!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){function n(e){return window.wizAssets&&window.wizAssets.initialize?void window.wizAssets.initialize(e,function(){console.error("failed to init wizAssets"),window.wizAssets=null,e()}):e()}function o(){if(d.isWebGlSupported()){var e=i(1186);window.isoEngine=new e,window.actorManager=window.isoEngine.actorManager,window.background=window.isoEngine.background}window.dofus.start()}i(1),i(2),i(3),i(4),i(5),i(6);var s=i(7);window.developmentMode=!1,window.buildVersion="1.11.0",window.location.search.slice(1).split(";").map(function(e){var t=e.split("=");switch(t[0]){case"appVersion":window.appInfo=window.appInfo||{},window.appInfo.version=t[1]}}),window.assetPreloader=i(182),window.dofus=i(186);var a=document.createElement("div");a.id="dofusBody",document.body.appendChild(a);var r=i(314),l=i(429);window.gui=new l,window.foreground=new r;var c=i(168),d=i(398),u=window.chrome;"object"==typeof u&&u.system&&u.system.memory&&c.isPhoneGap?u.system.memory.getInfo(function(e){c.capacity=e.capacity,n(o)}):n(o),c.isCordova?c.isAndroid?window.cordova&&window.cordova.plugins&&window.cordova.plugins.isemulator&&window.cordova.plugins.isemulator.assess(function(e){s.wKpi.sendPlatform(e?"emulator":"device")},function(e){console.error("cordova.plugins.isemulator.assess failed: "+e)}):s.wKpi.sendPlatform("device"):s.wKpi.sendPlatform("browser")},function(e,t){},function(e,t){},function(e,t){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function i(e){return"string"!=typeof e&&(e=String(e)),e}function n(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return f.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function s(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function a(e){return new Promise(function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}})}function r(e){var t=new FileReader;return t.readAsArrayBuffer(e),a(t)}function l(e){var t=new FileReader;return t.readAsText(e),a(t)}function c(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(f.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(f.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(f.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(e){if(!f.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob?(this.blob=function(){var e=s(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(r)},this.text=function(){var e=s(this);if(e)return e;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var e=s(this);return e?e:Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function d(e){var t=e.toUpperCase();return g.indexOf(t)>-1?t:e}function u(e,t){t=t||{};var i=t.body;if(u.prototype.isPrototypeOf(e)){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,i||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=e;if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new o(t.headers)),this.method=d(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function h(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var i=e.split("="),n=i.shift().replace(/\+/g," "),o=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}}),t}function p(e){var t=new o,i=(e.getAllResponseHeaders()||"").trim().split("\n");return i.forEach(function(e){var i=e.trim().split(":"),n=i.shift().trim(),o=i.join(":").trim();t.append(n,o)}),t}function m(e,t){t||(t={}),this.type="default",this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof o?t.headers:new o(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var f={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};o.prototype.append=function(e,n){e=t(e),n=i(n);var o=this.map[e];o||(o=[],this.map[e]=o),o.push(n)},o.prototype["delete"]=function(e){delete this.map[t(e)]},o.prototype.get=function(e){var i=this.map[t(e)];return i?i[0]:null},o.prototype.getAll=function(e){return this.map[t(e)]||[]},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(e,n){this.map[t(e)]=[i(n)]},o.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(i){this.map[i].forEach(function(n){e.call(t,n,i,this)},this)},this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,i){e.push(i)}),n(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),n(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,i){e.push([i,t])}),n(e)},f.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.prototype.clone=function(){return new u(this)},c.call(u.prototype),c.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},m.error=function(){var e=new m(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];m.redirect=function(e,t){if(_.indexOf(t)===-1)throw new RangeError("Invalid status code");return new m(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=u,e.Response=m,e.fetch=function(e,t){return new Promise(function(i,n){function o(){return"responseURL"in a?a.responseURL:/^X-Request-URL:/m.test(a.getAllResponseHeaders())?a.getResponseHeader("X-Request-URL"):void 0}var s;s=u.prototype.isPrototypeOf(e)&&!t?e:new u(e,t);var a=new XMLHttpRequest;a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:p(a),url:o()},t="response"in a?a.response:a.responseText;i(new m(t,e))},a.onerror=function(){n(new TypeError("Network request failed"))},a.ontimeout=function(){n(new TypeError("Network request failed"))},a.open(s.method,s.url,!0),"include"===s.credentials&&(a.withCredentials=!0),"responseType"in a&&f.blob&&(a.responseType="blob"),s.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),a.send("undefined"==typeof s._bodyInit?null:s._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(e,t){"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e,t){return void 0===t&&(t=0),this.slice(t,e.length+t)===e}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e,t){var i=this.toString();(void 0===t||t>i.length)&&(t=i.length),t-=e.length;var n=i.indexOf(e,t);return n!==-1&&n===t})},function(e,t){/*! http://mths.be/codepointat v0.2.0 by @mathias */
String.prototype.codePointAt||!function(){"use strict";var e=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(n){}return i}(),t=function(e){if(null==this)throw TypeError();var t=String(this),i=t.length,n=e?Number(e):0;if(n!=n&&(n=0),!(n<0||n>=i)){var o,s=t.charCodeAt(n);return s>=55296&&s<=56319&&i>n+1&&(o=t.charCodeAt(n+1),o>=56320&&o<=57343)?1024*(s-55296)+o-56320+65536:s}};e?e(String.prototype,"codePointAt",{value:t,configurable:!0,writable:!0}):String.prototype.codePointAt=t}()},function(e,t){/*! http://mths.be/fromcodepoint v0.2.1 by @mathias */
String.fromCodePoint||!function(){var e=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(n){}return i}(),t=String.fromCharCode,i=Math.floor,n=function(e){var n,o,s=16384,a=[],r=-1,l=arguments.length;if(!l)return"";for(var c="";++r<l;){var d=Number(arguments[r]);if(!isFinite(d)||d<0||d>1114111||i(d)!=d)throw RangeError("Invalid code point: "+d);d<=65535?a.push(d):(d-=65536,n=(d>>10)+55296,o=d%1024+56320,a.push(n,o)),(r+1==l||a.length>s)&&(c+=t.apply(null,a),a.length=0)}return c};e?e(String,"fromCodePoint",{value:n,configurable:!0,writable:!0}):String.fromCodePoint=n}()},function(e,t,i){i(8),e.exports=i(9)},function(e,t,i){var n=i(9),o=i(181),s=0;n.logTutorialStepStart=function(e){var t=o.STEP_START[e];t&&(s=Date.now(),n.log(t))},n.logTutorialStepEnd=function(e){var t=o.STEP_END[e];if(t){var i=Math.ceil((Date.now()-s)/1e3);s=0,n.log(o.STEP_END[e],{time_spent_on_action:i})}},n.logTutorialSubStep=function(e,t){var i=o.SUB_STEP[e];i&&i[t]&&n.log(i[t])}},function(e,t,i){function n(e,t,i){c.length>50&&(console.error("The stackEvent exceed 50 events, the stack is trash"),c=[]),c.push({name:e,data:t,options:i})}function o(){for(;c.length;){var e=c.shift();t.log(e.name,e.data,e.options)}}var s=i(10),a=i(19),r=i(41),l=i(165),c=[],d=!1;t.init=function(e){e=e||{};var t=e.wizAnalytics;for(var n in t){var o=t[n];s.register(n,o.token,o.options)}a.init(e.ankAnalytics),i(178)},t.register=function(e,t,i){a.register(t),s.freeze(e,i),d=!0,o()},t.unregister=function(){d=!1,a.unregister()},t.log=function(e,t,i){if(t=t||{},i=i||{},!d)return void n(e,t,i);i.withPlayerInfo!==!1&&l.addCharacterInfo(t),i.withEquipment&&l.addEquippedItem(t,window.gui.playerData);var o;try{o=JSON.parse(JSON.stringify(t))}catch(r){var c='Analytics: unable to duplicate KPI data for event "'+e+'" ('+(r.message||r)+")";console.error(c),o=null}o?(l.addAccountId(o),i.withResolution&&l.addResolution(o),i.withSubscriptionInfo&&l.addSubscriptionInfo(o)):o=t,s.send(e,o),i.wizAnalyticsOnly||a.send(e,t)},t.wKpi=r},function(e,t,i){function n(e,t,n){try{var o=i(11)("./"+e+"/index.js");o.init(t,n),l.push(o)}catch(s){console.error("Analytics Error: Initialization failed",e,s)}}function o(e,t){for(var i=0;i<l.length;i+=1){var n=l[i];if(n.idendity)try{n.idendity(e.valueOf())}catch(o){console.error("Analytics Error: couldn't set identity",n.name,o)}if(n.register)try{n.register(t)}catch(o){console.error("Analytics Error: couldn't freeze data",n.name,o)}}}function s(e,t){for(var i=0;i<l.length;i+=1){var n=l[i];try{n.log(e,t)}catch(o){console.error("Analytics Error: couldn't log",e,n.name,o)}}}function a(e){for(var t=0;t<l.length;t+=1){var i=l[t];if(i.screen)try{i.screen(e)}catch(n){console.error("Analytics Error: not able to register the screen",i.name,n)}}}function r(e,t){for(var i=0;i<l.length;i+=1){var n=l[i];if(n.revenue)try{n.revenue(e,t)}catch(o){console.error("Analytics Error: couldn't log revenue",n.name,o)}}}var l=[];t.freeze=o,t.send=s,t.screen=a,t.revenue=r,t.register=n},function(e,t,i){function n(e){return i(o(e))}function o(e){return s[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var s={"./analog/index.js":12,"./flurry/index.js":13,"./localytics/index.js":15,"./mixpanel/index.js":17};n.keys=function(){return Object.keys(s)},n.resolve=o,e.exports=n,n.id=11},function(e,t){t.name="analog",t._basicData={},t.init=function(e){console.log("inititialized with: ",e)},t.idendity=function(e){console.log("Freeze ID: ",e.valueOf())},t.register=function(e){for(var i in e)t._basicData["_"+i]=e[i];console.log("Freeze data: ",e)},t.log=function(e,i){i=i||{};for(var n in t._basicData)i[n]=i[n]||t._basicData[n];console.log("Logging",e,i)},t.screen=function(e){console.log("Screen",e)},t.revenue=function(e){console.log("Revenue",e)}},function(e,t,i){t.name="flurry",t.init=function(e){i(14),t._flurry=window.FlurryAgent,t._flurry.startSession(e)},t.idendity=function(e){t._flurry.setUserId(e)},t.register=function(e){t._basicData=e||{}},t.log=function(e,i){i=i||{};for(var n in t._basicData)i[n]=i[n]||t._basicData[n];t._flurry.logEvent(e,i)},t.screen=function(e){t._flurry.logEvent("screen",{view:e})}},function(e,t){!function(){function e(e){throw e}function t(e,t){function i(){this.constructor=e}for(var n in t)g.call(t,n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i,e.wa=t.prototype}var i,n,o,s,a,r,l,c,d,u,h,p=!0,m=null,f=!1,g={}.hasOwnProperty;i=function(e,t,i,n,o){o==m&&(o=h),o.n(e),o.l(e),o.N(e),o.o(t),o.z(t),o.p(t.length,255),o.n(n),o.l(n),this.ce=e,this.bp=t,this.bq=n,i?(o.Ua(i),this.bs=i):this.bs={}},n=function(){function e(){}return e.ia=function(e){var t,i,n,o,s,a,r,l,c,e=this.Ob(e);for(r="",n=l=0,c=e.length;l<c;n=l+=3)t=e.charCodeAt(n),i=e.charCodeAt(n+1),n=e.charCodeAt(n+2),o=t>>2,t=(3&t)<<4|i>>4,s=(15&i)<<2|n>>6,a=63&n,isNaN(i)?s=a=64:isNaN(n)&&(a=64),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(o)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(s)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a);return r},e.lb=function(e){var t,i,n,o,s,a,r,l,e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(a="",s=r=0,l=e.length;r<l;s=r+=4)t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(s)),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(s+1)),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(s+2)),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(s+3)),t=t<<2|i>>4,i=(15&i)<<4|o>>2,n=(3&o)<<6|s,a+=String.fromCharCode(t),64!==o&&(a+=String.fromCharCode(i)),64!==s&&(a+=String.fromCharCode(n));return a=this.Nb(a)},e.Ob=function(e){var t,i,n,o,e=e.replace(/\r\n/g,"\n");for(i="",t=n=0,o=e.length;0<=o?n<o:n>o;t=0<=o?++n:--n)t=e.charCodeAt(t),t<128?i+=String.fromCharCode(t):(t>127&&t<2048?i+=String.fromCharCode(t>>6|192):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128)),i+=String.fromCharCode(63&t|128));return i},e.Nb=function(e){var t,i,n,o,s;for(s="",o=0;o<e.length;)t=e.charCodeAt(o),t<128?(s+=String.fromCharCode(t),o++):t>191&&t<224?(i=e.charCodeAt(o+1),s+=String.fromCharCode((31&t)<<6|63&i),o+=2):(i=e.charCodeAt(o+1),n=e.charCodeAt(o+2),s+=String.fromCharCode((15&t)<<12|(63&i)<<6|63&n),o+=3);return s},e}(),o=function(){function e(){}return e.bb=function(e){var t,i,n,o,s;for(t=1,i=0,n=o=0,s=e.length;0<=s?o<s:o>s;n=0<=s?++o:--o)n=e.charCodeAt(n),t+=n,i+=t;return t%=65521,i%=65521,65536*i+t},e}(),s=function(e){function i(e,t,n,o,s,a){a==m&&(a=h),a.M(o),i.wa.constructor.call(this,e,t,n,s),this.timed=o,this.br=0}return t(i,e),i}(i),a=function(){function t(){}var i;return i=function(e){var t,i;i={};try{t=n.lb(e),i=JSON.parse(t)}catch(o){console.log(o)}return i},t.ga=function(e,t){return(t?this.Da:"")+{install:"fit",session:"fs",lastPoll:"flp",firstPartyCookie:"fid"}[e]},t.i=p,t.appVersion="",t.O="",t.Ha=0,t.ka=Date.now(),t.Da=m,t.F=m,t.Ka=p,t.Bb=p,t.Qa=f,t.Ea=f,t.localStorage=f,t.fa=m,t.Ja="",t.referrer="",t.J=0,t.e=m,t.$=[],t.w=m,t.Y=5e3,t.ea=m,t.I=f,t.Z=m,t.h=function(e){if(this.Qa)return"string"==typeof e?this.g(""+e):this.g(""+e.name+"=>"+e.message)},t.g=function(e){if(this.Ea)return console.log("Flurry "+new Date+": "+e)},t.Ub=function(){},t.ub=function(){return this.g("getFlurryAgentVersion() called"),9},t.da=function(e){this.g("setAppVersion("+e+") called");try{return h.o(e),h.z(e),h.p(e.length,255),this.appVersion=e,this.e&&this.e.da(e),this.i=p}catch(t){return this.h(t)}},t.ua=function(e){this.g("setUserId("+e+") called");try{return h.j(this.e),h.o(e),h.z(e),h.p(e.length,"userId"),this.e.ua(e),this.i=p}catch(t){return this.h(t)}},t.ra=function(e){this.g("setGender("+e+") called");try{return h.j(this.e),h.o(e),h.Ta(e,{m:1,f:0}),this.e.ra(e),this.i=p}catch(t){return this.h(t)}},t.qa=function(e){this.g("setAge("+e+") called");try{return h.j(this.e),h.n(e),h.l(e),h.N(e),h.va(e),this.e.qa(e),this.i=p}catch(t){return this.h(t)}},t.sa=function(e,t,i){i==m&&(i=0),this.g("setLocation("+e+","+t+","+i+") called");try{return h.j(this.e),h.n(e),h.l(e),h.n(t),h.l(t),h.n(i),h.l(i),this.e.sa(e,t,i),this.i=p}catch(n){return this.h(n)}},t.mb=function(){this.Ja=navigator.platform},t.nb=function(){this.referrer=document.referrer},t.ib=function(){this.mb(),this.nb()},t.L=function(e){this.g("setSessionContinueSeconds("+e+") called");try{if(h.n(e),h.l(e),h.N(e),h.va(e),this.J=e,this.e)return this.e.L(e)}catch(t){return this.h(t)}},t.Jb=function(e){this.g("setShowErrorInLogEnabled("+e+") called");try{return h.M(e),this.Qa=e}catch(t){return this.h(t)}},t.Gb=function(e){this.g("setDebugLogEnabled("+e+") called");try{return h.M(e),this.Ea=e}catch(t){return this.h(t)}},t.Ib=function(e){this.g("setLocalStorageEnabled("+e+") called");try{h.M(e),this.localStorage=e}catch(t){this.h(t)}},t.kb=function(){var e,t,i=this;t=window.onfocus,window.onfocus=function(){if(i.g("ACTIVE"),t!=m&&t(),i.e)return i.e.Ma()?i.ta():(i.A(),i.Ra(i.O))},e=window.onblur,window.onblur=function(){var t;if(i.g("PAUSE"),e!=m&&e(),i.e&&(t=Date.now(),i.e.Pa(t),i.Q(),i.Bb))return i.q()}},t.jb=function(){var e;(e=parseInt(this.G("install")))?this.ka=e:this.K("install",this.ka)},t.Ca=function(){var e;(e=this.G("firstPartyCookie",f))?this.F=e:this.F!==m&&this.K("firstPartyCookie",this.F,f)},t.Fb=function(){this.Da=n.ia(this.O).replace("=","")+"_"},t.G=function(e,t){var i,n,o,s,a,r,l;for(t==m&&(t=p),a=this.ga(e,t),n=document.cookie.split(";"),r=0,l=n.length;r<l;r++)if(i=n[r],s=i.indexOf("="),o=i.slice(0,s).trim(),o===a)return i.slice(s+1);return m},t.eb=function(){return this.G("install")!=m},t.ha=function(e){var t;return t==m&&(t=p),document.cookie=""+this.ga(e,t)+"=; expires='Thu, 01 Jan 1970 00:00:00 GMT'; path=/"},t.K=function(e,t,i){var n;i==m&&(i=p),n=new Date,n.setTime(Date.now()+31536e7),document.cookie=this.ga(e,i)+"="+t+"; expires="+n.toGMTString()+"; path=/"},t.ta=function(e){var t=this;try{e&&h.va(1e3*e-5e3),h.j(this.e)}catch(i){return void this.h(i)}return this.Q(),e&&(this.Y=1e3*e),this.fa=window.setInterval(function(){return t.ea=Date.now(),t.K("lastPoll",t.ea),t.q()},this.Y),this.ea&&Date.now()-this.ea>this.Y&&this.q(),this.Y/1e3},t.Q=function(){this.fa&&window.clearInterval(this.fa),this.fa=m},t.$a=function(){var e,t,n;return t=this.G("session"),e=this.G("lastPoll"),this.ha("session"),this.ha("lastPoll"),t!=m&&e!=m&&(this.g("found paused session"),t=i(t),t[u.c.r]=e,e=new u(t),this.J&&e.L(this.J),e.Ma()&&(this.g("paused session resumed"),n=e)),n||(this.g("creating new session"),n=new u,this.J&&n.L(this.J)),this.appVersion&&n.da(this.appVersion),n},t.Ra=function(t){this.g("startSession("+t+") called");try{if(!this.e)return h.o(t),h.z(t),h.p(t,255),this.O=t,this.Fb(),this.i=p,this.e=this.$a(),this.jb(),this.Ca(),this.eb()||(this.Ka=f,this.A(),e("CookieError=>session ending since cookies not enabled!")),this.Ha||(this.ib(),this.kb()),this.ta(),this.q(),this.Ha++}catch(i){return this.h(i)}},t.A=function(){this.g("endSession() called");try{if(this.Q(),this.e)return this.e.A(),this.i=p,this.Ka?this.q():this.$.push(this.e),this.e=m,this.ha("session")}catch(e){return this.h(e)}},t.yb=function(){this.g("pauseSession() called");try{return this.Q(),this.Na(),this.e?(this.q(),this.e=m):this.g("no session to pause!")}catch(e){return this.h(e)}},t.Na=function(){var e;try{h.j(this.e),e=Date.now(),this.e.Pa(e),this.Tb=e,this.K("session",this.e.Ya()),this.K("lastPoll",e)}catch(t){this.h(t)}},t.t=function(e,t,i){t==m&&(t={}),i==m&&(i=f),this.g("logEvent("+e+","+t+","+i+") called");try{return h.j(this.e),this.e.Wa(e,t,i),this.i=p}catch(n){return this.h(n)}},t.qb=function(e,t){t==m&&(t=m),this.g("endTimedEvent("+e+","+t+") called");try{return h.j(this.e),this.e.pb(e,t),this.i=p}catch(i){return this.h(i)}},t.k=function(){var e,t,i,n,o;t=[];try{for(h.j(this.e),o=this.e[u.c.k],i=0,n=o.length;i<n;i++)e=o[i],t.push(e.bp)}catch(s){this.h(s)}return t},t.Hb=function(e){this.g("setEventLogging("+e+") called");try{return h.j(this.e),h.M(e),this.e.ja=e}catch(t){return this.h(t)}},t.U=function(e,t,i,n){t==m&&(t=0),i==m&&(i="USD"),n==m&&(n={}),this.g("logPurchase("+e+","+t+","+i+","+n+") called");try{return h.j(this.e),this.e.Xa(e,t,i,n),this.i=p}catch(o){return this.h(o)}},t.wb=function(e,t,i){i==m&&(i=0),this.g("logError("+e+","+t+","+i+") called");try{return h.j(this.e),this.e.Va(e,t,i),this.i=p}catch(n){return this.h(n)}},t.q=function(){var e;this.g("REQUEST INITIATED");try{if(!this.I&&(this.w?this.w.Kb():this.i&&(e=new d,e.Za(this.appVersion,this.O,this.ka,this.Ja,this.Rb,this.referrer,this.e,this.$,this.F),this.w=e.request,this.fb(e)),this.w))return this.Na(),this.rb(JSON.stringify(this.w))}catch(t){return this.h(t)}},t.fb=function(e){this.e.gb(e.sessionIncluded.events,e.sessionIncluded.purchases,e.sessionIncluded.errors),this.$=this.$.slice(e.sessionsIncluded),0===e.level&&(this.i=f)},t.rb=function(e){var t,i=this;return this.g("REQUEST EXECUTED"),this.I=p,this.Z=window.setInterval(function(){return i.P(f)},1e4),t=document.createElement("script"),t.type="text/javascript",t.async=p,t.src=encodeURI(c.Fa+"?d="+n.ia(e)+"&c="+o.bb(e)),e=document.getElementsByTagName("script"),e[0].parentNode.insertBefore(t,e[0])},t.Cb=function(t){this.g("RESPONSE RECEIVED");try{if(this.I||e("ResponseError=>request considered timed out!"),"object"!=typeof t&&(this.P(f),e("ResponseError=>input is not a valid object!")),t.a!=m&&t.a>0?this.P(p):this.P(f),t.b!=m&&this.Ib(t.b),t.d!=m&&(this.F=t.d,this.Ca(),this.i=p),this.i)return this.q()}catch(i){return this.h(i)}},t.P=function(e){if(this.g("CLEAR REQUEST with "+e),this.I)return this.Z&&window.clearInterval(this.Z),e&&(this.w=m),this.I=f,this.Z=m},t}(),window.FlurryAgent=a,a.setAppVersion=a.da,a.getFlurryAgentVersion=a.ub,a.setShowErrorInLogEnabled=a.Jb,a.setDebugLogEnabled=a.Gb,a.setSessionContinueSeconds=a.L,a.setRequestInterval=a.ta,a.startSession=a.Ra,a.endSession=a.A,a.pauseSession=a.yb,a.logEvent=a.t,a.endTimedEvent=a.qb,a.timedEvents=a.k,a.logError=a.wb,a.logPurchase=a.U,a.setUserId=a.ua,a.setAge=a.qa,a.setGender=a.ra,a.setLocation=a.sa,a.setEventLogging=a.Hb,a.requestCallback=a.Cb,r=function(e,t,i,n,o){o==m&&(o=h),o.n(e),o.l(e),o.N(e),o.o(t),o.z(t),o.p(t.length,255),o.o(i),o.z(i),o.p(i.length,255),o.n(n),o.l(n),o.N(n),this.cf=e,this.bz=t,this.ca=i,this.cb=n.toString(),this.cc=Date.now()},l=function(e){function i(e,t,o,s,a,r,l){l==m&&(l=h),l.n(o),l.l(o),l.Qb(o),l.o(s),l.Ta(s,n),i.wa.constructor.call(this,e,t,a,r),this.bw=100*o,this.bx=n[s]}var n;return t(i,e),n={USD:0,EUR:1,GBP:2,CHF:3},i}(i),c=function(){function e(n,o,s,a,r,l,c,d,h,p,f){for(this.a={},this.a.af=Date.now(),this.a.aa=t,this.a.ab=n,this.a.ac=o,this.a.ae=s,this.a.ad=a,this.a.ag=r,this.a.ah=h[u.c.timestamp],e.g("about to check if firstPartyCookieUID "+f+" should be assigned to global map in the report request"),f!==m&&(this.a.cg=f,e.g("firstPartyCookieUID "+f+" was assigned to global map")),0===h.requestsMade&&(this.a.ai=l,this.a.aj=d,h.Db()),this.a.ak=i,this.b=[],h&&(h.Oa(),s=e.za(h),this.b.push(s)),n=0,o=p.length;n<o;n++)s=p[n],s=e.za(s),this.b.push(s)}var t,i;return i=t=1,e.Ab={timedEvents:"timedEvents",eventLogging:"eventLogging",sessionContinue:"sessionContinue",pauseTimestamp:"pauseTimestamp",age:"age",numEventNames:"numEventNames",numPurchaseNames:"numPurchaseNames",requestsMade:"requestsMade",totalEventNames:"totalEventNames",totalPurchaseNames:"totalPurchaseNames",numEventsLogged:"numEventsLogged",numPurchasesLogged:"numPurchasesLogged",numErrorsLogged:"numErrorsLogged",eventCounter:"eventCounter",purchaseCounter:"purchaseCounter",errorCounter:"errorCounter"},e.zb={timed:"timed"},e.Fa="https://data.flurry.com/aah.do",e.g=function(){},e.Sb=function(){return this.Fa},e.hb=function(e){var t,i,n;i={};for(t in e)n=e[t],this.zb.hasOwnProperty(t)||(i[t]=n);return i},e.za=function(e){var t,i,n,o,s,a;n={};for(i in e)if(o=e[i],i===u.c.location)o.bg!=m&&(n[i]=o);else if(i===u.c.D)for(n[i]=[],s=0,a=o.length;s<a;s++)t=o[s],n[i].push(this.hb(t));else this.Ab.hasOwnProperty(i)||(n[i]=o);return n},e.prototype.Kb=function(){this.a.af=Date.now()},e}(),d=function(){function t(){this.sessionsIncluded=0,this.sessionIncluded={},this.request={},this.level=0}return t.g=function(){},t.prototype.Za=function(t,i,n,o,s,a,r,l,d){for(this.request=new c(10,9,t,i,n,o,s,a,r,l,d),i=[];;){if(4===this.level&&e("RequestError=>request length is set too short!"),t=JSON.stringify(this.request),4*t.length/3<=3e3){this.sessionsIncluded=this.request.b.length-1,this.sessionIncluded.events=this.request.b[0].bo.length,this.sessionIncluded.purchases=this.request.b[0].bv.length,this.sessionIncluded.errors=this.request.b[0].by.length;break}i.push(this.request=this.xb(this.request))}},t.prototype.xb=function(e){switch(this.level){case 0:1===e.b.length?this.level=1:e.b=this.R(e.b);break;case 1:0===e.b[0].by.length?this.level=2:e.b[0].by=this.R(e.b[0].by);break;case 2:0===e.b[0].bv.length?this.level=3:e.b[0].bv=this.R(e.b[0].bv);break;case 3:0===e.b[0].bo.length?this.level=4:e.b[0].bo=this.R(e.b[0].bo)}return e},t.prototype.R=function(e){var t;return e.length>=1&&(t=parseInt(e.length/2),e=e.slice(0,t)),e},t}(),u=function(){function t(e){e==m&&(e={}),this[t.c.appVersion]="",this[t.c.Sa]="",this[t.c.Ga]=-1,this[t.c.xa]=0,this[t.c.ya]=0,this[t.c.location]={},this[t.c.vb]=t.sb(),this[t.c.k]=e[t.c.k]||[],this[t.c.C]=e[t.c.C]||0,this[t.c.D]=[],this[t.c.V]=0,this[t.c.Aa]=f,this[t.c.T]={},this[t.c.s]={},this[t.c.ma]=0,this[t.c.H]=e[t.c.H]||0,this[t.c.X]=[],this[t.c.W]=0,this[t.c.Ba]=f,this[t.c.oa]={},this[t.c.v]={},this[t.c.na]=0,this[t.c.B]=e[t.c.B]||0,this[t.c.S]=[],this[t.c.la]=0,this[t.c.Ia]=0,this.ba=e[t.c.timestamp]||Date.now(),this[t.c.duration]=0,this[t.c.ja]=p,this[t.c.pa]=i,this[t.c.r]=e[t.c.r]||0,this[t.c.u]=e[t.c.u]||-1,this[t.c.La]=0,this[t.c.Lb]=t.tb()}var i;return t.c={appVersion:"bd",Sa:"be",Ga:"bk",xa:"age",ya:"bl",location:"bf",vb:"bj",k:"timedEvents",C:"eventCounter",D:"bo",V:"numEventsLogged",Aa:"bm",T:"totalEventNames",s:"bn",ma:"numEventNames",H:"purchaseCounter",X:"bv",W:"numPurchasesLogged",Ba:"bt",oa:"totalPurchaseNames",v:"bu",na:"numPurchaseNames",B:"errorCounter",S:"by",la:"numErrorsLogged",Ia:"cd",timestamp:"ba",duration:"bb",ja:"eventLogging",pa:"sessionContinue",r:"pauseTimestamp",u:"bc",La:"requestsMade",Lb:"ch"},i=3e5,t.sb=function(){var e;return e="",navigator.language!=m?e=navigator.language:navigator.Mb!=m&&(e=navigator.Mb),e},t.tb=function(){var e;return e=(new Date).getTimezoneOffset()/60,"Etc/GMT"+(e>0?"+":"-")+Math.abs(e)},t.prototype.Db=function(){this[t.c.La]++},t.prototype.da=function(e){return this[t.c.appVersion]=e},t.prototype.ua=function(e){return this[t.c.Sa]=e},t.prototype.ra=function(e){return this[t.c.Ga]="f"===e?0:1},t.prototype.qa=function(e){return this.Eb(e),this[t.c.xa]=e},t.prototype.Eb=function(e){var i;i=new Date,this[t.c.ya]=new Date(i.getFullYear()-e,i.getMonth(),1).getTime()},t.prototype.sa=function(e,i,n){return this[t.c.location]={bg:e,bh:i,bi:n}},t.prototype.L=function(e){return this[t.c.pa]=1e3*e},t.prototype.Oa=function(){this[t.c.duration]=Date.now()-this[t.c.timestamp]},t.prototype.gb=function(e,i,n){this[t.c.D]=this[t.c.D].slice(e),this[t.c.s]={},this[t.c.X]=this[t.c.X].slice(i),this[t.c.v]={},this[t.c.S]=this[t.c.S].slice(n)},t.prototype.A=function(){if(this.ob(),this.Oa(),this[t.c.V]<1e3&&(this[t.c.Aa]=f),this[t.c.W]<100)return this[t.c.Ba]=f},t.prototype.Pa=function(e){this[t.c.r]=e},t.prototype.Ma=function(){var e;return e=this[t.c.r]>0?Date.now()-this[t.c.r]:0,e>0&&(this[t.c.u]===-1&&(this[t.c.u]=0),this[t.c.u]+=e,this[t.c.r]=0),e<this[t.c.pa]},t.prototype.Ya=function(){var e,i,o,s,a;for(e={},o=[t.c.timestamp,t.c.u,t.c.C,t.c.H,t.c.B,t.c.k],s=0,a=o.length;s<a;s++)i=o[s],e[i]=this[i];return n.ia(JSON.stringify(e))},t.prototype.t=function(e){if(this[t.c.ja]&&this[t.c.V]<1e3)return e.timed&&!e.br?this[t.c.k].push(e):(this[t.c.D].push(e),this[t.c.V]++)},t.prototype.Wa=function(i,n,o){this[t.c.C]++,n=new s(this[t.c.C],i,n,o,Date.now()-this[t.c.timestamp]),i in this[t.c.T]?(this[t.c.T][i]++,i in this[t.c.s]?this[t.c.s][i]++:this[t.c.s][i]=1,this.t(n)):this[t.c.ma]<100?(this[t.c.T][i]=this[t.c.s][i]=1,this[t.c.ma]++,this.t(n)):e("LogError=>unique name limit reached!")},t.prototype.pb=function(e,i){var n,o,s,a,r;for(o=0,r=this[t.c.k],s=0,a=r.length;s<a;s++){if(n=r[s],n.bp===e){n.br=Date.now()-(this[t.c.timestamp]+n.bq),i&&h.Ua(i)&&(n.bs=i),this.t(n);break}o++}this[t.c.k].splice(o,1)},t.prototype.ob=function(){var e,i,n,o;for(o=this[t.c.k],i=0,n=o.length;i<n;i++)e=o[i],e.br=Date.now()-(this[t.c.timestamp]+e.bq),this.t(e);this[t.c.k]=[]},t.prototype.U=function(e){if(this[t.c.W]<100)return this[t.c.X].push(e),this[t.c.W]++},t.prototype.Xa=function(i,n,o,s){this[t.c.H]++,n=new l(this[t.c.H],i,n,o,s,Date.now()-this[t.c.timestamp]),i in this[t.c.oa]?(this.totalPurchaseNames[i]++,i in this[t.c.v]?this[t.c.v][i]++:this[t.c.v][i]=1,this.U(n)):this[t.c.na]<10?(this[t.c.oa][i]=this[t.c.v][i]=1,this[t.c.na]++,this.U(n)):e("PurchaseError=>unique name limit reached!")},t.prototype.Va=function(e,i,n){this[t.c.B]++,e=new r(this[t.c.B],e,i,n),this[t.c.la]<10&&(this[t.c.S].push(e),this[t.c.la]++),this[t.c.Ia]++},t}(),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),h=function(){function t(){}return t.M=function(t){"boolean"!=typeof t&&e("ValidationError=>input is not valid!")},t.n=function(t){"number"!=typeof t&&e("ValidationError=>input is not valid!")},t.o=function(t){"string"!=typeof t&&e("ValidationError=>input is not valid!")},t.Pb=function(t){"object"!=typeof t&&e("ValidationError=>input is not valid!")},t.N=function(t){t!==parseInt(t)&&e("ValidationError=>input is not valid!")},t.z=function(t){t.trim()||e("ValidationError=>input is not valid!")},t.p=function(t,i){t>i&&e("ValidationError=>input is not valid!")},t.l=function(t){isNaN(t)&&e("ValidationError=>input is not valid!")},t.Qb=function(t){t===parseInt(t)||t.toFixed(2)===t.toString()||t.toFixed(1)===t.toString()||e("ValidationError=>input is not valid!")},t.Ta=function(t,i){i.hasOwnProperty(t)||e("ValidationError=>input is not valid!")},t.va=function(t){t<0&&e("ValidationError=>input is not valid!")},t.j=function(t){t||e("ValidationError=>input does not exist!")},t.Ua=function(e){var t,i,n;this.Pb(e),i=1;for(t in e)n=e[t],this.o(t),this.p(t.length,255),this.o(n),this.p(n.length,255),this.p(i,10),i++;return p},t}()}()},function(e,t,i){t.name="localytics";var n;t.init=function(e,o){var s=i(16);o=o||{},o.useCustomerId=!0,o.sessionTimeoutSeconds=o.sessionTimeoutSeconds||!1,o.polling=o.polling||0,t._localyticsSession=s(e,o),n=o.defaultDimension,t._localyticsSession.open(),t._localyticsSession.upload()},t.idendity=function(e){t._localyticsSession.setCustomerId(e)},t.register=function(e){for(var i in e)t._localyticsSession.setIdentifier("customer_"+i,e[i])};var o=null;t.log=function(e,i){t._localyticsSession.tagEvent(e,i,n),o||(o=window.setTimeout(function(){t._localyticsSession.upload(),o=null},1e3))},t.screen=function(e){t._localyticsSession.tagScreen(e)},t.revenue=function(e,i){t._localyticsSession.tagEvent("revenue",{price:e},i,e),t._localyticsSession.upload()}},function(e,t){/*!
	 * Localytics HTML5/JavaScript Library
	 * Copyright (C) 2013 Char Software Inc., DBA Localytics
	 *
	 * This code is provided under the Localytics Modified BSD License.
	 * A copy of this license is available at
	 * http://www.localytics.com/docs/opensourceinfo/#license-documentation
	 *
	 * Please visit www.localytics.com for more information.
	 */
var i=function(e,t){var i=function(e){},n=function(){return console&&console.log?function(e){console.log(e)}:i}(),o=i,s={},a={};s.setItem=function(e,t){try{window.localStorage.setItem(e,t)}catch(i){o("setItem failed by exception.")}a[e]=t.toString()},s.getItem=function(e){var t=null;try{t=window.localStorage.getItem(e)}catch(i){o("getItem failed by exception.")}return a.hasOwnProperty(e)?t||a[e]:t},s.removeItem=function(e){try{window.localStorage.removeItem(e)}catch(t){o("removeItem failed by exception.")}delete a[e]},t=t?t:{};var r=null==t.namespace?"":t.namespace+"_";return function(a,l){var c,d,u,h,p,m,f,g,_,v,y,b,M,w,T,C,A,I,S,E='window.__localytics_callbacks__["'+r+'"]',x="html5_2.6",N=16e3,L=["open","close","tagEvent","tagScreen","tagEvent","upload","setIdentifier","setCustomerEmail","setCustomerId","setCustomerName"],O=30,D=1e4,R=3e4,P=500,B=!1,k=1e4,z={},F="__ll_"+r+"iu",H="__ll_"+r+"es",q="__ll_"+r+"ch",W="__ll_"+r+"pa",U="__ll_"+r+"csu",G="__ll_"+r+"cst",j="__ll_"+r+"csi",Y="__ll_"+r+"csq",V="__ll_"+r+"cso",X="__ll_"+r+"ub",Q="__ll_"+r+"lot",K="__ll_"+r+"lct",J="__ll_"+r+"chs",Z="__ll_"+r+"fl",$="__ll_"+r+"cd",ee="__ll_"+r+"ids",te=[F,H,q,W,U,G,j,Y,V,X,K,J,Z,$,ee],ie=/loaded|complete/;z._switchLogger=function(e){o=e?n:i};var ne=navigator.userAgent,oe=function(){return"undefined"!=typeof WinJS&&"function"==typeof WinJS.xhr}();z._getStore=function(e,t){if(s){var i,n=s.getItem(e);if(null!=n)try{i=t?JSON.parse(n):n}catch(a){o("Error parsing JSON from localStorage."+e)}return i}};var se=function(e){var t=(z._getStore(J,!1)||"").length,i=(""+e).length,n=i-t;e+=n;try{return s.setItem(J,e),T=e,e}catch(o){return l}},ae=function(){T=de(),se(T)};z._writeStore=function(e,t){if(s){var i,n,a,r,c;T===l&&(T=z._getStore(J,!0),T||ae()),i=z._getStore(e,!1),i=i?i.length:0;try{if(null==t)se(T-i),s.removeItem(e);else if(r=JSON.stringify(t),n=r.length,a=n-i)if(c=T+a,a<0){if(se(c)===l)return o("Write aborted: delta was negative, but unable to update storage"),l;s.setItem(e,r)}else{if(c+=(""+c).length-(""+T).length,!(c<k&&se(c)!==l))return o("Write aborted: writing would exceed storage limits"),l;s.setItem(e,r)}else s.setItem(e,r);return t}catch(d){return o("Write to localStorage failed by exception."),l}}};var re=function(e){h||(o("No event store found, searching localStorage"),h=z._getStore(H,!0),h||(o("No event storage in localStorage found, creating an empty array"),h=[])),o("Pushing event to event store"),h.push(e),z._writeStore(H,h)},le=function(t){var i="http:"+z.__url__+"api/v2/applications/"+encodeURIComponent(e)+"/uploads";WinJS.xhr({url:i,type:"POST",data:t,headers:{"Content-Type":"application/json","x-upload-time":he()}}).done(ke,ke)},ce=function(t){var i=document.createElement("script"),n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,s="http:"+z.__url__+"api/v2/applications/"+encodeURIComponent(e)+"/uploads?callback="+E+"&client_date="+he()+"&data="+encodeURIComponent(t);return o("Uploading blob: \n"+t),o("Request length: "+s.length),s.length>N?(o("Upload length exceeds maximum supported length.  Deleting data without uploading."),void z._clearStoredUploads()):(i.async="async",i.src=s,i.onload=function(){i.readyState&&!ie.test(i.readyState)||(o("Unloading script tag from header"),i.onload=null,n&&i.parentNode&&n.removeChild(i),i=l)},void n.insertBefore(i,n.firstChild))};z._send=function(){return oe?function(e){le(e)}:function(e){ce(e)}}();var de=function(){var e,t,i,n=0;for(e=0,t=te.length;e<t;e+=1)i=z._getStore(te[e],!1),i&&i.length&&(n+=i.length);return n},ue=function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},he=function(){return(new Date).getTime()/1e3|0},pe=function(){return(new Date).getTime()},me=function(){return!1},fe=function(){return[]},ge=function(){return""},_e=function(){return 0},ve=function(){return{}};z._getOrCreateProperty=function(e,t,i,n){return n?(e=i(),z._writeStore(t,e)):null==e&&(e=z._getStore(t,!0),e||(e=i(),z._writeStore(t,e))),e};var ye=function(){var e=z._getStore(ee,!0);return null==e&&(o("No identifiers in localStorage found, creating an empty map"),e=ve()),e},be=function(){return t.useCustomerId?"":ue()},Me=function(){return u=z._getOrCreateProperty(u,F,be,!1)},we=function(e){return f=z._getOrCreateProperty(f,U,ue,e)},Te=function(e){return g=z._getOrCreateProperty(g,G,he,e)},Ce=function(){return m=z._getOrCreateProperty(m,W,he,!1)};z._getSessionIndex=function(){return _=z._getOrCreateProperty(_,j,_e,!1)};var Ae=function(){return z._getSessionIndex(),_+=1,z._writeStore(j,_),_},Ie=function(){return v=z._getOrCreateProperty(v,Y,_e,!1),v+=1,z._writeStore(Y,v),v},Se=function(){return y=z._getOrCreateProperty(y,V,me,!1)};z._getOSVersion=function(e){var t,i,n,o,s,a,r=e.split(/[)]?\s[(]?/),l=r.length,c=r[1];if(e.match(/iPhone|iPad|iPod/))o=e.match(/OS (\d+)\D(\d+)/),o&&3===o.length&&(n="iOS "+o[1]+"."+o[2]);else if(c&&c.match(/Macintosh/)){for(t=2;t<l;t++)if("OS"==r[t]){var d=t-1,u=t+2;for(i=t-1;i>1;i--)if(";"===r[i].substr(-1)||"Intel"===r[i]||"CPU"===r[i]){d=i+1;break}for(i=t+1;i<t+4;i++){if(";"===r[i].substr(-1)){u=i;break}if("like"===r[i]){u=i-1;break}}n=r.splice(d,u-(d-1)).join(" "),n=n.replace(";","").replace("_",".").replace(/_\d$/,"").replace("Mac ","");break}}else/^Android/.test(r[3])?n=(r[3]+" "+r[4]).replace(";",""):(o=e.match(/Windows NT (\d)\.(\d)/))?o.length>2&&(s=o[1],a=o[2],"6"===s&&"2"===a?n="Windows 8":"6"===s&&"1"===a?n="Windows 7":"6"===s&&"0"===a?n="Windows Vista":"5"===s&&"1"===a?n="Windows XP":"5"===s&&"0"===a?n="Windows 2000":"5"===s&&"2"===a&&(n="Windows Server 2003")):e.match(/SymbOS/)?n="SymbOS":e.match(/BlackBerry/)&&(o=e.match(/Version\/(\d+)\./))&&(n="BlackBerry "+o[1]);return n},z._generateHeader=function(){o("Generating a new header");var t,i=(navigator.language||navigator.userLanguage||"").toUpperCase();if(i)if(i.match(/-/)){var n=i.split(/-/);i=n[0],t=n[1]}else t=ne.match(new RegExp("^.*?\\(.*?"+i+"-(\\w\\w).*?\\).*?$","i")),t=t&&t[1];var s=navigator.platform,a=navigator.vendor,r=navigator.platform,l={dt:"h",pa:Ce(),seq:Ie(),u:ue()},u={dt:"a",au:e,iu:Me(),lv:x,ua:ne};r&&(u.dmo=r),s&&(u.dp=s),i&&(u.dll=i);var h=z._getOSVersion(ne);return h&&(u.dov=h),c&&(u.av=c),d&&(u.nc=d),t&&(u.dc=t.toUpperCase()),a&&(u.dma=a),l.attrs=u,0==ze(ye())&&(l.ids=ye()),l};var Ee=function(e){return p=z._getOrCreateProperty(p,q,z._generateHeader,e)},xe=function(){I?o("Already polling."):(o("Beginning to poll for closes"),I=a.setTimeout(Le,D))},Ne=function(){I?(o("Stopping close polling"),a.clearTimeout(I),I=null):o("No polling to stop")},Le=function(){z._markNewClose(),I=a.setTimeout(Le,D)};z._markNewClose=function(){return o("Marking a new close."),M=pe(),z._writeStore(K,M)};var Oe=function(){M=z._getOrCreateProperty(M,K,pe,!1),C=z._getOrCreateProperty(C,Z,fe,!1);var e=M/1e3|0,t=Te(),i=e-t,n={dt:"c",u:ue(),ss:t,su:we(),ct:e,ctl:i,cta:i};return C.length>0&&(n.fl=C),Pe(n,z._getOrCreateProperty(A,$,fe,!1)),n},De=function(){o("Finalizing close with last polled close"),Ne(),re(Oe()),C=[],z._writeStore(Z,C),z._writeStore(V,!1)};z._finalizeClose=De,z._clearStoredUploads=function(){b=null,z._writeStore(X,b)};var Re=function(e){var t;if(null!=e.polling&&(D=e.polling?+e.polling:0),e.uploadTimeout&&(R=e.uploadTimeout),e.screenLimit&&(P=e.screenLimit),e.appVersion)c=""+e.appVersion;else if(e.version)o("'version' is deprecated, please use 'appVersion' instead."),c=""+e.version;else if("undefined"!=typeof Windows)try{t=Windows.ApplicationModel.Package.current.id.version,c=[t.major,t.minor,t.build,t.revision].join(".")}catch(i){}e.carrier&&(d=""+e.carrier),null!=e.sessionTimeoutSeconds?O=e.sessionTimeoutSeconds?+e.sessionTimeoutSeconds:0:null!=e.timeout&&(o("'timeout' is deprecated, please use 'sessionTimeoutSeconds' instead."),O=e.timeout?+e.timeout/1e3:0),null!=e.storage&&(k=e.storage?+e.storage:0),null!=e.logger&&(B=!!e.logger),z._switchLogger(B),ae(),oe||(a.__localytics_callbacks__=a.__localytics_callbacks__||{},a.__localytics_callbacks__[r]=ke),Ee(!0),o("LocalyticsSession successfully initialized")},Pe=function(e,t){var i;if(t&&Be(t))for(i=0;i<4;i+=1)t[i]&&(e["c"+i]=""+t[i])},Be=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};z._open=function(e){var t;if(M=z._getStore(K,!0)||0,pe()-M<1e3*O)o("Open called within timeout, resuming last session.");else{Se()&&De(),Ae();var i=Te(!0);if(t={dt:"s",ct:i,u:we(!0),nth:z._getSessionIndex()},w=w||z._getStore(Q,!0)||0,w&&0!=w){var n=i-w;n>=1&&(t.sl=Math.round(n))}w=z._writeStore(Q,i),e&&(A=z._writeStore($,e.slice(0)),Pe(t,e)),re(t)}y=!0,z._writeStore(V,y),o("Appended open tag to event store"),D?xe():o("Polling timeout was set to 0; no close polling will be done.")},z._tagEvent=function(e,t,i,n){if(!Se())return void o("Cannot tag event: either no session was opened, or it was already closed");isNaN(n)?(o("Customer value increase not a number, setting to 0."),n=0):parseFloat(n)!=parseInt(n)&&o("Customer value increase passed as floating point number.");var s,a,r={dt:"e",ct:he(),u:ue(),su:we(),n:""+e,v:n};if(!i&&Be(t)&&(i=t,t=null),t){a={};for(s in t)t.hasOwnProperty(s)&&(a[s]=""+t[s]);r.attrs=a}Pe(r,i),re(r),o("Tagged event: '"+e+"' with attributes (JSON): '"+JSON.stringify(a)+"'")},z._tagScreen=function(e){if(!Se())return void o("Cannot tag screen: either no session was opened, or it was already closed");C=z._getOrCreateProperty(C,Z,fe,!1);var t=C.length||0,i=""+e;t<P&&C[t-1]!==i&&(C.push(i),z._writeStore(Z,C))},z._close=function(){return Se()?(Ne(),void z._markNewClose()):void o("Cannot close session: either no session was opened, or it was already closed")},z._upload=function(){if(null!=S&&pe()-S<R)return void o("Upload in progress, returning");if(h=z._getOrCreateProperty(h,H,fe,!1),b=z._getOrCreateProperty(b,X,ge,!1),!(h&&0!==h.length||b))return void o("Nothing to upload, returning.");var e,t,i=h.splice(0),n="";for(i.unshift(Ee(!1)),e=0,t=i.length;e<t;e+=1)n+=JSON.stringify(i[e])+"\n";b+=n,z._writeStore(X,b),h=null,z._writeStore(H,h),z._send(b),S=pe(),Ee(!0)};var ke=function(e){var t=+(e.response_code||e.status);S=null,o("Callback called with response:"),t&&(o("Response code: "+t),202===t||200===t?(o("Upload succeeded, clearing uploaded items."),z._clearStoredUploads()):t>=400&&t>500?(o("Response was 4XX, clearing items"),z._clearStoredUploads()):e.message&&(o("Upload failed with message:"),o(e.message)))},ze=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},Fe=function(e,t){e+="",t+="";var i=ye();o("Adding identifier:"+e+" to identifiers map"),i[e]=t,z._writeStore(ee,i)},He=function(e){e+="";var t=ye();o("Deleting value for key:"+e),delete t[e],z._writeStore(ee,t)};z._setIdentifier=function(e,t){null!=e&&0!=e.length&&(null==t?He(e):0==t.length?He(e):Fe(e,t))},z._setCustomerName=function(e){z.setIdentifier("customer_name",e)},z._setCustomerId=function(e){z.setIdentifier("customer_id",e),t.useCustomerId&&(u=e,z._writeStore(F,u),Ee(!0))},z._setCustomerEmail=function(e){z.setIdentifier("customer_email",e)},z.__url__="//analytics.localytics.com/";var qe=function(e,t){console.log("> Call to Localytics client library failed ."),console.log("> localyticsSession."+e+" failed ."),console.log("> "+t),console.log(t);for(var e in L)z[e]=i};return function(){var e,i,n=L.length;for(e=0;e<n;e++)i=L[e],z[i]=function(e){return function(){try{z["_"+e].apply(z,arguments)}catch(t){qe(e,t)}}}(i);Re(t)}(),z}(window)};e.exports=i},function(e,t,i){t.name="mixpanel",t._mixpanel=window.mixpanel=[],t._mixpanel.__SV=1.2,t.init=function(e,n){i(18),window.mixpanel.init(e,n),t._mixpanel=window.mixpanel},t.idendity=function(e){t._mixpanel.identify(e),t._mixpanel.people.set_once("firstLogin",new Date),t._mixpanel.people.set("lastLogin",new Date),t._mixpanel.people.increment("nbLogin")},t.register=function(e){e.name&&(t._mixpanel.people.set("$name",e.name),t._mixpanel.name_tag(e.name)),t._mixpanel.register(e),t._mixpanel.people.set(e)},t.log=function(e,i){t._mixpanel.track(e,i)},t.screen=function(e){t._mixpanel.track_pageview(e)},t.revenue=function(e,i){i=i||{},i.$time=new Date,t._mixpanel.people.track_charge(e,i)}},function(e,t){!function(e){function t(){t.done||(t.done=!0,L=!0,S=!1,E.each(H,function(e){e._dom_loaded()}))}function i(){try{d.documentElement.doScroll("left")}catch(e){return void setTimeout(i,1)}t()}var n=Array.prototype,o=Object.prototype,s=n.slice,a=o.toString,r=o.hasOwnProperty,l=window.console,c=window.navigator,d=window.document,u=c.userAgent,h="mixpanel",p="__mps",m="__mpso",f="__mpa",g="__mpap",_="$set",v="$set_once",y="$add",b="$append",M="$people_distinct_id",w="__alias",T=[p,m,f,g,M,w],C="https:"==d.location.protocol?"https://":"http://",A=e&&e.__SV||0,I=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,S=!I&&u.indexOf("MSIE")==-1,E={},x=!1,N={api_host:C+"api.mixpanel.com",cross_subdomain_cookie:!0,cookie_name:"",loaded:function(){},store_google:!0,save_referrer:!0,test:!1,verbose:!1,img:!1,track_pageview:!0,debug:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_cookie:!1,secure_cookie:!1,ip:!0},L=!1;!function(){var e=n.forEach,t=n.indexOf,i=Array.isArray,o={},l=E.each=function(t,i,n){if(null!=t)if(e&&t.forEach===e)t.forEach(i,n);else if(t.length===+t.length){for(var s=0,a=t.length;s<a;s++)if(s in t&&i.call(n,t[s],s,t)===o)return}else for(var l in t)if(r.call(t,l)&&i.call(n,t[l],l,t)===o)return};E.extend=function(e){return l(s.call(arguments,1),function(t){for(var i in t)void 0!==t[i]&&(e[i]=t[i])}),e},E.isArray=i||function(e){return"[object Array]"===a.call(e)},E.isFunction=function(e){try{return/^\s*\bfunction\b/.test(e)}catch(t){return!1}},E.isArguments=function(e){return!(!e||!r.call(e,"callee"))},E.toArray=function(e){return e?e.toArray?e.toArray():E.isArray(e)?s.call(e):E.isArguments(e)?s.call(e):E.values(e):[]},E.values=function(e){var t=[];return null==e?t:(l(e,function(e){t[t.length]=e}),t)},E.identity=function(e){return e},E.include=function(e,i){var n=!1;return null==e?n:t&&e.indexOf===t?e.indexOf(i)!=-1:(l(e,function(e){if(n||(n=e===i))return o}),n)},E.includes=function(e,t){return e.indexOf(t)!==-1}}(),E.inherit=function(e,t){return e.prototype=new t,e.prototype.constructor=e,e.superclass=t.prototype,e},E.isObject=function(e){return e===Object(e)&&!E.isArray(e)},E.isEmptyObject=function(e){if(E.isObject(e)){for(var t in e)if(r.call(e,t))return!1;return!0}return!1},E.isUndefined=function(e){return void 0===e},E.isString=function(e){return"[object String]"==a.call(e)},E.isDate=function(e){return"[object Date]"==a.call(e)},E.isNumber=function(e){return"[object Number]"==a.call(e)},E.encodeDates=function(e){return E.each(e,function(t,i){E.isDate(t)?e[i]=E.formatDate(t):E.isObject(t)&&(e[i]=E.encodeDates(t))}),e},E.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())},E.strip_empty_properties=function(e){var t={};return E.each(e,function(e,i){E.isString(e)&&e.length>0&&(t[i]=e)}),t},E.truncate=function(e,t){var i;return"string"==typeof e?i=e.slice(0,t):E.isArray(e)?(i=[],E.each(e,function(e){i.push(E.truncate(e,t))})):E.isObject(e)?(i={},E.each(e,function(e,n){i[n]=E.truncate(e,t)})):i=e,i},E.JSONEncode=function(){return function(e){var t=e,i=function(e){var t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return t.lastIndex=0,t.test(e)?'"'+e.replace(t,function(e){var t=i[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},n=function(e,t){var o="",s="    ",l=0,c="",d="",u=0,h=o,p=[],m=t[e];switch(m&&"object"==typeof m&&"function"==typeof m.toJSON&&(m=m.toJSON(e)),typeof m){case"string":return i(m);case"number":return isFinite(m)?String(m):"null";case"boolean":case"null":return String(m);case"object":if(!m)return"null";if(o+=s,p=[],"[object Array]"===a.apply(m)){for(u=m.length,l=0;l<u;l+=1)p[l]=n(l,m)||"null";return d=0===p.length?"[]":o?"[\n"+o+p.join(",\n"+o)+"\n"+h+"]":"["+p.join(",")+"]",o=h,d}for(c in m)r.call(m,c)&&(d=n(c,m),d&&p.push(i(c)+(o?": ":":")+d));return d=0===p.length?"{}":o?"{"+p.join(",")+h+"}":"{"+p.join(",")+"}",o=h,d}};return n("",{"":t})}}(),E.JSONDecode=function(){var e,t,i,n,o={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},s=function(t){throw{name:"SyntaxError",message:t,at:e,text:i}},a=function(n){return n&&n!==t&&s("Expected '"+n+"' instead of '"+t+"'"),t=i.charAt(e),e+=1,t},r=function(){var e,i="";for("-"===t&&(i="-",a("-"));t>="0"&&t<="9";)i+=t,a();if("."===t)for(i+=".";a()&&t>="0"&&t<="9";)i+=t;if("e"===t||"E"===t)for(i+=t,a(),"-"!==t&&"+"!==t||(i+=t,a());t>="0"&&t<="9";)i+=t,a();return e=+i,isFinite(e)?e:void s("Bad number")},l=function(){var e,i,n,r="";if('"'===t)for(;a();){if('"'===t)return a(),r;if("\\"===t)if(a(),"u"===t){for(n=0,i=0;i<4&&(e=parseInt(a(),16),isFinite(e));i+=1)n=16*n+e;r+=String.fromCharCode(n)}else{if("string"!=typeof o[t])break;r+=o[t]}else r+=t}s("Bad string")},c=function(){for(;t&&t<=" ";)a()},d=function(){switch(t){case"t":return a("t"),a("r"),a("u"),a("e"),!0;case"f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case"n":return a("n"),a("u"),a("l"),a("l"),null}s("Unexpected '"+t+"'")},u=function(){var e=[];if("["===t){if(a("["),c(),"]"===t)return a("]"),e;for(;t;){if(e.push(n()),c(),"]"===t)return a("]"),e;a(","),c()}}s("Bad array")},h=function(){var e,i={};if("{"===t){if(a("{"),c(),"}"===t)return a("}"),i;for(;t;){if(e=l(),c(),a(":"),Object.hasOwnProperty.call(i,e)&&s('Duplicate key "'+e+'"'),i[e]=n(),c(),"}"===t)return a("}"),i;a(","),c()}}s("Bad object")};return n=function(){switch(c(),t){case"{":return h();case"[":return u();case'"':return l();case"-":return r();default:return t>="0"&&t<="9"?r():d()}},function(o){var a;return i=o,e=0,t=" ",a=n(),c(),t&&s("Syntax error"),a}}(),E.base64Encode=function(e){var t,i,n,o,s,a,r,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,u=0,h="",p=[];if(!e)return e;e=E.utf8Encode(e);do t=e.charCodeAt(d++),i=e.charCodeAt(d++),n=e.charCodeAt(d++),l=t<<16|i<<8|n,o=l>>18&63,s=l>>12&63,a=l>>6&63,r=63&l,p[u++]=c.charAt(o)+c.charAt(s)+c.charAt(a)+c.charAt(r);while(d<e.length);switch(h=p.join(""),e.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=h.slice(0,-1)+"="}return h},E.utf8Encode=function(e){e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var t,i,n,o="",s=0;for(t=i=0,s=e.length,n=0;n<s;n++){var a=e.charCodeAt(n),r=null;a<128?i++:r=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),null!==r&&(i>t&&(o+=e.substring(t,i)),o+=r,t=i=n+1)}return i>t&&(o+=e.substring(t,e.length)),o},E.UUID=function(){var e=function(){for(var e=1*new Date,t=0;e==1*new Date;)t++;return e.toString(16)+t.toString(16)},t=function(){return Math.random().toString(16).replace(".","")},i=function(e){function t(e,t){var i,n=0;for(i=0;i<t.length;i++)n|=s[i]<<8*i;return e^n}var i,n,o=u,s=[],a=0;for(i=0;i<o.length;i++)n=o.charCodeAt(i),s.unshift(255&n),s.length>=4&&(a=t(a,s),s=[]);return s.length>0&&(a=t(a,s)),a.toString(16)};return function(){var n=(screen.height*screen.width).toString(16);return e()+"-"+t()+"-"+i()+"-"+n+"-"+e()}}(),E.isBlockedUA=function(){var e=u;return!!/(google web preview|baiduspider|yandexbot)/i.test(e)},E.HTTPBuildQuery=function(e,t){var i,n,o=[];return"undefined"==typeof t&&(t="&"),E.each(e,function(e,t){i=encodeURIComponent(e.toString()),n=encodeURIComponent(t),o[o.length]=n+"="+i}),o.join(t)},E.getQueryParam=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+t+"=([^&#]*)",n=new RegExp(i),o=n.exec(e);return null===o||o&&"string"!=typeof o[1]&&o[1].length?"":decodeURIComponent(o[1]).replace(/\+/g," ")},E.cookie={get:function(e){for(var t=e+"=",i=d.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return null},parse:function(e){var t;try{t=E.JSONDecode(E.cookie.get(e))||{}}catch(i){}return t},set:function(e,t,i,n,o){var s="",a="",r="";if(n){var l=d.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),c=l?l[0]:"";s=c?"; domain=."+c:""}if(i){var u=new Date;u.setTime(u.getTime()+24*i*60*60*1e3),a="; expires="+u.toGMTString()}o&&(r="; secure"),d.cookie=e+"="+encodeURIComponent(t)+a+"; path=/"+s+r},remove:function(e,t){E.cookie.set(e,"",-1,t)}},E.register_event=function(){function e(e,i,n){var o=function(o){if(o=o||t(window.event)){var s,a,r=!0;return E.isFunction(n)&&(s=n(o)),a=i.call(e,o),!1!==s&&!1!==a||(r=!1),r}};return o}function t(e){return e&&(e.preventDefault=t.preventDefault,e.stopPropagation=t.stopPropagation),e}var i=function(t,i,n,o){if(!t)return void O.error("No valid element provided to register_event");if(t.addEventListener&&!o)t.addEventListener(i,n,!1);else{var s="on"+i,a=t[s];t[s]=e(t,n,a)}};return t.preventDefault=function(){this.returnValue=!1},t.stopPropagation=function(){this.cancelBubble=!0},i}(),E.dom_query=function(){function e(e){return e.all?e.all:e.getElementsByTagName("*")}function t(e,t){var i=" "+t+" ";return(" "+e.className+" ").replace(n," ").indexOf(i)>=0}function i(i){if(!d.getElementsByTagName)return new Array;for(var n,o=i.split(" "),s=new Array(d),a=0;a<o.length;a++)if(n=o[a].replace(/^\s+/,"").replace(/\s+$/,""),n.indexOf("#")>-1){var r=n.split("#"),l=r[0],c=r[1],u=d.getElementById(c);if(!u||l&&u.nodeName.toLowerCase()!=l)return new Array;s=new Array(u)}else if(n.indexOf(".")>-1){var r=n.split("."),l=r[0],h=r[1];l||(l="*");for(var p=new Array,m=0,f=0;f<s.length;f++){var g;g="*"==l?e(s[f]):s[f].getElementsByTagName(l);for(var _=0;_<g.length;_++)p[m++]=g[_]}s=new Array;for(var v=0,y=0;y<p.length;y++)p[y].className&&E.isString(p[y].className)&&t(p[y],h)&&(s[v++]=p[y])}else if(n.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var l=RegExp.$1,b=RegExp.$2,M=RegExp.$3,w=RegExp.$4;l||(l="*");for(var p=new Array,m=0,f=0;f<s.length;f++){var g;g="*"==l?e(s[f]):s[f].getElementsByTagName(l);for(var _=0;_<g.length;_++)p[m++]=g[_]}s=new Array;var T,v=0;switch(M){case"=":T=function(e){return e.getAttribute(b)==w};break;case"~":T=function(e){return e.getAttribute(b).match(new RegExp("\\b"+w+"\\b"))};break;case"|":T=function(e){return e.getAttribute(b).match(new RegExp("^"+w+"-?"))};break;case"^":T=function(e){return 0==e.getAttribute(b).indexOf(w)};break;case"$":T=function(e){return e.getAttribute(b).lastIndexOf(w)==e.getAttribute(b).length-w.length};break;case"*":T=function(e){return e.getAttribute(b).indexOf(w)>-1};break;default:T=function(e){return e.getAttribute(b)}}s=new Array,v=0;for(var y=0;y<p.length;y++)T(p[y])&&(s[v++]=p[y])}else{l=n;for(var p=new Array,m=0,f=0;f<s.length;f++)for(var g=s[f].getElementsByTagName(l),_=0;_<g.length;_++)p[m++]=g[_];s=p}return s}var n=/[\t\r\n]/g;return i}(),E.info={campaignParams:function(){var e="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),t="",i={};return E.each(e,function(e){t=E.getQueryParam(d.URL,e),t.length&&(i[e]=t)}),i},searchEngine:function(e){return 0===e.search("https?://(.*)google.([^/?]*)")?"google":0===e.search("https?://(.*)bing.com")?"bing":0===e.search("https?://(.*)yahoo.com")?"yahoo":0===e.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(e){var t=E.info.searchEngine(e),i="yahoo"!=t?"q":"p",n={};if(null!==t){n.$search_engine=t;var o=E.getQueryParam(e,i);o.length&&(n.mp_keyword=o)}return n},browser:function(){var e=u,t=c.vendor||"";return window.opera?E.includes(e,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":E.includes(e,"Chrome")?"Chrome":E.includes(t,"Apple")?E.includes(e,"Mobile")?"Mobile Safari":"Safari":E.includes(e,"Android")?"Android Mobile":E.includes(e,"Konqueror")?"Konqueror":E.includes(e,"Firefox")?"Firefox":E.includes(e,"MSIE")?"Internet Explorer":E.includes(e,"Gecko")?"Mozilla":""},os:function(){var e=u;return/Windows/i.test(e)?/Phone/.test(e)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"Mac OS X":/Linux/.test(e)?"Linux":""},device:function(){var e=u;return/iPhone/.test(e)?"iPhone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Windows Phone/i.test(e)?"Windows Phone":/Android/.test(e)?"Android":""},referringDomain:function(e){var t=e.split("/");return t.length>=3?t[2]:""},properties:function(){return E.strip_empty_properties({$os:E.info.os(),$browser:E.info.browser(),$referrer:d.referrer,$referring_domain:E.info.referringDomain(d.referrer),$device:E.info.device(),mp_lib:"web"})},people_properties:function(){return E.strip_empty_properties({$os:E.info.os(),$browser:E.info.browser()})},pageviewInfo:function(e){return E.strip_empty_properties({mp_page:e,mp_referrer:d.referrer,mp_browser:E.info.browser(),mp_platform:E.info.os()})}};var O={log:function(){if(x&&!E.isUndefined(l)&&l)try{l.log.apply(l,arguments)}catch(e){E.each(arguments,function(e){l.log(e)})}},error:function(){if(x&&!E.isUndefined(l)&&l){var e=["Mixpanel error:"].concat(E.toArray(arguments));try{l.error.apply(l,e)}catch(t){E.each(e,function(e){l.error(e)})}}},critical:function(){if(!E.isUndefined(l)&&l){var e=["Mixpanel error:"].concat(E.toArray(arguments));try{l.error.apply(l,e)}catch(t){E.each(e,function(e){l.error(e)})}}}},D=function(){};D.prototype.create_properties=function(){},D.prototype.event_handler=function(){},D.prototype.after_track_handler=function(){},D.prototype.init=function(e){return this.mp=e,this},D.prototype.track=function(e,t,i,n){var o=this,s=E.dom_query(e);return 0==s.length?void O.error("The DOM query ("+e+") returned 0 elements"):(E.each(s,function(e){E.register_event(e,this.override_event,function(e){var s={},a=o.create_properties(i,this),r=o.mp.get_config("track_links_timeout");o.event_handler(e,this,s),window.setTimeout(o.track_callback(n,a,s,!0),r),o.mp.track(t,a,o.track_callback(n,a,s))})},this),!0)},D.prototype.track_callback=function(e,t,i,n){n=n||!1;var o=this;return function(){i.callback_fired||(i.callback_fired=!0,e&&e(n,t)===!1||o.after_track_handler(t,i,n))}},D.prototype.create_properties=function(e,t){var i;return i="function"==typeof e?e(t):E.extend({},e)};var R=function(){this.override_event="click"};E.inherit(R,D),R.prototype.create_properties=function(e,t){var i=R.superclass.create_properties.apply(this,arguments);return t.href&&(i.url=t.href),i},R.prototype.event_handler=function(e,t,i){i.new_tab=2===e.which||e.metaKey||"_blank"===t.target,i.href=t.href,i.new_tab||e.preventDefault()},R.prototype.after_track_handler=function(e,t,i){t.new_tab||setTimeout(function(){window.location=t.href},0)};var P=function(){this.override_event="submit"};E.inherit(P,D),P.prototype.event_handler=function(e,t,i){i.element=t,e.preventDefault()},P.prototype.after_track_handler=function(e,t,i){setTimeout(function(){t.element.submit()},0)};var B=function(e){this.props={},this.campaign_params_saved=!1,e.cookie_name?this.name="mp_"+e.cookie_name:this.name="mp_"+e.token+"_mixpanel",this.load(),this.update_config(e),this.upgrade(e),this.save()};B.prototype.properties=function(){var e={};return E.each(this.props,function(t,i){E.include(T,i)||(e[i]=t)}),e},B.prototype.load=function(){if(!this.disabled){var e=E.cookie.parse(this.name);e&&(this.props=E.extend({},e))}},B.prototype.upgrade=function(e){var t,i,n=e.upgrade;n&&(t="mp_super_properties","string"==typeof n&&(t=n),i=E.cookie.parse(t),E.cookie.remove(t),E.cookie.remove(t,!0),i&&(this.props=E.extend(this.props,i.all,i.events))),e.cookie_name||"mixpanel"===e.name||(t="mp_"+e.token+"_"+e.name,i=E.cookie.parse(t),i&&(E.cookie.remove(t),E.cookie.remove(t,!0),this.register_once(i)))},B.prototype.save=function(){this.disabled||E.cookie.set(this.name,E.JSONEncode(this.props),this.expire_days,this.cross_subdomain,this.secure)},B.prototype.remove=function(){E.cookie.remove(this.name,!1),E.cookie.remove(this.name,!0)},B.prototype.clear=function(){this.remove(),this.props={}},B.prototype.register_once=function(e,t,i){return!!E.isObject(e)&&("undefined"==typeof t&&(t="None"),this.expire_days="undefined"==typeof i?this.default_expiry:i,E.each(e,function(e,i){this.props[i]&&this.props[i]!==t||(this.props[i]=e)},this),this.save(),!0)},B.prototype.register=function(e,t){return!!E.isObject(e)&&(this.expire_days="undefined"==typeof t?this.default_expiry:t,E.extend(this.props,e),this.save(),!0)},B.prototype.unregister=function(e){e in this.props&&(delete this.props[e],this.save())},B.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register_once(E.info.campaignParams()),this.campaign_params_saved=!0)},B.prototype.update_search_keyword=function(e){this.register(E.info.searchInfo(e))},B.prototype.update_referrer_info=function(e){this.register_once({$initial_referrer:e||"$direct",$initial_referring_domain:E.info.referringDomain(e)||"$direct"},"")},B.prototype.get_referrer_info=function(){return E.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})},B.prototype.safe_merge=function(e){return E.each(this.props,function(t,i){i in e||(e[i]=t)}),e},B.prototype.update_config=function(e){this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_cookie),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie)},B.prototype.set_disabled=function(e){this.disabled=e,this.disabled&&this.remove()},B.prototype.set_cross_subdomain=function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())},B.prototype.get_cross_subdomain=function(){return this.cross_subdomain},B.prototype.set_secure=function(e){e!==this.secure&&(this.secure=!!e,this.remove(),this.save())},B.prototype._add_to_people_queue=function(e,t){var i=this._get_queue_key(e),n=t[e],o=this._get_or_create_queue(_),s=this._get_or_create_queue(v),a=this._get_or_create_queue(y),r=this._get_or_create_queue(b,[]);i===p?(E.extend(o,n),this._pop_from_people_queue(y,n)):i===m?E.each(n,function(e,t){t in s||(s[t]=e)}):i===f?E.each(n,function(e,t){t in o?o[t]+=e:(t in a||(a[t]=0),a[t]+=e)},this):i===g&&r.push(n),O.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):"),O.log(t),this.save()},B.prototype._pop_from_people_queue=function(e,t){var i=this._get_queue(e);E.isUndefined(i)||(E.each(t,function(e,t){delete i[t]},this),this.save())},B.prototype._get_queue_key=function(e){return e===_?p:e===v?m:e===y?f:e===b?g:void O.error("Invalid queue:",e)},B.prototype._get_queue=function(e){return this.props[this._get_queue_key(e)]},B.prototype._get_or_create_queue=function(e,t){var i=this._get_queue_key(e),t=E.isUndefined(t)?{}:t;return this.props[i]||(this.props[i]=t)};var k=function(t,i,n){var o,s=n===h?e:e[n];return s&&!E.isArray(s)?void O.error("You have already initialized "+n):(o=new z,o._init(t,i,n),o.people=new F,o.people._init(o),x=x||o.get_config("debug"),E.isUndefined(s)||(o._execute_array.call(o.people,s.people),o._execute_array(s)),o)},z=function(){};z.prototype.init=function(t,i,n){if("undefined"==typeof n)return void O.error("You must name your new library: init(token, config, name)");if(n===h)return void O.error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");var o=k(t,i,n);return e[n]=o,o._loaded(),o},z.prototype._init=function(e,t,i){this.__loaded=!0,this.config={},this.set_config(E.extend({},N,t,{name:i,token:e,callback_fn:(i===h?i:"mixpanel."+i)+"._jsc"})),this._jsc=function(){},this.__dom_loaded_queue=[],this.__request_queue=[],this.__disabled_events=[],this._flags={disable_all_events:!1,identify_called:!1},this.cookie=new B(this.config),this.register_once({distinct_id:E.UUID()},"")},z.prototype._loaded=function(){
this.get_config("loaded")(this),this.get_config("track_pageview")&&this.track_pageview()},z.prototype._dom_loaded=function(){E.each(this.__dom_loaded_queue,function(e){this._track_dom.apply(this,e)},this),E.each(this.__request_queue,function(e){this._send_request.apply(this,e)},this),delete this.__dom_loaded_queue,delete this.__request_queue},z.prototype._track_dom=function(e,t){if(this.get_config("img"))return O.error("You can't use DOM tracking functions with img = true."),!1;if(!L)return this.__dom_loaded_queue.push([e,t]),!1;var i=(new e).init(this);return i.track.apply(i,t)},z.prototype._prepare_callback=function(e,t){if(E.isUndefined(e))return null;if(I){var i=function(i){e(i,t)};return i}var n=this._jsc,o=""+Math.floor(1e8*Math.random()),s=this.get_config("callback_fn")+'["'+o+'"]';return n[o]=function(i){delete n[o],e(i,t)},s},z.prototype._send_request=function(e,t,i){if(S)return void this.__request_queue.push(arguments);var n=this.get_config("verbose");if(this.get_config("test")&&(t.test=1),n&&(t.verbose=1),this.get_config("img")&&(t.img=1),I||(i?t.callback=i:(n||this.get_config("test"))&&(t.callback="(function(){})")),t.ip=this.get_config("ip")?1:0,t._=(new Date).getTime().toString(),e+="?"+E.HTTPBuildQuery(t),"img"in t){var o=d.createElement("img");o.src=e,d.body.appendChild(o)}else if(I){var s=new XMLHttpRequest;s.open("GET",e,!0),s.withCredentials=!0,s.onreadystatechange=function(e){if(4===s.readyState)if(200===s.status)i&&i(n?E.JSONDecode(s.responseText):Number(s.responseText));else{var t="Bad HTTP status: "+s.status+" "+s.statusText;O.error(t),i&&i(n?{status:0,error:t}:0)}},s.send(null)}else{var a=d.createElement("script");a.type="text/javascript",a.async=!0,a.defer=!0,a.src=e;var r=d.getElementsByTagName("script")[0];r.parentNode.insertBefore(a,r)}},z.prototype._execute_array=function(e){var t,i=[],n=[],o=[];E.each(e,function(e){e&&(t=e[0],"function"==typeof e?e.call(this):E.isArray(e)&&"alias"===t?i.push(e):E.isArray(e)&&t.indexOf("track")!=-1&&"function"==typeof this[t]?o.push(e):n.push(e))},this);var s=function(e,t){E.each(e,function(e){this[e[0]].apply(this,e.slice(1))},t)};s(i,this),s(n,this),s(o,this)},z.prototype.push=function(e){this._execute_array([e])},z.prototype.disable=function(e){"undefined"==typeof e?this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(e)},z.prototype.track=function(e,t,i){if("undefined"==typeof e)return void O.error("No event name provided to mixpanel.track");if(E.isBlockedUA()||this._flags.disable_all_events||E.include(this.__disabled_events,e))return void("undefined"!=typeof i&&i(0));t=t||{},t.token=t.token||this.get_config("token"),this.cookie.update_search_keyword(d.referrer),this.get_config("store_google")&&this.cookie.update_campaign_params(),this.get_config("save_referrer")&&this.cookie.update_referrer_info(d.referrer),t=E.extend({},E.info.properties(),this.cookie.properties(),t);var n={event:e,properties:t},o=E.truncate(n,255),s=E.JSONEncode(o),a=E.base64Encode(s);return O.log("MIXPANEL REQUEST:"),O.log(o),this._send_request(this.get_config("api_host")+"/track/",{data:a},this._prepare_callback(i,o)),o},z.prototype.track_pageview=function(e){"undefined"==typeof e&&(e=d.location.href),this.track("mp_page_view",E.info.pageviewInfo(e))},z.prototype.track_links=function(){return this._track_dom.call(this,R,arguments)},z.prototype.track_forms=function(){return this._track_dom.call(this,P,arguments)},z.prototype.register=function(e,t){this.cookie.register(e,t)},z.prototype.register_once=function(e,t,i){this.cookie.register_once(e,t,i)},z.prototype.unregister=function(e){this.cookie.unregister(e)},z.prototype._register_single=function(e,t){var i={};i[e]=t,this.register(i)},z.prototype.identify=function(e,t,i,n,o){e!=this.get_distinct_id()&&e!=this.get_property(w)&&(this.unregister(w),this._register_single("distinct_id",e)),this._flags.identify_called=!0,this.people._flush(t,i,n,o)},z.prototype.get_distinct_id=function(){return this.get_property("distinct_id")},z.prototype.alias=function(e,t){if(e===this.get_property(M))return O.critical("Attempting to create alias for existing People user - aborting."),-2;var i=this;return E.isUndefined(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(w,e),this.track("$create_alias",{alias:e,distinct_id:t},function(t){i.identify(e)})):(O.error("alias matches current distinct_id - skipping api call."),this.identify(e),-1)},z.prototype.name_tag=function(e){this._register_single("mp_name_tag",e)},z.prototype.set_config=function(e){E.isObject(e)&&(E.extend(this.config,e),this.cookie&&this.cookie.update_config(this.config),x=x||this.get_config("debug"))},z.prototype.get_config=function(e){return this.config[e]},z.prototype.get_property=function(e){return this.cookie.props[e]},z.prototype.toString=function(){var e=this.get_config("name");return e!==h&&(e="mixpanel."+e),e};var F=function(){};if(F.prototype._init=function(e){this._mixpanel=e},F.prototype.set=function(e,t,i){var n={},o={};return E.isObject(e)?(E.each(e,function(e,t){"$distinct_id"!=t&&"$token"!=t&&(o[t]=e)}),i=t):o[e]=t,this._get_config("save_referrer")&&this._mixpanel.cookie.update_referrer_info(d.referrer),o=E.extend({},E.info.people_properties(),this._mixpanel.cookie.get_referrer_info(),o),n[_]=o,this._send_request(n,i)},F.prototype.set_once=function(e,t,i){var n={},o={};return E.isObject(e)?(E.each(e,function(e,t){"$distinct_id"!=t&&"$token"!=t&&(o[t]=e)}),i=t):o[e]=t,n[v]=o,this._send_request(n,i)},F.prototype.increment=function(e,t,i){var n={},o={};return E.isObject(e)?(E.each(e,function(e,t){if("$distinct_id"!=t&&"$token"!=t)return isNaN(parseFloat(e))?void O.error("Invalid increment value passed to mixpanel.people.increment - must be a number"):void(o[t]=e)}),i=t):(E.isUndefined(t)&&(t=1),o[e]=t),n[y]=o,this._send_request(n,i)},F.prototype.append=function(e,t,i){var n={},o={};return E.isObject(e)?(E.each(e,function(e,t){"$distinct_id"!=t&&"$token"!=t&&(o[t]=e)}),i=t):o[e]=t,n[b]=o,this._send_request(n,i)},F.prototype.track_charge=function(e,t,i){return!E.isNumber(e)&&(e=parseFloat(e),isNaN(e))?void O.error("Invalid value passed to mixpanel.people.track_charge - must be a number"):this.append("$transactions",E.extend({$amount:e},t),i)},F.prototype.clear_charges=function(e){return this.set("$transactions",[],e)},F.prototype.delete_user=function(){if(!this._identify_called())return void O.error("mixpanel.people.delete_user() requires you to call identify() first");var e={$delete:this._mixpanel.get_distinct_id()};return this._send_request(e)},F.prototype.toString=function(){return this._mixpanel.toString()+".people"},F.prototype._send_request=function(e,t){e.$token=this._get_config("token"),e.$distinct_id=this._mixpanel.get_distinct_id();var i=E.encodeDates(e),n=E.truncate(i,255),o=E.JSONEncode(i),s=E.base64Encode(o);return this._identify_called()?(O.log("MIXPANEL PEOPLE REQUEST:"),O.log(n),this._mixpanel._send_request(this._get_config("api_host")+"/engage/",{data:s},this._mixpanel._prepare_callback(t,n)),n):(this._enqueue(e),E.isUndefined(t)||t(this._get_config("verbose")?{status:-1,error:null}:-1),n)},F.prototype._get_config=function(e){return this._mixpanel.get_config(e)},F.prototype._identify_called=function(){return this._mixpanel._flags.identify_called===!0},F.prototype._enqueue=function(e){_ in e?this._mixpanel.cookie._add_to_people_queue(_,e):v in e?this._mixpanel.cookie._add_to_people_queue(v,e):y in e?this._mixpanel.cookie._add_to_people_queue(y,e):b in e?this._mixpanel.cookie._add_to_people_queue(b,e):O.error("Invalid call to _enqueue():",e)},F.prototype._flush=function(e,t,i,n){var o=this,s=E.extend({},this._mixpanel.cookie._get_queue(_)),a=E.extend({},this._mixpanel.cookie._get_queue(v)),r=E.extend({},this._mixpanel.cookie._get_queue(y)),l=this._mixpanel.cookie._get_queue(b);if(E.isUndefined(s)||!E.isObject(s)||E.isEmptyObject(s)||(o._mixpanel.cookie._pop_from_people_queue(_,s),this.set(s,function(t,i){0==t&&o._mixpanel.cookie._add_to_people_queue(_,s),E.isUndefined(e)||e(t,i)})),E.isUndefined(a)||!E.isObject(a)||E.isEmptyObject(a)||(o._mixpanel.cookie._pop_from_people_queue(v,a),this.set_once(a,function(e,t){0==e&&o._mixpanel.cookie._add_to_people_queue(v,a),E.isUndefined(n)||n(e,t)})),E.isUndefined(r)||!E.isObject(r)||E.isEmptyObject(r)||(o._mixpanel.cookie._pop_from_people_queue(y,r),this.increment(r,function(e,i){0==e&&o._mixpanel.cookie._add_to_people_queue(y,r),E.isUndefined(t)||t(e,i)})),!E.isUndefined(l)&&E.isArray(l)&&l.length){for(var c=l.length-1;c>=0;c--){var d=l.pop();o.append(d,function(e,t){0==e&&o._mixpanel.cookie._add_to_people_queue(b,d),E.isUndefined(i)||i(e,t)})}o._mixpanel.cookie.save()}},E.toArray=E.toArray,E.isObject=E.isObject,E.JSONEncode=E.JSONEncode,E.JSONDecode=E.JSONDecode,E.isEmptyObject=E.isEmptyObject,z.prototype.init=z.prototype.init,z.prototype.disable=z.prototype.disable,z.prototype.track=z.prototype.track,z.prototype.track_links=z.prototype.track_links,z.prototype.track_forms=z.prototype.track_forms,z.prototype.track_pageview=z.prototype.track_pageview,z.prototype.register=z.prototype.register,z.prototype.register_once=z.prototype.register_once,z.prototype.unregister=z.prototype.unregister,z.prototype.identify=z.prototype.identify,z.prototype.alias=z.prototype.alias,z.prototype.name_tag=z.prototype.name_tag,z.prototype.set_config=z.prototype.set_config,z.prototype.get_config=z.prototype.get_config,z.prototype.get_property=z.prototype.get_property,z.prototype.get_distinct_id=z.prototype.get_distinct_id,z.prototype.toString=z.prototype.toString,B.prototype.properties=B.prototype.properties,B.prototype.update_search_keyword=B.prototype.update_search_keyword,B.prototype.update_referrer_info=B.prototype.update_referrer_info,B.prototype.get_cross_subdomain=B.prototype.get_cross_subdomain,B.prototype.clear=B.prototype.clear,F.prototype.set=F.prototype.set,F.prototype.set_once=F.prototype.set_once,F.prototype.increment=F.prototype.increment,F.prototype.append=F.prototype.append,F.prototype.track_charge=F.prototype.track_charge,F.prototype.clear_charges=F.prototype.clear_charges,F.prototype.delete_user=F.prototype.delete_user,F.prototype.toString=F.prototype.toString,E.isUndefined(e))return void O.critical("'mixpanel' object not initialized. Ensure you are using the latest version of the Mixpanel JS Library along with the snippet we provide.");if(e.__loaded||e.config&&e.cookie)return void O.error("Mixpanel library has already been downloaded at least once.");if(A<1.1)return void O.critical("Version mismatch; please ensure you're using the latest version of the Mixpanel code snippet.");var H={};E.each(e._i,function(e){var t,i;e&&E.isArray(e)&&(t=e[e.length-1],i=k.apply(this,e),H[t]=i)});var q=function(){E.each(H,function(t,i){i!==h&&(e[i]=t)}),e._=E};if(e.init=function(t,i,n){if(n)e[n]||(e[n]=H[n]=k(t,i,n),e[n]._loaded());else{var o=e;H[h]?o=H[h]:t&&(o=k(t,i,h)),window[h]=e=o,q()}},e.init(),E.each(H,function(e){e._loaded()}),d.addEventListener)"complete"==d.readyState?t():d.addEventListener("DOMContentLoaded",t,!1);else if(d.attachEvent){d.attachEvent("onreadystatechange",t);var W=!1;try{W=null==window.frameElement}catch(U){}d.documentElement.doScroll&&W&&i()}E.register_event(window,"load",t,!0)}(window.mixpanel)},function(e,t,i){function n(e){var t=r[e];return void 0===t?(a.error("ankAnalytics.getEventId: "+e+" is missing from the event map"),-1):t}function o(e,t){var i=l[e];if(!i)return void console.error("ankAnalytics checkModel: "+e+" is missing from the models");for(var n=Object.keys(t),o=[],s=0,a=i.length;s<a;s+=1){var r=i[s];if("relative_soft_currency_gained"!==r&&"relative_hard_currency_gained"!==r&&"time_spent_on_action"!==r){var c=n.indexOf(r)===-1,d=b.indexOf(r)===-1&&(void 0===t[r]||null===t[r]);(c||d)&&o.push(r)}}o.length&&console.error("ankAnalytics checkModel: missing params on event",e,o)}var s,a,r=i(20),l=i(21),c=i(22),d=i(23),u=i(27),h=i(28),p=!1,m=!1,f=!1,g=!1,_=18,v=null,y=!1,b=["amu_id","weapon_id","ringl_id","belt_id","ringr_id","boots_id","hat_id","cloack_id","pet_id","ride_id","comp_id","shield_id"];t.init=function(e){a=window.dofus.logger,e&&(s=e.version,e.debug&&(f=!0),e.analog?(m=!0,y=!0):e.useUrlMap?(g=!0,y=!0):y=!1)},t.register=function(e){y&&(v=e||0)},t.unregister=function(){v=null},t.send=function(e,t){if(y){t=t||{};var i=n(e);window.developmentMode&&f&&o(e,t);var r={game_id:_,event_id:i,session_id:v,date:u(t.date||h.now(),"UTC:yyyy-mm-dd HH:MM:ss")+" GMT",data:t};if(m)a.info("ankAnalytics.send: "+e,JSON.stringify(r));else if(g){var l=window.gui.serversData.connectedServerId,b=c[l];if(!b)return void(p||(p=!0,console.error("ankAnalytics send: eventServerURL is missing for server "+l)));d(b,r,s,function(e){if(e)return a.error("ankAnalytics.send:",e)})}}}},function(e,t){e.exports={"Session_Info.Login":558,"Session_Info.Choose_Server":559,"Session_Info.Choose_Character":560,"F_T_U_E.Step0000_Chose_Nickname":320,"F_T_U_E.Step0100_Chose_Server":321,"F_T_U_E.Step0200_Create_First_Character":322,"F_T_U_E.Step0300_Enter_Tuto":323,"F_T_U_E.Step9999_Quit_Tuto":324,"F_T_U_E.Step0400_Start_Tuto_Step_1_Move":325,"F_T_U_E.Step0500_Succeed_Tuto_Step_1_Move":326,"F_T_U_E.Step0600_Start_Tuto_Step_2_Speak_To_NPC":327,"F_T_U_E.Step0630_Clic_Maitre_Pifo":328,"F_T_U_E.Step0660_Answer_Maitre_Pifo":329,"F_T_U_E.Step0700_Succeed_Tuto_Step_2_Speak_To_NPC":330,"F_T_U_E.Step0800_Start_Tuto_Step_3_Equip_Ring":331,"F_T_U_E.Step0820_Clic_Menu_Bag":332,"F_T_U_E.Step0840_Clic_Menu_Weapons":333,"F_T_U_E.Step0860_Equip_Ring":334,"F_T_U_E.Step0880_Close_Menu":335,"F_T_U_E.Step0900_Succed_Tuto_Step_3_Equip_Ring":336,"F_T_U_E.Step1000_Start_Tuto_Step_4_Change_Map":337,"F_T_U_E.Step1100_Succeed_Tuto_Step_4_Change_Map":338,"F_T_U_E.Step1200_Start_Tuto_Step_5_Start_Fight":339,"F_T_U_E.Step1230_Clic_Scarecrow":340,"F_T_U_E.Step1260_Clic_Attack":341,"F_T_U_E.Step1300_Succeed_Tuto_Step_5_Start_Fight":342,"F_T_U_E.Step1400_Start_Tuto_Step_6_Chose_Starting_Position":343,"F_T_U_E.Step1430_Clic_Desired_Position_Square":344,"F_T_U_E.Step1460_Clic_Ready_Button":345,"F_T_U_E.Step1500_Succeed_Tuto_Step_6_Chose_Starting_Position":346,"F_T_U_E.Step1600_Start_Tuto_Step_7_Move_In_Fight":347,"F_T_U_E.Step1630_Clic_Desired_Position_Square":348,"F_T_U_E.Step1660_Clic_Validate_Move":349,"F_T_U_E.Step1700_Succed_Tuto_Step_7_Move_In_Fight":350,"F_T_U_E.Step1800_Start_Tuto_Step_8_Use_Spell":351,"F_T_U_E.Step1820_Clic_Attack_Button":352,"F_T_U_E.Step1850_Select_Target":353,"F_T_U_E.Step1870_Validate_Attack":354,"F_T_U_E.Step1890_Succeed_Tuto_Step_8_Use_Spell":355,"F_T_U_E.Step1900_Start_Tuto_Step_9_End_Turn":356,"F_T_U_E.Step1950_Clic_End_Turn_Button":357,"F_T_U_E.Step2000_Succeed_Tuto_Step_9_End_Turn":358,"F_T_U_E.Step2100_Start_Tuto_Step_10_Win_Fight":359,"F_T_U_E.Step2140_Scarecrow_Figh_End":360,"F_T_U_E.Step2180_Close_Fight_Summary_Window":361,"F_T_U_E.Step2200_Succeed_Tuto_Step_10_Win_Fight":362,"F_T_U_E.Step2300_Start_Tuto_Step_11_Start_Quest":363,"F_T_U_E.Step2330_Talk_To_NPC_Maitre_Pifo":364,"F_T_U_E.Step2360_Answer_NPC_Maitre_Pifo":365,"F_T_U_E.Step2400_Succeed_Tuto_Step_11_Start_Quest":366,"F_T_U_E.Step2500_Start_Tuto_Step_12_Equip_Items":367,"F_T_U_E.Step2510_Clic_Bag_Menu":368,"F_T_U_E.Step2520_Clic_Weapon_Menu":369,"F_T_U_E.Step2530_Equip_Cloak":370,"F_T_U_E.Step2540_Equip_Amulet":371,"F_T_U_E.Step2550_Equip_Belt":372,"F_T_U_E.Step2560_Equip_Shield":373,"F_T_U_E.Step2570_Equip_Sword":374,"F_T_U_E.Step2580_Equip_Boots":375,"F_T_U_E.Step2590_Quit_Bag_Menu":376,"F_T_U_E.Step2600_Succeed_Tuto_Step_12_Equip_Items":377,"F_T_U_E.Step2700_Start_Tuto_Step_13_Defeat_Monster":378,"F_T_U_E.Step2720_Change_Map":379,"F_T_U_E.Step2750_Clic_Monster_Lupus_Minimus":380,"F_T_U_E.Step2770_Attack_Monster_Lupus_Minimus":381,"F_T_U_E.Step2800_Succed_Tuto_Step_13_Defeat_Monster":382,"F_T_U_E.Step2900_Start_Tuto_Step_14_End_Fight":383,"F_T_U_E.Step2910_Lupus_Minimus_Figh_End":384,"F_T_U_E.Step2930_Win_Fight_Monster_Lupus_Minimus":385,"F_T_U_E.Step2960_Close_Fight_Summary_Window":386,"F_T_U_E.Step3000_Succed_Tuto_Step_14_End_Fight":387,"F_T_U_E.Step3100_Start_Tuto_Step_15_End_Learning":388,"F_T_U_E.Step3130_Talk_To_NPC_Maitre_Pifo":389,"F_T_U_E.Step3160_Answer_NPC_Maitre_Pifo":390,"F_T_U_E.Step3200_Succeed_Tuto_Step_15_End_Learning":391,"fight_report.fight_end_alive_monster_description":583,"character_progression.spell_level_change":585,"social.fight_group_join":586,"social.fight_group_quit":587,"social.guild_join":588,"social.guild_quit":589,"Fight_Action.Spell_Cast_By_User":398,"Fight_Report.Fight_Start":405,"Fight_Report.Fight_End":407,"User_Life_Cycle.Level_Up":415,"User_Life_Cycle.Achievement_Achieved":416,"User_Life_Cycle.Achievement_Get_Reward":417,"User_Life_Cycle.Quest_Start":418,"User_Life_Cycle.Quest_End":419,"User_Life_Cycle.Quest_Step_Success":420,"User_Life_Cycle.Quest_Step_Objective_Success":421,"User_Life_Cycle.Profession_Level_Up":426,"User_Life_Cycle.Death":427,"Fight_Report.Fight_Character_Description":555,"Fight_Report.Fight_Monster_Description":556,"HUD.Click_on_button":413,"HUD.Display_Menu":414}},function(e,t){e.exports={"Session_Info.Login":["account_session_id","character_level"],"Session_Info.Choose_Server":["account_session_id","character_level"],"Session_Info.Choose_Character":["character_level"],"F_T_U_E.Step0000_Chose_Nickname":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0100_Chose_Server":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0200_Create_First_Character":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","used_name_generator","used_proposed_style"],"F_T_U_E.Step0300_Enter_Tuto":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step9999_Quit_Tuto":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0400_Start_Tuto_Step_1_Move":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0500_Succeed_Tuto_Step_1_Move":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0600_Start_Tuto_Step_2_Speak_To_NPC":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0630_Clic_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","message_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0660_Answer_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0700_Succeed_Tuto_Step_2_Speak_To_NPC":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0800_Start_Tuto_Step_3_Equip_Ring":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0820_Clic_Menu_Bag":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0840_Clic_Menu_Weapons":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0860_Equip_Ring":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0880_Close_Menu":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0900_Succed_Tuto_Step_3_Equip_Ring":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1000_Start_Tuto_Step_4_Change_Map":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1100_Succeed_Tuto_Step_4_Change_Map":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1200_Start_Tuto_Step_5_Start_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1230_Clic_Scarecrow":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1260_Clic_Attack":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1300_Succeed_Tuto_Step_5_Start_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1400_Start_Tuto_Step_6_Chose_Starting_Position":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1430_Clic_Desired_Position_Square":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1460_Clic_Ready_Button":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1500_Succeed_Tuto_Step_6_Chose_Starting_Position":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1600_Start_Tuto_Step_7_Move_In_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1630_Clic_Desired_Position_Square":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1660_Clic_Validate_Move":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1700_Succed_Tuto_Step_7_Move_In_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1800_Start_Tuto_Step_8_Use_Spell":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1820_Clic_Attack_Button":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1850_Select_Target":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1870_Validate_Attack":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1890_Succeed_Tuto_Step_8_Use_Spell":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1900_Start_Tuto_Step_9_End_Turn":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1950_Clic_End_Turn_Button":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2000_Succeed_Tuto_Step_9_End_Turn":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2100_Start_Tuto_Step_10_Win_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2140_Scarecrow_Figh_End":["character_level","fight_id","hard_currency_balance","map_id","nb_turns","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","winner_team_id","winner_team_life_points"],"F_T_U_E.Step2180_Close_Fight_Summary_Window":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2200_Succeed_Tuto_Step_10_Win_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2300_Start_Tuto_Step_11_Start_Quest":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2330_Talk_To_NPC_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","message_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2360_Answer_NPC_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2400_Succeed_Tuto_Step_11_Start_Quest":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2500_Start_Tuto_Step_12_Equip_Items":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2510_Clic_Bag_Menu":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2520_Clic_Weapon_Menu":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2530_Equip_Cloak":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2540_Equip_Amulet":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2550_Equip_Belt":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2560_Equip_Shield":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2570_Equip_Sword":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2580_Equip_Boots":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2590_Quit_Bag_Menu":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2600_Succeed_Tuto_Step_12_Equip_Items":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2700_Start_Tuto_Step_13_Defeat_Monster":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2720_Change_Map":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2750_Clic_Monster_Lupus_Minimus":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2770_Attack_Monster_Lupus_Minimus":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2800_Succed_Tuto_Step_13_Defeat_Monster":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2900_Start_Tuto_Step_14_End_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2910_Lupus_Minimus_Figh_End":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2930_Win_Fight_Monster_Lupus_Minimus":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2960_Close_Fight_Summary_Window":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step3000_Succed_Tuto_Step_14_End_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step3100_Start_Tuto_Step_15_End_Learning":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step3130_Talk_To_NPC_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","message_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step3160_Answer_NPC_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],
"F_T_U_E.Step3200_Succeed_Tuto_Step_15_End_Learning":["character_level","fight_id","hard_currency_balance","map_id","nb_turns","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","winner_team_id","winner_team_life_points"],"fight_report.fight_end_alive_monster_description":["character_level","fight_id","hard_currency_balance","map_id","monster_grade","monster_id","monster_level","ratio_life_remaining","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","team_id","time_spent_on_action"],"character_progression.spell_level_change":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","spell_level_after","spell_level_before","time_spent_on_action"],"social.fight_group_join":["character_level","group_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"social.fight_group_quit":["character_level","group_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"social.guild_join":["character_level","guild_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"social.guild_quit":["character_level","guild_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Fight_Action.Spell_Cast_By_User":["character_level","fight_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","spell_level","time_spent_on_action"],"Fight_Action.Spell_Confirmation":["character_level","fight_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","spell_level","spell_was_confirmed","time_spent_on_action"],"Fight_Action.Move_confirmation":["character_level","fight_id","hard_currency_balance","map_id","moved_confirmed","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Fight_Report.Fight_Start":["character_level","fight_id","fight_type","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","team_0_hp","team_1_hp","time_spent_on_action"],"Fight_Report.Fight_End":["character_level","fight_id","hard_currency_balance","map_id","nb_turns","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","winner_team_id","winner_team_life_points"],"User_Life_Cycle.Level_Up":["character_level","hard_currency_balance","map_id","old_level","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Achievement_Achieved":["achievement_id","character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Achievement_Get_Reward":["achievement_id","character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Quest_Start":["character_level","hard_currency_balance","map_id","quest_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Quest_End":["character_level","hard_currency_balance","map_id","quest_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Quest_Step_Success":["character_level","hard_currency_balance","map_id","quest_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","step_id","time_spent_on_action"],"User_Life_Cycle.Quest_Step_Objective_Success":["character_level","hard_currency_balance","map_id","objective_id","quest_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","step_id","time_spent_on_action"],"User_Life_Cycle.Profession_Level_Up":["character_level","hard_currency_balance","job_id","map_id","new_level","old_level","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Death":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Fight_Report.Fight_Character_Description":["amu_id","belt_id","boots_id","character_level","cloack_id","comp_id","fight_id","hard_currency_balance","hat_id","is_incarnation","map_id","pet_id","relative_hard_currency_gained","relative_soft_currency_gained","ride_id","ringl_id","ringr_id","shield_id","soft_currency_balance","team_id","time_spent_on_action","weapon_id"],"Fight_Report.Fight_Monster_Description":["character_level","fight_id","hard_currency_balance","map_id","monster_grade","monster_id","monster_level","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","team_id","time_spent_on_action"],"Game_Action.Arrives_On_Map":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Virtual_Economy.Receive_Item":["character_level","context","context_id","hard_currency_balance","item_id","map_id","quantity","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Virtual_Economy.Dispose_Item":["character_level","context","context_id","hard_currency_balance","item_id","map_id","quantity","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"fight_action.spell_cast_by_monster":["character_level","fight_id","hard_currency_balance","map_id","monster_grade","monster_id","monster_level","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","spell_level","time_spent_on_action"],"fight_action.damage_ally":["ally_is_killed","character_level","fight_id","hard_currency_balance","life_points_removed_count","life_points_removed_percentage","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","target_character_id","target_monster_id","time_spent_on_action"],"fight_action.heal_ennemy":["character_level","fight_id","hard_currency_balance","life_points_given_count","life_points_given_percentage","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","target_character_id","target_monster_id","time_spent_on_action"],"user_life_cycle.xp_gained":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","xp"],"Game_Action.Travel":["character_level","destination_map_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","travel_method_category","travel_method_id"],"Game_Action.Talk_To_NPC":["answer_id","character_level","hard_currency_balance","map_id","message_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Game_Action.Player_Answer_To_NPC":["answer_id","character_level","hard_currency_balance","map_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Game_Action.Mode_Marchant_On":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Game_Action.Memorize_New_Zaap":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","zaap_id"],"Game_Action.Use_Scenery_Object":["character_level","element_uid","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Character_Progression.Caracteristic_Level_Up":["character_level","characteristic_id","characteristic_initial","characteristic_new","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Character_Progression.Caracteristic_Reset":["character_level","characteristic_name","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Character_Progression.New_Spell_Unlocked":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","time_spent_on_action"],"Character_Progression.Incarnation_Level_Up":["character_level","hard_currency_balance","incarnation_id","incarnation_new_level","incarnation_old_level","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"HUD.Click_on_button":["button_id","character_level","clic_parameter_key","clic_parameter_value","clic_type","hard_currency_balance","interface_id","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"HUD.Display_Menu":["character_level","hard_currency_balance","interface_id","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Virtual_Economy.Use_Bank_Account":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"]}},function(e,t){e.exports={300:"http://localhost:8888/forward",401:"https://analytics-north-virginia.touch.dofus.com/forward",402:"https://analytics-north-virginia.touch.dofus.com/forward",407:"https://analytics-north-virginia.touch.dofus.com/forward",403:"https://analytics-ireland.touch.dofus.com/forward",404:"https://analytics-ireland.touch.dofus.com/forward",405:"https://analytics-ireland.touch.dofus.com/forward",406:"https://analytics-ireland.touch.dofus.com/forward",408:"https://analytics-ireland.touch.dofus.com/forward",409:"https://analytics-ireland.touch.dofus.com/forward",410:"https://analytics-ireland.touch.dofus.com/forward",900:"https://analytics-ireland.touch.dofus.com/forward"}},function(e,t,i){function n(e,t,i){var n;return 204!==~~t&&(n="analytics.request: event "+e+", xhrError: "+t+" for url: "+i),n}var o=i(24);e.exports=function(e,t,i,s){if(!e)return s(new Error("analytics.request: url is empty"));t=t||{};var a=t.event_id,r=new XMLHttpRequest;r.timeout=5e3;var l=o.operation({retries:4,randomize:!0});r.onreadystatechange=function(){if(4===~~r.readyState){var t=n(a,r.status,e);return l.retry(t)?void console.warn("analytics.request failed event",a,"on the url",e,"will retry..."):t?s(l.mainError()):void s()}},l.attempt(function(){r.open("POST",e,!0),r.setRequestHeader("x-version",i),r.setRequestHeader("Content-type","application/json"),r.send(JSON.stringify(t))})}},function(e,t,i){e.exports=i(25)},function(e,t,i){var n=i(26);t.operation=function(e){var i=t.timeouts(e);return new n(i,{forever:e&&e.forever,unref:e&&e.unref})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var i in e)t[i]=e[i];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],o=0;o<t.retries;o++)n.push(this.createTimeout(o,t));return n.sort(function(e,t){return e-t}),n},t.createTimeout=function(e,t){var i=t.randomize?Math.random()+1:1,n=Math.round(i*t.minTimeout*Math.pow(t.factor,e));return n=Math.min(n,t.maxTimeout)},t.wrap=function(e,i,n){if(i instanceof Array&&(n=i,i=null),!n){n=[];for(var o in e)"function"==typeof e[o]&&n.push(o)}for(var s=0;s<n.length;s++){var a=n[s],r=e[a];e[a]=function(){var n=t.operation(i),o=Array.prototype.slice.call(arguments),s=o.pop();o.push(function(e){n.retry(e)||(e&&(arguments[0]=n.mainError()),s.apply(this,arguments))}),n.attempt(function(){r.apply(e,o)})},e[a].options=i}}},function(e,t){function i(e,t){"boolean"==typeof t&&(t={forever:t}),this._timeouts=e,this._options=t||{},this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=i,i.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;this._errors.push(e);var t=this._timeouts.shift();if(void 0===t){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),t=this._timeouts.shift()}var i=this,n=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),this._options.unref&&i._timeout.unref()),i._fn(i._attempts)},t);return this._options.unref&&n.unref(),!0},i.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var i=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){i._operationTimeoutCb()},i._operationTimeout)),this._fn(this._attempts)},i.prototype["try"]=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},i.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},i.prototype.start=i.prototype["try"],i.prototype.errors=function(){return this._errors},i.prototype.attempts=function(){return this._attempts},i.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,i=0,n=0;n<this._errors.length;n++){var o=this._errors[n],s=o.message,a=(e[s]||0)+1;e[s]=a,a>=i&&(t=o,i=a)}return t}},function(e,t,i){var n;!function(o){"use strict";function s(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}function a(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var i=new Date(t.getFullYear(),0,4);i.setDate(i.getDate()-(i.getDay()+6)%7+3);var n=t.getTimezoneOffset()-i.getTimezoneOffset();t.setHours(t.getHours()-n);var o=(t-i)/6048e5;return 1+Math.floor(o)}function r(e){var t=e.getDay();return 0===t&&(t=7),t}function l(e){return null===e?"null":void 0===e?"undefined":"object"!=typeof e?typeof e:Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}var c=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|'[^']*'|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g;return function(n,o,d,u){if(1!==arguments.length||"string"!==l(n)||/\d/.test(n)||(o=n,n=void 0),n=n||new Date,n instanceof Date||(n=new Date(n)),isNaN(n))throw TypeError("Invalid date");o=String(c.masks[o]||o||c.masks["default"]);var h=o.slice(0,4);"UTC:"!==h&&"GMT:"!==h||(o=o.slice(4),d=!0,"GMT:"===h&&(u=!0));var p=d?"getUTC":"get",m=n[p+"Date"](),f=n[p+"Day"](),g=n[p+"Month"](),_=n[p+"FullYear"](),v=n[p+"Hours"](),y=n[p+"Minutes"](),b=n[p+"Seconds"](),M=n[p+"Milliseconds"](),w=d?0:n.getTimezoneOffset(),T=a(n),C=r(n),A={d:m,dd:s(m),ddd:c.i18n.dayNames[f],dddd:c.i18n.dayNames[f+7],m:g+1,mm:s(g+1),mmm:c.i18n.monthNames[g],mmmm:c.i18n.monthNames[g+12],yy:String(_).slice(2),yyyy:_,h:v%12||12,hh:s(v%12||12),H:v,HH:s(v),M:y,MM:s(y),s:b,ss:s(b),l:s(M,3),L:s(Math.round(M/10)),t:v<12?"a":"p",tt:v<12?"am":"pm",T:v<12?"A":"P",TT:v<12?"AM":"PM",Z:u?"GMT":d?"UTC":(String(n).match(t)||[""]).pop().replace(i,""),o:(w>0?"-":"+")+s(100*Math.floor(Math.abs(w)/60)+Math.abs(w)%60,4),S:["th","st","nd","rd"][m%10>3?0:(m%100-m%10!=10)*m%10],W:T,N:C};return o.replace(e,function(e){return e in A?A[e]:e.slice(1,e.length-1)})}}();c.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},c.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},n=function(){return c}.call(t,i,t,e),!(void 0!==n&&(e.exports=n))}(this)},function(e,t,i){function n(e){return("0"+e).slice(-2)}function o(e){this.timestamp=e}var s=i(29).getText;t.time={serverTimeLag:0,serverUtcTimeLag:0,timezoneOffset:0,dofusTimeYearLag:-1370},t.getDateNow=function(){return Date.now()},t.leadWithZero=n,t.initialize=function(e){e.on("BasicTimeMessage",function(e){var i=t.getDateNow(),n=t.time;n.serverTimeLag=1e3*(e.timestamp+60*e.timezoneOffset)-i,n.serverUtcTimeLag=1e3*e.timestamp-i,n.timezoneOffset=60*e.timezoneOffset*1e3})},t.now=function(){return t.getDateNow()+t.time.serverUtcTimeLag},t.DofusDate=o,o.prototype.getLocalDate=function(e){var i=new Date(1e3*this.timestamp);return this.dofusDate=e,this.date=i,this.year=i.getFullYear()+(e?t.time.dofusTimeYearLag:0),this.month=i.getMonth(),this.day=i.getDate(),this.hour=i.getHours(),this.minute=i.getMinutes(),this},o.prototype.getServerDate=function(e){var i=new Date(1e3*this.timestamp+t.time.timezoneOffset);return this.dofusDate=e,this.date=i,this.year=i.getUTCFullYear()+(e?t.time.dofusTimeYearLag:0),this.month=i.getUTCMonth(),this.day=i.getUTCDate(),this.hour=i.getUTCHours(),this.minute=i.getUTCMinutes(),this},o.prototype.toString=function(e){if(!this.date)return{};var i=!this.dofusDate&&e,o=this.year+(i?t.time.dofusTimeYearLag:0),a=n(this.day),r=n(this.month+1),l=n(this.hour),c=n(this.minute);return{date:s("ui.time.dateNumbers",a,r,o),time:l+":"+c,year:o,month:r,monthName:window.gui.databases.Months[this.month].nameId,day:a,hour:l,minute:c}}},function(e,t,i){function n(e,t,i){for(var n=void 0!==i?i:t[1],o="",s=0,a=e.length;s<a;s++){var r=e[s];if("%"===r||"#"===r){var l=parseInt(e[s+1],10);if(!isNaN(l)){var c=t[l];void 0===i&&(n=c),void 0!==c&&null!==c&&(o+=c),s++;continue}}if("{"===r||"("===r){var d=e.indexOf("{"===r?"}":")",s);if(d!==-1&&"~"===e[s+1]){var u=!1;switch(e[s+2]){case"p":u=1!==n&&"1"!==n;break;//!=1 is gramatically correct and similar to Ankama's code
case"s":u=1===n||"1"===n;break;case"m":u=0===n;break;case"f":u=0!==n;break;case"1":"~"===e[s+3]&&"2"===e[s+4]&&(u=void 0!==t[1]&&null!==t[1]&&void 0!==t[2]&&null!==t[2],s+=2);break;default:console.error("Found unknown marker in:",e)}u&&(o+=e.substring(s+3,d)),s=d;continue}}o+=r}return o}function o(e,t){return d?a+"["+e+"]":void 0===t[1]?e:n(e,t)}var s=i(30),a="en",r="en",l=null,c=null,d=!1;t.initialize=function(e,t){return l&&a===e.language&&d===e.chaseText?t():(a=e.language,d=e.chaseText,r=e.failoverLanguage||r,void s.getDictionary(r,function(e,i){return e?t(e):(c=i,void s.getDictionary(a,function(e,i){return e?t(e):(l=i,void t())}))}))},t.initializeStatic=function(e,t){a=e,l=t},t.findText=function(e){return d?a+"["+e+"]":e},t.getText=function(e){var t=l[e];if(!t){if(console.warn("getText: no getText was found for",e,"in",a),!c[e])return console.error("getText: no failover getText was found for",e,"in",r),a+"[?"+e+"]";t=c[e]}return o(t,arguments)},t.getTextFailover=function(e){var t=c[e];return t?o(t,arguments):(console.error("getTextFailover: no failover getText was found for",e,"in",r),a+"[?"+e+"]")},t.processText=function(e){return n(e,arguments)},t.processTextWithModifier=function(e,t){return n(e,Array.prototype.slice.call(arguments,1),t)}},function(e,t,i){function n(e){p.initialize(_+h.cacheDatabaseSuffix,h,e)}function o(e,t,i){return m(g,"/data/"+e,t,_,i)}function s(e,t){for(var i=Object.keys(e),n=i.length,o=new Array(n),s=0;s<n;s++)o[s]=e[i[s]];if(t&&t.sortBy){var a=t.sortBy;o.sort(function(e,t){return e[a]-t[a]})}return o}function a(e,t,i){var n=[];for(var o in e)n.push(e[o]);if(i){var s=h.getKey(t);n.sort(function(e,t){return e[s]-t[s]})}return n}function r(e,t){p.requestAll(e,function(i,n){return i?t(i):n?t(null,n):o("map",{"class":e},function(i,n){if(i)return t(i);var o,s=h.getKey(e);for(var a in n){o=n[a]&&void 0!==n[a][s];break}return o?p.putAll(e,n,function(e){e&&console.warn("_getAllDataMap putAll: Caching data on disk failed with error: "+e)}):console.warn("Request to cache table "+e+' which has no "'+s+'" key; table will not be cached.'),t(null,n)})})}function l(e,t){var i={};u.eachLimit(e,5,function(e,t){return r(e,function(n,o){return n?t(n):(i[e]=o,t())})},function(e){return e?t(e):t(null,i)})}function c(e,t,i){r(e,function(n,o){return n?i(n):i(null,a(o,e,t))})}function d(e,t,i){var n={};u.eachLimit(e,5,function(e,i){return c(e,t,function(t,o){return t?i(t):(n[e]=o,i())})},function(e){return e?i(e):i(null,n)})}var u=i(31),h=i(34),p=i(35),m=i(37),f=p.DUMMY_RECORD_FLAG,g=null,_=null;t.initialize=function(e){g=e.dataUrl},t.initializeDiskCache=n,t.eraseDiskCache=function(e){var t=["en","fr","es","it","de","pt"];u.eachSeries(t,function(e,t){return p["delete"](e+h.cacheDatabaseSuffix,t)},e)},t.changeLanguage=function(e){_=e},t.getDictionary=function(e,t){o("dictionary",{lang:e},function(i,o){return i?t(i):(_=e,void n(function(){t(null,o)}))})},t.getText=function(e,t){var i={};Array.isArray(e)?i.ids=e:i.id=e,o("text",i,function(e,i){return e?t(e):void t(null,i)})},t.getDataMap=function(e,t,i){return Array.isArray(t)?void p.request(e,t,function(t,n,s){if(t)return i(t);var a={};for(var r in n)n[r][f]||(a[r]=n[r]);if(0===s.length)return i(null,a);var l={"class":e,ids:s};o("map",l,function(t,n){if(t)return i(t);for(var o=0,r=s.length;o<r;o++){var l=s[o],c=n[l];c?a[l]=c:n[l]=p.newDummyRecord(h.getKey(e),l)}return p.put(e,n,function(e){e&&console.warn("getDataMap put: Caching data on disk failed with error:",e)}),i(null,a)})}):i(new TypeError("Data ids should be passed as an array"))},t.getDataArray=function(e,i,n,o){"function"==typeof n&&(o=n,n=null),t.getDataMap(e,i,function(e,t){return e?o(e):void o(null,s(t,n))})},t.searchDataMap=function(e,t,i){var n={"class":e,match:t.match,matchProp:t.matchProp};o("map",n,function(t,n){return t?i(t):(p.put(e,n,function(e){e&&console.warn("searchDataMap put: Caching search results on disk failed with error: "+e)}),i(null,n))})},t.getObject=function(e,i,n){return i||0===i?void t.getDataMap(e,[i],function(e,t){return e?n(e):n(null,t[i])}):n(new Error("You must pass an ID"))},t.getData=function(e,i,n){return Array.isArray(i)?t.getDataArray(e,i,null,n):void t.getObject(e,i,n)},t.getAllDataTable=function(e,t){return Array.isArray(e)?d(e,!0,t):c(e,!0,t)},t.getAllDataBulk=function(e,t){return Array.isArray(e)?d(e,!1,t):c(e,!1,t)},t.getAllDataMap=function(e,t){return Array.isArray(e)?l(e,t):r(e,t)}},function(e,t,i){var n,o;(function(i,s,a){/*!
	 * async
	 * https://github.com/caolan/async
	 *
	 * Copyright 2010-2014 Caolan McMahon
	 * Released under the MIT license
	 */
!function(){function r(){}function l(e){return e}function c(e){return!!e}function d(e){return!e}function u(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function h(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}function p(e){return U(e)||"number"==typeof e.length&&e.length>=0&&e.length%1===0}function m(e,t){for(var i=-1,n=e.length;++i<n;)t(e[i],i,e)}function f(e,t){for(var i=-1,n=e.length,o=Array(n);++i<n;)o[i]=t(e[i],i,e);return o}function g(e){return f(Array(e),function(e,t){return t})}function _(e,t,i){return m(e,function(e,n,o){i=t(i,e,n,o)}),i}function v(e,t){m(j(e),function(i){t(e[i],i)})}function y(e,t){for(var i=0;i<e.length;i++)if(e[i]===t)return i;return-1}function b(e){var t,i,n=-1;return p(e)?(t=e.length,function(){return n++,n<t?n:null}):(i=j(e),t=i.length,function(){return n++,n<t?i[n]:null})}function M(e,t){return t=null==t?e.length-1:+t,function(){for(var i=Math.max(arguments.length-t,0),n=Array(i),o=0;o<i;o++)n[o]=arguments[o+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n)}}}function w(e){return function(t,i,n){return e(t,n)}}function T(e){return function(t,i,n){n=h(n||r),t=t||[];var o=b(t);if(e<=0)return n(null);var s=!1,a=0,l=!1;!function c(){if(s&&a<=0)return n(null);for(;a<e&&!l;){var r=o();if(null===r)return s=!0,void(a<=0&&n(null));a+=1,i(t[r],r,u(function(e){a-=1,e?(n(e),l=!0):c()}))}}()}}function C(e){return function(t,i,n){return e(H.eachOf,t,i,n)}}function A(e){return function(t,i,n,o){return e(T(i),t,n,o)}}function I(e){return function(t,i,n){return e(H.eachOfSeries,t,i,n)}}function S(e,t,i,n){n=h(n||r),t=t||[];var o=p(t)?[]:{};e(t,function(e,t,n){i(e,function(e,i){o[t]=i,n(e)})},function(e){n(e,o)})}function E(e,t,i,n){var o=[];e(t,function(e,t,n){i(e,function(i){i&&o.push({index:t,value:e}),n()})},function(){n(f(o.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function x(e,t,i,n){E(e,t,function(e,t){i(e,function(e){t(!e)})},n)}function N(e,t,i){return function(n,o,s,a){function r(){a&&a(i(!1,void 0))}function l(e,n,o){return a?void s(e,function(n){a&&t(n)&&(a(i(!0,e)),a=s=!1),o()}):o()}arguments.length>3?e(n,o,l,r):(a=s,s=o,e(n,l,r))}}function L(e,t){return t}function O(e,t,i){i=i||r;var n=p(t)?[]:{};e(t,function(e,t,i){e(M(function(e,o){o.length<=1&&(o=o[0]),n[t]=o,i(e)}))},function(e){i(e,n)})}function D(e,t,i,n){var o=[];e(t,function(e,t,n){i(e,function(e,t){o=o.concat(t||[]),n(e)})},function(e){n(e,o)})}function R(e,t,i){function n(e,t,i,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");return e.started=!0,U(t)||(t=[t]),0===t.length&&e.idle()?H.setImmediate(function(){e.drain()}):(m(t,function(t){var o={data:t,callback:n||r};i?e.tasks.unshift(o):e.tasks.push(o),e.tasks.length===e.concurrency&&e.saturated()}),void H.setImmediate(e.process))}function o(e,t){return function(){s-=1;var i=!1,n=arguments;m(t,function(e){m(a,function(t,n){t!==e||i||(a.splice(n,1),i=!0)}),e.callback.apply(e,n)}),e.tasks.length+s===0&&e.drain(),e.process()}}if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var s=0,a=[],l={tasks:[],concurrency:t,payload:i,saturated:r,empty:r,drain:r,started:!1,paused:!1,push:function(e,t){n(l,e,!1,t)},kill:function(){l.drain=r,l.tasks=[]},unshift:function(e,t){n(l,e,!0,t)},process:function(){if(!l.paused&&s<l.concurrency&&l.tasks.length)for(;s<l.concurrency&&l.tasks.length;){var t=l.payload?l.tasks.splice(0,l.payload):l.tasks.splice(0,l.tasks.length),i=f(t,function(e){return e.data});0===l.tasks.length&&l.empty(),s+=1,a.push(t[0]);var n=u(o(l,t));e(i,n)}},length:function(){return l.tasks.length},running:function(){return s},workersList:function(){return a},idle:function(){return l.tasks.length+s===0},pause:function(){l.paused=!0},resume:function(){if(l.paused!==!1){l.paused=!1;for(var e=Math.min(l.concurrency,l.tasks.length),t=1;t<=e;t++)H.setImmediate(l.process)}}};return l}function P(e){return M(function(t,i){t.apply(null,i.concat([M(function(t,i){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&m(i,function(t){console[e](t)}))})]))})}function B(e){return function(t,i,n){e(g(t),i,n)}}function k(e){return M(function(t,i){var n=M(function(i){var n=this,o=i.pop();return e(t,function(e,t,o){e.apply(n,i.concat([o]))},o)});return i.length?n.apply(this,i):n})}function z(e){return M(function(t){var i=t.pop();t.push(function(){var e=arguments;n?H.setImmediate(function(){i.apply(null,e)}):i.apply(null,e)});var n=!0;e.apply(this,t),n=!1})}var F,H={},q="object"==typeof self&&self.self===self&&self||"object"==typeof i&&i.global===i&&i||this;null!=q&&(F=q.async),H.noConflict=function(){return q.async=F,H};var W=Object.prototype.toString,U=Array.isArray||function(e){return"[object Array]"===W.call(e)},G=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},j=Object.keys||function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t},Y="function"==typeof s&&s,V=Y?function(e){Y(e)}:function(e){setTimeout(e,0)};"object"==typeof a&&"function"==typeof a.nextTick?H.nextTick=a.nextTick:H.nextTick=V,H.setImmediate=Y?V:H.nextTick,H.forEach=H.each=function(e,t,i){return H.eachOf(e,w(t),i)},H.forEachSeries=H.eachSeries=function(e,t,i){return H.eachOfSeries(e,w(t),i)},H.forEachLimit=H.eachLimit=function(e,t,i,n){return T(t)(e,w(i),n)},H.forEachOf=H.eachOf=function(e,t,i){function n(e){a--,e?i(e):null===o&&a<=0&&i(null)}i=h(i||r),e=e||[];for(var o,s=b(e),a=0;null!=(o=s());)a+=1,t(e[o],o,u(n));0===a&&i(null)},H.forEachOfSeries=H.eachOfSeries=function(e,t,i){function n(){var a=!0;return null===s?i(null):(t(e[s],s,u(function(e){if(e)i(e);else{if(s=o(),null===s)return i(null);a?H.setImmediate(n):n()}})),void(a=!1))}i=h(i||r),e=e||[];var o=b(e),s=o();n()},H.forEachOfLimit=H.eachOfLimit=function(e,t,i,n){T(t)(e,i,n)},H.map=C(S),H.mapSeries=I(S),H.mapLimit=A(S),H.inject=H.foldl=H.reduce=function(e,t,i,n){H.eachOfSeries(e,function(e,n,o){i(t,e,function(e,i){t=i,o(e)})},function(e){n(e,t)})},H.foldr=H.reduceRight=function(e,t,i,n){var o=f(e,l).reverse();H.reduce(o,t,i,n)},H.transform=function(e,t,i,n){3===arguments.length&&(n=i,i=t,t=U(e)?[]:{}),H.eachOf(e,function(e,n,o){i(t,e,n,o)},function(e){n(e,t)})},H.select=H.filter=C(E),H.selectLimit=H.filterLimit=A(E),H.selectSeries=H.filterSeries=I(E),H.reject=C(x),H.rejectLimit=A(x),H.rejectSeries=I(x),H.any=H.some=N(H.eachOf,c,l),H.someLimit=N(H.eachOfLimit,c,l),H.all=H.every=N(H.eachOf,d,d),H.everyLimit=N(H.eachOfLimit,d,d),H.detect=N(H.eachOf,l,L),H.detectSeries=N(H.eachOfSeries,l,L),H.detectLimit=N(H.eachOfLimit,l,L),H.sortBy=function(e,t,i){function n(e,t){var i=e.criteria,n=t.criteria;return i<n?-1:i>n?1:0}H.map(e,function(e,i){t(e,function(t,n){t?i(t):i(null,{value:e,criteria:n})})},function(e,t){return e?i(e):void i(null,f(t.sort(n),function(e){return e.value}))})},H.auto=function(e,t,i){function n(e){u.unshift(e)}function o(e){var t=y(u,e);t>=0&&u.splice(t,1)}function s(){l--,m(u.slice(0),function(e){e()})}i||(i=t,t=null),i=h(i||r);var a=j(e),l=a.length;if(!l)return i(null);t||(t=l);var c={},d=0,u=[];n(function(){l||i(null,c)}),m(a,function(a){function r(){return d<t&&_(m,function(e,t){return e&&c.hasOwnProperty(t)},!0)&&!c.hasOwnProperty(a)}function l(){r()&&(d++,o(l),h[h.length-1](p,c))}for(var u,h=U(e[a])?e[a]:[e[a]],p=M(function(e,t){if(d--,t.length<=1&&(t=t[0]),e){var n={};v(c,function(e,t){n[t]=e}),n[a]=t,i(e,n)}else c[a]=t,H.setImmediate(s)}),m=h.slice(0,h.length-1),f=m.length;f--;){if(!(u=e[m[f]]))throw new Error("Has inexistant dependency");if(U(u)&&y(u,a)>=0)throw new Error("Has cyclic dependencies")}r()?(d++,h[h.length-1](p,c)):n(l)})},H.retry=function(e,t,i){function n(e,t){if("number"==typeof t)e.times=parseInt(t,10)||s;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||s,e.interval=parseInt(t.interval,10)||a}}function o(e,t){function i(e,i){return function(n){e(function(e,t){n(!e||i,{err:e,result:t})},t)}}function n(e){return function(t){setTimeout(function(){t(null)},e)}}for(;l.times;){var o=!(l.times-=1);r.push(i(l.task,o)),!o&&l.interval>0&&r.push(n(l.interval))}H.series(r,function(t,i){i=i[i.length-1],(e||l.callback)(i.err,i.result)})}var s=5,a=0,r=[],l={times:s,interval:a},c=arguments.length;if(c<1||c>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return c<=2&&"function"==typeof e&&(i=t,t=e),"function"!=typeof e&&n(l,e),l.callback=i,l.task=t,l.callback?o():o},H.waterfall=function(e,t){function i(e){return M(function(n,o){if(n)t.apply(null,[n].concat(o));else{var s=e.next();s?o.push(i(s)):o.push(t),z(e).apply(null,o)}})}if(t=h(t||r),!U(e)){var n=new Error("First argument to waterfall must be an array of functions");return t(n)}return e.length?void i(H.iterator(e))():t()},H.parallel=function(e,t){O(H.eachOf,e,t)},H.parallelLimit=function(e,t,i){O(T(t),e,i)},H.series=function(e,t){O(H.eachOfSeries,e,t)},H.iterator=function(e){function t(i){function n(){return e.length&&e[i].apply(null,arguments),n.next()}return n.next=function(){return i<e.length-1?t(i+1):null},n}return t(0)},H.apply=M(function(e,t){return M(function(i){return e.apply(null,t.concat(i))})}),H.concat=C(D),H.concatSeries=I(D),H.whilst=function(e,t,i){if(i=i||r,e()){var n=M(function(o,s){o?i(o):e.apply(this,s)?t(n):i(null)});t(n)}else i(null)},H.doWhilst=function(e,t,i){var n=0;return H.whilst(function(){return++n<=1||t.apply(this,arguments)},e,i)},H.until=function(e,t,i){return H.whilst(function(){return!e.apply(this,arguments)},t,i)},H.doUntil=function(e,t,i){return H.doWhilst(e,function(){return!t.apply(this,arguments)},i)},H.during=function(e,t,i){i=i||r;var n=M(function(t,n){t?i(t):(n.push(o),e.apply(this,n))}),o=function(e,o){e?i(e):o?t(n):i(null)};e(o)},H.doDuring=function(e,t,i){var n=0;H.during(function(e){n++<1?e(null,!0):t.apply(this,arguments)},e,i)},H.queue=function(e,t){var i=R(function(t,i){e(t[0],i)},t,1);return i},H.priorityQueue=function(e,t){function i(e,t){return e.priority-t.priority}function n(e,t,i){for(var n=-1,o=e.length-1;n<o;){var s=n+(o-n+1>>>1);i(t,e[s])>=0?n=s:o=s-1}return n}function o(e,t,o,s){if(null!=s&&"function"!=typeof s)throw new Error("task callback must be a function");return e.started=!0,U(t)||(t=[t]),0===t.length?H.setImmediate(function(){e.drain()}):void m(t,function(t){var a={data:t,priority:o,callback:"function"==typeof s?s:r};e.tasks.splice(n(e.tasks,a,i)+1,0,a),e.tasks.length===e.concurrency&&e.saturated(),H.setImmediate(e.process)})}var s=H.queue(e,t);return s.push=function(e,t,i){o(s,e,t,i)},delete s.unshift,s},H.cargo=function(e,t){return R(e,1,t)},H.log=P("log"),H.dir=P("dir"),H.memoize=function(e,t){var i={},n={};t=t||l;var o=M(function(o){var s=o.pop(),a=t.apply(null,o);a in i?H.setImmediate(function(){s.apply(null,i[a])}):a in n?n[a].push(s):(n[a]=[s],e.apply(null,o.concat([M(function(e){i[a]=e;var t=n[a];delete n[a];for(var o=0,s=t.length;o<s;o++)t[o].apply(null,e)})])))});return o.memo=i,o.unmemoized=e,o},H.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},H.times=B(H.map),H.timesSeries=B(H.mapSeries),H.timesLimit=function(e,t,i,n){return H.mapLimit(g(e),t,i,n)},H.seq=function(){var e=arguments;return M(function(t){var i=this,n=t[t.length-1];"function"==typeof n?t.pop():n=r,H.reduce(e,t,function(e,t,n){t.apply(i,e.concat([M(function(e,t){n(e,t)})]))},function(e,t){n.apply(i,[e].concat(t))})})},H.compose=function(){return H.seq.apply(null,Array.prototype.reverse.call(arguments))},H.applyEach=k(H.eachOf),H.applyEachSeries=k(H.eachOfSeries),H.forever=function(e,t){function i(e){return e?n(e):void o(i)}var n=u(t||r),o=z(e);i()},H.ensureAsync=z,H.constant=M(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),H.wrapSync=H.asyncify=function(e){return M(function(t){var i,n=t.pop();try{i=e.apply(this,t)}catch(o){return n(o)}G(i)&&"function"==typeof i.then?i.then(function(e){n(null,e)})["catch"](function(e){n(e.message?e:new Error(e))}):n(null,i)})},"object"==typeof e&&e.exports?e.exports=H:(n=[],o=function(){return H}.apply(t,n),!(void 0!==o&&(e.exports=o)))}()}).call(t,function(){return this}(),i(32).setImmediate,i(33))},function(e,t,i){(function(e,n){function o(e,t){this._id=e,this._clearFn=t}var s=i(33).nextTick,a=Function.prototype.apply,r=Array.prototype.slice,l={},c=0;t.setTimeout=function(){return new o(a.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(a.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var i=c++,n=!(arguments.length<2)&&r.call(arguments,1);return l[i]=!0,s(function(){l[i]&&(n?e.apply(null,n):e.call(null),t.clearImmediate(i))}),i},t.clearImmediate="function"==typeof n?n:function(e){delete l[e]}}).call(t,i(32).setImmediate,i(32).clearImmediate)},function(e,t){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(d===setTimeout)return setTimeout(e,0);if((d===i||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function s(e){if(u===clearTimeout)return clearTimeout(e);if((u===n||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(e);try{return u(e)}catch(t){try{return u.call(null,e)}catch(t){return u.call(this,e)}}}function a(){f&&p&&(f=!1,p.length?m=p.concat(m):g=-1,m.length&&r())}function r(){if(!f){var e=o(a);f=!0;for(var t=m.length;t;){for(p=m,m=[];++g<t;)p&&p[g].run();g=-1,t=m.length}p=null,f=!1,s(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var d,u,h=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:i}catch(e){d=i}try{u="function"==typeof clearTimeout?clearTimeout:n}catch(e){u=n}}();var p,m=[],f=!1,g=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];m.push(new l(e,t)),1!==m.length||f||o(r)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=c,h.addListener=c,h.once=c,h.off=c,h.removeListener=c,h.removeAllListeners=c,h.emit=c,h.prependListener=c,h.prependOnceListener=c,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t){e.exports.cacheDatabaseSuffix="DataCache";var i="isCacheComplete";e.exports.cacheCompletion=i,e.exports.typeNames=["AbuseReasons","AchievementCategories","AchievementObjectives","AchievementRewards","Achievements","ActionDescriptions","AlignmentBalance","AlignmentEffect","AlignmentGift","AlignmentOrder","AlignmentRank","AlignmentRankJntGift","AlignmentSides","AlignmentTitles","AlmanaxCalendars","Appearances","Areas","BidHouseCategories","Breeds","CensoredContents","CensoredWords","Challenge","ChatChannels","CompanionCharacteristics","Companions","CompanionSpells","CreatureBonesOverrides","CreatureBonesTypes","Documents","Dungeons","Effects","EmblemBackgrounds","EmblemSymbolCategories","EmblemSymbols","Emoticons","ExternalNotifications","Heads","HintCategory","Hints","Houses","Incarnation","IncarnationLevels","InfoMessages","Interactives","Items","ItemSets","ItemTypes","Jobs","LegendaryTreasureHunts","LivingObjectSkinJntMood","MapCoordinates","MapPositions","MapReferences","MapScrollActions","MonsterMiniBoss","MonsterRaces","Monsters","MonsterSuperRaces","Months","MountBehaviors","MountBones","Mounts","Notifications","NpcActions","NpcMessages","Npcs","OptionalFeatures","Ornaments","Pack","Pets","Phoenixes","PointOfInterest","PointOfInterestCategory","PresetIcons","QuestCategory","QuestObjectives","QuestObjectiveTypes","Quests","QuestStepRewards","QuestSteps","RankNames","Recipes","RideFood","ServerCommunities","ServerGameTypes","ServerPopulations","Servers","SkillNames","Skills","SkinMappings","SkinPositions","Smileys","SoundBones","SoundUi","SoundUiHook","SpeakingItemsText","SpeakingItemsTriggers","SpellBombs","SpellLevels","SpellPairs","Spells","SpellStates","SpellTypes","StealthBones","SubAreas","SubAreaIdPerCoordinate","SubAreasWorldMapData","SuperAreas","TaxCollectorFirstnames","TaxCollectorNames","Tips","TitleCategories","Titles","TypeActions","Url","Waypoints","WorldMaps"];var n={AbuseReasons:"_abuseReasonId",AlignmentTitles:"sideId",CreatureBonesOverrides:"creatureBoneId",Houses:"typeId",InfoMessages:"messageId",LivingObjectSkinJntMood:"skinId",MapCoordinates:"compressedCoords",Phoenixes:"mapId",Recipes:"resultId",SpeakingItemsText:"textId",SpeakingItemsTriggers:"triggersId"};e.exports.getKey=function(e){return n[e]||"id"};var o={};o[i]=!0,e.exports.hasStringId=function(e){return o[e]||!1}},function(e,t,i){function n(e){return"string"==typeof e?e:e.toString()}function o(e){if("number"==typeof e)return e;var t=parseInt(e,10);return isNaN(t)?null:t}function s(e){return h.hasStringId(e)?n:o}function a(e){function t(t){var i=h.getKey(t),n=e.createObjectStore(t,{keyPath:i}),o=n.transaction;o.oncomplete=function(){},o.onabort=function(){console.error(new Error("Object store creation aborted for:"+t+", with error:"+o.error))},o.onerror=function(){console.error(new Error("Object store creation failed for:"+t+", with error:"+o.error))}}for(var i=h.typeNames,n=0,o=i.length;n<o;++n)t(i[n]);h.cacheCompletion&&t(h.cacheCompletion)}function r(e,t,i){function n(t){if(void 0===t||null===t)return void console.error(new Error("IndexedDB id to get in object store: "+e+", is invalid: "+t));if(t=c(t),null===t)return void console.error(new Error("IndexedDB id to get in object store: "+e+", is invalid: "+t));var i=l.get(t);i.onsuccess=function(e){e.target.result?o[t]=e.target.result:a.push(t)},i.onerror=function(i){console.error("Requesting id:",t+", in store:",e+", failed with error:",i.target.errorCode),a.push(t)}}var o={},a=[];if(!t.length)return i(null,o,a);for(var r=u.transaction(e,m.READ_ONLY),l=r.objectStore(e),c=s(e),d=0,h=t.length;d<h;++d)n(t[d]);r.oncomplete=function(){i(null,o,a)},r.onabort=function(){var e=r.error||{};i(new Error("IndexedDB request transaction aborted with error: "+e.name+", "+e.message))},r.onerror=function(){var e=r.error||{};i(new Error("IndexedDB request transaction failed with error: "+e.name+", "+e.message))}}function l(e,t,i){function n(t){if(!t)return void console.error("IndexedDB object to put in object store: "+e+", is invalid: "+t);if(t[c]=d(t[c]),null===t[c])return void console.error("IndexedDB object to put in object store: "+e+", is invalid: "+t);var i=l.put(t);i.onsuccess=function(){},i.onerror=function(t){console.error(new Error("IndexedDB put object in store:"+e+", failed with error: "+t.target.errorCode))}}var o,a=!0;for(o in t){a=!1;break}if(a)return i();var r=u.transaction(e,m.READ_WRITE),l=r.objectStore(e),c=h.getKey(e),d=s(e);for(o in t)n(t[o]);r.oncomplete=function(){i()},r.onabort=function(){var e;try{e="IndexedDB put transaction aborted with error: "+JSON.stringify(r.error)}catch(t){e="IndexedDB put transaction aborted with exception: "+t}i(new Error(e))},r.onerror=function(){i(new Error("IndexedDB put transaction failed with error: "+r.error))}}function c(e,t){var i={},n=u.transaction(e,m.READ_ONLY),o=n.objectStore(e),s=h.getKey(e),a=o.openCursor();a.onsuccess=function(e){var t=e.target.result;if(t){var n=t.value;n[f]||(i[n[s]]=n),t["continue"]()}},a.onerror=function(){console.error(new Error("IndexedDB opening cursor on object store: "+e+", failed."))},n.oncomplete=function(){t(null,i)},n.onabort=function(){t(new Error("IndexedDB requestAll transaction aborted with error: "+n.error))},n.onerror=function(){t(new Error("IndexedDB requestAll transaction failed with error: "+n.error))}}function d(e,t,i){return u?u.objectStoreNames.contains(e)?void l(e,t,i):void i(new Error("IndexedDB request failed: object store: "+e+" not found in disk cache")):void i(new Error("IndexedDB request failed: disk cache not yet initialized"))}i(36);var u,h,p=window.indexedDB||window.shimIndexedDB,m=window.IDBTransaction,f=t.DUMMY_RECORD_FLAG="MISSING_ID";t.newDummyRecord=function(e,t){var i={};return i[f]=!0,i[e]=t,i},t.initialize=function(e,t,i){if(!p)return i(new Error("This browser doesn't support a stable version of IndexedDB."));u&&(u.close(),u=null),h=t;var n=p.open(e);n.onupgradeneeded=function(e){var t=e.target.result;t.onerror=function(e){console.error(new Error("IndexedDB database error: "+e.target.errorCode))},a(t)},n.onsuccess=function(){u=n.result,u.onerror=function(e){console.error(new Error("IndexedDB database error: "+e.target.errorCode))},i()},n.onerror=function(e){i(new Error("Opening IndexedDB database failed with error: "+e.target.errorCode))}},t["delete"]=function(e,t){u&&u.name===e&&(u.close(),u=null);var i=p.deleteDatabase(e);i.onsuccess=function(){return t()},i.onerror=function(){return t(new Error("Could not delete database"))},i.onblocked=function(){return t(new Error("Could not delete database due to the operation being blocked"))}},t.request=function(e,t,i){return u?u.objectStoreNames.contains(e)?void r(e,t,i):void i(new Error("IndexedDB request failed: object store: "+e+" not found in disk cache")):void i(new Error("IndexedDB request failed: disk cache not yet initialized"))},t.put=d,t.requestAll=function(e,t){if(!u)return void t(new Error("IndexedDB request failed: disk cache not yet initialized"));var i=h.cacheCompletion;return i&&u.objectStoreNames.contains(i)?void r(i,[e],function(i,n){if(i)return t(i);var o=n[e];return o?u.objectStoreNames.contains(e)?void c(e,t):void t(new Error("IndexedDB request failed: object store: "+e+" not found in disk cache")):t(null,null)}):void t(new Error("IndexedDB isCacheComplete failed: cache completion not initialized"))},t.putAll=function(e,t,i){d(e,t,function(t){if(t)return i(t);var n=h.cacheCompletion;if(!n||!u.objectStoreNames.contains(n))return void i(new Error("IndexedDB putAll operation called but cache completion is not set up"));var o={completedType:{id:e}};d(n,o,function(e){return e?i(e):i()})})}},function(module,exports){/*! IndexedDBShim - v0.1.2 - 2014-08-07 */
"use strict";var idbModules={},cleanInterface=!1;!function(){var e={test:!0};if(Object.defineProperty)try{Object.defineProperty(e,"test",{enumerable:!1}),e.test&&(cleanInterface=!0)}catch(t){}}(),function(e){function t(e,t,i,n){i.target=t,"function"==typeof t[e]&&t[e].apply(t,[i]),"function"==typeof n&&n()}function i(t,i,n){var o=new DOMException.prototype.constructor(0,i);throw o.name=t,o.message=i,e.DEBUG&&(console.log(t,i,n,o),console.trace&&console.trace()),o}var n=function(){this.length=0,this._items=[],cleanInterface&&Object.defineProperty(this,"_items",{enumerable:!1})};if(n.prototype={contains:function(e){return-1!==this._items.indexOf(e)},item:function(e){return this._items[e]},indexOf:function(e){return this._items.indexOf(e)},push:function(e){this._items.push(e),this.length+=1;for(var t=0;this._items.length>t;t++)this[t]=this._items[t]},splice:function(){this._items.splice.apply(this._items,arguments),this.length=this._items.length;for(var e in this)e===parseInt(e,10)+""&&delete this[e];for(e=0;this._items.length>e;e++)this[e]=this._items[e]}},cleanInterface)for(var o in{indexOf:!1,push:!1,splice:!1})Object.defineProperty(n.prototype,o,{enumerable:!1});e.util={throwDOMException:i,callback:t,quote:function(e){return"'"+e+"'"},StringList:n}}(idbModules),function(idbModules){var Sca=function(){return{decycle:function(object,callback){function checkForCompletion(){0===queuedObjects.length&&returnCallback(derezObj)}function readBlobAsDataURL(e,t){var i=new FileReader;i.onloadend=function(e){var i=e.target.result,n="blob";updateEncodedBlob(i,t,n)},i.readAsDataURL(e)}function updateEncodedBlob(dataURL,path,blobtype){var encoded=queuedObjects.indexOf(path);path=path.replace("$","derezObj"),eval(path+'.$enc="'+dataURL+'"'),eval(path+'.$type="'+blobtype+'"'),queuedObjects.splice(encoded,1),checkForCompletion()}function derez(e,t){var i,n,o;if(!("object"!=typeof e||null===e||e instanceof Boolean||e instanceof Date||e instanceof Number||e instanceof RegExp||e instanceof Blob||e instanceof String)){for(i=0;objects.length>i;i+=1)if(objects[i]===e)return{$ref:paths[i]};if(objects.push(e),paths.push(t),"[object Array]"===Object.prototype.toString.apply(e))for(o=[],i=0;e.length>i;i+=1)o[i]=derez(e[i],t+"["+i+"]");else{o={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=derez(e[n],t+"["+JSON.stringify(n)+"]"))}return o}return e instanceof Blob?(queuedObjects.push(t),readBlobAsDataURL(e,t)):e instanceof Boolean?e={$type:"bool",$enc:""+e}:e instanceof Date?e={$type:"date",$enc:e.getTime()}:e instanceof Number?e={$type:"num",$enc:""+e}:e instanceof RegExp&&(e={$type:"regex",$enc:""+e}),e}var objects=[],paths=[],queuedObjects=[],returnCallback=callback,derezObj=derez(object,"$");checkForCompletion()},retrocycle:function retrocycle($){function dataURLToBlob(e){var t,i,n,o=";base64,";if(-1===e.indexOf(o))return i=e.split(","),t=i[0].split(":")[1],n=i[1],new Blob([n],{type:t});i=e.split(o),t=i[0].split(":")[1],n=window.atob(i[1]);for(var s=n.length,a=new Uint8Array(s),r=0;s>r;++r)a[r]=n.charCodeAt(r);return new Blob([a.buffer],{type:t})}function rez(value){var i,item,name,path;if(value&&"object"==typeof value)if("[object Array]"===Object.prototype.toString.apply(value))for(i=0;value.length>i;i+=1)item=value[i],item&&"object"==typeof item&&(path=item.$ref,value[i]="string"==typeof path&&px.test(path)?eval(path):rez(item));else if(void 0!==value.$type)switch(value.$type){case"blob":case"file":value=dataURLToBlob(value.$enc);break;case"bool":value=Boolean("true"===value.$enc);break;case"date":value=new Date(value.$enc);break;case"num":value=Number(value.$enc);break;case"regex":value=eval(value.$enc)}else for(name in value)"object"==typeof value[name]&&(item=value[name],item&&(path=item.$ref,value[name]="string"==typeof path&&px.test(path)?eval(path):rez(item)));return value}var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return rez($),$},encode:function(e,t){function i(e){t(JSON.stringify(e))}this.decycle(e,i)},decode:function(e){return this.retrocycle(JSON.parse(e))}}}();idbModules.Sca=Sca}(idbModules),function(e){var t=["","number","string","boolean","object","undefined"],i=function(){return{encode:function(e){return t.indexOf(typeof e)+"-"+JSON.stringify(e)},decode:function(e){return void 0===e?void 0:JSON.parse(e.substring(2))}}},n={number:i("number"),"boolean":i(),object:i(),string:{encode:function(e){return t.indexOf("string")+"-"+e},decode:function(e){return""+e.substring(2)}},undefined:{encode:function(){return t.indexOf("undefined")+"-undefined"},decode:function(){}}},o=function(){return{encode:function(e){return n[typeof e].encode(e)},decode:function(e){return n[t[e.substring(0,1)]].decode(e)}}}();e.Key=o}(idbModules),function(e){var t=function(e,t){return{type:e,debug:t,bubbles:!1,cancelable:!1,eventPhase:0,timeStamp:new Date}};e.Event=t}(idbModules),function(e){var t=function(){this.onsuccess=this.onerror=this.result=this.error=this.source=this.transaction=null,this.readyState="pending"},i=function(){this.onblocked=this.onupgradeneeded=null};i.prototype=t,e.IDBRequest=t,e.IDBOpenRequest=i}(idbModules),function(e,t){var i=function(e,t,i,n){this.lower=e,this.upper=t,this.lowerOpen=i,this.upperOpen=n};i.only=function(e){return new i(e,e,(!1),(!1))},i.lowerBound=function(e,n){return new i(e,t,n,t)},i.upperBound=function(e){return new i(t,e,t,open)},i.bound=function(e,t,n,o){return new i(e,t,n,o)},e.IDBKeyRange=i}(idbModules),function(e,t){function i(i,n,o,s,a,r){!i||i instanceof e.IDBKeyRange||(i=new e.IDBKeyRange(i,i,(!1),(!1))),this.__range=i,this.source=this.__idbObjectStore=o,this.__req=s,this.key=t,this.direction=n,this.__keyColumnName=a,this.__valueColumnName=r,this.__valueDecoder="value"===r?e.Sca:e.Key,this.source.transaction.__active||e.util.throwDOMException("TransactionInactiveError - The transaction this IDBObjectStore belongs to is not active."),this.__offset=-1,this.__lastKeyContinued=t,this["continue"]()}i.prototype.__find=function(i,n,o,s,a){a=a||1;var r=this,l=["SELECT * FROM ",e.util.quote(r.__idbObjectStore.name)],c=[];l.push("WHERE ",r.__keyColumnName," NOT NULL"),r.__range&&(r.__range.lower||r.__range.upper)&&(l.push("AND"),r.__range.lower&&(l.push(r.__keyColumnName+(r.__range.lowerOpen?" >":" >= ")+" ?"),c.push(e.Key.encode(r.__range.lower))),r.__range.lower&&r.__range.upper&&l.push("AND"),r.__range.upper&&(l.push(r.__keyColumnName+(r.__range.upperOpen?" < ":" <= ")+" ?"),c.push(e.Key.encode(r.__range.upper)))),i!==t&&(r.__lastKeyContinued=i,r.__offset=0),r.__lastKeyContinued!==t&&(l.push("AND "+r.__keyColumnName+" >= ?"),c.push(e.Key.encode(r.__lastKeyContinued))),l.push("ORDER BY ",r.__keyColumnName),l.push("LIMIT "+a+" OFFSET "+r.__offset),e.DEBUG&&console.log(l.join(" "),c),r.__prefetchedData=null,n.executeSql(l.join(" "),c,function(i,n){n.rows.length>1?(r.__prefetchedData=n.rows,r.__prefetchedIndex=0,e.DEBUG&&console.log("Preloaded "+r.__prefetchedData.length+" records for cursor"),r.__decode(n.rows.item(0),o)):1===n.rows.length?r.__decode(n.rows.item(0),o):(e.DEBUG&&console.log("Reached end of cursors"),o(t,t))},function(t,i){e.DEBUG&&console.log("Could not execute Cursor.continue"),s(i)})},i.prototype.__decode=function(t,i){var n=e.Key.decode(t[this.__keyColumnName]),o=this.__valueDecoder.decode(t[this.__valueColumnName]),s=e.Key.decode(t.key);i(n,o,s)},i.prototype["continue"]=function(i){var n=e.cursorPreloadPackSize||100,o=this;this.__idbObjectStore.transaction.__addToTransactionQueue(function(e,s,a,r){o.__offset++;var l=function(e,i,n){o.key=e,o.value=i,o.primaryKey=n,a(o.key!==t?o:t,o.__req)};return o.__prefetchedData&&(o.__prefetchedIndex++,o.__prefetchedIndex<o.__prefetchedData.length)?(o.__decode(o.__prefetchedData.item(o.__prefetchedIndex),l),t):(o.__find(i,e,l,r,n),t)})},i.prototype.advance=function(i){0>=i&&e.util.throwDOMException("Type Error - Count is invalid - 0 or negative",i);var n=this;this.__idbObjectStore.transaction.__addToTransactionQueue(function(e,o,s,a){n.__offset+=i,n.__find(t,e,function(e,i){n.key=e,n.value=i,s(n.key!==t?n:t,n.__req)},a)})},i.prototype.update=function(i){var n=this,o=this.__idbObjectStore.transaction.__createRequest(function(){});return e.Sca.encode(i,function(i){n.__idbObjectStore.transaction.__pushToQueue(o,function(o,s,a,r){n.__find(t,o,function(t,s,l){var c="UPDATE "+e.util.quote(n.__idbObjectStore.name)+" SET value = ? WHERE key = ?";e.DEBUG&&console.log(c,i,t,l),o.executeSql(c,[i,e.Key.encode(l)],function(e,i){n.__prefetchedData=null,1===i.rowsAffected?a(t):r("No rows with key found"+t)},function(e,t){r(t)})},r)})}),o},i.prototype["delete"]=function(){var i=this;return this.__idbObjectStore.transaction.__addToTransactionQueue(function(n,o,s,a){i.__find(t,n,function(o,r,l){var c="DELETE FROM  "+e.util.quote(i.__idbObjectStore.name)+" WHERE key = ?";e.DEBUG&&console.log(c,o,l),n.executeSql(c,[e.Key.encode(l)],function(e,n){i.__prefetchedData=null,1===n.rowsAffected?(i.__offset--,s(t)):a("No rows with key found"+o)},function(e,t){a(t)})},a)})},e.IDBCursor=i}(idbModules),function(idbModules,undefined){function IDBIndex(e,t){this.indexName=this.name=e,this.__idbObjectStore=this.objectStore=this.source=t;var i=t.__storeProps&&t.__storeProps.indexList;i&&(i=JSON.parse(i)),this.keyPath=i&&i[e]&&i[e].keyPath||e,["multiEntry","unique"].forEach(function(t){this[t]=!!(i&&i[e]&&i[e].optionalParams&&i[e].optionalParams[t])},this)}IDBIndex.prototype.__createIndex=function(indexName,keyPath,optionalParameters){var me=this,transaction=me.__idbObjectStore.transaction;transaction.__addToTransactionQueue(function(tx,args,success,failure){me.__idbObjectStore.__getStoreProps(tx,function(){function error(){idbModules.util.throwDOMException(0,"Could not create new index",arguments)}2!==transaction.mode&&idbModules.util.throwDOMException(0,"Invalid State error, not a version transaction",me.transaction);var idxList=JSON.parse(me.__idbObjectStore.__storeProps.indexList);idxList[indexName]!==undefined&&idbModules.util.throwDOMException(0,"Index already exists on store",idxList);var columnName=indexName;idxList[indexName]={columnName:columnName,keyPath:keyPath,optionalParams:optionalParameters},me.__idbObjectStore.__storeProps.indexList=JSON.stringify(idxList);var sql=["ALTER TABLE",idbModules.util.quote(me.__idbObjectStore.name),"ADD",columnName,"BLOB"].join(" ");idbModules.DEBUG&&console.log(sql),tx.executeSql(sql,[],function(tx,data){tx.executeSql("SELECT * FROM "+idbModules.util.quote(me.__idbObjectStore.name),[],function(tx,data){!function initIndexForRow(i){if(data.rows.length>i)try{var value=idbModules.Sca.decode(data.rows.item(i).value),indexKey=eval("value['"+keyPath+"']");tx.executeSql("UPDATE "+idbModules.util.quote(me.__idbObjectStore.name)+" set "+columnName+" = ? where key = ?",[idbModules.Key.encode(indexKey),data.rows.item(i).key],function(){initIndexForRow(i+1)},error)}catch(e){initIndexForRow(i+1)}else idbModules.DEBUG&&console.log("Updating the indexes in table",me.__idbObjectStore.__storeProps),tx.executeSql("UPDATE __sys__ set indexList = ? where name = ?",[me.__idbObjectStore.__storeProps.indexList,me.__idbObjectStore.name],function(){me.__idbObjectStore.__setReadyState("createIndex",!0),success(me)},error)}(0)},error)},error)},"createObjectStore")})},IDBIndex.prototype.openCursor=function(e,t){var i=new idbModules.IDBRequest;return new idbModules.IDBCursor(e,t,this.source,i,this.indexName,"value"),i},IDBIndex.prototype.openKeyCursor=function(e,t){var i=new idbModules.IDBRequest;return new idbModules.IDBCursor(e,t,this.source,i,this.indexName,"key"),i},IDBIndex.prototype.__fetchIndexData=function(e,t){var i=this;return i.__idbObjectStore.transaction.__addToTransactionQueue(function(n,o,s,a){var r=["SELECT * FROM ",idbModules.util.quote(i.__idbObjectStore.name)," WHERE",i.indexName,"NOT NULL"],l=[];e!==undefined&&(r.push("AND",i.indexName," = ?"),l.push(idbModules.Key.encode(e))),idbModules.DEBUG&&console.log("Trying to fetch data for Index",r.join(" "),l),n.executeSql(r.join(" "),l,function(e,i){var n;n="count"===t?i.rows.length:0===i.rows.length?undefined:"key"===t?idbModules.Key.decode(i.rows.item(0).key):idbModules.Sca.decode(i.rows.item(0).value),s(n)},a)})},IDBIndex.prototype.get=function(e){return this.__fetchIndexData(e,"value")},IDBIndex.prototype.getKey=function(e){return this.__fetchIndexData(e,"key")},IDBIndex.prototype.count=function(e){return this.__fetchIndexData(e,"count")},idbModules.IDBIndex=IDBIndex}(idbModules),function(idbModules){var IDBObjectStore=function(e,t,i){this.name=e,this.transaction=t,this.__ready={},this.__setReadyState("createObjectStore",void 0===i||i),this.indexNames=new idbModules.util.StringList};IDBObjectStore.prototype.__setReadyState=function(e,t){this.__ready[e]=t},IDBObjectStore.prototype.__waitForReady=function(e,t){var i=!0;if(void 0!==t)i=void 0===this.__ready[t]||this.__ready[t];else for(var n in this.__ready)this.__ready[n]||(i=!1);if(i)e();else{idbModules.DEBUG&&console.log("Waiting for to be ready",t);var o=this;window.setTimeout(function(){o.__waitForReady(e,t)},100)}},IDBObjectStore.prototype.__getStoreProps=function(e,t,i){var n=this;this.__waitForReady(function(){n.__storeProps?(idbModules.DEBUG&&console.log("Store properties - cached",n.__storeProps),t(n.__storeProps)):e.executeSql("SELECT * FROM __sys__ where name = ?",[n.name],function(e,i){1!==i.rows.length?t():(n.__storeProps={name:i.rows.item(0).name,indexList:i.rows.item(0).indexList,autoInc:i.rows.item(0).autoInc,keyPath:i.rows.item(0).keyPath},idbModules.DEBUG&&console.log("Store properties",n.__storeProps),t(n.__storeProps))},function(){t()})},i)},IDBObjectStore.prototype.__deriveKey=function(tx,value,key,callback){function getNextAutoIncKey(){tx.executeSql("SELECT * FROM sqlite_sequence where name like ?",[me.name],function(e,t){callback(1!==t.rows.length?0:t.rows.item(0).seq)},function(e,t){idbModules.util.throwDOMException(0,"Data Error - Could not get the auto increment value for key",t)})}var me=this;me.__getStoreProps(tx,function(props){if(props||idbModules.util.throwDOMException(0,"Data Error - Could not locate defination for this table",props),props.keyPath)if(void 0!==key&&idbModules.util.throwDOMException(0,"Data Error - The object store uses in-line keys and the key parameter was provided",props),value)try{var primaryKey=eval("value['"+props.keyPath+"']");void 0===primaryKey?"true"===props.autoInc?getNextAutoIncKey():idbModules.util.throwDOMException(0,"Data Error - Could not eval key from keyPath"):callback(primaryKey)}catch(e){idbModules.util.throwDOMException(0,"Data Error - Could not eval key from keyPath",e)}else idbModules.util.throwDOMException(0,"Data Error - KeyPath was specified, but value was not");else void 0!==key?callback(key):"false"===props.autoInc?idbModules.util.throwDOMException(0,"Data Error - The object store uses out-of-line keys and has no key generator and the key parameter was not provided. ",props):getNextAutoIncKey()})},IDBObjectStore.prototype.__insertData=function(tx,encoded,value,primaryKey,success,error){var paramMap={};void 0!==primaryKey&&(paramMap.key=idbModules.Key.encode(primaryKey));var indexes=JSON.parse(this.__storeProps.indexList);for(var key in indexes)try{paramMap[indexes[key].columnName]=idbModules.Key.encode(eval("value['"+indexes[key].keyPath+"']"))}catch(e){error(e)}var sqlStart=["INSERT INTO ",idbModules.util.quote(this.name),"("],sqlEnd=[" VALUES ("],sqlValues=[];for(key in paramMap)sqlStart.push(key+","),sqlEnd.push("?,"),sqlValues.push(paramMap[key]);sqlStart.push("value )"),sqlEnd.push("?)"),sqlValues.push(encoded);var sql=sqlStart.join(" ")+sqlEnd.join(" ");idbModules.DEBUG&&console.log("SQL for adding",sql,sqlValues),tx.executeSql(sql,sqlValues,function(){success(primaryKey)},function(e,t){error(t)})},IDBObjectStore.prototype.add=function(e,t){var i=this,n=i.transaction.__createRequest(function(){});return idbModules.Sca.encode(e,function(o){i.transaction.__pushToQueue(n,function(n,s,a,r){i.__deriveKey(n,e,t,function(t){i.__insertData(n,o,e,t,a,r)})})}),n},IDBObjectStore.prototype.put=function(e,t){var i=this,n=i.transaction.__createRequest(function(){});return idbModules.Sca.encode(e,function(o){i.transaction.__pushToQueue(n,function(n,s,a,r){i.__deriveKey(n,e,t,function(t){var s="DELETE FROM "+idbModules.util.quote(i.name)+" where key = ?";n.executeSql(s,[idbModules.Key.encode(t)],function(n,s){idbModules.DEBUG&&console.log("Did the row with the",t,"exist? ",s.rowsAffected),i.__insertData(n,o,e,t,a,r)},function(e,t){r(t)})})})}),n},IDBObjectStore.prototype.get=function(e){var t=this;return t.transaction.__addToTransactionQueue(function(i,n,o,s){t.__waitForReady(function(){var n=idbModules.Key.encode(e);idbModules.DEBUG&&console.log("Fetching",t.name,n),i.executeSql("SELECT * FROM "+idbModules.util.quote(t.name)+" where key = ?",[n],function(e,t){idbModules.DEBUG&&console.log("Fetched data",t);try{if(0===t.rows.length)return o();o(idbModules.Sca.decode(t.rows.item(0).value))}catch(i){idbModules.DEBUG&&console.log(i),o(void 0)}},function(e,t){s(t)})})})},IDBObjectStore.prototype["delete"]=function(e){var t=this;return t.transaction.__addToTransactionQueue(function(i,n,o,s){t.__waitForReady(function(){var n=idbModules.Key.encode(e);idbModules.DEBUG&&console.log("Fetching",t.name,n),i.executeSql("DELETE FROM "+idbModules.util.quote(t.name)+" where key = ?",[n],function(e,t){idbModules.DEBUG&&console.log("Deleted from database",t.rowsAffected),o()},function(e,t){s(t)})})})},IDBObjectStore.prototype.clear=function(){var e=this;return e.transaction.__addToTransactionQueue(function(t,i,n,o){e.__waitForReady(function(){t.executeSql("DELETE FROM "+idbModules.util.quote(e.name),[],function(e,t){idbModules.DEBUG&&console.log("Cleared all records from database",t.rowsAffected),n()},function(e,t){o(t)})})})},IDBObjectStore.prototype.count=function(e){var t=this;return t.transaction.__addToTransactionQueue(function(i,n,o,s){t.__waitForReady(function(){var n="SELECT * FROM "+idbModules.util.quote(t.name)+(void 0!==e?" WHERE key = ?":""),a=[];void 0!==e&&a.push(idbModules.Key.encode(e)),i.executeSql(n,a,function(e,t){o(t.rows.length)},function(e,t){s(t)})})})},IDBObjectStore.prototype.openCursor=function(e,t){var i=new idbModules.IDBRequest;return new idbModules.IDBCursor(e,t,this,i,"key","value"),i},IDBObjectStore.prototype.index=function(e){var t=new idbModules.IDBIndex(e,this);return t},IDBObjectStore.prototype.createIndex=function(e,t,i){var n=this;i=i||{},n.__setReadyState("createIndex",!1);var o=new idbModules.IDBIndex(e,n);return n.__waitForReady(function(){o.__createIndex(e,t,i)},"createObjectStore"),n.indexNames.push(e),o},IDBObjectStore.prototype.deleteIndex=function(e){var t=new idbModules.IDBIndex(e,this,(!1));return t.__deleteIndex(e),t},idbModules.IDBObjectStore=IDBObjectStore}(idbModules),function(e){var t=0,i=1,n=2,o=function(n,o,s){if("number"==typeof o)this.mode=o,2!==o&&e.DEBUG&&console.log("Mode should be a string, but was specified as ",o);else if("string"==typeof o)switch(o){case"readwrite":this.mode=i;break;case"readonly":this.mode=t;break;default:this.mode=t}this.storeNames="string"==typeof n?[n]:n;for(var a=0;this.storeNames.length>a;a++)s.objectStoreNames.contains(this.storeNames[a])||e.util.throwDOMException(0,"The operation failed because the requested database object could not be found. For example, an object store did not exist but was being opened.",this.storeNames[a]);this.__active=!0,this.__running=!1,this.__requests=[],this.__aborted=!1,this.db=s,this.error=null,this.onabort=this.onerror=this.oncomplete=null};o.prototype.__executeRequests=function(){if(this.__running&&this.mode!==n)return void(e.DEBUG&&console.log("Looks like the request set is already running",this.mode));this.__running=!0;var t=this;window.setTimeout(function(){2===t.mode||t.__active||e.util.throwDOMException(0,"A request was placed against a transaction which is currently not active, or which is finished",t.__active),t.db.__db.transaction(function(i){function n(t,i){i&&(a.req=i),a.req.readyState="done",a.req.result=t,delete a.req.error;var n=e.Event("success");e.util.callback("onsuccess",a.req,n),r++,s()}function o(){a.req.readyState="done",a.req.error="DOMError";var t=e.Event("error",arguments);e.util.callback("onerror",a.req,t),r++,s()}function s(){return r>=t.__requests.length?(t.__active=!1,void(t.__requests=[])):(a=t.__requests[r],void a.op(i,a.args,n,o))}t.__tx=i;var a=null,r=0;try{s()}catch(l){e.DEBUG&&console.log("An exception occured in transaction",arguments),"function"==typeof t.onerror&&t.onerror()}},function(){e.DEBUG&&console.log("An error in transaction",arguments),"function"==typeof t.onerror&&t.onerror()},function(){e.DEBUG&&console.log("Transaction completed",arguments),"function"==typeof t.oncomplete&&t.oncomplete()})},1)},o.prototype.__addToTransactionQueue=function(t,i){this.__active||this.mode===n||e.util.throwDOMException(0,"A request was placed against a transaction which is currently not active, or which is finished.",this.__mode);var o=this.__createRequest();return this.__pushToQueue(o,t,i),o},o.prototype.__createRequest=function(){var t=new e.IDBRequest;return t.source=this.db,t.transaction=this,t},o.prototype.__pushToQueue=function(e,t,i){this.__requests.push({op:t,args:i,req:e}),this.__executeRequests()},o.prototype.objectStore=function(t){return new e.IDBObjectStore(t,this)},o.prototype.abort=function(){!this.__active&&e.util.throwDOMException(0,"A request was placed against a transaction which is currently not active, or which is finished",this.__active)},o.prototype.READ_ONLY=0,o.prototype.READ_WRITE=1,o.prototype.VERSION_CHANGE=2,e.IDBTransaction=o}(idbModules),function(e){var t=function(t,i,n,o){this.__db=t,this.version=n,this.__storeProperties=o,this.objectStoreNames=new e.util.StringList;for(var s=0;o.rows.length>s;s++)this.objectStoreNames.push(o.rows.item(s).name);this.name=i,this.onabort=this.onerror=this.onversionchange=null};t.prototype.createObjectStore=function(t,i){var n=this;i=i||{},i.keyPath=i.keyPath||null;var o=new e.IDBObjectStore(t,n.__versionTransaction,(!1)),s=n.__versionTransaction;return s.__addToTransactionQueue(function(s,a,r){function l(){e.util.throwDOMException(0,"Could not create new object store",arguments)}n.__versionTransaction||e.util.throwDOMException(0,"Invalid State error",n.transaction);var c=["CREATE TABLE",e.util.quote(t),"(key BLOB",i.autoIncrement?", inc INTEGER PRIMARY KEY AUTOINCREMENT":"PRIMARY KEY",", value BLOB)"].join(" ");e.DEBUG&&console.log(c),s.executeSql(c,[],function(e){e.executeSql("INSERT INTO __sys__ VALUES (?,?,?,?)",[t,i.keyPath,!!i.autoIncrement,"{}"],function(){o.__setReadyState("createObjectStore",!0),r(o)},l)},l)}),n.objectStoreNames.push(t),o},t.prototype.deleteObjectStore=function(t){var i=function(){e.util.throwDOMException(0,"Could not delete ObjectStore",arguments)},n=this;!n.objectStoreNames.contains(t)&&i("Object Store does not exist"),n.objectStoreNames.splice(n.objectStoreNames.indexOf(t),1);var o=n.__versionTransaction;o.__addToTransactionQueue(function(){n.__versionTransaction||e.util.throwDOMException(0,"Invalid State error",n.transaction),n.__db.transaction(function(n){n.executeSql("SELECT * FROM __sys__ where name = ?",[t],function(n,o){o.rows.length>0&&n.executeSql("DROP TABLE "+e.util.quote(t),[],function(){n.executeSql("DELETE FROM __sys__ WHERE name = ?",[t],function(){},i)},i)})})})},t.prototype.close=function(){},t.prototype.transaction=function(t,i){var n=new e.IDBTransaction(t,i||1,this);return n},e.IDBDatabase=t}(idbModules),function(e){var t=4194304;if(window.openDatabase){var i=window.openDatabase("__sysdb__",1,"System Database",t);i.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS dbVersions (name VARCHAR(255), version INT);",[])},function(){e.DEBUG&&console.log("Error in sysdb transaction - when creating dbVersions",arguments)});var n={open:function(n,o){function s(){if(!l){var t=e.Event("error",arguments);r.readyState="done",r.error="DOMError",e.util.callback("onerror",r,t),l=!0}}function a(a){var l=window.openDatabase(n,1,n,t);r.readyState="done",void 0===o&&(o=a||1),(0>=o||a>o)&&e.util.throwDOMException(0,"An attempt was made to open a database using a lower version than the existing version.",o),l.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS __sys__ (name VARCHAR(255), keyPath VARCHAR(255), autoInc BOOLEAN, indexList BLOB)",[],function(){t.executeSql("SELECT * FROM __sys__",[],function(t,c){var d=e.Event("success");r.source=r.result=new e.IDBDatabase(l,n,o,c),o>a?i.transaction(function(t){t.executeSql("UPDATE dbVersions set version = ? where name = ?",[o,n],function(){var t=e.Event("upgradeneeded");t.oldVersion=a,t.newVersion=o,r.transaction=r.result.__versionTransaction=new e.IDBTransaction([],2,r.source),e.util.callback("onupgradeneeded",r,t,function(){var t=e.Event("success");e.util.callback("onsuccess",r,t)})},s)},s):e.util.callback("onsuccess",r,d)},s)},s)},s)}var r=new e.IDBOpenRequest,l=!1;return i.transaction(function(e){e.executeSql("SELECT * FROM dbVersions where name = ?",[n],function(e,t){0===t.rows.length?e.executeSql("INSERT INTO dbVersions VALUES (?,?)",[n,o||1],function(){a(0)},s):a(t.rows.item(0).version)},s)},s),r},deleteDatabase:function(n){function o(t){if(!r){a.readyState="done",a.error="DOMError";var i=e.Event("error");i.message=t,i.debug=arguments,e.util.callback("onerror",a,i),r=!0}}function s(){i.transaction(function(t){t.executeSql("DELETE FROM dbVersions where name = ? ",[n],function(){a.result=void 0;var t=e.Event("success");t.newVersion=null,t.oldVersion=l,e.util.callback("onsuccess",a,t)},o)},o)}var a=new e.IDBOpenRequest,r=!1,l=null;return i.transaction(function(i){i.executeSql("SELECT * FROM dbVersions where name = ?",[n],function(i,r){if(0===r.rows.length){a.result=void 0;var c=e.Event("success");return c.newVersion=null,c.oldVersion=l,void e.util.callback("onsuccess",a,c)}l=r.rows.item(0).version;var d=window.openDatabase(n,1,n,t);d.transaction(function(t){t.executeSql("SELECT * FROM __sys__",[],function(t,i){var n=i.rows;!function a(i){i>=n.length?t.executeSql("DROP TABLE __sys__",[],function(){s()},o):t.executeSql("DROP TABLE "+e.util.quote(n.item(i).name),[],function(){a(i+1)},function(){a(i+1)})}(0)},function(){s()})},o)})},o),a},cmp:function(t,i){return e.Key.encode(t)>e.Key.encode(i)?1:t===i?0:-1}};e.shimIndexedDB=n}}(idbModules),function(e,t){void 0!==e.openDatabase&&(e.shimIndexedDB=t.shimIndexedDB,e.shimIndexedDB&&(e.shimIndexedDB.__useShim=function(){e.indexedDB=t.shimIndexedDB,e.IDBDatabase=t.IDBDatabase,e.IDBTransaction=t.IDBTransaction,e.IDBCursor=t.IDBCursor,e.IDBKeyRange=t.IDBKeyRange,e.indexedDB!==t.shimIndexedDB&&Object.defineProperty&&Object.defineProperty(e,"indexedDB",{value:t.shimIndexedDB})},e.shimIndexedDB.__debug=function(e){t.DEBUG=e})),"indexedDB"in e||(e.indexedDB=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.oIndexedDB||e.msIndexedDB);var i=!1;if((navigator.userAgent.match(/Android 2/)||navigator.userAgent.match(/Android 3/)||navigator.userAgent.match(/Android 4\.[0-3]/))&&(navigator.userAgent.match(/Chrome/)||(i=!0)),void 0!==e.indexedDB&&!i||void 0===e.openDatabase){e.IDBDatabase=e.IDBDatabase||e.webkitIDBDatabase,e.IDBTransaction=e.IDBTransaction||e.webkitIDBTransaction,e.IDBCursor=e.IDBCursor||e.webkitIDBCursor,e.IDBKeyRange=e.IDBKeyRange||e.webkitIDBKeyRange,e.IDBTransaction||(e.IDBTransaction={});try{e.IDBTransaction.READ_ONLY=e.IDBTransaction.READ_ONLY||"readonly",e.IDBTransaction.READ_WRITE=e.IDBTransaction.READ_WRITE||"readwrite"}catch(n){}}else e.shimIndexedDB.__useShim()}(window,idbModules)},function(e,t,i){var n=i(38),o=i(24);e.exports=function(e,t,i,s,a){if(!e)return a(new Error("staticContent is not initialized. Cannot perform request: "+t));var r=o.operation({retries:4,randomize:!0});i=i||{};var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4===~~l.readyState){var e;if(200!==~~l.status&&(e="staticContent xhrError: "+l.status),r.retry(e))return console.warn("staticContent.request failed code ",l.status+", will retry...");if(e)return a(r.mainError());var t;try{t=JSON.parse(l.response)}catch(i){return a(i)}a(null,t)}};var c={lang:i.lang||s,v:window.buildVersion},d=e+t+"?"+n.stringify(c);r.attempt(function(){l.open("POST",d,!0),l.setRequestHeader("Content-type","application/json"),l.send(JSON.stringify(i))})}},function(e,t,i){"use strict";t.decode=t.parse=i(39),t.encode=t.stringify=i(40)},function(e,t){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var r=1e3;o&&"number"==typeof o.maxKeys&&(r=o.maxKeys);var l=e.length;r>0&&l>r&&(l=r);for(var c=0;c<l;++c){var d,u,h,p,m=e[c].replace(a,"%20"),f=m.indexOf(n);f>=0?(d=m.substr(0,f),u=m.substr(f+1)):(d=m,u=""),h=decodeURIComponent(d),p=decodeURIComponent(u),i(s,h)?Array.isArray(s[h])?s[h].push(p):s[h]=[s[h],p]:s[h]=p}return s}},function(e,t){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,o){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(o){var s=encodeURIComponent(i(o))+n;return Array.isArray(e[o])?e[o].map(function(e){return s+encodeURIComponent(i(e))}).join(t):s+encodeURIComponent(i(e[o]))}).join(t):o?encodeURIComponent(i(o))+n+encodeURIComponent(i(e)):""}},function(e,t,i){function n(e){return~~e}function o(e,t){var i=e&&e.consumeResult;if(i instanceof Array&&i.length>0)for(var n=i.length,o=0;o<n;o++)l.log(p,{articleId:i[o].id,caption:i[o].name,articlesCount:n,isRestore:t},u);else{console.error("wKpi mysteryBox"+(t?" (restore)":"")+": unparsable msg content");var s={articleId:-1,caption:"unknown",articlesCount:0,isRestore:t};l.log(p,s,u)}}var s,a=i(42),r=i(43),l=i(9),c=i(28),d=i(44),u={wizAnalyticsOnly:!0};t.bidHouseBuyPrepare=function(e){var t=e.itemInstance;if(!t)return console.error("wKpi.bidHouseBuyPrepare: invalid itemInstance");var i=t.item;return i&&i.type?void(s={currency:e.isHardCurrency?"hard":"soft",spent:e.spent,itemId:t.objectGID,itemCaption:t.shortName,type:a.ITEM_TYPE_NAME[i.type.id]||"not referenced",superType:a.ITEM_SUPERTYPE_NAME[i.getSuperTypeId()]||"not referenced",quantity:e.quantity}):console.error("wKpi.bidHouseBuyPrepare: invalid itemInstance.item")},t.bidHouseBuySuccess=function(){s&&(l.log("Currency.BidHouse_Buy_Success",s,u),s=null)};var h;t.shopBuyPrepare=function(e){if(!e)return console.error("wKpi.shopBuyPrepare: no options provided");var t=e.currency,i=e.article,o=t===r.KAMA,s=i.itemsId instanceof Array?i.itemsId.map(n).sort():null;h={currency:o?"soft":"hard",spent:o?i._softPrice:i.price,articleId:i.id,articleCaption:i.name,itemsId:s}},t.shopBuySuccess=function(){h&&(l.log("Currency.Shop_Buy_Success",h,u),h=null)};var p="Mystery_Box_Success";t.mysteryBoxSuccess=function(e){o(e,!1)},t.restoreMysteryBoxSuccess=function(e){o(e,!0)};var m,f="Hard_Currency_Amount";t.hardCurrencyAmount=function(e){var t=d(c.now());m&&m.isSame(t,"day")||(l.log(f,{amount:e},u),m=t)},t.sendPlatform=function(e){l.log("Platform.Type",{platform:e},u)}},function(e,t){t.ITEM_SUPERTYPE_NAME={0:"empty",1:"amulet",2:"weapon",3:"ring",4:"belt",5:"boot",6:"usable",7:"shield",8:"capture item",9:"resource",10:"hat",11:"cape",12:"pet/dofus"},t.ITEM_TYPE_NAME={1:"Amulet",2:"Bow",3:"Wand",4:"Staff",5:"Dagger",6:"Sword",7:"Hammer",8:"Shovel",9:"Ring",10:"Belt",11:"Boots",12:"Potion",13:"Experience scroll",14:"Order ability item",15:"Miscellaneous",16:"Hat",17:"Cloak",18:"Pet",19:"Axe",20:"Tool",21:"Pickaxe",22:"Scythe",23:"Dofus",24:"Miscellaneous",25:"Document",26:"Smithmagic potion",27:"Mutation item",28:"Boost food",29:"Blessing",30:"Curse",31:"Roleplay buff",32:"Following character",33:"Bread",34:"Cereal",35:"Flower",36:"Plant",37:"Beer",38:"Wood",39:"Ore",40:"Alloy",41:"Fish",42:"Treat",
43:"Spell deleveling potion",44:"Profession deleveling potion",45:"Weapon skill deleveling potion",46:"Fruit",47:"Bone",48:"Powder",49:"Edible fish",50:"Precious stone",51:"Stone",52:"Flour",53:"Feather",54:"Hair",55:"Fabric",56:"Leather",57:"Wool",58:"Seed",59:"Skin",60:"Oil",61:"Stuffed toy",62:"Gutted fish",63:"Meat",64:"Preserved meat",65:"Tail",66:"Metaria",68:"Vegetable",69:"Edible meat",70:"Dye",71:"Alchemy equipment",72:"Pet egg",73:"Skill",74:"Fairywork",75:"Spell-learning scroll",76:"Characteristic scroll",77:"Pet certificate",78:"Smithmagic rune",79:"Drink",80:"Mission item",81:"Backpack",82:"Shield",83:"Soul stone",84:"Key",85:"Full soul stone",86:"Perceptor deleveling potion",87:"Seeker scroll",88:"Magic stone",89:"Gift",90:"Pet ghost",91:"Dragoturkey",92:"Gobball",93:"Breeding item",94:"Various",95:"Plank",96:"Bark",97:"Mount certificate",98:"Root",99:"Capturing net",100:"Bag of resources",102:"Crossbow",103:"Leg",104:"Wing",105:"Egg",106:"Ear",107:"Carapace",108:"Bud",109:"Eye",110:"Jelly",111:"Shell",112:"Prism",113:"Living object",114:"Magic weapon",115:"Fragment of Shushu soul",116:"Pet potion",118:"Equipment",119:"Mushroom",121:"Petsmount",122:"Petsmount potion",123:"Petsmount certificate",124:"Petsmount ghost",125:"Souvenir",126:"Main quests",127:"Temple quests",128:"Wanted notice",129:"Alignment",130:"City order",131:"Event",132:"Archipelago of Vulkania",133:"Astrub",134:"City quests",136:"Bwork Camp",137:"Cania",138:"Amakna Castle",139:"Frigost Island",140:"Otomai Island",141:"Kwismas Island",142:"Incarnam",143:"Koalak Mountain",144:"Pandala",145:"Madrestam Harbour",146:"Province of Amakna",147:"Krosmoz",148:"Token",149:"Moon Island",150:"Wabbit Islands",151:"Trophy",152:"Pebble",153:"Kwismas",154:"Wrapping paper",155:"Sufokia",156:"Almanax",157:"Figurine",158:"Caramel Rabmajoke",159:"Strawberry Rabmajoke",160:"Lemon Rabmajoke",161:"Orange Rabmajoke",162:"Kola Rabmajoke",163:"Nougat Rabmajoke",164:"Garment",165:"Conquest potion",166:"Mimisymbic"}},function(e,t){e.exports={GOULTINE:"GOU",KAMA:"KMS"}},function(e,t,i){var n=e.exports=i(45);n.tz.load(i(164))},function(e,t,i){var n,o,s;//! moment-timezone.js
//! version : 0.5.5
//! author : Tim Wood
//! license : MIT
//! github.com/moment/moment-timezone
!function(a,r){"use strict";o=[i(46)],n=r,s="function"==typeof n?n.apply(t,o):n,!(void 0!==s&&(e.exports=s))}(this,function(e){"use strict";function t(e){return e>96?e-87:e>64?e-29:e-48}function i(e){var i,n=0,o=e.split("."),s=o[0],a=o[1]||"",r=1,l=0,c=1;for(45===e.charCodeAt(0)&&(n=1,c=-1),n;n<s.length;n++)i=t(s.charCodeAt(n)),l=60*l+i;for(n=0;n<a.length;n++)r/=60,i=t(a.charCodeAt(n)),l+=i*r;return l*c}function n(e){for(var t=0;t<e.length;t++)e[t]=i(e[t])}function o(e,t){for(var i=0;i<t;i++)e[i]=Math.round((e[i-1]||0)+6e4*e[i]);e[t-1]=1/0}function s(e,t){var i,n=[];for(i=0;i<t.length;i++)n[i]=e[t[i]];return n}function a(e){var t=e.split("|"),i=t[2].split(" "),a=t[3].split(""),r=t[4].split(" ");return n(i),n(a),n(r),o(r,a.length),{name:t[0],abbrs:s(t[1].split(" "),a),offsets:s(i,a),untils:r,population:0|t[5]}}function r(e){e&&this._set(a(e))}function l(e){var t=e.toTimeString(),i=t.match(/\([a-z ]+\)/i);i&&i[0]?(i=i[0].match(/[A-Z]/g),i=i?i.join(""):void 0):(i=t.match(/[A-Z]{3,5}/g),i=i?i[0]:void 0),"GMT"===i&&(i=void 0),this.at=+e,this.abbr=i,this.offset=e.getTimezoneOffset()}function c(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function d(e,t){for(var i,n;n=6e4*((t.at-e.at)/12e4|0);)i=new l(new Date(e.at+n)),i.offset===e.offset?e=i:t=i;return e}function u(){var e,t,i,n=(new Date).getFullYear()-2,o=new l(new Date(n,0,1)),s=[o];for(i=1;i<48;i++)t=new l(new Date(n,i,1)),t.offset!==o.offset&&(e=d(o,t),s.push(e),s.push(new l(new Date(e.at+6e4)))),o=t;for(i=0;i<4;i++)s.push(new l(new Date(n+i,0,1))),s.push(new l(new Date(n+i,6,1)));return s}function h(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:t.zone.population-e.zone.population}function p(e,t){var i,o;for(n(t),i=0;i<t.length;i++)o=t[i],R[o]=R[o]||{},R[o][e]=!0}function m(e){var t,i,n,o=e.length,s={},a=[];for(t=0;t<o;t++){n=R[e[t].offset]||{};for(i in n)n.hasOwnProperty(i)&&(s[i]=!0)}for(t in s)s.hasOwnProperty(t)&&a.push(D[t]);return a}function f(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e){var t=D[_(e)];if(t)return t;A("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(i){}var n,o,s,a=u(),r=a.length,l=m(a),d=[];for(o=0;o<l.length;o++){for(n=new c(y(l[o]),r),s=0;s<r;s++)n.scoreOffsetAt(a[s]);d.push(n)}return d.sort(h),d.length>0?d[0].zone.name:void 0}function g(e){return x&&!e||(x=f()),x}function _(e){return(e||"").toLowerCase().replace(/\//g,"_")}function v(e){var t,i,n,o;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)n=e[t].split("|"),i=n[0],o=_(i),L[o]=e[t],D[o]=i,n[5]&&p(o,n[2].split(" "))}function y(e,t){e=_(e);var i,n=L[e];return n instanceof r?n:"string"==typeof n?(n=new r(n),L[e]=n,n):O[e]&&t!==y&&(i=y(O[e],y))?(n=L[e]=new r,n._set(i),n.name=D[e],n):null}function b(){var e,t=[];for(e in D)D.hasOwnProperty(e)&&(L[e]||L[O[e]])&&D[e]&&t.push(D[e]);return t.sort()}function M(e){var t,i,n,o;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)i=e[t].split("|"),n=_(i[0]),o=_(i[1]),O[n]=o,D[n]=i[0],O[o]=n,D[o]=i[1]}function w(e){v(e.zones),M(e.links),I.dataVersion=e.version}function T(e){return T.didShowError||(T.didShowError=!0,A("moment.tz.zoneExists('"+e+"') has been deprecated in favor of !moment.tz.zone('"+e+"')")),!!y(e)}function C(e){return!(!e._a||void 0!==e._tzm)}function A(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}function I(t){var i=Array.prototype.slice.call(arguments,0,-1),n=arguments[arguments.length-1],o=y(n),s=e.utc.apply(null,i);return o&&!e.isMoment(t)&&C(s)&&s.add(o.parse(s),"minutes"),s.tz(n),s}function S(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}function E(e){return function(){return this._z=null,e.apply(this,arguments)}}if(void 0!==e.tz)return A("Moment Timezone "+e.tz.version+" was already loaded "+(e.tz.dataVersion?"with data from ":"without any data")+e.tz.dataVersion),e;var x,N="0.5.5",L={},O={},D={},R={},P=e.version.split("."),B=+P[0],k=+P[1];(B<2||2===B&&k<6)&&A("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+e.version+". See momentjs.com"),r.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){var t,i=+e,n=this.untils;for(t=0;t<n.length;t++)if(i<n[t])return t},parse:function(e){var t,i,n,o,s=+e,a=this.offsets,r=this.untils,l=r.length-1;for(o=0;o<l;o++)if(t=a[o],i=a[o+1],n=a[o?o-1:o],t<i&&I.moveAmbiguousForward?t=i:t>n&&I.moveInvalidForward&&(t=n),s<r[o]-6e4*t)return a[o];return a[l]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return this.offsets[this._index(e)]}},c.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.offset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},I.version=N,I.dataVersion="",I._zones=L,I._links=O,I._names=D,I.add=v,I.link=M,I.load=w,I.zone=y,I.zoneExists=T,I.guess=g,I.names=b,I.Zone=r,I.unpack=a,I.unpackBase60=i,I.needsOffset=C,I.moveInvalidForward=!0,I.moveAmbiguousForward=!1;var z=e.fn;e.tz=I,e.defaultZone=null,e.updateOffset=function(t,i){var n,o=e.defaultZone;void 0===t._z&&(o&&C(t)&&!t._isUTC&&(t._d=e.utc(t._a)._d,t.utc().add(o.parse(t),"minutes")),t._z=o),t._z&&(n=t._z.offset(t),Math.abs(n)<16&&(n/=60),void 0!==t.utcOffset?t.utcOffset(-n,i):t.zone(n,i))},z.tz=function(t){return t?(this._z=y(t),this._z?e.updateOffset(this):A("Moment Timezone has no data for "+t+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},z.zoneName=S(z.zoneName),z.zoneAbbr=S(z.zoneAbbr),z.utc=E(z.utc),e.tz.setDefault=function(t){return(B<2||2===B&&k<9)&&A("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+e.version+"."),e.defaultZone=t?y(t):null,e};var F=e.momentProperties;return"[object Array]"===Object.prototype.toString.call(F)?(F.push("_z"),F.push("_a")):F&&(F._z=null),e})},function(e,t,i){(function(e){!function(t,i){e.exports=i()}(this,function(){"use strict";function t(){return Mn.apply(null,arguments)}function n(e){Mn=e}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e){var t;for(t in e)return!1;return!0}function r(e){return void 0===e}function l(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function c(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function d(e,t){var i,n=[];for(i=0;i<e.length;++i)n.push(t(e[i],i));return n}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function h(e,t){for(var i in t)u(t,i)&&(e[i]=t[i]);return u(t,"toString")&&(e.toString=t.toString),u(t,"valueOf")&&(e.valueOf=t.valueOf),e}function p(e,t,i,n){return bt(e,t,i,n,!0).utc()}function m(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function f(e){return null==e._pf&&(e._pf=m()),e._pf}function g(e){if(null==e._isValid){var t=f(e),i=Tn.call(t.parsedDateParts,function(e){return null!=e}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&i);if(e._strict&&(n=n&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return n;e._isValid=n}return e._isValid}function _(e){var t=p(NaN);return null!=e?h(f(t),e):f(t).userInvalidated=!0,t}function v(e,t){var i,n,o;if(r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),r(t._i)||(e._i=t._i),r(t._f)||(e._f=t._f),r(t._l)||(e._l=t._l),r(t._strict)||(e._strict=t._strict),r(t._tzm)||(e._tzm=t._tzm),r(t._isUTC)||(e._isUTC=t._isUTC),r(t._offset)||(e._offset=t._offset),r(t._pf)||(e._pf=f(t)),r(t._locale)||(e._locale=t._locale),Cn.length>0)for(i=0;i<Cn.length;i++)n=Cn[i],o=t[n],r(o)||(e[n]=o);return e}function y(e){v(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),An===!1&&(An=!0,t.updateOffset(this),An=!1)}function b(e){return e instanceof y||null!=e&&null!=e._isAMomentObject}function M(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function w(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=M(t)),i}function T(e,t,i){var n,o=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),a=0;for(n=0;n<o;n++)(i&&e[n]!==t[n]||!i&&w(e[n])!==w(t[n]))&&a++;return a+s}function C(e){t.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function A(e,i){var n=!0;return h(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),n){for(var o,s=[],a=0;a<arguments.length;a++){if(o="","object"==typeof arguments[a]){o+="\n["+a+"] ";for(var r in arguments[0])o+=r+": "+arguments[0][r]+", ";o=o.slice(0,-2)}else o=arguments[a];s.push(o)}C(e+"\nArguments: "+Array.prototype.slice.call(s).join("")+"\n"+(new Error).stack),n=!1}return i.apply(this,arguments)},i)}function I(e,i){null!=t.deprecationHandler&&t.deprecationHandler(e,i),In[e]||(C(i),In[e]=!0)}function S(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function E(e){var t,i;for(i in e)t=e[i],S(t)?this[i]=t:this["_"+i]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function x(e,t){var i,n=h({},e);for(i in t)u(t,i)&&(s(e[i])&&s(t[i])?(n[i]={},h(n[i],e[i]),h(n[i],t[i])):null!=t[i]?n[i]=t[i]:delete n[i]);for(i in e)u(e,i)&&!u(t,i)&&s(e[i])&&(n[i]=h({},n[i]));return n}function N(e){null!=e&&this.set(e)}function L(e,t,i){var n=this._calendar[e]||this._calendar.sameElse;return S(n)?n.call(t,i):n}function O(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];return t||!i?t:(this._longDateFormat[e]=i.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function D(){return this._invalidDate}function R(e){return this._ordinal.replace("%d",e)}function P(e,t,i,n){var o=this._relativeTime[i];return S(o)?o(e,t,i,n):o.replace(/%d/i,e)}function B(e,t){var i=this._relativeTime[e>0?"future":"past"];return S(i)?i(t):i.replace(/%s/i,t)}function k(e,t){var i=e.toLowerCase();Bn[i]=Bn[i+"s"]=Bn[t]=e}function z(e){return"string"==typeof e?Bn[e]||Bn[e.toLowerCase()]:void 0}function F(e){var t,i,n={};for(i in e)u(e,i)&&(t=z(i),t&&(n[t]=e[i]));return n}function H(e,t){kn[e]=t}function q(e){var t=[];for(var i in e)t.push({unit:i,priority:kn[i]});return t.sort(function(e,t){return e.priority-t.priority}),t}function W(e,i){return function(n){return null!=n?(G(this,e,n),t.updateOffset(this,i),this):U(this,e)}}function U(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function G(e,t,i){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](i)}function j(e){return e=z(e),S(this[e])?this[e]():this}function Y(e,t){if("object"==typeof e){e=F(e);for(var i=q(e),n=0;n<i.length;n++)this[i[n].unit](e[i[n].unit])}else if(e=z(e),S(this[e]))return this[e](t);return this}function V(e,t,i){var n=""+Math.abs(e),o=t-n.length,s=e>=0;return(s?i?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}function X(e,t,i,n){var o=n;"string"==typeof n&&(o=function(){return this[n]()}),e&&(qn[e]=o),t&&(qn[t[0]]=function(){return V(o.apply(this,arguments),t[1],t[2])}),i&&(qn[i]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function Q(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function K(e){var t,i,n=e.match(zn);for(t=0,i=n.length;t<i;t++)qn[n[t]]?n[t]=qn[n[t]]:n[t]=Q(n[t]);return function(t){var o,s="";for(o=0;o<i;o++)s+=S(n[o])?n[o].call(t,e):n[o];return s}}function J(e,t){return e.isValid()?(t=Z(t,e.localeData()),Hn[t]=Hn[t]||K(t),Hn[t](e)):e.localeData().invalidDate()}function Z(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(Fn.lastIndex=0;n>=0&&Fn.test(e);)e=e.replace(Fn,i),Fn.lastIndex=0,n-=1;return e}function $(e,t,i){so[e]=S(t)?t:function(e,n){return e&&i?i:t}}function ee(e,t){return u(so,e)?so[e](t._strict,t._locale):new RegExp(te(e))}function te(e){return ie(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,o){return t||i||n||o}))}function ie(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ne(e,t){var i,n=t;for("string"==typeof e&&(e=[e]),l(t)&&(n=function(e,i){i[t]=w(e)}),i=0;i<e.length;i++)ao[e[i]]=n}function oe(e,t){ne(e,function(e,i,n,o){n._w=n._w||{},t(e,n._w,n,o)})}function se(e,t,i){null!=t&&u(ao,e)&&ao[e](t,i._a,i,e)}function ae(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function re(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||vo).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone}function le(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[vo.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ce(e,t,i){var n,o,s,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=p([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return i?"MMM"===t?(o=_o.call(this._shortMonthsParse,a),o!==-1?o:null):(o=_o.call(this._longMonthsParse,a),o!==-1?o:null):"MMM"===t?(o=_o.call(this._shortMonthsParse,a),o!==-1?o:(o=_o.call(this._longMonthsParse,a),o!==-1?o:null)):(o=_o.call(this._longMonthsParse,a),o!==-1?o:(o=_o.call(this._shortMonthsParse,a),o!==-1?o:null))}function de(e,t,i){var n,o,s;if(this._monthsParseExact)return ce.call(this,e,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=p([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(s="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),i&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(i&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!i&&this._monthsParse[n].test(e))return n}}function ue(e,t){var i;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=w(t);else if(t=e.localeData().monthsParse(t),!l(t))return e;return i=Math.min(e.date(),ae(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e}function he(e){return null!=e?(ue(this,e),t.updateOffset(this,!0),this):U(this,"Month")}function pe(){return ae(this.year(),this.month())}function me(e){return this._monthsParseExact?(u(this,"_monthsRegex")||ge.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(u(this,"_monthsShortRegex")||(this._monthsShortRegex=Mo),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function fe(e){return this._monthsParseExact?(u(this,"_monthsRegex")||ge.call(this),e?this._monthsStrictRegex:this._monthsRegex):(u(this,"_monthsRegex")||(this._monthsRegex=wo),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function ge(){function e(e,t){return t.length-e.length}var t,i,n=[],o=[],s=[];for(t=0;t<12;t++)i=p([2e3,t]),n.push(this.monthsShort(i,"")),o.push(this.months(i,"")),s.push(this.months(i,"")),s.push(this.monthsShort(i,""));for(n.sort(e),o.sort(e),s.sort(e),t=0;t<12;t++)n[t]=ie(n[t]),o[t]=ie(o[t]);for(t=0;t<24;t++)s[t]=ie(s[t]);this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function _e(e){return ve(e)?366:365}function ve(e){return e%4===0&&e%100!==0||e%400===0}function ye(){return ve(this.year())}function be(e,t,i,n,o,s,a){var r=new Date(e,t,i,n,o,s,a);return e<100&&e>=0&&isFinite(r.getFullYear())&&r.setFullYear(e),r}function Me(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function we(e,t,i){var n=7+t-i,o=(7+Me(e,0,n).getUTCDay()-t)%7;return-o+n-1}function Te(e,t,i,n,o){var s,a,r=(7+i-n)%7,l=we(e,n,o),c=1+7*(t-1)+r+l;return c<=0?(s=e-1,a=_e(s)+c):c>_e(e)?(s=e+1,a=c-_e(e)):(s=e,a=c),{year:s,dayOfYear:a}}function Ce(e,t,i){var n,o,s=we(e.year(),t,i),a=Math.floor((e.dayOfYear()-s-1)/7)+1;return a<1?(o=e.year()-1,n=a+Ae(o,t,i)):a>Ae(e.year(),t,i)?(n=a-Ae(e.year(),t,i),o=e.year()+1):(o=e.year(),n=a),{week:n,year:o}}function Ae(e,t,i){var n=we(e,t,i),o=we(e+1,t,i);return(_e(e)-n+o)/7}function Ie(e){return Ce(e,this._week.dow,this._week.doy).week}function Se(){return this._week.dow}function Ee(){return this._week.doy}function xe(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Ne(e){var t=Ce(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Le(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Oe(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function De(e,t){return e?o(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:o(this._weekdays)?this._weekdays:this._weekdays.standalone}function Re(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Pe(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Be(e,t,i){var n,o,s,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=p([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return i?"dddd"===t?(o=_o.call(this._weekdaysParse,a),o!==-1?o:null):"ddd"===t?(o=_o.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=_o.call(this._minWeekdaysParse,a),o!==-1?o:null):"dddd"===t?(o=_o.call(this._weekdaysParse,a),o!==-1?o:(o=_o.call(this._shortWeekdaysParse,a),o!==-1?o:(o=_o.call(this._minWeekdaysParse,a),o!==-1?o:null))):"ddd"===t?(o=_o.call(this._shortWeekdaysParse,a),o!==-1?o:(o=_o.call(this._weekdaysParse,a),o!==-1?o:(o=_o.call(this._minWeekdaysParse,a),o!==-1?o:null))):(o=_o.call(this._minWeekdaysParse,a),o!==-1?o:(o=_o.call(this._weekdaysParse,a),o!==-1?o:(o=_o.call(this._shortWeekdaysParse,a),o!==-1?o:null)))}function ke(e,t,i){var n,o,s;if(this._weekdaysParseExact)return Be.call(this,e,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=p([2e3,1]).day(n),i&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".",".?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),i&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(i&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(i&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!i&&this._weekdaysParse[n].test(e))return n}}function ze(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Le(e,this.localeData()),this.add(e-t,"d")):t}function Fe(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function He(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Oe(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function qe(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||Ge.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(u(this,"_weekdaysRegex")||(this._weekdaysRegex=Eo),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function We(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||Ge.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(u(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=xo),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ue(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||Ge.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(u(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=No),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ge(){function e(e,t){return t.length-e.length}var t,i,n,o,s,a=[],r=[],l=[],c=[];for(t=0;t<7;t++)i=p([2e3,1]).day(t),n=this.weekdaysMin(i,""),o=this.weekdaysShort(i,""),s=this.weekdays(i,""),a.push(n),r.push(o),l.push(s),c.push(n),c.push(o),c.push(s);for(a.sort(e),r.sort(e),l.sort(e),c.sort(e),t=0;t<7;t++)r[t]=ie(r[t]),l[t]=ie(l[t]),c[t]=ie(c[t]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function je(){return this.hours()%12||12}function Ye(){return this.hours()||24}function Ve(e,t){X(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Xe(e,t){return t._meridiemParse}function Qe(e){return"p"===(e+"").toLowerCase().charAt(0)}function Ke(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"}function Je(e){return e?e.toLowerCase().replace("_","-"):e}function Ze(e){for(var t,i,n,o,s=0;s<e.length;){for(o=Je(e[s]).split("-"),t=o.length,i=Je(e[s+1]),i=i?i.split("-"):null;t>0;){if(n=$e(o.slice(0,t).join("-")))return n;if(i&&i.length>=t&&T(o,i,!0)>=t-1)break;t--}s++}return null}function $e(t){var n=null;if(!Po[t]&&"undefined"!=typeof e&&e&&e.exports)try{n=Lo._abbr,i(48)("./"+t),et(n)}catch(o){}return Po[t]}function et(e,t){var i;return e&&(i=r(t)?nt(e):tt(e,t),i&&(Lo=i)),Lo._abbr}function tt(e,t){if(null!==t){var i=Ro;if(t.abbr=e,null!=Po[e])I("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Po[e]._config;else if(null!=t.parentLocale){if(null==Po[t.parentLocale])return Bo[t.parentLocale]||(Bo[t.parentLocale]=[]),Bo[t.parentLocale].push({name:e,config:t}),null;i=Po[t.parentLocale]._config}return Po[e]=new N(x(i,t)),Bo[e]&&Bo[e].forEach(function(e){tt(e.name,e.config)}),et(e),Po[e]}return delete Po[e],null}function it(e,t){if(null!=t){var i,n=Ro;null!=Po[e]&&(n=Po[e]._config),t=x(n,t),i=new N(t),i.parentLocale=Po[e],Po[e]=i,et(e)}else null!=Po[e]&&(null!=Po[e].parentLocale?Po[e]=Po[e].parentLocale:null!=Po[e]&&delete Po[e]);return Po[e]}function nt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Lo;if(!o(e)){if(t=$e(e))return t;e=[e]}return Ze(e)}function ot(){return xn(Po)}function st(e){var t,i=e._a;return i&&f(e).overflow===-2&&(t=i[lo]<0||i[lo]>11?lo:i[co]<1||i[co]>ae(i[ro],i[lo])?co:i[uo]<0||i[uo]>24||24===i[uo]&&(0!==i[ho]||0!==i[po]||0!==i[mo])?uo:i[ho]<0||i[ho]>59?ho:i[po]<0||i[po]>59?po:i[mo]<0||i[mo]>999?mo:-1,f(e)._overflowDayOfYear&&(t<ro||t>co)&&(t=co),f(e)._overflowWeeks&&t===-1&&(t=fo),f(e)._overflowWeekday&&t===-1&&(t=go),f(e).overflow=t),e}function at(e){var t,i,n,o,s,a,r=e._i,l=ko.exec(r)||zo.exec(r);if(l){for(f(e).iso=!0,t=0,i=Ho.length;t<i;t++)if(Ho[t][1].exec(l[1])){o=Ho[t][0],n=Ho[t][2]!==!1;break}if(null==o)return void(e._isValid=!1);if(l[3]){for(t=0,i=qo.length;t<i;t++)if(qo[t][1].exec(l[3])){s=(l[2]||" ")+qo[t][0];break}if(null==s)return void(e._isValid=!1)}if(!n&&null!=s)return void(e._isValid=!1);if(l[4]){if(!Fo.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=o+(s||"")+(a||""),pt(e)}else e._isValid=!1}function rt(e){var t,i,n,o,s,a,r,l,c={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},d="YXWVUTSRQPONZABCDEFGHIKLM";if(t=e._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),i=Uo.exec(t)){if(n=i[1]?"ddd"+(5===i[1].length?", ":" "):"",o="D MMM "+(i[2].length>10?"YYYY ":"YY "),s="HH:mm"+(i[4]?":ss":""),i[1]){var u=new Date(i[2]),h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][u.getDay()];if(i[1].substr(0,3)!==h)return f(e).weekdayMismatch=!0,void(e._isValid=!1)}switch(i[5].length){case 2:0===l?r=" +0000":(l=d.indexOf(i[5][1].toUpperCase())-12,r=(l<0?" -":" +")+(""+l).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:r=c[i[5]];break;default:r=c[" GMT"]}i[5]=r,e._i=i.splice(1).join(""),a=" ZZ",e._f=n+o+s+a,pt(e),f(e).rfc2822=!0}else e._isValid=!1}function lt(e){var i=Wo.exec(e._i);return null!==i?void(e._d=new Date((+i[1]))):(at(e),void(e._isValid===!1&&(delete e._isValid,rt(e),e._isValid===!1&&(delete e._isValid,t.createFromInputFallback(e)))))}function ct(e,t,i){return null!=e?e:null!=t?t:i}function dt(e){var i=new Date(t.now());return e._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function ut(e){var t,i,n,o,s=[];if(!e._d){for(n=dt(e),e._w&&null==e._a[co]&&null==e._a[lo]&&ht(e),null!=e._dayOfYear&&(o=ct(e._a[ro],n[ro]),(e._dayOfYear>_e(o)||0===e._dayOfYear)&&(f(e)._overflowDayOfYear=!0),i=Me(o,0,e._dayOfYear),e._a[lo]=i.getUTCMonth(),e._a[co]=i.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=n[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[uo]&&0===e._a[ho]&&0===e._a[po]&&0===e._a[mo]&&(e._nextDay=!0,e._a[uo]=0),e._d=(e._useUTC?Me:be).apply(null,s),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[uo]=24)}}function ht(e){var t,i,n,o,s,a,r,l;if(t=e._w,null!=t.GG||null!=t.W||null!=t.E)s=1,a=4,i=ct(t.GG,e._a[ro],Ce(Mt(),1,4).year),n=ct(t.W,1),o=ct(t.E,1),(o<1||o>7)&&(l=!0);else{s=e._locale._week.dow,a=e._locale._week.doy;var c=Ce(Mt(),s,a);i=ct(t.gg,e._a[ro],c.year),n=ct(t.w,c.week),null!=t.d?(o=t.d,(o<0||o>6)&&(l=!0)):null!=t.e?(o=t.e+s,(t.e<0||t.e>6)&&(l=!0)):o=s}n<1||n>Ae(i,s,a)?f(e)._overflowWeeks=!0:null!=l?f(e)._overflowWeekday=!0:(r=Te(i,n,o,s,a),e._a[ro]=r.year,e._dayOfYear=r.dayOfYear)}function pt(e){if(e._f===t.ISO_8601)return void at(e);if(e._f===t.RFC_2822)return void rt(e);e._a=[],f(e).empty=!0;var i,n,o,s,a,r=""+e._i,l=r.length,c=0;for(o=Z(e._f,e._locale).match(zn)||[],i=0;i<o.length;i++)s=o[i],n=(r.match(ee(s,e))||[])[0],n&&(a=r.substr(0,r.indexOf(n)),a.length>0&&f(e).unusedInput.push(a),r=r.slice(r.indexOf(n)+n.length),c+=n.length),qn[s]?(n?f(e).empty=!1:f(e).unusedTokens.push(s),se(s,n,e)):e._strict&&!n&&f(e).unusedTokens.push(s);f(e).charsLeftOver=l-c,r.length>0&&f(e).unusedInput.push(r),e._a[uo]<=12&&f(e).bigHour===!0&&e._a[uo]>0&&(f(e).bigHour=void 0),f(e).parsedDateParts=e._a.slice(0),f(e).meridiem=e._meridiem,e._a[uo]=mt(e._locale,e._a[uo],e._meridiem),ut(e),st(e)}function mt(e,t,i){var n;return null==i?t:null!=e.meridiemHour?e.meridiemHour(t,i):null!=e.isPM?(n=e.isPM(i),n&&t<12&&(t+=12),n||12!==t||(t=0),t):t}function ft(e){var t,i,n,o,s;if(0===e._f.length)return f(e).invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<e._f.length;o++)s=0,t=v({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],pt(t),g(t)&&(s+=f(t).charsLeftOver,s+=10*f(t).unusedTokens.length,f(t).score=s,(null==n||s<n)&&(n=s,i=t));h(e,i||t)}function gt(e){if(!e._d){var t=F(e._i);e._a=d([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ut(e)}}function _t(e){var t=new y(st(vt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function vt(e){var t=e._i,i=e._f;return e._locale=e._locale||nt(e._l),null===t||void 0===i&&""===t?_({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),b(t)?new y(st(t)):(c(t)?e._d=t:o(i)?ft(e):i?pt(e):yt(e),g(e)||(e._d=null),e))}function yt(e){var i=e._i;r(i)?e._d=new Date(t.now()):c(i)?e._d=new Date(i.valueOf()):"string"==typeof i?lt(e):o(i)?(e._a=d(i.slice(0),function(e){return parseInt(e,10)}),ut(e)):s(i)?gt(e):l(i)?e._d=new Date(i):t.createFromInputFallback(e)}function bt(e,t,i,n,r){var l={};return i!==!0&&i!==!1||(n=i,i=void 0),(s(e)&&a(e)||o(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=r,l._l=i,l._i=e,l._f=t,l._strict=n,_t(l)}function Mt(e,t,i,n){return bt(e,t,i,n,!1)}function wt(e,t){var i,n;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Mt();for(i=t[0],n=1;n<t.length;++n)t[n].isValid()&&!t[n][e](i)||(i=t[n]);return i}function Tt(){var e=[].slice.call(arguments,0);return wt("isBefore",e)}function Ct(){var e=[].slice.call(arguments,0);return wt("isAfter",e)}function At(e){for(var t in e)if(Vo.indexOf(t)===-1||null!=e[t]&&isNaN(e[t]))return!1;for(var i=!1,n=0;n<Vo.length;++n)if(e[Vo[n]]){if(i)return!1;parseFloat(e[Vo[n]])!==w(e[Vo[n]])&&(i=!0)}return!0}function It(){return this._isValid}function St(){return Yt(NaN)}function Et(e){var t=F(e),i=t.year||0,n=t.quarter||0,o=t.month||0,s=t.week||0,a=t.day||0,r=t.hour||0,l=t.minute||0,c=t.second||0,d=t.millisecond||0;this._isValid=At(t),this._milliseconds=+d+1e3*c+6e4*l+1e3*r*60*60,this._days=+a+7*s,this._months=+o+3*n+12*i,this._data={},this._locale=nt(),this._bubble()}function xt(e){return e instanceof Et}function Nt(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Lt(e,t){X(e,0,0,function(){var e=this.utcOffset(),i="+";return e<0&&(e=-e,i="-"),i+V(~~(e/60),2)+t+V(~~e%60,2)})}function Ot(e,t){var i=(t||"").match(e);if(null===i)return null;var n=i[i.length-1]||[],o=(n+"").match(Xo)||["-",0,0],s=+(60*o[1])+w(o[2]);return 0===s?0:"+"===o[0]?s:-s}function Dt(e,i){var n,o;return i._isUTC?(n=i.clone(),o=(b(e)||c(e)?e.valueOf():Mt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+o),t.updateOffset(n,!1),n):Mt(e).local()}function Rt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Pt(e,i,n){var o,s=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(e=Ot(io,e),null===e)return this}else Math.abs(e)<16&&!n&&(e=60*e);return!this._isUTC&&i&&(o=Rt(this)),this._offset=e,this._isUTC=!0,null!=o&&this.add(o,"m"),s!==e&&(!i||this._changeInProgress?Jt(this,Yt(e-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?s:Rt(this)}function Bt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function kt(e){return this.utcOffset(0,e)}function zt(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Rt(this),"m")),this}function Ft(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ot(to,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Ht(e){return!!this.isValid()&&(e=e?Mt(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function qt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Wt(){if(!r(this._isDSTShifted))return this._isDSTShifted;var e={};if(v(e,this),e=vt(e),e._a){var t=e._isUTC?p(e._a):Mt(e._a);this._isDSTShifted=this.isValid()&&T(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Ut(){return!!this.isValid()&&!this._isUTC}function Gt(){
return!!this.isValid()&&this._isUTC}function jt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Yt(e,t){var i,n,o,s=e,a=null;return xt(e)?s={ms:e._milliseconds,d:e._days,M:e._months}:l(e)?(s={},t?s[t]=e:s.milliseconds=e):(a=Qo.exec(e))?(i="-"===a[1]?-1:1,s={y:0,d:w(a[co])*i,h:w(a[uo])*i,m:w(a[ho])*i,s:w(a[po])*i,ms:w(Nt(1e3*a[mo]))*i}):(a=Ko.exec(e))?(i="-"===a[1]?-1:1,s={y:Vt(a[2],i),M:Vt(a[3],i),w:Vt(a[4],i),d:Vt(a[5],i),h:Vt(a[6],i),m:Vt(a[7],i),s:Vt(a[8],i)}):null==s?s={}:"object"==typeof s&&("from"in s||"to"in s)&&(o=Qt(Mt(s.from),Mt(s.to)),s={},s.ms=o.milliseconds,s.M=o.months),n=new Et(s),xt(e)&&u(e,"_locale")&&(n._locale=e._locale),n}function Vt(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function Xt(e,t){var i={milliseconds:0,months:0};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function Qt(e,t){var i;return e.isValid()&&t.isValid()?(t=Dt(t,e),e.isBefore(t)?i=Xt(e,t):(i=Xt(t,e),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function Kt(e,t){return function(i,n){var o,s;return null===n||isNaN(+n)||(I(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=i,i=n,n=s),i="string"==typeof i?+i:i,o=Yt(i,n),Jt(this,o,e),this}}function Jt(e,i,n,o){var s=i._milliseconds,a=Nt(i._days),r=Nt(i._months);e.isValid()&&(o=null==o||o,s&&e._d.setTime(e._d.valueOf()+s*n),a&&G(e,"Date",U(e,"Date")+a*n),r&&ue(e,U(e,"Month")+r*n),o&&t.updateOffset(e,a||r))}function Zt(e,t){var i=e.diff(t,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function $t(e,i){var n=e||Mt(),o=Dt(n,this).startOf("day"),s=t.calendarFormat(this,o)||"sameElse",a=i&&(S(i[s])?i[s].call(this,n):i[s]);return this.format(a||this.localeData().calendar(s,this,Mt(n)))}function ei(){return new y(this)}function ti(e,t){var i=b(e)?e:Mt(e);return!(!this.isValid()||!i.isValid())&&(t=z(r(t)?"millisecond":t),"millisecond"===t?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf())}function ii(e,t){var i=b(e)?e:Mt(e);return!(!this.isValid()||!i.isValid())&&(t=z(r(t)?"millisecond":t),"millisecond"===t?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf())}function ni(e,t,i,n){return n=n||"()",("("===n[0]?this.isAfter(e,i):!this.isBefore(e,i))&&(")"===n[1]?this.isBefore(t,i):!this.isAfter(t,i))}function oi(e,t){var i,n=b(e)?e:Mt(e);return!(!this.isValid()||!n.isValid())&&(t=z(t||"millisecond"),"millisecond"===t?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(t).valueOf()<=i&&i<=this.clone().endOf(t).valueOf()))}function si(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function ai(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function ri(e,t,i){var n,o,s,a;return this.isValid()?(n=Dt(e,this),n.isValid()?(o=6e4*(n.utcOffset()-this.utcOffset()),t=z(t),"year"===t||"month"===t||"quarter"===t?(a=li(this,n),"quarter"===t?a/=3:"year"===t&&(a/=12)):(s=this-n,a="second"===t?s/1e3:"minute"===t?s/6e4:"hour"===t?s/36e5:"day"===t?(s-o)/864e5:"week"===t?(s-o)/6048e5:s),i?a:M(a)):NaN):NaN}function li(e,t){var i,n,o=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(o,"months");return t-s<0?(i=e.clone().add(o-1,"months"),n=(t-s)/(s-i)):(i=e.clone().add(o+1,"months"),n=(t-s)/(i-s)),-(o+n)||0}function ci(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function di(){if(!this.isValid())return null;var e=this.clone().utc();return e.year()<0||e.year()>9999?J(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):S(Date.prototype.toISOString)?this.toDate().toISOString():J(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function ui(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var i="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",s=t+'[")]';return this.format(i+n+o+s)}function hi(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var i=J(this,e);return this.localeData().postformat(i)}function pi(e,t){return this.isValid()&&(b(e)&&e.isValid()||Mt(e).isValid())?Yt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function mi(e){return this.from(Mt(),e)}function fi(e,t){return this.isValid()&&(b(e)&&e.isValid()||Mt(e).isValid())?Yt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function gi(e){return this.to(Mt(),e)}function _i(e){var t;return void 0===e?this._locale._abbr:(t=nt(e),null!=t&&(this._locale=t),this)}function vi(){return this._locale}function yi(e){switch(e=z(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function bi(e){return e=z(e),void 0===e||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function Mi(){return this._d.valueOf()-6e4*(this._offset||0)}function wi(){return Math.floor(this.valueOf()/1e3)}function Ti(){return new Date(this.valueOf())}function Ci(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Ai(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ii(){return this.isValid()?this.toISOString():null}function Si(){return g(this)}function Ei(){return h({},f(this))}function xi(){return f(this).overflow}function Ni(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Li(e,t){X(0,[e,e.length],0,t)}function Oi(e){return Bi.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Di(e){return Bi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Ri(){return Ae(this.year(),1,4)}function Pi(){var e=this.localeData()._week;return Ae(this.year(),e.dow,e.doy)}function Bi(e,t,i,n,o){var s;return null==e?Ce(this,n,o).year:(s=Ae(e,n,o),t>s&&(t=s),ki.call(this,e,t,i,n,o))}function ki(e,t,i,n,o){var s=Te(e,t,i,n,o),a=Me(s.year,0,s.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function zi(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Fi(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function Hi(e,t){t[mo]=w(1e3*("0."+e))}function qi(){return this._isUTC?"UTC":""}function Wi(){return this._isUTC?"Coordinated Universal Time":""}function Ui(e){return Mt(1e3*e)}function Gi(){return Mt.apply(null,arguments).parseZone()}function ji(e){return e}function Yi(e,t,i,n){var o=nt(),s=p().set(n,t);return o[i](s,e)}function Vi(e,t,i){if(l(e)&&(t=e,e=void 0),e=e||"",null!=t)return Yi(e,t,i,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Yi(e,n,i,"month");return o}function Xi(e,t,i,n){"boolean"==typeof e?(l(t)&&(i=t,t=void 0),t=t||""):(t=e,i=t,e=!1,l(t)&&(i=t,t=void 0),t=t||"");var o=nt(),s=e?o._week.dow:0;if(null!=i)return Yi(t,(i+s)%7,n,"day");var a,r=[];for(a=0;a<7;a++)r[a]=Yi(t,(a+s)%7,n,"day");return r}function Qi(e,t){return Vi(e,t,"months")}function Ki(e,t){return Vi(e,t,"monthsShort")}function Ji(e,t,i){return Xi(e,t,i,"weekdays")}function Zi(e,t,i){return Xi(e,t,i,"weekdaysShort")}function $i(e,t,i){return Xi(e,t,i,"weekdaysMin")}function en(){var e=this._data;return this._milliseconds=rs(this._milliseconds),this._days=rs(this._days),this._months=rs(this._months),e.milliseconds=rs(e.milliseconds),e.seconds=rs(e.seconds),e.minutes=rs(e.minutes),e.hours=rs(e.hours),e.months=rs(e.months),e.years=rs(e.years),this}function tn(e,t,i,n){var o=Yt(t,i);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function nn(e,t){return tn(this,e,t,1)}function on(e,t){return tn(this,e,t,-1)}function sn(e){return e<0?Math.floor(e):Math.ceil(e)}function an(){var e,t,i,n,o,s=this._milliseconds,a=this._days,r=this._months,l=this._data;return s>=0&&a>=0&&r>=0||s<=0&&a<=0&&r<=0||(s+=864e5*sn(ln(r)+a),a=0,r=0),l.milliseconds=s%1e3,e=M(s/1e3),l.seconds=e%60,t=M(e/60),l.minutes=t%60,i=M(t/60),l.hours=i%24,a+=M(i/24),o=M(rn(a)),r+=o,a-=sn(ln(o)),n=M(r/12),r%=12,l.days=a,l.months=r,l.years=n,this}function rn(e){return 4800*e/146097}function ln(e){return 146097*e/4800}function cn(e){if(!this.isValid())return NaN;var t,i,n=this._milliseconds;if(e=z(e),"month"===e||"year"===e)return t=this._days+n/864e5,i=this._months+rn(t),"month"===e?i:i/12;switch(t=this._days+Math.round(ln(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}}function dn(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*w(this._months/12):NaN}function un(e){return function(){return this.as(e)}}function hn(e){return e=z(e),this.isValid()?this[e+"s"]():NaN}function pn(e){return function(){return this.isValid()?this._data[e]:NaN}}function mn(){return M(this.days()/7)}function fn(e,t,i,n,o){return o.relativeTime(t||1,!!i,e,n)}function gn(e,t,i){var n=Yt(e).abs(),o=Ts(n.as("s")),s=Ts(n.as("m")),a=Ts(n.as("h")),r=Ts(n.as("d")),l=Ts(n.as("M")),c=Ts(n.as("y")),d=o<=Cs.ss&&["s",o]||o<Cs.s&&["ss",o]||s<=1&&["m"]||s<Cs.m&&["mm",s]||a<=1&&["h"]||a<Cs.h&&["hh",a]||r<=1&&["d"]||r<Cs.d&&["dd",r]||l<=1&&["M"]||l<Cs.M&&["MM",l]||c<=1&&["y"]||["yy",c];return d[2]=t,d[3]=+e>0,d[4]=i,fn.apply(null,d)}function _n(e){return void 0===e?Ts:"function"==typeof e&&(Ts=e,!0)}function vn(e,t){return void 0!==Cs[e]&&(void 0===t?Cs[e]:(Cs[e]=t,"s"===e&&(Cs.ss=t-1),!0))}function yn(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),i=gn(this,!e,t);return e&&(i=t.pastFuture(+this,i)),t.postformat(i)}function bn(){if(!this.isValid())return this.localeData().invalidDate();var e,t,i,n=As(this._milliseconds)/1e3,o=As(this._days),s=As(this._months);e=M(n/60),t=M(e/60),n%=60,e%=60,i=M(s/12),s%=12;var a=i,r=s,l=o,c=t,d=e,u=n,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(a?a+"Y":"")+(r?r+"M":"")+(l?l+"D":"")+(c||d||u?"T":"")+(c?c+"H":"")+(d?d+"M":"")+(u?u+"S":""):"P0D"}var Mn,wn;wn=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),i=t.length>>>0,n=0;n<i;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};var Tn=wn,Cn=t.momentProperties=[],An=!1,In={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var Sn;Sn=Object.keys?Object.keys:function(e){var t,i=[];for(t in e)u(e,t)&&i.push(t);return i};var En,xn=Sn,Nn={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Ln={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},On="Invalid date",Dn="%d",Rn=/\d{1,2}/,Pn={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Bn={},kn={},zn=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Fn=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Hn={},qn={},Wn=/\d/,Un=/\d\d/,Gn=/\d{3}/,jn=/\d{4}/,Yn=/[+-]?\d{6}/,Vn=/\d\d?/,Xn=/\d\d\d\d?/,Qn=/\d\d\d\d\d\d?/,Kn=/\d{1,3}/,Jn=/\d{1,4}/,Zn=/[+-]?\d{1,6}/,$n=/\d+/,eo=/[+-]?\d+/,to=/Z|[+-]\d\d:?\d\d/gi,io=/Z|[+-]\d\d(?::?\d\d)?/gi,no=/[+-]?\d+(\.\d{1,3})?/,oo=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,so={},ao={},ro=0,lo=1,co=2,uo=3,ho=4,po=5,mo=6,fo=7,go=8;En=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};var _o=En;X("M",["MM",2],"Mo",function(){return this.month()+1}),X("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),X("MMMM",0,0,function(e){return this.localeData().months(this,e)}),k("month","M"),H("month",8),$("M",Vn),$("MM",Vn,Un),$("MMM",function(e,t){return t.monthsShortRegex(e)}),$("MMMM",function(e,t){return t.monthsRegex(e)}),ne(["M","MM"],function(e,t){t[lo]=w(e)-1}),ne(["MMM","MMMM"],function(e,t,i,n){var o=i._locale.monthsParse(e,n,i._strict);null!=o?t[lo]=o:f(i).invalidMonth=e});var vo=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,yo="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),bo="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Mo=oo,wo=oo;X("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),X(0,["YY",2],0,function(){return this.year()%100}),X(0,["YYYY",4],0,"year"),X(0,["YYYYY",5],0,"year"),X(0,["YYYYYY",6,!0],0,"year"),k("year","y"),H("year",1),$("Y",eo),$("YY",Vn,Un),$("YYYY",Jn,jn),$("YYYYY",Zn,Yn),$("YYYYYY",Zn,Yn),ne(["YYYYY","YYYYYY"],ro),ne("YYYY",function(e,i){i[ro]=2===e.length?t.parseTwoDigitYear(e):w(e)}),ne("YY",function(e,i){i[ro]=t.parseTwoDigitYear(e)}),ne("Y",function(e,t){t[ro]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return w(e)+(w(e)>68?1900:2e3)};var To=W("FullYear",!0);X("w",["ww",2],"wo","week"),X("W",["WW",2],"Wo","isoWeek"),k("week","w"),k("isoWeek","W"),H("week",5),H("isoWeek",5),$("w",Vn),$("ww",Vn,Un),$("W",Vn),$("WW",Vn,Un),oe(["w","ww","W","WW"],function(e,t,i,n){t[n.substr(0,1)]=w(e)});var Co={dow:0,doy:6};X("d",0,"do","day"),X("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),X("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),X("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),X("e",0,0,"weekday"),X("E",0,0,"isoWeekday"),k("day","d"),k("weekday","e"),k("isoWeekday","E"),H("day",11),H("weekday",11),H("isoWeekday",11),$("d",Vn),$("e",Vn),$("E",Vn),$("dd",function(e,t){return t.weekdaysMinRegex(e)}),$("ddd",function(e,t){return t.weekdaysShortRegex(e)}),$("dddd",function(e,t){return t.weekdaysRegex(e)}),oe(["dd","ddd","dddd"],function(e,t,i,n){var o=i._locale.weekdaysParse(e,n,i._strict);null!=o?t.d=o:f(i).invalidWeekday=e}),oe(["d","e","E"],function(e,t,i,n){t[n]=w(e)});var Ao="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Io="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),So="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Eo=oo,xo=oo,No=oo;X("H",["HH",2],0,"hour"),X("h",["hh",2],0,je),X("k",["kk",2],0,Ye),X("hmm",0,0,function(){return""+je.apply(this)+V(this.minutes(),2)}),X("hmmss",0,0,function(){return""+je.apply(this)+V(this.minutes(),2)+V(this.seconds(),2)}),X("Hmm",0,0,function(){return""+this.hours()+V(this.minutes(),2)}),X("Hmmss",0,0,function(){return""+this.hours()+V(this.minutes(),2)+V(this.seconds(),2)}),Ve("a",!0),Ve("A",!1),k("hour","h"),H("hour",13),$("a",Xe),$("A",Xe),$("H",Vn),$("h",Vn),$("k",Vn),$("HH",Vn,Un),$("hh",Vn,Un),$("kk",Vn,Un),$("hmm",Xn),$("hmmss",Qn),$("Hmm",Xn),$("Hmmss",Qn),ne(["H","HH"],uo),ne(["k","kk"],function(e,t,i){var n=w(e);t[uo]=24===n?0:n}),ne(["a","A"],function(e,t,i){i._isPm=i._locale.isPM(e),i._meridiem=e}),ne(["h","hh"],function(e,t,i){t[uo]=w(e),f(i).bigHour=!0}),ne("hmm",function(e,t,i){var n=e.length-2;t[uo]=w(e.substr(0,n)),t[ho]=w(e.substr(n)),f(i).bigHour=!0}),ne("hmmss",function(e,t,i){var n=e.length-4,o=e.length-2;t[uo]=w(e.substr(0,n)),t[ho]=w(e.substr(n,2)),t[po]=w(e.substr(o)),f(i).bigHour=!0}),ne("Hmm",function(e,t,i){var n=e.length-2;t[uo]=w(e.substr(0,n)),t[ho]=w(e.substr(n))}),ne("Hmmss",function(e,t,i){var n=e.length-4,o=e.length-2;t[uo]=w(e.substr(0,n)),t[ho]=w(e.substr(n,2)),t[po]=w(e.substr(o))});var Lo,Oo=/[ap]\.?m?\.?/i,Do=W("Hours",!0),Ro={calendar:Nn,longDateFormat:Ln,invalidDate:On,ordinal:Dn,dayOfMonthOrdinalParse:Rn,relativeTime:Pn,months:yo,monthsShort:bo,week:Co,weekdays:Ao,weekdaysMin:So,weekdaysShort:Io,meridiemParse:Oo},Po={},Bo={},ko=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,zo=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Fo=/Z|[+-]\d\d(?::?\d\d)?/,Ho=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],qo=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Wo=/^\/?Date\((\-?\d+)/i,Uo=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;t.createFromInputFallback=A("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var Go=A("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Mt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:_()}),jo=A("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Mt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:_()}),Yo=function(){return Date.now?Date.now():+new Date},Vo=["year","quarter","month","week","day","hour","minute","second","millisecond"];Lt("Z",":"),Lt("ZZ",""),$("Z",io),$("ZZ",io),ne(["Z","ZZ"],function(e,t,i){i._useUTC=!0,i._tzm=Ot(io,e)});var Xo=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var Qo=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ko=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Yt.fn=Et.prototype,Yt.invalid=St;var Jo=Kt(1,"add"),Zo=Kt(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var $o=A("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});X(0,["gg",2],0,function(){return this.weekYear()%100}),X(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Li("gggg","weekYear"),Li("ggggg","weekYear"),Li("GGGG","isoWeekYear"),Li("GGGGG","isoWeekYear"),k("weekYear","gg"),k("isoWeekYear","GG"),H("weekYear",1),H("isoWeekYear",1),$("G",eo),$("g",eo),$("GG",Vn,Un),$("gg",Vn,Un),$("GGGG",Jn,jn),$("gggg",Jn,jn),$("GGGGG",Zn,Yn),$("ggggg",Zn,Yn),oe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,i,n){t[n.substr(0,2)]=w(e)}),oe(["gg","GG"],function(e,i,n,o){i[o]=t.parseTwoDigitYear(e)}),X("Q",0,"Qo","quarter"),k("quarter","Q"),H("quarter",7),$("Q",Wn),ne("Q",function(e,t){t[lo]=3*(w(e)-1)}),X("D",["DD",2],"Do","date"),k("date","D"),H("date",9),$("D",Vn),$("DD",Vn,Un),$("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ne(["D","DD"],co),ne("Do",function(e,t){t[co]=w(e.match(Vn)[0],10)});var es=W("Date",!0);X("DDD",["DDDD",3],"DDDo","dayOfYear"),k("dayOfYear","DDD"),H("dayOfYear",4),$("DDD",Kn),$("DDDD",Gn),ne(["DDD","DDDD"],function(e,t,i){i._dayOfYear=w(e)}),X("m",["mm",2],0,"minute"),k("minute","m"),H("minute",14),$("m",Vn),$("mm",Vn,Un),ne(["m","mm"],ho);var ts=W("Minutes",!1);X("s",["ss",2],0,"second"),k("second","s"),H("second",15),$("s",Vn),$("ss",Vn,Un),ne(["s","ss"],po);var is=W("Seconds",!1);X("S",0,0,function(){return~~(this.millisecond()/100)}),X(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),X(0,["SSS",3],0,"millisecond"),X(0,["SSSS",4],0,function(){return 10*this.millisecond()}),X(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),X(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),X(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),X(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),X(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),k("millisecond","ms"),H("millisecond",16),$("S",Kn,Wn),$("SS",Kn,Un),$("SSS",Kn,Gn);var ns;for(ns="SSSS";ns.length<=9;ns+="S")$(ns,$n);for(ns="S";ns.length<=9;ns+="S")ne(ns,Hi);var os=W("Milliseconds",!1);X("z",0,0,"zoneAbbr"),X("zz",0,0,"zoneName");var ss=y.prototype;ss.add=Jo,ss.calendar=$t,ss.clone=ei,ss.diff=ri,ss.endOf=bi,ss.format=hi,ss.from=pi,ss.fromNow=mi,ss.to=fi,ss.toNow=gi,ss.get=j,ss.invalidAt=xi,ss.isAfter=ti,ss.isBefore=ii,ss.isBetween=ni,ss.isSame=oi,ss.isSameOrAfter=si,ss.isSameOrBefore=ai,ss.isValid=Si,ss.lang=$o,ss.locale=_i,ss.localeData=vi,ss.max=jo,ss.min=Go,ss.parsingFlags=Ei,ss.set=Y,ss.startOf=yi,ss.subtract=Zo,ss.toArray=Ci,ss.toObject=Ai,ss.toDate=Ti,ss.toISOString=di,ss.inspect=ui,ss.toJSON=Ii,ss.toString=ci,ss.unix=wi,ss.valueOf=Mi,ss.creationData=Ni,ss.year=To,ss.isLeapYear=ye,ss.weekYear=Oi,ss.isoWeekYear=Di,ss.quarter=ss.quarters=zi,ss.month=he,ss.daysInMonth=pe,ss.week=ss.weeks=xe,ss.isoWeek=ss.isoWeeks=Ne,ss.weeksInYear=Pi,ss.isoWeeksInYear=Ri,ss.date=es,ss.day=ss.days=ze,ss.weekday=Fe,ss.isoWeekday=He,ss.dayOfYear=Fi,ss.hour=ss.hours=Do,ss.minute=ss.minutes=ts,ss.second=ss.seconds=is,ss.millisecond=ss.milliseconds=os,ss.utcOffset=Pt,ss.utc=kt,ss.local=zt,ss.parseZone=Ft,ss.hasAlignedHourOffset=Ht,ss.isDST=qt,ss.isLocal=Ut,ss.isUtcOffset=Gt,ss.isUtc=jt,ss.isUTC=jt,ss.zoneAbbr=qi,ss.zoneName=Wi,ss.dates=A("dates accessor is deprecated. Use date instead.",es),ss.months=A("months accessor is deprecated. Use month instead",he),ss.years=A("years accessor is deprecated. Use year instead",To),ss.zone=A("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Bt),ss.isDSTShifted=A("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Wt);var as=N.prototype;as.calendar=L,as.longDateFormat=O,as.invalidDate=D,as.ordinal=R,as.preparse=ji,as.postformat=ji,as.relativeTime=P,as.pastFuture=B,as.set=E,as.months=re,as.monthsShort=le,as.monthsParse=de,as.monthsRegex=fe,as.monthsShortRegex=me,as.week=Ie,as.firstDayOfYear=Ee,as.firstDayOfWeek=Se,as.weekdays=De,as.weekdaysMin=Pe,as.weekdaysShort=Re,as.weekdaysParse=ke,as.weekdaysRegex=qe,as.weekdaysShortRegex=We,as.weekdaysMinRegex=Ue,as.isPM=Qe,as.meridiem=Ke,et("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=1===w(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),t.lang=A("moment.lang is deprecated. Use moment.locale instead.",et),t.langData=A("moment.langData is deprecated. Use moment.localeData instead.",nt);var rs=Math.abs,ls=un("ms"),cs=un("s"),ds=un("m"),us=un("h"),hs=un("d"),ps=un("w"),ms=un("M"),fs=un("y"),gs=pn("milliseconds"),_s=pn("seconds"),vs=pn("minutes"),ys=pn("hours"),bs=pn("days"),Ms=pn("months"),ws=pn("years"),Ts=Math.round,Cs={ss:44,s:45,m:45,h:22,d:26,M:11},As=Math.abs,Is=Et.prototype;return Is.isValid=It,Is.abs=en,Is.add=nn,Is.subtract=on,Is.as=cn,Is.asMilliseconds=ls,Is.asSeconds=cs,Is.asMinutes=ds,Is.asHours=us,Is.asDays=hs,Is.asWeeks=ps,Is.asMonths=ms,Is.asYears=fs,Is.valueOf=dn,Is._bubble=an,Is.get=hn,Is.milliseconds=gs,Is.seconds=_s,Is.minutes=vs,Is.hours=ys,Is.days=bs,Is.weeks=mn,Is.months=Ms,Is.years=ws,Is.humanize=yn,Is.toISOString=bn,Is.toString=bn,Is.toJSON=bn,Is.locale=_i,Is.localeData=vi,Is.toIsoString=A("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",bn),Is.lang=$o,X("X",0,0,"unix"),X("x",0,0,"valueOf"),$("x",eo),$("X",no),ne("X",function(e,t,i){i._d=new Date(1e3*parseFloat(e,10))}),ne("x",function(e,t,i){i._d=new Date(w(e))}),t.version="2.18.1",n(Mt),t.fn=ss,t.min=Tt,t.max=Ct,t.now=Yo,t.utc=p,t.unix=Ui,t.months=Qi,t.isDate=c,t.locale=et,t.invalid=_,t.duration=Yt,t.isMoment=b,t.weekdays=Ji,t.parseZone=Gi,t.localeData=nt,t.isDuration=xt,t.monthsShort=Ki,t.weekdaysMin=$i,t.defineLocale=tt,t.updateLocale=it,t.locales=ot,t.weekdaysShort=Zi,t.normalizeUnits=z,t.relativeTimeRounding=_n,t.relativeTimeThreshold=vn,t.calendarFormat=Zt,t.prototype=ss,t})}).call(t,i(47)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,i){function n(e){return i(o(e))}function o(e){return s[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var s={"./af":49,"./af.js":49,"./ar":50,"./ar-dz":51,"./ar-dz.js":51,"./ar-kw":52,"./ar-kw.js":52,"./ar-ly":53,"./ar-ly.js":53,"./ar-ma":54,"./ar-ma.js":54,"./ar-sa":55,"./ar-sa.js":55,"./ar-tn":56,"./ar-tn.js":56,"./ar.js":50,"./az":57,"./az.js":57,"./be":58,"./be.js":58,"./bg":59,"./bg.js":59,"./bn":60,"./bn.js":60,"./bo":61,"./bo.js":61,"./br":62,"./br.js":62,"./bs":63,"./bs.js":63,"./ca":64,"./ca.js":64,"./cs":65,"./cs.js":65,"./cv":66,"./cv.js":66,"./cy":67,"./cy.js":67,"./da":68,"./da.js":68,"./de":69,"./de-at":70,"./de-at.js":70,"./de-ch":71,"./de-ch.js":71,"./de.js":69,"./dv":72,"./dv.js":72,"./el":73,"./el.js":73,"./en-au":74,"./en-au.js":74,"./en-ca":75,"./en-ca.js":75,"./en-gb":76,"./en-gb.js":76,"./en-ie":77,"./en-ie.js":77,"./en-nz":78,"./en-nz.js":78,"./eo":79,"./eo.js":79,"./es":80,"./es-do":81,"./es-do.js":81,"./es.js":80,"./et":82,"./et.js":82,"./eu":83,"./eu.js":83,"./fa":84,"./fa.js":84,"./fi":85,"./fi.js":85,"./fo":86,"./fo.js":86,"./fr":87,"./fr-ca":88,"./fr-ca.js":88,"./fr-ch":89,"./fr-ch.js":89,"./fr.js":87,"./fy":90,"./fy.js":90,"./gd":91,"./gd.js":91,"./gl":92,"./gl.js":92,"./gom-latn":93,"./gom-latn.js":93,"./he":94,"./he.js":94,"./hi":95,"./hi.js":95,"./hr":96,"./hr.js":96,"./hu":97,"./hu.js":97,"./hy-am":98,"./hy-am.js":98,"./id":99,"./id.js":99,"./is":100,"./is.js":100,"./it":101,"./it.js":101,"./ja":102,"./ja.js":102,"./jv":103,"./jv.js":103,"./ka":104,"./ka.js":104,"./kk":105,"./kk.js":105,"./km":106,"./km.js":106,"./kn":107,"./kn.js":107,"./ko":108,"./ko.js":108,"./ky":109,"./ky.js":109,"./lb":110,"./lb.js":110,"./lo":111,"./lo.js":111,"./lt":112,"./lt.js":112,"./lv":113,"./lv.js":113,"./me":114,"./me.js":114,"./mi":115,"./mi.js":115,"./mk":116,"./mk.js":116,"./ml":117,"./ml.js":117,"./mr":118,"./mr.js":118,"./ms":119,"./ms-my":120,"./ms-my.js":120,"./ms.js":119,"./my":121,"./my.js":121,"./nb":122,"./nb.js":122,"./ne":123,"./ne.js":123,"./nl":124,"./nl-be":125,"./nl-be.js":125,"./nl.js":124,"./nn":126,"./nn.js":126,"./pa-in":127,"./pa-in.js":127,"./pl":128,"./pl.js":128,"./pt":129,"./pt-br":130,"./pt-br.js":130,"./pt.js":129,"./ro":131,"./ro.js":131,"./ru":132,"./ru.js":132,"./sd":133,"./sd.js":133,"./se":134,"./se.js":134,"./si":135,"./si.js":135,"./sk":136,"./sk.js":136,"./sl":137,"./sl.js":137,"./sq":138,"./sq.js":138,"./sr":139,"./sr-cyrl":140,"./sr-cyrl.js":140,"./sr.js":139,"./ss":141,"./ss.js":141,"./sv":142,"./sv.js":142,"./sw":143,"./sw.js":143,"./ta":144,"./ta.js":144,"./te":145,"./te.js":145,"./tet":146,"./tet.js":146,"./th":147,"./th.js":147,"./tl-ph":148,"./tl-ph.js":148,"./tlh":149,"./tlh.js":149,"./tr":150,"./tr.js":150,"./tzl":151,"./tzl.js":151,"./tzm":152,"./tzm-latn":153,"./tzm-latn.js":153,"./tzm.js":152,"./uk":154,"./uk.js":154,"./ur":155,"./ur.js":155,"./uz":156,"./uz-latn":157,"./uz-latn.js":157,"./uz.js":156,"./vi":158,"./vi.js":158,"./x-pseudo":159,"./x-pseudo.js":159,"./yo":160,"./yo.js":160,"./zh-cn":161,"./zh-cn.js":161,"./zh-hk":162,"./zh-hk.js":162,"./zh-tw":163,"./zh-tw.js":163};n.keys=function(){return Object.keys(s)},n.resolve=o,e.exports=n,n.id=48},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mrt_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(e){return/^nm$/i.test(e)},meridiem:function(e,t,i){return e<12?i?"vm":"VM":i?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Môre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"١",2:"٢",3:"٣",4:"٤",5:"٥",6:"٦",7:"٧",8:"٨",9:"٩",0:"٠"},i={"١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","٠":"0"},n=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},o={s:["أقل من ثانية","ثانية واحدة",["ثانيتان","ثانيتين"],"%d ثوان","%d ثانية","%d ثانية"],m:["أقل من دقيقة","دقيقة واحدة",["دقيقتان","دقيقتين"],"%d دقائق","%d دقيقة","%d دقيقة"],h:["أقل من ساعة","ساعة واحدة",["ساعتان","ساعتين"],"%d ساعات","%d ساعة","%d ساعة"],d:["أقل من يوم","يوم واحد",["يومان","يومين"],"%d أيام","%d يومًا","%d يوم"],M:["أقل من شهر","شهر واحد",["شهران","شهرين"],"%d أشهر","%d شهرا","%d شهر"],y:["أقل من عام","عام واحد",["عامان","عامين"],"%d أعوام","%d عامًا","%d عام"]},s=function(e){return function(t,i,s,a){var r=n(t),l=o[e][n(t)];return 2===r&&(l=l[i?0:1]),l.replace(/%d/i,t)}},a=["كانون الثاني يناير","شباط فبراير","آذار مارس","نيسان أبريل","أيار مايو","حزيران يونيو","تموز يوليو","آب أغسطس","أيلول سبتمبر","تشرين الأول أكتوبر","تشرين الثاني نوفمبر","كانون الأول ديسمبر"],r=e.defineLocale("ar",{months:a,monthsShort:a,weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"أحد_إثنين_ثلاثاء_أربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/‏M/‏YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/ص|م/,isPM:function(e){return"م"===e},meridiem:function(e,t,i){return e<12?"ص":"م"},calendar:{sameDay:"[اليوم عند الساعة] LT",nextDay:"[غدًا عند الساعة] LT",nextWeek:"dddd [عند الساعة] LT",lastDay:"[أمس عند الساعة] LT",lastWeek:"dddd [عند الساعة] LT",sameElse:"L"},relativeTime:{future:"بعد %s",past:"منذ %s",s:s("s"),m:s("m"),mm:s("m"),h:s("h"),hh:s("h"),d:s("d"),dd:s("d"),M:s("M"),MM:s("M"),y:s("y"),yy:s("y")},preparse:function(e){return e.replace(/\u200f/g,"").replace(/[١٢٣٤٥٦٧٨٩٠]/g,function(e){return i[e]}).replace(/،/g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"،")},week:{dow:6,doy:12}});return r})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ar-dz",{
months:"جانفي_فيفري_مارس_أفريل_ماي_جوان_جويلية_أوت_سبتمبر_أكتوبر_نوفمبر_ديسمبر".split("_"),monthsShort:"جانفي_فيفري_مارس_أفريل_ماي_جوان_جويلية_أوت_سبتمبر_أكتوبر_نوفمبر_ديسمبر".split("_"),weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"احد_اثنين_ثلاثاء_اربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"أح_إث_ثلا_أر_خم_جم_سب".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:0,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ar-kw",{months:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),monthsShort:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),weekdays:"الأحد_الإتنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"احد_اتنين_ثلاثاء_اربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:0,doy:12}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",0:"0"},i=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},n={s:["أقل من ثانية","ثانية واحدة",["ثانيتان","ثانيتين"],"%d ثوان","%d ثانية","%d ثانية"],m:["أقل من دقيقة","دقيقة واحدة",["دقيقتان","دقيقتين"],"%d دقائق","%d دقيقة","%d دقيقة"],h:["أقل من ساعة","ساعة واحدة",["ساعتان","ساعتين"],"%d ساعات","%d ساعة","%d ساعة"],d:["أقل من يوم","يوم واحد",["يومان","يومين"],"%d أيام","%d يومًا","%d يوم"],M:["أقل من شهر","شهر واحد",["شهران","شهرين"],"%d أشهر","%d شهرا","%d شهر"],y:["أقل من عام","عام واحد",["عامان","عامين"],"%d أعوام","%d عامًا","%d عام"]},o=function(e){return function(t,o,s,a){var r=i(t),l=n[e][i(t)];return 2===r&&(l=l[o?0:1]),l.replace(/%d/i,t)}},s=["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],a=e.defineLocale("ar-ly",{months:s,monthsShort:s,weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"أحد_إثنين_ثلاثاء_أربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/‏M/‏YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/ص|م/,isPM:function(e){return"م"===e},meridiem:function(e,t,i){return e<12?"ص":"م"},calendar:{sameDay:"[اليوم عند الساعة] LT",nextDay:"[غدًا عند الساعة] LT",nextWeek:"dddd [عند الساعة] LT",lastDay:"[أمس عند الساعة] LT",lastWeek:"dddd [عند الساعة] LT",sameElse:"L"},relativeTime:{future:"بعد %s",past:"منذ %s",s:o("s"),m:o("m"),mm:o("m"),h:o("h"),hh:o("h"),d:o("d"),dd:o("d"),M:o("M"),MM:o("M"),y:o("y"),yy:o("y")},preparse:function(e){return e.replace(/\u200f/g,"").replace(/،/g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"،")},week:{dow:6,doy:12}});return a})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ar-ma",{months:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),monthsShort:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),weekdays:"الأحد_الإتنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"احد_اتنين_ثلاثاء_اربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:6,doy:12}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"١",2:"٢",3:"٣",4:"٤",5:"٥",6:"٦",7:"٧",8:"٨",9:"٩",0:"٠"},i={"١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","٠":"0"},n=e.defineLocale("ar-sa",{months:"يناير_فبراير_مارس_أبريل_مايو_يونيو_يوليو_أغسطس_سبتمبر_أكتوبر_نوفمبر_ديسمبر".split("_"),monthsShort:"يناير_فبراير_مارس_أبريل_مايو_يونيو_يوليو_أغسطس_سبتمبر_أكتوبر_نوفمبر_ديسمبر".split("_"),weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"أحد_إثنين_ثلاثاء_أربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/ص|م/,isPM:function(e){return"م"===e},meridiem:function(e,t,i){return e<12?"ص":"م"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},preparse:function(e){return e.replace(/[١٢٣٤٥٦٧٨٩٠]/g,function(e){return i[e]}).replace(/،/g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"،")},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ar-tn",{months:"جانفي_فيفري_مارس_أفريل_ماي_جوان_جويلية_أوت_سبتمبر_أكتوبر_نوفمبر_ديسمبر".split("_"),monthsShort:"جانفي_فيفري_مارس_أفريل_ماي_جوان_جويلية_أوت_سبتمبر_أكتوبر_نوفمبر_ديسمبر".split("_"),weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"أحد_إثنين_ثلاثاء_أربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-üncü",4:"-üncü",100:"-üncü",6:"-ncı",9:"-uncu",10:"-uncu",30:"-uncu",60:"-ıncı",90:"-ıncı"},i=e.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertəsi_Çərşənbə axşamı_Çərşənbə_Cümə axşamı_Cümə_Şənbə".split("_"),weekdaysShort:"Baz_BzE_ÇAx_Çər_CAx_Cüm_Şən".split("_"),weekdaysMin:"Bz_BE_ÇA_Çə_CA_Cü_Şə".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugün saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gələn həftə] dddd [saat] LT",lastDay:"[dünən] LT",lastWeek:"[keçən həftə] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s əvvəl",s:"birneçə saniyyə",m:"bir dəqiqə",mm:"%d dəqiqə",h:"bir saat",hh:"%d saat",d:"bir gün",dd:"%d gün",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gecə|səhər|gündüz|axşam/,isPM:function(e){return/^(gündüz|axşam)$/.test(e)},meridiem:function(e,t,i){return e<4?"gecə":e<12?"səhər":e<17?"gündüz":"axşam"},dayOfMonthOrdinalParse:/\d{1,2}-(ıncı|inci|nci|üncü|ncı|uncu)/,ordinal:function(e){if(0===e)return e+"-ıncı";var i=e%10,n=e%100-i,o=e>=100?100:null;return e+(t[i]||t[n]||t[o])},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t){var i=e.split("_");return t%10===1&&t%100!==11?i[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?i[1]:i[2]}function i(e,i,n){var o={mm:i?"хвіліна_хвіліны_хвілін":"хвіліну_хвіліны_хвілін",hh:i?"гадзіна_гадзіны_гадзін":"гадзіну_гадзіны_гадзін",dd:"дзень_дні_дзён",MM:"месяц_месяцы_месяцаў",yy:"год_гады_гадоў"};return"m"===n?i?"хвіліна":"хвіліну":"h"===n?i?"гадзіна":"гадзіну":e+" "+t(o[n],+e)}var n=e.defineLocale("be",{months:{format:"студзеня_лютага_сакавіка_красавіка_траўня_чэрвеня_ліпеня_жніўня_верасня_кастрычніка_лістапада_снежня".split("_"),standalone:"студзень_люты_сакавік_красавік_травень_чэрвень_ліпень_жнівень_верасень_кастрычнік_лістапад_снежань".split("_")},monthsShort:"студ_лют_сак_крас_трав_чэрв_ліп_жнів_вер_каст_ліст_снеж".split("_"),weekdays:{format:"нядзелю_панядзелак_аўторак_сераду_чацвер_пятніцу_суботу".split("_"),standalone:"нядзеля_панядзелак_аўторак_серада_чацвер_пятніца_субота".split("_"),isFormat:/\[ ?[Вв] ?(?:мінулую|наступную)? ?\] ?dddd/},weekdaysShort:"нд_пн_ат_ср_чц_пт_сб".split("_"),weekdaysMin:"нд_пн_ат_ср_чц_пт_сб".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., HH:mm",LLLL:"dddd, D MMMM YYYY г., HH:mm"},calendar:{sameDay:"[Сёння ў] LT",nextDay:"[Заўтра ў] LT",lastDay:"[Учора ў] LT",nextWeek:function(){return"[У] dddd [ў] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[У мінулую] dddd [ў] LT";case 1:case 2:case 4:return"[У мінулы] dddd [ў] LT"}},sameElse:"L"},relativeTime:{future:"праз %s",past:"%s таму",s:"некалькі секунд",m:i,mm:i,h:i,hh:i,d:"дзень",dd:i,M:"месяц",MM:i,y:"год",yy:i},meridiemParse:/ночы|раніцы|дня|вечара/,isPM:function(e){return/^(дня|вечара)$/.test(e)},meridiem:function(e,t,i){return e<4?"ночы":e<12?"раніцы":e<17?"дня":"вечара"},dayOfMonthOrdinalParse:/\d{1,2}-(і|ы|га)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e%10!==2&&e%10!==3||e%100===12||e%100===13?e+"-ы":e+"-і";case"D":return e+"-га";default:return e}},week:{dow:1,doy:7}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("bg",{months:"януари_февруари_март_април_май_юни_юли_август_септември_октомври_ноември_декември".split("_"),monthsShort:"янр_фев_мар_апр_май_юни_юли_авг_сеп_окт_ное_дек".split("_"),weekdays:"неделя_понеделник_вторник_сряда_четвъртък_петък_събота".split("_"),weekdaysShort:"нед_пон_вто_сря_чет_пет_съб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[Днес в] LT",nextDay:"[Утре в] LT",nextWeek:"dddd [в] LT",lastDay:"[Вчера в] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[В изминалата] dddd [в] LT";case 1:case 2:case 4:case 5:return"[В изминалия] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"след %s",past:"преди %s",s:"няколко секунди",m:"минута",mm:"%d минути",h:"час",hh:"%d часа",d:"ден",dd:"%d дни",M:"месец",MM:"%d месеца",y:"година",yy:"%d години"},dayOfMonthOrdinalParse:/\d{1,2}-(ев|ен|ти|ви|ри|ми)/,ordinal:function(e){var t=e%10,i=e%100;return 0===e?e+"-ев":0===i?e+"-ен":i>10&&i<20?e+"-ти":1===t?e+"-ви":2===t?e+"-ри":7===t||8===t?e+"-ми":e+"-ти"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"১",2:"২",3:"৩",4:"৪",5:"৫",6:"৬",7:"৭",8:"৮",9:"৯",0:"০"},i={"১":"1","২":"2","৩":"3","৪":"4","৫":"5","৬":"6","৭":"7","৮":"8","৯":"9","০":"0"},n=e.defineLocale("bn",{months:"জানুয়ারী_ফেব্রুয়ারি_মার্চ_এপ্রিল_মে_জুন_জুলাই_আগস্ট_সেপ্টেম্বর_অক্টোবর_নভেম্বর_ডিসেম্বর".split("_"),monthsShort:"জানু_ফেব_মার্চ_এপ্র_মে_জুন_জুল_আগ_সেপ্ট_অক্টো_নভে_ডিসে".split("_"),weekdays:"রবিবার_সোমবার_মঙ্গলবার_বুধবার_বৃহস্পতিবার_শুক্রবার_শনিবার".split("_"),weekdaysShort:"রবি_সোম_মঙ্গল_বুধ_বৃহস্পতি_শুক্র_শনি".split("_"),weekdaysMin:"রবি_সোম_মঙ্গ_বুধ_বৃহঃ_শুক্র_শনি".split("_"),longDateFormat:{LT:"A h:mm সময়",LTS:"A h:mm:ss সময়",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm সময়",LLLL:"dddd, D MMMM YYYY, A h:mm সময়"},calendar:{sameDay:"[আজ] LT",nextDay:"[আগামীকাল] LT",nextWeek:"dddd, LT",lastDay:"[গতকাল] LT",lastWeek:"[গত] dddd, LT",sameElse:"L"},relativeTime:{future:"%s পরে",past:"%s আগে",s:"কয়েক সেকেন্ড",m:"এক মিনিট",mm:"%d মিনিট",h:"এক ঘন্টা",hh:"%d ঘন্টা",d:"এক দিন",dd:"%d দিন",M:"এক মাস",MM:"%d মাস",y:"এক বছর",yy:"%d বছর"},preparse:function(e){return e.replace(/[১২৩৪৫৬৭৮৯০]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/রাত|সকাল|দুপুর|বিকাল|রাত/,meridiemHour:function(e,t){return 12===e&&(e=0),"রাত"===t&&e>=4||"দুপুর"===t&&e<5||"বিকাল"===t?e+12:e},meridiem:function(e,t,i){return e<4?"রাত":e<10?"সকাল":e<17?"দুপুর":e<20?"বিকাল":"রাত"},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"༡",2:"༢",3:"༣",4:"༤",5:"༥",6:"༦",7:"༧",8:"༨",9:"༩",0:"༠"},i={"༡":"1","༢":"2","༣":"3","༤":"4","༥":"5","༦":"6","༧":"7","༨":"8","༩":"9","༠":"0"},n=e.defineLocale("bo",{months:"ཟླ་བ་དང་པོ_ཟླ་བ་གཉིས་པ_ཟླ་བ་གསུམ་པ_ཟླ་བ་བཞི་པ_ཟླ་བ་ལྔ་པ_ཟླ་བ་དྲུག་པ_ཟླ་བ་བདུན་པ_ཟླ་བ་བརྒྱད་པ_ཟླ་བ་དགུ་པ_ཟླ་བ་བཅུ་པ_ཟླ་བ་བཅུ་གཅིག་པ_ཟླ་བ་བཅུ་གཉིས་པ".split("_"),monthsShort:"ཟླ་བ་དང་པོ_ཟླ་བ་གཉིས་པ_ཟླ་བ་གསུམ་པ_ཟླ་བ་བཞི་པ_ཟླ་བ་ལྔ་པ_ཟླ་བ་དྲུག་པ_ཟླ་བ་བདུན་པ_ཟླ་བ་བརྒྱད་པ_ཟླ་བ་དགུ་པ_ཟླ་བ་བཅུ་པ_ཟླ་བ་བཅུ་གཅིག་པ_ཟླ་བ་བཅུ་གཉིས་པ".split("_"),weekdays:"གཟའ་ཉི་མ་_གཟའ་ཟླ་བ་_གཟའ་མིག་དམར་_གཟའ་ལྷག་པ་_གཟའ་ཕུར་བུ_གཟའ་པ་སངས་_གཟའ་སྤེན་པ་".split("_"),weekdaysShort:"ཉི་མ་_ཟླ་བ་_མིག་དམར་_ལྷག་པ་_ཕུར་བུ_པ་སངས་_སྤེན་པ་".split("_"),weekdaysMin:"ཉི་མ་_ཟླ་བ་_མིག་དམར་_ལྷག་པ་_ཕུར་བུ_པ་སངས་_སྤེན་པ་".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[དི་རིང] LT",nextDay:"[སང་ཉིན] LT",nextWeek:"[བདུན་ཕྲག་རྗེས་མ], LT",lastDay:"[ཁ་སང] LT",lastWeek:"[བདུན་ཕྲག་མཐའ་མ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ལ་",past:"%s སྔན་ལ",s:"ལམ་སང",m:"སྐར་མ་གཅིག",mm:"%d སྐར་མ",h:"ཆུ་ཚོད་གཅིག",hh:"%d ཆུ་ཚོད",d:"ཉིན་གཅིག",dd:"%d ཉིན་",M:"ཟླ་བ་གཅིག",MM:"%d ཟླ་བ",y:"ལོ་གཅིག",yy:"%d ལོ"},preparse:function(e){return e.replace(/[༡༢༣༤༥༦༧༨༩༠]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/མཚན་མོ|ཞོགས་ཀས|ཉིན་གུང|དགོང་དག|མཚན་མོ/,meridiemHour:function(e,t){return 12===e&&(e=0),"མཚན་མོ"===t&&e>=4||"ཉིན་གུང"===t&&e<5||"དགོང་དག"===t?e+12:e},meridiem:function(e,t,i){return e<4?"མཚན་མོ":e<10?"ཞོགས་ཀས":e<17?"ཉིན་གུང":e<20?"དགོང་དག":"མཚན་མོ"},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i){var n={mm:"munutenn",MM:"miz",dd:"devezh"};return e+" "+o(n[i],e)}function i(e){switch(n(e)){case 1:case 3:case 4:case 5:case 9:return e+" bloaz";default:return e+" vloaz"}}function n(e){return e>9?n(e%10):e}function o(e,t){return 2===t?s(e):e}function s(e){var t={m:"v",b:"v",d:"z"};return void 0===t[e.charAt(0)]?e:t[e.charAt(0)]+e.substring(1)}var a=e.defineLocale("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h[e]mm A",LTS:"h[e]mm:ss A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY h[e]mm A",LLLL:"dddd, D [a viz] MMMM YYYY h[e]mm A"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondennoù",m:"ur vunutenn",mm:t,h:"un eur",hh:"%d eur",d:"un devezh",dd:t,M:"ur miz",MM:t,y:"ur bloaz",yy:i},dayOfMonthOrdinalParse:/\d{1,2}(añ|vet)/,ordinal:function(e){var t=1===e?"añ":"vet";return e+t},week:{dow:1,doy:4}});return a})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i){var n=e+" ";switch(i){case"m":return t?"jedna minuta":"jedne minute";case"mm":return n+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return n+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return n+=1===e?"dan":"dana";case"MM":return n+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return n+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}var i=e.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jučer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prošlu] dddd [u] LT";case 6:return"[prošle] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[prošli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ca",{months:{standalone:"gener_febrer_març_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),format:"de gener_de febrer_de març_d'abril_de maig_de juny_de juliol_d'agost_de setembre_d'octubre_de novembre_de desembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._març_abr._maig_juny_jul._ag._set._oct._nov._des.".split("_"),monthsParseExact:!0,weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"[el] D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"[el] D MMMM [de] YYYY [a les] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"[el] dddd D MMMM [de] YYYY [a les] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[demà a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"d'aquí %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t|è|a)/,ordinal:function(e,t){var i=1===e?"r":2===e?"n":3===e?"r":4===e?"t":"è";return"w"!==t&&"W"!==t||(i="a"),e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e){return e>1&&e<5&&1!==~~(e/10)}function i(e,i,n,o){var s=e+" ";switch(n){case"s":return i||o?"pár sekund":"pár sekundami";case"m":return i?"minuta":o?"minutu":"minutou";case"mm":return i||o?s+(t(e)?"minuty":"minut"):s+"minutami";case"h":return i?"hodina":o?"hodinu":"hodinou";case"hh":return i||o?s+(t(e)?"hodiny":"hodin"):s+"hodinami";case"d":return i||o?"den":"dnem";case"dd":return i||o?s+(t(e)?"dny":"dní"):s+"dny";case"M":return i||o?"měsíc":"měsícem";case"MM":return i||o?s+(t(e)?"měsíce":"měsíců"):s+"měsíci";case"y":return i||o?"rok":"rokem";case"yy":return i||o?s+(t(e)?"roky":"let"):s+"lety"}}var n="leden_únor_březen_duben_květen_červen_červenec_srpen_září_říjen_listopad_prosinec".split("_"),o="led_úno_bře_dub_kvě_čvn_čvc_srp_zář_říj_lis_pro".split("_"),s=e.defineLocale("cs",{months:n,monthsShort:o,monthsParse:function(e,t){var i,n=[];for(i=0;i<12;i++)n[i]=new RegExp("^"+e[i]+"$|^"+t[i]+"$","i");return n}(n,o),shortMonthsParse:function(e){var t,i=[];for(t=0;t<12;t++)i[t]=new RegExp("^"+e[t]+"$","i");return i}(o),longMonthsParse:function(e){var t,i=[];for(t=0;t<12;t++)i[t]=new RegExp("^"+e[t]+"$","i");return i}(n),weekdays:"neděle_pondělí_úterý_středa_čtvrtek_pátek_sobota".split("_"),weekdaysShort:"ne_po_út_st_čt_pá_so".split("_"),weekdaysMin:"ne_po_út_st_čt_pá_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[zítra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v neděli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve středu v] LT";case 4:return"[ve čtvrtek v] LT";case 5:return"[v pátek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[včera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou neděli v] LT";case 1:case 2:return"[minulé] dddd [v] LT";case 3:return"[minulou středu v] LT";case 4:case 5:return"[minulý] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"před %s",s:i,m:i,mm:i,h:i,hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("cv",{months:"кӑрлач_нарӑс_пуш_ака_май_ҫӗртме_утӑ_ҫурла_авӑн_юпа_чӳк_раштав".split("_"),monthsShort:"кӑр_нар_пуш_ака_май_ҫӗр_утӑ_ҫур_авн_юпа_чӳк_раш".split("_"),weekdays:"вырсарникун_тунтикун_ытларикун_юнкун_кӗҫнерникун_эрнекун_шӑматкун".split("_"),weekdaysShort:"выр_тун_ытл_юн_кӗҫ_эрн_шӑм".split("_"),weekdaysMin:"вр_тн_ыт_юн_кҫ_эр_шм".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [ҫулхи] MMMM [уйӑхӗн] D[-мӗшӗ]",LLL:"YYYY [ҫулхи] MMMM [уйӑхӗн] D[-мӗшӗ], HH:mm",LLLL:"dddd, YYYY [ҫулхи] MMMM [уйӑхӗн] D[-мӗшӗ], HH:mm"},calendar:{sameDay:"[Паян] LT [сехетре]",nextDay:"[Ыран] LT [сехетре]",lastDay:"[Ӗнер] LT [сехетре]",nextWeek:"[Ҫитес] dddd LT [сехетре]",lastWeek:"[Иртнӗ] dddd LT [сехетре]",sameElse:"L"},relativeTime:{future:function(e){var t=/сехет$/i.exec(e)?"рен":/ҫул$/i.exec(e)?"тан":"ран";return e+t},past:"%s каялла",s:"пӗр-ик ҫеккунт",m:"пӗр минут",mm:"%d минут",h:"пӗр сехет",hh:"%d сехет",d:"пӗр кун",dd:"%d кун",M:"пӗр уйӑх",MM:"%d уйӑх",y:"пӗр ҫул",yy:"%d ҫул"},dayOfMonthOrdinalParse:/\d{1,2}-мӗш/,ordinal:"%d-мӗш",week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn ôl",s:"ychydig eiliadau",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},dayOfMonthOrdinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(e){var t=e,i="",n=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return t>20?i=40===t||50===t||60===t||80===t||100===t?"fed":"ain":t>0&&(i=n[t]),e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"søn_man_tir_ons_tor_fre_lør".split("_"),weekdaysMin:"sø_ma_ti_on_to_fr_lø".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"på dddd [kl.] LT",lastDay:"[i går kl.] LT",lastWeek:"[i] dddd[s kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"få sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en måned",MM:"%d måneder",y:"et år",yy:"%d år"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?o[i][0]:o[i][1]}var i=e.defineLocale("de",{months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?o[i][0]:o[i][1]}var i=e.defineLocale("de-at",{months:"Jänner_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jän._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?o[i][0]:o[i][1]}var i=e.defineLocale("de-ch",{months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._März_April_Mai_Juni_Juli_Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH.mm",LLLL:"dddd, D. MMMM YYYY HH.mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=["ޖެނުއަރީ","ފެބްރުއަރީ","މާރިޗު","އޭޕްރީލު","މޭ","ޖޫން","ޖުލައި","އޯގަސްޓު","ސެޕްޓެމްބަރު","އޮކްޓޯބަރު","ނޮވެމްބަރު","ޑިސެމްބަރު"],i=["އާދިއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],n=e.defineLocale("dv",{months:t,monthsShort:t,weekdays:i,weekdaysShort:i,weekdaysMin:"އާދި_ހޯމަ_އަން_ބުދަ_ބުރާ_ހުކު_ހޮނި".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/މކ|މފ/,isPM:function(e){return"މފ"===e},meridiem:function(e,t,i){return e<12?"މކ":"މފ"},calendar:{sameDay:"[މިއަދު] LT",nextDay:"[މާދަމާ] LT",nextWeek:"dddd LT",lastDay:"[އިއްޔެ] LT",lastWeek:"[ފާއިތުވި] dddd LT",sameElse:"L"},relativeTime:{future:"ތެރޭގައި %s",past:"ކުރިން %s",s:"ސިކުންތުކޮޅެއް",m:"މިނިޓެއް",mm:"މިނިޓު %d",h:"ގަޑިއިރެއް",hh:"ގަޑިއިރު %d",d:"ދުވަހެއް",dd:"ދުވަސް %d",M:"މަހެއް",MM:"މަސް %d",y:"އަހަރެއް",yy:"އަހަރު %d"},preparse:function(e){return e.replace(/،/g,",")},postformat:function(e){return e.replace(/,/g,"،")},week:{dow:7,doy:12}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}var i=e.defineLocale("el",{monthsNominativeEl:"Ιανουάριος_Φεβρουάριος_Μάρτιος_Απρίλιος_Μάιος_Ιούνιος_Ιούλιος_Αύγουστος_Σεπτέμβριος_Οκτώβριος_Νοέμβριος_Δεκέμβριος".split("_"),monthsGenitiveEl:"Ιανουαρίου_Φεβρουαρίου_Μαρτίου_Απριλίου_Μαΐου_Ιουνίου_Ιουλίου_Αυγούστου_Σεπτεμβρίου_Οκτωβρίου_Νοεμβρίου_Δεκεμβρίου".split("_"),months:function(e,t){return e?/D/.test(t.substring(0,t.indexOf("MMMM")))?this._monthsGenitiveEl[e.month()]:this._monthsNominativeEl[e.month()]:this._monthsNominativeEl},
monthsShort:"Ιαν_Φεβ_Μαρ_Απρ_Μαϊ_Ιουν_Ιουλ_Αυγ_Σεπ_Οκτ_Νοε_Δεκ".split("_"),weekdays:"Κυριακή_Δευτέρα_Τρίτη_Τετάρτη_Πέμπτη_Παρασκευή_Σάββατο".split("_"),weekdaysShort:"Κυρ_Δευ_Τρι_Τετ_Πεμ_Παρ_Σαβ".split("_"),weekdaysMin:"Κυ_Δε_Τρ_Τε_Πε_Πα_Σα".split("_"),meridiem:function(e,t,i){return e>11?i?"μμ":"ΜΜ":i?"πμ":"ΠΜ"},isPM:function(e){return"μ"===(e+"").toLowerCase()[0]},meridiemParse:/[ΠΜ]\.?Μ?\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[Σήμερα {}] LT",nextDay:"[Αύριο {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[Χθες {}] LT",lastWeek:function(){switch(this.day()){case 6:return"[το προηγούμενο] dddd [{}] LT";default:return"[την προηγούμενη] dddd [{}] LT"}},sameElse:"L"},calendar:function(e,i){var n=this._calendarEl[e],o=i&&i.hours();return t(n)&&(n=n.apply(i)),n.replace("{}",o%12===1?"στη":"στις")},relativeTime:{future:"σε %s",past:"%s πριν",s:"λίγα δευτερόλεπτα",m:"ένα λεπτό",mm:"%d λεπτά",h:"μία ώρα",hh:"%d ώρες",d:"μία μέρα",dd:"%d μέρες",M:"ένας μήνας",MM:"%d μήνες",y:"ένας χρόνος",yy:"%d χρόνια"},dayOfMonthOrdinalParse:/\d{1,2}η/,ordinal:"%dη",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("en-ie",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("en-nz",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_aŭgusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aŭg_sep_okt_nov_dec".split("_"),weekdays:"dimanĉo_lundo_mardo_merkredo_ĵaŭdo_vendredo_sabato".split("_"),weekdaysShort:"dim_lun_mard_merk_ĵaŭ_ven_sab".split("_"),weekdaysMin:"di_lu_ma_me_ĵa_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D[-a de] MMMM, YYYY",LLL:"D[-a de] MMMM, YYYY HH:mm",LLLL:"dddd, [la] D[-a de] MMMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(e){return"p"===e.charAt(0).toLowerCase()},meridiem:function(e,t,i){return e>11?i?"p.t.m.":"P.T.M.":i?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodiaŭ je] LT",nextDay:"[Morgaŭ je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hieraŭ je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"post %s",past:"antaŭ %s",s:"sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},dayOfMonthOrdinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),i="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),n=e.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsParseExact:!0,weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},dayOfMonthOrdinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),i="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),n=e.defineLocale("es-do",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsParseExact:!0,weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},dayOfMonthOrdinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o={s:["mõne sekundi","mõni sekund","paar sekundit"],m:["ühe minuti","üks minut"],mm:[e+" minuti",e+" minutit"],h:["ühe tunni","tund aega","üks tund"],hh:[e+" tunni",e+" tundi"],d:["ühe päeva","üks päev"],M:["kuu aja","kuu aega","üks kuu"],MM:[e+" kuu",e+" kuud"],y:["ühe aasta","aasta","üks aasta"],yy:[e+" aasta",e+" aastat"]};return t?o[i][2]?o[i][2]:o[i][1]:n?o[i][0]:o[i][1]}var i=e.defineLocale("et",{months:"jaanuar_veebruar_märts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_märts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"pühapäev_esmaspäev_teisipäev_kolmapäev_neljapäev_reede_laupäev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Täna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Järgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s pärast",past:"%s tagasi",s:t,m:t,mm:t,h:t,hh:t,d:t,dd:"%d päeva",M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),monthsParseExact:!0,weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"۱",2:"۲",3:"۳",4:"۴",5:"۵",6:"۶",7:"۷",8:"۸",9:"۹",0:"۰"},i={"۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9","۰":"0"},n=e.defineLocale("fa",{months:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),monthsShort:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),weekdays:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysShort:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysMin:"ی_د_س_چ_پ_ج_ش".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/قبل از ظهر|بعد از ظهر/,isPM:function(e){return/بعد از ظهر/.test(e)},meridiem:function(e,t,i){return e<12?"قبل از ظهر":"بعد از ظهر"},calendar:{sameDay:"[امروز ساعت] LT",nextDay:"[فردا ساعت] LT",nextWeek:"dddd [ساعت] LT",lastDay:"[دیروز ساعت] LT",lastWeek:"dddd [پیش] [ساعت] LT",sameElse:"L"},relativeTime:{future:"در %s",past:"%s پیش",s:"چند ثانیه",m:"یک دقیقه",mm:"%d دقیقه",h:"یک ساعت",hh:"%d ساعت",d:"یک روز",dd:"%d روز",M:"یک ماه",MM:"%d ماه",y:"یک سال",yy:"%d سال"},preparse:function(e){return e.replace(/[۰-۹]/g,function(e){return i[e]}).replace(/،/g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"،")},dayOfMonthOrdinalParse:/\d{1,2}م/,ordinal:"%dم",week:{dow:6,doy:12}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,n,o){var s="";switch(n){case"s":return o?"muutaman sekunnin":"muutama sekunti";case"m":return o?"minuutin":"minuutti";case"mm":s=o?"minuutin":"minuuttia";break;case"h":return o?"tunnin":"tunti";case"hh":s=o?"tunnin":"tuntia";break;case"d":return o?"päivän":"päivä";case"dd":s=o?"päivän":"päivää";break;case"M":return o?"kuukauden":"kuukausi";case"MM":s=o?"kuukauden":"kuukautta";break;case"y":return o?"vuoden":"vuosi";case"yy":s=o?"vuoden":"vuotta"}return s=i(e,o)+" "+s}function i(e,t){return e<10?t?o[e]:n[e]:e}var n="nolla yksi kaksi kolme neljä viisi kuusi seitsemän kahdeksan yhdeksän".split(" "),o=["nolla","yhden","kahden","kolmen","neljän","viiden","kuuden",n[7],n[8],n[9]],s=e.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kesäkuu_heinäkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kesä_heinä_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tänään] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s päästä",past:"%s sitten",s:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("fo",{months:"januar_februar_mars_apríl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mánadagur_týsdagur_mikudagur_hósdagur_fríggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mán_týs_mik_hós_frí_ley".split("_"),weekdaysMin:"su_má_tý_mi_hó_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[Í dag kl.] LT",nextDay:"[Í morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[Í gjár kl.] LT",lastWeek:"[síðstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s síðani",s:"fá sekund",m:"ein minutt",mm:"%d minuttir",h:"ein tími",hh:"%d tímar",d:"ein dagur",dd:"%d dagar",M:"ein mánaði",MM:"%d mánaðir",y:"eitt ár",yy:"%d ár"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd’hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,t){switch(t){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("fr-ca",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd’hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("fr-ch",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd’hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t="jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_"),i="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),n=e.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsParseExact:!0,weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[ôfrûne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",m:"ien minút",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=["Am Faoilleach","An Gearran","Am Màrt","An Giblean","An Cèitean","An t-Ògmhios","An t-Iuchar","An Lùnastal","An t-Sultain","An Dàmhair","An t-Samhain","An Dùbhlachd"],i=["Faoi","Gear","Màrt","Gibl","Cèit","Ògmh","Iuch","Lùn","Sult","Dàmh","Samh","Dùbh"],n=["Didòmhnaich","Diluain","Dimàirt","Diciadain","Diardaoin","Dihaoine","Disathairne"],o=["Did","Dil","Dim","Dic","Dia","Dih","Dis"],s=["Dò","Lu","Mà","Ci","Ar","Ha","Sa"],a=e.defineLocale("gd",{months:t,monthsShort:i,monthsParseExact:!0,weekdays:n,weekdaysShort:o,weekdaysMin:s,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[An-diugh aig] LT",nextDay:"[A-màireach aig] LT",nextWeek:"dddd [aig] LT",lastDay:"[An-dè aig] LT",lastWeek:"dddd [seo chaidh] [aig] LT",sameElse:"L"},relativeTime:{future:"ann an %s",past:"bho chionn %s",s:"beagan diogan",m:"mionaid",mm:"%d mionaidean",h:"uair",hh:"%d uairean",d:"latha",dd:"%d latha",M:"mìos",MM:"%d mìosan",y:"bliadhna",yy:"%d bliadhna"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){var t=1===e?"d":e%10===2?"na":"mh";return e+t},week:{dow:1,doy:4}});return a})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("gl",{months:"xaneiro_febreiro_marzo_abril_maio_xuño_xullo_agosto_setembro_outubro_novembro_decembro".split("_"),monthsShort:"xan._feb._mar._abr._mai._xuñ._xul._ago._set._out._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"domingo_luns_martes_mércores_xoves_venres_sábado".split("_"),weekdaysShort:"dom._lun._mar._mér._xov._ven._sáb.".split("_"),weekdaysMin:"do_lu_ma_mé_xo_ve_sá".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"ás":"á")+"] LT"},nextDay:function(){return"[mañá "+(1!==this.hours()?"ás":"á")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"ás":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"á":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"ás":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(e){return 0===e.indexOf("un")?"n"+e:"en "+e},past:"hai %s",s:"uns segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o={s:["thodde secondanim","thodde second"],m:["eka mintan","ek minute"],mm:[e+" mintanim",e+" mintam"],h:["eka horan","ek hor"],hh:[e+" horanim",e+" hor"],d:["eka disan","ek dis"],dd:[e+" disanim",e+" dis"],M:["eka mhoinean","ek mhoino"],MM:[e+" mhoineanim",e+" mhoine"],y:["eka vorsan","ek voros"],yy:[e+" vorsanim",e+" vorsam"]};return t?o[i][0]:o[i][1]}var i=e.defineLocale("gom-latn",{months:"Janer_Febrer_Mars_Abril_Mai_Jun_Julai_Agost_Setembr_Otubr_Novembr_Dezembr".split("_"),monthsShort:"Jan._Feb._Mars_Abr._Mai_Jun_Jul._Ago._Set._Otu._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Aitar_Somar_Mongllar_Budvar_Brestar_Sukrar_Son'var".split("_"),weekdaysShort:"Ait._Som._Mon._Bud._Bre._Suk._Son.".split("_"),weekdaysMin:"Ai_Sm_Mo_Bu_Br_Su_Sn".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm [vazta]",LTS:"A h:mm:ss [vazta]",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm [vazta]",LLLL:"dddd, MMMM[achea] Do, YYYY, A h:mm [vazta]",llll:"ddd, D MMM YYYY, A h:mm [vazta]"},calendar:{sameDay:"[Aiz] LT",nextDay:"[Faleam] LT",nextWeek:"[Ieta to] dddd[,] LT",lastDay:"[Kal] LT",lastWeek:"[Fatlo] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s adim",s:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}(er)/,ordinal:function(e,t){switch(t){case"D":return e+"er";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return e}},week:{dow:1,doy:4},meridiemParse:/rati|sokalli|donparam|sanje/,meridiemHour:function(e,t){return 12===e&&(e=0),"rati"===t?e<4?e:e+12:"sokalli"===t?e:"donparam"===t?e>12?e:e+12:"sanje"===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"rati":e<12?"sokalli":e<16?"donparam":e<20?"sanje":"rati"}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("he",{months:"ינואר_פברואר_מרץ_אפריל_מאי_יוני_יולי_אוגוסט_ספטמבר_אוקטובר_נובמבר_דצמבר".split("_"),monthsShort:"ינו׳_פבר׳_מרץ_אפר׳_מאי_יוני_יולי_אוג׳_ספט׳_אוק׳_נוב׳_דצמ׳".split("_"),weekdays:"ראשון_שני_שלישי_רביעי_חמישי_שישי_שבת".split("_"),weekdaysShort:"א׳_ב׳_ג׳_ד׳_ה׳_ו׳_ש׳".split("_"),weekdaysMin:"א_ב_ג_ד_ה_ו_ש".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [ב]MMMM YYYY",LLL:"D [ב]MMMM YYYY HH:mm",LLLL:"dddd, D [ב]MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[היום ב־]LT",nextDay:"[מחר ב־]LT",nextWeek:"dddd [בשעה] LT",lastDay:"[אתמול ב־]LT",lastWeek:"[ביום] dddd [האחרון בשעה] LT",sameElse:"L"},relativeTime:{future:"בעוד %s",past:"לפני %s",s:"מספר שניות",m:"דקה",mm:"%d דקות",h:"שעה",hh:function(e){return 2===e?"שעתיים":e+" שעות"},d:"יום",dd:function(e){return 2===e?"יומיים":e+" ימים"},M:"חודש",MM:function(e){return 2===e?"חודשיים":e+" חודשים"},y:"שנה",yy:function(e){return 2===e?"שנתיים":e%10===0&&10!==e?e+" שנה":e+" שנים"}},meridiemParse:/אחה"צ|לפנה"צ|אחרי הצהריים|לפני הצהריים|לפנות בוקר|בבוקר|בערב/i,isPM:function(e){return/^(אחה"צ|אחרי הצהריים|בערב)$/.test(e)},meridiem:function(e,t,i){return e<5?"לפנות בוקר":e<10?"בבוקר":e<12?i?'לפנה"צ':"לפני הצהריים":e<18?i?'אחה"צ':"אחרי הצהריים":"בערב"}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},i={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"},n=e.defineLocale("hi",{months:"जनवरी_फ़रवरी_मार्च_अप्रैल_मई_जून_जुलाई_अगस्त_सितम्बर_अक्टूबर_नवम्बर_दिसम्बर".split("_"),monthsShort:"जन._फ़र._मार्च_अप्रै._मई_जून_जुल._अग._सित._अक्टू._नव._दिस.".split("_"),monthsParseExact:!0,weekdays:"रविवार_सोमवार_मंगलवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),weekdaysShort:"रवि_सोम_मंगल_बुध_गुरू_शुक्र_शनि".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),longDateFormat:{LT:"A h:mm बजे",LTS:"A h:mm:ss बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm बजे",LLLL:"dddd, D MMMM YYYY, A h:mm बजे"},calendar:{sameDay:"[आज] LT",nextDay:"[कल] LT",nextWeek:"dddd, LT",lastDay:"[कल] LT",lastWeek:"[पिछले] dddd, LT",sameElse:"L"},relativeTime:{future:"%s में",past:"%s पहले",s:"कुछ ही क्षण",m:"एक मिनट",mm:"%d मिनट",h:"एक घंटा",hh:"%d घंटे",d:"एक दिन",dd:"%d दिन",M:"एक महीने",MM:"%d महीने",y:"एक वर्ष",yy:"%d वर्ष"},preparse:function(e){return e.replace(/[१२३४५६७८९०]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/रात|सुबह|दोपहर|शाम/,meridiemHour:function(e,t){return 12===e&&(e=0),"रात"===t?e<4?e:e+12:"सुबह"===t?e:"दोपहर"===t?e>=10?e:e+12:"शाम"===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"रात":e<10?"सुबह":e<17?"दोपहर":e<20?"शाम":"रात"},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i){var n=e+" ";switch(i){case"m":return t?"jedna minuta":"jedne minute";case"mm":return n+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return n+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return n+=1===e?"dan":"dana";case"MM":return n+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return n+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}var i=e.defineLocale("hr",{months:{format:"siječnja_veljače_ožujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),standalone:"siječanj_veljača_ožujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_")},monthsShort:"sij._velj._ožu._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jučer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prošlu] dddd [u] LT";case 6:return"[prošle] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[prošli] dddd [u] LT"}},sameElse:"L"
},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o=e;switch(i){case"s":return n||t?"néhány másodperc":"néhány másodperce";case"m":return"egy"+(n||t?" perc":" perce");case"mm":return o+(n||t?" perc":" perce");case"h":return"egy"+(n||t?" óra":" órája");case"hh":return o+(n||t?" óra":" órája");case"d":return"egy"+(n||t?" nap":" napja");case"dd":return o+(n||t?" nap":" napja");case"M":return"egy"+(n||t?" hónap":" hónapja");case"MM":return o+(n||t?" hónap":" hónapja");case"y":return"egy"+(n||t?" év":" éve");case"yy":return o+(n||t?" év":" éve")}return""}function i(e){return(e?"":"[múlt] ")+"["+n[this.day()]+"] LT[-kor]"}var n="vasárnap hétfőn kedden szerdán csütörtökön pénteken szombaton".split(" "),o=e.defineLocale("hu",{months:"január_február_március_április_május_június_július_augusztus_szeptember_október_november_december".split("_"),monthsShort:"jan_feb_márc_ápr_máj_jún_júl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasárnap_hétfő_kedd_szerda_csütörtök_péntek_szombat".split("_"),weekdaysShort:"vas_hét_kedd_sze_csüt_pén_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(e){return"u"===e.charAt(1).toLowerCase()},meridiem:function(e,t,i){return e<12?i===!0?"de":"DE":i===!0?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return i.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return i.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s múlva",past:"%s",s:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return o})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("hy-am",{months:{format:"հունվարի_փետրվարի_մարտի_ապրիլի_մայիսի_հունիսի_հուլիսի_օգոստոսի_սեպտեմբերի_հոկտեմբերի_նոյեմբերի_դեկտեմբերի".split("_"),standalone:"հունվար_փետրվար_մարտ_ապրիլ_մայիս_հունիս_հուլիս_օգոստոս_սեպտեմբեր_հոկտեմբեր_նոյեմբեր_դեկտեմբեր".split("_")},monthsShort:"հնվ_փտր_մրտ_ապր_մյս_հնս_հլս_օգս_սպտ_հկտ_նմբ_դկտ".split("_"),weekdays:"կիրակի_երկուշաբթի_երեքշաբթի_չորեքշաբթի_հինգշաբթի_ուրբաթ_շաբաթ".split("_"),weekdaysShort:"կրկ_երկ_երք_չրք_հնգ_ուրբ_շբթ".split("_"),weekdaysMin:"կրկ_երկ_երք_չրք_հնգ_ուրբ_շբթ".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY թ.",LLL:"D MMMM YYYY թ., HH:mm",LLLL:"dddd, D MMMM YYYY թ., HH:mm"},calendar:{sameDay:"[այսօր] LT",nextDay:"[վաղը] LT",lastDay:"[երեկ] LT",nextWeek:function(){return"dddd [օրը ժամը] LT"},lastWeek:function(){return"[անցած] dddd [օրը ժամը] LT"},sameElse:"L"},relativeTime:{future:"%s հետո",past:"%s առաջ",s:"մի քանի վայրկյան",m:"րոպե",mm:"%d րոպե",h:"ժամ",hh:"%d ժամ",d:"օր",dd:"%d օր",M:"ամիս",MM:"%d ամիս",y:"տարի",yy:"%d տարի"},meridiemParse:/գիշերվա|առավոտվա|ցերեկվա|երեկոյան/,isPM:function(e){return/^(ցերեկվա|երեկոյան)$/.test(e)},meridiem:function(e){return e<4?"գիշերվա":e<12?"առավոտվա":e<17?"ցերեկվա":"երեկոյան"},dayOfMonthOrdinalParse:/\d{1,2}|\d{1,2}-(ին|րդ)/,ordinal:function(e,t){switch(t){case"DDD":case"w":case"W":case"DDDo":return 1===e?e+"-ին":e+"-րդ";default:return e}},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"siang"===t?e>=11?e:e+12:"sore"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"pagi":e<15?"siang":e<19?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e){return e%100===11||e%10!==1}function i(e,i,n,o){var s=e+" ";switch(n){case"s":return i||o?"nokkrar sekúndur":"nokkrum sekúndum";case"m":return i?"mínúta":"mínútu";case"mm":return t(e)?s+(i||o?"mínútur":"mínútum"):i?s+"mínúta":s+"mínútu";case"hh":return t(e)?s+(i||o?"klukkustundir":"klukkustundum"):s+"klukkustund";case"d":return i?"dagur":o?"dag":"degi";case"dd":return t(e)?i?s+"dagar":s+(o?"daga":"dögum"):i?s+"dagur":s+(o?"dag":"degi");case"M":return i?"mánuður":o?"mánuð":"mánuði";case"MM":return t(e)?i?s+"mánuðir":s+(o?"mánuði":"mánuðum"):i?s+"mánuður":s+(o?"mánuð":"mánuði");case"y":return i||o?"ár":"ári";case"yy":return t(e)?s+(i||o?"ár":"árum"):s+(i||o?"ár":"ári")}}var n=e.defineLocale("is",{months:"janúar_febrúar_mars_apríl_maí_júní_júlí_ágúst_september_október_nóvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_maí_jún_júl_ágú_sep_okt_nóv_des".split("_"),weekdays:"sunnudagur_mánudagur_þriðjudagur_miðvikudagur_fimmtudagur_föstudagur_laugardagur".split("_"),weekdaysShort:"sun_mán_þri_mið_fim_fös_lau".split("_"),weekdaysMin:"Su_Má_Þr_Mi_Fi_Fö_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[í dag kl.] LT",nextDay:"[á morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[í gær kl.] LT",lastWeek:"[síðasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s síðan",s:i,m:i,mm:i,h:"klukkustund",hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_lunedì_martedì_mercoledì_giovedì_venerdì_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ja",{months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日 HH:mm dddd",l:"YYYY/MM/DD",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日 HH:mm dddd"},meridiemParse:/午前|午後/i,isPM:function(e){return"午後"===e},meridiem:function(e,t,i){return e<12?"午前":"午後"},calendar:{sameDay:"[今日] LT",nextDay:"[明日] LT",nextWeek:"[来週]dddd LT",lastDay:"[昨日] LT",lastWeek:"[前週]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}日/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";default:return e}},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(e,t){return 12===e&&(e=0),"enjing"===t?e:"siyang"===t?e>=11?e:e+12:"sonten"===t||"ndalu"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"enjing":e<15?"siyang":e<19?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ka",{months:{standalone:"იანვარი_თებერვალი_მარტი_აპრილი_მაისი_ივნისი_ივლისი_აგვისტო_სექტემბერი_ოქტომბერი_ნოემბერი_დეკემბერი".split("_"),format:"იანვარს_თებერვალს_მარტს_აპრილის_მაისს_ივნისს_ივლისს_აგვისტს_სექტემბერს_ოქტომბერს_ნოემბერს_დეკემბერს".split("_")},monthsShort:"იან_თებ_მარ_აპრ_მაი_ივნ_ივლ_აგვ_სექ_ოქტ_ნოე_დეკ".split("_"),weekdays:{standalone:"კვირა_ორშაბათი_სამშაბათი_ოთხშაბათი_ხუთშაბათი_პარასკევი_შაბათი".split("_"),format:"კვირას_ორშაბათს_სამშაბათს_ოთხშაბათს_ხუთშაბათს_პარასკევს_შაბათს".split("_"),isFormat:/(წინა|შემდეგ)/},weekdaysShort:"კვი_ორშ_სამ_ოთხ_ხუთ_პარ_შაბ".split("_"),weekdaysMin:"კვ_ორ_სა_ოთ_ხუ_პა_შა".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[დღეს] LT[-ზე]",nextDay:"[ხვალ] LT[-ზე]",lastDay:"[გუშინ] LT[-ზე]",nextWeek:"[შემდეგ] dddd LT[-ზე]",lastWeek:"[წინა] dddd LT-ზე",sameElse:"L"},relativeTime:{future:function(e){return/(წამი|წუთი|საათი|წელი)/.test(e)?e.replace(/ი$/,"ში"):e+"ში"},past:function(e){return/(წამი|წუთი|საათი|დღე|თვე)/.test(e)?e.replace(/(ი|ე)$/,"ის უკან"):/წელი/.test(e)?e.replace(/წელი$/,"წლის უკან"):void 0},s:"რამდენიმე წამი",m:"წუთი",mm:"%d წუთი",h:"საათი",hh:"%d საათი",d:"დღე",dd:"%d დღე",M:"თვე",MM:"%d თვე",y:"წელი",yy:"%d წელი"},dayOfMonthOrdinalParse:/0|1-ლი|მე-\d{1,2}|\d{1,2}-ე/,ordinal:function(e){return 0===e?e:1===e?e+"-ლი":e<20||e<=100&&e%20===0||e%100===0?"მე-"+e:e+"-ე"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={0:"-ші",1:"-ші",2:"-ші",3:"-ші",4:"-ші",5:"-ші",6:"-шы",7:"-ші",8:"-ші",9:"-шы",10:"-шы",20:"-шы",30:"-шы",40:"-шы",50:"-ші",60:"-шы",70:"-ші",80:"-ші",90:"-шы",100:"-ші"},i=e.defineLocale("kk",{months:"қаңтар_ақпан_наурыз_сәуір_мамыр_маусым_шілде_тамыз_қыркүйек_қазан_қараша_желтоқсан".split("_"),monthsShort:"қаң_ақп_нау_сәу_мам_мау_шіл_там_қыр_қаз_қар_жел".split("_"),weekdays:"жексенбі_дүйсенбі_сейсенбі_сәрсенбі_бейсенбі_жұма_сенбі".split("_"),weekdaysShort:"жек_дүй_сей_сәр_бей_жұм_сен".split("_"),weekdaysMin:"жк_дй_сй_ср_бй_жм_сн".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Бүгін сағат] LT",nextDay:"[Ертең сағат] LT",nextWeek:"dddd [сағат] LT",lastDay:"[Кеше сағат] LT",lastWeek:"[Өткен аптаның] dddd [сағат] LT",sameElse:"L"},relativeTime:{future:"%s ішінде",past:"%s бұрын",s:"бірнеше секунд",m:"бір минут",mm:"%d минут",h:"бір сағат",hh:"%d сағат",d:"бір күн",dd:"%d күн",M:"бір ай",MM:"%d ай",y:"бір жыл",yy:"%d жыл"},dayOfMonthOrdinalParse:/\d{1,2}-(ші|шы)/,ordinal:function(e){var i=e%10,n=e>=100?100:null;return e+(t[e]||t[i]||t[n])},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("km",{months:"មករា_កុម្ភៈ_មីនា_មេសា_ឧសភា_មិថុនា_កក្កដា_សីហា_កញ្ញា_តុលា_វិច្ឆិកា_ធ្នូ".split("_"),monthsShort:"មករា_កុម្ភៈ_មីនា_មេសា_ឧសភា_មិថុនា_កក្កដា_សីហា_កញ្ញា_តុលា_វិច្ឆិកា_ធ្នូ".split("_"),weekdays:"អាទិត្យ_ច័ន្ទ_អង្គារ_ពុធ_ព្រហស្បតិ៍_សុក្រ_សៅរ៍".split("_"),weekdaysShort:"អាទិត្យ_ច័ន្ទ_អង្គារ_ពុធ_ព្រហស្បតិ៍_សុក្រ_សៅរ៍".split("_"),weekdaysMin:"អាទិត្យ_ច័ន្ទ_អង្គារ_ពុធ_ព្រហស្បតិ៍_សុក្រ_សៅរ៍".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ថ្ងៃនេះ ម៉ោង] LT",nextDay:"[ស្អែក ម៉ោង] LT",nextWeek:"dddd [ម៉ោង] LT",lastDay:"[ម្សិលមិញ ម៉ោង] LT",lastWeek:"dddd [សប្តាហ៍មុន] [ម៉ោង] LT",sameElse:"L"},relativeTime:{future:"%sទៀត",past:"%sមុន",s:"ប៉ុន្មានវិនាទី",m:"មួយនាទី",mm:"%d នាទី",h:"មួយម៉ោង",hh:"%d ម៉ោង",d:"មួយថ្ងៃ",dd:"%d ថ្ងៃ",M:"មួយខែ",MM:"%d ខែ",y:"មួយឆ្នាំ",yy:"%d ឆ្នាំ"},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"೧",2:"೨",3:"೩",4:"೪",5:"೫",6:"೬",7:"೭",8:"೮",9:"೯",0:"೦"},i={"೧":"1","೨":"2","೩":"3","೪":"4","೫":"5","೬":"6","೭":"7","೮":"8","೯":"9","೦":"0"},n=e.defineLocale("kn",{months:"ಜನವರಿ_ಫೆಬ್ರವರಿ_ಮಾರ್ಚ್_ಏಪ್ರಿಲ್_ಮೇ_ಜೂನ್_ಜುಲೈ_ಆಗಸ್ಟ್_ಸೆಪ್ಟೆಂಬರ್_ಅಕ್ಟೋಬರ್_ನವೆಂಬರ್_ಡಿಸೆಂಬರ್".split("_"),monthsShort:"ಜನ_ಫೆಬ್ರ_ಮಾರ್ಚ್_ಏಪ್ರಿಲ್_ಮೇ_ಜೂನ್_ಜುಲೈ_ಆಗಸ್ಟ್_ಸೆಪ್ಟೆಂಬ_ಅಕ್ಟೋಬ_ನವೆಂಬ_ಡಿಸೆಂಬ".split("_"),monthsParseExact:!0,weekdays:"ಭಾನುವಾರ_ಸೋಮವಾರ_ಮಂಗಳವಾರ_ಬುಧವಾರ_ಗುರುವಾರ_ಶುಕ್ರವಾರ_ಶನಿವಾರ".split("_"),weekdaysShort:"ಭಾನು_ಸೋಮ_ಮಂಗಳ_ಬುಧ_ಗುರು_ಶುಕ್ರ_ಶನಿ".split("_"),weekdaysMin:"ಭಾ_ಸೋ_ಮಂ_ಬು_ಗು_ಶು_ಶ".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[ಇಂದು] LT",nextDay:"[ನಾಳೆ] LT",nextWeek:"dddd, LT",lastDay:"[ನಿನ್ನೆ] LT",lastWeek:"[ಕೊನೆಯ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ನಂತರ",past:"%s ಹಿಂದೆ",s:"ಕೆಲವು ಕ್ಷಣಗಳು",m:"ಒಂದು ನಿಮಿಷ",mm:"%d ನಿಮಿಷ",h:"ಒಂದು ಗಂಟೆ",hh:"%d ಗಂಟೆ",d:"ಒಂದು ದಿನ",dd:"%d ದಿನ",M:"ಒಂದು ತಿಂಗಳು",MM:"%d ತಿಂಗಳು",y:"ಒಂದು ವರ್ಷ",yy:"%d ವರ್ಷ"},preparse:function(e){return e.replace(/[೧೨೩೪೫೬೭೮೯೦]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/ರಾತ್ರಿ|ಬೆಳಿಗ್ಗೆ|ಮಧ್ಯಾಹ್ನ|ಸಂಜೆ/,meridiemHour:function(e,t){return 12===e&&(e=0),"ರಾತ್ರಿ"===t?e<4?e:e+12:"ಬೆಳಿಗ್ಗೆ"===t?e:"ಮಧ್ಯಾಹ್ನ"===t?e>=10?e:e+12:"ಸಂಜೆ"===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"ರಾತ್ರಿ":e<10?"ಬೆಳಿಗ್ಗೆ":e<17?"ಮಧ್ಯಾಹ್ನ":e<20?"ಸಂಜೆ":"ರಾತ್ರಿ"},dayOfMonthOrdinalParse:/\d{1,2}(ನೇ)/,ordinal:function(e){return e+"ನೇ"},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ko",{months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 A h:mm",LLLL:"YYYY년 MMMM D일 dddd A h:mm",l:"YYYY.MM.DD",ll:"YYYY년 MMMM D일",lll:"YYYY년 MMMM D일 A h:mm",llll:"YYYY년 MMMM D일 dddd A h:mm"},calendar:{sameDay:"오늘 LT",nextDay:"내일 LT",nextWeek:"dddd LT",lastDay:"어제 LT",lastWeek:"지난주 dddd LT",sameElse:"L"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇 초",ss:"%d초",m:"1분",mm:"%d분",h:"한 시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한 달",MM:"%d달",y:"일 년",yy:"%d년"},dayOfMonthOrdinalParse:/\d{1,2}일/,ordinal:"%d일",meridiemParse:/오전|오후/,isPM:function(e){return"오후"===e},meridiem:function(e,t,i){return e<12?"오전":"오후"}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={0:"-чү",1:"-чи",2:"-чи",3:"-чү",4:"-чү",5:"-чи",6:"-чы",7:"-чи",8:"-чи",9:"-чу",10:"-чу",20:"-чы",30:"-чу",40:"-чы",50:"-чү",60:"-чы",70:"-чи",80:"-чи",90:"-чу",100:"-чү"},i=e.defineLocale("ky",{months:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),monthsShort:"янв_фев_март_апр_май_июнь_июль_авг_сен_окт_ноя_дек".split("_"),weekdays:"Жекшемби_Дүйшөмбү_Шейшемби_Шаршемби_Бейшемби_Жума_Ишемби".split("_"),weekdaysShort:"Жек_Дүй_Шей_Шар_Бей_Жум_Ише".split("_"),weekdaysMin:"Жк_Дй_Шй_Шр_Бй_Жм_Иш".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Бүгүн саат] LT",nextDay:"[Эртең саат] LT",nextWeek:"dddd [саат] LT",lastDay:"[Кече саат] LT",lastWeek:"[Өткен аптанын] dddd [күнү] [саат] LT",sameElse:"L"},relativeTime:{future:"%s ичинде",past:"%s мурун",s:"бирнече секунд",m:"бир мүнөт",mm:"%d мүнөт",h:"бир саат",hh:"%d саат",d:"бир күн",dd:"%d күн",M:"бир ай",MM:"%d ай",y:"бир жыл",yy:"%d жыл"},dayOfMonthOrdinalParse:/\d{1,2}-(чи|чы|чү|чу)/,ordinal:function(e){var i=e%10,n=e>=100?100:null;return e+(t[e]||t[i]||t[n])},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return t?o[i][0]:o[i][1]}function i(e){var t=e.substr(0,e.indexOf(" "));return o(t)?"a "+e:"an "+e}function n(e){var t=e.substr(0,e.indexOf(" "));return o(t)?"viru "+e:"virun "+e}function o(e){if(e=parseInt(e,10),isNaN(e))return!1;if(e<0)return!0;if(e<10)return 4<=e&&e<=7;if(e<100){var t=e%10,i=e/10;return o(0===t?i:t)}if(e<1e4){for(;e>=10;)e/=10;return o(e)}return e/=1e3,o(e)}var s=e.defineLocale("lb",{months:"Januar_Februar_Mäerz_Abrëll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonndeg_Méindeg_Dënschdeg_Mëttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._Mé._Dë._Më._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mé_Dë_Më_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gëschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:i,past:n,s:"e puer Sekonnen",m:t,mm:"%d Minutten",h:t,hh:"%d Stonnen",d:t,dd:"%d Deeg",M:t,MM:"%d Méint",y:t,yy:"%d Joer"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("lo",{months:"ມັງກອນ_ກຸມພາ_ມີນາ_ເມສາ_ພຶດສະພາ_ມິຖຸນາ_ກໍລະກົດ_ສິງຫາ_ກັນຍາ_ຕຸລາ_ພະຈິກ_ທັນວາ".split("_"),monthsShort:"ມັງກອນ_ກຸມພາ_ມີນາ_ເມສາ_ພຶດສະພາ_ມິຖຸນາ_ກໍລະກົດ_ສິງຫາ_ກັນຍາ_ຕຸລາ_ພະຈິກ_ທັນວາ".split("_"),weekdays:"ອາທິດ_ຈັນ_ອັງຄານ_ພຸດ_ພະຫັດ_ສຸກ_ເສົາ".split("_"),weekdaysShort:"ທິດ_ຈັນ_ອັງຄານ_ພຸດ_ພະຫັດ_ສຸກ_ເສົາ".split("_"),weekdaysMin:"ທ_ຈ_ອຄ_ພ_ພຫ_ສກ_ສ".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"ວັນdddd D MMMM YYYY HH:mm"},meridiemParse:/ຕອນເຊົ້າ|ຕອນແລງ/,isPM:function(e){return"ຕອນແລງ"===e},meridiem:function(e,t,i){return e<12?"ຕອນເຊົ້າ":"ຕອນແລງ"},calendar:{sameDay:"[ມື້ນີ້ເວລາ] LT",nextDay:"[ມື້ອື່ນເວລາ] LT",nextWeek:"[ວັນ]dddd[ໜ້າເວລາ] LT",lastDay:"[ມື້ວານນີ້ເວລາ] LT",lastWeek:"[ວັນ]dddd[ແລ້ວນີ້ເວລາ] LT",sameElse:"L"},relativeTime:{future:"ອີກ %s",past:"%sຜ່ານມາ",s:"ບໍ່ເທົ່າໃດວິນາທີ",m:"1 ນາທີ",mm:"%d ນາທີ",h:"1 ຊົ່ວໂມງ",hh:"%d ຊົ່ວໂມງ",d:"1 ມື້",dd:"%d ມື້",M:"1 ເດືອນ",MM:"%d ເດືອນ",y:"1 ປີ",yy:"%d ປີ"},dayOfMonthOrdinalParse:/(ທີ່)\d{1,2}/,ordinal:function(e){return"ທີ່"+e}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){return t?"kelios sekundės":n?"kelių sekundžių":"kelias sekundes"}function i(e,t,i,n){return t?o(i)[0]:n?o(i)[1]:o(i)[2]}function n(e){return e%10===0||e>10&&e<20}function o(e){return a[e].split("_")}function s(e,t,s,a){var r=e+" ";return 1===e?r+i(e,t,s[0],a):t?r+(n(e)?o(s)[1]:o(s)[0]):a?r+o(s)[1]:r+(n(e)?o(s)[1]:o(s)[2])}var a={m:"minutė_minutės_minutę",mm:"minutės_minučių_minutes",h:"valanda_valandos_valandą",hh:"valandos_valandų_valandas",d:"diena_dienos_dieną",dd:"dienos_dienų_dienas",M:"mėnuo_mėnesio_mėnesį",MM:"mėnesiai_mėnesių_mėnesius",y:"metai_metų_metus",yy:"metai_metų_metus"},r=e.defineLocale("lt",{months:{format:"sausio_vasario_kovo_balandžio_gegužės_birželio_liepos_rugpjūčio_rugsėjo_spalio_lapkričio_gruodžio".split("_"),standalone:"sausis_vasaris_kovas_balandis_gegužė_birželis_liepa_rugpjūtis_rugsėjis_spalis_lapkritis_gruodis".split("_"),isFormat:/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/},monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:{format:"sekmadienį_pirmadienį_antradienį_trečiadienį_ketvirtadienį_penktadienį_šeštadienį".split("_"),standalone:"sekmadienis_pirmadienis_antradienis_trečiadienis_ketvirtadienis_penktadienis_šeštadienis".split("_"),isFormat:/dddd HH:mm/},weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_Šeš".split("_"),weekdaysMin:"S_P_A_T_K_Pn_Š".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[Šiandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Praėjusį] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prieš %s",s:t,m:i,mm:s,h:i,hh:s,d:i,dd:s,M:i,MM:s,y:i,yy:s},dayOfMonthOrdinalParse:/\d{1,2}-oji/,ordinal:function(e){return e+"-oji"},week:{dow:1,doy:4}});return r})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i){return i?t%10===1&&t%100!==11?e[2]:e[3]:t%10===1&&t%100!==11?e[0]:e[1]}function i(e,i,n){return e+" "+t(s[n],e,i)}function n(e,i,n){return t(s[n],e,i)}function o(e,t){return t?"dažas sekundes":"dažām sekundēm"}var s={m:"minūtes_minūtēm_minūte_minūtes".split("_"),mm:"minūtes_minūtēm_minūte_minūtes".split("_"),h:"stundas_stundām_stunda_stundas".split("_"),hh:"stundas_stundām_stunda_stundas".split("_"),d:"dienas_dienām_diena_dienas".split("_"),dd:"dienas_dienām_diena_dienas".split("_"),M:"mēneša_mēnešiem_mēnesis_mēneši".split("_"),MM:"mēneša_mēnešiem_mēnesis_mēneši".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")},a=e.defineLocale("lv",{months:"janvāris_februāris_marts_aprīlis_maijs_jūnijs_jūlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jūn_jūl_aug_sep_okt_nov_dec".split("_"),weekdays:"svētdiena_pirmdiena_otrdiena_trešdiena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[Šodien pulksten] LT",nextDay:"[Rīt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagājušā] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pēc %s",past:"pirms %s",s:o,m:n,mm:i,h:n,hh:i,d:n,dd:i,M:n,MM:i,y:n,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return a})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={words:{m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,i,n){var o=t.words[n];return 1===n.length?i?o[0]:o[1]:e+" "+t.correctGrammaticalCase(e,o)}},i=e.defineLocale("me",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juče u] LT",lastWeek:function(){var e=["[prošle] [nedjelje] [u] LT","[prošlog] [ponedjeljka] [u] LT","[prošlog] [utorka] [u] LT","[prošle] [srijede] [u] LT","[prošlog] [četvrtka] [u] LT","[prošlog] [petka] [u] LT","[prošle] [subote] [u] LT"];return e[this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mjesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("mi",{months:"Kohi-tāte_Hui-tanguru_Poutū-te-rangi_Paenga-whāwhā_Haratua_Pipiri_Hōngoingoi_Here-turi-kōkā_Mahuru_Whiringa-ā-nuku_Whiringa-ā-rangi_Hakihea".split("_"),monthsShort:"Kohi_Hui_Pou_Pae_Hara_Pipi_Hōngoi_Here_Mahu_Whi-nu_Whi-ra_Haki".split("_"),monthsRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,2}/i,weekdays:"Rātapu_Mane_Tūrei_Wenerei_Tāite_Paraire_Hātarei".split("_"),weekdaysShort:"Ta_Ma_Tū_We_Tāi_Pa_Hā".split("_"),weekdaysMin:"Ta_Ma_Tū_We_Tāi_Pa_Hā".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [i] HH:mm",LLLL:"dddd, D MMMM YYYY [i] HH:mm"},calendar:{sameDay:"[i teie mahana, i] LT",nextDay:"[apopo i] LT",nextWeek:"dddd [i] LT",lastDay:"[inanahi i] LT",lastWeek:"dddd [whakamutunga i] LT",sameElse:"L"},relativeTime:{future:"i roto i %s",past:"%s i mua",s:"te hēkona ruarua",m:"he meneti",mm:"%d meneti",h:"te haora",hh:"%d haora",d:"he ra",dd:"%d ra",M:"he marama",MM:"%d marama",y:"he tau",yy:"%d tau"},dayOfMonthOrdinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("mk",{months:"јануари_февруари_март_април_мај_јуни_јули_август_септември_октомври_ноември_декември".split("_"),monthsShort:"јан_фев_мар_апр_мај_јун_јул_авг_сеп_окт_ное_дек".split("_"),weekdays:"недела_понеделник_вторник_среда_четврток_петок_сабота".split("_"),weekdaysShort:"нед_пон_вто_сре_чет_пет_саб".split("_"),weekdaysMin:"нe_пo_вт_ср_че_пе_сa".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[Денес во] LT",nextDay:"[Утре во] LT",nextWeek:"[Во] dddd [во] LT",lastDay:"[Вчера во] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[Изминатата] dddd [во] LT";case 1:case 2:case 4:case 5:return"[Изминатиот] dddd [во] LT"}},sameElse:"L"},relativeTime:{future:"после %s",past:"пред %s",s:"неколку секунди",m:"минута",mm:"%d минути",h:"час",hh:"%d часа",d:"ден",dd:"%d дена",M:"месец",MM:"%d месеци",y:"година",yy:"%d години"},dayOfMonthOrdinalParse:/\d{1,2}-(ев|ен|ти|ви|ри|ми)/,ordinal:function(e){var t=e%10,i=e%100;return 0===e?e+"-ев":0===i?e+"-ен":i>10&&i<20?e+"-ти":1===t?e+"-ви":2===t?e+"-ри":7===t||8===t?e+"-ми":e+"-ти"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ml",{months:"ജനുവരി_ഫെബ്രുവരി_മാർച്ച്_ഏപ്രിൽ_മേയ്_ജൂൺ_ജൂലൈ_ഓഗസ്റ്റ്_സെപ്റ്റംബർ_ഒക്ടോബർ_നവംബർ_ഡിസംബർ".split("_"),monthsShort:"ജനു._ഫെബ്രു._മാർ._ഏപ്രി._മേയ്_ജൂൺ_ജൂലൈ._ഓഗ._സെപ്റ്റ._ഒക്ടോ._നവം._ഡിസം.".split("_"),monthsParseExact:!0,weekdays:"ഞായറാഴ്ച_തിങ്കളാഴ്ച_ചൊവ്വാഴ്ച_ബുധനാഴ്ച_വ്യാഴാഴ്ച_വെള്ളിയാഴ്ച_ശനിയാഴ്ച".split("_"),weekdaysShort:"ഞായർ_തിങ്കൾ_ചൊവ്വ_ബുധൻ_വ്യാഴം_വെള്ളി_ശനി".split("_"),weekdaysMin:"ഞാ_തി_ചൊ_ബു_വ്യാ_വെ_ശ".split("_"),longDateFormat:{LT:"A h:mm -നു",LTS:"A h:mm:ss -നു",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -നു",LLLL:"dddd, D MMMM YYYY, A h:mm -നു"},calendar:{sameDay:"[ഇന്ന്] LT",nextDay:"[നാളെ] LT",nextWeek:"dddd, LT",lastDay:"[ഇന്നലെ] LT",lastWeek:"[കഴിഞ്ഞ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s കഴിഞ്ഞ്",past:"%s മുൻപ്",s:"അൽപ നിമിഷങ്ങൾ",m:"ഒരു മിനിറ്റ്",mm:"%d മിനിറ്റ്",h:"ഒരു മണിക്കൂർ",hh:"%d മണിക്കൂർ",d:"ഒരു ദിവസം",dd:"%d ദിവസം",M:"ഒരു മാസം",MM:"%d മാസം",y:"ഒരു വർഷം",yy:"%d വർഷം"},meridiemParse:/രാത്രി|രാവിലെ|ഉച്ച കഴിഞ്ഞ്|വൈകുന്നേരം|രാത്രി/i,meridiemHour:function(e,t){return 12===e&&(e=0),"രാത്രി"===t&&e>=4||"ഉച്ച കഴിഞ്ഞ്"===t||"വൈകുന്നേരം"===t?e+12:e},meridiem:function(e,t,i){return e<4?"രാത്രി":e<12?"രാവിലെ":e<17?"ഉച്ച കഴിഞ്ഞ്":e<20?"വൈകുന്നേരം":"രാത്രി"}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o="";if(t)switch(i){case"s":o="काही सेकंद";break;case"m":o="एक मिनिट";break;case"mm":o="%d मिनिटे";break;case"h":o="एक तास";break;case"hh":o="%d तास";break;case"d":o="एक दिवस";break;case"dd":o="%d दिवस";break;case"M":o="एक महिना";break;case"MM":o="%d महिने";break;case"y":o="एक वर्ष";break;case"yy":o="%d वर्षे"}else switch(i){case"s":o="काही सेकंदां";break;case"m":o="एका मिनिटा";break;case"mm":o="%d मिनिटां";break;case"h":o="एका तासा";break;case"hh":o="%d तासां";break;case"d":o="एका दिवसा";break;case"dd":o="%d दिवसां";break;case"M":o="एका महिन्या";break;case"MM":o="%d महिन्यां";break;case"y":o="एका वर्षा";break;case"yy":o="%d वर्षां"}return o.replace(/%d/i,e)}var i={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},n={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"},o=e.defineLocale("mr",{months:"जानेवारी_फेब्रुवारी_मार्च_एप्रिल_मे_जून_जुलै_ऑगस्ट_सप्टेंबर_ऑक्टोबर_नोव्हेंबर_डिसेंबर".split("_"),monthsShort:"जाने._फेब्रु._मार्च._एप्रि._मे._जून._जुलै._ऑग._सप्टें._ऑक्टो._नोव्हें._डिसें.".split("_"),monthsParseExact:!0,weekdays:"रविवार_सोमवार_मंगळवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),weekdaysShort:"रवि_सोम_मंगळ_बुध_गुरू_शुक्र_शनि".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),longDateFormat:{LT:"A h:mm वाजता",LTS:"A h:mm:ss वाजता",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm वाजता",LLLL:"dddd, D MMMM YYYY, A h:mm वाजता"},calendar:{sameDay:"[आज] LT",nextDay:"[उद्या] LT",nextWeek:"dddd, LT",lastDay:"[काल] LT",lastWeek:"[मागील] dddd, LT",sameElse:"L"},relativeTime:{future:"%sमध्ये",past:"%sपूर्वी",s:t,m:t,mm:t,h:t,hh:t,d:t,
dd:t,M:t,MM:t,y:t,yy:t},preparse:function(e){return e.replace(/[१२३४५६७८९०]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return i[e]})},meridiemParse:/रात्री|सकाळी|दुपारी|सायंकाळी/,meridiemHour:function(e,t){return 12===e&&(e=0),"रात्री"===t?e<4?e:e+12:"सकाळी"===t?e:"दुपारी"===t?e>=10?e:e+12:"सायंकाळी"===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"रात्री":e<10?"सकाळी":e<17?"दुपारी":e<20?"सायंकाळी":"रात्री"},week:{dow:0,doy:6}});return o})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"၁",2:"၂",3:"၃",4:"၄",5:"၅",6:"၆",7:"၇",8:"၈",9:"၉",0:"၀"},i={"၁":"1","၂":"2","၃":"3","၄":"4","၅":"5","၆":"6","၇":"7","၈":"8","၉":"9","၀":"0"},n=e.defineLocale("my",{months:"ဇန်နဝါရီ_ဖေဖော်ဝါရီ_မတ်_ဧပြီ_မေ_ဇွန်_ဇူလိုင်_သြဂုတ်_စက်တင်ဘာ_အောက်တိုဘာ_နိုဝင်ဘာ_ဒီဇင်ဘာ".split("_"),monthsShort:"ဇန်_ဖေ_မတ်_ပြီ_မေ_ဇွန်_လိုင်_သြ_စက်_အောက်_နို_ဒီ".split("_"),weekdays:"တနင်္ဂနွေ_တနင်္လာ_အင်္ဂါ_ဗုဒ္ဓဟူး_ကြာသပတေး_သောကြာ_စနေ".split("_"),weekdaysShort:"နွေ_လာ_ဂါ_ဟူး_ကြာ_သော_နေ".split("_"),weekdaysMin:"နွေ_လာ_ဂါ_ဟူး_ကြာ_သော_နေ".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ယနေ.] LT [မှာ]",nextDay:"[မနက်ဖြန်] LT [မှာ]",nextWeek:"dddd LT [မှာ]",lastDay:"[မနေ.က] LT [မှာ]",lastWeek:"[ပြီးခဲ့သော] dddd LT [မှာ]",sameElse:"L"},relativeTime:{future:"လာမည့် %s မှာ",past:"လွန်ခဲ့သော %s က",s:"စက္ကန်.အနည်းငယ်",m:"တစ်မိနစ်",mm:"%d မိနစ်",h:"တစ်နာရီ",hh:"%d နာရီ",d:"တစ်ရက်",dd:"%d ရက်",M:"တစ်လ",MM:"%d လ",y:"တစ်နှစ်",yy:"%d နှစ်"},preparse:function(e){return e.replace(/[၁၂၃၄၅၆၇၈၉၀]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"sø._ma._ti._on._to._fr._lø.".split("_"),weekdaysMin:"sø_ma_ti_on_to_fr_lø".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i går kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en måned",MM:"%d måneder",y:"ett år",yy:"%d år"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},i={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"},n=e.defineLocale("ne",{months:"जनवरी_फेब्रुवरी_मार्च_अप्रिल_मई_जुन_जुलाई_अगष्ट_सेप्टेम्बर_अक्टोबर_नोभेम्बर_डिसेम्बर".split("_"),monthsShort:"जन._फेब्रु._मार्च_अप्रि._मई_जुन_जुलाई._अग._सेप्ट._अक्टो._नोभे._डिसे.".split("_"),monthsParseExact:!0,weekdays:"आइतबार_सोमबार_मङ्गलबार_बुधबार_बिहिबार_शुक्रबार_शनिबार".split("_"),weekdaysShort:"आइत._सोम._मङ्गल._बुध._बिहि._शुक्र._शनि.".split("_"),weekdaysMin:"आ._सो._मं._बु._बि._शु._श.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"Aको h:mm बजे",LTS:"Aको h:mm:ss बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, Aको h:mm बजे",LLLL:"dddd, D MMMM YYYY, Aको h:mm बजे"},preparse:function(e){return e.replace(/[१२३४५६७८९०]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/राति|बिहान|दिउँसो|साँझ/,meridiemHour:function(e,t){return 12===e&&(e=0),"राति"===t?e<4?e:e+12:"बिहान"===t?e:"दिउँसो"===t?e>=10?e:e+12:"साँझ"===t?e+12:void 0},meridiem:function(e,t,i){return e<3?"राति":e<12?"बिहान":e<16?"दिउँसो":e<20?"साँझ":"राति"},calendar:{sameDay:"[आज] LT",nextDay:"[भोलि] LT",nextWeek:"[आउँदो] dddd[,] LT",lastDay:"[हिजो] LT",lastWeek:"[गएको] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%sमा",past:"%s अगाडि",s:"केही क्षण",m:"एक मिनेट",mm:"%d मिनेट",h:"एक घण्टा",hh:"%d घण्टा",d:"एक दिन",dd:"%d दिन",M:"एक महिना",MM:"%d महिना",y:"एक बर्ष",yy:"%d बर्ष"},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),i="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),n=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],o=/^(januari|februari|maart|april|mei|april|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,s=e.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(januari|februari|maart|mei|ju[nl]i|april|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:n,longMonthsParse:n,shortMonthsParse:n,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"één minuut",mm:"%d minuten",h:"één uur",hh:"%d uur",d:"één dag",dd:"%d dagen",M:"één maand",MM:"%d maanden",y:"één jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),i="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),n=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],o=/^(januari|februari|maart|april|mei|april|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,s=e.defineLocale("nl-be",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(januari|februari|maart|mei|ju[nl]i|april|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:n,longMonthsParse:n,shortMonthsParse:n,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"één minuut",mm:"%d minuten",h:"één uur",hh:"%d uur",d:"één dag",dd:"%d dagen",M:"één maand",MM:"%d maanden",y:"één jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_måndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mån_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_må_ty_on_to_fr_lø".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I går klokka] LT",lastWeek:"[Føregåande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s sidan",s:"nokre sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein månad",MM:"%d månader",y:"eit år",yy:"%d år"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"੧",2:"੨",3:"੩",4:"੪",5:"੫",6:"੬",7:"੭",8:"੮",9:"੯",0:"੦"},i={"੧":"1","੨":"2","੩":"3","੪":"4","੫":"5","੬":"6","੭":"7","੮":"8","੯":"9","੦":"0"},n=e.defineLocale("pa-in",{months:"ਜਨਵਰੀ_ਫ਼ਰਵਰੀ_ਮਾਰਚ_ਅਪ੍ਰੈਲ_ਮਈ_ਜੂਨ_ਜੁਲਾਈ_ਅਗਸਤ_ਸਤੰਬਰ_ਅਕਤੂਬਰ_ਨਵੰਬਰ_ਦਸੰਬਰ".split("_"),monthsShort:"ਜਨਵਰੀ_ਫ਼ਰਵਰੀ_ਮਾਰਚ_ਅਪ੍ਰੈਲ_ਮਈ_ਜੂਨ_ਜੁਲਾਈ_ਅਗਸਤ_ਸਤੰਬਰ_ਅਕਤੂਬਰ_ਨਵੰਬਰ_ਦਸੰਬਰ".split("_"),weekdays:"ਐਤਵਾਰ_ਸੋਮਵਾਰ_ਮੰਗਲਵਾਰ_ਬੁਧਵਾਰ_ਵੀਰਵਾਰ_ਸ਼ੁੱਕਰਵਾਰ_ਸ਼ਨੀਚਰਵਾਰ".split("_"),weekdaysShort:"ਐਤ_ਸੋਮ_ਮੰਗਲ_ਬੁਧ_ਵੀਰ_ਸ਼ੁਕਰ_ਸ਼ਨੀ".split("_"),weekdaysMin:"ਐਤ_ਸੋਮ_ਮੰਗਲ_ਬੁਧ_ਵੀਰ_ਸ਼ੁਕਰ_ਸ਼ਨੀ".split("_"),longDateFormat:{LT:"A h:mm ਵਜੇ",LTS:"A h:mm:ss ਵਜੇ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ਵਜੇ",LLLL:"dddd, D MMMM YYYY, A h:mm ਵਜੇ"},calendar:{sameDay:"[ਅਜ] LT",nextDay:"[ਕਲ] LT",nextWeek:"dddd, LT",lastDay:"[ਕਲ] LT",lastWeek:"[ਪਿਛਲੇ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ਵਿੱਚ",past:"%s ਪਿਛਲੇ",s:"ਕੁਝ ਸਕਿੰਟ",m:"ਇਕ ਮਿੰਟ",mm:"%d ਮਿੰਟ",h:"ਇੱਕ ਘੰਟਾ",hh:"%d ਘੰਟੇ",d:"ਇੱਕ ਦਿਨ",dd:"%d ਦਿਨ",M:"ਇੱਕ ਮਹੀਨਾ",MM:"%d ਮਹੀਨੇ",y:"ਇੱਕ ਸਾਲ",yy:"%d ਸਾਲ"},preparse:function(e){return e.replace(/[੧੨੩੪੫੬੭੮੯੦]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/ਰਾਤ|ਸਵੇਰ|ਦੁਪਹਿਰ|ਸ਼ਾਮ/,meridiemHour:function(e,t){return 12===e&&(e=0),"ਰਾਤ"===t?e<4?e:e+12:"ਸਵੇਰ"===t?e:"ਦੁਪਹਿਰ"===t?e>=10?e:e+12:"ਸ਼ਾਮ"===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"ਰਾਤ":e<10?"ਸਵੇਰ":e<17?"ਦੁਪਹਿਰ":e<20?"ਸ਼ਾਮ":"ਰਾਤ"},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e){return e%10<5&&e%10>1&&~~(e/10)%10!==1}function i(e,i,n){var o=e+" ";switch(n){case"m":return i?"minuta":"minutę";case"mm":return o+(t(e)?"minuty":"minut");case"h":return i?"godzina":"godzinę";case"hh":return o+(t(e)?"godziny":"godzin");case"MM":return o+(t(e)?"miesiące":"miesięcy");case"yy":return o+(t(e)?"lata":"lat")}}var n="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),o="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_"),s=e.defineLocale("pl",{months:function(e,t){return e?""===t?"("+o[e.month()]+"|"+n[e.month()]+")":/D MMMM/.test(t)?o[e.month()]:n[e.month()]:n},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_śr_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_Śr_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dziś o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zeszłą niedzielę o] LT";case 3:return"[W zeszłą środę o] LT";case 6:return"[W zeszłą sobotę o] LT";default:return"[W zeszły] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:i,mm:i,h:i,hh:i,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:i,y:"rok",yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("pt",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-Feira_Terça-Feira_Quarta-Feira_Quinta-Feira_Sexta-Feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Do_2ª_3ª_4ª_5ª_6ª_Sá".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"há %s",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("pt-br",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Terça-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Do_2ª_3ª_4ª_5ª_6ª_Sá".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [às] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [às] HH:mm"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}º/,ordinal:"%dº"});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i){var n={mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"},o=" ";return(e%100>=20||e>=100&&e%100===0)&&(o=" de "),e+o+n[i]}var i=e.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"duminică_luni_marți_miercuri_joi_vineri_sâmbătă".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sâm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_Sâ".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mâine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s în urmă",s:"câteva secunde",m:"un minut",mm:t,h:"o oră",hh:t,d:"o zi",dd:t,M:"o lună",MM:t,y:"un an",yy:t},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t){var i=e.split("_");return t%10===1&&t%100!==11?i[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?i[1]:i[2]}function i(e,i,n){var o={mm:i?"минута_минуты_минут":"минуту_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"};return"m"===n?i?"минута":"минуту":e+" "+t(o[n],+e)}var n=[/^янв/i,/^фев/i,/^мар/i,/^апр/i,/^ма[йя]/i,/^июн/i,/^июл/i,/^авг/i,/^сен/i,/^окт/i,/^ноя/i,/^дек/i],o=e.defineLocale("ru",{months:{format:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_"),standalone:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_")},monthsShort:{format:"янв._февр._мар._апр._мая_июня_июля_авг._сент._окт._нояб._дек.".split("_"),standalone:"янв._февр._март_апр._май_июнь_июль_авг._сент._окт._нояб._дек.".split("_")},weekdays:{standalone:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),format:"воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_"),isFormat:/\[ ?[Вв] ?(?:прошлую|следующую|эту)? ?\] ?dddd/},weekdaysShort:"вс_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),monthsParse:n,longMonthsParse:n,shortMonthsParse:n,monthsRegex:/^(январ[ья]|янв\.?|феврал[ья]|февр?\.?|марта?|мар\.?|апрел[ья]|апр\.?|ма[йя]|июн[ья]|июн\.?|июл[ья]|июл\.?|августа?|авг\.?|сентябр[ья]|сент?\.?|октябр[ья]|окт\.?|ноябр[ья]|нояб?\.?|декабр[ья]|дек\.?)/i,monthsShortRegex:/^(январ[ья]|янв\.?|феврал[ья]|февр?\.?|марта?|мар\.?|апрел[ья]|апр\.?|ма[йя]|июн[ья]|июн\.?|июл[ья]|июл\.?|августа?|авг\.?|сентябр[ья]|сент?\.?|октябр[ья]|окт\.?|ноябр[ья]|нояб?\.?|декабр[ья]|дек\.?)/i,monthsStrictRegex:/^(январ[яь]|феврал[яь]|марта?|апрел[яь]|ма[яй]|июн[яь]|июл[яь]|августа?|сентябр[яь]|октябр[яь]|ноябр[яь]|декабр[яь])/i,monthsShortStrictRegex:/^(янв\.|февр?\.|мар[т.]|апр\.|ма[яй]|июн[ья.]|июл[ья.]|авг\.|сент?\.|окт\.|нояб?\.|дек\.)/i,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., HH:mm",LLLL:"dddd, D MMMM YYYY г., HH:mm"},calendar:{sameDay:"[Сегодня в] LT",nextDay:"[Завтра в] LT",lastDay:"[Вчера в] LT",nextWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT";switch(this.day()){case 0:return"[В следующее] dddd [в] LT";case 1:case 2:case 4:return"[В следующий] dddd [в] LT";case 3:case 5:case 6:return"[В следующую] dddd [в] LT"}},lastWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT";switch(this.day()){case 0:return"[В прошлое] dddd [в] LT";case 1:case 2:case 4:return"[В прошлый] dddd [в] LT";case 3:case 5:case 6:return"[В прошлую] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:i,mm:i,h:"час",hh:i,d:"день",dd:i,M:"месяц",MM:i,y:"год",yy:i},meridiemParse:/ночи|утра|дня|вечера/i,isPM:function(e){return/^(дня|вечера)$/.test(e)},meridiem:function(e,t,i){return e<4?"ночи":e<12?"утра":e<17?"дня":"вечера"},dayOfMonthOrdinalParse:/\d{1,2}-(й|го|я)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":return e+"-й";case"D":return e+"-го";case"w":case"W":return e+"-я";default:return e}},week:{dow:1,doy:7}});return o})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=["جنوري","فيبروري","مارچ","اپريل","مئي","جون","جولاءِ","آگسٽ","سيپٽمبر","آڪٽوبر","نومبر","ڊسمبر"],i=["آچر","سومر","اڱارو","اربع","خميس","جمع","ڇنڇر"],n=e.defineLocale("sd",{months:t,monthsShort:t,weekdays:i,weekdaysShort:i,weekdaysMin:i,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd، D MMMM YYYY HH:mm"},meridiemParse:/صبح|شام/,isPM:function(e){return"شام"===e},meridiem:function(e,t,i){return e<12?"صبح":"شام"},calendar:{sameDay:"[اڄ] LT",nextDay:"[سڀاڻي] LT",nextWeek:"dddd [اڳين هفتي تي] LT",lastDay:"[ڪالهه] LT",lastWeek:"[گزريل هفتي] dddd [تي] LT",sameElse:"L"},relativeTime:{future:"%s پوء",past:"%s اڳ",s:"چند سيڪنڊ",m:"هڪ منٽ",mm:"%d منٽ",h:"هڪ ڪلاڪ",hh:"%d ڪلاڪ",d:"هڪ ڏينهن",dd:"%d ڏينهن",M:"هڪ مهينو",MM:"%d مهينا",y:"هڪ سال",yy:"%d سال"},preparse:function(e){return e.replace(/،/g,",")},postformat:function(e){return e.replace(/,/g,"،")},week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("se",{months:"ođđajagemánnu_guovvamánnu_njukčamánnu_cuoŋománnu_miessemánnu_geassemánnu_suoidnemánnu_borgemánnu_čakčamánnu_golggotmánnu_skábmamánnu_juovlamánnu".split("_"),monthsShort:"ođđj_guov_njuk_cuo_mies_geas_suoi_borg_čakč_golg_skáb_juov".split("_"),weekdays:"sotnabeaivi_vuossárga_maŋŋebárga_gaskavahkku_duorastat_bearjadat_lávvardat".split("_"),weekdaysShort:"sotn_vuos_maŋ_gask_duor_bear_láv".split("_"),weekdaysMin:"s_v_m_g_d_b_L".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"MMMM D. [b.] YYYY",LLL:"MMMM D. [b.] YYYY [ti.] HH:mm",LLLL:"dddd, MMMM D. [b.] YYYY [ti.] HH:mm"},calendar:{sameDay:"[otne ti] LT",nextDay:"[ihttin ti] LT",nextWeek:"dddd [ti] LT",lastDay:"[ikte ti] LT",lastWeek:"[ovddit] dddd [ti] LT",sameElse:"L"},relativeTime:{future:"%s geažes",past:"maŋit %s",s:"moadde sekunddat",m:"okta minuhta",mm:"%d minuhtat",h:"okta diimmu",hh:"%d diimmut",d:"okta beaivi",dd:"%d beaivvit",M:"okta mánnu",MM:"%d mánut",y:"okta jahki",yy:"%d jagit"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("si",{months:"ජනවාරි_පෙබරවාරි_මාර්තු_අප්‍රේල්_මැයි_ජූනි_ජූලි_අගෝස්තු_සැප්තැම්බර්_ඔක්තෝබර්_නොවැම්බර්_දෙසැම්බර්".split("_"),monthsShort:"ජන_පෙබ_මාර්_අප්_මැයි_ජූනි_ජූලි_අගෝ_සැප්_ඔක්_නොවැ_දෙසැ".split("_"),weekdays:"ඉරිදා_සඳුදා_අඟහරුවාදා_බදාදා_බ්‍රහස්පතින්දා_සිකුරාදා_සෙනසුරාදා".split("_"),weekdaysShort:"ඉරි_සඳු_අඟ_බදා_බ්‍රහ_සිකු_සෙන".split("_"),weekdaysMin:"ඉ_ස_අ_බ_බ්‍ර_සි_සෙ".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [වැනි] dddd, a h:mm:ss"},calendar:{sameDay:"[අද] LT[ට]",nextDay:"[හෙට] LT[ට]",nextWeek:"dddd LT[ට]",lastDay:"[ඊයේ] LT[ට]",lastWeek:"[පසුගිය] dddd LT[ට]",sameElse:"L"},relativeTime:{future:"%sකින්",past:"%sකට පෙර",s:"තත්පර කිහිපය",m:"මිනිත්තුව",mm:"මිනිත්තු %d",h:"පැය",hh:"පැය %d",d:"දිනය",dd:"දින %d",M:"මාසය",MM:"මාස %d",y:"වසර",yy:"වසර %d"},dayOfMonthOrdinalParse:/\d{1,2} වැනි/,ordinal:function(e){return e+" වැනි"},meridiemParse:/පෙර වරු|පස් වරු|පෙ.ව|ප.ව./,isPM:function(e){return"ප.ව."===e||"පස් වරු"===e},meridiem:function(e,t,i){return e>11?i?"ප.ව.":"පස් වරු":i?"පෙ.ව.":"පෙර වරු"}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e){return e>1&&e<5}function i(e,i,n,o){var s=e+" ";switch(n){case"s":return i||o?"pár sekúnd":"pár sekundami";case"m":return i?"minúta":o?"minútu":"minútou";case"mm":return i||o?s+(t(e)?"minúty":"minút"):s+"minútami";case"h":return i?"hodina":o?"hodinu":"hodinou";case"hh":return i||o?s+(t(e)?"hodiny":"hodín"):s+"hodinami";case"d":return i||o?"deň":"dňom";case"dd":return i||o?s+(t(e)?"dni":"dní"):s+"dňami";case"M":return i||o?"mesiac":"mesiacom";case"MM":return i||o?s+(t(e)?"mesiace":"mesiacov"):s+"mesiacmi";case"y":return i||o?"rok":"rokom";case"yy":return i||o?s+(t(e)?"roky":"rokov"):s+"rokmi"}}var n="január_február_marec_apríl_máj_jún_júl_august_september_október_november_december".split("_"),o="jan_feb_mar_apr_máj_jún_júl_aug_sep_okt_nov_dec".split("_"),s=e.defineLocale("sk",{months:n,monthsShort:o,weekdays:"nedeľa_pondelok_utorok_streda_štvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_št_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_št_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeľu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo štvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[včera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulú nedeľu o] LT";case 1:case 2:return"[minulý] dddd [o] LT";case 3:return"[minulú stredu o] LT";case 4:case 5:return"[minulý] dddd [o] LT";case 6:return"[minulú sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:i,m:i,mm:i,h:i,hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o=e+" ";switch(i){case"s":return t||n?"nekaj sekund":"nekaj sekundami";case"m":return t?"ena minuta":"eno minuto";case"mm":return o+=1===e?t?"minuta":"minuto":2===e?t||n?"minuti":"minutama":e<5?t||n?"minute":"minutami":t||n?"minut":"minutami";case"h":return t?"ena ura":"eno uro";case"hh":return o+=1===e?t?"ura":"uro":2===e?t||n?"uri":"urama":e<5?t||n?"ure":"urami":t||n?"ur":"urami";case"d":return t||n?"en dan":"enim dnem";case"dd":return o+=1===e?t||n?"dan":"dnem":2===e?t||n?"dni":"dnevoma":t||n?"dni":"dnevi";case"M":return t||n?"en mesec":"enim mesecem";case"MM":return o+=1===e?t||n?"mesec":"mesecem":2===e?t||n?"meseca":"mesecema":e<5?t||n?"mesece":"meseci":t||n?"mesecev":"meseci";case"y":return t||n?"eno leto":"enim letom";case"yy":return o+=1===e?t||n?"leto":"letom":2===e?t||n?"leti":"letoma":e<5?t||n?"leta":"leti":t||n?"let":"leti"}}var i=e.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljek_torek_sreda_četrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._čet._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_če_pe_so".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[včeraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejšnjo] [nedeljo] [ob] LT";case 3:return"[prejšnjo] [sredo] [ob] LT";case 6:return"[prejšnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejšnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"čez %s",past:"pred %s",s:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nëntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nën_Dhj".split("_"),weekdays:"E Diel_E Hënë_E Martë_E Mërkurë_E Enjte_E Premte_E Shtunë".split("_"),weekdaysShort:"Die_Hën_Mar_Mër_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_Më_E_P_Sh".split("_"),weekdaysParseExact:!0,meridiemParse:/PD|MD/,isPM:function(e){return"M"===e.charAt(0)},meridiem:function(e,t,i){return e<12?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot në] LT",nextDay:"[Nesër në] LT",nextWeek:"dddd [në] LT",lastDay:"[Dje në] LT",lastWeek:"dddd [e kaluar në] LT",sameElse:"L"},relativeTime:{future:"në %s",past:"%s më parë",s:"disa sekonda",m:"një minutë",mm:"%d minuta",h:"një orë",hh:"%d orë",d:"një ditë",dd:"%d ditë",M:"një muaj",MM:"%d muaj",y:"një vit",yy:"%d vite"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={words:{m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,i,n){var o=t.words[n];return 1===n.length?i?o[0]:o[1]:e+" "+t.correctGrammaticalCase(e,o)}},i=e.defineLocale("sr",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljak_utorak_sreda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juče u] LT",lastWeek:function(){var e=["[prošle] [nedelje] [u] LT","[prošlog] [ponedeljka] [u] LT","[prošlog] [utorka] [u] LT","[prošle] [srede] [u] LT","[prošlog] [četvrtka] [u] LT","[prošlog] [petka] [u] LT","[prošle] [subote] [u] LT"];return e[this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",
s:"nekoliko sekundi",m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={words:{m:["један минут","једне минуте"],mm:["минут","минуте","минута"],h:["један сат","једног сата"],hh:["сат","сата","сати"],dd:["дан","дана","дана"],MM:["месец","месеца","месеци"],yy:["година","године","година"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,i,n){var o=t.words[n];return 1===n.length?i?o[0]:o[1]:e+" "+t.correctGrammaticalCase(e,o)}},i=e.defineLocale("sr-cyrl",{months:"јануар_фебруар_март_април_мај_јун_јул_август_септембар_октобар_новембар_децембар".split("_"),monthsShort:"јан._феб._мар._апр._мај_јун_јул_авг._сеп._окт._нов._дец.".split("_"),monthsParseExact:!0,weekdays:"недеља_понедељак_уторак_среда_четвртак_петак_субота".split("_"),weekdaysShort:"нед._пон._уто._сре._чет._пет._суб.".split("_"),weekdaysMin:"не_по_ут_ср_че_пе_су".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[данас у] LT",nextDay:"[сутра у] LT",nextWeek:function(){switch(this.day()){case 0:return"[у] [недељу] [у] LT";case 3:return"[у] [среду] [у] LT";case 6:return"[у] [суботу] [у] LT";case 1:case 2:case 4:case 5:return"[у] dddd [у] LT"}},lastDay:"[јуче у] LT",lastWeek:function(){var e=["[прошле] [недеље] [у] LT","[прошлог] [понедељка] [у] LT","[прошлог] [уторка] [у] LT","[прошле] [среде] [у] LT","[прошлог] [четвртка] [у] LT","[прошлог] [петка] [у] LT","[прошле] [суботе] [у] LT"];return e[this.day()]},sameElse:"L"},relativeTime:{future:"за %s",past:"пре %s",s:"неколико секунди",m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"дан",dd:t.translate,M:"месец",MM:t.translate,y:"годину",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("ss",{months:"Bhimbidvwane_Indlovana_Indlov'lenkhulu_Mabasa_Inkhwekhweti_Inhlaba_Kholwane_Ingci_Inyoni_Imphala_Lweti_Ingongoni".split("_"),monthsShort:"Bhi_Ina_Inu_Mab_Ink_Inh_Kho_Igc_Iny_Imp_Lwe_Igo".split("_"),weekdays:"Lisontfo_Umsombuluko_Lesibili_Lesitsatfu_Lesine_Lesihlanu_Umgcibelo".split("_"),weekdaysShort:"Lis_Umb_Lsb_Les_Lsi_Lsh_Umg".split("_"),weekdaysMin:"Li_Us_Lb_Lt_Ls_Lh_Ug".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Namuhla nga] LT",nextDay:"[Kusasa nga] LT",nextWeek:"dddd [nga] LT",lastDay:"[Itolo nga] LT",lastWeek:"dddd [leliphelile] [nga] LT",sameElse:"L"},relativeTime:{future:"nga %s",past:"wenteka nga %s",s:"emizuzwana lomcane",m:"umzuzu",mm:"%d emizuzu",h:"lihora",hh:"%d emahora",d:"lilanga",dd:"%d emalanga",M:"inyanga",MM:"%d tinyanga",y:"umnyaka",yy:"%d iminyaka"},meridiemParse:/ekuseni|emini|entsambama|ebusuku/,meridiem:function(e,t,i){return e<11?"ekuseni":e<15?"emini":e<19?"entsambama":"ebusuku"},meridiemHour:function(e,t){return 12===e&&(e=0),"ekuseni"===t?e:"emini"===t?e>=11?e:e+12:"entsambama"===t||"ebusuku"===t?0===e?0:e+12:void 0},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag".split("_"),weekdaysShort:"sön_mån_tis_ons_tor_fre_lör".split("_"),weekdaysMin:"sö_må_ti_on_to_fr_lö".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igår] LT",nextWeek:"[På] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"för %s sedan",s:"några sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"},dayOfMonthOrdinalParse:/\d{1,2}(e|a)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"e":1===t?"a":2===t?"a":"e";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("sw",{months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[leo saa] LT",nextDay:"[kesho saa] LT",nextWeek:"[wiki ijayo] dddd [saat] LT",lastDay:"[jana] LT",lastWeek:"[wiki iliyopita] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"masiku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"௧",2:"௨",3:"௩",4:"௪",5:"௫",6:"௬",7:"௭",8:"௮",9:"௯",0:"௦"},i={"௧":"1","௨":"2","௩":"3","௪":"4","௫":"5","௬":"6","௭":"7","௮":"8","௯":"9","௦":"0"},n=e.defineLocale("ta",{months:"ஜனவரி_பிப்ரவரி_மார்ச்_ஏப்ரல்_மே_ஜூன்_ஜூலை_ஆகஸ்ட்_செப்டெம்பர்_அக்டோபர்_நவம்பர்_டிசம்பர்".split("_"),monthsShort:"ஜனவரி_பிப்ரவரி_மார்ச்_ஏப்ரல்_மே_ஜூன்_ஜூலை_ஆகஸ்ட்_செப்டெம்பர்_அக்டோபர்_நவம்பர்_டிசம்பர்".split("_"),weekdays:"ஞாயிற்றுக்கிழமை_திங்கட்கிழமை_செவ்வாய்கிழமை_புதன்கிழமை_வியாழக்கிழமை_வெள்ளிக்கிழமை_சனிக்கிழமை".split("_"),weekdaysShort:"ஞாயிறு_திங்கள்_செவ்வாய்_புதன்_வியாழன்_வெள்ளி_சனி".split("_"),weekdaysMin:"ஞா_தி_செ_பு_வி_வெ_ச".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[இன்று] LT",nextDay:"[நாளை] LT",nextWeek:"dddd, LT",lastDay:"[நேற்று] LT",lastWeek:"[கடந்த வாரம்] dddd, LT",sameElse:"L"},relativeTime:{future:"%s இல்",past:"%s முன்",s:"ஒரு சில விநாடிகள்",m:"ஒரு நிமிடம்",mm:"%d நிமிடங்கள்",h:"ஒரு மணி நேரம்",hh:"%d மணி நேரம்",d:"ஒரு நாள்",dd:"%d நாட்கள்",M:"ஒரு மாதம்",MM:"%d மாதங்கள்",y:"ஒரு வருடம்",yy:"%d ஆண்டுகள்"},dayOfMonthOrdinalParse:/\d{1,2}வது/,ordinal:function(e){return e+"வது"},preparse:function(e){return e.replace(/[௧௨௩௪௫௬௭௮௯௦]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/யாமம்|வைகறை|காலை|நண்பகல்|எற்பாடு|மாலை/,meridiem:function(e,t,i){return e<2?" யாமம்":e<6?" வைகறை":e<10?" காலை":e<14?" நண்பகல்":e<18?" எற்பாடு":e<22?" மாலை":" யாமம்"},meridiemHour:function(e,t){return 12===e&&(e=0),"யாமம்"===t?e<2?e:e+12:"வைகறை"===t||"காலை"===t?e:"நண்பகல்"===t&&e>=10?e:e+12},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("te",{months:"జనవరి_ఫిబ్రవరి_మార్చి_ఏప్రిల్_మే_జూన్_జూలై_ఆగస్టు_సెప్టెంబర్_అక్టోబర్_నవంబర్_డిసెంబర్".split("_"),monthsShort:"జన._ఫిబ్ర._మార్చి_ఏప్రి._మే_జూన్_జూలై_ఆగ._సెప్._అక్టో._నవ._డిసె.".split("_"),monthsParseExact:!0,weekdays:"ఆదివారం_సోమవారం_మంగళవారం_బుధవారం_గురువారం_శుక్రవారం_శనివారం".split("_"),weekdaysShort:"ఆది_సోమ_మంగళ_బుధ_గురు_శుక్ర_శని".split("_"),weekdaysMin:"ఆ_సో_మం_బు_గు_శు_శ".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[నేడు] LT",nextDay:"[రేపు] LT",nextWeek:"dddd, LT",lastDay:"[నిన్న] LT",lastWeek:"[గత] dddd, LT",sameElse:"L"},relativeTime:{future:"%s లో",past:"%s క్రితం",s:"కొన్ని క్షణాలు",m:"ఒక నిమిషం",mm:"%d నిమిషాలు",h:"ఒక గంట",hh:"%d గంటలు",d:"ఒక రోజు",dd:"%d రోజులు",M:"ఒక నెల",MM:"%d నెలలు",y:"ఒక సంవత్సరం",yy:"%d సంవత్సరాలు"},dayOfMonthOrdinalParse:/\d{1,2}వ/,ordinal:"%dవ",meridiemParse:/రాత్రి|ఉదయం|మధ్యాహ్నం|సాయంత్రం/,meridiemHour:function(e,t){return 12===e&&(e=0),"రాత్రి"===t?e<4?e:e+12:"ఉదయం"===t?e:"మధ్యాహ్నం"===t?e>=10?e:e+12:"సాయంత్రం"===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"రాత్రి":e<10?"ఉదయం":e<17?"మధ్యాహ్నం":e<20?"సాయంత్రం":"రాత్రి"},week:{dow:0,doy:6}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("tet",{months:"Janeiru_Fevereiru_Marsu_Abril_Maiu_Juniu_Juliu_Augustu_Setembru_Outubru_Novembru_Dezembru".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Aug_Set_Out_Nov_Dez".split("_"),weekdays:"Domingu_Segunda_Tersa_Kuarta_Kinta_Sexta_Sabadu".split("_"),weekdaysShort:"Dom_Seg_Ters_Kua_Kint_Sext_Sab".split("_"),weekdaysMin:"Do_Seg_Te_Ku_Ki_Sex_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Ohin iha] LT",nextDay:"[Aban iha] LT",nextWeek:"dddd [iha] LT",lastDay:"[Horiseik iha] LT",lastWeek:"dddd [semana kotuk] [iha] LT",sameElse:"L"},relativeTime:{future:"iha %s",past:"%s liuba",s:"minutu balun",m:"minutu ida",mm:"minutus %d",h:"horas ida",hh:"horas %d",d:"loron ida",dd:"loron %d",M:"fulan ida",MM:"fulan %d",y:"tinan ida",yy:"tinan %d"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("th",{months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"ม.ค._ก.พ._มี.ค._เม.ย._พ.ค._มิ.ย._ก.ค._ส.ค._ก.ย._ต.ค._พ.ย._ธ.ค.".split("_"),monthsParseExact:!0,weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา H:mm",LLLL:"วันddddที่ D MMMM YYYY เวลา H:mm"},meridiemParse:/ก่อนเที่ยง|หลังเที่ยง/,isPM:function(e){return"หลังเที่ยง"===e},meridiem:function(e,t,i){return e<12?"ก่อนเที่ยง":"หลังเที่ยง"},calendar:{sameDay:"[วันนี้ เวลา] LT",nextDay:"[พรุ่งนี้ เวลา] LT",nextWeek:"dddd[หน้า เวลา] LT",lastDay:"[เมื่อวานนี้ เวลา] LT",lastWeek:"[วัน]dddd[ที่แล้ว เวลา] LT",sameElse:"L"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e){var t=e;return t=e.indexOf("jaj")!==-1?t.slice(0,-3)+"leS":e.indexOf("jar")!==-1?t.slice(0,-3)+"waQ":e.indexOf("DIS")!==-1?t.slice(0,-3)+"nem":t+" pIq"}function i(e){var t=e;return t=e.indexOf("jaj")!==-1?t.slice(0,-3)+"Hu’":e.indexOf("jar")!==-1?t.slice(0,-3)+"wen":e.indexOf("DIS")!==-1?t.slice(0,-3)+"ben":t+" ret"}function n(e,t,i,n){var s=o(e);switch(i){case"mm":return s+" tup";case"hh":return s+" rep";case"dd":return s+" jaj";case"MM":return s+" jar";case"yy":return s+" DIS"}}function o(e){var t=Math.floor(e%1e3/100),i=Math.floor(e%100/10),n=e%10,o="";return t>0&&(o+=s[t]+"vatlh"),i>0&&(o+=(""!==o?" ":"")+s[i]+"maH"),n>0&&(o+=(""!==o?" ":"")+s[n]),""===o?"pagh":o}var s="pagh_wa’_cha’_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_"),a=e.defineLocale("tlh",{months:"tera’ jar wa’_tera’ jar cha’_tera’ jar wej_tera’ jar loS_tera’ jar vagh_tera’ jar jav_tera’ jar Soch_tera’ jar chorgh_tera’ jar Hut_tera’ jar wa’maH_tera’ jar wa’maH wa’_tera’ jar wa’maH cha’".split("_"),monthsShort:"jar wa’_jar cha’_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar wa’maH_jar wa’maH wa’_jar wa’maH cha’".split("_"),monthsParseExact:!0,weekdays:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysShort:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysMin:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[DaHjaj] LT",nextDay:"[wa’leS] LT",nextWeek:"LLL",lastDay:"[wa’Hu’] LT",lastWeek:"LLL",sameElse:"L"},relativeTime:{future:t,past:i,s:"puS lup",m:"wa’ tup",mm:n,h:"wa’ rep",hh:n,d:"wa’ jaj",dd:n,M:"wa’ jar",MM:n,y:"wa’ DIS",yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return a})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'üncü",4:"'üncü",100:"'üncü",6:"'ncı",9:"'uncu",10:"'uncu",30:"'uncu",60:"'ıncı",90:"'ıncı"},i=e.defineLocale("tr",{months:"Ocak_Şubat_Mart_Nisan_Mayıs_Haziran_Temmuz_Ağustos_Eylül_Ekim_Kasım_Aralık".split("_"),monthsShort:"Oca_Şub_Mar_Nis_May_Haz_Tem_Ağu_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Salı_Çarşamba_Perşembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_Çar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_Ça_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugün saat] LT",nextDay:"[yarın saat] LT",nextWeek:"[haftaya] dddd [saat] LT",lastDay:"[dün] LT",lastWeek:"[geçen hafta] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s önce",s:"birkaç saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gün",dd:"%d gün",M:"bir ay",MM:"%d ay",y:"bir yıl",yy:"%d yıl"},dayOfMonthOrdinalParse:/\d{1,2}'(inci|nci|üncü|ncı|uncu|ıncı)/,ordinal:function(e){if(0===e)return e+"'ıncı";var i=e%10,n=e%100-i,o=e>=100?100:null;return e+(t[i]||t[n]||t[o])},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t,i,n){var o={s:["viensas secunds","'iensas secunds"],m:["'n míut","'iens míut"],mm:[e+" míuts",""+e+" míuts"],h:["'n þora","'iensa þora"],hh:[e+" þoras",""+e+" þoras"],d:["'n ziua","'iensa ziua"],dd:[e+" ziuas",""+e+" ziuas"],M:["'n mes","'iens mes"],MM:[e+" mesen",""+e+" mesen"],y:["'n ar","'iens ar"],yy:[e+" ars",""+e+" ars"]};return n?o[i][0]:t?o[i][0]:o[i][1]}var i=e.defineLocale("tzl",{months:"Januar_Fevraglh_Març_Avrïu_Mai_Gün_Julia_Guscht_Setemvar_Listopäts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gün_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Súladi_Lúneçi_Maitzi_Márcuri_Xhúadi_Viénerçi_Sáturi".split("_"),weekdaysShort:"Súl_Lún_Mai_Már_Xhú_Vié_Sát".split("_"),weekdaysMin:"Sú_Lú_Ma_Má_Xh_Vi_Sá".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY HH.mm",LLLL:"dddd, [li] D. MMMM [dallas] YYYY HH.mm"},meridiemParse:/d\'o|d\'a/i,isPM:function(e){return"d'o"===e.toLowerCase()},meridiem:function(e,t,i){return e>11?i?"d'o":"D'O":i?"d'a":"D'A"},calendar:{sameDay:"[oxhi à] LT",nextDay:"[demà à] LT",nextWeek:"dddd [à] LT",lastDay:"[ieiri à] LT",lastWeek:"[sür el] dddd [lasteu à] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("tzm",{months:"ⵉⵏⵏⴰⵢⵔ_ⴱⵕⴰⵢⵕ_ⵎⴰⵕⵚ_ⵉⴱⵔⵉⵔ_ⵎⴰⵢⵢⵓ_ⵢⵓⵏⵢⵓ_ⵢⵓⵍⵢⵓⵣ_ⵖⵓⵛⵜ_ⵛⵓⵜⴰⵏⴱⵉⵔ_ⴽⵟⵓⴱⵕ_ⵏⵓⵡⴰⵏⴱⵉⵔ_ⴷⵓⵊⵏⴱⵉⵔ".split("_"),monthsShort:"ⵉⵏⵏⴰⵢⵔ_ⴱⵕⴰⵢⵕ_ⵎⴰⵕⵚ_ⵉⴱⵔⵉⵔ_ⵎⴰⵢⵢⵓ_ⵢⵓⵏⵢⵓ_ⵢⵓⵍⵢⵓⵣ_ⵖⵓⵛⵜ_ⵛⵓⵜⴰⵏⴱⵉⵔ_ⴽⵟⵓⴱⵕ_ⵏⵓⵡⴰⵏⴱⵉⵔ_ⴷⵓⵊⵏⴱⵉⵔ".split("_"),weekdays:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),weekdaysShort:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),weekdaysMin:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ⴰⵙⴷⵅ ⴴ] LT",nextDay:"[ⴰⵙⴽⴰ ⴴ] LT",nextWeek:"dddd [ⴴ] LT",lastDay:"[ⴰⵚⴰⵏⵜ ⴴ] LT",lastWeek:"dddd [ⴴ] LT",sameElse:"L"},relativeTime:{future:"ⴷⴰⴷⵅ ⵙ ⵢⴰⵏ %s",past:"ⵢⴰⵏ %s",s:"ⵉⵎⵉⴽ",m:"ⵎⵉⵏⵓⴺ",mm:"%d ⵎⵉⵏⵓⴺ",h:"ⵙⴰⵄⴰ",hh:"%d ⵜⴰⵙⵙⴰⵄⵉⵏ",d:"ⴰⵙⵙ",dd:"%d oⵙⵙⴰⵏ",M:"ⴰⵢoⵓⵔ",MM:"%d ⵉⵢⵢⵉⵔⵏ",y:"ⴰⵙⴳⴰⵙ",yy:"%d ⵉⵙⴳⴰⵙⵏ"},week:{dow:6,doy:12}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("tzm-latn",{months:"innayr_brˤayrˤ_marˤsˤ_ibrir_mayyw_ywnyw_ywlywz_ɣwšt_šwtanbir_ktˤwbrˤ_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brˤayrˤ_marˤsˤ_ibrir_mayyw_ywnyw_ywlywz_ɣwšt_šwtanbir_ktˤwbrˤ_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",m:"minuḍ",mm:"%d minuḍ",h:"saɛa",hh:"%d tassaɛin",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";function t(e,t){var i=e.split("_");return t%10===1&&t%100!==11?i[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?i[1]:i[2]}function i(e,i,n){var o={mm:i?"хвилина_хвилини_хвилин":"хвилину_хвилини_хвилин",hh:i?"година_години_годин":"годину_години_годин",dd:"день_дні_днів",MM:"місяць_місяці_місяців",yy:"рік_роки_років"};return"m"===n?i?"хвилина":"хвилину":"h"===n?i?"година":"годину":e+" "+t(o[n],+e)}function n(e,t){var i={nominative:"неділя_понеділок_вівторок_середа_четвер_п’ятниця_субота".split("_"),accusative:"неділю_понеділок_вівторок_середу_четвер_п’ятницю_суботу".split("_"),genitive:"неділі_понеділка_вівторка_середи_четверга_п’ятниці_суботи".split("_")};if(!e)return i.nominative;var n=/(\[[ВвУу]\]) ?dddd/.test(t)?"accusative":/\[?(?:минулої|наступної)? ?\] ?dddd/.test(t)?"genitive":"nominative";return i[n][e.day()]}function o(e){return function(){return e+"о"+(11===this.hours()?"б":"")+"] LT"}}var s=e.defineLocale("uk",{months:{format:"січня_лютого_березня_квітня_травня_червня_липня_серпня_вересня_жовтня_листопада_грудня".split("_"),standalone:"січень_лютий_березень_квітень_травень_червень_липень_серпень_вересень_жовтень_листопад_грудень".split("_")},monthsShort:"січ_лют_бер_квіт_трав_черв_лип_серп_вер_жовт_лист_груд".split("_"),weekdays:n,weekdaysShort:"нд_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY р.",LLL:"D MMMM YYYY р., HH:mm",LLLL:"dddd, D MMMM YYYY р., HH:mm"},calendar:{sameDay:o("[Сьогодні "),nextDay:o("[Завтра "),lastDay:o("[Вчора "),nextWeek:o("[У] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return o("[Минулої] dddd [").call(this);case 1:case 2:case 4:return o("[Минулого] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:"за %s",past:"%s тому",s:"декілька секунд",m:i,mm:i,h:"годину",hh:i,d:"день",dd:i,M:"місяць",MM:i,y:"рік",yy:i},meridiemParse:/ночі|ранку|дня|вечора/,isPM:function(e){return/^(дня|вечора)$/.test(e)},meridiem:function(e,t,i){return e<4?"ночі":e<12?"ранку":e<17?"дня":"вечора"},dayOfMonthOrdinalParse:/\d{1,2}-(й|го)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e+"-й";case"D":return e+"-го";default:return e}},week:{dow:1,doy:7}});return s})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=["جنوری","فروری","مارچ","اپریل","مئی","جون","جولائی","اگست","ستمبر","اکتوبر","نومبر","دسمبر"],i=["اتوار","پیر","منگل","بدھ","جمعرات","جمعہ","ہفتہ"],n=e.defineLocale("ur",{months:t,monthsShort:t,weekdays:i,weekdaysShort:i,weekdaysMin:i,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd، D MMMM YYYY HH:mm"},meridiemParse:/صبح|شام/,isPM:function(e){return"شام"===e},meridiem:function(e,t,i){return e<12?"صبح":"شام"},calendar:{sameDay:"[آج بوقت] LT",nextDay:"[کل بوقت] LT",nextWeek:"dddd [بوقت] LT",lastDay:"[گذشتہ روز بوقت] LT",lastWeek:"[گذشتہ] dddd [بوقت] LT",sameElse:"L"},relativeTime:{future:"%s بعد",past:"%s قبل",s:"چند سیکنڈ",m:"ایک منٹ",mm:"%d منٹ",h:"ایک گھنٹہ",hh:"%d گھنٹے",d:"ایک دن",dd:"%d دن",M:"ایک ماہ",MM:"%d ماہ",y:"ایک سال",yy:"%d سال"},preparse:function(e){return e.replace(/،/g,",")},postformat:function(e){return e.replace(/,/g,"،")},week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("uz",{months:"январ_феврал_март_апрел_май_июн_июл_август_сентябр_октябр_ноябр_декабр".split("_"),monthsShort:"янв_фев_мар_апр_май_июн_июл_авг_сен_окт_ноя_дек".split("_"),weekdays:"Якшанба_Душанба_Сешанба_Чоршанба_Пайшанба_Жума_Шанба".split("_"),weekdaysShort:"Якш_Душ_Сеш_Чор_Пай_Жум_Шан".split("_"),weekdaysMin:"Як_Ду_Се_Чо_Па_Жу_Ша".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Бугун соат] LT [да]",nextDay:"[Эртага] LT [да]",nextWeek:"dddd [куни соат] LT [да]",lastDay:"[Кеча соат] LT [да]",lastWeek:"[Утган] dddd [куни соат] LT [да]",sameElse:"L"},relativeTime:{future:"Якин %s ичида",past:"Бир неча %s олдин",s:"фурсат",m:"бир дакика",mm:"%d дакика",h:"бир соат",hh:"%d соат",d:"бир кун",dd:"%d кун",M:"бир ой",MM:"%d ой",y:"бир йил",yy:"%d йил"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("uz-latn",{months:"Yanvar_Fevral_Mart_Aprel_May_Iyun_Iyul_Avgust_Sentabr_Oktabr_Noyabr_Dekabr".split("_"),monthsShort:"Yan_Fev_Mar_Apr_May_Iyun_Iyul_Avg_Sen_Okt_Noy_Dek".split("_"),weekdays:"Yakshanba_Dushanba_Seshanba_Chorshanba_Payshanba_Juma_Shanba".split("_"),weekdaysShort:"Yak_Dush_Sesh_Chor_Pay_Jum_Shan".split("_"),weekdaysMin:"Ya_Du_Se_Cho_Pa_Ju_Sha".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Bugun soat] LT [da]",nextDay:"[Ertaga] LT [da]",nextWeek:"dddd [kuni soat] LT [da]",lastDay:"[Kecha soat] LT [da]",lastWeek:"[O'tgan] dddd [kuni soat] LT [da]",sameElse:"L"},relativeTime:{future:"Yaqin %s ichida",past:"Bir necha %s oldin",s:"soniya",m:"bir daqiqa",mm:"%d daqiqa",h:"bir soat",hh:"%d soat",d:"bir kun",dd:"%d kun",M:"bir oy",MM:"%d oy",y:"bir yil",yy:"%d yil"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("vi",{months:"tháng 1_tháng 2_tháng 3_tháng 4_tháng 5_tháng 6_tháng 7_tháng 8_tháng 9_tháng 10_tháng 11_tháng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),monthsParseExact:!0,weekdays:"chủ nhật_thứ hai_thứ ba_thứ tư_thứ năm_thứ sáu_thứ bảy".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysParseExact:!0,meridiemParse:/sa|ch/i,isPM:function(e){return/^ch$/i.test(e)},meridiem:function(e,t,i){return e<12?i?"sa":"SA":i?"ch":"CH"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [năm] YYYY",LLL:"D MMMM [năm] YYYY HH:mm",LLLL:"dddd, D MMMM [năm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hôm nay lúc] LT",nextDay:"[Ngày mai lúc] LT",nextWeek:"dddd [tuần tới lúc] LT",lastDay:"[Hôm qua lúc] LT",lastWeek:"dddd [tuần rồi lúc] LT",sameElse:"L"},relativeTime:{future:"%s tới",past:"%s trước",s:"vài giây",m:"một phút",mm:"%d phút",h:"một giờ",hh:"%d giờ",d:"một ngày",dd:"%d ngày",M:"một tháng",MM:"%d tháng",y:"một năm",yy:"%d năm"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("x-pseudo",{months:"J~áñúá~rý_F~ébrú~árý_~Márc~h_Áp~ríl_~Máý_~Júñé~_Júl~ý_Áú~gúst~_Sép~témb~ér_Ó~ctób~ér_Ñ~óvém~bér_~Décé~mbér".split("_"),monthsShort:"J~áñ_~Féb_~Már_~Ápr_~Máý_~Júñ_~Júl_~Áúg_~Sép_~Óct_~Ñóv_~Déc".split("_"),monthsParseExact:!0,weekdays:"S~úñdá~ý_Mó~ñdáý~_Túé~sdáý~_Wéd~ñésd~áý_T~húrs~dáý_~Fríd~áý_S~átúr~dáý".split("_"),weekdaysShort:"S~úñ_~Móñ_~Túé_~Wéd_~Thú_~Frí_~Sát".split("_"),weekdaysMin:"S~ú_Mó~_Tú_~Wé_T~h_Fr~_Sá".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[T~ódá~ý át] LT",nextDay:"[T~ómó~rró~w át] LT",nextWeek:"dddd [át] LT",lastDay:"[Ý~ést~érdá~ý át] LT",lastWeek:"[L~ást] dddd [át] LT",sameElse:"L"},relativeTime:{future:"í~ñ %s",past:"%s á~gó",s:"á ~féw ~sécó~ñds",m:"á ~míñ~úté",mm:"%d m~íñú~tés",h:"á~ñ hó~úr",hh:"%d h~óúrs",d:"á ~dáý",dd:"%d d~áýs",M:"á ~móñ~th",MM:"%d m~óñt~hs",y:"á ~ýéár",yy:"%d ý~éárs"},dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("yo",{months:"Sẹ́rẹ́_Èrèlè_Ẹrẹ̀nà_Ìgbé_Èbibi_Òkùdu_Agẹmo_Ògún_Owewe_Ọ̀wàrà_Bélú_Ọ̀pẹ̀̀".split("_"),monthsShort:"Sẹ́r_Èrl_Ẹrn_Ìgb_Èbi_Òkù_Agẹ_Ògú_Owe_Ọ̀wà_Bél_Ọ̀pẹ̀̀".split("_"),weekdays:"Àìkú_Ajé_Ìsẹ́gun_Ọjọ́rú_Ọjọ́bọ_Ẹtì_Àbámẹ́ta".split("_"),weekdaysShort:"Àìk_Ajé_Ìsẹ́_Ọjr_Ọjb_Ẹtì_Àbá".split("_"),weekdaysMin:"Àì_Aj_Ìs_Ọr_Ọb_Ẹt_Àb".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Ònì ni] LT",nextDay:"[Ọ̀la ni] LT",nextWeek:"dddd [Ọsẹ̀ tón'bọ] [ni] LT",lastDay:"[Àna ni] LT",lastWeek:"dddd [Ọsẹ̀ tólọ́] [ni] LT",sameElse:"L"},relativeTime:{future:"ní %s",past:"%s kọjá",s:"ìsẹjú aayá die",m:"ìsẹjú kan",mm:"ìsẹjú %d",h:"wákati kan",hh:"wákati %d",d:"ọjọ́ kan",dd:"ọjọ́ %d",M:"osù kan",MM:"osù %d",y:"ọdún kan",yy:"ọdún %d"},dayOfMonthOrdinalParse:/ọjọ́\s\d{1,2}/,ordinal:"ọjọ́ %d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY年MMMD日",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日Ah点mm分",LLLL:"YYYY年MMMD日ddddAh点mm分",l:"YYYY年MMMD日",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日 HH:mm",llll:"YYYY年MMMD日dddd HH:mm"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(e,t){return 12===e&&(e=0),"凌晨"===t||"早上"===t||"上午"===t?e:"下午"===t||"晚上"===t?e+12:e>=11?e:e+12},meridiem:function(e,t,i){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1130?"上午":n<1230?"中午":n<1800?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(日|月|周)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"周";default:return e}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("zh-hk",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY年MMMD日",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日 HH:mm",LLLL:"YYYY年MMMD日dddd HH:mm",l:"YYYY年MMMD日",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日 HH:mm",llll:"YYYY年MMMD日dddd HH:mm"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(e,t){return 12===e&&(e=0),"凌晨"===t||"早上"===t||"上午"===t?e:"中午"===t?e>=11?e:e+12:"下午"===t||"晚上"===t?e+12:void 0},meridiem:function(e,t,i){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1130?"上午":n<1230?"中午":n<1800?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(日|月|週)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"週";default:return e}},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"1 分鐘",mm:"%d 分鐘",h:"1 小時",hh:"%d 小時",d:"1 天",dd:"%d 天",M:"1 個月",MM:"%d 個月",y:"1 年",yy:"%d 年"}});return t})},function(e,t,i){!function(e,t){t(i(46))}(this,function(e){"use strict";var t=e.defineLocale("zh-tw",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY年MMMD日",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日 HH:mm",LLLL:"YYYY年MMMD日dddd HH:mm",l:"YYYY年MMMD日",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日 HH:mm",llll:"YYYY年MMMD日dddd HH:mm"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(e,t){return 12===e&&(e=0),"凌晨"===t||"早上"===t||"上午"===t?e:"中午"===t?e>=11?e:e+12:"下午"===t||"晚上"===t?e+12:void 0},meridiem:function(e,t,i){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1130?"上午":n<1230?"中午":n<1800?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(日|月|週)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"週";default:return e}},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"1 分鐘",mm:"%d 分鐘",h:"1 小時",hh:"%d 小時",d:"1 天",dd:"%d 天",M:"1 個月",MM:"%d 個月",y:"1 年",yy:"%d 年"}});return t})},function(e,t){e.exports={version:"2016f",zones:["Africa/Abidjan|LMT GMT|g.8 0|01|-2ldXH.Q|48e5","Africa/Accra|LMT GMT GHST|.Q 0 -k|012121212121212121212121212121212121212121212121|-26BbX.8 6tzX.8 MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE|41e5","Africa/Nairobi|LMT EAT BEAT BEAUT|-2r.g -30 -2u -2J|01231|-1F3Cr.g 3Dzr.g okMu MFXJ|47e5","Africa/Algiers|PMT WET WEST CET CEST|-9.l 0 -10 -10 -20|0121212121212121343431312123431213|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 DA0 Imo0 rd0 De0 9Xz0 1fb0 1ap0 16K0 2yo0 mEp0 hwL0 jxA0 11A0 dDd0 17b0 11B0 1cN0 2Dy0 1cN0 1fB0 1cL0|26e5","Africa/Lagos|LMT WAT|-d.A -10|01|-22y0d.A|17e6","Africa/Bissau|LMT WAT GMT|12.k 10 0|012|-2ldWV.E 2xonV.E|39e4","Africa/Maputo|LMT CAT|-2a.k -20|01|-2GJea.k|26e5","Africa/Cairo|EET EEST|-20 -30|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1bIO0 vb0 1ip0 11z0 1iN0 1nz0 12p0 1pz0 10N0 1pz0 16p0 1jz0 s3d0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1WL0 rd0 1Rz0 wp0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1qL0 Xd0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1ny0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 WL0 1qN0 Rb0 1wp0 On0 1zd0 Lz0 1EN0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0|15e6","Africa/Casablanca|LMT WET WEST CET|u.k 0 -10 -10|0121212121212121213121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2gMnt.E 130Lt.E rb0 Dd0 dVb0 b6p0 TX0 EoB0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4mn0 SyN0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0 11A0 5A0 e00 17c0 1fA0 1a00 1a00 1fA0 17c0 1io0 14o0 1lc0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1lc0 14o0 1fA0|32e5","Africa/Ceuta|WET WEST CET CEST|0 -10 -10 -20|010101010101010101010232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-25KN0 11z0 drd0 18o0 3I00 17c0 1fA0 1a00 1io0 1a00 1y7p0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4VB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|85e3","Africa/El_Aaiun|LMT WAT WET WEST|Q.M 10 0 -10|01232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1rDz7.c 1GVA7.c 6L0 AL0 1Nd0 XX0 1Cp0 pz0 1cBB0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0 11A0 5A0 e00 17c0 1fA0 1a00 1a00 1fA0 17c0 1io0 14o0 1lc0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1lc0 14o0 1fA0|20e4","Africa/Johannesburg|SAST SAST SAST|-1u -20 -30|012121|-2GJdu 1Ajdu 1cL0 1cN0 1cL0|84e5","Africa/Khartoum|LMT CAT CAST EAT|-2a.8 -20 -30 -30|01212121212121212121212121212121213|-1yW2a.8 1zK0a.8 16L0 1iN0 17b0 1jd0 17b0 1ip0 17z0 1i10 17X0 1hB0 18n0 1hd0 19b0 1gp0 19z0 1iN0 17b0 1ip0 17z0 1i10 18n0 1hd0 18L0 1gN0 19b0 1gp0 19z0 1iN0 17z0 1i10 17X0 yGd0|51e5","Africa/Monrovia|MMT LRT GMT|H.8 I.u 0|012|-23Lzg.Q 29s01.m|11e5","Africa/Ndjamena|LMT WAT WAST|-10.c -10 -20|0121|-2le10.c 2J3c0.c Wn0|13e5","Africa/Tripoli|LMT CET CEST EET|-Q.I -10 -20 -20|012121213121212121212121213123123|-21JcQ.I 1hnBQ.I vx0 4iP0 xx0 4eN0 Bb0 7ip0 U0n0 A10 1db0 1cN0 1db0 1dd0 1db0 1eN0 1bb0 1e10 1cL0 1c10 1db0 1dd0 1db0 1cN0 1db0 1q10 fAn0 1ep0 1db0 AKq0 TA0 1o00|11e5","Africa/Tunis|PMT CET CEST|-9.l -10 -20|0121212121212121212121212121212121|-2nco9.l 18pa9.l 1qM0 DA0 3Tc0 11B0 1ze0 WM0 7z0 3d0 14L0 1cN0 1f90 1ar0 16J0 1gXB0 WM0 1rA0 11c0 nwo0 Ko0 1cM0 1cM0 1rA0 10M0 zuM0 10N0 1aN0 1qM0 WM0 1qM0 11A0 1o00|20e5","Africa/Windhoek|SWAT SAST SAST CAT WAT WAST|-1u -20 -30 -20 -10 -20|012134545454545454545454545454545454545454545454545454545454545454545454545454545454545454545|-2GJdu 1Ajdu 1cL0 1SqL0 9NA0 11D0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0|32e4","America/Adak|NST NWT NPT BST BDT AHST HST HDT|b0 a0 a0 b0 a0 a0 a0 90|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|CAT CAWT CAPT AHST AHDT YST AKST AKDT|a0 90 90 a0 90 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T00 8wX0 iA0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Port_of_Spain|LMT AST|46.4 40|01|-2kNvR.U|43e3","America/Araguaina|LMT BRT BRST|3c.M 30 20|0121212121212121212121212121212121212121212121212121|-2glwL.c HdKL.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 ny10 Lz0|14e4","America/Argentina/Buenos_Aires|CMT ART ARST ART ARST|4g.M 40 30 30 20|0121212121212121212121212121212121212121213434343434343234343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 g0p0 10M0 j3c0 uL0 1qN0 WL0","America/Argentina/Catamarca|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|0121212121212121212121212121212121212121213434343454343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 g0p0 10M0 ako0 7B0 8zb0 uL0","America/Argentina/Cordoba|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|0121212121212121212121212121212121212121213434343454343234343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 g0p0 10M0 j3c0 uL0 1qN0 WL0","America/Argentina/Jujuy|CMT ART ARST ART ARST WART WARST|4g.M 40 30 30 20 40 30|01212121212121212121212121212121212121212134343456543432343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1ze0 TX0 1ld0 WK0 1wp0 TX0 g0p0 10M0 j3c0 uL0","America/Argentina/La_Rioja|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|01212121212121212121212121212121212121212134343434534343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 g0p0 10M0 ako0 7B0 8zb0 uL0","America/Argentina/Mendoza|CMT ART ARST ART ARST WART WARST|4g.M 40 30 30 20 40 30|0121212121212121212121212121212121212121213434345656543235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1u20 SL0 1vd0 Tb0 1wp0 TW0 g0p0 10M0 agM0 Op0 7TX0 uL0","America/Argentina/Rio_Gallegos|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|0121212121212121212121212121212121212121213434343434343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 g0p0 10M0 ako0 7B0 8zb0 uL0","America/Argentina/Salta|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|01212121212121212121212121212121212121212134343434543432343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 g0p0 10M0 j3c0 uL0","America/Argentina/San_Juan|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|01212121212121212121212121212121212121212134343434534343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 g0p0 10M0 ak00 m10 8lb0 uL0","America/Argentina/San_Luis|CMT ART ARST ART ARST WART WARST|4g.M 40 30 30 20 40 30|01212121212121212121212121212121212121212134343456536353465653|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 XX0 1q20 SL0 AN0 kin0 10M0 ak00 m10 8lb0 8L0 jd0 1qN0 WL0 1qN0","America/Argentina/Tucuman|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|012121212121212121212121212121212121212121343434345434323534343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 g0p0 10M0 ako0 4N0 8BX0 uL0 1qN0 WL0","America/Argentina/Ushuaia|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|0121212121212121212121212121212121212121213434343434343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 g0p0 10M0 ajA0 8p0 8zb0 uL0","America/Curacao|LMT ANT AST|4z.L 4u 40|012|-2kV7o.d 28KLS.d|15e4","America/Asuncion|AMT PYT PYT PYST|3O.E 40 30 30|012131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313|-1x589.k 1DKM9.k 3CL0 3Dd0 10L0 1pB0 10n0 1pB0 10n0 1pB0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1lB0 14n0 1dd0 1cL0 1fd0 WL0 1rd0 1aL0 1dB0 Xz0 1qp0 Xb0 1qN0 10L0 1rB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 WN0 1qL0 11B0 1nX0 1ip0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 TX0 1tB0 19X0 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0|28e5","America/Atikokan|CST CDT CWT CPT EST|60 50 50 50 50|0101234|-25TQ0 1in0 Rnb0 3je0 8x30 iw0|28e2","America/Bahia|LMT BRT BRST|2y.4 30 20|01212121212121212121212121212121212121212121212121212121212121|-2glxp.U HdLp.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 l5B0 Rb0|27e5","America/Bahia_Banderas|LMT MST CST PST MDT CDT|71 70 60 80 60 50|0121212131414141414141414141414141414152525252525252525252525252525252525252525252525252525252|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|84e3","America/Barbados|LMT BMT AST ADT|3W.t 3W.t 40 30|01232323232|-1Q0I1.v jsM0 1ODC1.v IL0 1ip0 17b0 1ip0 17b0 1ld0 13b0|28e4","America/Belem|LMT BRT BRST|3d.U 30 20|012121212121212121212121212121|-2glwK.4 HdKK.4 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0|20e5","America/Belize|LMT CST CHDT CDT|5Q.M 60 5u 50|01212121212121212121212121212121212121212121212121213131|-2kBu7.c fPA7.c Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1f0Mu qn0 lxB0 mn0|57e3","America/Blanc-Sablon|AST ADT AWT APT|40 30 30 30|010230|-25TS0 1in0 UGp0 8x50 iu0|11e2","America/Boa_Vista|LMT AMT AMST|42.E 40 30|0121212121212121212121212121212121|-2glvV.k HdKV.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 smp0 WL0 1tB0 2L0|62e2","America/Bogota|BMT COT COST|4U.g 50 40|0121|-2eb73.I 38yo3.I 2en0|90e5","America/Boise|PST PDT MST MWT MPT MDT|80 70 70 60 60 60|0101023425252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-261q0 1nX0 11B0 1nX0 8C10 JCL0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 Dd0 1Kn0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e4","America/Cambridge_Bay|-00 MST MWT MPT MDDT MDT CST CDT EST|0 70 60 60 50 60 60 50 50|0123141515151515151515151515151515151515151515678651515151515151515151515151515151515151515151515151515151515151515151515151|-21Jc0 RO90 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11A0 1nX0 2K0 WQ0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e2","America/Campo_Grande|LMT AMT AMST|3C.s 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwl.w HdLl.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0|77e4","America/Cancun|LMT CST EST EDT CDT|5L.4 60 50 40 50|0123232341414141414141414141414141414141412|-1UQG0 2q2o0 yLB0 1lb0 14p0 1lb0 14p0 Lz0 xB0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 Dd0|63e4","America/Caracas|CMT VET VET|4r.E 4u 40|01212|-2kV7w.k 28KM2.k 1IwOu kqo0|29e5","America/Cayenne|LMT GFT GFT|3t.k 40 30|012|-2mrwu.E 2gWou.E|58e3","America/Panama|CMT EST|5j.A 50|01|-2uduE.o|15e5","America/Chicago|CST CDT EST CWT CPT|60 50 50 50 50|01010101010101010101010101010101010102010101010103401010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 1wp0 TX0 WN0 1qL0 1cN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 11B0 1Hz0 14p0 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|LMT MST CST CDT MDT|74.k 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|81e4","America/Costa_Rica|SJMT CST CDT|5A.d 60 50|0121212121|-1Xd6n.L 2lu0n.L Db0 1Kp0 Db0 pRB0 15b0 1kp0 mL0|12e5","America/Creston|MST PST|70 80|010|-29DR0 43B0|53e2","America/Cuiaba|LMT AMT AMST|3I.k 40 30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwf.E HdLf.E 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 4a10 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0|54e4","America/Danmarkshavn|LMT WGT WGST GMT|1e.E 30 20 0|01212121212121212121212121212121213|-2a5WJ.k 2z5fJ.k 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 DC0|8","America/Dawson|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 jrA0 fNd0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|13e2","America/Dawson_Creek|PST PDT PWT PPT MST|80 70 70 70 70|0102301010101010101010101010101010101010101010101010101014|-25TO0 1in0 UGp0 8x10 iy0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 ML0|12e3","America/Denver|MST MDT MWT MPT|70 60 60 60|01010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 11B0 1qL0 WN0 mn0 Ord0 8x20 ix0 LCN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Detroit|LMT CST EST EWT EPT EDT|5w.b 60 50 40 40 40|01234252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2Cgir.N peqr.N 156L0 8x40 iv0 6fd0 11z0 Jy10 SL0 dnB0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e5","America/Edmonton|LMT MST MDT MWT MPT|7x.Q 70 60 60 60|01212121212121341212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2yd4q.8 shdq.8 1in0 17d0 hz0 2dB0 1fz0 1a10 11z0 1qN0 WL0 1qN0 11z0 IGN0 8x20 ix0 3NB0 11z0 LFB0 1cL0 3Cp0 1cL0 66N0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|10e5","America/Eirunepe|LMT ACT ACST AMT|4D.s 50 40 40|0121212121212121212121212121212131|-2glvk.w HdLk.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0 yTd0 d5X0|31e3","America/El_Salvador|LMT CST CDT|5U.M 60 50|012121|-1XiG3.c 2Fvc3.c WL0 1qN0 WL0|11e5","America/Tijuana|LMT MST PST PDT PWT PPT|7M.4 70 80 70 70 70|012123245232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQE0 4PX0 8mM0 8lc0 SN0 1cL0 pHB0 83r0 zI0 5O10 1Rz0 cOP0 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 BUp0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|20e5","America/Fort_Nelson|PST PDT PWT PPT MST|80 70 70 70 70|01023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104|-25TO0 1in0 UGp0 8x10 iy0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0|39e2","America/Fort_Wayne|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010101023010101010101010101040454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 QI10 Db0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 5Tz0 1o10 qLb0 1cL0 1cN0 1cL0 1qhd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Fortaleza|LMT BRT BRST|2y 30 20|0121212121212121212121212121212121212121|-2glxq HdLq 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 5z0 2mN0 On0|34e5","America/Glace_Bay|LMT AST ADT AWT APT|3X.M 40 30 30 30|012134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsI0.c CwO0.c 1in0 UGp0 8x50 iu0 iq10 11z0 Jg10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|19e3","America/Godthab|LMT WGT WGST|3q.U 30 20|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5Ux.4 2z5dx.4 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e3","America/Goose_Bay|NST NDT NST NDT NWT NPT AST ADT ADDT|3u.Q 2u.Q 3u 2u 2u 2u 40 30 20|010232323232323245232323232323232323232323232323232323232326767676767676767676767676767676767676767676768676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-25TSt.8 1in0 DXb0 2HbX.8 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 S10 g0u 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|76e2","America/Grand_Turk|KMT EST EDT AST|57.b 50 40 40|0121212121212121212121212121212121212121212121212121212121212121212121212123|-2l1uQ.N 2HHBQ.N 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Guatemala|LMT CST CDT|62.4 60 50|0121212121|-24KhV.U 2efXV.U An0 mtd0 Nz0 ifB0 17b0 zDB0 11z0|13e5","America/Guayaquil|QMT ECT|5e 50|01|-1yVSK|27e5","America/Guyana|LMT GBGT GYT GYT GYT|3Q.E 3J 3J 30 40|01234|-2dvU7.k 24JzQ.k mlc0 Bxbf|80e4","America/Halifax|LMT AST ADT AWT APT|4e.o 40 30 30 30|0121212121212121212121212121212121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsHJ.A xzzJ.A 1db0 3I30 1in0 3HX0 IL0 1E10 ML0 1yN0 Pb0 1Bd0 Mn0 1Bd0 Rz0 1w10 Xb0 1w10 LX0 1w10 Xb0 1w10 Lz0 1C10 Jz0 1E10 OL0 1yN0 Un0 1qp0 Xb0 1qp0 11X0 1w10 Lz0 1HB0 LX0 1C10 FX0 1w10 Xb0 1qp0 Xb0 1BB0 LX0 1td0 Xb0 1qp0 Xb0 Rf0 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 6i10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Havana|HMT CST CDT|5t.A 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Meuu.o 72zu.o ML0 sld0 An0 1Nd0 Db0 1Nd0 An0 6Ep0 An0 1Nd0 An0 JDd0 Mn0 1Ap0 On0 1fd0 11X0 1qN0 WL0 1wp0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 14n0 1ld0 14L0 1kN0 15b0 1kp0 1cL0 1cN0 1fz0 1a10 1fz0 1fB0 11z0 14p0 1nX0 11B0 1nX0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 1a10 1in0 1a10 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 17c0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 11A0 6i00 Rc0 1wo0 U00 1tA0 Rc0 1wo0 U00 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/Hermosillo|LMT MST CST PST MDT|7n.Q 70 60 80 60|0121212131414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0|64e4","America/Indiana/Knox|CST CDT CWT CPT EST|60 50 50 50 50|0101023010101010101010101010101010101040101010101010101010101010101010101010101010101010141010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 3Cn0 8wp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 z8o0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Marengo|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010104545454545414545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 dyN0 11z0 6fd0 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1e6p0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Petersburg|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010104010101010101010101010141014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 njX0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 3Fb0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 19co0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Tell_City|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vevay|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010102304545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 kPB0 Awn0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1lnd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vincennes|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Winamac|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010101010454541054545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1za0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Inuvik|-00 PST PDDT MST MDT|0 80 60 70 60|0121343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-FnA0 tWU0 1fA0 wPe0 2pz0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|35e2","America/Iqaluit|-00 EWT EPT EST EDDT EDT CST CDT|0 40 40 50 30 40 60 50|01234353535353535353535353535353535353535353567353535353535353535353535353535353535353535353535353535353535353535353535353|-16K00 7nX0 iv0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|67e2","America/Jamaica|KMT EST EDT|57.b 50 40|0121212121212121212121|-2l1uQ.N 2uM1Q.N 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0|94e4","America/Juneau|PST PWT PPT PDT YDT YST AKST AKDT|80 70 70 70 80 90 90 80|01203030303030303030303030403030356767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cM0 1cM0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|33e3","America/Kentucky/Louisville|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101010102301010101010101010101010101454545454545414545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 3Fd0 Nb0 LPd0 11z0 RB0 8x30 iw0 Bb0 10N0 2bB0 8in0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 xz0 gso0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Kentucky/Monticello|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 SWp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/La_Paz|CMT BOST BOT|4w.A 3w.A 40|012|-1x37r.o 13b0|19e5","America/Lima|LMT PET PEST|58.A 50 40|0121212121212121|-2tyGP.o 1bDzP.o zX0 1aN0 1cL0 1cN0 1cL0 1PrB0 zX0 1O10 zX0 6Gp0 zX0 98p0 zX0|11e6","America/Los_Angeles|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 5Wp0 1Vb0 3dB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/Maceio|LMT BRT BRST|2m.Q 30 20|012121212121212121212121212121212121212121|-2glxB.8 HdLB.8 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 8Q10 WL0 1tB0 5z0 2mN0 On0|93e4","America/Managua|MMT CST EST CDT|5J.c 60 50 50|0121313121213131|-1quie.M 1yAMe.M 4mn0 9Up0 Dz0 1K10 Dz0 s3F0 1KH0 DB0 9In0 k8p0 19X0 1o30 11y0|22e5","America/Manaus|LMT AMT AMST|40.4 40 30|01212121212121212121212121212121|-2glvX.U HdKX.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0|19e5","America/Martinique|FFMT AST ADT|44.k 40 30|0121|-2mPTT.E 2LPbT.E 19X0|39e4","America/Matamoros|LMT CST CDT|6E 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|45e4","America/Mazatlan|LMT MST CST PST MDT|75.E 70 60 80 60|0121212131414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|44e4","America/Menominee|CST CDT CWT CPT EST|60 50 50 50 50|01010230101041010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 LCN0 1fz0 6410 9Jb0 1cM0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|85e2","America/Merida|LMT CST EST CDT|5W.s 60 50 50|0121313131313131313131313131313131313131313131313131313131313131313131313131313131313131|-1UQG0 2q2o0 2hz0 wu30 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|11e5","America/Metlakatla|PST PWT PPT PDT AKST AKDT|80 70 70 70 90 80|0120303030303030303030303030303030454545454545454545454545454545454545454545454|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1hU10 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Mexico_City|LMT MST CST CDT CWT|6A.A 70 60 50 50|012121232324232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 gEn0 TX0 3xd0 Jb0 6zB0 SL0 e5d0 17b0 1Pff0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|20e6","America/Miquelon|LMT AST PMST PMDT|3I.E 40 30 20|012323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2mKkf.k 2LTAf.k gQ10 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Moncton|EST AST ADT AWT APT|50 40 30 30 30|012121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsH0 CwN0 1in0 zAo0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1K10 Lz0 1zB0 NX0 1u10 Wn0 S20 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14n1 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 ReX 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|64e3","America/Monterrey|LMT CST CDT|6F.g 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|41e5","America/Montevideo|MMT UYT UYHST UYST UYT UYHST|3I.I 3u 30 20 30 2u|012121212121212121212121213434343434345454543453434343434343434343434343434343434343434|-20UIf.g 8jzJ.g 1cLu 1dcu 1cLu 1dcu 1cLu ircu 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu WLu 1qMu WLu 1qMu 11zu 1o0u 11zu NAu 11bu 2iMu zWu Dq10 19X0 pd0 jz0 cm10 19X0 1fB0 1on0 11d0 1oL0 1nB0 1fzu 1aou 1fzu 1aou 1fzu 3nAu Jb0 3MN0 1SLu 4jzu 2PB0 Lb0 3Dd0 1pb0 ixd0 An0 1MN0 An0 1wp0 On0 1wp0 Rb0 1zd0 On0 1wp0 Rb0 s8p0 1fB0 1ip0 11z0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0|17e5","America/Toronto|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101012301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 11Wu 1nzu 1fD0 WJ0 1wr0 Nb0 1Ap0 On0 1zd0 On0 1wp0 TX0 1tB0 TX0 1tB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 4kM0 8x40 iv0 1o10 11z0 1nX0 11z0 1o10 11z0 1o10 1qL0 11D0 1nX0 11B0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|65e5","America/Nassau|LMT EST EDT|59.u 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2kNuO.u 26XdO.u 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|24e4","America/New_York|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 11B0 1qL0 1a10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x40 iv0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Nipigon|EST EDT EWT EPT|50 40 40 40|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 Rnb0 3je0 8x40 iv0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|16e2","America/Nome|NST NWT NPT BST BDT YST AKST AKDT|b0 a0 a0 b0 a0 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cl0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|38e2","America/Noronha|LMT FNT FNST|29.E 20 10|0121212121212121212121212121212121212121|-2glxO.k HdKO.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0|30e2","America/North_Dakota/Beulah|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/Center|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/New_Salem|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Ojinaga|LMT MST CST CDT MDT|6V.E 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e3","America/Pangnirtung|-00 AST AWT APT ADDT ADT EDT EST CST CDT|0 40 30 30 20 30 40 50 60 50|012314151515151515151515151515151515167676767689767676767676767676767676767676767676767676767676767676767676767676767676767|-1XiM0 PnG0 8x50 iu0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1o00 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Paramaribo|LMT PMT PMT NEGT SRT SRT|3E.E 3E.Q 3E.A 3u 3u 30|012345|-2nDUj.k Wqo0.c qanX.I 1dmLN.o lzc0|24e4","America/Phoenix|MST MDT MWT|70 60 60|01010202010|-261r0 1nX0 11B0 1nX0 SgN0 4Al1 Ap0 1db0 SWqX 1cL0|42e5","America/Port-au-Prince|PPMT EST EDT|4N 50 40|01212121212121212121212121212121212121212121|-28RHb 2FnMb 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14q0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 i6n0 1nX0 11B0 1nX0 d430 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Rio_Branco|LMT ACT ACST AMT|4v.c 50 40 40|01212121212121212121212121212131|-2glvs.M HdLs.M 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0 d5X0|31e4","America/Porto_Velho|LMT AMT AMST|4f.A 40 30|012121212121212121212121212121|-2glvI.o HdKI.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0|37e4","America/Puerto_Rico|AST AWT APT|40 30 30|0120|-17lU0 7XT0 iu0|24e5","America/Rainy_River|CST CDT CWT CPT|60 50 50 50|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TQ0 1in0 Rnb0 3je0 8x30 iw0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|842","America/Rankin_Inlet|-00 CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313131313131313131313131313131313131313131313131313131313131313131|-vDc0 keu0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e2","America/Recife|LMT BRT BRST|2j.A 30 20|0121212121212121212121212121212121212121|-2glxE.o HdLE.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0|33e5","America/Regina|LMT MST MDT MWT MPT CST|6W.A 70 60 60 60 60|012121212121212121212121341212121212121212121212121215|-2AD51.o uHe1.o 1in0 s2L0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 66N0 1cL0 1cN0 19X0 1fB0 1cL0 1fB0 1cL0 1cN0 1cL0 M30 8x20 ix0 1ip0 1cL0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 3NB0 1cL0 1cN0|19e4","America/Resolute|-00 CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313431313131313131313131313131313131313131313131313131313131313131|-SnA0 GWS0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|229","America/Santarem|LMT AMT AMST BRT|3C.M 40 30 30|0121212121212121212121212121213|-2glwl.c HdLl.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0|21e4","America/Santiago|SMT CLT CLT CLST CLST|4G.K 50 40 40 30|010203131313131212421242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424|-2q2jh.e fJAh.e 5knG.K 1Vzh.e jRAG.K 1pbh.e 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 nHX0 op0 9Bz0 jb0 1oN0 ko0 Qeo0 WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|62e5","America/Santo_Domingo|SDMT EST EDT EHDT AST|4E 50 40 4u 40|01213131313131414|-1ttjk 1lJMk Mn0 6sp0 Lbu 1Cou yLu 1RAu wLu 1QMu xzu 1Q0u xXu 1PAu 13jB0 e00|29e5","America/Sao_Paulo|LMT BRT BRST|36.s 30 20|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwR.w HdKR.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 pTd0 PX0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0|20e6","America/Scoresbysund|LMT CGT CGST EGST EGT|1r.Q 20 10 0 10|0121343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434|-2a5Ww.8 2z5ew.8 1a00 1cK0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|452","America/Sitka|PST PWT PPT PDT YST AKST AKDT|80 70 70 70 90 90 80|01203030303030303030303030303030345656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|90e2","America/St_Johns|NST NDT NST NDT NWT NPT NDDT|3u.Q 2u.Q 3u 2u 2u 2u 1u|01010101010101010101010101010101010102323232323232324523232323232323232323232323232323232323232323232323232323232323232323232323232323232326232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-28oit.8 14L0 1nB0 1in0 1gm0 Dz0 1JB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1fB0 19X0 1fB0 19X0 10O0 eKX.8 19X0 1iq0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","America/Swift_Current|LMT MST MDT MWT MPT CST|7b.k 70 60 60 60 60|012134121212121212121215|-2AD4M.E uHdM.E 1in0 UGp0 8x20 ix0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 isN0 1cL0 3Cp0 1cL0 1cN0 11z0 1qN0 WL0 pMp0|16e3","America/Tegucigalpa|LMT CST CDT|5M.Q 60 50|01212121|-1WGGb.8 2ETcb.8 WL0 1qN0 WL0 GRd0 AL0|11e5","America/Thule|LMT AST ADT|4z.8 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5To.Q 31NBo.Q 1cL0 1cN0 1cL0 1fB0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|656","America/Thunder_Bay|CST EST EWT EPT EDT|60 50 40 40 40|0123141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-2q5S0 1iaN0 8x40 iv0 XNB0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","America/Vancouver|PST PDT PWT PPT|80 70 70 70|0102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TO0 1in0 UGp0 8x10 iy0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Whitehorse|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 3NA0 vrd0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e3","America/Winnipeg|CST CDT CWT CPT|60 50 50 50|010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aIi0 WL0 3ND0 1in0 Jap0 Rb0 aCN0 8x30 iw0 1tB0 11z0 1ip0 11z0 1o10 11z0 1o10 11z0 1rd0 10L0 1op0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 1cL0 1cN0 11z0 6i10 WL0 6i10 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|66e4","America/Yakutat|YST YWT YPT YDT AKST AKDT|90 80 80 80 90 80|01203030303030303030303030303030304545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-17T10 8x00 iz0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cn0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|642","America/Yellowknife|-00 MST MWT MPT MDDT MDT|0 70 60 60 50 60|012314151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151|-1pdA0 hix0 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|19e3","Antarctica/Casey|-00 AWST CAST|0 -80 -b0|012121|-2q00 1DjS0 T90 40P0 KL0|10","Antarctica/Davis|-00 DAVT DAVT|0 -70 -50|01012121|-vyo0 iXt0 alj0 1D7v0 VB0 3Wn0 KN0|70","Antarctica/DumontDUrville|-00 PMT DDUT|0 -a0 -a0|0102|-U0o0 cfq0 bFm0|80","Antarctica/Macquarie|AEST AEDT -00 MIST|-a0 -b0 0 -b0|0102010101010101010101010101010101010101010101010101010101010101010101010101010101010101013|-29E80 19X0 4SL0 1ayy0 Lvs0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0|1","Antarctica/Mawson|-00 MAWT MAWT|0 -60 -50|012|-CEo0 2fyk0|60","Pacific/Auckland|NZMT NZST NZST NZDT|-bu -cu -c0 -d0|01020202020202020202020202023232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-1GCVu Lz0 1tB0 11zu 1o0u 11zu 1o0u 11zu 1o0u 14nu 1lcu 14nu 1lcu 1lbu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1qLu WMu 1qLu 11Au 1n1bu IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|14e5","Antarctica/Palmer|-00 ARST ART ART ARST CLT CLST|0 30 40 30 20 40 30|0121212121234356565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656|-cao0 nD0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 jsN0 14N0 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|40","Antarctica/Rothera|-00 ROTT|0 30|01|gOo0|130","Antarctica/Syowa|-00 SYOT|0 -30|01|-vs00|20","Antarctica/Troll|-00 UTC CEST|0 0 -20|01212121212121212121212121212121212121212121212121212121212121212121|1puo0 hd0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|40","Antarctica/Vostok|-00 VOST|0 -60|01|-tjA0|25","Europe/Oslo|CET CEST|-10 -20|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2awM0 Qm0 W6o0 5pf0 WM0 1fA0 1cM0 1cM0 1cM0 1cM0 wJc0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1qM0 WM0 zpc0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|62e4","Asia/Riyadh|LMT AST|-36.Q -30|01|-TvD6.Q|57e5","Asia/Almaty|LMT +05 +06 +07|-57.M -50 -60 -70|012323232323232323232321232323232323232323232323232|-1Pc57.M eUo7.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0|15e5","Asia/Amman|LMT EET EEST|-2n.I -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1yW2n.I 1HiMn.I KL0 1oN0 11b0 1oN0 11b0 1pd0 1dz0 1cp0 11b0 1op0 11b0 fO10 1db0 1e10 1cL0 1cN0 1cL0 1cN0 1fz0 1pd0 10n0 1ld0 14n0 1hB0 15b0 1ip0 19X0 1cN0 1cL0 1cN0 17b0 1ld0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1So0 y00 1fc0 1dc0 1co0 1dc0 1cM0 1cM0 1cM0 1o00 11A0 1lc0 17c0 1cM0 1cM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|25e5","Asia/Anadyr|LMT ANAT ANAT ANAST ANAST ANAST ANAT|-bN.U -c0 -d0 -e0 -d0 -c0 -b0|01232414141414141414141561414141414141414141414141414141414141561|-1PcbN.U eUnN.U 23CL0 1db0 1cN0 1dc0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qN0 WM0|13e3","Asia/Aqtau|LMT +04 +05 +06|-3l.4 -40 -50 -60|012323232323232323232123232312121212121212121212|-1Pc3l.4 eUnl.4 24PX0 2pX0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|15e4","Asia/Aqtobe|LMT +04 +05 +06|-3M.E -40 -50 -60|0123232323232323232321232323232323232323232323232|-1Pc3M.E eUnM.E 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0|27e4","Asia/Ashgabat|LMT ASHT ASHT ASHST ASHST TMT TMT|-3R.w -40 -50 -60 -50 -40 -50|012323232323232323232324156|-1Pc3R.w eUnR.w 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 ba0 xC0|41e4","Asia/Baghdad|BMT AST ADT|-2V.A -30 -40|012121212121212121212121212121212121212121212121212121|-26BeV.A 2ACnV.A 11b0 1cp0 1dz0 1dd0 1db0 1cN0 1cp0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1de0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0|66e5","Asia/Qatar|LMT GST AST|-3q.8 -40 -30|012|-21Jfq.8 27BXq.8|96e4","Asia/Baku|LMT BAKT BAKT BAKST BAKST AZST AZT AZT AZST|-3j.o -30 -40 -50 -40 -40 -30 -40 -50|01232323232323232323232456578787878787878787878787878787878787878787|-1Pc3j.o 1jUoj.o WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 10K0 c30 1cM0 1cM0 8wq0 1o00 11z0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|27e5","Asia/Bangkok|BMT ICT|-6G.4 -70|01|-218SG.4|15e6","Asia/Barnaul|LMT +06 +07 +08|-5z -60 -70 -80|0123232323232323232323212323232321212121212121212121212121212121212|-21S5z pCnz 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 p90 LE0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Asia/Beirut|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-21aq0 1on0 1410 1db0 19B0 1in0 1ip0 WL0 1lQp0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 q6N0 En0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1op0 11b0 dA10 17b0 1iN0 17b0 1iN0 17b0 1iN0 17b0 1vB0 SL0 1mp0 13z0 1iN0 17b0 1iN0 17b0 1jd0 12n0 1a10 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|22e5","Asia/Bishkek|LMT FRUT FRUT FRUST FRUST KGT KGST KGT|-4W.o -50 -60 -70 -60 -50 -60 -60|01232323232323232323232456565656565656565656565656567|-1Pc4W.o eUnW.o 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 11c0 1tX0 17b0 1ip0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1cPu 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 T8u|87e4","Asia/Brunei|LMT BNT BNT|-7D.E -7u -80|012|-1KITD.E gDc9.E|42e4","Asia/Kolkata|HMT BURT IST IST|-5R.k -6u -5u -6u|01232|-18LFR.k 1unn.k HB0 7zX0|15e6","Asia/Chita|LMT YAKT YAKT YAKST YAKST YAKT IRKT|-7x.Q -80 -90 -a0 -90 -a0 -80|0123232323232323232323241232323232323232323232323232323232323232562|-21Q7x.Q pAnx.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3re0|33e4","Asia/Choibalsan|LMT ULAT ULAT CHOST CHOT CHOT CHOST|-7C -70 -80 -a0 -90 -80 -90|0123434343434343434343434343434343434343434343456565656565656565656565656565656565656565656565|-2APHC 2UkoC cKn0 1da0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 3Db0 h1f0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|38e3","Asia/Shanghai|CST CDT|-80 -90|01010101010101010|-1c1I0 LX0 16p0 1jz0 1Myp0 Rb0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0|23e6","Asia/Colombo|MMT IST IHST IST LKT LKT|-5j.w -5u -60 -6u -6u -60|01231451|-2zOtj.w 1rFbN.w 1zzu 7Apu 23dz0 11zu n3cu|22e5","Asia/Dhaka|HMT BURT IST DACT BDT BDST|-5R.k -6u -5u -60 -60 -70|01213454|-18LFR.k 1unn.k HB0 m6n0 LqMu 1x6n0 1i00|16e6","Asia/Damascus|LMT EET EEST|-2p.c -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-21Jep.c Hep.c 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1xRB0 11X0 1oN0 10L0 1pB0 11b0 1oN0 10L0 1mp0 13X0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 Nb0 1AN0 Nb0 bcp0 19X0 1gp0 19X0 3ld0 1xX0 Vd0 1Bz0 Sp0 1vX0 10p0 1dz0 1cN0 1cL0 1db0 1db0 1g10 1an0 1ap0 1db0 1fd0 1db0 1cN0 1db0 1dd0 1db0 1cp0 1dz0 1c10 1dX0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 19z0 1fB0 1qL0 11B0 1on0 Wp0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0|26e5","Asia/Dili|LMT TLT JST TLT WITA|-8m.k -80 -90 -90 -80|012343|-2le8m.k 1dnXm.k 8HA0 1ew00 Xld0|19e4","Asia/Dubai|LMT GST|-3F.c -40|01|-21JfF.c|39e5","Asia/Dushanbe|LMT DUST DUST DUSST DUSST TJT|-4z.c -50 -60 -70 -60 -50|0123232323232323232323245|-1Pc4z.c eUnz.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 14N0|76e4","Asia/Gaza|EET EET EEST IST IDT|-20 -30 -30 -20 -30|010101010102020202020202020202023434343434343434343434343430202020202020202020202020202020202020202020202020202020202020202020202020202020202020|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 11z0 1o10 14o0 1lA1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0|18e5","Asia/Hebron|EET EET EEST IST IDT|-20 -30 -30 -20 -30|01010101010202020202020202020202343434343434343434343434343020202020202020202020202020202020202020202020202020202020202020202020202020202020202020|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 12L0 1mN0 14o0 1lc0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0|25e4","Asia/Ho_Chi_Minh|LMT PLMT ICT IDT JST|-76.E -76.u -70 -80 -90|0123423232|-2yC76.E bK00.a 1h7b6.u 5lz0 18o0 3Oq0 k5b0 aW00 BAM0|90e5","Asia/Hong_Kong|LMT HKT HKST JST|-7A.G -80 -90 -90|0121312121212121212121212121212121212121212121212121212121212121212121|-2CFHA.G 1sEP6.G 1cL0 ylu 93X0 1qQu 1tX0 Rd0 1In0 NB0 1cL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1kL0 14N0 1nX0 U10 1tz0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 Rd0 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 17d0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1cL0 6fd0 14n0|73e5","Asia/Hovd|LMT HOVT HOVT HOVST|-66.A -60 -70 -80|012323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2APG6.A 2Uko6.A cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 kEp0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|IMT IRKT IRKT IRKST IRKST IRKT|-6V.5 -70 -80 -90 -80 -90|012323232323232323232324123232323232323232323232323232323232323252|-21zGV.5 pjXV.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|60e4","Europe/Istanbul|IMT EET EEST TRST TRT|-1U.U -20 -30 -40 -30|012121212121212121212121212121212121212121212121212121234343434342121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ogNU.U dzzU.U 11b0 8tB0 1on0 1410 1db0 19B0 1in0 3Rd0 Un0 1oN0 11b0 zSp0 CL0 mN0 1Vz0 1gN0 1pz0 5Rd0 1fz0 1yp0 ML0 1kp0 17b0 1ip0 17b0 1fB0 19X0 1jB0 18L0 1ip0 17z0 qdd0 xX0 3S10 Tz0 dA10 11z0 1o10 11z0 1qN0 11z0 1ze0 11B0 WM0 1qO0 WI0 1nX0 1rB0 10L0 11B0 1in0 17d0 1in0 2pX0 19E0 1fU0 16Q0 1iI0 16Q0 1iI0 1Vd0 pb0 3Kp0 14o0 1df0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WO0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1tA0 U00 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|13e6","Asia/Jakarta|BMT JAVT WIB JST WIB WIB|-77.c -7k -7u -90 -80 -70|01232425|-1Q0Tk luM0 mPzO 8vWu 6kpu 4PXu xhcu|31e6","Asia/Jayapura|LMT WIT ACST|-9m.M -90 -9u|0121|-1uu9m.M sMMm.M L4nu|26e4","Asia/Jerusalem|JMT IST IDT IDDT|-2k.E -20 -30 -40|01212121212132121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-26Bek.E SyMk.E 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 3LB0 Em0 or0 1cn0 1dB0 16n0 10O0 1ja0 1tC0 14o0 1cM0 1a00 11A0 1Na0 An0 1MP0 AJ0 1Kp0 LC0 1oo0 Wl0 EQN0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 1hB0 1dX0 1ep0 1aL0 1eN0 17X0 1nf0 11z0 1tB0 19W0 1e10 17b0 1ep0 1gL0 18N0 1fz0 1eN0 17b0 1gq0 1gn0 19d0 1dz0 1c10 17X0 1hB0 1gn0 19d0 1dz0 1c10 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0|81e4","Asia/Kabul|AFT AFT|-40 -4u|01|-10Qs0|46e5","Asia/Kamchatka|LMT PETT PETT PETST PETST|-ay.A -b0 -c0 -d0 -c0|01232323232323232323232412323232323232323232323232323232323232412|-1SLKy.A ivXy.A 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qN0 WM0|18e4","Asia/Karachi|LMT IST IST KART PKT PKST|-4s.c -5u -6u -50 -50 -60|012134545454|-2xoss.c 1qOKW.c 7zX0 eup0 LqMu 1fy00 1cL0 dK10 11b0 1610 1jX0|24e6","Asia/Urumqi|LMT XJT|-5O.k -60|01|-1GgtO.k|32e5","Asia/Kathmandu|LMT IST NPT|-5F.g -5u -5J|012|-21JhF.g 2EGMb.g|12e5","Asia/Khandyga|LMT YAKT YAKT YAKST YAKST VLAT VLAST VLAT YAKT|-92.d -80 -90 -a0 -90 -a0 -b0 -b0 -a0|01232323232323232323232412323232323232323232323232565656565656565782|-21Q92.d pAp2.d 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 qK0 yN0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0|66e2","Asia/Krasnoyarsk|LMT KRAT KRAT KRAST KRAST KRAT|-6b.q -60 -70 -80 -70 -80|012323232323232323232324123232323232323232323232323232323232323252|-21Hib.q prAb.q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|10e5","Asia/Kuala_Lumpur|SMT MALT MALST MALT MALT JST MYT|-6T.p -70 -7k -7k -7u -90 -80|01234546|-2Bg6T.p 17anT.p 7hXE dM00 17bO 8Fyu 1so1u|71e5","Asia/Kuching|LMT BORT BORT BORTST JST MYT|-7l.k -7u -80 -8k -90 -80|01232323232323232425|-1KITl.k gDbP.k 6ynu AnE 1O0k AnE 1NAk AnE 1NAk AnE 1NAk AnE 1O0k AnE 1NAk AnE pAk 8Fz0 1so10|13e4","Asia/Macau|LMT MOT MOST CST|-7y.k -80 -90 -80|0121212121212121212121212121212121212121213|-2le7y.k 1XO34.k 1wn0 Rd0 1wn0 R9u 1wqu U10 1tz0 TVu 1tz0 17gu 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cJu 1cL0 1cN0 1fz0 1cN0 1cOu 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cJu 1cL0 1cN0 1fz0 1cN0 1cL0 KEp0|57e4","Asia/Magadan|LMT MAGT MAGT MAGST MAGST MAGT|-a3.c -a0 -b0 -c0 -b0 -c0|0123232323232323232323241232323232323232323232323232323232323232512|-1Pca3.c eUo3.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3Cq0|95e3","Asia/Makassar|LMT MMT WITA JST|-7V.A -7V.A -80 -90|01232|-21JjV.A vfc0 myLV.A 8ML0|15e5","Asia/Manila|PHT PHST JST|-80 -90 -90|010201010|-1kJI0 AL0 cK10 65X0 mXB0 vX0 VK10 1db0|24e6","Asia/Nicosia|LMT EET EEST|-2d.s -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Vc2d.s 2a3cd.s 1cL0 1qp0 Xz0 19B0 19X0 1fB0 1db0 1cp0 1cL0 1fB0 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1o30 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|32e4","Asia/Novokuznetsk|LMT +06 +07 +08|-5M.M -60 -70 -80|012323232323232323232321232323232323232323232323232323232323212|-1PctM.M eULM.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|55e4","Asia/Novosibirsk|LMT +06 +07 +08|-5v.E -60 -70 -80|0123232323232323232323212323212121212121212121212121212121212121212|-21Qnv.E pAFv.E 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 ml0 Os0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 4eN0|15e5","Asia/Omsk|LMT OMST OMST OMSST OMSST OMST|-4R.u -50 -60 -70 -60 -70|012323232323232323232324123232323232323232323232323232323232323252|-224sR.u pMLR.u 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|12e5","Asia/Oral|LMT +04 +05 +06|-3p.o -40 -50 -60|01232323232323232121212121212121212121212121212|-1Pc3p.o eUnp.o 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 1cM0 IM0 1EM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|27e4","Asia/Pontianak|LMT PMT WIB JST WIB WITA WIB|-7h.k -7h.k -7u -90 -80 -80 -70|012324256|-2ua7h.k XE00 munL.k 8Rau 6kpu 4PXu xhcu Wqnu|23e4","Asia/Pyongyang|LMT KST JCST JST KST|-8n -8u -90 -90 -90|012341|-2um8n 97XR 12FXu jdA0 2Onc0|29e5","Asia/Qyzylorda|LMT +04 +05 +06|-4l.Q -40 -50 -60|0123232323232323232323232323232323232323232323|-1Pc4l.Q eUol.Q 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 3ao0 1EM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|73e4","Asia/Rangoon|RMT BURT JST MMT|-6o.E -6u -90 -6u|0123|-21Jio.E SmnS.E 7j9u|48e5","Asia/Sakhalin|LMT JCST JST SAKT SAKST SAKST SAKT|-9u.M -90 -90 -b0 -c0 -b0 -a0|01234343434343434343434356343434343435656565656565656565656565656363|-2AGVu.M 1iaMu.M je00 1qFa0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o10 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0|58e4","Asia/Samarkand|LMT SAMT SAMT SAMST TAST UZST UZT|-4r.R -40 -50 -60 -60 -60 -50|01234323232323232323232356|-1Pc4r.R eUor.R 23CL0 1db0 1cM0 1dc0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 11x0 bf0|36e4","Asia/Seoul|LMT KST JCST JST KST KDT KDT|-8r.Q -8u -90 -90 -90 -9u -a0|01234151515151515146464|-2um8r.Q 97XV.Q 12FXu jjA0 kKo0 2I0u OL0 1FB0 Rb0 1qN0 TX0 1tB0 TX0 1tB0 TX0 1tB0 TX0 2ap0 12FBu 11A0 1o00 11A0|23e6","Asia/Singapore|SMT MALT MALST MALT MALT JST SGT SGT|-6T.p -70 -7k -7k -7u -90 -7u -80|012345467|-2Bg6T.p 17anT.p 7hXE dM00 17bO 8Fyu Mspu DTA0|56e5","Asia/Srednekolymsk|LMT MAGT MAGT MAGST MAGST MAGT SRET|-ae.Q -a0 -b0 -c0 -b0 -c0 -b0|012323232323232323232324123232323232323232323232323232323232323256|-1Pcae.Q eUoe.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|35e2","Asia/Taipei|JWST JST CST CDT|-80 -90 -80 -90|01232323232323232323232323232323232323232|-1iw80 joM0 1yo0 Tz0 1ip0 1jX0 1cN0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 10N0 1BX0 10p0 1pz0 10p0 1pz0 10p0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1BB0 ML0 1Bd0 ML0 uq10 1db0 1cN0 1db0 97B0 AL0|74e5","Asia/Tashkent|LMT TAST TAST TASST TASST UZST UZT|-4B.b -50 -60 -70 -60 -60 -50|01232323232323232323232456|-1Pc4B.b eUnB.b 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 11y0 bf0|23e5","Asia/Tbilisi|TBMT TBIT TBIT TBIST TBIST GEST GET GET GEST|-2X.b -30 -40 -50 -40 -40 -30 -40 -50|0123232323232323232323245656565787878787878787878567|-1Pc2X.b 1jUnX.b WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 3y0 19f0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cM0 1cL0 1fB0 3Nz0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 An0 Os0 WM0|11e5","Asia/Tehran|LMT TMT IRST IRST IRDT IRDT|-3p.I -3p.I -3u -40 -50 -4u|01234325252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2btDp.I 1d3c0 1huLT.I TXu 1pz0 sN0 vAu 1cL0 1dB0 1en0 pNB0 UL0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 64p0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6","Asia/Thimphu|LMT IST BTT|-5W.A -5u -60|012|-Su5W.A 1BGMs.A|79e3","Asia/Tokyo|JCST JST JDT|-90 -90 -a0|0121212121|-1iw90 pKq0 QL0 1lB0 13X0 1zB0 NX0 1zB0 NX0|38e6","Asia/Tomsk|LMT +06 +07 +08|-5D.P -60 -70 -80|0123232323232323232323212323232323232323232323212121212121212121212|-21NhD.P pxzD.P 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 co0 1bB0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3Qp0|10e5","Asia/Ulaanbaatar|LMT ULAT ULAT ULAST|-77.w -70 -80 -90|012323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2APH7.w 2Uko7.w cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 kEp0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|12e5","Asia/Ust-Nera|LMT YAKT YAKT MAGST MAGT MAGST MAGT MAGT VLAT VLAT|-9w.S -80 -90 -c0 -b0 -b0 -a0 -c0 -b0 -a0|0123434343434343434343456434343434343434343434343434343434343434789|-21Q9w.S pApw.S 23CL0 1d90 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0|65e2","Asia/Vladivostok|LMT VLAT VLAT VLAST VLAST VLAT|-8L.v -90 -a0 -b0 -a0 -b0|012323232323232323232324123232323232323232323232323232323232323252|-1SJIL.v itXL.v 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|60e4","Asia/Yakutsk|LMT YAKT YAKT YAKST YAKST YAKT|-8C.W -80 -90 -a0 -90 -a0|012323232323232323232324123232323232323232323232323232323232323252|-21Q8C.W pAoC.W 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|28e4","Asia/Yekaterinburg|LMT PMT SVET SVET SVEST SVEST YEKT YEKST YEKT|-42.x -3J.5 -40 -50 -60 -50 -50 -60 -60|0123434343434343434343435267676767676767676767676767676767676767686|-2ag42.x 7mQh.s qBvJ.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|14e5","Asia/Yerevan|LMT YERT YERT YERST YERST AMST AMT AMT AMST|-2W -30 -40 -50 -40 -40 -30 -40 -50|0123232323232323232323245656565657878787878787878787878787878787|-1Pc2W 1jUnW WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1am0 2r0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 3Fb0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|13e5","Atlantic/Azores|HMT AZOT AZOST AZOMT AZOT AZOST WET|1S.w 20 10 0 10 0 0|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121454545454545454545454545454545456545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2ldW5.s aPX5.s Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|25e4","Atlantic/Bermuda|LMT AST ADT|4j.i 40 30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1BnRE.G 1LTbE.G 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|65e3","Atlantic/Canary|LMT CANT WET WEST|11.A 10 0 -10|01232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UtaW.o XPAW.o 1lAK0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Atlantic/Cape_Verde|LMT CVT CVST CVT|1y.4 20 10 10|01213|-2xomp.U 1qOMp.U 7zX0 1djf0|50e4","Atlantic/Faroe|LMT WET WEST|r.4 0 -10|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2uSnw.U 2Wgow.U 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|49e3","Atlantic/Madeira|FMT MADT MADST MADMT WET WEST|17.A 10 0 -10 0 -10|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2ldWQ.o aPWQ.o Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e4","Atlantic/Reykjavik|LMT IST ISST GMT|1s 10 0 0|012121212121212121212121212121212121212121212121212121212121212121213|-2uWmw mfaw 1Bd0 ML0 1LB0 Cn0 1LB0 3fX0 C10 HrX0 1cO0 LB0 1EL0 LA0 1C00 Oo0 1wo0 Rc0 1wo0 Rc0 1wo0 Rc0 1zc0 Oo0 1zc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0|12e4","Atlantic/South_Georgia|GST|20|0||30","Atlantic/Stanley|SMT FKT FKST FKT FKST|3P.o 40 30 30 20|0121212121212134343212121212121212121212121212121212121212121212121212|-2kJw8.A 12bA8.A 19X0 1fB0 19X0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 Cn0 1Cc10 WL0 1qL0 U10 1tz0 U10 1qM0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 U10 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qN0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 U10 1tz0 U10 1tz0 U10|21e2","Australia/Sydney|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|40e5","Australia/Adelaide|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 WM0 1qM0 Rc0 1zc0 U00 1tA0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|11e5","Australia/Brisbane|AEST AEDT|-a0 -b0|01010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0|20e5","Australia/Broken_Hill|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|18e3","Australia/Currie|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|746","Australia/Darwin|ACST ACDT|-9u -au|010101010|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0|12e4","Australia/Eucla|ACWST ACWDT|-8J -9J|0101010101010101010|-293kI xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0|368","Australia/Hobart|AEST AEDT|-a0 -b0|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 VfB0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|21e4","Australia/Lord_Howe|AEST LHST LHDT LHDT|-a0 -au -bu -b0|0121212121313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313|raC0 1zdu Rb0 1zd0 On0 1zd0 On0 1zd0 On0 1zd0 TXu 1qMu WLu 1tAu WLu 1tAu TXu 1tAu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu 11zu 1o0u 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 11Au 1nXu 1qMu 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu 11zu 1o0u WLu 1qMu 14nu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu|347","Australia/Lindeman|AEST AEDT|-a0 -b0|010101010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0|10","Australia/Melbourne|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1qM0 11A0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|39e5","Australia/Perth|AWST AWDT|-80 -90|0101010101010101010|-293jX xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0|18e5","CET|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","CST6CDT|CST CDT CWT CPT|60 50 50 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Pacific/Easter|EMT EAST EASST EAST EASST|7h.s 70 60 60 50|0121212121212121212121212121234343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434|-1uSgG.w 1s4IG.w WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|30e2","EET|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","EST|EST|50|0|","EST5EDT|EST EDT EWT EPT|50 40 40 40|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 SgN0 8x40 iv0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Europe/Dublin|DMT IST GMT BST IST|p.l -y.D 0 -10 -10|01232323232324242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242|-2ax9y.D Rc0 1fzy.D 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 g5X0 14p0 1wn0 17d0 1io0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Etc/GMT+0|GMT|0|0|","Etc/GMT+1|GMT+1|10|0|","Etc/GMT+10|GMT+10|a0|0|","Etc/GMT+11|GMT+11|b0|0|","Etc/GMT+12|GMT+12|c0|0|","Etc/GMT+2|GMT+2|20|0|","Etc/GMT+3|GMT+3|30|0|","Etc/GMT+4|GMT+4|40|0|","Etc/GMT+5|GMT+5|50|0|","Etc/GMT+6|GMT+6|60|0|","Etc/GMT+7|GMT+7|70|0|","Etc/GMT+8|GMT+8|80|0|","Etc/GMT+9|GMT+9|90|0|","Etc/GMT-1|GMT-1|-10|0|","Etc/GMT-10|GMT-10|-a0|0|","Etc/GMT-11|GMT-11|-b0|0|","Etc/GMT-12|GMT-12|-c0|0|","Etc/GMT-13|GMT-13|-d0|0|","Etc/GMT-14|GMT-14|-e0|0|","Etc/GMT-2|GMT-2|-20|0|","Etc/GMT-3|GMT-3|-30|0|","Etc/GMT-4|GMT-4|-40|0|","Etc/GMT-5|GMT-5|-50|0|","Etc/GMT-6|GMT-6|-60|0|","Etc/GMT-7|GMT-7|-70|0|","Etc/GMT-8|GMT-8|-80|0|","Etc/GMT-9|GMT-9|-90|0|","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Amsterdam|AMT NST NEST NET CEST CET|-j.w -1j.w -1k -k -20 -10|010101010101010101010101010101010101010101012323234545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545|-2aFcj.w 11b0 1iP0 11A0 1io0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1co0 1io0 1yo0 Pc0 1a00 1fA0 1Bc0 Mo0 1tc0 Uo0 1tA0 U00 1uo0 W00 1s00 VA0 1so0 Vc0 1sM0 UM0 1wo0 Rc0 1u00 Wo0 1rA0 W00 1s00 VA0 1sM0 UM0 1w00 fV0 BCX.w 1tA0 U00 1u00 Wo0 1sm0 601k WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|16e5","Europe/Andorra|WET CET CEST|0 -10 -20|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-UBA0 1xIN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|79e3","Europe/Astrakhan|LMT +03 +04 +05|-3c.c -30 -40 -50|012323232323232323212121212121212121212121212121212121212121212|-1Pcrc.c eUMc.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Europe/Athens|AMT EET EEST CEST CET|-1y.Q -20 -30 -20 -10|012123434121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a61x.Q CNbx.Q mn0 kU10 9b0 3Es0 Xa0 1fb0 1dd0 k3X0 Nz0 SCp0 1vc0 SO0 1cM0 1a00 1ao0 1fc0 1a10 1fG0 1cg0 1dX0 1bX0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|35e5","Europe/London|GMT BST BDST|0 -10 -20|0101010101010101010101010101010101010101010101010121212121210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|10e6","Europe/Belgrade|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19RC0 3IP0 WM0 1fA0 1cM0 1cM0 1rc0 Qo0 1vmo0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Berlin|CET CEST CEMT|-10 -20 -30|01010101010101210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 kL0 Nc0 m10 WM0 1ao0 1cp0 dX0 jz0 Dd0 1io0 17c0 1fA0 1a00 1ehA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|41e5","Europe/Prague|CET CEST|-10 -20|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 16M0 1lc0 1tA0 17A0 11c0 1io0 17c0 1io0 17c0 1fc0 1ao0 1bNc0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|13e5","Europe/Brussels|WET CET CEST WEST|0 -10 -20 -10|0121212103030303030303030303030303030303030303030303212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ehc0 3zX0 11c0 1iO0 11A0 1o00 11A0 my0 Ic0 1qM0 Rc0 1EM0 UM0 1u00 10o0 1io0 1io0 17c0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a30 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 y00 5Wn0 WM0 1fA0 1cM0 16M0 1iM0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|21e5","Europe/Bucharest|BMT EET EEST|-1I.o -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1xApI.o 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Axc0 On0 1fA0 1a10 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|19e5","Europe/Budapest|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1ip0 17b0 1op0 1tb0 Q2m0 3Ne0 WM0 1fA0 1cM0 1cM0 1oJ0 1dc0 1030 1fA0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1iM0 1fA0 8Ha0 Rb0 1wN0 Rb0 1BB0 Lz0 1C20 LB0 SNX0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e5","Europe/Zurich|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19Lc0 11A0 1o00 11A0 1xG10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|38e4","Europe/Chisinau|CMT BMT EET EEST CEST CET MSK MSD|-1T -1I.o -20 -30 -20 -10 -30 -40|012323232323232323234545467676767676767676767323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-26jdT wGMa.A 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 27A0 2en0 39g0 WM0 1fA0 1cM0 V90 1t7z0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 gL0 WO0 1cM0 1cM0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11D0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|67e4","Europe/Copenhagen|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 Tz0 VuO0 60q0 WM0 1fA0 1cM0 1cM0 1cM0 S00 1HA0 Nc0 1C00 Dc0 1Nc0 Ao0 1h5A0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Gibraltar|GMT BST BDST CET CEST|0 -10 -20 -10 -20|010101010101010101010101010101010101010101010101012121212121010121010101010101010101034343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 10Jz0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|30e3","Europe/Helsinki|HMT EET EEST|-1D.N -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1WuND.N OULD.N 1dA0 1xGq0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Kaliningrad|CET CEST CET CEST MSK MSD EEST EET FET|-10 -20 -20 -30 -30 -40 -30 -20 -30|0101010101010232454545454545454546767676767676767676767676767676767676767676787|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 Am0 Lb0 1en0 op0 1pNz0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|44e4","Europe/Kiev|KMT EET MSK CEST CET MSD EEST|-22.4 -20 -30 -20 -10 -40 -30|0123434252525252525252525256161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc22.4 eUo2.4 rnz0 2Hg0 WM0 1fA0 da0 1v4m0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 Db0 3220 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|34e5","Europe/Kirov|LMT +03 +04 +05|-3i.M -30 -40 -50|01232323232323232321212121212121212121212121212121212121212121|-22WNi.M qHai.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|48e4","Europe/Lisbon|LMT WET WEST WEMT CET CEST|A.J 0 -10 -20 -10 -20|012121212121212121212121212121212121212121212321232123212321212121212121212121212121212121212121214121212121212121212121212121212124545454212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ldXn.f aPWn.f Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 pvy0 1cM0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e5","Europe/Luxembourg|LMT CET CEST WET WEST WEST WET|-o.A -10 -20 0 -10 -20 -10|0121212134343434343434343434343434343434343434343434565651212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2DG0o.A t6mo.A TB0 1nX0 Up0 1o20 11A0 rW0 CM0 1qP0 R90 1EO0 UK0 1u20 10m0 1ip0 1in0 17e0 19W0 1fB0 1db0 1cp0 1in0 17d0 1fz0 1a10 1in0 1a10 1in0 17f0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 vA0 60L0 WM0 1fA0 1cM0 17c0 1io0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Europe/Madrid|WET WEST WEMT CET CEST|0 -10 -20 -10 -20|01010101010101010101010121212121234343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-28dd0 11A0 1go0 19A0 1co0 1dA0 b1A0 18o0 3I00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 iyo0 Rc0 18o0 1hc0 1io0 1a00 14o0 5aL0 MM0 1vc0 17A0 1i00 1bc0 1eo0 17d0 1in0 17A0 6hA0 10N0 XIL0 1a10 1in0 17d0 19X0 1cN0 1fz0 1a10 1fX0 1cp0 1cO0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|62e5","Europe/Malta|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2as10 M00 1cM0 1cM0 14o0 1o00 WM0 1qM0 17c0 1cM0 M3A0 5M20 WM0 1fA0 1cM0 1cM0 1cM0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 Lz0 1C10 Lz0 1EN0 Lz0 1C10 Lz0 1zd0 Oo0 1C00 On0 1cp0 1cM0 1lA0 Xc0 1qq0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1iN0 19z0 1fB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|42e4","Europe/Minsk|MMT EET MSK CEST CET MSD EEST FET|-1O -20 -30 -20 -10 -40 -30 -30|012343432525252525252525252616161616161616161616161616161616161616172|-1Pc1O eUnO qNX0 3gQ0 WM0 1fA0 1cM0 Al0 1tsn0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 3Fc0 1cN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hy0|19e5","Europe/Monaco|PMT WET WEST WEMT CET CEST|-9.l 0 -10 -20 -10 -20|01212121212121212121212121212121212121212121212121232323232345454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 2RV0 11z0 11B0 1ze0 WM0 1fA0 1cM0 1fa0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|38e3","Europe/Moscow|MMT MMT MST MDST MSD MSK MSM EET EEST MSK|-2u.h -2v.j -3v.j -4v.j -40 -30 -50 -20 -30 -40|012132345464575454545454545454545458754545454545454545454545454545454545454595|-2ag2u.h 2pyW.W 1bA0 11X0 GN0 1Hb0 c20 imv.j 3DA0 dz0 15A0 c10 2q10 iM10 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|16e6","Europe/Paris|PMT WET WEST CEST CET WEMT|-9.l 0 -10 -20 -10 -20|0121212121212121212121212121212121212121212121212123434352543434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434|-2nco8.l cNb8.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 Ik0 5M30 WM0 1fA0 1cM0 Vx0 hB0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e6","Europe/Riga|RMT LST EET MSK CEST CET MSD EEST|-1A.y -2A.y -20 -30 -20 -10 -40 -30|010102345454536363636363636363727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272|-25TzA.y 11A0 1iM0 ko0 gWm0 yDXA.y 2bX0 3fE0 WM0 1fA0 1cM0 1cM0 4m0 1sLy0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 1o00 11A0 1o00 11A0 1qM0 3oo0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|64e4","Europe/Rome|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2as10 M00 1cM0 1cM0 14o0 1o00 WM0 1qM0 17c0 1cM0 M3A0 5M20 WM0 1fA0 1cM0 16K0 1iO0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 Lz0 1C10 Lz0 1EN0 Lz0 1C10 Lz0 1zd0 Oo0 1C00 On0 1C10 Lz0 1zd0 On0 1C10 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1zc0 Oo0 1fC0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|39e5","Europe/Samara|LMT SAMT SAMT KUYT KUYST MSD MSK EEST SAMST SAMST|-3k.k -30 -40 -40 -50 -40 -30 -30 -50 -40|012343434343434343435656712828282828282828282828282828282828282912|-22WNk.k qHak.k bcn0 1Qqo0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cN0 8o0 14m0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qN0 WM0|12e5","Europe/Simferopol|SMT EET MSK CEST CET MSD EEST MSK|-2g -20 -30 -20 -10 -40 -30 -40|012343432525252525252525252161616525252616161616161616161616161616161616172|-1Pc2g eUog rEn0 2qs0 WM0 1fA0 1cM0 3V0 1u0L0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 4eL0 1cL0 1cN0 1cL0 1cN0 dX0 WL0 1cN0 1cL0 1fB0 1o30 11B0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0|33e4","Europe/Sofia|EET CET CEST EEST|-20 -10 -20 -30|01212103030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030|-168L0 WM0 1fA0 1cM0 1cM0 1cN0 1mKH0 1dd0 1fb0 1ap0 1fb0 1a20 1fy0 1a30 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Stockholm|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 TB0 2yDe0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|15e5","Europe/Tallinn|TMT CET CEST EET MSK MSD EEST|-1D -10 -20 -20 -30 -40 -30|012103421212454545454545454546363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363|-26oND teD 11A0 1Ta0 4rXl KSLD 2FX0 2Jg0 WM0 1fA0 1cM0 18J0 1sTX0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o10 11A0 1qM0 5QM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|41e4","Europe/Tirane|LMT CET CEST|-1j.k -10 -20|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2glBj.k 14pcj.k 5LC0 WM0 4M0 1fCK0 10n0 1op0 11z0 1pd0 11z0 1qN0 WL0 1qp0 Xb0 1qp0 Xb0 1qp0 11z0 1lB0 11z0 1qN0 11z0 1iN0 16n0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|42e4","Europe/Ulyanovsk|LMT +03 +04 +05 +02|-3d.A -30 -40 -50 -20|01232323232323232321214121212121212121212121212121212121212121212|-22WNd.A qHad.A 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Europe/Uzhgorod|CET CEST MSK MSD EET EEST|-10 -20 -30 -40 -20 -30|010101023232323232323232320454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-1cqL0 6i00 WM0 1fA0 1cM0 1ml0 1Cp0 1r3W0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 1Nf0 2pw0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e4","Europe/Vienna|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 3KM0 14o0 LA00 6i00 WM0 1fA0 1cM0 1cM0 1cM0 400 2qM0 1a00 1cM0 1cM0 1io0 17c0 1gHa0 19X0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|18e5","Europe/Vilnius|WMT KMT CET EET MSK CEST MSD EEST|-1o -1z.A -10 -20 -30 -20 -40 -30|012324525254646464646464646473737373737373737352537373737373737373737373737373737373737373737373737373737373737373737373|-293do 6ILM.o 1Ooz.A zz0 Mfd0 29W0 3is0 WM0 1fA0 1cM0 LV0 1tgL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11B0 1o00 11A0 1qM0 8io0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Europe/Volgograd|LMT TSAT STAT STAT VOLT VOLST VOLST VOLT MSD MSK MSK|-2V.E -30 -30 -40 -40 -50 -40 -30 -40 -30 -40|0123454545454545454676767489898989898989898989898989898989898989a9|-21IqV.E cLXV.E cEM0 1gqn0 Lco0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1cM0 1fA0 1cM0 2pz0 1cN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|10e5","Europe/Warsaw|WMT CET CEST EET EEST|-1o -10 -20 -20 -30|012121234312121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ctdo 1LXo 11d0 1iO0 11A0 1o00 11A0 1on0 11A0 6zy0 HWP0 5IM0 WM0 1fA0 1cM0 1dz0 1mL0 1en0 15B0 1aq0 1nA0 11A0 1io0 17c0 1fA0 1a00 iDX0 LA0 1cM0 1cM0 1C00 Oo0 1cM0 1cM0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1C00 LA0 uso0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e5","Europe/Zaporozhye|CUT EET MSK CEST CET MSD EEST|-2k -20 -30 -20 -10 -40 -30|01234342525252525252525252526161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc2k eUok rdb0 2RE0 WM0 1fA0 8m0 1v9a0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cK0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|77e4","HST|HST|a0|0|","Indian/Chagos|LMT IOT IOT|-4N.E -50 -60|012|-2xosN.E 3AGLN.E|30e2","Indian/Christmas|CXT|-70|0||21e2","Indian/Cocos|CCT|-6u|0||596","Indian/Kerguelen|-00 TFT|0 -50|01|-MG00|130","Indian/Mahe|LMT SCT|-3F.M -40|01|-2yO3F.M|79e3","Indian/Maldives|MMT MVT|-4S -50|01|-olgS|35e4","Indian/Mauritius|LMT MUT MUST|-3O -40 -50|012121|-2xorO 34unO 14L0 12kr0 11z0|15e4","Indian/Reunion|LMT RET|-3F.Q -40|01|-2mDDF.Q|84e4","Pacific/Kwajalein|MHT KWAT MHT|-b0 c0 -c0|012|-AX0 W9X0|14e3","MET|MET MEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","MST|MST|70|0|","MST7MDT|MST MDT MWT MPT|70 60 60 60|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Pacific/Chatham|CHAST CHAST CHADT|-cf -cJ -dJ|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-WqAf 1adef IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|600","PST8PDT|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Pacific/Apia|LMT WSST SST SDT WSDT WSST|bq.U bu b0 a0 -e0 -d0|01232345454545454545454545454545454545454545454545454545454|-2nDMx.4 1yW03.4 2rRbu 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|37e3","Pacific/Bougainville|PGT JST BST|-a0 -90 -b0|0102|-16Wy0 7CN0 2MQp0|18e4","Pacific/Chuuk|CHUT|-a0|0||49e3","Pacific/Efate|LMT VUT VUST|-bd.g -b0 -c0|0121212121212121212121|-2l9nd.g 2Szcd.g 1cL0 1oN0 10L0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 Lz0 1Nd0 An0|66e3","Pacific/Enderbury|PHOT PHOT PHOT|c0 b0 -d0|012|nIc0 B8n0|1","Pacific/Fakaofo|TKT TKT|b0 -d0|01|1Gfn0|483","Pacific/Fiji|LMT FJT FJST|-bT.I -c0 -d0|0121212121212121212121212121212121212121212121212121212121212121|-2bUzT.I 3m8NT.I LA0 1EM0 IM0 nJc0 LA0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0|88e4","Pacific/Funafuti|TVT|-c0|0||45e2","Pacific/Galapagos|LMT ECT GALT|5W.o 50 60|012|-1yVS1.A 2dTz1.A|25e3","Pacific/Gambier|LMT GAMT|8X.M 90|01|-2jof0.c|125","Pacific/Guadalcanal|LMT SBT|-aD.M -b0|01|-2joyD.M|11e4","Pacific/Guam|GST ChST|-a0 -a0|01|1fpq0|17e4","Pacific/Honolulu|HST HDT HST|au 9u a0|010102|-1thLu 8x0 lef0 8Pz0 46p0|37e4","Pacific/Kiritimati|LINT LINT LINT|aE a0 -e0|012|nIaE B8nk|51e2","Pacific/Kosrae|KOST KOST|-b0 -c0|010|-AX0 1bdz0|66e2","Pacific/Majuro|MHT MHT|-b0 -c0|01|-AX0|28e3","Pacific/Marquesas|LMT MART|9i 9u|01|-2joeG|86e2","Pacific/Pago_Pago|LMT NST BST SST|bm.M b0 b0 b0|0123|-2nDMB.c 2gVzB.c EyM0|37e2","Pacific/Nauru|LMT NRT JST NRT|-b7.E -bu -90 -c0|01213|-1Xdn7.E PvzB.E 5RCu 1ouJu|10e3","Pacific/Niue|NUT NUT NUT|bk bu b0|012|-KfME 17y0a|12e2","Pacific/Norfolk|NMT NFT NFST NFT|-bc -bu -cu -b0|01213|-Kgbc W01G On0 1COp0|25e4","Pacific/Noumea|LMT NCT NCST|-b5.M -b0 -c0|01212121|-2l9n5.M 2EqM5.M xX0 1PB0 yn0 HeP0 Ao0|98e3","Pacific/Palau|PWT|-90|0||21e3","Pacific/Pitcairn|PNT PST|8u 80|01|18Vku|56","Pacific/Pohnpei|PONT|-b0|0||34e3","Pacific/Port_Moresby|PGT|-a0|0||25e4","Pacific/Rarotonga|CKT CKHST CKT|au 9u a0|012121212121212121212121212|lyWu IL0 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu|13e3","Pacific/Tahiti|LMT TAHT|9W.g a0|01|-2joe1.I|18e4","Pacific/Tarawa|GILT|-c0|0||29e3","Pacific/Tongatapu|TOT TOT TOST|-ck -d0 -e0|01212121|-1aB0k 2n5dk 15A0 1wo0 xz0 1Q10 xz0|75e3","Pacific/Wake|WAKT|-c0|0||16e3","Pacific/Wallis|WFT|-c0|0||94","WET|WET WEST|0 -10|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00"],
links:["Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Sao_Tome","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|Atlantic/St_Helena","Africa/Cairo|Egypt","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Khartoum|Africa/Juba","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|US/Alaska","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Catamarca|America/Argentina/ComodRivadavia","America/Argentina/Catamarca|America/Catamarca","America/Argentina/Cordoba|America/Cordoba","America/Argentina/Cordoba|America/Rosario","America/Argentina/Jujuy|America/Jujuy","America/Argentina/Mendoza|America/Mendoza","America/Atikokan|America/Coral_Harbour","America/Chicago|US/Central","America/Curacao|America/Aruba","America/Curacao|America/Kralendijk","America/Curacao|America/Lower_Princes","America/Denver|America/Shiprock","America/Denver|Navajo","America/Denver|US/Mountain","America/Detroit|US/Michigan","America/Edmonton|Canada/Mountain","America/Fort_Wayne|America/Indiana/Indianapolis","America/Fort_Wayne|America/Indianapolis","America/Fort_Wayne|US/East-Indiana","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/Indiana/Knox|America/Knox_IN","America/Indiana/Knox|US/Indiana-Starke","America/Jamaica|Jamaica","America/Kentucky/Louisville|America/Louisville","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Manaus|Brazil/West","America/Mazatlan|Mexico/BajaSur","America/Mexico_City|Mexico/General","America/New_York|US/Eastern","America/Noronha|Brazil/DeNoronha","America/Panama|America/Cayman","America/Phoenix|US/Arizona","America/Port_of_Spain|America/Anguilla","America/Port_of_Spain|America/Antigua","America/Port_of_Spain|America/Dominica","America/Port_of_Spain|America/Grenada","America/Port_of_Spain|America/Guadeloupe","America/Port_of_Spain|America/Marigot","America/Port_of_Spain|America/Montserrat","America/Port_of_Spain|America/St_Barthelemy","America/Port_of_Spain|America/St_Kitts","America/Port_of_Spain|America/St_Lucia","America/Port_of_Spain|America/St_Thomas","America/Port_of_Spain|America/St_Vincent","America/Port_of_Spain|America/Tortola","America/Port_of_Spain|America/Virgin","America/Regina|Canada/East-Saskatchewan","America/Regina|Canada/Saskatchewan","America/Rio_Branco|America/Porto_Acre","America/Rio_Branco|Brazil/Acre","America/Santiago|Chile/Continental","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","America/Tijuana|America/Ensenada","America/Tijuana|America/Santa_Isabel","America/Tijuana|Mexico/BajaNorte","America/Toronto|America/Montreal","America/Toronto|Canada/Eastern","America/Vancouver|Canada/Pacific","America/Whitehorse|Canada/Yukon","America/Winnipeg|Canada/Central","Asia/Ashgabat|Asia/Ashkhabad","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Vientiane","Asia/Dhaka|Asia/Dacca","Asia/Dubai|Asia/Muscat","Asia/Ho_Chi_Minh|Asia/Saigon","Asia/Hong_Kong|Hongkong","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Macau|Asia/Macao","Asia/Makassar|Asia/Ujung_Pandang","Asia/Nicosia|Europe/Nicosia","Asia/Qatar|Asia/Bahrain","Asia/Riyadh|Asia/Aden","Asia/Riyadh|Asia/Kuwait","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|PRC","Asia/Singapore|Singapore","Asia/Taipei|ROC","Asia/Tehran|Iran","Asia/Thimphu|Asia/Thimbu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Urumqi|Asia/Kashgar","Atlantic/Faroe|Atlantic/Faeroe","Atlantic/Reykjavik|Iceland","Australia/Adelaide|Australia/South","Australia/Brisbane|Australia/Queensland","Australia/Broken_Hill|Australia/Yancowinna","Australia/Darwin|Australia/North","Australia/Hobart|Australia/Tasmania","Australia/Lord_Howe|Australia/LHI","Australia/Melbourne|Australia/Victoria","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/NSW","Etc/GMT+0|Etc/GMT","Etc/GMT+0|Etc/GMT-0","Etc/GMT+0|Etc/GMT0","Etc/GMT+0|Etc/Greenwich","Etc/GMT+0|GMT","Etc/GMT+0|GMT+0","Etc/GMT+0|GMT-0","Etc/GMT+0|GMT0","Etc/GMT+0|Greenwich","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Belgrade|Europe/Ljubljana","Europe/Belgrade|Europe/Podgorica","Europe/Belgrade|Europe/Sarajevo","Europe/Belgrade|Europe/Skopje","Europe/Belgrade|Europe/Zagreb","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Helsinki|Europe/Mariehamn","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Portugal","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|W-SU","Europe/Oslo|Arctic/Longyearbyen","Europe/Oslo|Atlantic/Jan_Mayen","Europe/Prague|Europe/Bratislava","Europe/Rome|Europe/San_Marino","Europe/Rome|Europe/Vatican","Europe/Warsaw|Poland","Europe/Zurich|Europe/Busingen","Europe/Zurich|Europe/Vaduz","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Chuuk|Pacific/Truk","Pacific/Chuuk|Pacific/Yap","Pacific/Easter|Chile/EasterIsland","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kwajalein|Kwajalein","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pohnpei|Pacific/Ponape"]}},function(e,t,i){var n=i(166).dimensions,o={0:"amu_id",1:"weapon_id",2:"ringl_id",3:"belt_id",4:"ringr_id",5:"boots_id",6:"hat_id",7:"cloack_id",8:"pet_id",15:"shield_id"};t.addEquippedItem=function(e,t){var i=t.inventory.equippedItems;for(var n in o){var s=i[n],a=o[n];s?e[a]=s.getProperty("objectGID"):e[a]=void 0}e.comp_id=void 0;var r=t.equippedMount;t.isRiding&&r&&r.model?e.ride_id=r.model:e.ride_id=void 0},t.addCharacterInfo=function(e){if(window.gui.playerData){var t=window.gui.playerData,i=t.characterBaseInformations||{},n=t.position||{};e.server_id=window.gui.serversData.connectedServerId,e.character_id=t.id,e.character_level=i.level,e.soft_currency_balance=t.inventory.kamas,e.hard_currency_balance=t.inventory.goultines,e.map_id=n.mapId}},t.addAccountId=function(e){var t=window.gui.playerData;t&&t.identification&&(e.account_id=t.identification.accountId)},t.addResolution=function(e){e.dimensions=n.screenWidth+"_"+n.screenHeight},t.addSubscriptionInfo=function(e){e.subscription_days=window.gui.playerData.getSubscriptionDays()}},function(e,t,i){function n(e,t){p.screenWidth=e||document.documentElement.clientWidth,p.screenHeight=t||document.documentElement.clientHeight,p.physicalToViewportRatio=p.screenWidth/p.physicalScreenWidth}function o(e){var t=e/c.MAP_SCENE_HEIGHT;p.mapWidth=~~(c.MAP_SCENE_WIDTH*t),p.mapHeight=~~(c.MAP_SCENE_HEIGHT*t),p.zoom=c.PIXEL_RATIO*t,p.sideBarWidth=p.screenWidth-p.mapWidth,p.bottomBarHeight=p.screenHeight-p.mapHeight}function s(e,t){var i,n,o;"narrow"===e?(i=p.screenWidth,n=c.CHAT_BTN_MIN_WIDTH,p.mainControlBarSize=132,o=c.PING_EMOTE_BTN_NARROW_MIN_WIDTH):(i=p.screenHeight,n=c.CHAT_BTN_MIN_HEIGHT,p.mainControlBarSize=72,o=c.PING_EMOTE_BTN_WIDE_MIN_HEIGHT);var s=0;"narrow"===e?(p.posChatBtn=s,s+=n,p.pingEmoteBtnSize=o,p.posPingEmoteBtn=s,s+=o):(p.pingEmoteBtnSize=o,o=0),p.posMainControlBar=s,s+=p.mainControlBarSize;var a=window.gui.shortcutBar,r=window.gui.menuBar,l=i-p.mainControlBarSize-n,u=t?d.menubarSizeInFight:d.menubarSize,h=r.computeMinimumSize(u,e),m=~~(l-h-o),f=a.computeBestSize(m,e),g=l-f-o-h;p.menuBarSize=h+g,p.shortcutBarSize=f,p.posShortcutBar=s,s+=p.shortcutBarSize,p.posMenuBar=s,s+=p.menuBarSize,"wide"===e&&(p.posChatBtn=s,p.posPingEmoteBtn=s)}function a(e){var t;return t="narrow"===e?window.gui.playerData.isFighting?d.toolbarThicknessInFight:1:3,t*c.SHORTCUT_ICON_SIZE+c.SHORTCUT_GAUGE_SIZE+5}function r(e){var t="narrow",i=p.screenHeight-a(t),n=i/c.MAP_SCENE_HEIGHT,r=~~(c.MAP_SCENE_WIDTH*n);r>p.screenWidth&&(n=p.screenWidth/c.MAP_SCENE_WIDTH,i=~~(c.MAP_SCENE_HEIGHT*n)),o(i),p.bottomBarHeight=Math.min(p.bottomBarHeight,u),s(t,e),p.mapLeft=Math.round(p.sideBarWidth/2),p.mapTop=p.screenHeight-p.bottomBarHeight-p.mapHeight,p.mapRight=p.mapLeft+p.mapWidth,p.mapBottom=p.mapTop+p.mapHeight,p.windowFullScreenWidth=p.screenWidth,p.windowFullScreenHeight=p.mapBottom,p.screenExceptToolbar={left:0,top:0,width:p.screenWidth,height:p.screenHeight-p.bottomBarHeight}}function l(e){var t="wide",i=p.screenWidth-a(t),n=i/c.MAP_SCENE_WIDTH,r=~~(c.MAP_SCENE_HEIGHT*n);o(Math.min(r,p.screenHeight)),p.sideBarWidth=Math.min(p.sideBarWidth,h),s(t,e),p.mapLeft=p.screenWidth-p.sideBarWidth-p.mapWidth,p.mapTop=Math.round(p.bottomBarHeight/2),p.mapRight=p.mapLeft+p.mapWidth,p.mapBottom=p.mapTop+p.mapHeight,p.windowFullScreenWidth=p.screenWidth,p.windowFullScreenHeight=p.screenHeight,p.screenExceptToolbar={left:0,top:0,width:p.screenWidth-p.sideBarWidth,height:p.screenHeight}}var c=i(167),d=i(171),u=175,h=210,p={physicalScreenWidth:Math.max(window.screen.width,window.screen.height),physicalScreenHeight:Math.min(window.screen.width,window.screen.height)};n(),t.dimensions=p,t.updateScreen=n,t.resizeWideScreen=l,t.resizeNarrowScreen=r},function(e,t,i){var n=i(168);t.MAP_PATH="maps/",t.IMG_PATH="gfx/world/",t.SKIN_PATH="skins/",t.BONE_PATH="bones/",t.ICON_PATH="gfx/icons/",t.ORNAMENT_PATH="gfx/ornaments/",t.EMBEDDED_PATH="ui/embedded/",t.BACKGROUND_PATH="backgrounds/",t.FOREGROUND_PATH="foregrounds/",t.BITMAP_FONTS="ui/bitmapFonts/",t.WORLDMAP_PATH="gfx/maps/",t.LOADER_PATH="ui/loader/",t.MISSING_ANIM_PATH="bones/missingAnimList.json",t.CDV_PATH=".",t.ITEM_DIR="/gfx/items/",t.MAP_SCENE_WIDTH_IN_CELLS=14.5,t.MAP_SCENE_HEIGHT_IN_CELLS=20.5,t.CELL_WIDTH=86,t.CELL_HEIGHT=43,t.CELL_SIDE=Math.sqrt(2*t.CELL_HEIGHT*t.CELL_HEIGHT),t.NB_CELLS=560,t.ELEMENT_TYPE_ID={UNSPECIFIED:-1,ZAAP:16,PADDOCK:120},t.HORIZONTAL_OFFSET=53,t.VERTICAL_OFFSET=15,t.WIDTH_PADDING=20,t.HEIGHT_PADDING=-16,t.MAP_BORDER_H=30,t.MAP_BORDER_V=20,t.GRID_ALTITUDE_OFFSET=22,t.ICONBAR_CORNER_HEIGHT=19,t.ICONBAR_CORNER_WIDTH=36,t.ICONBAR_TAB_WIDTH=42,t.ICONBAR_TAB_HEIGHT=35,t.SHORTCUT_ICON_SIZE=50,t.MENU_ICON_SIZE=42,t.SHORTCUT_GAUGE_SIZE=13,t.CHAT_BTN_MIN_WIDTH=68,t.CHAT_BTN_MIN_HEIGHT=50,t.BONUS_PACK_XP=150,t.BONUS_PACK_DROP=150,t.BONUS_PACK_XPJOB=50,t.PING_EMOTE_BTN_NARROW_MIN_WIDTH=50,t.PING_EMOTE_BTN_WIDE_MIN_HEIGHT=50,t.PING_EMOTE_BTN_WIDE_MIN_WIDTH=40,t.MAP_SCENE_WIDTH=t.CELL_WIDTH*t.MAP_SCENE_WIDTH_IN_CELLS+t.WIDTH_PADDING,t.MAP_SCENE_HEIGHT=t.CELL_HEIGHT*t.MAP_SCENE_HEIGHT_IN_CELLS+t.HEIGHT_PADDING,t.PIXEL_RATIO=window.devicePixelRatio?Math.min(window.devicePixelRatio,2):1,t.CHARACTER_COLORS=5,t.FPS=60,t.TIME_UNITS_PER_SECOND=25,t.ANIM_SYMETRY=[!1,!1,!1,!0,!0,!1,!1,!0],t.ANIM_SYMBOLS=[0,1,2,1,0,5,6,5],t.ANGLE_PER_DIRECTION=[0,Math.PI/8,Math.PI/2,Math.PI-Math.PI/8,Math.PI,Math.PI+Math.PI/8,-Math.PI/2,-Math.PI/8],t.MISSING_TEXTURE_IMAGE_SRC="data:image/gif;base64,R0lGODlhAQABAIAAAOAv/wAAACwAAAAAAQABAAACAkQBADs=",t.EMPTY_IMAGE=new Image,t.EMPTY_IMAGE.src=t.MISSING_TEXTURE_IMAGE_SRC,t.EMPTY_JSON={},t.MAP_LAYER_BACKGROUND=-1,t.MAP_LAYER_PLAYGROUND=0,t.MAP_LAYER_FOREGROUND=1,t.MAP_LAYER_TRANSPARENT=2,t.MAP_LAYER_ICONS=3,t.MAP_LAYER_POINT_LABELS=4,t.MAP_LAYER_TAP_FEEDBACK=5,t.MAP_LAYER_TARGET_INDICATOR=6,t.TRANSPARENT_MODE_ALPHA=.725;var o=153600,s=1024e3,a=120;if(n.isPhoneGap){var r=n.capacity||536870912,l=n.isAndroid?.3:.5,c=r*l*.4;t.MAX_MUSIC_SFX_MEMORY=Math.round(.43*c/o),t.MAX_TEXTURE_MEMORY_MAP=Math.round(.25*c),t.MAX_TEXTURE_MEMORY_WORLDMAP=Math.round(.1*c),t.MAX_TEXTURE_MEMORY_CHARACTER_DISPLAY=Math.round(.05*c),t.MAX_SPRITES_BUFFER_MAP=Math.max(Math.round(.04*c/a),2e4),t.MAX_SPRITES_BUFFER_WORLDMAP=Math.max(Math.round(.005*c/a),1e4),t.MAX_SPRITES_BUFFER_CHARACTER_DISPLAY=Math.max(Math.round(.005*c/a),4e3),t.MAX_ANIMATIONS=Math.round(.12*c/s)}else t.MAX_MUSIC_SFX_MEMORY=1e3,t.MAX_TEXTURE_MEMORY_MAP=104857600,t.MAX_TEXTURE_MEMORY_WORLDMAP=52428800,t.MAX_TEXTURE_MEMORY_CHARACTER_DISPLAY=20971520,t.MAX_SPRITES_BUFFER_MAP=8e4,t.MAX_SPRITES_BUFFER_WORLDMAP=1e4,t.MAX_SPRITES_BUFFER_CHARACTER_DISPLAY=9e3,t.MAX_ANIMATIONS=30;t.MAX_ZOOM_MAP=1.1,t.PRERENDER_RATIO_MAP=t.PIXEL_RATIO,t.PRERENDER_RATIO_WORLDMAP=t.PIXEL_RATIO,t.PRERENDER_RATIO_CHARACTER_DISPLAY=2*t.PIXEL_RATIO,t.TOTAL_MAP_ASSETS_SIZE_IN_GB=2},function(e,t,i){var n=i(169),o=window.navigator.userAgent,s=new n(o),a=s.getOS(),r=void 0!==window.device&&"string"==typeof window.device.model;t.osName=a.name,t.isIOS="iOS"===a.name,t.isAndroid="Android"===a.name,t.isDevice=t.isIOS||t.isAndroid,t.isPhoneGap=t.isCordova=!!(window.cordova||window.PhoneGap||window.phonegap),t.isIpad2=r&&"iPad2,"===window.device.model.substr(0,6),t.os=a.name.toLowerCase(),t.isIOSApp=window.device&&window.device.platform&&"iOS"===window.device.platform,t.isAndroidApp=window.device&&window.device.platform&&"Android"===window.device.platform},function(e,t,i){var n;!function(o,s){"use strict";var a="0.7.9",r="",l="?",c="function",d="undefined",u="object",h="string",p="major",m="model",f="name",g="type",_="vendor",v="version",y="architecture",b="console",M="mobile",w="tablet",T="smarttv",C="wearable",A="embedded",I={extend:function(e,t){for(var i in t)"browser cpu device engine os".indexOf(i)!==-1&&t[i].length%2===0&&(e[i]=t[i].concat(e[i]));return e},has:function(e,t){return"string"==typeof e&&t.toLowerCase().indexOf(e.toLowerCase())!==-1},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===h?e.split(".")[0]:s}},S={rgx:function(){for(var e,t,i,n,o,a,r,l=0,h=arguments;l<h.length&&!a;){var p=h[l],m=h[l+1];if(typeof e===d){e={};for(n in m)o=m[n],typeof o===u?e[o[0]]=s:e[o]=s}for(t=i=0;t<p.length&&!a;)if(a=p[t++].exec(this.getUA()))for(n=0;n<m.length;n++)r=a[++i],o=m[n],typeof o===u&&o.length>0?2==o.length?typeof o[1]==c?e[o[0]]=o[1].call(this,r):e[o[0]]=o[1]:3==o.length?typeof o[1]!==c||o[1].exec&&o[1].test?e[o[0]]=r?r.replace(o[1],o[2]):s:e[o[0]]=r?o[1].call(this,r,o[2]):s:4==o.length&&(e[o[0]]=r?o[3].call(this,r.replace(o[1],o[2])):s):e[o]=r?r:s;l+=2}return e},str:function(e,t){for(var i in t)if(typeof t[i]===u&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(I.has(t[i][n],e))return i===l?s:i}else if(I.has(t[i],e))return i===l?s:i;return e}},E={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},x={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[f,v],[/\s(opr)\/([\w\.]+)/i],[[f,"Opera"],v],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium)\/([\w\.-]+)/i],[f,v],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[f,"IE"],v],[/(edge)\/((\d+)?[\w\.]+)/i],[f,v],[/(yabrowser)\/([\w\.]+)/i],[[f,"Yandex"],v],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],v],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[f,v],[/(dolfin)\/([\w\.]+)/i],[[f,"Dolphin"],v],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[f,"Chrome"],v],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[v,[f,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[v,[f,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[v,[f,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[v,[f,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[v,f],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[f,[v,S.str,E.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[f,v],[/(navigator|netscape)\/([\w\.-]+)/i],[[f,"Netscape"],v],[/fxios\/([\w\.-]+)/i],[v,[f,"Firefox"]],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[f,v]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[y,"amd64"]],[/(ia32(?=;))/i],[[y,I.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[y,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[y,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[y,/ower/,"",I.lowerize]],[/(sun4\w)[;\)]/i],[[y,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[y,I.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[m,_,[g,w]],[/applecoremedia\/[\w\.]+ \((ipad)/],[m,[_,"Apple"],[g,w]],[/(apple\s{0,1}tv)/i],[[m,"Apple TV"],[_,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[_,m,[g,w]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[m,[_,"Amazon"],[g,w]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[m,S.str,E.device.amazon.model],[_,"Amazon"],[g,M]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[m,_,[g,M]],[/\((ip[honed|\s\w*]+);/i],[m,[_,"Apple"],[g,M]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[_,m,[g,M]],[/\(bb10;\s(\w+)/i],[m,[_,"BlackBerry"],[g,M]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],[m,[_,"Asus"],[g,w]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[_,"Sony"],[m,"Xperia Tablet"],[g,w]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[_,"Sony"],[m,"Xperia Phone"],[g,M]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[_,m,[g,b]],[/android.+;\s(shield)\sbuild/i],[m,[_,"Nvidia"],[g,b]],[/(playstation\s[3portablevi]+)/i],[m,[_,"Sony"],[g,b]],[/(sprint\s(\w+))/i],[[_,S.str,E.device.sprint.vendor],[m,S.str,E.device.sprint.model],[g,M]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[_,m,[g,w]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[_,[m,/_/g," "],[g,M]],[/(nexus\s9)/i],[m,[_,"HTC"],[g,w]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[m,[_,"Microsoft"],[g,b]],[/(kin\.[onetw]{3})/i],[[m,/\./g," "],[_,"Microsoft"],[g,M]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i],[m,[_,"Motorola"],[g,M]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[m,[_,"Motorola"],[g,w]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[_,"Samsung"],m,[g,w]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-n900))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[_,"Samsung"],m,[g,M]],[/(samsung);smarttv/i],[_,m,[g,T]],[/\(dtv[\);].+(aquos)/i],[m,[_,"Sharp"],[g,T]],[/sie-(\w+)*/i],[m,[_,"Siemens"],[g,M]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[_,"Nokia"],m,[g,M]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[m,[_,"Acer"],[g,w]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[_,"LG"],m,[g,w]],[/(lg) netcast\.tv/i],[_,m,[g,T]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[m,[_,"LG"],[g,M]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[m,[_,"Lenovo"],[g,w]],[/linux;.+((jolla));/i],[_,m,[g,M]],[/((pebble))app\/[\d\.]+\s/i],[_,m,[g,C]],[/android.+;\s(glass)\s\d/i],[m,[_,"Google"],[g,C]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus)?[\s_]*(?:\d\w)?)\s+build/i],[[m,/_/g," "],[_,"Xiaomi"],[g,M]],[/(mobile|tablet);.+rv\:.+gecko\//i],[[g,I.lowerize],_,m]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[v,[f,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[f,v],[/rv\:([\w\.]+).*(gecko)/i],[v,f]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[f,v],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[f,[v,S.str,E.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[f,"Windows"],[v,S.str,E.os.windows.version]],[/\((bb)(10);/i],[[f,"BlackBerry"],v],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[f,v],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[f,"Symbian"],v],[/\((series40);/i],[f],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[f,"Firefox OS"],v],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[f,v],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[f,"Chromium OS"],v],[/(sunos)\s?([\w\.]+\d)*/i],[[f,"Solaris"],v],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[f,v],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[f,"iOS"],[v,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[f,"Mac OS"],[v,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[f,v]]},N=function(e,t){if(!(this instanceof N))return new N(e,t).getResult();var i=e||(o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:r),n=t?I.extend(x,t):x;return this.getBrowser=function(){var e=S.rgx.apply(this,n.browser);return e.major=I.major(e.version),e},this.getCPU=function(){return S.rgx.apply(this,n.cpu)},this.getDevice=function(){return S.rgx.apply(this,n.device)},this.getEngine=function(){return S.rgx.apply(this,n.engine)},this.getOS=function(){return S.rgx.apply(this,n.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this.setUA(i),this};N.VERSION=a,N.BROWSER={NAME:f,MAJOR:p,VERSION:v},N.CPU={ARCHITECTURE:y},N.DEVICE={MODEL:m,VENDOR:_,TYPE:g,CONSOLE:b,MOBILE:M,SMARTTV:T,TABLET:w,WEARABLE:C,EMBEDDED:A},N.ENGINE={NAME:f,VERSION:v},N.OS={NAME:f,VERSION:v},typeof t!==d?(typeof e!==d&&e.exports&&(t=e.exports=N),t.UAParser=N):"function"===c&&i(170)?(n=function(){return N}.call(t,i,t,e),!(n!==s&&(e.exports=n))):o.UAParser=N;var L=o.jQuery||o.Zepto;if(typeof L!==d){var O=new N;L.ua=O.getResult(),L.ua.get=function(){return O.getUA()},L.ua.set=function(e){O.setUA(e);var t=O.getResult();for(var i in t)L.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,i){function n(){s.call(this),this.optionDefs=null}var o=i(172).inherits,s=i(175).EventEmitter,a=i(176),r=i(177),l="option-";o(n,s),e.exports=new n,n.prototype.initialize=function(e){this.optionDefs={showAllMonsters:{init:!0},maxActorsBeforeCreatureMode:{init:9999,onChange:window.actorManager.onMaxActorsBeforeCreatureModeChange.bind(window.actorManager)},hideDeadFighters:{init:!0},allowSpellEffects:{init:!0},autoGpsFlags:{init:!0},autoGpsPhoenixes:{init:!0,onChange:function(){e.compass.updateMarkersPositions()}},menubarSize:{init:e.ipadRatio?6:3},menubarSizeInFight:{init:e.ipadRatio?3:2},toolbarThicknessInFight:{init:1},censorship:{init:!0},tutorialTips:{init:!0},soundOnPlayerTurnStart:{init:!0},alwaysShowGrid:{init:!1,onChange:window.background.toggleGrid.bind(window.background)},spellTooltipName:{init:!0},spellTooltipApRange:{init:!0},spellTooltipCritical:{init:!1},spellTooltipEffect:{init:!1},spellTooltipDescription:{init:!0},confirmBoxWhenDragCasting:{init:r.ALWAYS},confirmBoxWhenClickCasting:{init:r.ALWAYS},confirmBoxWhenWalking:{init:!0},showSpeechBubbleInFight:{init:!0},orderFighters:{init:!1},showApMpUsed:{init:!1}},this._loadAllOptions()},n.prototype._loadAllOptions=function(){for(var e in this.optionDefs){var t=this.optionDefs[e];this[e]=a.getValue(l+e,t.init)}},n.prototype.changeValue=function(e,t){var i=this[e];this[e]=t,a.setValue(l+e,t);var n=this.optionDefs[e];n.onChange&&n.onChange(t,i),this.emit(e,t,i)}},function(e,t,i){(function(e,n){function o(e,i){var n={seen:[],stylize:a};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(i)?n.showHidden=i:i&&t._extend(n,i),M(n.showHidden)&&(n.showHidden=!1),M(n.depth)&&(n.depth=2),M(n.colors)&&(n.colors=!1),M(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),l(n,e,n.depth)}function s(e,t){var i=o.styles[t];return i?"["+o.colors[i][0]+"m"+e+"["+o.colors[i][1]+"m":e}function a(e,t){return e}function r(e){var t={};return e.forEach(function(e,i){t[e]=!0}),t}function l(e,i,n){if(e.customInspect&&i&&I(i.inspect)&&i.inspect!==t.inspect&&(!i.constructor||i.constructor.prototype!==i)){var o=i.inspect(n,e);return y(o)||(o=l(e,o,n)),o}var s=c(e,i);if(s)return s;var a=Object.keys(i),f=r(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(i)),A(i)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(i);if(0===a.length){if(I(i)){var g=i.name?": "+i.name:"";return e.stylize("[Function"+g+"]","special")}if(w(i))return e.stylize(RegExp.prototype.toString.call(i),"regexp");if(C(i))return e.stylize(Date.prototype.toString.call(i),"date");if(A(i))return d(i)}var _="",v=!1,b=["{","}"];if(m(i)&&(v=!0,b=["[","]"]),I(i)){var M=i.name?": "+i.name:"";_=" [Function"+M+"]"}if(w(i)&&(_=" "+RegExp.prototype.toString.call(i)),C(i)&&(_=" "+Date.prototype.toUTCString.call(i)),A(i)&&(_=" "+d(i)),0===a.length&&(!v||0==i.length))return b[0]+_+b[1];if(n<0)return w(i)?e.stylize(RegExp.prototype.toString.call(i),"regexp"):e.stylize("[Object]","special");e.seen.push(i);var T;return T=v?u(e,i,n,f,a):a.map(function(t){return h(e,i,n,f,t,v)}),e.seen.pop(),p(T,_,b)}function c(e,t){if(M(t))return e.stylize("undefined","undefined");if(y(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}return v(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function u(e,t,i,n,o){for(var s=[],a=0,r=t.length;a<r;++a)L(t,String(a))?s.push(h(e,t,i,n,String(a),!0)):s.push("");return o.forEach(function(o){o.match(/^\d+$/)||s.push(h(e,t,i,n,o,!0))}),s}function h(e,t,i,n,o,s){var a,r,c;if(c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},c.get?r=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(r=e.stylize("[Setter]","special")),L(n,o)||(a="["+o+"]"),r||(e.seen.indexOf(c.value)<0?(r=g(i)?l(e,c.value,null):l(e,c.value,i-1),r.indexOf("\n")>-1&&(r=s?r.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+r.split("\n").map(function(e){return"   "+e}).join("\n"))):r=e.stylize("[Circular]","special")),M(a)){if(s&&o.match(/^\d+$/))return r;a=JSON.stringify(""+o),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+r}function p(e,t,i){var n=0,o=e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1]:i[0]+t+" "+e.join(", ")+" "+i[1]}function m(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function g(e){return null===e}function _(e){return null==e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function b(e){return"symbol"==typeof e}function M(e){return void 0===e}function w(e){return T(e)&&"[object RegExp]"===E(e)}function T(e){return"object"==typeof e&&null!==e}function C(e){return T(e)&&"[object Date]"===E(e)}function A(e){return T(e)&&("[object Error]"===E(e)||e instanceof Error)}function I(e){return"function"==typeof e}function S(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function E(e){return Object.prototype.toString.call(e)}function x(e){return e<10?"0"+e.toString(10):e.toString(10)}function N(){var e=new Date,t=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":");return[e.getDate(),P[e.getMonth()],t].join(" ")}function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var O=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(o(arguments[i]));return t.join(" ")}for(var i=1,n=arguments,s=n.length,a=String(e).replace(O,function(e){if("%%"===e)return"%";if(i>=s)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}default:return e}}),r=n[i];i<s;r=n[++i])a+=g(r)||!T(r)?" "+r:" "+o(r);return a},t.deprecate=function(i,o){function s(){if(!a){if(n.throwDeprecation)throw new Error(o);n.traceDeprecation?console.trace(o):console.error(o),a=!0}return i.apply(this,arguments)}if(M(e.process))return function(){return t.deprecate(i,o).apply(this,arguments)};if(n.noDeprecation===!0)return i;var a=!1;return s};var D,R={};t.debuglog=function(e){if(M(D)&&(D=n.env.NODE_DEBUG||""),e=e.toUpperCase(),!R[e])if(new RegExp("\\b"+e+"\\b","i").test(D)){var i=n.pid;R[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,i,n)}}else R[e]=function(){};return R[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=m,t.isBoolean=f,t.isNull=g,t.isNullOrUndefined=_,t.isNumber=v,t.isString=y,t.isSymbol=b,t.isUndefined=M,t.isRegExp=w,t.isObject=T,t.isDate=C,t.isError=A,t.isFunction=I,t.isPrimitive=S,t.isBuffer=i(173);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",N(),t.format.apply(t,arguments))},t.inherits=i(174),t._extend=function(e,t){if(!t||!T(t))return e;for(var i=Object.keys(t),n=i.length;n--;)e[i[n]]=t[i[n]];return e}}).call(t,function(){
return this}(),i(33))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},function(e,t){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,i,o,r,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}if(i=this._events[e],a(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(s(i))for(r=Array.prototype.slice.call(arguments,1),c=i.slice(),o=c.length,l=0;l<o;l++)c[l].apply(this,r);return!0},i.prototype.addListener=function(e,t){var o;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(o=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function i(){this.removeListener(e,i),o||(o=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var o=!1;return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var i,o,a,r;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],a=i.length,o=-1,i===t||n(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(i)){for(r=a;r-- >0;)if(i[r]===t||i[r].listener&&i[r].listener===t){o=r;break}if(o<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],n(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){function i(){this._hasListeners=!1,this.autosave=null,this.nextSaveTime=0,this.accountName=null,this.prefs={},this._load()}var n="dofus.1",o=180,s="all";i.prototype.close=function(){this.setAccount(null)},i.prototype._setupListeners=function(){if(!this._hasListeners){var e=this;window.gui.on("appGoBackground",function(){null!==e.accountName&&e.autosave&&e._save()}),this._hasListeners=!0}},i.prototype.setAccount=function(e){this.autosave&&this._save(),this.accountName=e,this._setupListeners()},i.prototype._load=function(){try{var e=window.localStorage.getItem(n);e&&(this.prefs=JSON.parse(e))}catch(t){console.warn("Failed to load user preferences: "+t)}},i.prototype._scheduleNextSave=function(e){var t=this;e||(e=o);var i=Date.now()+1e3*e;this.autosave&&this.nextSaveTime<=i||(this.autosave&&window.clearTimeout(this.autosave),this.nextSaveTime=i,this.autosave=window.setTimeout(function(){t.autosave=null,t._save()},1e3*e))},i.prototype._save=function(){try{this.autosave&&(window.clearTimeout(this.autosave),this.autosave=null),window.localStorage.setItem(n,JSON.stringify(this.prefs))}catch(e){console.warn("Failed to save user preferences: "+e)}},i.prototype.saveNow=function(){this._save()},i.prototype.getValue=function(e,t,i){e=(this.accountName&&!i?this.accountName:s)+"#"+e;var n=this.prefs[e];return void 0===n?t:n},i.prototype.setValue=function(e,t,i,n){e=(this.accountName&&!n?this.accountName:s)+"#"+e,this.prefs[e]=t,this._scheduleNextSave(i)},i.prototype.delValue=function(e,t,i){e=(this.accountName&&!i?this.accountName:s)+"#"+e,delete this.prefs[e],this._scheduleNextSave(t)};var a=new i;e.exports=a},function(e,t){e.exports={NEVER:0,ALWAYS:1,EMPTY_ONLY:2}},function(e,t,i){function n(e){a=!1,l=e.accountId,c=e.login,d=e.nickname,o.log("Session_Info.Login",{account_session_id:c},{withResolution:!0,withSubscriptionInfo:!0})}var o=i(9),s=i(179);i(180);var a=!1,r=0,l=0,c=0,d=0,u=window.dofus.connectionManager;window.gui.on("disconnect",function(){o.unregister()}),u.on("NicknameAcceptedMessage",function(){o.log("F_T_U_E.Step0000_Chose_Nickname")}),u.on("ServersListMessage",function(e){for(var t=0,i=e.servers||[],n=0,o=i.length;n<o;n+=1){var s=i[n];t+=s.charactersCount}a=!t}),u.on("IdentificationSuccessMessage",n),u.on("IdentificationSuccessWithLoginTokenMessage",n),u.on("SelectedServerDataMessage",function(e){o.log("Session_Info.Choose_Server",{account_session_id:c}),a&&o.log("F_T_U_E.Step0100_Chose_Server",{server_id:e.serverId})}),u.on("CharacterCreationResultMessage",function(e){a&&e.result===s.OK&&o.log("F_T_U_E.Step0200_Create_First_Character")}),window.gui.playerData.on("characterSelectedSuccess",function(){r=window.gui.playerData.characterBaseInformations.level,window.dofus.send("kpiStartSession",{accountSessionId:window.gui.playerData.identification.accountSessionUid,isSubscriber:window.gui.playerData.isSubscriber()}),o.log("Session_Info.Choose_Character")}),u.on("kpiStartSessionMessage",function(e){o.register(l,e.sessionId,{login:window.gui.playerData.loginName,nickname:d})}),u.on("kpiStartSessionErrorMessage",function(){console.error("kpiStartSessionErrorMessage"),o.register(l,null,{login:window.gui.playerData.loginName,nickname:d})}),u.on("CharacterLevelUpMessage",function(e){o.log("User_Life_Cycle.Level_Up",{old_level:r}),r=e.newLevel}),u.on("AchievementFinishedMessage",function(e){o.log("User_Life_Cycle.Achievement_Achieved",{achievement_id:e.id})}),u.on("AchievementRewardSuccessMessage",function(e){o.log("User_Life_Cycle.Achievement_Get_Reward",{achievement_id:e.achievementId})}),u.on("QuestStartedMessage",function(e){o.log("User_Life_Cycle.Quest_Start",{quest_id:e.questId})}),u.on("QuestValidatedMessage",function(e){o.log("User_Life_Cycle.Quest_End",{quest_id:e.questId})}),u.on("QuestObjectiveValidatedMessage",function(e){var t=window.gui.playerData.quests.all[e.questId]||{},i=t.stepId||0;o.log("User_Life_Cycle.Quest_Step_Objective_Success",{quest_id:e.questId,objective_id:e.objectiveId,step_id:i})}),u.on("QuestStepValidatedMessage",function(e){o.log("User_Life_Cycle.Quest_Step_Success",{quest_id:e.questId,step_id:e.stepId})}),u.on("DungeonEnteredMessage",function(e){o.log("User_Life_Cycle.Donjon_Start",{dungeon_id:e.dungeonId})}),u.on("JobLevelUpMessage",function(e){o.log("User_Life_Cycle.Profession_Level_Up",{job_id:e.jobsDescription.jobId,new_level:e.newLevel})}),u.on("GameRolePlayPlayerLifeStatusMessage",function(e){e.state>0&&o.log("User_Life_Cycle.Death")}),u.on("PartyJoinMessage",function(e){o.log("social.fight_group_join",{group_id:e.partyId})}),u.on("PartyDeletedMessage",function(e){o.log("social.fight_group_quit",{group_id:e.partyId})}),u.on("PartyLeaveMessage",function(e){o.log("social.fight_group_quit",{group_id:e.partyId})}),u.on("PartyKickedByMessage",function(e){o.log("social.fight_group_quit",{group_id:e.partyId})});var h=null;u.on("GuildMembershipMessage",function(e){h=e.guildInfo.guildId}),u.on("GuildJoinedMessage",function(e){h=e.guildInfo.guildId,o.log("social.guild_join",{guild_id:h})}),u.on("GuildLeftMessage",function(){o.log("social.guild_quit",{guild_id:h})})},function(e,t){e.exports={OK:0,ERR_NO_REASON:1,ERR_INVALID_NAME:2,ERR_NAME_ALREADY_EXISTS:3,ERR_TOO_MANY_CHARACTERS:4,ERR_NOT_ALLOWED:5,ERR_NEW_PLAYER_NOT_ALLOWED:6,ERR_RESTRICED_ZONE:7}},function(e,t,i){function n(e){if(!(e.contextualId>=0)){var t=f[e.contextualId]={};t.monster_id=e.creatureGenericId,t.monster_level=e._level,t.monster_grade=e.creatureGrade,t.team_id=e.teamId}}function o(e){if(!(e.id>=0)){var t=f[e.id];t||(t=f[e.id]={});var i=e.data.stats;t.ratio_life_remaining=Math.ceil(100*i.lifePoints/i.maxLifePoints)/100,1===t.ratio_life_remaining&&i.lifePoints!==i.maxLifePoints&&(t.ratio_life_remaining=.99)}}function s(e){for(var t=0;t<e.results.length;t++){var i=e.results[t];if(i.alive&&!(i.id>=0)){var n=f[i.id];if(!n)return;void 0===n.ratio_life_remaining&&(n.ratio_life_remaining=1),p.log("fight_report.fight_end_alive_monster_description",{fight_id:_,team_id:n.team_id,monster_id:n.monster_id,monster_level:n.monster_level,monster_grade:n.monster_grade,ratio_life_remaining:n.ratio_life_remaining},{noSessionId:!0})}}}function a(){for(var e in f){var t=f[e];p.log("Fight_Report.Fight_Monster_Description",{fight_id:_,team_id:t.team_id,monster_id:t.monster_id,monster_level:t.monster_level,monster_grade:t.monster_grade},{noSessionId:!0})}}function r(){var e=window.gui.fightManager,t=e.getAvailableFighters(),i=t[window.gui.playerData.id];i&&p.log("Fight_Report.Fight_Character_Description",{fight_id:_,is_incarnation:window.gui.playerData.isIncarnation(),team_id:i.data.teamId},{withEquipment:!0})}function l(e){if(!g){var t=window.gui.playerData.id,i="GameActionFightSpellCastMessage"===e._messageType||"GameActionFightCloseCombatMessage"===e._messageType;i&&e.sourceId===t&&p.log("Fight_Action.Spell_Cast_By_User",{spell_id:e.spellId,spell_level:e.spellLevel,fight_id:_})}}function c(e){var t=0;for(var i in e)t+=e[i];return t}function d(e,t,i){0!==e&&1!==e||(v[e][t]=i)}function u(e,t){0!==e&&1!==e||(v[e][t]=0)}function h(e){for(var t=null,i=0,n=e.results.length;i<n;i+=1){var o=e.results[i];if(o.alive){t=o.id;break}}return v[0][t]?0:v[1][t]?1:-1}var p=i(9),m=window.dofus.connectionManager,f={},g=!1,_=null,v={0:{},1:{}};m.on("GameFightJoinMessage",function(e){return e.isSpectator?void(g=!0):(f={},g=!1,void(_=null))}),m.on("GameFightTurnReadyRequestMessage",function(){if(!g){var e=window.gui.fightManager.getAvailableFighters();for(var t in e)o(e[t])}}),m.on("messageSequence",function(e){null===_&&(_=window.gui.fightManager.fightId);for(var t=0;t<e.sequence.length;t+=1)l(e.sequence[t])}),m.on("GameActionFightSpellCastMessage",l),m.on("GameActionFightCloseCombatMessage",l),m.on("GameFightShowFighterMessage",function(e){if(!g){var t=e.informations;d(t.teamId,t.contextualId,t.stats.lifePoints),n(t)}}),m.on("GameFightRemoveTeamMemberMessage",function(e){g||u(e.teamId,e.charId)}),m.on("GameFightStartMessage",function(){if(!g){var e=window.gui.fightManager;_=e.fightId,p.log("Fight_Report.Fight_Start",{fight_id:_,fight_type:e.fightType,team_0_hp:c(v[0]),team_1_hp:c(v[1])},{noSessionId:!0}),a(),r()}}),m.on("GameFightEndMessage",function(e){if(!g){s(e);var t=h(e);p.log("Fight_Report.Fight_End",{nb_turns:window.gui.fightManager.getTurnCount()+1,fight_id:_,time_spent_on_action:~~(e.duration/1e3),winner_team_id:t},{noSessionId:!0}),v={0:{},1:{}},f={},g=!1,_=null}})},function(e,t){t.STEP_START={1:"F_T_U_E.Step0400_Start_Tuto_Step_1_Move",2:"F_T_U_E.Step0600_Start_Tuto_Step_2_Speak_To_NPC",3:"F_T_U_E.Step0800_Start_Tuto_Step_3_Equip_Ring",4:"F_T_U_E.Step1000_Start_Tuto_Step_4_Change_Map",5:"F_T_U_E.Step1200_Start_Tuto_Step_5_Start_Fight",6:"F_T_U_E.Step1400_Start_Tuto_Step_6_Chose_Starting_Position",7:"F_T_U_E.Step1600_Start_Tuto_Step_7_Move_In_Fight",8:"F_T_U_E.Step1800_Start_Tuto_Step_8_Use_Spell",9:"F_T_U_E.Step1900_Start_Tuto_Step_9_End_Turn",10:"F_T_U_E.Step2100_Start_Tuto_Step_10_Win_Fight",11:"F_T_U_E.Step2300_Start_Tuto_Step_11_Start_Quest",12:"F_T_U_E.Step2500_Start_Tuto_Step_12_Equip_Items",13:"F_T_U_E.Step2700_Start_Tuto_Step_13_Defeat_Monster",14:"F_T_U_E.Step2900_Start_Tuto_Step_14_End_Fight",15:"F_T_U_E.Step3100_Start_Tuto_Step_15_End_Learning"},t.STEP_END={1:"F_T_U_E.Step0500_Succeed_Tuto_Step_1_Move",2:"F_T_U_E.Step0700_Succeed_Tuto_Step_2_Speak_To_NPC",3:"F_T_U_E.Step0900_Succed_Tuto_Step_3_Equip_Ring",4:"F_T_U_E.Step1100_Succeed_Tuto_Step_4_Change_Map",5:"F_T_U_E.Step1300_Succeed_Tuto_Step_5_Start_Fight",6:"F_T_U_E.Step1500_Succeed_Tuto_Step_6_Chose_Starting_Position",7:"F_T_U_E.Step1700_Succed_Tuto_Step_7_Move_In_Fight",8:"F_T_U_E.Step1890_Succeed_Tuto_Step_8_Use_Spell",9:"F_T_U_E.Step2000_Succeed_Tuto_Step_9_End_Turn",10:"F_T_U_E.Step2200_Succeed_Tuto_Step_10_Win_Fight",11:"F_T_U_E.Step2400_Succeed_Tuto_Step_11_Start_Quest",12:"F_T_U_E.Step2600_Succeed_Tuto_Step_12_Equip_Items",13:"F_T_U_E.Step2800_Succed_Tuto_Step_13_Defeat_Monster",14:"F_T_U_E.Step3000_Succed_Tuto_Step_14_End_Fight",15:"F_T_U_E.Step3200_Succeed_Tuto_Step_15_End_Learning"},t.SUB_STEP={2:{1:"F_T_U_E.Step0630_Clic_Maitre_Pifo",2:"F_T_U_E.Step0660_Answer_Maitre_Pifo"},3:{1:"F_T_U_E.Step0820_Clic_Menu_Bag",2:"F_T_U_E.Step0840_Clic_Menu_Weapons",item2:"F_T_U_E.Step0860_Equip_Ring",item4:"F_T_U_E.Step0860_Equip_Ring",4:"F_T_U_E.Step0880_Close_Menu"},5:{1:"F_T_U_E.Step1230_Clic_Scarecrow",2:"F_T_U_E.Step1260_Clic_Attack"},6:{1:"F_T_U_E.Step1430_Clic_Desired_Position_Square",2:"F_T_U_E.Step1460_Clic_Ready_Button"},7:{1:"F_T_U_E.Step1630_Clic_Desired_Position_Square",2:"F_T_U_E.Step1660_Clic_Validate_Move"},8:{1:"F_T_U_E.Step1820_Clic_Attack_Button",2:"F_T_U_E.Step1850_Select_Target",3:"F_T_U_E.Step1870_Validate_Attack"},9:{1:"F_T_U_E.Step1950_Clic_End_Turn_Button"},10:{1:"F_T_U_E.Step2140_Scarecrow_Figh_End",2:"F_T_U_E.Step2180_Close_Fight_Summary_Window"},11:{1:"F_T_U_E.Step2330_Talk_To_NPC_Maitre_Pifo",2:"F_T_U_E.Step2360_Answer_NPC_Maitre_Pifo"},12:{1:"F_T_U_E.Step2510_Clic_Bag_Menu",2:"F_T_U_E.Step2520_Clic_Weapon_Menu",item7:"F_T_U_E.Step2530_Equip_Cloak",item0:"F_T_U_E.Step2540_Equip_Amulet",item3:"F_T_U_E.Step2550_Equip_Belt",item15:"F_T_U_E.Step2560_Equip_Shield",item1:"F_T_U_E.Step2570_Equip_Sword",item5:"F_T_U_E.Step2580_Equip_Boots",9:"F_T_U_E.Step2590_Quit_Bag_Menu"},13:{1:"F_T_U_E.Step2720_Change_Map",2:"F_T_U_E.Step2750_Clic_Monster_Lupus_Minimus",3:"F_T_U_E.Step2770_Attack_Monster_Lupus_Minimus"},14:{1:"F_T_U_E.Step2910_Lupus_Minimus_Figh_End",2:"F_T_U_E.Step2930_Win_Fight_Monster_Lupus_Minimus",3:"F_T_U_E.Step2960_Close_Fight_Summary_Window"},15:{1:"F_T_U_E.Step3130_Talk_To_NPC_Maitre_Pifo",2:"F_T_U_E.Step3160_Answer_NPC_Maitre_Pifo"}}},function(e,t,i){function n(){S=0}function o(e){return e.code===N||e.code===x&&e.status>499}function s(e,t,i,n){this.url=e,this.cssFormat=t,this.callback=i,this.loadBatchIndex=n}function a(e){return/^\/?ui\//.test(e)}function r(e){return!(a(e)||!window.wizAssets)}function l(e){return T*Math.pow(2,e-1)}function c(e){if(I+=1,!e)return d("emptyPath",e);if(a(e))return window.wizAssets?d(null,e,_.CDV_PATH+"/"+e):d(null,e,window.Config.uiUrl+"/"+e);var t=window.Config.assetsUrl+"/"+e;if(!window.wizAssets)return d(null,e,t);var i=M,n=function(t){return d(null,e,t)},s=function(a){if(i-=1,i>0&&o(a)){var r=M-i,c=l(r);return window.gui.isConnected?v.setTimeout(window.wizAssets.downloadFile,c,t,e,n,s):window.setTimeout(window.wizAssets.downloadFile,c,t,e,n,s)}return d(a,e,null)};return y[e]?(console.warn('initiateAssetLoading: known missing asset "'+e+'" will be skip'),d(null,e,null)):window.wizAssets.downloadFile(t,e,n,s)}function d(e,t,i){e&&console.error("notifyAsLoaded: Could not load asset: "+t+" ("+JSON.stringify(e)+")");for(var n=C[t],o=0;o<n.length;o+=1){var s,a=n[o],r=a.callback,l=a.loadBatchIndex;s=i?a.cssFormat?'url("'+i+'")':i:null,r&&r(s,l)}delete C[t],I-=1,u()}function u(){for(;I<b&&A.length>0;){var e=A.pop();c(e)}}function h(e,t,i,n){var o=new s(e,t,i,n);C[e]?C[e].push(o):(C[e]=[o],I<b?c(e):A.push(e))}function p(e,t,i,n){function o(e,t){if(s[t]=e,r+=1,i&&i(e,t),r===a)return n&&n(s)}var s=[],a=e.length;if(0===a)return n&&n(s);for(var r=0,l=0;l<e.length;l+=1)h(e[l],t,o,l)}function m(e,t,i,o,s){0===S&&E(n,0),S<w?(S+=1,e(t,i,o,s)):E(function(){m(e,t,i,o,s)},0)}function f(e,t,i,n){if(!t)return i(_.EMPTY_IMAGE,n);var o=window.Config.imgCrossOrigin,s=new Image;o&&(s.crossOrigin=o);var a=M;s.onload=function(){return this.onload=null,this.onerror=null,i(this,n)},s.onerror=function(){return a-=1,a>0?void(this.src=t):(this.onload=null,this.onerror=null,r(e)&&(console.error("loadAndCreateImage: Image not found: "+t),window.wizAssets.deleteFile(e,function(){},function(e){console.error("loadAndCreateImage: Image could not be deleted: "+t+" with error: "+e)})),i(_.EMPTY_IMAGE,n))},s.src=t}function g(e,t,i,n){if(!t)return i(_.EMPTY_JSON,n);var o=M,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===~~s.readyState){if(200!==~~s.status&&0!==~~s.status)return o-=1,o>0?(s.open("GET",t,!0),void s.send()):(a(e)||console.error("loadAndParseJson: Failed to load json "+t+": "+s.status),i(_.EMPTY_JSON,n));var l;try{l=JSON.parse(s.response)}catch(c){return r(e)&&(console.error("loadAndParseJson: Could not parse json "+t+": "+c),window.wizAssets.deleteFile(e,function(){},function(e){console.error("loadAndParseJson: json could not be deleted: "+t+" with error: "+e)})),i(_.EMPTY_JSON,n)}return i(l,n)}},s.open("GET",t,!0),s.send()}var _=i(167),v=i(183),y=i(185),b=30,M=5,w=5,T=1e3,C={},A=[],I=0,S=0,E=window.setTimeout,x=window.WizAssetsError&&window.WizAssetsError.HTTP_REQUEST_ERROR,N=window.WizAssetsError&&window.WizAssetsError.CONNECTIVITY_ERROR;t.preloadAsset=h,t.preloadAssets=p,t.preloadImages=function(e,t){return p(e,!0,null,t)},t.preloadImage=function(e,t){return h(e,!0,t)},t.preloadImageUrls=function(e,t){return p(e,!1,null,t)},t.preloadImageUrl=function(e,t){return h(e,!1,t)},t.loadImages=function(e,t,i){function n(e,n){if(o[n]=e,s+=1,t&&t(e,n),s===a)return i&&i(o)}var o=[],s=0,a=e.length;return 0===a?i&&i(o):void p(e,!1,function(t,i){m(f,e[i],t,n,i)},null)},t.loadImage=function(e,t){h(e,!1,function(i){m(f,e,i,t)})},t.loadJsons=function(e,t,i){p(e,!1,function(i,n){m(g,e[n],i,t,n)},i)},t.loadJson=function(e,t){h(e,!1,function(i){m(g,e,i,t)})}},function(e,t,i){function n(e,t,i){return function(){delete f[e],t.apply(this,i)}}function o(e,t,i,o){var s=m++;e===u.TYPES.TIMEOUT&&(t=n(s,t,o));var a=f[s]=new u(e,t,i,o);return p&&a.start(),s}function s(e){var t=f[e];t&&(t.clear(),delete f[e])}function a(){for(var e in f)f[e].clear();f={}}function r(){for(var e in f)f[e].start()}function l(){h=!1;for(var e in f)f[e]["continue"]()}function c(){for(var e in f)f[e].suspend();h=!0}function d(){a(),h=!1}var u=i(184),h=!1,p=!1,m=0,f={};t.initialize=function(e){e.on("connected",function(){p=!0,r()}),e.on("disconnect",function(){p=!1,d()}),e.on("appGoBackground",function(){c()}),e.on("connectedAfterAppLeaveBackground",function(){h&&l()})};var g=2;t.setTimeout=function(e,t){var i=[];if(arguments.length>g)for(var n=0;n<arguments.length-g;n++)i[n]=arguments[n+g];return o(u.TYPES.TIMEOUT,e,t,i)},t.setInterval=function(e,t){var i=[];if(arguments.length>g)for(var n=0;n<arguments.length-g;n++)i[n]=arguments[n+g];return o(u.TYPES.INTERVAL,e,t,i)},t.clearTimeout=t.clearInterval=function(e){return s(e),null}},function(e,t){function i(e,t,i,n){this._type=e,this._delay=i,this._action=t,this._arguments=n,this._startedAtTime=null,this._timeout=null,this._interval=null}function n(e){return function(){e._action.apply(this,e._arguments)}}function o(e){return function(){e._startedAtTime=Date.now(),e._action.apply(this,e._arguments)}}function s(e){return function(){e._timeout=null,e._interval=window.setInterval(o(e),e._delay),e._startedAtTime=Date.now(),e._action.apply(this,e._arguments)}}e.exports=i;var a={TIMEOUT:1,INTERVAL:2};i.TYPES=a,i.prototype.start=function(){this._startedAtTime||(this._startedAtTime=Date.now(),this._type===a.TIMEOUT?this._timeout=window.setTimeout(n(this),this._delay):this._type===a.INTERVAL&&(this._interval=window.setInterval(o(this),this._delay)))},i.prototype.suspend=function(){this._startedAtTime&&(this._type===a.TIMEOUT?this._timeout=window.clearTimeout(this._timeout):this._type===a.INTERVAL&&(this._timeout=window.clearTimeout(this._timeout),this._interval=window.clearInterval(this._interval)))},i.prototype["continue"]=function(){if(this._startedAtTime&&!this._timeout&&!this._interval){var e=Date.now()-this._startedAtTime,t=Math.max(0,this._delay-e);this._type===a.TIMEOUT?this._timeout=window.setTimeout(n(this),t):this._type===a.INTERVAL&&(this._timeout=window.setTimeout(s(this),t))}},i.prototype.clear=function(){this.suspend(),this._startedAtTime=null}},function(e,t){e.exports={"bones/1/AnimAttaque0_1.json":!0,"bones/1/AnimAttaque0_1.png":!0,"bones/1/AnimAttaque0_5.json":!0,"bones/1/AnimAttaque0_5.png":!0,"bones/1/AnimAttaque101_2.json":!0,"bones/1/AnimAttaque101_2.png":!0,"bones/1/AnimAttaque101_6.json":!0,"bones/1/AnimAttaque101_6.png":!0,"bones/1/AnimAttaque1102_0.json":!0,"bones/1/AnimAttaque1102_0.png":!0,"bones/1/AnimAttaque1102_2.json":!0,"bones/1/AnimAttaque1102_2.png":!0,"bones/1/AnimAttaque1102_6.json":!0,"bones/1/AnimAttaque1102_6.png":!0,"bones/1/AnimAttaque14051_6.json":!0,"bones/1/AnimAttaque14051_6.png":!0,"bones/1/AnimAttaque140_0.json":!0,"bones/1/AnimAttaque140_0.png":!0,"bones/1/AnimAttaque140_6.json":!0,"bones/1/AnimAttaque140_6.png":!0,"bones/1/AnimAttaque15751_1.json":!0,"bones/1/AnimAttaque15751_1.png":!0,"bones/1/AnimAttaque15751_5.json":!0,"bones/1/AnimAttaque15751_5.png":!0,"bones/1/AnimAttaque15752_5.json":!0,"bones/1/AnimAttaque15752_5.png":!0,"bones/1/AnimAttaque15755_1.json":!0,"bones/1/AnimAttaque15755_1.png":!0,"bones/1/AnimAttaque15755_5.json":!0,"bones/1/AnimAttaque15755_5.png":!0,"bones/1/AnimAttaque15761_5.json":!0,"bones/1/AnimAttaque15761_5.png":!0,"bones/1/AnimAttaque15762_1.json":!0,"bones/1/AnimAttaque15762_1.png":!0,"bones/1/AnimAttaque15762_5.json":!0,"bones/1/AnimAttaque15762_5.png":!0,"bones/1/AnimAttaque1_6.json":!0,"bones/1/AnimAttaque1_6.png":!0,"bones/1/AnimAttaque301_0.json":!0,"bones/1/AnimAttaque301_0.png":!0,"bones/1/AnimAttaque301_2.json":!0,"bones/1/AnimAttaque301_2.png":!0,"bones/1/AnimAttaque4_6.json":!0,"bones/1/AnimAttaque4_6.png":!0,"bones/1/AnimAttaque5_2.json":!0,"bones/1/AnimAttaque5_2.png":!0,"bones/1/AnimAttaque5_6.json":!0,"bones/1/AnimAttaque5_6.png":!0,"bones/1/AnimAttaque6_2.json":!0,"bones/1/AnimAttaque6_2.png":!0,"bones/1/AnimAttaque6_6.json":!0,"bones/1/AnimAttaque6_6.png":!0,"bones/1/AnimAttaque801_2.json":!0,"bones/1/AnimAttaque801_2.png":!0,"bones/1/AnimAttaque801_6.json":!0,"bones/1/AnimAttaque801_6.png":!0,"bones/1/AnimAttaque8_2.json":!0,"bones/1/AnimAttaque8_2.png":!0,"bones/1/AnimAttaque8_6.json":!0,"bones/1/AnimAttaque8_6.png":!0,"bones/1/AnimAttaque901_0.json":!0,"bones/1/AnimAttaque901_0.png":!0,"bones/1/AnimAttaque901_2.json":!0,"bones/1/AnimAttaque901_2.png":!0,"bones/1/AnimAttaque901_6.json":!0,"bones/1/AnimAttaque901_6.png":!0,"bones/1/AnimAttaque9_0.json":!0,"bones/1/AnimAttaque9_0.png":!0,"bones/1/AnimAttaque9_2.json":!0,"bones/1/AnimAttaque9_2.png":!0,"bones/1/AnimAttaque9_6.json":!0,"bones/1/AnimAttaque9_6.png":!0,"bones/1/AnimHit_0.json":!0,"bones/1/AnimHit_0.png":!0,"bones/1/AnimHit_2.json":!0,"bones/1/AnimHit_2.png":!0,"bones/1/AnimHit_6.json":!0,"bones/1/AnimHit_6.png":!0,"bones/1/AnimMort_0.json":!0,"bones/1/AnimMort_0.png":!0,"bones/1/AnimMort_2.json":!0,"bones/1/AnimMort_2.png":!0,"bones/1/AnimMort_6.json":!0,"bones/1/AnimMort_6.png":!0,"bones/1/AnimTacle_0.json":!0,"bones/1/AnimTacle_0.png":!0,"bones/1/AnimTacle_2.json":!0,"bones/1/AnimTacle_2.png":!0,"bones/1/AnimTacle_6.json":!0,"bones/1/AnimTacle_6.png":!0,"bones/1039/AnimTacle_1.json":!0,"bones/1039/AnimTacle_1.png":!0,"bones/1057/AnimTacle_1.json":!0,"bones/1057/AnimTacle_1.png":!0,"bones/1068/AnimHit_1.json":!0,"bones/1068/AnimHit_1.png":!0,"bones/1068/AnimHit_5.json":!0,"bones/1068/AnimHit_5.png":!0,"bones/1084/AnimEmoteEat_0_1.json":!0,"bones/1084/AnimEmoteEat_0_1.png":!0,"bones/1084/AnimHit_1.json":!0,"bones/1084/AnimHit_1.png":!0,"bones/1084/AnimHit_5.json":!0,"bones/1084/AnimHit_5.png":!0,"bones/1084/AnimMort_1.json":!0,"bones/1084/AnimMort_1.png":!0,"bones/1084/AnimPioche_5.json":!0,"bones/1084/AnimPioche_5.png":!0,"bones/1160/AnimTacle_1.json":!0,"bones/1160/AnimTacle_1.png":!0,"bones/1162/AnimTacle_5.json":!0,"bones/1162/AnimTacle_5.png":!0,"bones/1163/AnimTacle_1.json":!0,"bones/1163/AnimTacle_1.png":!0,"bones/1163/AnimTacle_5.json":!0,"bones/1163/AnimTacle_5.png":!0,"bones/1164/AnimTacle_1.json":!0,"bones/1164/AnimTacle_1.png":!0,"bones/1179/AnimTacle_5.json":!0,"bones/1179/AnimTacle_5.png":!0,"bones/1202/AnimPioche_1.json":!0,"bones/1202/AnimPioche_1.png":!0,"bones/1202/AnimPioche_5.json":!0,"bones/1202/AnimPioche_5.png":!0,"bones/1219/AnimTacle_1.json":!0,"bones/1219/AnimTacle_1.png":!0,"bones/1219/AnimTacle_5.json":!0,"bones/1219/AnimTacle_5.png":!0,"bones/1221/AnimTacle_1.json":!0,"bones/1221/AnimTacle_1.png":!0,"bones/1221/AnimTacle_5.json":!0,"bones/1221/AnimTacle_5.png":!0,"bones/1222/AnimTacle_1.json":!0,"bones/1222/AnimTacle_1.png":!0,"bones/1239/AnimTacle_1.json":!0,"bones/1239/AnimTacle_1.png":!0,"bones/1239/AnimTacle_5.json":!0,"bones/1239/AnimTacle_5.png":!0,"bones/1240/AnimTacle_1.json":!0,"bones/1240/AnimTacle_1.png":!0,"bones/1240/AnimTacle_5.json":!0,"bones/1240/AnimTacle_5.png":!0,"bones/1291/AnimTacle_1.json":!0,"bones/1291/AnimTacle_1.png":!0,"bones/1291/AnimTacle_5.json":!0,"bones/1291/AnimTacle_5.png":!0,"bones/1299/AnimTacle_1.json":!0,"bones/1299/AnimTacle_1.png":!0,"bones/1299/AnimTacle_5.json":!0,"bones/1299/AnimTacle_5.png":!0,"bones/14/AnimHitCarrying_1.json":!0,"bones/14/AnimHitCarrying_1.png":!0,"bones/14/AnimHitCarrying_5.json":!0,"bones/14/AnimHitCarrying_5.png":!0,"bones/14/AnimTacle_1.json":!0,"bones/14/AnimTacle_1.png":!0,"bones/14/AnimTacle_5.json":!0,"bones/14/AnimTacle_5.png":!0,"bones/14/carrying.json":!0,"bones/14/carrying.png":!0,"bones/1422/AnimAttaque1203_1.json":!0,"bones/1422/AnimAttaque1203_1.png":!0,"bones/1422/AnimAttaque1203_5.json":!0,"bones/1422/AnimAttaque1203_5.png":!0,"bones/1537/AnimVanish_1.json":!0,"bones/1537/AnimVanish_1.png":!0,"bones/1537/AnimVanish_5.json":!0,"bones/1537/AnimVanish_5.png":!0,"bones/1540/AnimTacle_1.json":!0,"bones/1540/AnimTacle_1.png":!0,"bones/1540/AnimTacle_5.json":!0,"bones/1540/AnimTacle_5.png":!0,"bones/1575/AnimPioche_5.json":!0,"bones/1575/AnimPioche_5.png":!0,"bones/1576/AnimAttaque14372_5.json":!0,"bones/1576/AnimAttaque14372_5.png":!0,"bones/1601/AnimTacle_1.json":!0,"bones/1601/AnimTacle_1.png":!0,"bones/1601/AnimTacle_5.json":!0,"bones/1601/AnimTacle_5.png":!0,"bones/1632/AnimTacle_1.json":!0,"bones/1632/AnimTacle_1.png":!0,"bones/1633/AnimEmoteEat_0_5.json":!0,"bones/1633/AnimEmoteEat_0_5.png":!0,"bones/1747/AnimVanish_1.json":!0,"bones/1747/AnimVanish_1.png":!0,"bones/1747/AnimVanish_5.json":!0,"bones/1747/AnimVanish_5.png":!0,"bones/1749/AnimThrow_1.json":!0,"bones/1749/AnimThrow_1.png":!0,"bones/1749/AnimThrow_5.json":!0,"bones/1749/AnimThrow_5.png":!0,"bones/1749/carrying.json":!0,"bones/1749/carrying.png":!0,"bones/177/AnimTacle_1.json":!0,"bones/177/AnimTacle_1.png":!0,"bones/18/AnimCueillirSol1_1.json":!0,"bones/18/AnimCueillirSol1_1.png":!0,"bones/18/AnimCueillirSol1_5.json":!0,"bones/18/AnimCueillirSol1_5.png":!0,"bones/1846/AnimVanish_1.json":!0,"bones/1846/AnimVanish_1.png":!0,"bones/1846/AnimVanish_5.json":!0,"bones/1846/AnimVanish_5.png":!0,"bones/1847/AnimTacle_1.json":!0,"bones/1847/AnimTacle_1.png":!0,"bones/1847/AnimTacle_5.json":!0,"bones/1847/AnimTacle_5.png":!0,"bones/1848/AnimTacle_1.json":!0,"bones/1848/AnimTacle_1.png":!0,"bones/1848/AnimTacle_5.json":!0,"bones/1848/AnimTacle_5.png":!0,"bones/186/AnimTacle_1.json":!0,"bones/186/AnimTacle_1.png":!0,"bones/186/AnimTacle_5.json":!0,"bones/186/AnimTacle_5.png":!0,"bones/1884/AnimTacle_1.json":!0,"bones/1884/AnimTacle_1.png":!0,"bones/1884/AnimTacle_5.json":!0,"bones/1884/AnimTacle_5.png":!0,"bones/1886/AnimCueillirSol1_1.json":!0,"bones/1886/AnimCueillirSol1_1.png":!0,"bones/1910/AnimTacle_1.json":!0,"bones/1910/AnimTacle_1.png":!0,"bones/1910/AnimTacle_5.json":!0,"bones/1910/AnimTacle_5.png":!0,"bones/195/AnimEmoteAlliance_0_5.json":!0,"bones/195/AnimEmoteAlliance_0_5.png":!0,"bones/195/AnimEmoteGuild_0_5.json":!0,"bones/195/AnimEmoteGuild_0_5.png":!0,"bones/195/AnimFaucher_1.json":!0,"bones/195/AnimFaucher_1.png":!0,"bones/195/AnimFaucher_5.json":!0,"bones/195/AnimFaucher_5.png":!0,"bones/1957/FX.json":!0,"bones/1957/FX.png":!0,"bones/1990/AnimEmoteAlliance_0_1.json":!0,"bones/1990/AnimEmoteAlliance_0_1.png":!0,"bones/1990/AnimEmoteDrink_0_1.json":!0,"bones/1990/AnimEmoteDrink_0_1.png":!0,"bones/1990/AnimEmoteEat_0_1.json":!0,"bones/1990/AnimEmoteEat_0_1.png":!0,"bones/1990/AnimEmoteEat_0_5.json":!0,"bones/1990/AnimEmoteEat_0_5.png":!0,"bones/1990/AnimPioche_5.json":!0,"bones/1990/AnimPioche_5.png":!0,"bones/1990/AnimTacle_1.json":!0,"bones/1990/AnimTacle_1.png":!0,"bones/2/AnimArme83_5.json":!0,"bones/2/AnimArme83_5.png":!0,"bones/2/AnimAttaque0_0.json":!0,"bones/2/AnimAttaque0_0.png":!0,"bones/2/AnimAttaque0_2.json":!0,"bones/2/AnimAttaque0_2.png":!0,"bones/2/AnimAttaque0_6.json":!0,"bones/2/AnimAttaque0_6.png":!0,"bones/2/AnimEmoteCard_0_1.json":!0,"bones/2/AnimEmoteCard_0_1.png":!0,"bones/2/AnimEmoteSeiza_0_1.json":!0,"bones/2/AnimEmoteSeiza_0_1.png":!0,"bones/2/AnimEmoteSeiza_0_5.json":!0,"bones/2/AnimEmoteSeiza_0_5.png":!0,"bones/2/AnimHitCarrying_1.json":!0,"bones/2/AnimHitCarrying_1.png":!0,"bones/2/AnimHitCarrying_5.json":!0,"bones/2/AnimHitCarrying_5.png":!0,"bones/2/AnimHit_0.json":!0,"bones/2/AnimHit_0.png":!0,"bones/2/AnimHit_2.json":!0,"bones/2/AnimHit_2.png":!0,"bones/2/AnimHit_6.json":!0,"bones/2/AnimHit_6.png":!0,"bones/2/AnimMort_0.json":!0,"bones/2/AnimMort_0.png":!0,"bones/2013/AnimEmoteDrink_0_1.json":!0,"bones/2013/AnimEmoteDrink_0_1.png":!0,"bones/2013/AnimEmoteDrink_0_5.json":!0,"bones/2013/AnimEmoteDrink_0_5.png":!0,"bones/2013/AnimEmoteEat_0_1.json":!0,"bones/2013/AnimEmoteEat_0_1.png":!0,"bones/2013/AnimEmoteEat_0_5.json":!0,"bones/2013/AnimEmoteEat_0_5.png":!0,"bones/2013/AnimEmoteGuild_0_1.json":!0,"bones/2013/AnimEmoteGuild_0_1.png":!0,"bones/2013/AnimHache_5.json":!0,"bones/2013/AnimHache_5.png":!0,"bones/2013/AnimTacle_1.json":!0,"bones/2013/AnimTacle_1.png":!0,"bones/2013/AnimTacle_5.json":!0,"bones/2013/AnimTacle_5.png":!0,"bones/2287/AnimTacle_1.json":!0,"bones/2287/AnimTacle_1.png":!0,"bones/2287/AnimTacle_5.json":!0,"bones/2287/AnimTacle_5.png":!0,"bones/2288/AnimTacle_1.json":!0,"bones/2288/AnimTacle_1.png":!0,"bones/2291/AnimTacle_5.json":!0,"bones/2291/AnimTacle_5.png":!0,"bones/2292/AnimTacle_1.json":!0,"bones/2292/AnimTacle_1.png":!0,"bones/23/AnimEmoteDrink_0_1.json":!0,"bones/23/AnimEmoteDrink_0_1.png":!0,"bones/23/AnimEmoteDrink_0_5.json":!0,"bones/23/AnimEmoteDrink_0_5.png":!0,"bones/230/AnimTacle_1.json":!0,"bones/230/AnimTacle_1.png":!0,"bones/230/AnimTacle_5.json":!0,
"bones/230/AnimTacle_5.png":!0,"bones/2302/AnimTacle_1.json":!0,"bones/2302/AnimTacle_1.png":!0,"bones/2302/AnimTacle_5.json":!0,"bones/2302/AnimTacle_5.png":!0,"bones/2350/FX.json":!0,"bones/2350/FX.png":!0,"bones/238/AnimTacle_1.json":!0,"bones/238/AnimTacle_1.png":!0,"bones/239/AnimTacle_1.json":!0,"bones/239/AnimTacle_1.png":!0,"bones/239/AnimTacle_5.json":!0,"bones/239/AnimTacle_5.png":!0,"bones/240/AnimTacle_5.json":!0,"bones/240/AnimTacle_5.png":!0,"bones/241/AnimTacle_5.json":!0,"bones/241/AnimTacle_5.png":!0,"bones/255/AnimEmoteRest_0_1.json":!0,"bones/255/AnimEmoteRest_0_1.png":!0,"bones/255/AnimEmoteSit_0_1.json":!0,"bones/255/AnimEmoteSit_0_1.png":!0,"bones/267/AnimCueillir0_1.json":!0,"bones/267/AnimCueillir0_1.png":!0,"bones/267/AnimCueillir0_5.json":!0,"bones/267/AnimCueillir0_5.png":!0,"bones/267/AnimEmoteDrink_0_1.json":!0,"bones/267/AnimEmoteDrink_0_1.png":!0,"bones/281/AnimTacle_1.json":!0,"bones/281/AnimTacle_1.png":!0,"bones/281/AnimTacle_5.json":!0,"bones/281/AnimTacle_5.png":!0,"bones/282/AnimTacle_1.json":!0,"bones/282/AnimTacle_1.png":!0,"bones/282/AnimTacle_5.json":!0,"bones/282/AnimTacle_5.png":!0,"bones/284/AnimTacle_1.json":!0,"bones/284/AnimTacle_1.png":!0,"bones/284/AnimTacle_5.json":!0,"bones/284/AnimTacle_5.png":!0,"bones/285/AnimTacle_1.json":!0,"bones/285/AnimTacle_1.png":!0,"bones/285/AnimTacle_5.json":!0,"bones/285/AnimTacle_5.png":!0,"bones/286/AnimTacle_1.json":!0,"bones/286/AnimTacle_1.png":!0,"bones/286/AnimTacle_5.json":!0,"bones/286/AnimTacle_5.png":!0,"bones/287/AnimTacle_1.json":!0,"bones/287/AnimTacle_1.png":!0,"bones/287/AnimTacle_5.json":!0,"bones/287/AnimTacle_5.png":!0,"bones/288/AnimTacle_5.json":!0,"bones/288/AnimTacle_5.png":!0,"bones/289/AnimTacle_1.json":!0,"bones/289/AnimTacle_1.png":!0,"bones/289/AnimTacle_5.json":!0,"bones/289/AnimTacle_5.png":!0,"bones/291/AnimTacle_1.json":!0,"bones/291/AnimTacle_1.png":!0,"bones/291/AnimTacle_5.json":!0,"bones/291/AnimTacle_5.png":!0,"bones/292/AnimTacle_1.json":!0,"bones/292/AnimTacle_1.png":!0,"bones/292/AnimTacle_5.json":!0,"bones/292/AnimTacle_5.png":!0,"bones/301/AnimTacle_1.json":!0,"bones/301/AnimTacle_1.png":!0,"bones/306/AnimTacle_1.json":!0,"bones/306/AnimTacle_1.png":!0,"bones/306/AnimTacle_5.json":!0,"bones/306/AnimTacle_5.png":!0,"bones/308/AnimTacle_1.json":!0,"bones/308/AnimTacle_1.png":!0,"bones/308/AnimTacle_5.json":!0,"bones/308/AnimTacle_5.png":!0,"bones/309/AnimTacle_1.json":!0,"bones/309/AnimTacle_1.png":!0,"bones/309/AnimTacle_5.json":!0,"bones/309/AnimTacle_5.png":!0,"bones/310/AnimTacle_1.json":!0,"bones/310/AnimTacle_1.png":!0,"bones/310/AnimTacle_5.json":!0,"bones/310/AnimTacle_5.png":!0,"bones/311/AnimTacle_1.json":!0,"bones/311/AnimTacle_1.png":!0,"bones/312/AnimTacle_5.json":!0,"bones/312/AnimTacle_5.png":!0,"bones/313/AnimTacle_1.json":!0,"bones/313/AnimTacle_1.png":!0,"bones/313/AnimTacle_5.json":!0,"bones/313/AnimTacle_5.png":!0,"bones/314/AnimTacle_1.json":!0,"bones/314/AnimTacle_1.png":!0,"bones/314/AnimTacle_5.json":!0,"bones/314/AnimTacle_5.png":!0,"bones/315/AnimTacle_1.json":!0,"bones/315/AnimTacle_1.png":!0,"bones/315/AnimTacle_5.json":!0,"bones/315/AnimTacle_5.png":!0,"bones/316/AnimTacle_1.json":!0,"bones/316/AnimTacle_1.png":!0,"bones/317/AnimTacle_1.json":!0,"bones/317/AnimTacle_1.png":!0,"bones/317/AnimTacle_5.json":!0,"bones/317/AnimTacle_5.png":!0,"bones/318/AnimTacle_5.json":!0,"bones/318/AnimTacle_5.png":!0,"bones/319/AnimTacle_1.json":!0,"bones/319/AnimTacle_1.png":!0,"bones/319/AnimTacle_5.json":!0,"bones/319/AnimTacle_5.png":!0,"bones/322/AnimTacle_1.json":!0,"bones/322/AnimTacle_1.png":!0,"bones/322/AnimTacle_5.json":!0,"bones/322/AnimTacle_5.png":!0,"bones/323/AnimAttaque2_1.json":!0,"bones/323/AnimAttaque2_1.png":!0,"bones/323/AnimAttaque2_5.json":!0,"bones/323/AnimAttaque2_5.png":!0,"bones/325/AnimTacle_1.json":!0,"bones/325/AnimTacle_1.png":!0,"bones/325/AnimTacle_5.json":!0,"bones/325/AnimTacle_5.png":!0,"bones/326/AnimTacle_1.json":!0,"bones/326/AnimTacle_1.png":!0,"bones/326/AnimTacle_5.json":!0,"bones/326/AnimTacle_5.png":!0,"bones/327/AnimTacle_1.json":!0,"bones/327/AnimTacle_1.png":!0,"bones/327/AnimTacle_5.json":!0,"bones/327/AnimTacle_5.png":!0,"bones/328/AnimTacle_1.json":!0,"bones/328/AnimTacle_1.png":!0,"bones/328/AnimTacle_5.json":!0,"bones/328/AnimTacle_5.png":!0,"bones/329/AnimTacle_1.json":!0,"bones/329/AnimTacle_1.png":!0,"bones/329/AnimTacle_5.json":!0,"bones/329/AnimTacle_5.png":!0,"bones/331/AnimTacle_1.json":!0,"bones/331/AnimTacle_1.png":!0,"bones/331/AnimTacle_5.json":!0,"bones/331/AnimTacle_5.png":!0,"bones/332/AnimTacle_1.json":!0,"bones/332/AnimTacle_1.png":!0,"bones/332/AnimTacle_5.json":!0,"bones/332/AnimTacle_5.png":!0,"bones/334/AnimTacle_1.json":!0,"bones/334/AnimTacle_1.png":!0,"bones/334/AnimTacle_5.json":!0,"bones/334/AnimTacle_5.png":!0,"bones/337/AnimTacle_5.json":!0,"bones/337/AnimTacle_5.png":!0,"bones/342/AnimAttaque1203_1.json":!0,"bones/342/AnimAttaque1203_1.png":!0,"bones/342/AnimAttaque1203_5.json":!0,"bones/342/AnimAttaque1203_5.png":!0,"bones/342/AnimTacle_1.json":!0,"bones/342/AnimTacle_1.png":!0,"bones/342/AnimTacle_5.json":!0,"bones/342/AnimTacle_5.png":!0,"bones/343/AnimTacle_1.json":!0,"bones/343/AnimTacle_1.png":!0,"bones/343/AnimTacle_5.json":!0,"bones/343/AnimTacle_5.png":!0,"bones/346/AnimTacle_1.json":!0,"bones/346/AnimTacle_1.png":!0,"bones/346/AnimTacle_5.json":!0,"bones/346/AnimTacle_5.png":!0,"bones/347/AnimTacle_1.json":!0,"bones/347/AnimTacle_1.png":!0,"bones/347/AnimTacle_5.json":!0,"bones/347/AnimTacle_5.png":!0,"bones/348/AnimTacle_1.json":!0,"bones/348/AnimTacle_1.png":!0,"bones/348/AnimTacle_5.json":!0,"bones/348/AnimTacle_5.png":!0,"bones/349/AnimTacle_1.json":!0,"bones/349/AnimTacle_1.png":!0,"bones/349/AnimTacle_5.json":!0,"bones/349/AnimTacle_5.png":!0,"bones/350/AnimTacle_1.json":!0,"bones/350/AnimTacle_1.png":!0,"bones/350/AnimTacle_5.json":!0,"bones/350/AnimTacle_5.png":!0,"bones/351/AnimTacle_1.json":!0,"bones/351/AnimTacle_1.png":!0,"bones/351/AnimTacle_5.json":!0,"bones/351/AnimTacle_5.png":!0,"bones/352/AnimTacle_5.json":!0,"bones/352/AnimTacle_5.png":!0,"bones/353/AnimTacle_1.json":!0,"bones/353/AnimTacle_1.png":!0,"bones/353/AnimTacle_5.json":!0,"bones/353/AnimTacle_5.png":!0,"bones/354/AnimTacle_1.json":!0,"bones/354/AnimTacle_1.png":!0,"bones/354/AnimTacle_5.json":!0,"bones/354/AnimTacle_5.png":!0,"bones/355/AnimTacle_1.json":!0,"bones/355/AnimTacle_1.png":!0,"bones/355/AnimTacle_5.json":!0,"bones/355/AnimTacle_5.png":!0,"bones/356/AnimTacle_1.json":!0,"bones/356/AnimTacle_1.png":!0,"bones/356/AnimTacle_5.json":!0,"bones/356/AnimTacle_5.png":!0,"bones/357/AnimTacle_1.json":!0,"bones/357/AnimTacle_1.png":!0,"bones/357/AnimTacle_5.json":!0,"bones/357/AnimTacle_5.png":!0,"bones/363/AnimTacle_5.json":!0,"bones/363/AnimTacle_5.png":!0,"bones/364/AnimTacle_1.json":!0,"bones/364/AnimTacle_1.png":!0,"bones/364/AnimTacle_5.json":!0,"bones/364/AnimTacle_5.png":!0,"bones/372/AnimTacle_1.json":!0,"bones/372/AnimTacle_1.png":!0,"bones/373/AnimTacle_5.json":!0,"bones/373/AnimTacle_5.png":!0,"bones/377/AnimTacle_1.json":!0,"bones/377/AnimTacle_1.png":!0,"bones/377/AnimTacle_5.json":!0,"bones/377/AnimTacle_5.png":!0,"bones/379/AnimTacle_5.json":!0,"bones/379/AnimTacle_5.png":!0,"bones/380/AnimTacle_1.json":!0,"bones/380/AnimTacle_1.png":!0,"bones/380/AnimTacle_5.json":!0,"bones/380/AnimTacle_5.png":!0,"bones/381/AnimTacle_1.json":!0,"bones/381/AnimTacle_1.png":!0,"bones/381/AnimTacle_5.json":!0,"bones/381/AnimTacle_5.png":!0,"bones/382/AnimTacle_1.json":!0,"bones/382/AnimTacle_1.png":!0,"bones/382/AnimTacle_5.json":!0,"bones/382/AnimTacle_5.png":!0,"bones/383/AnimTacle_1.json":!0,"bones/383/AnimTacle_1.png":!0,"bones/383/AnimTacle_5.json":!0,"bones/383/AnimTacle_5.png":!0,"bones/384/AnimTacle_1.json":!0,"bones/384/AnimTacle_1.png":!0,"bones/384/AnimTacle_5.json":!0,"bones/384/AnimTacle_5.png":!0,"bones/385/AnimTacle_5.json":!0,"bones/385/AnimTacle_5.png":!0,"bones/386/AnimTacle_1.json":!0,"bones/386/AnimTacle_1.png":!0,"bones/387/AnimTacle_5.json":!0,"bones/387/AnimTacle_5.png":!0,"bones/388/AnimTacle_1.json":!0,"bones/388/AnimTacle_1.png":!0,"bones/388/AnimTacle_5.json":!0,"bones/388/AnimTacle_5.png":!0,"bones/389/AnimTacle_1.json":!0,"bones/389/AnimTacle_1.png":!0,"bones/389/AnimTacle_5.json":!0,"bones/389/AnimTacle_5.png":!0,"bones/396/AnimTacle_1.json":!0,"bones/396/AnimTacle_1.png":!0,"bones/396/AnimTacle_5.json":!0,"bones/396/AnimTacle_5.png":!0,"bones/40/AnimCueillirSol1_1.json":!0,"bones/40/AnimCueillirSol1_1.png":!0,"bones/40/AnimCueillirSol1_5.json":!0,"bones/40/AnimCueillirSol1_5.png":!0,"bones/403/AnimTacle_1.json":!0,"bones/403/AnimTacle_1.png":!0,"bones/403/AnimTacle_5.json":!0,"bones/403/AnimTacle_5.png":!0,"bones/405/AnimTacle_1.json":!0,"bones/405/AnimTacle_1.png":!0,"bones/405/AnimTacle_5.json":!0,"bones/405/AnimTacle_5.png":!0,"bones/406/AnimTacle_1.json":!0,"bones/406/AnimTacle_1.png":!0,"bones/406/AnimTacle_5.json":!0,"bones/406/AnimTacle_5.png":!0,"bones/407/AnimTacle_1.json":!0,"bones/407/AnimTacle_1.png":!0,"bones/407/AnimTacle_5.json":!0,"bones/407/AnimTacle_5.png":!0,"bones/408/AnimTacle_1.json":!0,"bones/408/AnimTacle_1.png":!0,"bones/408/AnimTacle_5.json":!0,"bones/408/AnimTacle_5.png":!0,"bones/409/AnimTacle_1.json":!0,"bones/409/AnimTacle_1.png":!0,"bones/409/AnimTacle_5.json":!0,"bones/409/AnimTacle_5.png":!0,"bones/410/AnimTacle_1.json":!0,"bones/410/AnimTacle_1.png":!0,"bones/410/AnimTacle_5.json":!0,"bones/410/AnimTacle_5.png":!0,"bones/411/AnimTacle_1.json":!0,"bones/411/AnimTacle_1.png":!0,"bones/411/AnimTacle_5.json":!0,"bones/411/AnimTacle_5.png":!0,"bones/412/AnimTacle_1.json":!0,"bones/412/AnimTacle_1.png":!0,"bones/412/AnimTacle_5.json":!0,"bones/412/AnimTacle_5.png":!0,"bones/413/AnimTacle_1.json":!0,"bones/413/AnimTacle_1.png":!0,"bones/413/AnimTacle_5.json":!0,"bones/413/AnimTacle_5.png":!0,"bones/415/AnimTacle_1.json":!0,"bones/415/AnimTacle_1.png":!0,"bones/415/AnimTacle_5.json":!0,"bones/415/AnimTacle_5.png":!0,"bones/416/AnimTacle_5.json":!0,"bones/416/AnimTacle_5.png":!0,"bones/421/AnimTacle_1.json":!0,"bones/421/AnimTacle_1.png":!0,"bones/421/AnimTacle_5.json":!0,"bones/421/AnimTacle_5.png":!0,"bones/423/AnimTacle_1.json":!0,"bones/423/AnimTacle_1.png":!0,"bones/424/AnimTacle_5.json":!0,"bones/424/AnimTacle_5.png":!0,"bones/426/AnimTacle_1.json":!0,"bones/426/AnimTacle_1.png":!0,"bones/426/AnimTacle_5.json":!0,"bones/426/AnimTacle_5.png":!0,"bones/427/AnimTacle_1.json":!0,"bones/427/AnimTacle_1.png":!0,"bones/427/AnimTacle_5.json":!0,"bones/427/AnimTacle_5.png":!0,"bones/428/AnimTacle_1.json":!0,"bones/428/AnimTacle_1.png":!0,"bones/428/AnimTacle_5.json":!0,"bones/428/AnimTacle_5.png":!0,"bones/429/AnimTacle_1.json":!0,"bones/429/AnimTacle_1.png":!0,"bones/429/AnimTacle_5.json":!0,"bones/429/AnimTacle_5.png":!0,"bones/43/AnimTacle_1.json":!0,"bones/43/AnimTacle_1.png":!0,"bones/433/AnimTacle_1.json":!0,"bones/433/AnimTacle_1.png":!0,"bones/433/AnimTacle_5.json":!0,"bones/433/AnimTacle_5.png":!0,"bones/434/AnimTacle_1.json":!0,"bones/434/AnimTacle_1.png":!0,"bones/436/AnimTacle_1.json":!0,"bones/436/AnimTacle_1.png":!0,"bones/436/AnimTacle_5.json":!0,"bones/436/AnimTacle_5.png":!0,"bones/437/AnimTacle_1.json":!0,"bones/437/AnimTacle_1.png":!0,"bones/437/AnimTacle_5.json":!0,"bones/437/AnimTacle_5.png":!0,"bones/44/AnimAttaque1210_5.json":!0,"bones/44/AnimAttaque1210_5.png":!0,"bones/44/AnimEmoteSit_0_5.json":!0,"bones/44/AnimEmoteSit_0_5.png":!0,"bones/44/AnimPeche_1.json":!0,"bones/44/AnimPeche_1.png":!0,"bones/44/AnimPeche_5.json":!0,"bones/44/AnimPeche_5.png":!0,"bones/441/AnimTacle_1.json":!0,"bones/441/AnimTacle_1.png":!0,"bones/441/AnimTacle_5.json":!0,"bones/441/AnimTacle_5.png":!0,"bones/442/AnimTacle_1.json":!0,"bones/442/AnimTacle_1.png":!0,"bones/442/AnimTacle_5.json":!0,"bones/442/AnimTacle_5.png":!0,"bones/443/AnimTacle_5.json":!0,"bones/443/AnimTacle_5.png":!0,"bones/444/AnimTacle_1.json":!0,"bones/444/AnimTacle_1.png":!0,"bones/444/AnimTacle_5.json":!0,"bones/444/AnimTacle_5.png":!0,"bones/445/AnimTacle_1.json":!0,"bones/445/AnimTacle_1.png":!0,"bones/445/AnimTacle_5.json":!0,"bones/445/AnimTacle_5.png":!0,"bones/45/AnimTacle_1.json":!0,"bones/45/AnimTacle_1.png":!0,"bones/45/AnimTacle_5.json":!0,"bones/45/AnimTacle_5.png":!0,"bones/452/AnimTacle_1.json":!0,"bones/452/AnimTacle_1.png":!0,"bones/452/AnimTacle_5.json":!0,"bones/452/AnimTacle_5.png":!0,"bones/453/AnimAttaque603_1.json":!0,"bones/453/AnimAttaque603_1.png":!0,"bones/453/AnimAttaque603_5.json":!0,"bones/453/AnimAttaque603_5.png":!0,"bones/453/AnimTacle_1.json":!0,"bones/453/AnimTacle_1.png":!0,"bones/453/AnimTacle_5.json":!0,"bones/453/AnimTacle_5.png":!0,"bones/455/AnimTacle_5.json":!0,"bones/455/AnimTacle_5.png":!0,"bones/456/AnimTacle_1.json":!0,"bones/456/AnimTacle_1.png":!0,"bones/456/AnimTacle_5.json":!0,"bones/456/AnimTacle_5.png":!0,"bones/457/AnimTacle_1.json":!0,"bones/457/AnimTacle_1.png":!0,"bones/457/AnimTacle_5.json":!0,"bones/457/AnimTacle_5.png":!0,"bones/458/AnimTacle_1.json":!0,"bones/458/AnimTacle_1.png":!0,"bones/458/AnimTacle_5.json":!0,"bones/458/AnimTacle_5.png":!0,"bones/459/AnimTacle_1.json":!0,"bones/459/AnimTacle_1.png":!0,"bones/459/AnimTacle_5.json":!0,"bones/459/AnimTacle_5.png":!0,"bones/460/AnimTacle_1.json":!0,"bones/460/AnimTacle_1.png":!0,"bones/460/AnimTacle_5.json":!0,"bones/460/AnimTacle_5.png":!0,"bones/461/AnimTacle_5.json":!0,"bones/461/AnimTacle_5.png":!0,"bones/462/AnimTacle_1.json":!0,"bones/462/AnimTacle_1.png":!0,"bones/462/AnimTacle_5.json":!0,"bones/462/AnimTacle_5.png":!0,"bones/463/AnimTacle_1.json":!0,"bones/463/AnimTacle_1.png":!0,"bones/464/AnimTacle_1.json":!0,"bones/464/AnimTacle_1.png":!0,"bones/464/AnimTacle_5.json":!0,"bones/464/AnimTacle_5.png":!0,"bones/465/AnimTacle_5.json":!0,"bones/465/AnimTacle_5.png":!0,"bones/469/AnimTacle_1.json":!0,"bones/469/AnimTacle_1.png":!0,"bones/469/AnimTacle_5.json":!0,"bones/469/AnimTacle_5.png":!0,"bones/47/AnimTacle_1.json":!0,"bones/47/AnimTacle_1.png":!0,"bones/47/AnimTacle_5.json":!0,"bones/47/AnimTacle_5.png":!0,"bones/476/AnimTacle_5.json":!0,"bones/476/AnimTacle_5.png":!0,"bones/477/AnimTacle_1.json":!0,"bones/477/AnimTacle_1.png":!0,"bones/477/AnimTacle_5.json":!0,"bones/477/AnimTacle_5.png":!0,"bones/480/AnimTacle_1.json":!0,"bones/480/AnimTacle_1.png":!0,"bones/480/AnimTacle_5.json":!0,"bones/480/AnimTacle_5.png":!0,"bones/482/AnimTacle_1.json":!0,"bones/482/AnimTacle_1.png":!0,"bones/482/AnimTacle_5.json":!0,"bones/482/AnimTacle_5.png":!0,"bones/484/AnimTacle_1.json":!0,"bones/484/AnimTacle_1.png":!0,"bones/484/AnimTacle_5.json":!0,"bones/484/AnimTacle_5.png":!0,"bones/486/AnimTacle_1.json":!0,"bones/486/AnimTacle_1.png":!0,"bones/489/AnimTacle_1.json":!0,"bones/489/AnimTacle_1.png":!0,"bones/489/AnimTacle_5.json":!0,"bones/489/AnimTacle_5.png":!0,"bones/492/AnimTacle_1.json":!0,"bones/492/AnimTacle_1.png":!0,"bones/492/AnimTacle_5.json":!0,"bones/492/AnimTacle_5.png":!0,"bones/493/AnimTacle_1.json":!0,"bones/493/AnimTacle_1.png":!0,"bones/493/AnimTacle_5.json":!0,"bones/493/AnimTacle_5.png":!0,"bones/494/AnimTacle_1.json":!0,"bones/494/AnimTacle_1.png":!0,"bones/494/AnimTacle_5.json":!0,"bones/494/AnimTacle_5.png":!0,"bones/498/AnimTacle_1.json":!0,"bones/498/AnimTacle_1.png":!0,"bones/498/AnimTacle_5.json":!0,"bones/498/AnimTacle_5.png":!0,"bones/499/AnimTacle_1.json":!0,"bones/499/AnimTacle_1.png":!0,"bones/51/AnimTacle_1.json":!0,"bones/51/AnimTacle_1.png":!0,"bones/51/AnimTacle_5.json":!0,"bones/51/AnimTacle_5.png":!0,"bones/512/AnimTacle_1.json":!0,"bones/512/AnimTacle_1.png":!0,"bones/512/AnimTacle_5.json":!0,"bones/512/AnimTacle_5.png":!0,"bones/513/AnimTacle_1.json":!0,"bones/513/AnimTacle_1.png":!0,"bones/52/AnimTacle_1.json":!0,"bones/52/AnimTacle_1.png":!0,"bones/52/AnimTacle_5.json":!0,"bones/52/AnimTacle_5.png":!0,"bones/521/AnimTacle_1.json":!0,"bones/521/AnimTacle_1.png":!0,"bones/521/AnimTacle_5.json":!0,"bones/521/AnimTacle_5.png":!0,"bones/523/AnimTacle_1.json":!0,"bones/523/AnimTacle_1.png":!0,"bones/525/AnimTacle_1.json":!0,"bones/525/AnimTacle_1.png":!0,"bones/525/AnimTacle_5.json":!0,"bones/525/AnimTacle_5.png":!0,"bones/526/AnimTacle_1.json":!0,"bones/526/AnimTacle_1.png":!0,"bones/526/AnimTacle_5.json":!0,"bones/526/AnimTacle_5.png":!0,"bones/528/AnimTacle_1.json":!0,"bones/528/AnimTacle_1.png":!0,"bones/528/AnimTacle_5.json":!0,"bones/528/AnimTacle_5.png":!0,"bones/531/AnimTacle_1.json":!0,"bones/531/AnimTacle_1.png":!0,"bones/531/AnimTacle_5.json":!0,"bones/531/AnimTacle_5.png":!0,"bones/532/AnimTacle_1.json":!0,"bones/532/AnimTacle_1.png":!0,"bones/532/AnimTacle_5.json":!0,"bones/532/AnimTacle_5.png":!0,"bones/533/AnimTacle_1.json":!0,"bones/533/AnimTacle_1.png":!0,"bones/533/AnimTacle_5.json":!0,"bones/533/AnimTacle_5.png":!0,"bones/534/AnimTacle_1.json":!0,"bones/534/AnimTacle_1.png":!0,"bones/534/AnimTacle_5.json":!0,"bones/534/AnimTacle_5.png":!0,"bones/535/AnimTacle_5.json":!0,"bones/535/AnimTacle_5.png":!0,"bones/536/AnimTacle_1.json":!0,"bones/536/AnimTacle_1.png":!0,"bones/539/AnimTacle_1.json":!0,"bones/539/AnimTacle_1.png":!0,"bones/539/AnimTacle_5.json":!0,"bones/539/AnimTacle_5.png":!0,"bones/540/AnimTacle_1.json":!0,"bones/540/AnimTacle_1.png":!0,"bones/540/AnimTacle_5.json":!0,"bones/540/AnimTacle_5.png":!0,"bones/547/AnimTacle_1.json":!0,"bones/547/AnimTacle_1.png":!0,"bones/547/AnimTacle_5.json":!0,"bones/547/AnimTacle_5.png":!0,"bones/548/AnimTacle_1.json":!0,"bones/548/AnimTacle_1.png":!0,"bones/549/AnimTacle_1.json":!0,"bones/549/AnimTacle_1.png":!0,"bones/550/AnimTacle_1.json":!0,"bones/550/AnimTacle_1.png":!0,"bones/550/AnimTacle_5.json":!0,"bones/550/AnimTacle_5.png":!0,"bones/551/AnimTacle_1.json":!0,"bones/551/AnimTacle_1.png":!0,"bones/551/AnimTacle_5.json":!0,"bones/551/AnimTacle_5.png":!0,"bones/552/AnimTacle_1.json":!0,"bones/552/AnimTacle_1.png":!0,"bones/554/AnimTacle_1.json":!0,"bones/554/AnimTacle_1.png":!0,"bones/557/AnimAttaque3_5.json":!0,"bones/557/AnimAttaque3_5.png":!0,"bones/557/AnimTacle_1.json":!0,"bones/557/AnimTacle_1.png":!0,"bones/557/AnimTacle_5.json":!0,"bones/557/AnimTacle_5.png":!0,"bones/558/AnimAttaque3_5.json":!0,"bones/558/AnimAttaque3_5.png":!0,"bones/559/AnimTacle_1.json":!0,"bones/559/AnimTacle_1.png":!0,"bones/559/AnimTacle_5.json":!0,"bones/559/AnimTacle_5.png":!0,"bones/560/AnimCueillir0_1.json":!0,"bones/560/AnimCueillir0_1.png":!0,"bones/560/AnimCueillir0_5.json":!0,"bones/560/AnimCueillir0_5.png":!0,"bones/560/AnimEmoteBeer_0_1.json":!0,"bones/560/AnimEmoteBeer_0_1.png":!0,"bones/560/AnimEmoteBeer_0_5.json":!0,"bones/560/AnimEmoteBeer_0_5.png":!0,"bones/560/AnimEmoteDrink_0_1.json":!0,"bones/560/AnimEmoteDrink_0_1.png":!0,"bones/560/AnimEmoteDrink_0_5.json":!0,"bones/560/AnimEmoteDrink_0_5.png":!0,"bones/560/AnimEmoteEat_0_1.json":!0,"bones/560/AnimEmoteEat_0_1.png":!0,"bones/560/AnimEmoteEat_0_5.json":!0,"bones/560/AnimEmoteEat_0_5.png":!0,"bones/560/AnimEmoteRest_0_1.json":!0,"bones/560/AnimEmoteRest_0_1.png":!0,"bones/560/AnimEmoteSit_0_1.json":!0,"bones/560/AnimEmoteSit_0_1.png":!0,"bones/560/AnimEmoteSit_0_5.json":!0,"bones/560/AnimEmoteSit_0_5.png":!0,"bones/560/AnimHache_1.json":!0,"bones/560/AnimHache_1.png":!0,"bones/560/AnimHache_5.json":!0,"bones/560/AnimHache_5.png":!0,"bones/560/AnimPioche_5.json":!0,"bones/560/AnimPioche_5.png":!0,"bones/561/AnimTacle_1.json":!0,"bones/561/AnimTacle_1.png":!0,"bones/561/AnimTacle_5.json":!0,"bones/561/AnimTacle_5.png":!0,"bones/562/AnimTacle_1.json":!0,"bones/562/AnimTacle_1.png":!0,"bones/562/AnimTacle_5.json":!0,"bones/562/AnimTacle_5.png":!0,"bones/566/AnimTacle_1.json":!0,"bones/566/AnimTacle_1.png":!0,"bones/566/AnimTacle_5.json":!0,"bones/566/AnimTacle_5.png":!0,"bones/570/AnimCueillir0_1.json":!0,"bones/570/AnimCueillir0_1.png":!0,"bones/570/AnimCueillir0_5.json":!0,"bones/570/AnimCueillir0_5.png":!0,"bones/570/AnimCueillirSol0_1.json":!0,"bones/570/AnimCueillirSol0_1.png":!0,"bones/570/AnimCueillirSol0_5.json":!0,"bones/570/AnimCueillirSol0_5.png":!0,"bones/570/AnimEmoteDrink_0_1.json":!0,"bones/570/AnimEmoteDrink_0_1.png":!0,"bones/571/AnimTacle_1.json":!0,"bones/571/AnimTacle_1.png":!0,"bones/571/AnimTacle_5.json":!0,"bones/571/AnimTacle_5.png":!0,"bones/572/AnimTacle_5.json":!0,"bones/572/AnimTacle_5.png":!0,"bones/573/AnimTacle_1.json":!0,"bones/573/AnimTacle_1.png":!0,"bones/574/AnimTacle_1.json":!0,"bones/574/AnimTacle_1.png":!0,"bones/576/AnimTacle_1.json":!0,"bones/576/AnimTacle_1.png":!0,"bones/576/AnimTacle_5.json":!0,"bones/576/AnimTacle_5.png":!0,"bones/577/AnimTacle_1.json":!0,"bones/577/AnimTacle_1.png":!0,"bones/577/AnimTacle_5.json":!0,"bones/577/AnimTacle_5.png":!0,"bones/578/AnimTacle_1.json":!0,"bones/578/AnimTacle_1.png":!0,"bones/578/AnimTacle_5.json":!0,"bones/578/AnimTacle_5.png":!0,"bones/579/AnimTacle_1.json":!0,"bones/579/AnimTacle_1.png":!0,"bones/579/AnimTacle_5.json":!0,"bones/579/AnimTacle_5.png":!0,"bones/580/AnimTacle_1.json":!0,"bones/580/AnimTacle_1.png":!0,"bones/580/AnimTacle_5.json":!0,"bones/580/AnimTacle_5.png":!0,"bones/581/AnimTacle_1.json":!0,"bones/581/AnimTacle_1.png":!0,"bones/581/AnimTacle_5.json":!0,"bones/581/AnimTacle_5.png":!0,"bones/583/AnimTacle_5.json":!0,"bones/583/AnimTacle_5.png":!0,"bones/585/AnimTacle_1.json":!0,"bones/585/AnimTacle_1.png":!0,"bones/585/AnimTacle_5.json":!0,"bones/585/AnimTacle_5.png":!0,"bones/586/AnimTacle_1.json":!0,"bones/586/AnimTacle_1.png":!0,"bones/587/AnimTacle_1.json":!0,"bones/587/AnimTacle_1.png":!0,"bones/588/AnimTacle_1.json":!0,"bones/588/AnimTacle_1.png":!0,"bones/594/AnimTacle_1.json":!0,"bones/594/AnimTacle_1.png":!0,"bones/594/AnimTacle_5.json":!0,"bones/594/AnimTacle_5.png":!0,"bones/601/AnimTacle_1.json":!0,"bones/601/AnimTacle_1.png":!0,"bones/609/AnimTacle_1.json":!0,"bones/609/AnimTacle_1.png":!0,"bones/609/AnimTacle_5.json":!0,"bones/609/AnimTacle_5.png":!0,"bones/611/AnimTacle_1.json":!0,"bones/611/AnimTacle_1.png":!0,"bones/611/AnimTacle_5.json":!0,"bones/611/AnimTacle_5.png":!0,"bones/620/AnimTacle_5.json":!0,"bones/620/AnimTacle_5.png":!0,"bones/624/AnimTacle_1.json":!0,"bones/624/AnimTacle_1.png":!0,"bones/625/AnimTacle_1.json":!0,"bones/625/AnimTacle_1.png":!0,"bones/627/AnimTacle_1.json":!0,"bones/627/AnimTacle_1.png":!0,"bones/627/AnimTacle_5.json":!0,"bones/627/AnimTacle_5.png":!0,"bones/63/AnimTacle_5.json":!0,"bones/63/AnimTacle_5.png":!0,"bones/630/AnimTacle_5.json":!0,"bones/630/AnimTacle_5.png":!0,"bones/631/AnimTacle_1.json":!0,"bones/631/AnimTacle_1.png":!0,"bones/631/AnimTacle_5.json":!0,"bones/631/AnimTacle_5.png":!0,"bones/632/AnimTacle_1.json":!0,"bones/632/AnimTacle_1.png":!0,"bones/632/AnimTacle_5.json":!0,"bones/632/AnimTacle_5.png":!0,"bones/633/AnimTacle_1.json":!0,"bones/633/AnimTacle_1.png":!0,"bones/633/AnimTacle_5.json":!0,"bones/633/AnimTacle_5.png":!0,"bones/639/AnimAttaque1001_1.json":!0,"bones/639/AnimAttaque1001_1.png":!0,"bones/639/AnimAttaque101_1.json":!0,"bones/639/AnimAttaque101_1.png":!0,"bones/639/AnimAttaque1102_1.json":!0,"bones/639/AnimAttaque1102_1.png":!0,"bones/639/AnimAttaque1102_5.json":!0,"bones/639/AnimAttaque1102_5.png":!0,"bones/639/AnimAttaque1103_1.json":!0,"bones/639/AnimAttaque1103_1.png":!0,"bones/639/AnimAttaque201_1.json":!0,"bones/639/AnimAttaque201_5.json":!0,"bones/639/AnimAttaque201_5.png":!0,"bones/639/AnimAttaque2_5.json":!0,"bones/639/AnimAttaque2_5.png":!0,"bones/639/AnimAttaque501_5.json":!0,"bones/639/AnimAttaque501_5.png":!0,"bones/639/AnimAttaque602_5.json":!0,"bones/639/AnimAttaque602_5.png":!0,"bones/639/AnimAttaque7_1.json":!0,"bones/639/AnimAttaque7_1.png":!0,"bones/639/AnimAttaque7_5.json":!0,"bones/639/AnimAttaque7_5.png":!0,"bones/639/AnimAttaque801_1.json":!0,"bones/639/AnimAttaque801_1.png":!0,"bones/639/AnimAttaque801_5.json":!0,"bones/639/AnimAttaque801_5.png":!0,"bones/639/AnimAttaque803_1.json":!0,"bones/639/AnimAttaque803_1.png":!0,"bones/639/AnimAttaque803_5.json":!0,"bones/639/AnimAttaque803_5.png":!0,"bones/639/AnimAttaque8_5.json":!0,"bones/639/AnimAttaque8_5.png":!0,"bones/639/AnimAttaque902_5.json":!0,"bones/639/AnimAttaque902_5.png":!0,"bones/639/AnimAttaque9_1.json":!0,"bones/639/AnimAttaque9_1.png":!0,"bones/639/AnimAttaque9_5.json":!0,"bones/639/AnimAttaque9_5.png":!0,"bones/639/AnimCueillir0_1.json":!0,"bones/639/AnimCueillir0_1.png":!0,"bones/639/AnimCueillir0_5.json":!0,"bones/639/AnimCueillir0_5.png":!0,"bones/639/AnimCueillirSol0_1.json":!0,"bones/639/AnimCueillirSol0_1.png":!0,"bones/639/AnimCueillirSol0_5.json":!0,"bones/639/AnimCueillirSol0_5.png":!0,"bones/639/AnimEmoteAlliance_0_1.json":!0,"bones/639/AnimEmoteAlliance_0_1.png":!0,"bones/639/AnimEmoteAlliance_0_5.json":!0,"bones/639/AnimEmoteAlliance_0_5.png":!0,"bones/639/AnimEmoteGuild_0_1.json":!0,"bones/639/AnimEmoteGuild_0_1.png":!0,"bones/639/AnimEmoteGuild_0_5.json":!0,"bones/639/AnimEmoteGuild_0_5.png":!0,"bones/639/AnimEmoteWeap_0_1.json":!0,"bones/639/AnimEmoteWeap_0_1.png":!0,"bones/639/AnimHache_1.json":!0,"bones/639/AnimHache_1.png":!0,"bones/639/AnimHache_5.json":!0,"bones/639/AnimHache_5.png":!0,"bones/639/AnimHit_0.json":!0,"bones/639/AnimHit_0.png":!0,"bones/639/AnimHit_2.json":!0,"bones/639/AnimHit_2.png":!0,"bones/639/AnimHit_6.json":!0,"bones/639/AnimHit_6.png":!0,"bones/639/AnimMort_0.json":!0,"bones/639/AnimMort_0.png":!0,"bones/639/AnimPickup_1.png":!0,"bones/639/AnimPioche_1.json":!0,"bones/639/AnimPioche_1.png":!0,"bones/639/AnimPioche_5.json":!0,"bones/639/AnimPioche_5.png":!0,"bones/639/AnimThrow_5.png":!0,"bones/643/AnimTacle_5.json":!0,"bones/643/AnimTacle_5.png":!0,"bones/644/AnimTacle_1.json":!0,"bones/644/AnimTacle_1.png":!0,"bones/68/AnimTacle_1.json":!0,"bones/68/AnimTacle_1.png":!0,"bones/68/AnimTacle_5.json":!0,"bones/68/AnimTacle_5.png":!0,"bones/69/AnimTacle_1.json":!0,"bones/69/AnimTacle_1.png":!0,"bones/69/AnimTacle_5.json":!0,"bones/69/AnimTacle_5.png":!0,"bones/706/AnimTacle_1.json":!0,"bones/706/AnimTacle_1.png":!0,"bones/706/AnimTacle_5.json":!0,"bones/706/AnimTacle_5.png":!0,"bones/708/AnimTacle_1.json":!0,"bones/708/AnimTacle_1.png":!0,"bones/78/AnimTacle_1.json":!0,"bones/78/AnimTacle_1.png":!0,"bones/78/AnimTacle_5.json":!0,"bones/78/AnimTacle_5.png":!0,"bones/79/AnimTacle_1.json":!0,"bones/79/AnimTacle_1.png":!0,"bones/81/AnimTacle_1.json":!0,"bones/81/AnimTacle_1.png":!0,"bones/81/AnimTacle_5.json":!0,"bones/81/AnimTacle_5.png":!0,"bones/834/AnimTacle_1.json":!0,"bones/834/AnimTacle_1.png":!0,"bones/834/AnimTacle_5.json":!0,"bones/834/AnimTacle_5.png":!0,"bones/839/AnimTacle_1.json":!0,"bones/839/AnimTacle_1.png":!0,"bones/839/AnimTacle_5.json":!0,"bones/839/AnimTacle_5.png":!0,"bones/840/AnimTacle_1.json":!0,"bones/840/AnimTacle_1.png":!0,"bones/840/AnimTacle_5.json":!0,"bones/840/AnimTacle_5.png":!0,"bones/85/AnimTacle_1.json":!0,"bones/85/AnimTacle_1.png":!0,"bones/85/AnimTacle_5.json":!0,"bones/85/AnimTacle_5.png":!0,"bones/889/AnimTacle_1.json":!0,"bones/889/AnimTacle_1.png":!0,"bones/889/AnimTacle_5.json":!0,"bones/889/AnimTacle_5.png":!0,"bones/892/AnimAttaque2_1.json":!0,"bones/892/AnimAttaque2_1.png":!0,"bones/892/AnimAttaque2_5.json":!0,"bones/892/AnimAttaque2_5.png":!0,"bones/892/AnimTacle_1.json":!0,"bones/892/AnimTacle_1.png":!0,"bones/892/AnimTacle_5.json":!0,"bones/892/AnimTacle_5.png":!0,"bones/91/AnimTacle_1.json":!0,"bones/91/AnimTacle_1.png":!0,"bones/91/AnimTacle_5.json":!0,"bones/91/AnimTacle_5.png":!0,"gfx/monsters/1122.png":!0,"gfx/monsters/3203.png":!0,"skins/0.json":!0,"skins/0.png":!0,"skins/919.json":!0,"skins/919.png":!0}},function(e,t,i){function n(e){if(!window.Config.sessionId)return console.warn("Cannot make URL sticky (no session ID has been set):",e),e;var t=e.indexOf("?")===-1?"?":"&";return e+t+x+"="+encodeURIComponent(window.Config.sessionId)}function o(){var e=window.appInfo||{};return e.server?e.server:"https://proxyconnection.touch.dofus.com"}function s(e){for(var t=0;t<O.length;t+=1){var i=O[t];if(i.id===e)return i}}function a(e,t){var i={};e&&(i.lang=e);var n=o()+"/config.json?"+S.stringify(i);h.loadJson(n,function(e,i){return e?t(e):(i.imgCrossOrigin=i.assetsUrl.match(/^https?:\/\/.+?:.+?@.+?/)?void 0:"anonymous",void t(null,i))})}function r(e,i){u.auto({primus:function(e){return window.Primus?e():void h.loadScript(o()+"/primus/primus.js",e)},config:function(i){return window.Config?e?t.setLanguage(e,i):i():void a(e,function(e,t){return e?i(e):(window.Config=t,void i())})},syncSetup:["config",function(e){m.setup(window.Config),_.initialize(window.Config),e()}],getText:["syncSetup",function(e){v.initialize(window.Config,e)}]},i)}function l(){w.setupChannels(g.getValue("soundPreferences",{},!0)),w.playLoopSound("music","20000",.8)}function c(){w.stopAllLoopSounds(),w.release()}function d(e){var t={language:window.Config?window.Config.language:"en",server:e,client:E.os,appVersion: "1.9.35",buildVersion:L};return t}var u=i(31),h=i(187),p=i(188).EventEmitter,m=i(189),f=i(202),g=i(176),_=i(30),v=i(29),y=i(204);i(211);var b=i(308),M=i(309),w=i(247),T=i(310),C=i(311),A=i(7),I=i(312),S=i(38),E=i(168);window.developmentMode&&i(313);var x="STICKER",N=window.appInfo&&window.appInfo.version,L=window.buildVersion;t=e.exports=new p,t.logger=m,t.connectionManager=f,t.sessionId=null;var O=[];t.setLanguage=function(e,t){if(!window.Config||e&&window.Config.language===e)return t();var i=o()+"/getLanguage.json?lang="+e;h.loadJson(i,function(e,i){return e?t(e):(window.Config.language=i.language,void t())})},t.start=function(){function e(){return window.gui.splashScreen.show(),window.setTimeout(function(){window.gui.splashScreen.hide(),t.start()},6e4)}window.gui.initialize();var i=g.getValue("lang");r(i,function(t){return t?(console.error(t),void(navigator.notification?navigator.notification.alert("Server busy.",e,"Dofus Touch","Reload"):(window.alert("Server busy."),e()))):(A.init(window.Config.analytics),I.initialize(window.Config.adjust),y.backToLogin(),window.gui.initialize(window.Config),void(window.isoEngine&&window.isoEngine.initialize({config:window.Config})))})};var D,R=0,P=1,B=2,k=3,z=4,F=R,H={username:null,token:null,salt:null,key:null};t.setCredentials=function(e,t){g.setValue("token",t),H.username=e,H.token=t,H.salt=null,H.key=null},t.login=function(e){if(F===B)return console.warn("Already logged in"),e();if(F===P)return console.warn("Already logging in"),t.once("loginEnd",e);F===z&&f.disconnect("SWITCHING_TO_LOGIN"),F=P,H.salt=null,H.key=null;var i=C(f,function(i){i?(this.disconnect("LOGIN_ERROR"),F=R,t.emit("loginEnd",i)):(F=B,t.emit("loginEnd")),e(i)});i("disconnect",function(){throw new Error("Disconnect during login")}),i("open",function(){this.send("connecting",d("login"))}),i("serverDisconnecting",function(e){i.done(e)}),i("ProtocolRequired",function(e){console.log("[Login server protocol] requiredVersion:",e.requiredVersion,"currentVersion:",e.currentVersion)}),i("HelloConnectMessage",function(e){H.salt=e.salt,H.key=e.key;var t=this;M.getVersions(function(e,n){return e?i.done(e):void t.send("checkAssetsVersion",n)})}),i("assetsVersionChecked",function(e){var t=this;M.upgradeAssets(e,function(e){return e?i.done(e):void t.send("login",H)})}),i("IdentificationSuccessMessage","IdentificationSuccessWithLoginTokenMessage",function(e){var n=window.gui.playerData.loginName;if(n){if(/^\[GUEST]/.test(n)){if(window.Config.disabledFeatures.guest)return i.done(new Error("identification: no guests"));var o=g.getValue("guestAccount",{},!0);o.nickname=e.nickname}}else console.error("dofus.login: loginName is empty");g.setAccount(e.nickname),g.setValue("token",e.loginToken),l(),T.start(),e.wasAlreadyConnected&&t.emit("wasAlreadyConnected")}),i("ConnectionFailedMessage","IdentificationFailedMessage","IdentificationFailedForBadVersionMessage","IdentificationFailedBannedMessage",function(e){i.done(e)}),i("ServersListMessage",function(e){O=e.servers,i.done()}),f.connect(n(o()))},t.accessGameServer=function(e,i){if(F===P)return t.once("loginEnd",function(n){return n?i(n):void t.accessGameServer(e,i)});if(F===k)return e===D?(console.warn("Already accessing this game server ("+e+")"),t.once("accessGameEnd",i)):i(new Error("Already accessing game server "+D+" (while trying to access "+e+")"));
if(D=e,F!==B)return t.login(function(n){return n?i(n):void t.accessGameServer(e,i)});var o,a,r,l=s(e);if(!l)return i(new Error("Unknown server: "+e));F=k;var c=C(f,function(e){e?(this.disconnect("GAME_HANDSHAKE_ERROR"),F=R,t.emit("accessGameEnd",e)):(F=z,t.emit("accessGameEnd")),D=null,i(e)});c("SelectedServerDataMessage",function(e){o=e.ticket,a=e.address,r=e.port,this.disconnect("SWITCHING_TO_GAME"),this.connect(n(e._access))}),c("SelectedServerRefusedMessage",function(t){throw new Error("Server "+e+" not accessible: "+t.error)}),c("open",function(){this.send("connecting",d({address:a,port:r,id:e}))}),c("serverDisconnecting",function(e){c.done(e)}),c("ProtocolRequired",function(e){console.log("[Game server protocol] requiredVersion:",e.requiredVersion,"currentVersion:",e.currentVersion)}),c("HelloGameMessage",function(){this.sendMessage("AuthenticationTicketMessage",{ticket:o,lang:window.Config.language})}),c("AuthenticationTicketAcceptedMessage",function(){c.done()}),c("AuthenticationTicketRefusedMessage",function(){throw new Error("Server "+e+" Authentication failed")}),f.sendMessage("ServerSelectionMessage",{serverId:e})},f.on("HelloConnectMessage",function(){window.gui.connectionSplashScreen.onStateChange("CONNECTED")}),f.on("offline",function(){window.gui.connectionSplashScreen.onStateChange("UNSTABLE")}),f.on("reconnecting",function(e,t){console.info("Reconnecting to "+t+" (attempt #"+e+")"),window.gui.connectionSplashScreen.onStateChange("RECONNECTING",e)}),f.on("open",function(e){e&&f.send("reconnecting")}),f.on("sessionReconnected",function(){return window.isoEngine.onQuickReconnection(function(){window.gui.connectionSplashScreen.onStateChange("CONNECTED")})}),f.on("sessionTimedOut",function(){console.info("Session timed out"),f.disconnect("SESSION_TIMED_OUT")}),f.on("serverDisconnecting",function(e){console.info("Server disconnecting, reason:",e.reason),f.disconnect("SOCKET_LOST")}),f.on("disconnect",function(e){F=R,e.match(/^SWITCHING_/)||(c(),T.stop(),window.gui.disconnect(e),window.isoEngine.disconnect(),window.gui.connectionSplashScreen.onStateChange("RELOAD"===e?"RELOADING":"DISCONNECTED"))}),t.toggleTutorialListeners=function(e){e?b.setTutorialListeners(f):b.removeTutorialListeners(f)},t.send=function(e,t){f.send(e,t)},t.sendMessage=function(e,t){f.sendMessage(e,t)},t.disconnect=function(e){f.disconnect(e)},window.addEventListener("beforeunload",function(){f.disconnect("RELOAD")})},function(e,t){function i(e,t){var i=document.getElementsByTagName("head")[0],n=document.createElement("script");n.onload=function(){return this.onload=null,this.onerror=null,t()},n.onerror=function(){return this.onload=null,this.onerror=null,t(new Error("Error loading script: "+e))},n.type="text/javascript",n.src=e,i.appendChild(n)}function n(e,t){var i=new XMLHttpRequest;i.overrideMimeType("application/json"),i.onreadystatechange=function(){if(4===~~i.readyState){if(i.onreadystatechange=null,200!==~~i.status)return t(new Error("Error loading json: "+e));var n;try{n=JSON.parse(i.responseText)}catch(o){return t(o)}return t(null,n)}},i.open("GET",e,!0),i.send(null)}e.exports.loadScript=i,e.exports.loadJson=n},function(e,t){var i=function(){this.eventHandlers={}};i.EventEmitter=i,e.exports=i,i.listenerCount=function(e,t){var i=e.eventHandlers[t];return i?i.length:0},i.prototype.on=function(e,t){if("function"!=typeof t)return console.warn("Tried to register non-function",t,"as event handler for event:",e),this;this.emit("newListener",e,t);var i=this.eventHandlers,n=i[e];return void 0===n?(i[e]=[t],this):(n.push(t),this)},i.prototype.addListener=i.prototype.on,i.prototype.once=function(e,t){return t.once?t.once+=1:t.once=1,this.on(e,t)},i.prototype.setMaxListeners=function(){console.warn("Method setMaxListeners not supported, there is no limit to the number of listeners")},i.prototype.removeListener=function(e,t){var i=this.eventHandlers[e];if(void 0!==i){var n=i.indexOf(t);n!==-1&&(i.splice(n,1),this.emit("removeListener",e,t),0===i.length&&delete this.eventHandlers[e])}return this},i.prototype.removeAllListeners=function(e){return e?delete this.eventHandlers[e]:this.eventHandlers={},this},i.prototype.hasListeners=function(e){return void 0!==this.eventHandlers[e]},i.prototype.listeners=function(e){var t=this.eventHandlers[e];return void 0!==t?t.slice():[]};var n=Array.prototype.slice;i.prototype.emit=function(e){var t=this.eventHandlers[e];if(void 0===t)return!1;t=t.slice();for(var i=!1,o=n.call(arguments,1),s=0,a=t.length;s<a;s++){var r=t[s];void 0!==r&&(r.apply(this,o),i=!0,r.once&&(r.once>1?r.once--:delete r.once,this.removeListener(e,r)))}return i}},function(e,t,i){function n(e){_[e]||(_[e]=function(){_.emit(e,arguments)})}function o(){var e={};if(!window.gui.playerData)return e;var t=window.gui.playerData,i=t.identification||{},n=t.characterBaseInformations||{},o=t.position||{},s=window.gui.fightManager||{},a=window.appInfo&&window.appInfo.version,r=window.buildVersion;return e.nickname=i.nickname,e.accountId=i.accountId,e.charaName=n.name,e.charaId=n.id,e.breed=n.breed,e.level=n.level,e.mapId=o.mapId,e.openWindows=p.getOpenWindows(),e.lastClosedWindow=p.getLastClosedWindow(),e.fightState=s.fightState,e.appVersion=a,e.buildVersion=r,e.appStart=b,e.lastDisconnect=M,e.lastCharaSelection=w,e.lastReceivedMessage=m.lastReceivedMessage,e}function s(){}function a(){}function r(e){var t=I[e];if(t)return t;var i=A[e];return i?(t=new i,I[e]=t,t):void v.error("Unknown writer type:",e)}function l(e){for(var t=Object.keys(g),i=0,o=t.length;i<o;i++){var s=t[i];n(s);for(var a in e){var l=e[a],c=r(a);c&&l.indexOf(s)!==-1&&c.addChannel(s)}}}function c(e){if(!d){d={};for(var t in e)if(e.hasOwnProperty(t)){if(S[t])continue;d[t]=e[t]}}}var d,u=i(188).EventEmitter,h=i(190),p=i(194),m=i(202),f=i(28),g={},_=new u,v=window.console,y=10,b=f.now(),M=-1,w=-1;v||(v={log:function(){},info:function(){},debug:function(){},warn:function(){},error:function(){}});var T={log:"verbose",debug:"debug",info:"info",warn:"warning",error:"error"},C={verbose:"color: #AAA",debug:"color: #0AA;",info:"color: #00A; font-weight: bold;",notice:"color: #0A0;",warning:"color: #F55;",error:"color: #A00;",critical:"color: #A00; font-weight: bold;",alert:"color: #A00; font-weight: bold; text-decoration: underline;",emergency:"background-color: #A00; font-weight: bold;"};Object.keys(T).forEach(function(e){"function"==typeof v[e]?v["_"+e]=v[e]:"object"==typeof v[e]&&(v["_"+e]=Function.prototype.bind.call(v[e],v))}),s.prototype.addChannel=function(e){var t,i=Array.prototype.slice,n="%c["+e+"]",o="background-color: transparent;",s=g[e]||0;C[e]&&(o=C[e]),s>g.warning&&(t=v._error),!t&&s>=g.warning&&(t=v._warn),!t&&v._info&&s>=g.info&&(t=v._info),!t&&v._debug&&s>=g.debug&&(t=v._debug),t||(t=v._log),_.on(e,function(e){var s=i.call(e),a=n;return v.group&&_.groups?(v.group(a,o),t.apply(v,s),void v.groupEnd()):("string"==typeof s[0]&&(a=a+" "+s.shift()),e=[a,o].concat(s),void t.apply(v,e))})},a.prototype.addChannel=function(e){var t=window.navigator||{},i={userAgent:t.userAgent||"unknown",clientConfig:d};_.on(e,function(t){var n=h(t);n.data||(n.data={}),Array.isArray(n.data.error)&&n.data.error.length>y&&(n.data.error.length=y),i.characterInfo=o(),n.data.clientInfo=i;var s=window.Config&&window.Config.dataUrl||"",a={};a.Accept="application/json",a["Content-Type"]="application/json",window.fetch(s+"/logger",{method:"post",headers:a,body:JSON.stringify({channelName:e,message:n.message,data:n.data,report:n})})})};var A={console:s,server:a},I={},S={logging:!0,haapi:!0,adjust:!0,analytics:!0,serverLanguages:!0,failoverLanguage:!0,uiUrl:!0,dataUrl:!0,imgCrossOrigin:!0};_.setup=function(e){e=e||{};var t=e.logging||{};c(e),g=t.logLevels||{},_.groups=t.groups,l(t.config),t.disableOverride||(_.overrideConsole(),_.logUncaughtExceptions("error",!1)),window.gui.on("disconnect",function(){M=f.now()}),m.on("CharacterSelectedSuccessMessage",function(){w=f.now()})},_.overrideConsole=function(){},_.logUncaughtExceptions=function(e,t){var i=window.ErrorEvent;window.onerror&&_.debug("window.onerror was already assigned, overwriting."),window.onerror=function(n,o,s,a,r){if(i&&n instanceof i)_.emit(e,[n,r]);else if(i&&window.event instanceof i)_.emit(e,[window.event,r]);else{var l=[{message:n,url:o,lineno:s,colno:a}];r&&l.push(r),_.emit(e,l)}if(!t)return!0}},e.exports=_},function(e,t,i){function n(e,t){function i(h){if(void 0===h)return JSON.stringify("<undefined>");if(d&&h instanceof d)return JSON.stringify("[DOM Window]");if(c&&h instanceof c)return JSON.stringify("[DOM Element ("+s(h)+")]");if(l&&h instanceof l)return JSON.stringify("[DOM Node ("+h.nodeName+")]");if(r&&h instanceof r)return JSON.stringify("[RegExp ("+h.toString()+")]");if(h instanceof n){try{t.error=o.parse(h)}catch(p){"string"==typeof h.stack&&(t.error=h.stack.split("\n"))}return JSON.stringify(h.name+": "+h.message)}if(a&&h instanceof a)return t.filename=h.filename,t.lineno=e.lineno,t.colno=e.colno||e.column,h.error&&(t.error=i(h.error)),i(h.message);if(Array.isArray(h))return u.indexOf(h)!==-1?JSON.stringify("[Circular reference]"):(u.push(h),"["+h.map(i).join(",")+"]");if(h&&"object"==typeof h){if(u.indexOf(h)!==-1)return JSON.stringify("[Circular reference]");u.push(h);var m=Object.keys(h);return"{"+m.map(function(e){return JSON.stringify(e)+":"+i(h[e])}).join(",")+"}"}return JSON.stringify(h)}var n=window.Error,a=window.ErrorEvent,r=window.RegExp,l=window.Node,c=window.Element,d=window.Window,u=[];return i(e)}var o=i(191),s=i(193);e.exports=function(e){for(var t=e.length,i=new Array(t),o={},s=0;s<t;s++){var a=e[s];"string"==typeof a?i[s]=a:i[s]=n(e[s],o)}var r=i.join(" ");return 0===Object.keys(o).length&&(o=null),{message:r,data:o}}},function(e,t,i){var n,o,s;!function(a,r){"use strict";o=[i(192)],n=r,s="function"==typeof n?n.apply(t,o):n,!(void 0!==s&&(e.exports=s))}(this,function(e){"use strict";var t=/(^|@)\S+\:\d+/,i=/\s+at .*(\S+\:\d+|\(native\))/;return{parse:function(e){if("undefined"!=typeof e.stacktrace||"undefined"!=typeof e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(i))return this.parseV8OrIE(e);if(e.stack&&e.stack.match(t))return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(e.indexOf(":")===-1)return[e];var t=e.replace(/[\(\)\s]/g,"").split(":"),i=t.pop(),n=t[t.length-1];if(!isNaN(parseFloat(n))&&isFinite(n)){var o=t.pop();return[t.join(":"),o,i]}return[t.join(":"),i,void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter(function(e){return!!e.match(i)},this).map(function(t){var i=t.replace(/^\s+/,"").split(/\s+/).slice(1),n=this.extractLocation(i.pop()),o=i[0]&&"Anonymous"!==i[0]?i[0]:void 0;return new e(o,(void 0),n[0],n[1],n[2],t)},this)},parseFFOrSafari:function(i){return i.stack.split("\n").filter(function(e){return!!e.match(t)},this).map(function(t){var i=t.split("@"),n=this.extractLocation(i.pop()),o=i.shift()||void 0;return new e(o,(void 0),n[0],n[1],n[2],t)},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var i=/Line (\d+).*script (?:in )?(\S+)/i,n=t.message.split("\n"),o=[],s=2,a=n.length;s<a;s+=2){var r=i.exec(n[s]);r&&o.push(new e((void 0),(void 0),r[2],r[1],(void 0),n[s]))}return o},parseOpera10:function(t){for(var i=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=t.stacktrace.split("\n"),o=[],s=0,a=n.length;s<a;s+=2){var r=i.exec(n[s]);r&&o.push(new e(r[3]||void 0,(void 0),r[2],r[1],(void 0),n[s]))}return o},parseOpera11:function(i){return i.stack.split("\n").filter(function(e){return!!e.match(t)&&!e.match(/^Error created at/)},this).map(function(t){var i,n=t.split("@"),o=this.extractLocation(n.pop()),s=n.shift()||"",a=s.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;s.match(/\(([^\)]*)\)/)&&(i=s.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var r=void 0===i||"[arguments not available]"===i?void 0:i.split(",");return new e(a,r,o[0],o[1],o[2],t)},this)}}})},function(e,t,i){var n,o,s;!function(i,a){"use strict";o=[],n=a,s="function"==typeof n?n.apply(t,o):n,!(void 0!==s&&(e.exports=s))}(this,function(){"use strict";function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e,t,i,n,o,s){void 0!==e&&this.setFunctionName(e),void 0!==t&&this.setArgs(t),void 0!==i&&this.setFileName(i),void 0!==n&&this.setLineNumber(n),void 0!==o&&this.setColumnNumber(o),void 0!==s&&this.setSource(s)}return t.prototype={getFunctionName:function(){return this.functionName},setFunctionName:function(e){this.functionName=String(e)},getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getFileName:function(){return this.fileName},setFileName:function(e){this.fileName=String(e)},getLineNumber:function(){return this.lineNumber},setLineNumber:function(t){if(!e(t))throw new TypeError("Line Number must be a Number");this.lineNumber=Number(t)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(t){if(!e(t))throw new TypeError("Column Number must be a Number");this.columnNumber=Number(t)},getSource:function(){return this.source},setSource:function(e){this.source=String(e)},toString:function(){var t=this.getFunctionName()||"{anonymous}",i="("+(this.getArgs()||[]).join(",")+")",n=this.getFileName()?"@"+this.getFileName():"",o=e(this.getLineNumber())?":"+this.getLineNumber():"",s=e(this.getColumnNumber())?":"+this.getColumnNumber():"";return t+i+n+o+s}},t})},function(e,t){function i(e){if(!e||!e.tagName)throw new TypeError("Element expected");var t=o(e).join(" > "),i=document.querySelectorAll(t);if(i.length>1)for(var n=0;n<i.length;n++)if(e===i[n]){n=[].indexOf.call(e.parentNode.children,e),t+=":nth-child("+(n+1)+")";break}return t}function n(e){var t=e.getAttribute("class");return t&&t.length?(t=t.replace(/\s+/g," "),t=t.replace(/^\s+|\s+$/g,""),t.split(" ")):[]}function o(e){var t=[],i=null,o=null,s=null,a=null,r=null;do{if(e.id)i="#"+e.id;else{i=e.tagName.toLowerCase();var l=n(e);l.length&&(i+="."+l.join("."))}(o=e.getAttribute("title"))?i+='[title="'+o+'"]':(s=e.getAttribute("alt"))?i+='[alt="'+s+'"]':(a=e.getAttribute("name"))&&(i+='[name="'+a+'"]'),(r=e.getAttribute("value"))&&(i+='[value="'+r+'"]'),t.unshift(i)}while(!e.id&&(e=e.parentNode)&&e.tagName);if(!t.length)throw new Error("Failed to identify CSS selector");return t}e.exports=i},function(e,t,i){function n(e,t){delete e.closingTweener,e.hide(),e.emit("closed",t),y.emit("closed",{id:e.id})}function o(e,t,i){i||(e.emit("opened",t),y.emit("opened",{id:e.id})),delete e.openingTweener}function s(e,t){var i=b[e];if(!i)return console.error("Invalid window: "+e);if(i.openState){i.openingTweener&&(i.openingTweener.cancel(),o(i,null,!0)),i===w&&(w=null),i.openState=!1,T=e,i.emit("close",t),y.emit("close",{id:e});var s=i.position;i.closingTweener=m.tween(i,{opacity:0,webkitTransform:"translate3d("+s.x+"px,"+s.y+"px,0) scale(0.8)"},{time:150,delay:0,easing:"ease-out"},function(){n(i,t)})}}function a(){if(M){for(var e=0,t=M.length;e<t;e+=1)s(M[e]);M=null,window.foreground.unlock("windowsManagerDialog")}}function r(e,t){if("number"==typeof e)return e;var i=e.length;return"%"===e[i-1]?t*e.substr(0,i-1)/100:("px"===e.substr(i-2)&&(e=e.substr(0,i-2)),e*=1)}function l(e,t,i){return e=e.substr(1),e?t+r(e,i):t}function c(e,t,i){var n=(t-i)/2;return l(e,n,t)}function d(e,t,i){switch(e[0]){case"c":return c(e,t,i);case"w":return l(e,t,t);case"h":return l(e,t,t);default:return r(e,t)}}function u(e){var t=0,i=0,n=0,o=0,s=h.windowFullScreenWidth||h.screenWidth,a=h.windowFullScreenHeight||h.screenHeight;if(e.isFullScreen&&(s=h.screenWidth,a=h.screenHeight),e.mustAvoidToolbar&&(s=h.screenExceptToolbar.width,a=h.screenExceptToolbar.height),e.width){t=d(e.width,s);var r=e.maxWidth||s;t=r&&r<t?r:t}if(e.height){i=d(e.height,a);var l=Math.min(e.maxHeight||a,a);i=Math.min(i,l)}if(e.minHeight){var c=d(e.minHeight,a);i=Math.max(c,i)}if(e.minWidth){var u=d(e.minWidth,a);t=Math.max(u,t)}var p=e.hasOwnProperty("left");if((p||e.hasOwnProperty("x"))&&(n=d(p?e.left:e.x,s,t)),e.hasOwnProperty("right")){var m=d(e.right,s,t);t?n=s-m-t:t=s-m-n}var f=e.hasOwnProperty("top");if((f||e.hasOwnProperty("y"))&&(o=d(f?e.top:e.y,a,i)),e.bottom){var g=d(e.bottom,a,i);i?o=a-g-i:i=a-g-o}return n=Math.min(s-t,Math.max(0,n)),o=Math.max(0,Math.min(a-i,o)),{x:Math.round(n),y:Math.round(o),width:Math.round(t),height:Math.round(i)}}i(195);var h=i(166).dimensions,p=i(188).EventEmitter,m=i(196),f=i(197),g=i(201),_=i(29).getText,v=40,y=new p,b={},M=null,w=null,T=null;y.makeMovable=function(e,t){t=t||e.windowHeadWrapper,g(t);var i,n,o,s,a,r;t.on("slideStart",function(l,c){if(!e.openState)return t.cancelSlide();var d=e.rootElement.getBoundingClientRect(),u=c.left-d.left,h=c.top-d.top;a=d.width,r=c.height+h,o=l.x-c.left+u,s=l.y-c.top+h,i=e.position.x,n=e.position.y}),t.on("slideEnd",function(){e.position.x=i,e.position.y=n,e.emit("positioned")}),t.on("slideCancel",function(){e.setStyle("webkitTransform","translate3d("+e.position.x+"px,"+e.position.y+"px,0)")}),t.on("slide",function(t){i=t.x-o,n=t.y-s,i<0?i=0:i+a>h.windowFullScreenWidth&&(i=h.windowFullScreenWidth-a),n<0?n=0:n+r>h.windowFullScreenHeight&&(n=h.windowFullScreenHeight-r),e.setStyle("webkitTransform","translate3d("+i+"px, "+n+"px, 0)")})},y.initialize=function(e){e.on("disconnect",function(){M=null,T=null}),e.on("ExchangeLeaveMessage",a),e.on("LeaveDialogMessage",a)},y.addWindow=function(e,t,i){function n(){y.focusWindow(e)}i=i||{},b[e]=t,t.id=e,i.group&&(t.group=i.group),t.hide(),t.openState=!1;var o=i.container||window.gui.windowsContainer;o.appendChild(t),t.allowDomEvents(),t.on("dom.touchstart",n),f(t.header),t.header.on("doubletap",function(){y.positionWindow(e)}),i.fixed||y.makeMovable(t)},y.open=function(e,t){if(t=t||{},"market"===e&&window.Config.disabledFeatures.shop)return void window.gui.openPopup({title:_("tablet.window.shop.title"),message:_("ui.popup.accessDenied.serviceUnavailable")});if("register"===e&&window.Config.disabledFeatures.guest)return window.gui.openPopup({title:_("ui.login.createAccount"),message:_("ui.popup.accessDenied.serviceUnavailable")}),console.error(new Error("windowsManager: register should not open"));var i=b[e];if(!i)return console.error("Invalid window: "+e);i.closingTweener&&(i.closingTweener.cancel(),n(i));var s=i.group;if(s)for(var a in b){var r=b[a];s===r.group&&r.openState&&e!==a&&this.close(a)}var l=i.positionInfo,c=i.position;if(l&&!c&&(i.position=c=u(l),i.setStyles({webkitTransform:"translate3d("+c.x+"px,"+c.y+"px,0) scale(0.8)",width:c.width+"px",height:c.height+"px",opacity:0})),l&&l.isModal||t.isModal){i.addClassNames("modal");var d=window.gui.windowsContainer.createChild("div",{className:"modalWindowOverlay"});i.once("close",function(){d.destroy()})}i.openState=!0,i.show(),this.emit("open",{id:e}),i.emit("open",t),y.focusWindow(e),c=i.position;var p=l&&l.isDefault;return p||i.initialPosition||(i.initialPosition={x:c.x,y:c.y,width:c.width,height:c.height}),c.x=Math.min(h.windowFullScreenWidth-c.width,Math.max(0,c.x)),c.y=Math.max(0,Math.min(h.windowFullScreenHeight-v,c.y)),i.openingTweener=m.tween(i,{opacity:1,webkitTransform:"translate3d("+c.x+"px,"+c.y+"px,0)  scale(1)"},{time:150,delay:0,easing:"ease-out"},function(){o(i,t)}),window.gui.splashScreen.hide(),i},y.focusWindow=function(e){var t=b[e];t.openState&&w!==t&&(w=t,t.getParent().appendChild(t),t.emit("focus"))},y.positionWindow=function(e,t){var i,n=b[e];if(t)i=u(t);else if(n.initialPosition){var o=n.initialPosition;i={x:o.x,y:o.y,width:o.width,height:o.height}}else i=u(n.positionInfo);n.position=i,n.setStyles({width:i.width+"px",height:i.height+"px",webkitTransform:"translate3d("+i.x+"px,"+i.y+"px,0) scale(1)"}),t?n.emit("positioned"):n.emit("repositioned")},y.openDialog=function(e,t){if(!M){Array.isArray(e)||(e=[e]),M=e;for(var i=0,n=e.length;i<n;i+=1)y.open(e[i],t);window.foreground.lock("windowsManagerDialog")}},y.continueDialog=function(e,t){M=null,this.openDialog(e,t)},y.isDialogActive=function(){return!!M},y.close=function(e,t){var i=t&&t.keepDialog;return!i&&M&&M.indexOf(e)!==-1?(window.dofus.sendMessage("LeaveDialogRequestMessage",null),a()):void s(e,t)},y._forceClose=function(e){return M&&M.indexOf(e)!==-1?(window.gui.isConnected&&window.dofus.sendMessage("LeaveDialogRequestMessage",null),a()):void s(e)},y.closeAll=function(){for(var e in b)"popup"!==e&&b[e].openState&&this._forceClose(e)},y["switch"]=function(e,t){var i=b[e];i.openState?i===w?this.close(e):y.focusWindow(e):this.open(e,t)},y.getWindow=function(e){return b[e]},y.moveAndResizeWindow=function(e,t,i,n,o){var s=y.getWindow(e);if(s&&s.openState){var a=s.position.x,r=s.position.y,l=s.position.width,c=s.position.height;null!==t&&void 0!==t||(t=a),null!==i&&void 0!==i||(i=r),null!==n&&void 0!==n||(n=l),null!==o&&void 0!==o||(o=c);var d="translate3d("+t+"px, "+i+"px,0)";m.tween(s,{opacity:1,webkitTransform:d,width:n+"px",height:o+"px"},{time:150,delay:0,easing:"ease-out"},function(){y.positionWindow(e,{left:t,top:i,width:n,height:o})})}},y.arrangeOpeningWindow=function(e,t){var i=t.leftOf||t.rightOf,n=y.getWindow(e),o=y.getWindow(i);if(n&&o.openState){var s,a,r,l=n.position.width,c=o.position.width,d=o.position.x,u=d;t.leftOf?(s=d-l,s<0&&(s=0,u=Math.min(l,h.screenWidth-c))):t.rightOf&&(s=d+c,s+l>h.screenWidth&&(s=h.screenWidth-l,u=Math.max(0,s-c))),t.sameHeight&&(a=n.position.height,r=n.position.y),n.position.x=s,t.height&&(n.position.height=t.height),y.positionWindow(e,n.position),(u!==d||a)&&y.moveAndResizeWindow(i,u,r,null,a)}},y.arrangeOpeningWindowVertically=function(e,t){var i=t.below,n=y.getWindow(e),o=y.getWindow(i);if(n&&o.openState){var s;t.below&&(s=o.position.y+o.position.height,t.fullHeight&&(n.position.height=h.windowFullScreenHeight-s)),n.position.x=o.position.x,n.position.y=s,t.height&&(n.position.height=t.height),y.positionWindow(e,n.position)}},y.getOpenWindows=function(){var e=[];for(var t in b)"popup"!==t&&b[t].openState&&("function"==typeof b[t].getOpenedTabId?e.push(t+" > "+b[t].getOpenedTabId()):e.push(t));return e},y.getLastClosedWindow=function(){return T},e.exports=y},function(e,t){},function(e,t){function i(e){return!!e._tween&&(e._tween.cancel(),e.emit("tweenCancelled"),!0)}t.tween=function(e,t,n,o){function s(){window.clearTimeout(p),d.removeEventListener("webkitTransitionEnd",m),p=null,d.style.webkitTransition=u,e._tween=null}function a(){f||g||(f=g=!0,s(),o=null)}i(e),n=n||{};var r=n.time||500,l=n.delay||0,c=n.easing||"ease-in-out",d=e.rootElement,u=d.style.webkitTransition,h="all "+r+"ms "+c;l&&(h+=" "+l+"ms");var p,m,f=!1,g=!1;return m=function(t){g||(g=!0,t&&t.stopPropagation(),s(),o&&(o.call(e,t),o=null))},window.setTimeout(function(){if(!f){d.style.webkitTransition=h;for(var e in t)d.style[e]=t[e];d.addEventListener("webkitTransitionEnd",m),p=window.setTimeout(m,l+r)}},0),e._tween={cancel:a},e._tween},t.cancelTween=i},function(e,t,i){function n(){this.setEnable(!0)}function o(){this.setEnable(!1)}function s(){this.isEnable()&&(this.emit("tapstart"),this.emit("tapend"),this.emit("tap"))}function a(e,t){function i(){r=null,window.clearTimeout(_),clearInterval(b),l.removeListener("dom.touchmove",m),l.removeListener("dom.touchend",g)}function a(t){r===e&&(C=!0,e.emit("tapend",t)),i()}function u(t){b=setInterval(function(){e.emit("tap")},t)}function m(e){var t=c(e);(t.x<y.left||t.x>y.left+y.width||t.y<y.top||t.y>y.top+y.height)&&a(t)}function f(t){b=null,v=c(t),r||!T||v.touchCount>1||(r=e,C=!1,y=e.rootElement.getBoundingClientRect(),e.emit("tapstart",v,y),window.clearTimeout(_),_=window.setTimeout(function(){A?u(A):e.emit("longtap",v)},h),l.on("dom.touchmove",m),l.on("dom.touchend",g),d.recordActivity())}function g(t){if(!C){var n=e!==r;if(i(),!n){var o=c(t);if(e.emit("tapend",o),!b){var s=Date.now();!A&&w&&M>=s-w?e.emit("doubletap",o):e.emit("tap",o),w=s}}}}if(!e._tapBehavior){t=t||{},e._tapBehavior=!0,e.allowDomEvents();var _,v,y,b,M=t.doubletapTimeout||p,w=0,T=!0,C=!1,A=t.repeatDelay;e.setEnable=function(t){"boolean"!=typeof t&&console.error(new Error("tapBehavior: setEnable has been called with an undefined param")),T=t,e.emit("enable",t)},e.isEnable=function(){return T},e.enable=n,e.disable=o,e.tap=s,e.cancelTap=a,e.on("dom.touchstart",f)}}var r,l,c=i(198).getPosition,d=i(199),u=i(200),h=400,p=200;e.exports=a,a.initialize=function(e){l=e,u.on("handleTaken",function(){r&&r.cancelTap()})}},function(e,t){var i=!1;"ontouchstart"in window&&(i=!0);var n,o={x:0,y:0};n=i?function(e){var t=e.touches||[],i=t.length;if(0===i)return{x:o.x,y:o.y,touches:[],touchCount:0};for(var n=[],s=0;s<i;s+=1)n.push({x:t[s].clientX,y:t[s].clientY});return o.x=t[0].clientX,o.y=t[0].clientY,{x:o.x,y:o.y,touches:n,touchCount:i}}:function(e){return o.x=e.clientX,o.y=e.clientY,{x:o.x,y:o.y,touchCount:"mouseup"===e.type?0:1,touches:[{x:o.x,y:o.y}]}},e.exports={canTouch:i,getPosition:n,position:o,events:{start:i?"touchstart":"mousedown",move:i?"touchmove":"mousemove",end:i?"touchend":"mouseup"}}},function(e,t,i){function n(){o.call(this),this.isListening=!1,this.isConnected=!1,this.pingInterval=null,this.activityInterval=null,this.isInactive=!1,this.hasSeenActivity=!1,this.lastActivityTime=null}var o=i(175).EventEmitter,s=i(29).getText,a=i(172).inherits,r=6e5,l=3e5,c=6e5,d=12e4,u=1e3;a(n,o),e.exports=new n,n.prototype.initialize=function(e){var t=this,i=window.dofus.connectionManager;i.on("ServersListMessage",function(){t._start()}),e.on("connected",function(){t.isConnected=!0}),e.on("disconnect",function(){t.isConnected=!1,t._stop()}),e.on("appGoBackground",function(){t._stop()}),e.on("connectedAfterAppLeaveBackground",function(){t.isListening||t._start()})},n.prototype._start=function(){this.isListening||(this.isListening=!0,this.activityInterval=window.setInterval(function(e){e._checkActivity()},d,this),this.pingInterval=window.setInterval(function(e){e._pingServer()},r,this),this.isInactive=!1,this.hasSeenActivity=!1,this.lastActivityTime=Date.now())},n.prototype._stop=function(){this.isListening&&(this.isListening=!1,window.clearInterval(this.activityInterval),window.clearInterval(this.pingInterval))},n.prototype.recordActivity=function(){this.hasSeenActivity=!0,this.lastActivityTime=Date.now(),this.isInactive&&this.isListening&&this._leaveInactiveMode()},n.prototype.isActiveSince=function(e){return this.lastActivityTime>=e},n.prototype._checkActivity=function(){var e=Date.now()-this.lastActivityTime+u;e<l||(this.isInactive?e>=c&&window.dofus.disconnect("INACTIVITY"):this._enterInactiveMode())},n.prototype._pingServer=function(){this.hasSeenActivity&&(this.hasSeenActivity=!1,window.dofus.sendMessage("BasicPingMessage",{quiet:!0}))},n.prototype._enterInactiveMode=function(){this.isInactive=!0,this.isConnected&&this.emit("inactive",!0),window.gui.openSimplePopup(s("ui.common.inactivityWarning"),s("ui.popup.warning"))},n.prototype._leaveInactiveMode=function(){this.isInactive=!1,this.isConnected?this.emit("inactive",!1):this._pingServer()}},function(e,t,i){var n,o,s=i(198),a=s.events,r=s.getPosition,l=i(188).EventEmitter,c=e.exports=new l;document.body.addEventListener(a.start,function(){o||(o=!0,n=null)},!0),document.body.addEventListener(a.start,function(){n&&c.emit("handleTaken",n)},!1),document.body.addEventListener(a.end,function(e){0===r(e).touchCount&&(n=null,o=!1)}),c.isHandleFree=function(){return null===n},c.hasHandle=function(e){return n===e},c.requestInteractionHandle=function(e){return n?n===e:(n=e,c.emit("handleTaken",n),!0)},c.abortInteraction=function(){n=null}},function(e,t,i){function n(e,t){var i=Math.abs(e);return i>10&&i/t>.65}function o(e,t){function i(e){u="vertical"===e?"y":"x"}function o(e){y=s(e),y.x-=g.left,y.y-=g.top}function l(t){if(o(t),m){if(1!==y.touchCount)return;return e.emit("slide",y),e.slideOut=y.x<0||y.x>g.width||y.y<0||y.y>g.height,void(e.slideOut?_||(_=!0,e.emit("slideOut",y)):(e.emit("slideIn",y),_=!1))}var i=y.x-h.x,n=y.y-h.y,s=Math.sqrt(i*i+n*n);if(!(s<r))return Math.abs(n)>Math.abs(i)?void(u&&"y"!==u||!a(e)?e.cancelSlide():(m=!0,e.isSliding=!0,e.emit("slideStart",y,g))):void(u&&"x"!==u||!a(e)?e.cancelSlide():(m=!0,e.isSliding=!0,e.emit("slideStart",y,g)))}function c(t){if(o(t),!(y.touchCount>0)){if(m){e.isSliding=!1;var i,s=Date.now()-f;i=u?n(y[u]-h[u],s):n(y.x-h.x,s)&&"x"||n(y.y-h.y,s)&&"y",e.emit("slideEnd",y,h,i)}p=m=!1,window.gui.wBody.removeListener("dom.touchmove",l),window.gui.wBody.removeListener("dom.touchend",c),window.gui.wBody.removeListener("dom.touchcancel",d)}}function d(){e.isSliding=!1,m&&e.emit("slideCancel",y,h,!1),p=m=!1,window.gui.wBody.removeListener("dom.touchmove",l),window.gui.wBody.removeListener("dom.touchend",c),window.gui.wBody.removeListener("dom.touchcancel",d)}if(!e._slideBehavior){e._slideBehavior=!0,e.allowDomEvents();var u,h,p,m,f,g,_,v=!1,y={};t&&i(t),e.setSlideDirection=i,e.isSliding=!1,e.slideOut=!1,e.lockSlide=function(e){v=e},e.cancelSlide=d,e.on("dom.touchstart",function(t){p||v||(g=e.rootElement.getBoundingClientRect(),o(t),f=Date.now(),e.slideOut=!1,p=!0,h={x:y.x,y:y.y},window.gui.wBody.on("dom.touchmove",l),window.gui.wBody.on("dom.touchend",c),window.gui.wBody.on("dom.touchcancel",d))})}}var s=i(198).getPosition,a=i(200).requestInteractionHandle,r=5;e.exports=o},function(e,t,i){function n(e){if(0!==e.length){var i=e.shift();setTimeout(function(){n(e),t.emit(i._messageType,i)},0)}}var o=i(188).EventEmitter,s=i(203).monitor;t=e.exports=new o,t.setMaxListeners(0);var a,r,l,c,d,u=[],h=0,p=[],m=!1;t.lockMessages=function(){m=!0},t.lastReceivedMessage=null,t.unlockMessages=function(){if(m!==!1){m=!1;var e=p.slice();n(e),p.length=0}},t.connect=function(e){if(a)return a.destroy(),a=null,setTimeout(function(){t.connect(e)},0);var i=window.Primus,n=window.Config.maxReconnectionAttempt||10;d=!1,l=!0,r=!1,c=!0,a=new i(e,{manual:!0,strategy:"disconnect,timeout",reconnect:{max:5e3,min:500,retries:n}}),s.startListening(),a.on("open",function(){return a!==this?console.warn("onOpen - Ignoring event: possible missing call to Primus#destroy"):(d=!1,t.emit("open",r),void(r=!0))}),a.on("offline",function(){c&&(c=!1,l&&t.emit("offline"))}),a.on("online",function(){return a!==this?console.warn("onOnline - Ignoring event: possible missing call to Primus#destroy"):void(c||(c=!0,l&&(t.emit("online"),a.readyState!==i.CLOSED||a.recovery.reconnecting()||window.setTimeout(function(){a.readyState!==i.CLOSED||a.recovery.reconnecting()||a.open()},0))))}),a.on("end",function(){c&&(a=null,d||(l=!1,t.disconnect("SOCKET_LOST")))}),a.on("reconnect scheduled",function(i){t.emit("reconnecting",i.attempt,e)}),a.on("data",function(e){if(s.receiving(),"SequenceStartMessage"===e._messageType&&(h+=1),h>0){if(u.push(e),"SequenceEndMessage"===e._messageType&&(h-=1,h<=0)){var i={_messageType:"messageSequence",sequence:u};m?p.push(i):t.emit("messageSequence",i),u=[],h=0}}else t.emit("data",e),t.lastReceivedMessage=e._messageType,m?p.push(e):t.emit(e._messageType,e)}),a.on("error",function(e){t.emit("error",e)}),a.open()},t.close=function(){d=!0,l=!1,a&&(a.destroy(),a=null)},t.disconnect=function(e){e=e||"CLIENT_CLOSING",console.info("connectionManager.disconnect: reason="+e),"SOCKET_LOST"!==e&&a&&t.send("disconnecting",e),t.close(),t.emit("disconnect",e)},t.sendMessage=function(e,i){t.send("sendMessage",{type:e,data:i})},t.send=function(e,i){if(!a)return console.warn("Client trying to send while primus is null for call: "+e);s.sending(e,i);var n={call:e,data:i};a.write(n),t.emit("send",{call:e,data:n}),t.emit("send:"+e,n)}},function(e,t){function i(){this.lastReceivingTime=0,this.lastPingSent=0,this.isListening=!1,this.timeout=null,this.alarmLevel=r}function n(e){e.timeout=null,e._sendPing();var t=e.lastReceivingTime;window.setTimeout(function(){e.lastReceivingTime===t&&window.gui.connectionSplashScreen.onStateChange("UNSTABLE",e.alarmLevel);
},s)}var o=1e3,s=300,a=1e3,r=0,l=1,c=2,d={AchievementRewardRequestMessage:l,AllianceChangeGuildRightsMessage:l,AllianceFactsRequestMessage:l,AllianceInsiderInfoRequestMessage:l,AllianceKickRequestMessage:l,BasicWhoIsRequestMessage:l,ChangeMapMessage:l,ChatClientMultiMessage:l,ChatClientPrivateMessage:l,CharacterCreationRequestMessage:c,CharacterDeletionRequestMessage:l,CharacterNameSuggestionRequestMessage:l,CharacterSelectionMessage:c,ExchangeBidHouseBuyMessage:c,ExchangeBidHouseListMessage:l,ExchangeBidHouseTypeMessage:l,ExchangeBuyMessage:c,ExchangeHandleMountStableMessage:l,ExchangeObjectMoveMessage:l,ExchangeObjectMovePricedMessage:l,ExchangePlayerRequestMessage:l,ExchangeRequestOnShopStockMessage:l,ExchangeSellMessage:c,ExchangeShowVendorTaxMessage:l,ExchangeStartAsVendorMessage:c,FriendAddRequestMessage:l,FriendDeleteRequestMessage:l,GameMapMovementRequestMessage:l,GameRolePlayArenaRegisterMessage:l,GameRolePlayArenaUnregisterMessage:l,GameRolePlayPlayerFightRequestMessage:l,GuildChangeMemberParametersMessage:l,GuildCharacsUpgradeRequestMessage:c,GuildFactsRequestMessage:l,GuildGetInformationsMessage:l,GuildHouseTeleportRequestMessage:l,GuildKickRequestMessage:l,GuildPaddockTeleportRequestMessage:l,GuildSpellUpgradeRequestMessage:c,HouseGuildRightsViewMessage:l,HouseGuildShareRequestMessage:l,HouseKickRequestMessage:l,HouseLockFromInsideRequestMessage:l,IgnoredAddRequestMessage:l,InteractiveUseRequestMessage:l,JobAllowMultiCraftRequestSetMessage:l,JobCrafterDirectoryDefineSettingsMessage:l,LeaveDialogRequestMessage:l,LockableChangeCodeMessage:l,MountFeedRequestMessage:l,MountReleaseRequestMessage:l,MountRenameRequestMessage:l,MountSetXpRatioRequestMessage:l,MountSterilizeRequestMessage:l,MountToggleRidingRequestMessage:l,NpcDialogReplyMessage:l,NpcGenericActionRequestMessage:l,ObjectSetPositionMessage:l,ObjectUseMessage:c,OrnamentSelectRequestMessage:l,PartyAbdicateThroneMessage:l,PartyAcceptInvitationMessage:l,PartyCancelInvitationMessage:l,PartyInvitationArenaRequestMessage:l,PartyInvitationRequestMessage:l,PartyKickRequestMessage:l,PartyLeaveRequestMessage:l,PrismSettingsRequestMessage:l,ServerSelectionMessage:c,SetEnableAVARequestMessage:l,SetEnablePVPRequestMessage:l,SpellUpgradeRequestMessage:c,StatsUpgradeRequestMessage:c,TitleSelectRequestMessage:l},u={almanaxDataRequest:l};t.monitor=new i,t.WARNING=l,t.BLOCKING=c,i.prototype.startListening=function(){this.isListening||(this.isListening=!0,window.dofus.connectionManager.on("BasicPongMessage",this._gotPong.bind(this)))},i.prototype.receiving=function(){this.lastReceivingTime=Date.now(),this.timeout&&(this.alarmLevel=r,this.timeout=window.clearTimeout(this.timeout))},i.prototype.sending=function(e,t){var i;i="sendMessage"===e?d[t.type]:u[e],i&&this._monitorCommandDelay(i)},i.prototype._monitorCommandDelay=function(e){this.alarmLevel=Math.max(e,this.alarmLevel),this.timeout||(this.timeout=window.setTimeout(n,o,this))},i.prototype._sendPing=function(){Date.now()-this.lastPingSent>=a&&(window.dofus.sendMessage("BasicPingMessage",{quiet:!0}),this.lastPingSent=Date.now())},i.prototype._gotPong=function(){this.lastPingSent=0,window.gui.connectionSplashScreen.onStateChange("CONNECTED")}},function(e,t,i){function n(e){if(e.reason){if(e.reason===u.INCOMPATIBLE_APP_VERSION){var t,i;return r.isAndroidApp?(t=l("tablet.ui.popup.accessDenied.incompatibleAppAndroid"),i="market://details?id=com.ankama.dofustouch"):r.isIOSApp?(t=l("tablet.ui.popup.accessDenied.incompatibleAppIOS"),i="https://itunes.apple.com/app/id1041406978"):t=l("tablet.ui.popup.accessDenied.incompatibleApp"),void window.gui.openConfirmPopup({title:l("ui.popup.accessDenied"),message:t,cb:function(e){e&&i&&window.open(i,"_system","location=no")}})}if(e.reason===u.INCOMPATIBLE_BUILD_VERSION)return t=l("tablet.ui.popup.accessDenied.incompatibleBuild"),void window.gui.openConfirmPopup({title:l("ui.popup.accessDenied"),message:t,noDisable:!0,cb:function(e){e&&window.location.reload()}});window.gui.openSimplePopup(c(e),l("ui.popup.accessDenied"))}else window.gui.openSimplePopup(l("ui.popup.connectionFailed.text")),console.warn("login error without reason:",e)}function o(e,i,o){function r(a,r){return a?(window.gui.openSimplePopup(d(a),l("ui.popup.accessDenied")),o(a)):(window.dofus.setCredentials(i.account||r.username,r.token),window.gui.playerData.setLoginName(r.username),t.connectMethod=e,void window.dofus.login(function(e){return h=!1,e?(window.dofus.disconnect(),n(e)):(t.lastServerId=s.getValue("lastServerId"),o())}))}if(i=i||{},o=o||function(e){if(e)return console.error(e)},window.Config.byPassToken)return void r(null,{username:i.account,token:i.password});if(i.account){var c=i.account,u=c.split("|"),p=2===u.length;p&&(c=u[0]),window.gui.playerData.setForcedAccount(p),a.login(c,i.password,i.save,r)}else a.login(r)}var s=i(176),a=i(205),r=i(168),l=i(29).getText,c=i(207),d=i(209),u=i(210),h=!1;t.characterId=null,t.connectMethod=null,t.lastServerId=null,t.startLoginProcessWithPassword=function(e,t,i,n,s){o(e,{account:t,password:i,save:n},s)},t.startLoginProcessWithoutPassword=function(e,t){o(e,{},t)},t.reconnectByCharId=function(e){t.characterId=e,h=!0,window.dofus.disconnect(),window.gui._shutDownUI(),t.startLoginProcessWithoutPassword("characterId")},t.selectServer=function(e){var i=s.getValue("lastServerId");i!==e&&s.setValue("lastServerId",e),t.lastServerId=e},t.backToLogin=function(){h||window.gui.loginScreen.backToLogin()},t.goBackToSelectionOf=function(e){window.gui.splashScreen.show(),window.gui.loginScreen.hide(),h=!0,window.dofus.disconnect();var i="character"===e?"lastServer":null;t.startLoginProcessWithoutPassword(i)},t.onFullReconnection=function(){window.gui.splashScreen.show(),window.gui.loginScreen.hide(),t.connectMethod="lastCharacter"}},function(e,t,i){function n(e){if(e.status<400||e.status>599)return e;var t=new Error(e.statusText);throw t.response=e,t}function o(e){try{return window.localStorage.setItem("HAAPI_USERNAME",e),p=e,e}catch(t){return!1}}function s(e,t){if(t=t||{},h=e,!t.save)return e;try{if(!e)return window.localStorage.removeItem("HAAPI_KEY"),window.localStorage.removeItem("HAAPI_KEY_TIMEOUT"),e;var i=e?Date.now()+v:null;window.localStorage.setItem("HAAPI_KEY",e),window.localStorage.setItem("HAAPI_KEY_TIMEOUT",t.timeout||i)}catch(n){return m.warning("Failed to store HAAPI_KEY in local storage:",n),null}return e}function a(){var e=Date.now(),t=window.localStorage.getItem("HAAPI_KEY"),i=window.localStorage.getItem("HAAPI_KEY_TIMEOUT");return!t||!i||i<e?s(null,{save:!0}):s(t,{save:!1})}function r(){return h?h:a()}function l(e,t){e.then(n).then(function(e){e.json().then(function(i){if(i._statusCode||e.status>599)throw i;t(null,i)})["catch"](t)})["catch"](t)}function c(e,t,i){var n=window.Config.dataUrl;e=n+e;var o=f.stringify(t);l(window.fetch([e,o].join("?")),i)}function d(e,t,i){var n=r(),o=window.Config.haapi.url;e=o+e;var s={Accept:"application/json"};n&&(s.APIKEY=n);var a=f.stringify(t);l(window.fetch([e,a].join("?"),{headers:s}),i)}function u(e,t,i){var n=r(),o=window.Config.haapi.url;e=o+e;var s={Accept:"application/json"};n&&(s.apikey=n),l(window.fetch(e,{method:"post",headers:s,body:f.stringify(t)}),i)}var h,p,m=i(186).logger,f=i(38),g=i(176),_=i(206),v=2592e6,y=7e3;t.hasKeyFromStorage=function(){return!!a()},t.hasKey=function(){return!!r()},t.getHaapiKey=r,t.resetHaapiKey=function(){s(null,{save:!0})},t.getHaapiUsername=function(){return p?p:p=window.localStorage.getItem("HAAPI_USERNAME")},t.createGuest=function(e){return window.Config.disabledFeatures.guest?e({error:"createGuest: guest is disabled"}):void _.open({uri:window.Config.haapi.url+"/Account/CreateGuest",requestType:"GET",timeout:y,params:{game:window.Config.haapi.id,lang:window.Config.language}},function(t,i){var n={};if(i.content)try{n=JSON.parse(i.content)}catch(o){return e({error:"createGuest: unable to parse JSON ("+i.content+")"})}if(t)return e({error:t+" (status code: "+i.xhr.status+")",userError:i.xhr.status&&i.xhr.status>=600&&n?n.text:null});var s={login:n.login,password:i.headers&&i.headers["X-Password"]};return s.login&&s.password?(g.setValue("guestAccount",s,1),e(null,s)):e({error:"createGuest: wrong credential (login:"+s.login+"/password:"+s.password+")"})})},t.validateGuest=function(e,t){return window.Config.disabledFeatures.guest?t(new Error("validateGuest: guest is disabled")):(e.lang=window.Config.language,void c("/haapi/validateGuest",e,t))},t.createApiKey=function(e,t){u("/Api/CreateApiKey",e,t)},t.createToken=function(e){d("/Account/CreateToken",{game:window.Config.haapi.id},e)},t.login=function(e,i,n,a){function l(t,i){return t?a(t):(o(e),i.username=e,a(null,i))}return 1===arguments.length?(a=e,e=t.getHaapiUsername(),r()?t.createToken(l):a({reason:"NOKEY"})):(e=e.trim(),void t.createApiKey({login:e,password:i,long_life_token:n},function(e,i){if(e)return a(e);var o=new Date(i.expiration_date).getTime();return s(i.key,{save:n,timeout:o}),t.createToken(l)}))},t.getForumTopicsList=function(e){var t=window.Config.language;c("/haapi/getForumTopicsList",{lang:t},e)},t.getForumPostsList=function(e,t){var i=window.Config.language;c("/haapi/getForumPostsList",{lang:i,topicId:e},t)},t.getNewsList=function(e,t){var i=window.Config.language;c("/haapi/getNewsList",{lang:i,count:e},t)}},function(e,t,i){function n(){try{return new window.XMLHttpRequest}catch(e){}try{return new window.ActiveXObject("Msxml3.XMLHTTP")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}return null}function o(e){var t={};if(!e)return t;for(var i=e.split("\r\n"),n=0;n<i.length;n++){var o=i[n],s=o.indexOf(": ");if(s>0){var a=o.substring(0,s),r=o.substring(s+2);t[a]=r}}return t}var s=i(38),a=["POST","GET"],r=1e4;t.open=function(e,t){function i(){try{var e=this.readyState,i=this.status}catch(n){return t("caught Exception: "+n.description,{xhr:this})}if(4===e){if(i<200||i>=300)return t("there was a problem with the request",{xhr:this});var s={content:this.responseText,headers:o(this.getAllResponseHeaders()),xhr:this};return t(null,s)}}var l=function(e,i){setTimeout(t,0,e,i)};if(!e)return l("no options provided",{xhr:{}});var c=e.requestType||"GET";if(a.indexOf(c)===-1)return l('unsupported request type "'+c+'"',{xhr:{}});var d=n();if(!d)return l("unable to retrieve browser XMLHttpRequest object",{xhr:{}});var u=e.uri,h="string"==typeof e.params?e.params:s.stringify(e.params),p=e.timeout||r;"GET"===c&&h&&(u=u+"?"+h,h=null),d.timeout=p,d.onreadystatechange=i,d.open(c,u,!0),d.send(h)}},function(e,t,i){function n(e){return"v"+[e.major,e.minor,e.release].join(".")}var o=i(208),s=i(29).getText;e.exports=function(e){switch(e.reason!==o.WRONG_CREDENTIALS&&e.reason!==o.BANNED&&e.reason!==o.IN_MAINTENANCE&&e.reason!==o.BAD_IPRANGE&&console.error("Identification failed:",e),e.reason){case o.BAD_VERSION:return e.requiredVersion?s("ui.popup.accessDenied.badVersion",n(e.currentVersion),n(e.requiredVersion)):s("ui.popup.accessDenied.badVersion");case o.WRONG_CREDENTIALS:return s("ui.popup.accessDenied.wrongCredentials");case o.BANNED:return e.banEndDate?s("ui.popup.accessDenied.bannedWithDuration",new Date(e.banEndDate)):s("ui.popup.accessDenied.banned");case o.KICKED:return s("ui.popup.accessDenied.kicked");case o.IN_MAINTENANCE:return s("ui.popup.accessDenied.inMaintenance");case o.TOO_MANY_ON_IP:return s("ui.popup.accessDenied.toomanyonip");case o.TIME_OUT:return s("ui.popup.accessDenied.timeout");case o.BAD_IPRANGE:return s("ui.popup.accessDenied.badIpRange");case o.CREDENTIALS_RESET:return s("ui.popup.accessDenied.credentialsReset");case o.EMAIL_UNVALIDATED:return s("ui.popup.accessDenied.unvalidatedEmail");case o.SERVICE_UNAVAILABLE:return s("ui.popup.accessDenied.serviceUnavailable");default:return s("ui.popup.accessDenied.unknown")}}},function(e,t){e.exports={BAD_VERSION:1,WRONG_CREDENTIALS:2,BANNED:3,KICKED:4,IN_MAINTENANCE:5,TOO_MANY_ON_IP:6,TIME_OUT:7,BAD_IPRANGE:8,CREDENTIALS_RESET:9,EMAIL_UNVALIDATED:10,SERVICE_UNAVAILABLE:53,UNKNOWN_AUTH_ERROR:99,SPARE:100}},function(e,t,i){var n=i(29).getText;e.exports=function(e){switch("FAILED"!==e.reason&&"OTPTIMEFAILED"!==e.reason&&console.error("Haapi identification failed:",e),e.reason){case"NOTOKEN":return n("ui.popup.accessDenied.notoken");case"BAN":return n("ui.popup.accessDenied.banned");case"BLACKLIST":return n("tablet.ui.popup.accessDenied.blacklist");case"LOCKED":return n("tablet.ui.popup.accessDenied.locked");case"DELETED":return n("tablet.ui.popup.accessDenied.deleted");case"OTPTIMEFAILED":return n("tablet.ui.popup.accessDenied.otptimefailed");case"BRUTEFORCE":return n("tablet.ui.popup.accessDenied.bruteForceDetected");case"FAILED":return n("ui.popup.accessDenied.wrongCredentials");case"MAILNOVALID":return n("ui.popup.accessDenied.unvalidatedEmail");case"BETACLOSED":return n("tablet.ui.popup.accessDenied.betaClosed");default:return n("ui.popup.accessDenied.unknown")}}},function(e,t){e.exports={INCOMPATIBLE_APP_VERSION:"INCOMPATIBLEAPPVERSIONS",INCOMPATIBLE_BUILD_VERSION:"INCOMPATIBBUILDLEVERSIONS"}},function(e,t,i){i(212),i(213),i(214),i(215),i(216),i(217),i(218),i(219),i(222),i(223),i(224),i(225),i(226),i(227),i(228),i(229),i(230),i(231),i(232),i(233),i(234),i(235),i(236),i(236),i(237),i(238),i(239),i(240),i(241),i(242),i(243),i(244),i(245),i(246),i(260),i(261),i(262),i(263),i(264),i(265),i(266),i(267),i(268),i(269),i(270),i(271),i(272),i(273),i(274),i(275),i(276),i(277),i(278),i(279),i(280),i(281),i(282),i(283),i(284),i(285),i(286),i(287),i(288),i(289),i(290),i(291),i(292),i(293),i(294),i(295),i(296),i(297),i(298),i(299),i(300),i(301),i(302),i(303),i(304),i(305),i(306),i(307)},function(e,t,i){var n=i(202);n.on("_ErrorPopupMessage",function(e){window.gui.openSimplePopup(e.text,e.title)})},function(e,t,i){var n=i(202);n.on("ConsoleMessage",function(e){window.gui.transmitMessage(e)}),n.on("ConsoleCommandsListMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t){},function(e,t,i){var n=i(202);n.on("IdentificationSuccessMessage",function(e){window.gui.transmitMessage(e)}),n.on("IdentificationSuccessWithLoginTokenMessage",function(e){window.gui.transmitMessage(e)}),n.on("ServersListMessage",function(e){window.gui.transmitMessage(e)}),n.on("ServerStatusUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("SelectedServerRefusedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AuthenticationTicketAcceptedMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("NicknameRegistrationMessage",function(e){window.gui.transmitMessage(e)}),n.on("NicknameRefusedMessage",function(e){window.gui.transmitMessage(e)}),n.on("NicknameAcceptedMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("AcquaintanceSearchErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n,o=i(220),s=i(221),a=i(202);a.on("DebugHighlightCellsMessage",function(e){for(var t={},i=0,a=0;a<e.cells.length;a++){var r=e.cells[a];t[r]=new o(r,i,s.fullRed)}window.background.removeGridLayer(n),n=window.background.addGridAnimation(t),window.setTimeout(function(){window.background.removeGridLayer(n)},5e3)}),a.on("DebugClearHighlightCellsMessage",function(){n&&window.background.removeGridLayer(n)}),a.on("DebugInClientMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){function i(e,t,i){this.cellId=e,this.distanceToPlayer=t,this.transformState=i}e.exports=i},function(e,t){function i(e,t,i,n,o,s){this.sx=e,this.sy=t,this.r=i,this.g=n,this.b=o,this.a=s}t.empty=new i(.1,.1,.5,.5,.5,0),t.fullRed=new i(.78,.78,.8,.12,.08,.8),t.fullGreen=new i(.78,.78,0,1,.22,.7),t.fullBlue=new i(.78,.78,0,.51,.91,.8),t.walkable=new i(.9,.9,1,.92,0,.5),t.unwalkable=new i(.9,.9,.9,0,0,.8),t.walkableLast=new i(.9,.9,1,1,0,.8),t.inSight=new i(.78,.78,0,0,1,.5),t.outSight=new i(.78,.78,.6,.6,1,.5),t.areaOfEffect=new i(.78,.78,1,0,0,.9),t.inSightEnemyTurn=new i(.78,.78,.3,.3,.3,.8),t.outSightEnemyTurn=new i(.78,.78,.5,.5,.5,.7),t.areaOfEffectEnemyTurn=new i(.78,.78,1,1,1,1),t.blueTeamStart=new i(1,1,0,0,1,.5),t.blueTeamEnd=new i(.95,1,.1,.4,.8,.45),t.redTeamStart=new i(1,1,1,0,0,.5),t.redTeamEnd=new i(.95,1,.8,.4,.1,.45),t.walkArea=new i(1,1,0,.9,.02,.3),t.walkAreaRequiresAP=new i(1,1,0,.43,.4,.4),t.walkAreaRestricted=new i(1,1,1,0,0,.4),t.enemyWalkArea=new i(1,1,.1,.9,.032,.6),t.enemyWalkAreaRequiresAP=new i(1,1,.1,.435,.4,.6),t.enemyWalkAreaRestricted=new i(.9,.9,1,0,0,.6),t.TransformState=i},function(e,t,i){var n=i(202);n.on("AchievementListMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementDetailsMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementDetailedListMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementFinishedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementRewardSuccessMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementRewardErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(202);n.on("GameActionFightNoSpellCastMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameActionFightPointsVariationMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameActionFightDeathMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightKillMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightLifePointsGainMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightLifePointsLostMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightLifeAndShieldPointsLostMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightDispellableEffectMessage",function(e){console.error("GameActionFightDispellableEffectMessage received outside of sequence:",e)}),n.on("GameActionFightSlideMessage",function(e){window.actorManager.actorMovement({actorId:e.targetId,keyMovements:[e.startCellId,e.endCellId],slide:!0})}),n.on("GameActionFightTeleportOnSameMapMessage",function(e){window.actorManager.setActorsDisposition([{id:e.targetId,cellId:e.cellId}])}),n.on("GameActionFightExchangePositionsMessage",function(e){window.actorManager.setActorsDisposition([{id:e.sourceId,cellId:e.casterCellId},{id:e.targetId,cellId:e.targetCellId}])}),n.on("GameActionFightSummonMessage",function(e){window.actorManager.addActor(e.summon)})},function(e,t,i){var n=i(202);n.on("messageSequence",function(e){window.isoEngine.transmitMessage(e),window.gui.emit("checkServerLag","fightAction","stop")})},function(e,t,i){var n=i(202);n.on("AllianceCreationStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceModificationStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceCreationResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceInvitedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceInvitationStateRecruterMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceInvitationStateRecrutedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceJoinedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceGuildLeavingMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceLeftMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceMembershipMessage",function(e){window.gui.transmitMessage(e)}),n.on("KohUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceFactsErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceFactsMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceInsiderInfoMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("AccountLoggingKickedMessage",function(){window.gui.disconnect("AccountLoggingKickedMessage"),window.isoEngine.disconnect()}),n.on("ServerSettingsMessage",function(e){window.gui.transmitMessage(e)}),n.on("ServerSessionConstantsMessage",function(e){window.gui.transmitMessage(e)}),n.on("ServerOptionalFeaturesMessage",function(e){window.gui.transmitMessage(e)}),n.on("AccountCapabilitiesMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("AtlasPointInformationsMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("CompassResetMessage",function(e){window.gui.transmitMessage(e)}),n.on("CompassUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("CompassUpdatePartyMemberMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("BasicTimeMessage",function(e){window.gui.transmitMessage(e)}),n.on("BasicWhoIsNoMatchMessage",function(e){window.gui.transmitMessage(e)});var o=262,s=12,a=50;n.on("BasicLatencyStatsRequestMessage",function(){n.sendMessage("BasicLatencyStatsMessage",{latency:o,sampleCount:s,max:a})});var r=0;n.on("send:login",function(){r=0}),n.on("SequenceNumberRequestMessage",function(){r+=1,n.sendMessage("SequenceNumberMessage",{number:r})})},function(e,t,i){var n=i(202);n.on("CharacterCreationResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("CharacterNameSuggestionSuccessMessage",function(e){window.gui.transmitMessage(e)}),n.on("CharacterNameSuggestionFailureMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("CharacterDeletionErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(202);n.on("CharacterStatsListMessage",function(e){window.gui.transmitMessage(e)}),n.on("FighterStatsListMessage",function(e){window.isoEngine.sendToFightSequence(e)}),n.on("CharacterLevelUpMessage",function(e){window.gui.transmitMessage(e),window.isoEngine.playLevelUpAnimation(window.gui.playerData.id)}),n.on("CharacterLevelUpInformationMessage",function(e){var t=e.id;t!==window.gui.playerData.id&&window.isoEngine.playLevelUpAnimation(t)}),n.on("UpdateLifePointsMessage",function(e){window.gui.transmitMessage(e)}),n.on("LifePointsRegenBeginMessage",function(e){window.gui.transmitMessage(e)}),n.on("LifePointsRegenEndMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t){},function(e,t,i){var n=i(202);n.on("ChatSmileyMessage",function(e){window.gui.playerData.socialData.isIgnored(e.accountId)||window.actorManager.addSmileyOnActor(e.entityId,e.smileyId)}),n.on("MoodSmileyResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("MoodSmileyUpdateMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202),o=i(220),s=i(221);n.on("GameContextDestroyMessage",function(e){window.isoEngine.transmitMessage(e),window.actorManager.resetActors(),window.gui.transmitMessage(e)}),n.on("GameContextRemoveElementMessage",function(e){window.actorManager.removeActor(e.id)}),n.on("GameContextRemoveMultipleElementsMessage",function(e){window.actorManager.removeActors(e.id)}),n.on("GameContextRemoveElementWithEventMessage",function(e){window.actorManager.removeActor(e.id)}),n.on("GameContextRemoveMultipleElementsWithEventsMessage",function(e){window.actorManager.removeActors(e.id)}),n.on("GameContextRefreshEntityLookMessage",function(e){window.actorManager.setActorLook(e.id,e.look),window.gui.transmitMessage(e)}),n.on("GameMapNoMovementMessage",function(){window.isoEngine.noMovement()}),n.on("GameMapMovementMessage",function(e){window.actorManager.actorMovement(e)}),n.on("GameMapChangeOrientationMessage",function(e){window.actorManager.setActorsDisposition([e.orientation])}),n.on("GameMapChangeOrientationsMessage",function(e){window.actorManager.setActorsDisposition(e.orientations)}),n.on("GameEntityDispositionMessage",function(e){window.actorManager.setActorsDisposition([e.disposition])}),n.on("GameEntitiesDispositionMessage",function(e){window.actorManager.setActorsDisposition(e.dispositions,!0)}),n.on("ShowCellMessage",function(e){var t={},i=0;t[e.cellId]=new o(e.cellId,i,s.fullRed);var n=window.background.addGridAnimation(t);window.setTimeout(function(){window.background.removeGridLayer(n)},5e3)}),n.on("ShowCellSpectatorMessage",function(e){for(var t={},i=0,n=0;n<e.cells.length;n++){var a=e.cells[n];t[a]=new o(a,i,s.fullRed)}var r=window.background.addGridAnimation(t);window.setTimeout(function(){window.background.removeGridLayer(r)},5e3)})},function(e,t,i){function n(e){window.isoEngine.displayNumericalValue(e)}var o=i(202);o.on("DisplayNumericalValueMessage",n),o.on("DisplayNumericalValueWithAgeBonusMessage",n)},function(e,t){},function(e,t,i){function n(e){window.gui.transmitMessage(e),window.isoEngine.transmitMessage(e)}var o=i(202);o.on("GameFightStartingMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightJoinMessage",function(e){window.isoEngine.transmitMessage(e),window.gui.transmitMessage(e)}),o.on("GameFightPlacementPossiblePositionsMessage",function(e){window.isoEngine.displayFightPositions(e),window.gui.transmitMessage(e)}),o.on("GameFightOptionStateUpdateMessage",function(e){window.isoEngine.challengeOptionChange(e.fightId,e.teamId,e.option,e.state),window.gui.transmitMessage(e)}),o.on("GameFightUpdateTeamMessage",function(e){window.isoEngine.updateFightTeam(e),window.gui.transmitMessage(e)}),o.on("GameFightRemoveTeamMemberMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightHumanReadyStateMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightLeaveMessage",function(e){window.isoEngine.transmitMessage(e)}),o.on("GameFightStartMessage",function(e){window.gui.transmitMessage(e),window.isoEngine.transmitMessage(e)}),o.on("GameFightSpectateMessage",n),o.on("GameFightResumeMessage",n),o.on("GameFightResumeWithSlavesMessage",n),o.on("GameFightEndMessage",function(e){window.isoEngine.transmitMessage(e)}),o.on("GameFightNewRoundMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnListMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnStartMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnStartPlayingMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnResumeMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnStartSlaveMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnReadyRequestMessage",function(e){window.isoEngine.transmitMessage(e)}),o.on("GameFightSynchronizeMessage",function(e){window.isoEngine.transmitMessage(e)}),o.on("GameFightTurnEndMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("ChallengeInfoMessage",function(e){window.gui.transmitMessage(e)}),n.on("ChallengeResultMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("GameFightShowFighterMessage",function(e){window.gui.transmitMessage(e),e.informations.alive?window.actorManager.addActor(e.informations):window.actorManager.userActor.actorId===e.informations.contextualId&&window.actorManager.userActor.loadAndPlayAnimation({base:"AnimMort"},!1,function(){window.actorManager.userActor.death()})}),n.on("GameFightRefreshFighterMessage",function(e){window.gui.transmitMessage(e),window.actorManager.refreshFighter(e)}),n.on("GameFightShowFighterRandomStaticPoseMessage",function(e){window.gui.transmitMessage(e),window.actorManager.addActor(e.informations)})},function(e,t,i){function n(e){if(e._bonesId){var t={contextualId:"paddockItem:"+e.cellId,look:{bonesId:e._bonesId,scales:[100],skins:[]},disposition:{cellId:e.cellId,direction:1},name:e._nameId,durability:e.durability,_type:"PaddockObject"};window.actorManager.addActor(t)}}var o=i(202);o.on("MountEmoteIconUsedOkMessage",function(e){var t=window.actorManager.getActor(e.mountId);if(t){var i,n=e.reactionType;switch(n){case 1:i="AnimEmoteRest_Statique_0";break;case 2:i="AnimAttaque0";break;case 3:i="AnimEmoteCaresse";break;case 4:i="AnimEmoteReproductionF";break;case 5:i="AnimEmoteReproductionM";break;default:return}t.loadAndPlayAnimation({base:i})}}),window.connectionManager=o,o.on("GameDataPaddockObjectAddMessage",function(e){n(e.paddockItemDescription)}),o.on("GameDataPaddockObjectListAddMessage",function(e){for(var t=e.paddockItemDescription,i=0;i<t.length;i++)n(t[i])}),o.on("GameDataPaddockObjectRemoveMessage",function(e){window.actorManager.removeActor("paddockItem:"+e.cellId)})},function(e,t,i){var n=i(202);n.on("NotificationListMessage",function(e){window.gui.transmitMessage(e)}),n.on("NotificationByServerMessage",function(e){console.info("NotificationByServerMessage: ","id:"+e.id,e.parameters)})},function(e,t,i){function n(e){window.gui.transmitMessage(e),a===e.mapId?window.isoEngine.reloadMap(e):(o.lockMessages(),window.isoEngine.loadMap(e)),a=e.mapId}var o=i(202),s=i(247),a=null;o.on("disconnect",function(){a=null}),o.on("CurrentMapMessage",function(e){o.sendMessage("MapInformationsRequestMessage",{mapId:e.mapId}),e.mapId!==a&&(window.foreground.lock("loadMap"),window.gui.transmitMessage(e),s.release())}),o.on("TeleportOnSameMapMessage",function(e){window.actorManager.setActorsDisposition([{id:e.targetId,cellId:e.cellId}])}),o.on("MapFightCountMessage",function(e){window.gui.transmitMessage(e)}),o.on("MapRunningFightListMessage",function(e){window.gui.transmitMessage(e)}),o.on("MapRunningFightDetailsMessage",function(e){window.gui.transmitMessage(e)}),o.on("MapObstacleUpdateMessage",function(e){window.isoEngine.updateObstacles(e.obstacles)}),o.on("MapComplementaryInformationsDataMessage",n),o.on("MapComplementaryInformationsDataInHouseMessage",n),o.on("MapComplementaryInformationsWithCoordsMessage",n),o.on("GameRolePlayShowActorMessage",function(e){window.actorManager.addActor(e.informations)})},function(e,t,i){function n(){window.gui.on("appGoBackground",function(){y.setMute(!0)}),window.gui.on("appLeaveBackground",function(){y.setMute(!1)}),h.on("gameContextChanged",s)}function o(){for(var e in r)y.createSoundPermanent(r[e],"ui");v=!0}function s(e){if(m&&h.isRoleplayMode)y.playLoopSound("music",m.id,m.volume/100);else if(h.isFightMode){var t=e&&g?g:f;t&&y.playLoopSound("music",t.id,t.volume/100)}_&&(h.isRoleplayMode?y.playLoopSound("ambient",_.id,_.volume/100):y.stopLoopSound("ambient"))}var a=i(248),r=i(255),l=i(167),c=i(168),d=i(256),u=i(257),h=i(258),p=[null,"music","ambient","fight","boss"],m=null,f=null,g=null,_=null,v=!1,y=new a(["music","ambient","sfx","ui"]);y.settings.maxUsedMemory=l.MAX_MUSIC_SFX_MEMORY,window.wizAssets&&(y.settings.getFileUri=function(e,t,i){window.wizAssets.downloadFile(e+t+".mp3","audio/"+t+".mp3",function(e){i(null,e)},i)}),c.isCordova&&(y.settings.getSoundConstructor=function(e){return c.isIOSApp&&d.isAvailable()?d:c.isAndroidApp&&u.isAvailable()?"music"===e||"ambient"===e?u.LoopYanap:"sfx"===e||"ui"===e?u.SoundYanap:void 0===e?u.SoundYanap:void console.error(new Error("audioManager: unknown channelId `"+e+"`")):null});var t=e.exports=y;t.initialize=function(){y.init(),n()},t.createUiSound=function(e){y.createSoundPermanent(r[e],"ui")},t.playUiSound=function(e){if(!y.channels.ui.muted){var t=r[e];if(!t)return console.warn("Incorrect UI sound id: "+e);v||o(),y.playSound("ui",t)}},t.mapChange=function(e,t){var i={music:null,ambient:null,fight:null,boss:null};t=e.concat(t);for(var n=0;n<t.length;n++){var o=t[n],a=p[o.type_id];a&&(i[a]=o)}m=i.music||m,_=i.ambient||_,f=i.fight,g=i.boss,s()},t.createAnimSoundGroups=function(e,t){var i=void 0!==t&&y.channels[t].muted;for(var n in e){for(var o=e[n],s=[],a=0;a<o.vol.length;a++)s.push(o.vol[a]/100);y.createSoundGroup(n,{id:o.id,vol:s},i)}},t.setChannelVolume=function(e,t,i){var n=y.channels.music;"music"===e&&y.channels.ambient.setMute(0!==t),"ambient"===e&&!n.muted&&n.volume>0&&(i=!0),y.setVolume(e,t,i),"sfx"===e&&this.setChannelVolume("ambient",t)},t.setupChannels=function(e){y.setVolume("ambient",0,!0);for(var t in e)if("ambient"!==t){var i=e[t];this.setChannelVolume(t,i.volume,i.muted)}},t.getDefaultParams=function(){var e={};for(var t in y.channels)if("ambient"!==t){
var i="music"===t&&c.isIpad2,n=i?0:1;e[t]={muted:i,volume:n}}return e}},function(e,t,i){function n(e){this.soundsById={},this.soundGroupsById={},this.permanentSounds={},this.freeSoundPool=[],this.soundArchive=new s(function(){return 1}),this.soundGroupArchive=new s(function(){return 1}),this.soundArchiveById={},this.soundGroupArchiveById={},this.usedMemory=0,this.channels={},this.audioContext=null,this.muted=!1,this.settings={audioPath:"",maxSoundGroup:500,maxUsedMemory:300,defaultFade:2,maxPlayLatency:1e3,crossFading:!1,getFileUri:function(e,t){return e+t+".mp3"},getSoundConstructor:function(e,t){return null}};for(var t=0;t<e.length;t++){var i=e[t];this.channels[i]=new l(i)}c.prototype.audioManager=this,r.prototype.audioManager=this,l.prototype.audioManager=this}var o=window.AudioContext||window.webkitAudioContext,s=i(249),a=i(250),r=i(252),l=i(253),c=i(251);o||(console.warn("Web Audio API is not supported on this platform. Fallback to regular HTML5 <Audio>"),a=i(254),window.Audio||(console.warn("HTML5 <Audio> is not supported on this platform. Sound features are unavailable."),a=c)),e.exports=n,e.exports.ISound=c,n.prototype.init=function(){if(!this.audioContext&&o){this.audioContext=new o,a.prototype.audioContext=this.audioContext;for(var e in this.soundsById)this.soundsById[e].init()}},n.prototype.getEmptySound=function(e,t){var i,n=this.settings.getSoundConstructor(e,t);return n?i=new n:(this.freeSoundPool.length>0?(i=this.freeSoundPool.pop(),i.init()):i=new a,i)},n.prototype.setup=function(e){for(var t in e){var i=e[t];this.setVolume(t,i.volume,i.muted)}},n.prototype.setVolume=function(e,t,i){var n=this.channels[e];n&&n.setVolume(t,i)},n.prototype.setMute=function(e){void 0===e&&(e=!this.muted),this.muted=!!e;for(var t in this.channels){var i=this.channels[t];if(i.loopSound)if(e)i.loopSound.stop();else{var n=i.muted;i.muted=!0,i.setVolume(null,n)}}},n.prototype.loadSound=function(e,t){var i=this.createSound(e);return i.load(t),i},n.prototype.createSound=function(e,t){var i=this.getSound(e);return i?i:(i=this.soundsById[e]=this.getEmptySound(t,e),i.setId(e),i)},n.prototype.createSoundPermanent=function(e,t){var i=this.getSound(e);if(i)return i;var n=this.settings.getSoundConstructor(t,e)||a;return i=this.permanentSounds[e]=new n,i.setId(e),i},n.prototype.getSound=function(e){var t=this.permanentSounds[e];return t?t:(t=this.soundsById[e])?t:(t=this.soundArchiveById[e])?(this.soundArchive.removeByRef(t.poolRef),t.poolRef=null,delete this.soundArchiveById[e],this.soundsById[e]=t,t):null},n.prototype.getSoundGroup=function(e){var t=this.soundGroupsById[e];return t?t:(t=this.soundGroupArchiveById[e])?(this.soundGroupArchive.removeByRef(t.poolRef),t.poolRef=null,delete this.soundGroupArchiveById[e],t.verifySounds(),this.soundGroupsById[e]=t,t):null},n.prototype.freeSound=function(e){var t=e.id;this.soundsById[t]&&delete this.soundsById[t],this.soundArchiveById[t]&&(this.soundArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundArchiveById[t]),e.unload(),e instanceof a&&this.freeSoundPool.push(e)},n.prototype.playLoopSound=function(e,t,i,n,o){var s=this.channels[e];return s?void s.playLoopSound(t,i,n,o):console.warn('Channel id "'+e+'" does not exist.')},n.prototype.stopLoopSound=function(e){var t=this,i=this.channels[e];if(!i)return console.warn('Channel id "'+e+'" does not exist.');var n=i.loopSound;i.loopId=null,n&&n.stop(function(){t.freeSound(n),i.loopSound=null})},n.prototype.stopAllLoopSounds=function(){for(var e in this.channels)this.stopLoopSound(e)},n.prototype.release=function(){var e,t,i,n=this.settings.maxSoundGroup,o=this.settings.maxUsedMemory,s={};for(e in this.channels){var a=this.channels[e];a.loopSound&&(s[a.loopSound.id]=!0)}for(e in this.soundGroupsById)t=this.soundGroupsById[e],t.poolRef=this.soundGroupArchive.add(t),this.soundGroupArchiveById[e]=t,delete this.soundGroupsById[e];for(e in this.soundsById)s[e]||(i=this.soundsById[e],i.poolRef=this.soundArchive.add(i),this.soundArchiveById[e]=i,delete this.soundsById[e]);for(var r=this.soundGroupArchive.getCount();r>n&&(t=this.soundGroupArchive.popFirst());)t.poolRef=null,delete this.soundGroupArchiveById[t.id],r-=1;for(;this.usedMemory>o&&(i=this.soundArchive.popFirst());)i.poolRef=null,delete this.soundArchiveById[i.id],this.freeSound(i)},n.prototype.playSound=function(e,t,i,n,o){if(!this.muted){var s=this.channels[e];if(!s.muted){var a=this.getSound(t);a||(a=this.createSound(t,e)),i=i||1,a.play(s.volume*i,n,o)}}},n.prototype.playSoundGroup=function(e,t,i,n,o){if(!this.muted){var s=this.channels[e];if(s&&!s.muted){var a=this.getSoundGroup(t);if(!a)return console.warn('SoundGroup "'+t+'" does not exist.');i=i||1,a.play(i*s.volume,n,o)}}},n.prototype.createSoundGroup=function(e,t,i){if(!this.getSoundGroup(e)){var n=new r(e,t.id,t.vol,t.pitch,i);this.soundGroupsById[e]=n}},n.prototype.createSoundGroups=function(e,t){var i=void 0!==t&&this.channels[t].muted;for(var n in e)this.createSoundGroup(n,e[n],i)}},function(e,t){function i(e,t,i,n){this.object=e,this.previous=t,this.next=i,this.container=n}function n(e){this.count=0,this.first=null,this.last=null,this.cmpFunc=e}n.prototype.add=function(e){var t=new i(e,null,null,this);if(this.count+=1,null===this.first)return this.first=t,this.last=t,t;var n=this.cmpFunc(e,this.first.object);if(n<0)return t.next=this.first,this.first.previous=t,this.first=t,t;var o=this.cmpFunc(e,this.last.object);if(o>=0)return t.previous=this.last,this.last.next=t,this.last=t,t;var s;if(n+o<0){for(s=this.first.next;this.cmpFunc(e,s.object)>=0;)s=s.next;t.next=s,t.previous=s.previous,t.previous.next=t,s.previous=t}else{for(s=this.last.previous;this.cmpFunc(e,s.object)<0;)s=s.previous;t.previous=s,t.next=s.next,t.next.previous=t,s.next=t}return t},n.prototype.removeByRef=function(e){return!(!e||e.container!==this)&&(this.count-=1,null===e.previous?this.first=e.next:e.previous.next=e.next,null===e.next?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=null,e.container=null,!0)},n.prototype.moveToTheBeginning=function(e){return!(!e||e.container!==this)&&(null===e.previous||(e.previous.next=e.next,this.last===e?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=this.first,e.next.previous=e,this.first=e,!0))},n.prototype.moveToTheEnd=function(e){return!(!e||e.container!==this)&&(null===e.next||(e.next.previous=e.previous,this.first===e?this.first=e.next:e.previous.next=e.next,e.next=null,e.previous=this.last,e.previous.next=e,this.last=e,!0))},n.prototype.possess=function(e){return e&&e.container===this},n.prototype.popFirst=function(){var e=this.first;if(!e)return null;this.count-=1;var t=e.object;return this.first=e.next,null!==this.first&&(this.first.previous=null),e.next=null,e.container=null,t},n.prototype.popLast=function(){var e=this.last;if(!e)return null;this.count-=1;var t=e.object;return this.last=e.previous,null!==this.last&&(this.last.next=null),e.previous=null,e.container=null,t},n.prototype.getFirst=function(){return this.first&&this.first.object},n.prototype.getLast=function(){return this.last&&this.last.object},n.prototype.clear=function(){for(var e=this.first;e;e=e.next)e.container=null;this.count=0,this.first=null,this.last=null},n.prototype.getCount=function(){return this.count},n.prototype.forEach=function(e,t){for(var i=this.first;i;i=i.next)e(i.object,t)},n.prototype.forEachReverse=function(e,t){for(var i=this.last;i;i=i.previous)e(i.object,t)},n.prototype.reposition=function(e){if(e.container!==this)return this.add(e.object);var t=e.previous,i=e.next,n=e.object;for(null===i?this.last=t:i.previous=t,null===t?this.first=i:t.next=i;null!==t&&this.cmpFunc(n,t.object)<0;)i=t,t=t.previous;for(;null!==i&&this.cmpFunc(n,i.object)>=0;)t=i,i=i.next;return e.next=i,null===i?this.last=e:i.previous=e,e.previous=t,null===t?this.first=e:t.next=e,e},e.exports=n},function(e,t,i){function n(){s.call(this),this.buffer=null,this.source=null,this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._playPitch=0,this._fadeTimeout=null,this._onStopCallback=null,this._audioNodeReady=!1,this.init()}var o=i(172).inherits,s=i(251),a=1e-6;o(n,s),e.exports=n,n.prototype._createAudioNodes=function(){if(!this._audioNodeReady&&this.audioContext){var e,t=this.audioContext,i=t.createGain();e=t.createStereoPanner?t.createStereoPanner():t.createPanner(),i.connect(e),e.connect(t.destination),i.gain.value=0,this.sourceConnector=i,this.gain=i.gain,this.panNode=e,this._audioNodeReady=!0}},n.prototype._destroyAudioNodes=function(){if(this._audioNodeReady){var e=this.audioContext,t=this.panNode,i=this.sourceConnector;i.disconnect(t),t.disconnect(e.destination),this.source&&(this.source.disconnect(i),this.source.onended=null,this.source=null),this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._audioNodeReady=!1}},n.prototype.init=function(){function e(e){i.buffer=e,i.usedMemory=e.duration,i.audioManager.usedMemory+=e.duration,i.rawAudioData=null,i._loaded&&i._playTriggered&&((i.loop||Date.now()-i._playTriggered<n)&&i._play(),i._playTriggered=0)}function t(){console.error("decode audio failed for sound ",i.id)}if(this._createAudioNodes(),this.rawAudioData){var i=this,n=this.audioManager.settings.maxPlayLatency,o=this.audioContext;o.decodeAudioData(this.rawAudioData,e,t)}},n.prototype.setVolume=function(e){if(this.volume=e,this.playing){if(!this.fade)return void(this.gain.value=e);e<=0&&(e=a);var t=this.audioContext.currentTime;this.gain.cancelScheduledValues(t),this.gain.setValueAtTime(this.gain.value||a,t),this.gain.linearRampToValueAtTime(e,t+this.fade)}},n.prototype.setPan=function(e){this.pan=e,this.panNode&&(this.panNode.pan?this.panNode.pan.value=e:this.panNode.setPosition(e,0,.2))},n.prototype.setLoop=function(e){this.loop=e,this.source&&this.buffer&&(this.source.loop=e,this.source.loopStart=0,this.source.loopEnd=this.buffer.duration)},n.prototype.setPitch=function(e,t){this.pitch=e,this._setPlaybackRate(t)},n.prototype._updatePlayPitch=function(e){!e&&0!==e||e===this._playPitch||(this._playPitch=e,this._setPlaybackRate(0))},n.prototype._setPlaybackRate=function(e){if(this.source){var t=Math.pow(2,(this._playPitch+this.pitch)/12);if(!e)return void(this.source.playbackRate.value=t);var i=this.audioContext.currentTime;this.source.playbackRate.cancelScheduledValues(i),this.source.playbackRate.setValueAtTime(this.source.playbackRate.value||a,i),this.source.playbackRate.linearRampToValueAtTime(t,i+e)}},n.prototype._load=function(){function e(e){n._finalizeLoad(e)}function t(e){n.buffer=e,n.usedMemory=e.duration,n.audioManager.usedMemory+=e.duration,n._finalizeLoad(null)}function i(i){var o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=function(){if(4===~~o.readyState)return 200!==~~o.status&&0!==~~o.status?e("xhrError:"+o.status):void(n.audioContext?n.audioContext.decodeAudioData(o.response,t,e):(n.rawAudioData=o.response,n._finalizeLoad(null)))},o.open("GET",i,!0),o.send()}var n=this;this._createAudioNodes();var o=this.audioManager.settings.getFileUri,s=this.audioManager.settings.audioPath;if(o.length>2)o(s,this.id,function(t,n){return t?e(t):void i(n)});else try{var a=o(s,this.id);if(!a)return e("emptyUri");i(a)}catch(r){e(r)}},n.prototype.unload=function(){s.prototype.unload.call(this)&&(this._fadeTimeout&&(this._onStopCallback=null,this._stopAndClear()),this.buffer=null,this.source&&(this.source.onended=null,this.source.stop(0),this.source=null),this._destroyAudioNodes())},n.prototype._play=function(e){if(!this.buffer)return void(this._playTriggered=Date.now());this.playing=!0;var t=this.audioContext.currentTime;if(this.gain.cancelScheduledValues(t),this.fade?(this.gain.setValueAtTime(this.gain.value||a,t),this.gain.linearRampToValueAtTime(this.volume||a,t+this.fade)):this.gain.value=this.volume,this._fadeTimeout)return this._onStopCallback=null,this.source.onended=null,this.stopping=!1,window.clearTimeout(this._fadeTimeout),void(this._fadeTimeout=null);this.source&&(this.source.disconnect(this.sourceConnector),this.source.onended=null);var i=this.source=this.audioContext.createBufferSource();i.connect(this.sourceConnector);var n=this;i.onended=function(){n.playing=!1,i.onended=null,n.source=null},this._playPitch=e||0,(e||this.pitch)&&this._setPlaybackRate(0),i.loop=this.loop,i.buffer=this.buffer,i.loopStart=0,i.loopEnd=this.buffer.duration,i.start(0)},n.prototype._stopAndClear=function(){this.stopping=!1,this.source.onended=null,this.source.stop(0),this.source=null,this._fadeTimeout&&(window.clearTimeout(this._fadeTimeout),this._fadeTimeout=null),this._onStopCallback&&(this._onStopCallback(),this._onStopCallback=null)},n.prototype.stop=function(e){if(!this.playing&&!this.stopping)return e&&e();if(this._playTriggered=0,this.stopping=!0,this.playing=!1,!this.source)return e&&e();if(this._onStopCallback=e,!this._fadeTimeout){if(this.fade){var t=this,i=this.audioContext.currentTime;return this.gain.cancelScheduledValues(i),this.gain.setValueAtTime(this.gain.value||a,i),this.gain.linearRampToValueAtTime(a,i+this.fade),void(this._fadeTimeout=window.setTimeout(function(){t._fadeTimeout=null,t._stopAndClear()},1e3*this.fade))}this._stopAndClear()}}},function(e,t){function i(){this.playing=!1,this.stopping=!1,this.fade=0,this.usedMemory=0,this.poolRef=null,this.id=null,this.volume=1,this.pan=0,this.loop=!1,this.pitch=0,this._loaded=!1,this._loading=!1,this._unloading=!1,this._playTriggered=0,this._onLoadQueuedCallback=[]}e.exports=i,i.prototype.setId=function(e){this.id=e,this._loaded=!1},i.prototype.load=function(e){return this.id?this._loaded?e&&e(null,this):(e&&this._onLoadQueuedCallback.push(e),this._loading?void 0:(this._loading=!0,this._load())):e&&e("noId")},i.prototype._finalizeLoad=function(e){var t=this.audioManager.settings.maxPlayLatency;this._loaded=!e,this._loading=!1;for(var i=0;i<this._onLoadQueuedCallback.length;i++)this._onLoadQueuedCallback[i](e,this);return this._onLoadQueuedCallback=[],this._unloading?(this._unloading=!1,void this.unload()):void(this._loaded&&this._playTriggered&&((this.loop||Date.now()-this._playTriggered<t)&&this._play(),this._playTriggered=0))},i.prototype.cancelOnLoadCallbacks=function(){this._onLoadQueuedCallback=[]},i.prototype.play=function(e,t,i){return void 0!==e&&null!==e&&this.setVolume(e),void 0!==t&&null!==t&&this.setPan(t),this._loaded?this.loop&&this.playing?void this._updatePlayPitch(i):void this._play(i):(this._playTriggered=Date.now(),void this.load())},i.prototype.init=function(){},i.prototype.setVolume=function(e){this.volume=e},i.prototype.setPan=function(e){this.pan=e},i.prototype.setLoop=function(e){this.loop=e},i.prototype.setPitch=function(e){this.pitch=e},i.prototype._updatePlayPitch=function(e){},i.prototype._play=function(e){this.playing=!0,console.log('ISound play call: "'+this.id+'"')},i.prototype.stop=function(e){return this.playing=!1,e&&e()},i.prototype._load=function(){return console.log("ISound load call: "+this.id),this._finalizeLoad(null)},i.prototype.unload=function(){return this._playTriggered=0,this.setLoop(!1),this.fade=0,this.pitch=0,this.stop(),this._loading?(this._unloading=!0,!1):(this.audioManager.usedMemory-=this.usedMemory,this.setVolume(1),this.setPan(0),this.id=null,this._loaded=!1,this.usedMemory=0,!0)}},function(e,t){function i(e,t,i,n,o){this.id=e,this.soundIds=t,this.volumes=i||[],this.pitches=n||[],this.soundIndex=0,this.volIndex=0,this.pitchIndex=0,this.poolRef=null,this._ready=!1,0===this.volumes.length&&this.volumes.push(1),0===this.pitches.length&&this.pitches.push(0),o||this._createSounds()}e.exports=i,i.prototype._createSounds=function(){for(var e=this.soundIds,t=0;t<e.length;t++)this.audioManager.loadSound(e[t]);this._ready=!0},i.prototype.play=function(e,t,i){if(0!==this.soundIds.length){this._ready||this._createSounds();var n=this.soundIds[this.soundIndex++],o=this.audioManager.getSound(n);if(!o)return console.warn("[Sound Group: "+this.id+"] sound id "+n+"  cannot be played.");e=e||1,i=i||0,e*=this.volumes[this.volIndex++],i+=this.pitches[this.pitchIndex++],o.play(e,t,i),this.soundIndex>=this.soundIds.length&&(this.soundIndex=0),this.volIndex>=this.volumes.length&&(this.volIndex=0),this.pitchIndex>=this.pitches.length&&(this.pitchIndex=0)}},i.prototype.verifySounds=function(){for(var e=0;e<this.soundIds.length;e++){var t=this.soundIds[e];this.audioManager.createSound(t)}}},function(e,t){function i(e){this.id=e,this.volume=1,this.muted=!0,this.loopSound=null,this.loopId=null,this.loopVol=0,this.nextLoop=null}e.exports=i,i.prototype.setVolume=function(e,t){var i=this.muted;this.muted=0===e||t||!1,void 0!==e&&null!==e?this.volume=e:e=this.volume,this.loopId&&(this.loopSound&&this.muted?this.loopSound.stop():this.loopSound&&this.loopSound.id===this.loopId?(this.loopSound.setVolume(Math.max(0,Math.min(1,e*this.loopVol))),i&&this.loopSound.play()):this.muted||this.audioManager.playLoopSound(this.id,this.loopId,this.loopVol))},i.prototype.setMute=function(e){this.setVolume(null,e)},i.prototype.playLoopSound=function(e,t,i,n){function o(e,t){return e?void(e.stopping||e.stop(function(){return r.freeSound(e),e=null,t&&t()})):t&&t()}function s(){var e=h.loopSound=h.nextLoop;h.nextLoop=null,e&&(e.setLoop(!0),e.fade=l,e.load(function(o){return o?(e.unload(),void(h.loopSound=null)):void e.play(t*h.volume,i,n)}))}function a(){h.loopSound=null,window.setTimeout(s,0)}var r=this.audioManager,l=r.settings.defaultFade,c=r.settings.crossFading,d=this.loopSound,u=d&&d.id;if(t=Math.max(0,Math.min(1,t||1)),this.loopId=e,this.loopVol=t,!r.muted&&!this.muted){if(e===u&&d)return d.play(t*this.volume,i,n),void(this.nextLoop&&(this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=null));if(d=null,!this.nextLoop||this.nextLoop.id!==e){var h=this;c?(this.nextLoop&&this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=r.createSound(e,this.id),this.nextLoop.load(function(e){return e?(h.nextLoop.unload(),void(h.nextLoop=null)):(o(h.loopSound),void a())})):(this.nextLoop=r.createSound(e,this.id),o(this.loopSound,a))}}}},function(e,t,i){function n(){s.call(this);var e=new Audio;e.loop=!1,e.type="audio/mpeg",this._audio=e,this.audioContext&&(this.source=this.audioContext.createMediaElementSource(e),this.source.connect(this.audioContext.destination))}var o=i(172).inherits,s=i(251),a={playAudioWhenScreenIsLocked:!1};o(n,s),e.exports=n,n.prototype.setVolume=function(e){this.volume=this._audio.volume=e},n.prototype.setLoop=function(e){this.loop=this._audio.loop=e},n.prototype._load=function(){function e(e){o._finalizeLoad(e)}function t(){this.removeEventListener("canplaythrough",t),this.removeEventListener("error",i),o.usedMemory=this.duration,o.audioManager.usedMemory+=this.duration,o._finalizeLoad(null)}function i(n){this.removeEventListener("canplaythrough",t),this.removeEventListener("error",i),e(n)}function n(e){o._loading=!0,o._audio.addEventListener("canplaythrough",t),o._audio.addEventListener("error",i),o._audio.src=e,o._audio.load()}var o=this,s=this.audioManager.settings.getFileUri,a=this.audioManager.settings.audioPath;if(s.length>2)s(a,this.id,function(t,i){return t?e(t):void n(i)});else try{var r=s(a,this.id);if(!r)return e("emptyUri");n(r)}catch(l){e(l)}},n.prototype.unload=function(){s.prototype.unload.call(this)&&(this._audio.volume=1,this._audio.src="",this._audio.load())},n.prototype._play=function(e){this._audio.volume=this.volume,this._audio.pause(),this._audio.currentTime=0,this._audio.play(a),this.playing=!0},n.prototype.stop=function(e){return this._audio.pause(),this._audio.currentTime=0,this._playTriggered=0,this.playing=!1,e&&e()}},function(e,t){e.exports={LEVEL_UP:16062,OPEN_INVENTORY:16026,CLOSE_INVENTORY:16027,ITEM_IN_INVENTORY_1:16040,ITEM_IN_INVENTORY_2:16041,ITEM_IN_INVENTORY_3:16042,DROP_ITEM_1:16043,EQUIP_BOOTS:16028,EQUIP_WRISTBAND:16029,EQUIP_CLOTH_1:16030,EQUIP_CLOTH_2:16031,EQUIP_NECKLACE:16036,EQUIP_ACCESORIES:16037,EQUIP_WEAPON:16038,EQUIP_HAND:16039,EQUIP_DOFUS:16091,EQUIP_PET:16092,OPTIONS_OPEN:16023,OPTIONS_CLOSE:16024,INTRO_FIGHT:16067,OUTRO_FIGHT:16068,READY_TO_FIGHT:16070,END_TURN:16069,PLAYER_TURN:16077,NPC_TURN:16078,FIGHT_POSITION:16071,OK_BUTTON:16002,PLAY_BUTTON:16003,GEN_BUTTON:16004,SPEC_BUTTON:16005,CHECKBOX_CHECKED:16006,CHECKBOX_UNCHECKED:16007,TAB:16009,ROLLOVER:16010,SCROLL_UP:16014,SCROLL_DOWN:16015,CHARACTER_SELECTION_RIGHT:16079,CHARACTER_SELECTION_LEFT:16080,DELETE_CHARACTER:16081,POPUP_YES:16082,POPUP_NO:16083,CANCEL_BUTTON:16084,FRIENDS:16085,CHARACTER_CREATION:16086,BANNER_SPELL_TAB:16087,BANNER_EMOTE_TAB:16089,PLUS_BUTTON:16090,STORE_SELL_BUTTON:16099,STORE_BUY_BUTTON:16100,VALID_KAMA_EXCHANGE:16101,MERCHANT_REMOVE_SELL_BUTTON:16096,DRAG_START:16053,DRAG_END:16059,CHALLENGE_CHECKPOINT:16073,LITTLE_OBJECTIVE:16074,POPUP_INFO:16011,WINDOW_OPEN:16012,WINDOW_CLOSE:16013,OPEN_DOCUMENT:16102,CLOSE_DOCUMENT:16103,TURN_PAGE_DOCUMENT_1:16104,TURN_PAGE_DOCUMENT_2:16105,TURN_PAGE_DOCUMENT_3:16106,BACK_TO_BEGINNING_DOCUMENT:16108,GUILD_CHAT_MESSAGE:16109,RED_CHAT_MESSAGE:16114,MOUNT_HURT:1412506,OPEN_MOUNT_UI:1412505,OPEN_TRANSACTION_WINDOW:16093,CLOSE_TRANSACTION_WINDOW:16094,LEFT_TO_RIGHT_SWITCH:16097,RIGHT_TO_LEFT_SWITCH:16098,NEW_TIPS:16112,NEW_REWARD:16118}},function(e,t,i){function n(){return n.isAvailable()?(s.call(this),this.media=null,this.uri=null,this.errorOccured=!1,void(r||(window.Media.shouldReleaseOnMemoryWarning(!1),r=!0))):console.error(new Error("SoundCordova: cordova media plugin is not available"))}var o=i(172).inherits,s=i(248).ISound,a=i(168),r=!1,l=!1;o(n,s),e.exports=n,n.isAvailable=function(){return a.isCordova&&window.Media},n.prototype.setVolume=function(e){s.prototype.setVolume.call(this,e),this.media&&this.media.setVolume(e)},n.prototype._load=function(){function e(){}function t(e){var t=!o.errorOccured,i=a.isIOSApp&&window.navigator.userAgent.indexOf("iPad; CPU OS 8_0")!==-1;3===e.code&&i&&(l&&(t=!1),l=!0),o._loading&&o._finalizeLoad(e),o.errorOccured||o.unload(),o.errorOccured=!0,t&&console.error("SoundCordova: "+JSON.stringify(e)+", file: "+o.uri)}function i(){if(!o.usedMemory){var e=Number(o.media.getDuration());!e||e<0||(o.usedMemory=e,o.audioManager.usedMemory+=e)}}function n(n){o.uri=n,o.media=new window.Media(n,e,t,i),o._loading&&!o.errorOccured&&o._finalizeLoad(null)}var o=this;if(o.errorOccured)return this._finalizeLoad("previouslyFailed");var s=o.audioManager.settings.getFileUri,r=o.audioManager.settings.audioPath;if(s.length>2)s(r,o.id,function(e,t){return e?o._finalizeLoad(e):void n(t)});else try{var c=s(r,o.id);if(!c)return o._finalizeLoad("emptyUri");n(c)}catch(d){o._finalizeLoad(d)}},n.prototype.unload=function(){if(s.prototype.unload.call(this)){if(!this.media)return;this.media.stop(),this.media.release()}},n.prototype._play=function(){this.media&&(this.errorOccured||(this.media.setVolume(this.volume),this.loop&&this.playing||(this.media.seekTo(0),this.media.play({numberOfLoops:this.loop?0:1,playAudioWhenScreenIsLocked:!1}),this.playing=!0)))},n.prototype.stop=function(e){return this.media?(this.media.stop(),s.prototype.stop.call(this,e)):e&&e()}},function(e,t,i){function n(){return d.isAndroidApp&&window.cordova.plugins.Yanap}function o(){return n()?(c.call(this),this.audioMode=null,this.media=null,this.uri=null,void(this.errorOccured=!1)):console.error(new Error("YanapAudioInstance: Yanap plugin is not available"))}function s(){o.call(this),this.audioMode=window.cordova.plugins.Yanap.AUDIO_TYPE.LOOP}function a(){o.call(this),this.audioMode=window.cordova.plugins.Yanap.AUDIO_TYPE.MUSIC}function r(){o.call(this),this.audioMode=window.cordova.plugins.Yanap.AUDIO_TYPE.SOUND}var l=i(172).inherits,c=i(248).ISound,d=i(168),u=12e3;l(o,c),o.prototype.setVolume=function(e){c.prototype.setVolume.call(this,e),this.media&&this.media.setVolume(e,e)},o.prototype._load=function(){function e(e){var t=!n.errorOccured;n._loading&&n._finalizeLoad(e),n.errorOccured||n.unload(),n.errorOccured=!0,t&&console.error("SoundYanap: "+JSON.stringify(e)+", file: "+n.uri)}function t(t,i){if(t===window.cordova.plugins.Yanap.AUDIO_INSTANCE_STATUS.ERROR)return e(i);if(!n.usedMemory&&n.media&&n.media.fileLength){var o=~~n.media.fileLength/u;o<=0||(n.usedMemory=o,n.audioManager.usedMemory+=o)}}function i(e){n.uri=e,n.media=new window.cordova.plugins.Yanap.AudioInstance(n.audioMode,t),window.wizAssets&&!window.wizAssets.initialize&&(e=e.substr(e.indexOf("/audio/")+1)),n.media.load(e),n._finalizeLoad(null)}var n=this;if(n.errorOccured)return this._finalizeLoad("previouslyFailed");var o=n.audioManager.settings.getFileUri,s=n.audioManager.settings.audioPath;if(o.length>2)o(s,n.id,function(e,t){return e?n._finalizeLoad(e):void i(t)});else try{var a=o(s,n.id);if(!a)return n._finalizeLoad("emptyUri");i(a)}catch(r){n._finalizeLoad(r)}},o.prototype.unload=function(){if(c.prototype.unload.call(this)){if(!this.media)return;this.media.stop(),this.media.release()}},o.prototype._play=function(){this.media&&(this.errorOccured||(this.media.setVolume(this.volume,this.volume),this.media.play(),this.playing=!0))},o.prototype.stop=function(e){return this.media?(this.media.stop(),c.prototype.stop.call(this,e)):e&&e()},l(s,o),l(a,o),l(r,o),e.exports={LoopYanap:s,MusicYanap:a,SoundYanap:r,isAvailable:n}},function(e,t,i){function n(){s.call(this),this._context=a.ROLE_PLAY,this._setMode(),r.on("GameContextCreateMessage",this.changeGameContext.bind(this))}var o=i(172).inherits,s=i(175).EventEmitter,a=i(259),r=i(202);o(n,s),n.prototype.changeGameContext=function(e){this._context=e.context,this._setMode(),this.emit("gameContextChanged",this._context)},n.prototype._setMode=function(){this.isRoleplayMode=this._context===a.ROLE_PLAY,this.isFightMode=this._context===a.FIGHT},e.exports=new n},function(e,t){e.exports={ROLE_PLAY:1,FIGHT:2}},function(e,t,i){var n=i(202);n.on("GameRolePlayPlayerLifeStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayGameOverMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(202);n.on("DocumentReadingBeginMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("EmoteListMessage",function(e){window.gui.transmitMessage(e)}),n.on("EmoteAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("EmoteRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("EmotePlayMessage",function(e){window.isoEngine.playEmote(e)})},function(e,t,i){var n=i(202);n.on("GameRolePlayAggressionMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayPlayerFightFriendlyRequestedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayPlayerFightFriendlyAnsweredMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayShowChallengeMessage",function(e){window.isoEngine.showChallenge(e.commonsInfos)}),n.on("GameRolePlayRemoveChallengeMessage",function(e){window.gui.transmitMessage(e),window.isoEngine.removeChallenge(e.fightId)})},function(e,t,i){var n=i(202);n.on("GameRolePlayArenaRegistrationStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayArenaFightPropositionMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayArenaFighterStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayArenaUpdatePlayerInfosMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("AccountHouseMessage",function(e){window.gui.transmitMessage(e)}),n.on("HousePropertiesMessage",function(e){window.gui.transmitMessage(e)}),n.on("HouseBuyResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("HouseSoldMessage",function(e){window.gui.transmitMessage(e)}),n.on("HouseToSellListMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("HouseGuildNoneMessage",function(e){window.gui.transmitMessage(e)}),n.on("HouseGuildRightsMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("JobDescriptionMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobLevelUpMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobUnlearntMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobExperienceMultiUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobExperienceUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobAllowMultiCraftRequestMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobMultiCraftAvailableSkillsMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectoryListMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectorySettingsMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobListedUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectoryRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectoryAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectoryEntryMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("LockableShowCodeDialogMessage",function(e){window.gui.transmitMessage(e)}),n.on("LockableCodeResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("LockableStateUpdateHouseDoorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("TaxCollectorDialogQuestionBasicMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorDialogQuestionExtendedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceTaxCollectorDialogQuestionExtendedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AlliancePrismDialogQuestionMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202),o=i(182),s=i(167),a=s.ITEM_DIR;n.on("ObjectGroundAddedMessage",function(e){var t={cellId:e.cellId,objectGID:e.objectGID};o.loadImage(a+e._iconId+".png",function(e){t.img=e,window.isoEngine.addObjects([t])})}),n.on("ObjectGroundListAddedMessage",function(e){for(var t=[],i=[],n=0,s=e.cells.length;n<s;n++)t.push({cellId:e.cells[n],objectGID:e.referenceIds[n]}),i.push(a+e._iconIds[n]+".png");o.loadImages(i,null,function(e){for(var i=0;i<e.length;i++)t[i].img=e[i];window.isoEngine.addObjects(t)})}),n.on("ObjectGroundRemovedMessage",function(e){window.isoEngine.removeObjects([e.cell])}),n.on("ObjectGroundRemovedMultipleMessage",function(e){window.isoEngine.removeObjects(e.cells)})},function(e,t,i){var n=i(202);n.on("PaddockPropertiesMessage",function(e){window.gui.transmitMessage(e)}),n.on("PaddockSellBuyDialogMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameDataPlayFarmObjectAnimationMessage",function(e){for(var t=0;t<e.cellId.length;t++){var i="paddockItem:"+e.cellId[t],n=window.actorManager.getActor(i);n&&n.loadAndPlayAnimation({base:"AnimHit",direction:1},!1)}}),n.on("PaddockToSellListMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("PartyInvitationDetailsMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyCannotJoinErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyJoinMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyNewGuestMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyNewMemberMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyUpdateLightMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyFollowStatusUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyMemberInFightMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("PurchasableDialogMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("QuestListMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestValidatedMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestObjectiveValidatedMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestStepValidatedMessage",function(e){window.gui.transmitMessage(e);
}),n.on("QuestStepStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestStepInfoMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("SpellForgetUIMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpellForgottenMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpellUpgradeSuccessMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpellUpgradeFailureMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlaySpellAnimMessage",function(e){window.isoEngine.playRoleplaySpellAnim(e)})},function(e,t){},function(e,t){},function(e,t,i){var n=i(202);n.on("LeaveDialogMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("FriendsListMessage",function(e){window.gui.transmitMessage(e)}),n.on("IgnoredListMessage",function(e){window.gui.transmitMessage(e)}),n.on("FriendAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("FriendUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("IgnoredAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("IgnoredDeleteResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpouseStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpouseInformationsMessage",function(e){window.gui.transmitMessage(e)}),n.on("FriendWarnOnConnectionStateMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("GuildCreationStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildModificationStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildCreationResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInvitedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInvitationStateRecruterMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInvitationStateRecrutedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildJoinedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildMemberOnlineStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInformationsGeneralMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInformationsMembersMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildMemberWarnOnConnectionStateMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInformationsMemberUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInformationsPaddocksMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildMemberLeavingMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildLeftMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildMembershipMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInfosUpgradeMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildHousesInformationMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildHouseUpdateInformationMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildHouseRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildPaddockBoughtMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildPaddockRemovedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFactsMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInAllianceFactsMessage",function(e){window.gui.transmitMessage(e)}),n.on("ChallengeFightJoinRefusedMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("TaxCollectorMovementMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorListMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorMovementAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorMovementRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorAttackedMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorAttackedResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFightPlayersHelpersJoinMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFightPlayersHelpersLeaveMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFightPlayersEnemiesListMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFightPlayersEnemyRemoveMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("SetCharacterRestrictionsMessage",function(e){window.isoEngine.actorManager.userActor.updateRestrictions(e.restrictions)}),n.on("ServerExperienceModificatorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("InteractiveUseErrorMessage",function(e){window.isoEngine.onInteractiveUseErrorMessage(e)}),n.on("InteractiveUsedMessage",function(e){window.isoEngine.interactiveUseStart(e),window.gui.transmitMessage(e)}),n.on("InteractiveUseEndedMessage",function(e){window.isoEngine.interactiveUseEndedMessage(e),window.gui.transmitMessage(e)}),n.on("InteractiveMapUpdateMessage",function(e){window.isoEngine.updateInteractiveElements(e.interactiveElements)}),n.on("InteractiveElementUpdatedMessage",function(e){window.isoEngine.updateInteractiveElements([e.interactiveElement])}),n.on("StatedMapUpdateMessage",function(e){window.isoEngine.updateStatedElements(e.statedElements)}),n.on("StatedElementUpdatedMessage",function(e){window.isoEngine.updateStatedElements([e.statedElement])})},function(e,t,i){var n=i(202);n.on("TeleportDestinationsListMessage",function(e){window.gui.transmitMessage(e)}),n.on("ZaapListMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("KamasUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectAveragePricesMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("ExchangeReplayCountModifiedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeRequestedTradeMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartedWithPodsMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartedWithStorageMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftSlotCountIncreasedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeIsReadyMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeLeaveMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkNpcTradeMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeOkMultiCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftResultWithObjectIdMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftResultWithObjectDescMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftResultMagicWithObjectDescMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftInformationObjectMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartedMountStockMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeWeightMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeGuildTaxCollectorGetMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeReplyTaxVendorMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountStableErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountStableAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountPaddockAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountStableBornAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountStableRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountPaddockRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountTakenFromPaddockMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountFreeFromPaddockMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountSterilizeFromPaddockMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeItemAutoCraftStopedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeItemAutoCraftRemainingMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkCraftWithInformationMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkMulticraftCrafterMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkMulticraftCustomerMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkJobIndexMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeGoldPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeItemPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeModifiedPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeRemovedPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeClearPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("InventoryContentMessage",function(e){window.gui.transmitMessage(e)}),n.on("SetUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectMovementMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectsAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectModifiedMessage",function(e){window.gui.transmitMessage(e)}),n.on("LivingObjectMessageMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryContentAndPresetMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectRemovedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectModifiedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectPutInBagMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectRemovedFromBagMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectModifiedInBagMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeKamaModifiedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMultiCraftCrafterCanUseHisRessourcesMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("InventoryPresetUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetItemUpdateErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetItemUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetSaveResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetDeleteResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetUseResultMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("SpellListMessage",function(e){window.gui.transmitMessage(e)}),n.on("SlaveSwitchContextMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("StorageInventoryContentMessage",function(e){window.gui.transmitMessage(e)}),n.on("StorageKamasUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("StorageObjectUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("StorageObjectsUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("StorageObjectRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("StorageObjectsRemoveMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202),o=i(29).getText;n.on("PopupWarningMessage",function(e){window.gui.openConfirmPopup({title:o("ui.popup.information"),message:e.author+": "+e.content,noDisable:!0,timer:e.lockDuration})})},function(e,t){},function(e,t,i){var n=i(202);n.on("PrismFightDefenderAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightDefenderLeaveMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightAttackerAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightAttackerRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismsListMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismsListUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismsInfoValidMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightRemovedMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightStateUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismSettingsErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(202);n.on("UpdateMapPlayersAgressableStatusMessage",function(e){window.gui.transmitMessage(e),window.actorManager.updateActorsAggressableStatus(e.playerIds,e.enable)}),n.on("UpdateSelfAgressableStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("AlignmentRankUpdateMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t){},function(e,t,i){var n=i(202);n.on("ContactLookMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(202);n.on("TitlesAndOrnamentsListMessage",function(e){window.gui.transmitMessage(e)}),n.on("TitleGainedMessage",function(e){window.gui.transmitMessage(e)}),n.on("TitleLostMessage",function(e){window.gui.transmitMessage(e)}),n.on("OrnamentGainedMessage",function(e){window.gui.transmitMessage(e)}),n.on("TitleSelectedMessage",function(e){window.gui.transmitMessage(e)}),n.on("TitleSelectErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("OrnamentSelectedMessage",function(e){window.gui.transmitMessage(e)}),n.on("OrnamentSelectErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(202);n.on("TrustStatusMessage",function(e){n.sendMessage("CharactersListRequestMessage"),window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(202);n.on("SystemMessageDisplayMessage",function(e){window.gui.openSimplePopup(e.text,e.title),e.hangUp&&(window.gui.disconnect(),window.isoEngine.disconnect())})},function(e,t){},function(e,t){},function(e,t){},function(e,t){function i(e){window.gui.transmitMessage({_messageType:"_tutorialGameMapMovementMessage",actorId:e.actorId})}function n(){window.gui.transmitMessage({_messageType:"_tutorialGameEntitiesDispositionMessage"})}t.setTutorialListeners=function(e){e.on("GameMapMovementMessage",i),e.on("GameEntitiesDispositionMessage",n)},t.removeTutorialListeners=function(e){e.removeListener("GameMapMovementMessage",i),e.removeListener("GameEntitiesDispositionMessage",n)}},function(e,t,i){function n(e,t,i){function n(e){return e||0===e||(e=t),i(null,e)}function o(e){return i(e)}var a=window.plugins&&window.plugins.appPreferences;if(a)return a.fetch(n,o,e);var r;try{r=window.localStorage.getItem(e)}catch(l){return s.setImmediate(function(){return o(l)})}return s.setImmediate(function(){return n(r)})}function o(e,t,i){var n=window.plugins&&window.plugins.appPreferences;if(n)return n.store(function(){i()},i,t,e);try{window.localStorage.setItem(t,e)}catch(o){return s.setImmediate(function(){return i(o)})}return s.setImmediate(i)}var s=i(31),a=i(30),r="plugins.wizassets.assetsversion",l="client.main.staticdataversion",c="0.0.0",d="1";t.upgradeAssets=function(e,t){function i(t){function i(){return o(n,r,t)}var n=e.assetsVersion;if(!n)return t();var s=window.wizAssets;return s?s.deleteFiles(e.changedFiles,i,t):i()}function n(t){var i=e.staticDataVersion;return i?void a.eraseDiskCache(function(e){return e?t(e):void o(i,l,function(e){return e?t(e):void a.initializeDiskCache(t)})}):t()}return e.staticDataVersion||e.assetsVersion?void s.series([n,i],function(e){return e?t(e):t()}):t()},t.getVersions=function(e){function t(e,t,i,o){n(t,i,function(t,i){return t?o(t):(a[e]=i,o())})}function i(e){return t("assetsVersion",r,c,e)}function o(e){return t("staticDataVersion",l,d,e)}var a={};s.series([o,i],function(t){return t?e("Could not get the client assets version: "+t):e(null,a)})}},function(e,t){var i=!1;t.start=function(){if(window.powerManagement)return i?console.warn("PowerManager already active"):void window.powerManagement.dim(function(){i=!0},function(e){console.warn("PowerManager failed to acquire wakelock",e)})},t.stop=function(){if(window.powerManagement)return i?void window.powerManagement.release(function(){i=!1},function(e){console.warn("PowerManager failed to release wakelock",e)}):console.warn("PowerManager was not active")}},function(e,t){function i(e,t){function i(){if(!t)throw new Error("Final callback was already called");for(var i=0;i<o.length;i+=1)e.removeListener(o[i].eventName,o[i].callback);o=null;try{t.apply(e,arguments)}catch(n){setTimeout(function(){throw n},0)}finally{t=null}}function n(){function t(){try{n.apply(e,arguments)}catch(t){i(t)}}var n=arguments[arguments.length-1];if("function"!=typeof n)throw new TypeError("Final argument must be a callback function");for(var s=0;s<arguments.length-1;s+=1){var a=arguments[s];e.on(a,t),o.push({eventName:a,callback:t})}}var o=[];return t=t||function(){},n.done=i,n}e.exports=i},function(e,t){function i(){}function n(e,t){if(d){var i=new c(e);if(t){var n=t.revenue;n&&i.setRevenue(n.price,n.currency);var o=t.transactionId;o&&(o="string"==typeof o?o:o.toString(),i.setTransactionId(o))}r.trackEvent(i)}}var o,s,a,r=window.Adjust,l=window.AdjustConfig,c=window.AdjustEvent,d=!1;r&&(o=function(e){if(e){var t=l[e.environment]||l.EnvironmentSandbox,i=new l(e.appToken,t);i.setLogLevel(l.LogLevelVerbose),r.create(i),d=!0}},s=function(e,t,i){n("m38gxs",{revenue:{price:e,currency:t},transactionId:i})},a=function(){n("806tbe")}),t.initialize=o||i,t.trackIAPBought=s||i,t.trackTutorialCompleted=a||i},function(e,t,i){var n=i(202),o={BasicAckMessage:null,BasicLatencyStatsRequestMessage:null,BasicNoOperationMessage:null,SequenceNumberRequestMessage:null},s={BasicLatencyStatsMessage:null,SequenceNumberMessage:null};n.on("data",function(e){if(null!==o[e._messageType]){var t="background-color: #BFA;";e._messageType&&e._messageType.indexOf("ErrorMessage")===-1||(t="background-color: #F00; color: #FFF;"),console.log("[DOFUS PROXY] received: %c"+e._messageType,t,e)}}),n.on("messageSequence",function(e){var t="background-color: #CB98E7;";console.log("[DOFUS PROXY] received: %cmessageSequence",t,e)}),n.on("open",function(){console.log("[DOFUS PROXY] %c Connected to remote server ","background-color: #FF0;")}),n.on("reconnecting",function(){console.log("[DOFUS PROXY] %c Reconnecting to remote server... ","background-color: #FF0;")}),n.on("reconnected",function(){console.log("[DOFUS PROXY] %c Reconnected to remote server ","background-color: #FF0;")}),n.on("error",function(e){console.error("[DOFUS PROXY] ",e)}),n.on("disconnect",function(){console.log("[DOFUS PROXY] %c disconnecting ","background-color: #FF0;")}),n.on("send",function(e){if("sendMessage"===e.call){if(s[e.data.data.type])return;return void console.log("[DOFUS PROXY]     send: %c"+e.data.data.type,"background-color: #6DF;",e.data.data.data)}console.log("[DOFUS PROXY]     send: %c"+e.call,"background-color: #6DF;",e.data)})},function(e,t,i){i(315),e.exports=i(316),i(344),i(345),i(346),i(428)},function(e,t){},function(e,t,i){function n(){function e(){t.setStyles({left:o.mapLeft+"px",top:o.mapTop+"px",width:o.mapWidth+"px",height:o.mapHeight+"px"})}u.call(this,"div",{className:"foreground",hidden:!0}),this.tapOptions={},this.fightIsUserTurn=!1,this.isTacticMode=!1,this.locked=!1,this.lockMap={},m.on("gameContextChanged",this.onGameContextChanged.bind(this));var t=this,i=window.gui;i.once("connected",function(){t._setupInfoBox(),t._createConfirmBox(),t._setupDrop(),t._setupTouchInteraction(),t._setupBorderArrow(),e(),i.timeline.setStyles({top:o.mapHeight-150+"px",left:o.mapWidth+"px"}),t._initHandlers(this),this.on("disconnect",function(){t.tapOptions={},t.fightIsUserTurn=!1,t.locked=!1,t.lockMap={},t.hideInfobox(),t.confirmBox.close(),t.minMaxSelector.hide(),t.hide()})}),i.on("resize",e)}var o=i(166).dimensions,s=i(317),a=i(171),r=i(172).inherits,l=i(332),c=i(247).playUiSound,d=i(343),u=i(321),h=i(29).getText,p=i(29).processText,m=i(258);r(n,u),e.exports=n,n.prototype._setupDrop=function(){function e(e){var i=window.gui.playerData.inventory.objects[t],n=i?i.getName():t;window.gui.openConfirmPopup({title:h("ui.common.confirm"),message:p(h("ui.common.confirmationDropItem"),e,n),cb:function(i){i&&(window.dofus.sendMessage("ObjectDropMessage",{objectUID:t,quantity:e}),c("DROP_ITEM_1"))}})}var t,i=this,n=this.minMaxSelector=window.gui.windowsContainer.appendChild(new l);n.on("confirm",e),s.setDroppable(this,["itemContextMenu","equipment"]),this.on("drop",function(o,s,a){switch(s){case"itemContextMenu":var r=i.convertScreenToCanvasCoordinate(a.x,a.y);window.isoEngine.useItem(r.x,r.y,o.item.objectUID);break;case"equipment":t=o.itemInstance.objectUID;var l=o.itemInstance.quantity;1===l?e(1):n.open({min:1,max:l,x:a.x,y:a.y})}})},n.prototype._initHandlers=function(e){function t(){o.tapOptions.mode="fight",o.tapOptions.possiblePlacements&&delete o.tapOptions.possiblePlacements}function i(){o.fightIsUserTurn&&(o.fightIsUserTurn=!1,o.confirmBox.hide(),window.isoEngine.clearUserMovementZone())}function n(t){var i=o.fightIsUserTurn=e.playerData.characters.canControlCharacterId(t.id),n=window.isoEngine;if(n.fightTurnStart(i),n.clearHighlights(),i&&a.soundOnPlayerTurnStart&&c("PLAYER_TURN"),!n.mapRenderer.isReady)return n.mapRenderer.once("ready",function(){o._displayUserZones()})}var o=this;e.on("sendAllFightEvent",function(){o._displayUserZones()}),e.on("GameFightPlacementPossiblePositionsMessage",function(e){o.tapOptions.mode="fightPlacement",e.teamNumber===d.TEAM_CHALLENGER?o.tapOptions.possiblePlacements=e.positionsForChallengers:e.teamNumber===d.TEAM_DEFENDER?o.tapOptions.possiblePlacements=e.positionsForDefenders:o.tapOptions.possiblePlacements&&delete o.tapOptions.possiblePlacements}),e.on("GameFightJoinMessage",function(e){return e.isFightStarted?t():void(o.tapOptions.mode="fightPlacement")}),e.on("GameFightStartMessage",t),e.on("GameFightResumeMessage",t),e.on("GameFightResumeWithSlavesMessage",t),e.on("GameFightTurnStartPlayingMessage",function(){o.fightIsUserTurn=!0}),e.on("GameFightTurnStartMessage",n),e.on("GameFightTurnResumeMessage",n),e.on("GameFightTurnStartSlaveMessage",n),e.on("GameFightTurnEndMessage",i),e.on("GameFightEndMessage",i),e.on("spellSlotSelected",function(e){o.selectSpell(e)}),e.on("spellSlotDeselected",function(){o.deselectSpell()}),e.playerData.on("movementPointsCurrentUpdated",function(){this.isFighting&&o.fightIsUserTurn&&(o.isSpellSelected()||window.isoEngine.displayUserMovementZone())})},n.prototype._displayUserZones=function(){var e=this.isSpellSelected();this.fightIsUserTurn?e?this._displaySpellRange():window.isoEngine.displayUserMovementZone():e&&this._displaySpellRange()},n.prototype._displaySpellRange=function(){var e=this.tapOptions,t=e.spellId,i=window.gui.playerData.characters.getControlledCharacter(),n=i.spellData.spells[t],o=n.getZoneEffectWhenCasting(),s={spellId:t,castInDiagonal:n.getProperty("castInDiagonal"),castInLine:n.getProperty("castInLine"),castTestLos:n.getProperty("castTestLos"),minRange:n.getProperty("minRange"),range:n.getProperty("range"),apCost:n.getProperty("apCost",n.level),needFreeCell:n.getProperty("needFreeCell"),needFreeTrapCell:n.getProperty("needFreeTrapCell"),needTakenCell:n.getProperty("needTakenCell"),name:n.getName(),zoneEffect:o};e.spell=n,window.isoEngine.setCurrentSpell(s),window.isoEngine.displaySpellRange()},n.prototype.refreshSpellRange=function(){this.isSpellSelected()&&this._displaySpellRange()},n.prototype.selectSpell=function(e){this.tapOptions.spellId=e,this.tapOptions.characterId=window.gui.playerData.characters.controlledCharacterId,"fight"===this.tapOptions.mode&&this._displayUserZones()},n.prototype.deselectSpell=function(){void 0!==this.tapOptions.spellId&&(this.confirmBox.close(),delete this.tapOptions.spellId),"fight"===this.tapOptions.mode&&this._displayUserZones()},n.prototype.isSpellSelected=function(){return!!this.tapOptions.spellId||0===this.tapOptions.spellId},n.prototype.lock=function(e){return e?(this.lockMap[e]=!0,this.locked=!0,void this.cancelTransform()):console.error(new Error("Foreground.lock: no reason provided"))},n.prototype.unlock=function(e){if(!e)return console.error(new Error("Foreground.unlock: no reason provided"));this.lockMap[e]=!1;for(var t=Object.keys(this.lockMap),i=0;i<t.length;i++)if(this.lockMap[t[i]])return;this.locked=!1},n.prototype.onGameContextChanged=function(){m.isRoleplayMode?this.tapOptions.mode="roleplay":(delete this.tapOptions.mode,this.hideBorderArrow())}},function(e,t,i){function n(){h=!1,b=M=null,f=g=v=null}function o(e,t){var i=1.5,n=0,o=0,s=0;void 0!==f.customScale&&null!==f.customScale&&(i=f.customScale),void 0!==f.customXOffset&&null!==f.customXOffset&&(n=f.customXOffset),void 0!==f.customYOffset&&null!==f.customYOffset&&(o=f.customYOffset),void 0!==f.customRotation&&null!==f.customRotation&&(s=f.customRotation);var a=e-C.x-p+n,r=t-C.y-m+o;f.setStyle("webkitTransform","translate3d("+a+"px, "+r+"px, 0) scale("+i+") rotateZ("+s+"deg)")}function s(e,t){a.removeListener("dragMove",o),u.isDragging=!1,y&&(y.delClassNames("dragOver","notAllowed"),y=null),A.x=e,A.y=t;var i=document.elementFromPoint(e,t);if(i){var n=document.createEvent("Event");n.initEvent("drop",!0,!0),i.dispatchEvent(n)}l.stop()}i(318);var a=i(319),r=i(188).EventEmitter,l=i(320),c=i(196),d=i(321),u=new r,h=!1;u.isDragging=!1;var p,m,f,g,_,v,y=null,b=null,M=null,w={x:0,y:0},T={left:0,top:0},C={x:0,y:0},A={x:0,y:0};u.init=function(e){_=new d("div",{className:"dragElement"}),_.icon=_.createChild("div",{className:"icon"}),e.appendChild(_),_.hide(),window.gui.wBody.on("dom.drop",function(){c.tween(f,{webkitTransform:"translate3d(0,0,0) scale(1)"},{time:100,easing:"ease-out"},function(){v.onDragClassName&&f.delClassNames(v.onDragClassName),u.isLostDrop=!0,f!==_?(g.appendChild(f),f.delClassNames("customDragElement"),f.setStyles(T),f.emit("dragEnd",A.x,A.y)):(_.hide(),b.emit("dragEnd",A.x,A.y)),u.emit("dragEnd",b,b._dragManager.source,M),_.hide(),n()})})},u.setElementSource=function(e,t){e._dragManager&&(e._dragManager.source=t)},u.isDraggable=function(e){return e._dragManager&&e._dragManager.draggable},u.setDraggable=function(e,t,i,n,r){e._dragManager=e._dragManager||{},e._dragManager.draggable||(e._dragManager.draggable=!0,e._dragManager.source=i,r=r||{},t=t||{},a.initializeListeners(e,r),e.on("_dragStart",function(i,d){if(f=r.dragElement?e:_,!h&&(!t.prepareForDrag||t.prepareForDrag(n,f,e))){h=!0,u.isDragging=!0,b=e,M=n,v=t;var y=e.rootElement.getBoundingClientRect(),A={left:y.left,top:y.top,width:r.containerWidth||y.width,height:r.containerHeight||y.height};if(w.x=A.left,w.y=A.top,r.dragElement)g=e.getParent(),window.gui.gameGuiContainer.appendChild(e),T.left=e.getStyle("left"),T.top=e.getStyle("top"),f.setStyles({left:A.left+"px",top:A.top+"px",webkitTransform:"translate3d(0,0,0)"}),f.addClassNames("customDragElement");else{T.left=T.top=0,f.setStyles({left:A.left+"px",top:A.top+"px",width:A.width+"px",height:A.height+"px",webkitTransform:"translate3d(0,0,0)"});var I=v.styles||{};I.backgroundImage=v.backgroundImage||I.backgroundImage||"none",f.icon.setStyles(I)}v.onDragClassName&&f.addClassNames(v.onDragClassName),f.show(),p=A.left+Math.floor(A.width/2)-i,m=A.top+Math.floor(A.height/2)-d,C.x=i,C.y=d,c.tween(f,{webkitTransform:"translate3d("+-p+"px,"+-m+"px,0) scale(1.5)"},{time:100,easing:"ease-out"},function(){a.on("dragMove",o),r.noHover||l.start(),e.emit("dragStart"),u.emit("dragStart",b,b._dragManager.source,M)}),a.once("dragEnd",s)}}))},u.setDragEnable=function(e,t){e._dragManager&&(e._dragManager.enable=t)},u.enableDrag=function(e){u.setDragEnable(e,!0)},u.disableDrag=function(e){u.setDragEnable(e,!1)},u.cancelDragFromSource=function(e){b&&e===b._dragManager.source&&u.cancelDrag()},u.cancelDrag=function(){v&&v.onDragClassName&&f.delClassNames(v.onDragClassName),a.cancel()},u.setDroppable=function(e,t,i){function o(){var n=b._dragManager.source;return!(i.isDropAllowed&&!i.isDropAllowed.call(e,M,f,n))&&t.indexOf(n)!==-1}e._dragManager=e._dragManager||{},e._dragManager.droppable||(e._dragManager.droppable=!0,i=i||{},l(e),e.on("touchenter",function(){u.isDragging&&o()&&(y=e,e.addClassNames("dragOver"),e.emit("dragEnter",b,b._dragManager.source,M))}),e.on("touchleave",function(){u.isDragging&&o()&&(y=null,e.delClassNames("dragOver"),e.emit("dragLeave"))}),e.on("dom.drop",function(t){if(o()){t.stopPropagation();var s,a;if(i.matchPositionOnDrop){var r=e.rootElement.getBoundingClientRect();s=r.left-C.x+Math.floor(r.width/2)-p,a=r.top-C.y+Math.floor(r.height/2)-m}else s=A.x-C.x,a=A.y-C.y;e.emit("beforeDragEnd"),c.tween(f,{webkitTransform:"translate3d("+s+"px,"+a+"px,0) scale(1)"},{time:100,easing:"ease-out"},function(){M=M||{},M.x=A.x,M.y=A.y,v.onDragClassName&&f.delClassNames(v.onDragClassName),f!==_?(g.appendChild(f),f.delClassNames("customDragElement"),f.setStyles({left:T.left,top:T.top,webkitTransform:"translate3d(0px,0px, 0)"}),f.emit("dragEnd",s,a)):b.emit("dragEnd",s,a),u.isLostDrop=!1,u.emit("dragEnd",b,b._dragManager.source,M),e.delClassNames("dragOver"),e.emit("drop",b,b._dragManager.source,M),_.hide(),n()})}}))},u.getDraggedElement=function(){return f},e.exports=u},function(e,t){},function(e,t,i){function n(){g=!1,c=null}function o(e){var t=h(e);if(!g){if(Math.abs(t.x-r)<v&&Math.abs(t.y-l)<v)return;if(!p.requestInteractionHandle(m))return m.cancel();g=!0,c.emit("_dragStart",t.x,t.y)}c.emit("dragMove",t.x,t.y),m.emit("dragMove",t.x,t.y)}function s(){_||(_=!0,window.gui.wBody.on("dom.touchmove",o),window.gui.wBody.on("dom.touchend",d))}function a(){_&&(_=!1,window.gui.wBody.removeListener("dom.touchmove",o),window.gui.wBody.removeListener("dom.touchend",d))}var r,l,c,d,u=i(188).EventEmitter,h=i(198).getPosition,p=i(200),m=e.exports=new u,f=5,g=!1,_=!1,v=f;d=function(e){var t=h(e);a(),g&&(n(),m.emit("dragEnd",t.x,t.y))},m.cancel=function(){a(),g&&(n(),m.emit("dragEnd",0,0),p.abortInteraction())},m.initializeListeners=function(e,t){e.allowDomEvents();var i=t.hasOwnProperty("sensitivity")?t.sensitiviy:f;e.on("dom.touchstart",function(n){if(e._dragManager.enable&&!_){v=i;var a=h(n);r=a.x,l=a.y,s(),c=e,t.dragOnTouchstart&&(v=0,o(n))}}),e._dragManager.enable=!0}},function(e,t,i){function n(e){var t=b(e);h=M.x=t.x,p=M.y=t.y,M.touchCount=t.touchCount}function o(){w=!0}function s(){if(w){w=!1;var e=document.elementFromPoint(h,p);if(!e)return void(w=!0);if(e===_)return void o();_=e,f=M.touchedElements=[];var t=document.createEvent("Event");t.initEvent("touching",!0,!0),e.dispatchEvent(t)}}function a(e){n(e),(Math.abs(h-T)>15||Math.abs(p-C)>15||e.timeStamp-A>50)&&(T=h,C=p,s()),A=e.timeStamp}function r(e){var t=b(e);M.touchCount=t.touchCount,0===t.touchCount&&y()}function l(){f.push(v),g=M.topElement=f[0];for(var e=f.length-1,t=m.length-1,i=Math.max(e,t);i>=0;i-=1){var n=m[t],o=f[e];n!==o&&(n&&n.emit("touchleave",M),o&&o.emit("touchenter",M)),t-=1,e-=1}m=f,w=!0}function c(){u||(u=!0,m=[],f=[],_=null,g=null,w=!0,v.on("dom.touchmove",a),v.on("dom.touchend",r))}function d(e){e._hoverBehavior||(e._hoverBehavior=!0,e.allowDomEvents(),e.on("dom.touching",function(t){return g!==e||f.length?void f.push(e):(t.stopPropagation(),o())}))}var u,h,p,m,f,g,_,v,y,b=i(198).getPosition,M={x:0,y:0,touchCount:0,topElement:null,touchedElements:null},w=!1,T=0,C=0,A=0;y=function(){u&&(u=!1,v.removeListener("dom.touchend",r),v.removeListener("dom.touchmove",a))},e.exports=d,d.start=c,d.stop=y,d.initialize=function(e){return window._hoverBehavior?console.error("hover behavior initialised more than one time."):(window._hoverBehavior=!0,v=e,void v.on("dom.touching",l))}},function(e,t,i){function n(e){return d.apply([],e).filter(Boolean)}function o(e,t){
var i,n=document.createElement(e);if(t&&t.attr)for(i in t.attr)n.setAttribute(i,t.attr[i]);return n}function s(e,t){r.call(this),this._elementIsVisible=!0,this._currentTextContent=null,this.rootElement=null,this._text=null,this._name=null,this._childrenList=[],this._childrenMap={},this._contentType=c.EMPTY,this._parent=null,e&&this._assign(e,t)}var a=i(172).inherits,r=i(322).EventEmitter,l=i(323);i(324);var c={EMPTY:null,WUI:"wui",TEXT:"text",HTML:"html"},d=Array.prototype.concat;a(s,r),e.exports=s,s.prototype._assign=function(e,t){if(this.rootElement)throw new Error("WuiDom has already an element assigned");if("string"==typeof e)this.rootElement=o(e,t),t&&t.hasOwnProperty("text")&&this.setText(t.text);else{if(!(e instanceof window.Element))throw new Error("WuiDom.assign requires the given argument to be a DOM Element or tagName.");this.rootElement=e}t=t||{},t.hidden&&this.hide(),"name"in t&&(this._name=String(t.name)),"className"in t&&this.addClassNames(t.className),"style"in t&&this.setStyles(t.style||{})},s.prototype.assign=function(e,t){this._assign(e,t)},s.prototype.getWuiName=function(){return this._name},s.prototype.removeChild=function(e){var t=e instanceof s;if(!t&&(e=this._childrenMap[e],!e))throw new Error("WuiDom: Given name is not a current child");var i=this._childrenList.indexOf(e);if(i===-1)throw new Error("WuiDom: Not a current child");return this.rootElement.removeChild(e.rootElement),this._childrenList.splice(i,1),this._childrenMap.hasOwnProperty(e._name)&&delete this._childrenMap[e._name],e._parent=null,e},s.prototype._unsetParent=function(){this._parent&&this._parent.removeChild(this)},s.prototype._setParent=function(e){if(e!==this._parent){if(this._name){if(e._childrenMap[this._name])throw new Error("WuiDom: Parent already has a child with this name");e._childrenMap[this._name]=this}this._parent=e}},s.prototype.getParent=function(){return this._parent},s.prototype.appendChild=function(e){if(this._contentType&&this._contentType!==c.WUI&&this._clearLinearContent(),this===e._parent){var t=this._childrenList.indexOf(e);t!==-1&&this._childrenList.splice(t,1)}else e._unsetParent(),e._setParent(this);return this._childrenList.push(e),this.rootElement.appendChild(e.rootElement),e.rebindTouchListeners(),this._contentType=c.WUI,e},s.prototype.createChild=function(e,t){return this.appendChild(new s(e,t))},s.prototype.appendTo=function(e){e.appendChild(this)},s.prototype.insertChildBefore=function(e,t){this._contentType&&this._contentType!==c.WUI&&this._clearLinearContent();var i;if(this===e._parent){var n=this._childrenList.indexOf(e);n!==-1&&this._childrenList.splice(n,1)}else e._unsetParent();if(t){if(i=this._childrenList.indexOf(t),i===-1)throw new Error("WuiDom: Wanted sibling is not a child")}else i=this._childrenList.length;return e._setParent(this),this.rootElement.insertBefore(e.rootElement,t&&t.rootElement),e.rebindTouchListeners(),this._childrenList.splice(i,0,e),this._contentType=c.WUI,e},s.prototype.insertBefore=function(e){if(!e._parent)throw new Error("WuiDom: sibling has no parent");return e._parent.insertChildBefore(this,e),e},s.prototype.insertAsFirstChild=function(e){var t=this._childrenList[0];return t?this.insertChildBefore(e,t):this.appendChild(e)},s.prototype.getChildren=function(){return this._childrenList.concat()},s.prototype.getChildCount=function(){return this._childrenList.length},s.prototype.getChild=function(e){return this._childrenMap[e]},s.prototype._clearLinearContent=function(){this._text=null,this._currentTextContent=null,this.rootElement.innerHTML=""},s.prototype.setHtml=function(e){this._contentType===c.WUI&&this._destroyChildren(),this._contentType===c.TEXT&&this._clearLinearContent(),this.rootElement.innerHTML=e,this._contentType=c.HTML},s.prototype.setText=function(e){this._contentType===c.WUI&&this._destroyChildren(),this._contentType===c.HTML&&this._clearLinearContent(),null!==e&&void 0!==e&&(e=e.valueOf(),this._text||(this._text=document.createTextNode(""),this.rootElement.appendChild(this._text)),e!==this._currentTextContent&&(this._currentTextContent=e,this._text.nodeValue=e),this._contentType=c.TEXT)},s.prototype.getText=function(){return this._currentTextContent},s.prototype.setStyle=function(e,t){this.rootElement.style[e]=t},s.prototype.setStyles=function(e){var t=this.rootElement.style;for(var i in e)t[i]=e[i]},s.prototype.unsetStyle=function(e){this.rootElement.style[e]=""},s.prototype.getStyle=function(e){return this.rootElement.style[e]},s.prototype.getComputedStyle=function(e){var t=window.getComputedStyle(this.rootElement);return t?t.getPropertyValue(e):null},s.prototype.getComputedStyles=function(){var e=window.getComputedStyle(this.rootElement);if(!e)return{};for(var t={},i=0,n=arguments.length;i<n;i+=1){var o=arguments[i];t[o]=e.getPropertyValue(o)}return t},s.prototype.getClassNames=function(){return n(this.rootElement.classList)},s.prototype.hasClassName=function(e){return this.rootElement.classList.contains(e)},s.prototype.setClassNames=function(){this.rootElement.className="";var e=this.rootElement.classList;e.add.apply(e,n(arguments))},s.prototype.addClassNames=function(){var e=this.rootElement.classList;e.add.apply(e,n(arguments))},s.prototype.replaceClassNames=function(e,t){var i=this.rootElement.classList;i.remove.apply(i,n(e)),i.add.apply(i,n(t))},s.prototype.delClassNames=function(){var e=this.rootElement.classList;e.remove.apply(e,n(arguments))},s.prototype.toggleClassNames=function(e,t){for(var i=0;i<e.length;i+=1)this.toggleClassName(e[i],t)},s.prototype.toggleClassName=function(e,t){return t===!0||t===!1?this.rootElement.classList.toggle(e,t):this.rootElement.classList.toggle(e)},s.prototype._removeDom=function(){var e=this.rootElement;e&&(e.remove(),this.rootElement=null)},s.prototype._destroyChildren=function(){var e=this._childrenList.concat();this._childrenList=[],this._childrenMap={};for(var t=0,i=e.length;t<i;t+=1){var n=e[t];n.emit("destroy"),n._parent=null,n._destroyChildren(),n._removeDom(),n.removeAllListeners()}},s.prototype.clearContent=function(){switch(this._contentType){case c.HTML:case c.TEXT:this._clearLinearContent();break;case c.WUI:this._destroyChildren()}this._contentType=c.EMPTY,this.emit("cleared")},s.prototype.destroy=function(){this.emit("destroy"),this._unsetParent(),this._destroyChildren(),this._removeDom(),this.removeAllListeners()},s.prototype.showMethod=function(){this.rootElement.style.display=""},s.prototype.hideMethod=function(){this.rootElement.style.display="none"},s.prototype.show=function(){this._elementIsVisible||(this._elementIsVisible=!0,this.showMethod(),this.emit("show"))},s.prototype.hide=function(){this._elementIsVisible&&(this._elementIsVisible=!1,this.hideMethod(),this.emit("hide"))},s.prototype.toggleDisplay=function(e){return void 0===e&&(e=!this._elementIsVisible),e?this.show():this.hide(),!!e},s.prototype.isVisible=function(e){return!!this._elementIsVisible&&(!e||!this._parent||this._parent.isVisible(!0))},s.prototype.rebindTouchListeners=function(){if(this.domListeners){var e=this.rootElement;for(var t in this.domListeners)if(t.match(/^touch/)){var i=this.domListeners[t];for(var n in i){var o=i[n];e.removeEventListener(n,o),e.addEventListener(n,o)}}}},s.prototype.bindToTome=function(e,t){function i(e){t(this.valueOf(),e)}var n=this;t||(t=function(e){n.setText(e)}),e.on("readable",i),t(e.valueOf()),this.on("destroy",function(){e.removeListener("readable",i)})},s.prototype.allowDomEvents=function(){this.domListeners||(this.domListeners={},this.on("newListener",l["new"]),this.on("removeListener",l.remove),this.on("destroy",l.destroy))}},function(e,t){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,i,o,r,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[e],a(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(s(i))for(r=Array.prototype.slice.call(arguments,1),c=i.slice(),o=c.length,l=0;l<o;l++)c[l].apply(this,r);return!0},i.prototype.addListener=function(e,t){var o;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(o=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function i(){this.removeListener(e,i),o||(o=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var o=!1;return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var i,o,a,r;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],a=i.length,o=-1,i===t||n(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(i)){for(r=a;r-- >0;)if(i[r]===t||i[r].listener&&i[r].listener===t){o=r;break}if(o<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],n(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){function i(){s=Date.now()}function n(){s=0}function o(){return 0!==s&&Date.now()-s<a}var s=0,a=500,r="dom";t["new"]=function(e){var t=this,a=e.split(".");if(a[0]===r){var l=a[1];if(l&&!this.domListeners[l])switch(l){case"touchstart":var c=function(e){o()||1!==e.which||t.emit("dom.touchstart",e)},d=function(e){i(),t.emit("dom.touchstart",e)};this.domListeners.touchstart={mousedown:c,touchstart:d},this.rootElement.addEventListener("mousedown",c),this.rootElement.addEventListener("touchstart",d);break;case"touchmove":var u=function(e){s||1!==e.which||t.emit("dom.touchmove",e)},h=function(e){t.emit("dom.touchmove",e)};this.domListeners.touchmove={mousemove:u,touchmove:h},this.rootElement.addEventListener("mousemove",u),this.rootElement.addEventListener("touchmove",h);break;case"touchend":var p=function(e){return o()||1!==e.which?void n():void t.emit("dom.touchend",e)},m=function(e){i(),t.emit("dom.touchend",e),e.preventDefault()};this.domListeners.touchend={mouseup:p,touchend:m},this.rootElement.addEventListener("mouseup",p),this.rootElement.addEventListener("touchend",m);break;default:var f=function(i){t.emit(e,i)};this.domListeners[l]=f,this.rootElement.addEventListener(l,f)}}},t.remove=function(e){if(0===this.listeners(e).length){var t=e.split(".");if(t[0]===r){var i=t[1],n=this.domListeners[i];if(n){if(null!==n&&"object"==typeof n){for(var o in n){var s=n[o];this.rootElement.removeEventListener(o,s)}return void delete this.domListeners[i]}this.rootElement.removeEventListener(i,n),delete this.domListeners[i]}}}},t.destroy=function(){for(var e in this.domListeners){var t=this.domListeners[e];if(null===t||"object"!=typeof t)this.rootElement.removeEventListener(e,t);else for(var i in t){var n=t[i];this.rootElement.removeEventListener(i,n)}}this.domListeners={}}},function(e,t,i){i(325),i(326),i(327),i(328),i(329),i(330)},function(e,t){"HTMLDocument"in window||(window.HTMLDocument=window.Document)},function(e,t){!function(){"use strict";function e(e,t){if("string"!=typeof e)throw new TypeError('Failed to construct "CustomEvent": An event name must be provided.');var i=document.createEvent("CustomEvent"),n={bubbles:!1,cancelable:!1,detail:null};return t=t||n,i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}var t="CustomEvent"in window&&("function"==typeof window.CustomEvent||window.CustomEvent.toString().indexOf("CustomEventConstructor")>-1);t||(window.CustomEvent=e)}()},function(e,t){!function(){"use strict";var e=Element.prototype,t=e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector,i="matches"in e&&t.call(document.createElement("a"),"a");i||(e.matches=function(e){var i=Array.prototype.indexOf,n=this.parentNode;return n||(n=document.createDocumentFragment(),n.appendChild(this)),t?t.call(this,e):i.call(n.querySelectorAll(e),this)>-1})}()},function(e,t){!function(){"use strict";var e=Element.prototype;"closest"in e||(e.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null})}()},function(e,t){!function(){"use strict";function e(e){return"string"==typeof e?document.createTextNode(e):e}function t(t){var i,n,o;if(t&&(o=t.length),!o)throw new Error("No node was specified (DOM Exception 8)");if(1===o)return e(t[0]);for(i=document.createDocumentFragment(),n=0;n<o;n++)i.appendChild(e(t[n]));return i}var i=Element.prototype,n=i.after&&i.append&&i.before&&i.prepend&&i.remove&&i.replace;n||(i.prepend=function(){this.insertBefore(t(arguments),this.firstChild)},i.append=function(){this.appendChild(t(arguments))},i.before=function(){var e=this.parentNode;e&&e.insertBefore(t(arguments),this)},i.after=function(){var e=this.parentNode;e&&e.insertBefore(t(arguments),this.nextSibling)},i.replace=function(){var e=this.parentNode;e&&e.replaceChild(t(arguments),this)},i.remove=function(){var e=this.parentNode;e&&e.removeChild(this)})}()},function(e,t,i){!function(){"use strict";var e,t=document.createElement("x"),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=function(e){return"classList"in e&&(!e.classList.toggle("a",!1)&&!e.classList.contains("a"))};if(o(n)||(e=i(331),Object.defineProperty(Element.prototype,"classList",{get:function(){function t(){}return t.prototype=new e(this,"class"),new t}})),!o(t)){e=i(331);var s=DOMTokenList.prototype,a=function(e){return function(){var t,i=arguments.length;for(t=0;t<i;t++)e.call(this,arguments[t])}};s.add=a(s.add),s.remove=a(s.remove),s.toggle=function(t,i){return 1 in arguments&&this.contains(t)===i?i:e.prototype.toggle.call(this,t,i)}}}()},function(e,t){"use strict";function i(e,t){this._getString=function(){return e.getAttribute(t)||""},this._setString=function(i){e.setAttribute(t,i)},n(this,o(this))}function n(e,t){for(var i=t.length,n=0;n<i;n++)e[n]=t[n];delete e[i]}function o(e){var t=e._getString();return t&&""!==t?t.split(/\s+/):[]}function s(e){if(""===e||void 0===e)throw new Error("An invalid or illegal string was specified (DOM Exception 12)");if(/\s+/.test(e))throw new Error("InvalidCharacterError: String contains an invalid character (DOM Exception 5)")}i.prototype={add:function(e){for(var t,i=0,a=arguments.length,r=o(this),l=!1;i<a;i++)t=arguments[i],s(t),r.indexOf(t)<0&&(r.push(t),l=!0);l&&(this._setString(r.join(" ").trim()),n(this,r))},contains:function(e){return s(e),o(this).indexOf(e)>-1},item:function(e){return o(this)[e]||null},get length(){return o(this).length},remove:function(e){for(var t,i,a=0,r=arguments.length,l=o(this),c=!1;a<r;a++)for(i=arguments[a],s(i);(t=l.indexOf(i))>-1;)l.splice(t,1),c=!0;c&&(this._setString(l.join(" ").trim()),n(this,l))},toggle:function(e,t){var i=this.contains(e),n=i?t!==!0&&"remove":t!==!1&&"add";return n&&this[n](e),"boolean"==typeof t?t:!i},toString:function(){return this._getString()}},e.exports=i},function(e,t,i){function n(){var e=this;h.call(this,"div",{className:"minMaxSelector",hidden:!0});var t=this.createChild("div",{className:"topRow"}),i=this.createChild("div",{className:"botRow"});this.decrButton=t.appendChild(new r({className:["simpleButton","arrow","decrButton"],repeatDelay:m})),this.numberInput=t.appendChild(new c({className:"numberInput"})),this.incrButton=t.appendChild(new r({className:["simpleButton","arrow","incrButton"],repeatDelay:m})),this.minButton=i.appendChild(new l(s("ui.common.minWord"),{className:"minButton"})),this.maxButton=i.appendChild(new l(s("ui.common.maxWord"),{className:"maxButton"})),this.close=i.appendChild(new r({className:["simpleButton","closeBtn"]})),this.confirm=i.appendChild(new r({className:["simpleButton","confirmBtn"]})),this.currentValue=0,this.minButton.on("tap",function(){e.currentValue=e.min,e.numberInput.setValue(e.currentValue)}),this.maxButton.on("tap",function(){e.currentValue=e.max,e.numberInput.setValue(e.currentValue)}),this.decrButton.on("tap",function(){e.currentValue<=e.min||(e.currentValue--,e.numberInput.setValue(e.currentValue))}),this.incrButton.on("tap",function(){e.currentValue>=e.max||(e.currentValue++,e.numberInput.setValue(e.currentValue))}),this.confirm.on("tap",function(){e.closeMinMax(),e.emit("confirm",e.currentValue)}),this.close.on("tap",function(){e.closeMinMax()}),this.numberInput.on("change",function(t){e.currentValue=t})}i(333);var o=i(334).getElementPositionAt,s=i(29).getText,a=i(172).inherits,r=i(335),l=r.DofusButton,c=i(340),d=i(342),u=i(196),h=i(321),p=d.MAX_NUMBER,m=100,f={opacity:0,webkitTransform:"scale(0.8)"},g={opacity:1,webkitTransform:"scale(1)"};a(n,h),e.exports=n,n.prototype.position=function(e,t){var i=o(this,e,t);this.setStyles({left:i.x+"px",top:i.y+"px"})},n.prototype.open=function(e){function t(){delete i.openTweener,i.emit("opened")}var i=this;e=e||{},this.min=e.min||0,this.max=e.max||p;var n;return n=void 0!==e.defaultValue?Math.max(this.min,Math.min(this.max,e.defaultValue)):this.min,void 0!==e.placeholder&&void 0===e.defaultValue?(this.numberInput.setPlaceholder(e.placeholder),this.currentValue=""):this.currentValue=n,this.numberInput.setValue(this.currentValue),this.numberInput.minValue=this.min,this.numberInput.maxValue=this.max,this.show(),e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&this.position(e.x,e.y),this.setStyles(f),this.openTweener?(this.openTweener.cancel(),t()):void(this.openTweener=u.tween(this,g,{time:150,delay:0,easing:"ease-out"},t))},n.prototype.openAround=function(e,t){var i=e.rootElement.getBoundingClientRect();t.x=i.left,t.y=i.top,this.open(t)},n.prototype.closeMinMax=function(){function e(){delete t.closeTweener,t.hide(),t.emit("closed"),t.numberInput.rootElement.blur()}var t=this;return this.closeTweener?(this.closeTweener.cancel(),e()):void(this.closeTweener=u.tween(this,f,{time:150,delay:0,easing:"ease-out"},e))}},function(e,t){},function(e,t,i){function n(e,t,i,n,s){var a=i-e;a<r&&(a=n,a+e>o.screenWidth&&(a=Math.max(0,o.screenWidth-e)));var l=Math.max(s-t,r);return{x:Math.round(a),y:Math.round(l)}}var o=i(166).dimensions;t.positionNextTo=function(e,t,i){e.setStyle("opacity",0),e.show();var n=t.rootElement.getBoundingClientRect(),s=e.rootElement.getBoundingClientRect(),a=0,r=0;if(i&&i.padding){var l=i.padding;s.width+=2*l,s.height+=2*l}n.left>s.width?a=n.left-s.width:o.screenWidth-n.right>s.width&&(a=n.left+n.width),r=o.screenHeight-n.bottom+n.height>s.height?n.top:n.top+n.height>s.height?n.top+n.height-s.height:o.screenHeight-s.height,e.setStyles({left:Math.round(a)+"px",top:Math.round(r)+"px"}),e.setStyle("opacity",1)};var s=42,a=s/2,r=10;t.getElementPositionAt=function(e,t,i){return n(e.rootElement.clientWidth,e.rootElement.clientHeight,t-a,t+a,i-a)};var l=60;t.getElementPositionCenteredAt=function(e,t,i,n){n=n||{};var s=e.rootElement.clientWidth,a=e.rootElement.clientHeight,c=t-s/2;c<r?c=r:c+s>o.screenWidth-r&&(c=o.screenWidth-r-s);var d=void 0!==n.verticalMargin?n.verticalMargin:l,u=i-a-d;return u<r&&(u=i+d),{x:Math.round(c),y:Math.round(u)}},t.getElementPositionAround=function(e,t){var i,o;o=e&&e.rootElement?{width:e.rootElement.clientWidth,height:e.rootElement.clientHeight}:{width:0,height:0},i=t&&t.rootElement?t.rootElement.getBoundingClientRect():{width:0,height:0,left:0,top:0};var s=i.width/2,r=i.height/2,l=i.left+s,c=i.top+r;return s=s<a?a:s,r=r<a?a:r,n(o.width,o.height,l-s,l+s,c-r)},t.getTargetRect=function(e){return e.rootElement.getBoundingClientRect()},t.newTargetRect=function(e,t,i,n){return{left:e-i/2,top:t-n/2,width:i,height:n}},t.getBestTooltipPosition=function(e,t,i){var n,s,a=5,l=i.left+i.width/2,c=i.top+i.height/2;return s=i.top-a-t,s>=r?n=l-e/2:(n=l>o.screenWidth/2?i.left-a-e:l+i.width/2+a,s=c-t/2),n<r?n=r:n+e>o.screenWidth-r&&(n=o.screenWidth-r-e),s<r?s=r:s+t>o.screenHeight-r&&(s=o.screenHeight-r-t),{x:Math.round(n),y:Math.round(s)}}},function(e,t,i){function n(e,t){e=e||{},r.call(this,"div",e),this.addClassNames("Button"),l(this,{repeatDelay:e.repeatDelay,doubletapTimeout:1});var i=e.addIcon;if(i){if("string"==typeof i&&d.indexOf(i)<0)return console.error("Invalid addIcon option:",i);var n=new r("div",{className:"btnIcon"});"before"===i&&this.appendChild(n),e.text&&this.createChild("div",{className:"btnText",text:e.text}),"after"!==i&&i!==!0||this.appendChild(n)}(e.scaleOnPress||void 0===e.scaleOnPress)&&this.addClassNames("scaleOnPress"),e.tooltip&&s(this,e.tooltip),"function"==typeof t&&this.on("tap",t),this.on("tap",function(){c(e.sound||"GEN_BUTTON")}),this.on("tapstart",function(){this.addClassNames("pressed")}),this.on("tapend",function(){this.delClassNames("pressed")}),this.on("enable",function(e){this.toggleClassName("disabled",!e)}),e.disable&&this.disable()}function o(e,t,i){t=t||{},t.text=e,n.call(this,t,i),this.addClassNames("button")}i(336);var s=i(337).addTooltip,a=i(172).inherits,r=i(321),l=i(197),c=i(247).playUiSound,d=["before","after"];a(n,r),e.exports=n,a(o,n),n.DofusButton=o},function(e,t){},function(e,t,i){function n(e){e=e||{};var t={className:["TooltipBox",e.className],hidden:!0};e.name&&(t.name=e.name),g.call(this,"div",t),this.content=this.createChild("div",{className:"content"}),this.openState=!1,this.setStyle("opacity",0),e.content&&this._setContent(e.content)}function o(){this.delClassNames("transition")}function s(){this.delClassNames("transition"),this.hide()}function a(){d&&(d.emit("tooltipOut"),d=null),clearTimeout(h),h=null,c._closeTooltip(!1)}function r(){d&&(d.emit("tooltipOut"),d=null),clearTimeout(h),h=setTimeout(a,500)}function l(e){return Math.max(I,e/25*1e3)}i(338);var c,d,u,h,p=i(334),m=i(339),f=i(172).inherits,g=i(321),_=i(196),v=i(197),y=i(320),b=i(200),M=i(247).playUiSound,w=16,T=1,C=350,A=50;f(n,g);var t=e.exports=n;n.prototype.updateAndAppearAt=function(e,t){this._updateAndAppear(e,p.getTargetRect(t))},n.prototype._setContent=function(e){for(var t=this.content.getChildren(),i=0;i<t.length;i++)this.content.removeChild(t[i]);e&&this.content.appendChild(e)},n.prototype._prepareForNewContent=function(){var e=this.content.rootElement.clientWidth+w,t=this.content.rootElement.clientHeight+w;return _.cancelTween(this),this.delClassNames("transition"),this.setStyles({width:C+"px",overflow:"hidden"}),this.content.setStyles({width:null,height:null}),[e,t]},n.prototype._updateAndAppear=function(e,t){var i=this._prepareForNewContent();e&&this._setContent(e),this.show();var n=this.content.rootElement.clientWidth+T,s=this.content.rootElement.clientHeight,a=n+w,r=s+w,l=p.getBestTooltipPosition(a,r,t),c="translate3d("+l.x+"px,"+l.y+"px,0)";this.content.setStyles({width:n+"px",height:s+"px"}),this.openState?(this.setStyles({width:i[0]+"px",height:i[1]+"px",overflow:null}),m.forceReflow(this),this.addClassNames("transition"),_.tween(this,{width:a+"px",height:r+"px",webkitTransform:c},{time:150,easing:"ease-out"},o)):(this.openState=!0,this.setStyles({width:a+"px",height:r+"px",overflow:null,webkitTransform:c,opacity:1}),M("ROLLOVER"))},n.prototype.closeForRecomputing=function(){c._closeTooltip(!0)},n.prototype.closeTooltip=function(){this._closeTooltip(!1)},n.prototype._closeTooltip=function(e){this.openState&&(this.openState=!1,e?(this.setStyle("opacity",0),s.call(this)):_.tween(this,{opacity:0},{time:150,easing:"ease-out"},s))},t.initialiseTooltipBehavior=function(e){return c=new n,e.on("dom.touchend",function(){u&&y.stop(),u=!1,a()}),c},t.addTooltip=function(e,t,i){function n(){var i=t;return"function"==typeof t&&(i=t.call(e),i="string"==typeof i?new g("div",{text:i}):i),i}function o(){if(e._tooltipEnabled&&b.requestInteractionHandle(c)&&(clearTimeout(h),h=null,!d||d!==e)){var t=n(),i=t instanceof g;if(d&&d.emit("tooltipOut"),!i)return c._closeTooltip(!0),void c._setContent(!1);c._updateAndAppear(t,p.getTargetRect(e)),d=e,e.emit("tooltipOn")}}e.hasOwnProperty("_tooltipEnabled")||(e._tooltipEnabled=!0,i=i||{},t="string"==typeof t?new g("div",{text:t}):t,v(e),y(e),e.on("longtap",function(){y.start(),o(),u=!0}),e.on("touchenter",function(){u&&o()}),i.openOnTap&&e.on("tap",o),e.on("touchleave",r))},n.prototype.openTooltipAt=function(e,t,i,n){var o=p.newTargetRect(e,t,i||A,n||A);this._updateAndAppear(null,o)},t.enableTooltip=function(e,t){e.hasOwnProperty("_tooltipEnabled")&&e._tooltipEnabled!==t&&(e._tooltipEnabled=t)};var I=3e3;t.computeNotificationDisplayTime=l,t.showNotification=function(e,t,i){"string"==typeof e?(i=i||l(e.length),e=c.createChild("div",{text:e})):i=i||I,c._updateAndAppear(e,p.getTargetRect(t)),clearTimeout(h),h=setTimeout(a,i)}},function(e,t){},function(e,t,i){function n(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}var o=i(29).getText,s=i(31),a=i(28).time.dofusTimeYearLag,r=i(196),l=i(198).events;t.sortObjectInArray=function(e,t,i){var n=i?1:-1,o=i?-1:1;e.sort(function(e,i){return e[t]<i[t]?n:e[t]>i[t]?o:0})},t.getObjectInArrayIndexById=function(e,t,i){if(!Array.isArray(e))return console.error("Input not an array.",e);for(var n=0;n<e.length;n+=1){var o=e[n];if(o.hasOwnProperty(t)&&o[t]===i)return n}return-1},t.getObjectInArrayById=function(t,i,n){var o=e.exports.getObjectInArrayIndexById(t,i,n);if(o>=0)return t[o]},t.removeObjectInArrayById=function(e,t,i){if(!Array.isArray(e))return console.error("Input not an array.",e);for(var n=!1,o=e.length-1;o>=0;o-=1){var s=e[o];s.hasOwnProperty(t)&&s[t]===i&&(e.splice(o,1),n=!0)}return n},t.mergeObjects=function(e){for(var t=e||arguments,i={},n=0,o=t.length;n<o;n+=1){var s=t[n];for(var a in s)s.hasOwnProperty(a)&&(i[a]=s[a])}return i};var c=/[^0-9]+/g,d=/\B(?=(\d{3})+(?!\d))/g,u=null,h=null;t.kamasToString=function(e,t){t||""===t||(t=o("ui.common.short.kama"));var i=this.intToString(e);return t?i+" "+t:i},t.stringToKamas=function(e){return Number(e.replace(c,""))},t.intToString=function(e){return isNaN(e)||null===e?"":(h=null!==h?h:o("ui.common.numberSeparator"),e.toString().replace(d,h))},t.stringToInt=function(e){return u||(h=null!==h?h:o("ui.common.numberSeparator"),u=new RegExp(n(h),"g")),Number(e.replace(u,""))},t.hardAndSoftToString=function(e,i){var n=e?t.kamasToString(e,"G")+" / ":"";return n+t.kamasToString(i,"K")},t.extractElementsFrom=function(e,t,i,n){i=i||!1,n=n||"id",e=e.map(function(e){return e.toString()});var o,s;if(o=i?{}:[],t instanceof Array){var a=t.length;for(s=0;s<a;s++)t[s]&&e.indexOf(t[s][n].toString())!==-1&&(i?o[t[s][n]]=t[s]:o.push(t[s]))}else for(s in t)t[s]&&e.indexOf(t[s][n].toString())!==-1&&(i?o[t[s][n]]=t[s]:o.push(t[s]));return o},t.storeMapAndEmit=function(e,t,i,n){var o=!1;for(var s in i)t[s]!==i[s]&&(t[s]=i[s],o=!0);o&&e.emit(n)},t.storeValueAndEmit=function(e,t,i,n,o){t[i]!==n&&(t[i]=n,e.emit(o,n))},t.hexToRgb=function(e){for(var t=6-e.length,i=0;i<t;i++)e=t+e;var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null},t.durationToString=function(e){var t=~~e%60;t<10&&(t="0"+t);var i=~~(e/60)%60;i<10&&(i="0"+i);var n=~~(e/3600);return n<10&&(n="0"+n),n+":"+i+":"+t},t.getAlmanaxDate=function(e,t){e=e?new Date(e):new Date;var i=t?e.getFullYear():e.getUTCFullYear(),n=t?e.getMonth():e.getUTCMonth(),o=t?e.getDate():e.getUTCDate(),s=t?e.getHours():e.getUTCHours(),r=t?e.getMinutes():e.getUTCMinutes();return{year:i+a,month:n+1,day:o,monthName:window.gui.databases.Months[n].nameId,hour:s<10?"0"+s:s,minute:r<10?"0"+r:r}},t.simplifyString=function(e){e=e.split("");for(var t=[],i=e.length,n="ÀÁÂÃÄÅàáâãäåÒÓÔÕÕÖØòóôõöøÈÉÊËèéêëðÇçÐÌÍÎÏìíîïÙÚÛÜùúûüÑñŠšŸÿýŽž",o="AAAAAAaaaaaaOOOOOOOooooooEEEEeeeeeCcDIIIIiiiiUUUUuuuuNnSsYyyZz",s=0;s<i;s++)n.indexOf(e[s])!==-1?t[s]=o.substr(n.indexOf(e[s]),1):t[s]=e[s];return t=t.join(""),t.toLowerCase()},t.createFifo=function(){return s.queue(function(e,t){try{e(function(e){if(e)throw new Error(e);t()})}catch(i){console.error(i),t(i)}})},t.getObjectInstanceName=function(e){if(!e)return null;var t=/function ([^(]+)/.exec(String(Object.getPrototypeOf(e).constructor))||[];return t[1]},t.mapToArray=function(e,t){for(var i=Object.keys(e),n=i.length,o=new Array(n),s=0;s<n;s++)o[s]=e[i[s]];if(t&&t.sortBy){var a=t.sortBy;o.sort(function(e,t){return e[a]-t[a]})}return o},t.forceReflow=function(e){e.rootElement.offsetWidth},t.showProgressively=function(e,i,n,o){function s(){o&&r.tween(o,{opacity:0},{time:i||250}),e&&r.tween(e,{opacity:1},{time:i||250})}e&&(e.setStyle("opacity",0),e.show(),t.forceReflow(e)),n?window.setTimeout(s,n):s()},t.allLinksOnTargetBlank=function(e){function t(e,t){e.addEventListener(l.end,function(e){t=encodeURI(t),i.openUrlInAppBrowser(t),e.preventDefault()})}for(var i=this,n=e.rootElement.getElementsByTagName("a"),o=0;o<n.length;o++)n[o].href&&t(n[o],n[o].href)},t.openUrlInDeviceBrowser=function(e){window.open(e,"_system")};var p;if(window.cordova&&window.cordova.InAppBrowser){var m,f=function g(){m.removeEventListener("exit",g),m=null};p=function(e){return m?console.error(new Error("unable to open url "+e+": in app browser is already opened")):(m=window.cordova.InAppBrowser.open(e,"_blank","closebuttoncaption="+o("tablet.common.backToGame")),void m.addEventListener("exit",f))}}else p=function(e){window.open(e,"_blank")};t.openUrlInAppBrowser=p,t.cssTransform=function(e,t){e.setStyles({transform:t,oTransform:t,msTransform:t,mozTransform:t,webkitTransform:t})},t.cssTransition=function(e,t){e.setStyles({transition:t,oTransition:t,msTransition:t,mozTransition:t,webkitTransition:t})},t.createPropertyNameCompareFunc=function(e){return function(t,i){return t[e]<i[e]?-1:t[e]>i[e]?1:0}},t.jeffVersionDowngrader=function(e,i){if(i||e.meta&&e.meta.version){if(void 0!==e.x&&(e.x*=-1),void 0!==e.y&&(e.y*=-1),void 0!==e.transforms&&(e.matrices=e.transforms,delete e.transforms),void 0!==e.isAnimation&&(e.isAnim=e.isAnimation,delete e.isAnimation),e.symbols)for(var n in e.symbols)t.jeffVersionDowngrader(e.symbols[n],!0);if(e.children)for(var o in e.children)t.jeffVersionDowngrader(e.children[o],!0)}}},function(e,t,i){function n(e){e=e||{},this.title=e.title,this.minValue=void 0!==e.minValue?e.minValue:d,this.maxValue=e.maxValue||c;var t={type:"text",maxlength:u+1,placeholder:0
};if(e.attr)for(var i in e.attr)t[i]=e.attr[i];e.attr=t,l.call(this,"input",e),this.addClassNames("NumberInputBox"),r(this),this.on("tap",this._tapOnNumberInputBox)}i(341);var o=i(339),s=i(172).inherits,a=i(342),r=i(197),l=i(321),c=a.MAX_NUMBER,d=1,u=a.MAX_NUMBER_LEN;s(n,l),e.exports=n,n.prototype._parseNumber=function(e){var t=o.stringToInt(e);return Math.min(Math.max(t,this.minValue),this.maxValue)},n.prototype._tapOnNumberInputBox=function(){this.emit("focus"),void 0===this.minValue&&(this.minValue=d),void 0===this.maxValue&&(this.maxValue=c),window.gui.numberInputPad.open(this,this.title,this.minValue,this.maxValue)},n.prototype.promptForValue=function(e){function t(){n=!0}if(this._tapOnNumberInputBox(),e){var i=this,n=!1;this.on("change",t),window.gui.numberInputPad.once("hide",function(){return i.removeListener("change",t),e(n)})}},n.prototype.getValue=function(){return o.stringToInt(this.rootElement.value)},n.prototype.getFormattedValue=function(){return o.intToString(o.stringToInt(this.rootElement.value))},n.prototype.setValue=function(e,t){var i,n;"number"==typeof e?(n=e,i=o.intToString(n)):(i=e,n=this._parseNumber(i)),this.rootElement.value=i,t&&this.emit("change",n)},n.prototype.setReadonly=function(e){e===!1?this.rootElement.removeAttribute("readonly"):this.rootElement.setAttribute("readonly","readonly"),this.setEnable(!e)},n.prototype.setPlaceholder=function(e){this.rootElement.placeholder=e},n.prototype.blur=function(){},n.prototype.focus=function(){},n.prototype.disable=function(){this.setEnable(!1),this.rootElement.disabled=!0},n.prototype.enable=function(){this.setEnable(!0),this.rootElement.disabled=!1}},function(e,t){},function(e,t){e.exports={MAP_CELL_COUNT:560,MAX_LEVEL:200,MAX_GUILD_LEVEL:200,MAX_MOUNT_LEVEL:100,MAX_CHAT_LEN:512,USER_MAX_CHAT_LEN:256,MIN_LOGIN_LEN:3,MAX_LOGIN_LEN:50,MIN_PLAYER_NAME_LEN:2,MAX_PLAYER_NAME_LEN:20,MIN_NICK_LEN:2,MAX_NICK_LEN:30,MIN_GUILDNAME_LEN:3,MAX_GUILDNAME_LEN:30,MIN_ALLIANCENAME_LEN:3,MAX_ALLIANCENAME_LEN:30,MIN_ALLIANCETAG_LEN:3,MAX_ALLIANCETAG_LEN:5,MAX_PLAYER_COLOR:5,MAX_ENTITY_COLOR:8,MAX_PLAYERS_PER_TEAM:8,MAX_MEMBERS_PER_PARTY:8,MAX_GUESTS_PER_PARTY:7,MAX_MEMBERS_PER_ARENA_PARTY:5,MAX_MONSTERS_IN_GROUP_ON_MAP:16,MAX_CHAT_OBJECT_REF:16,NOT_EQUIPED:63,MAX_EQUIPED:255,MAX_JOBS_PER_CHARACTER:6,MAX_CRAFT_SLOT:9,MAX_JOB_LEVEL:100,MAX_HONOR:2e4,MAX_SHORTCUT:99,MAX_ARENA_RANK:2300,CHAR_MIN_LEVEL_ARENA:50,CHAR_MIN_LEVEL_RIDE:60,MAX_DUNGEON_REGISTER:10,MIN_RIDE_NAME_LEN:0,MAX_RIDE_NAME_LEN:16,MAX_EFFECTS_COUNT:100,MAX_LOCKABLE_CODE_LEN:8,MAX_PRESET_ITEM_COUNT:24,MIN_OBJ_COUNT_BY_XFERT:1,MAX_OBJ_COUNT_BY_XFERT:1e3,MAX_OBJECT_EFFECT_STRING_LEN:30,MAX_PLAYER_OR_ACCOUNT_NAME_LEN:31,MAX_NUMBER:2e9,MAX_NUMBER_LEN:13}},function(e,t){e.exports={TEAM_CHALLENGER:0,TEAM_DEFENDER:1,TEAM_SPECTATOR:2}},function(e,t,i){var n=i(316),o=i(29).getText;n.prototype._setupInfoBox=function(){var e=this.infoBox=this.createChild("div",{className:"infoBox",hidden:!0});e.mp=e.createChild("div",{className:"mp"}),e.ap=e.createChild("div",{className:"ap"})},n.prototype.hideInfobox=function(){this.infoBox.hide()},n.prototype.showInfobox=function(e,t){"tackle"===e&&(this.infoBox.mp.setText(t.mp?-t.mp+" "+o("ui.stats.shortMP"):""),this.infoBox.ap.setText(t.ap?-t.ap+" "+o("ui.stats.shortAP"):"")),this.infoBox.show()}},function(e,t,i){var n=i(335),o=i(316),s=i(29).getText,a=i(334).getElementPositionCenteredAt,r=i(198).position,l=i(196);o.prototype._createConfirmBox=function(){function e(){o.hide(),o.tween=null}var t,i={x:0,y:0},o=this.confirmBox=window.gui.gameGuiContainer.createChild("div",{className:"fightConfirmBox",hidden:!0});o.isOpen=!0,o.allowDomEvents();var c=o.createChild("div",{className:"title"}),d=o.createChild("div",{className:"content"});d.appendChild(new n({className:"cancel",scaleOnPress:!0},function(){t(!1),o.close()}));var u=d.createChild("div",{className:"mpAndAp"}),h=u.createChild("div",{className:"mp"});h.createChild("div",{className:"logo"});var p=h.createChild("div",{className:"value"}),m=u.createChild("div",{className:"ap"});m.createChild("div",{className:"logo"});var f=m.createChild("div",{className:"value"}),g=d.appendChild(new n({className:"valid",scaleOnPress:!0},function(){g.disable(),t(!0),o.close()})),_=null;o.open=function(e,n,d,u,v){return _&&u&&_===u?(d(!0),void o.close()):(_=u,g.enable(),"move"===e?(c.setText(s("ui.common.move")),h.show(),p.setText(s("ui.short.movementPoints")+s("ui.common.colon")+"-"+n.mp),n.ap>0?(f.setText(s("ui.short.actionPoints")+s("ui.common.colon")+"-"+n.ap),m.show()):m.hide()):(c.setText(n.name),h.hide(),m.show(),f.setText(s("ui.short.actionPoints")+s("ui.common.colon")+"-"+n.apCost)),o.show(),i=a(o,r.x,r.y),o.isOpen?o.setStyles({webkitTransformOrigin:r.x+"px "+r.y+"px"}):o.setStyles({webkitTransform:"scale(0) translate3d("+i.x+"px,"+i.y+"px,0)",webkitTransformOrigin:r.x+"px "+r.y+"px"}),l.tween(o,{webkitTransform:"scale(1) translate3d("+i.x+"px,"+i.y+"px,0)"},{time:100,easing:"linear"}),o.isOpen=!0,v&&o.hide(),void(t=d))},o.close=function(){o.isOpen&&(o.isOpen=!1,g.disable(),_=null,l.tween(o,{webkitTransform:"scale(0) translate3d("+i.x+"px,"+i.y+"px,0)"},{time:100,easing:"linear"},e))},o.close()}},function(e,t,i){var n=i(347).FIGHT_STATES,o=i(316),s=i(166).dimensions,a=i(334),r=a.getElementPositionAt,l=i(198),c=l.position,d=l.getPosition,u=i(200).requestInteractionHandle,h=i(417),p=i(419),m=i(337),f=i(196),g=i(392).Tween,_=i(420),v=i(426),y=i(321),b=i(29).getText,M=10;o.prototype._setupTouchInteraction=function(){function e(e){if(h.isVisible()){var t=r(h,e.x,e.y);h.setStyle("webkitTransform","translate3d("+t.x+"px, "+t.y+"px, 0)")}}function t(t){var i=d(t);if(e(i),Math.abs(s-i.x)>10||Math.abs(a-i.y)>10){if(!u(f))return l();s=i.x,a=i.y;var n=c.convertScreenToCanvasCoordinate(s,a);p.touchMove(n.x,n.y,this.tapOptions)}}var i,o,s,a,l,c=this,h=this.infoBox,p=window.isoEngine,m=window.gui.fightManager,f={};l=function(){o=!0,p.touchCancel(),c.removeListener("dom.touchmove",t)},this.on("dom.touchstart",function(e){if(i)return l();var r=d(e);this.locked||r.touchCount>1||(s=r.x,a=r.y,i=!0,o=!1,m.fightState===n.BATTLE&&this.on("dom.touchmove",t))}),this.on("dom.touchend",function(e){if(this.removeListener("dom.touchmove",t),this.locked||o||!i||!u(f))return void(i=!1);i=!1;var n=d(e),s=c.convertScreenToCanvasCoordinate(n.x,n.y);p.touchEnd(s.x,s.y,this.tapOptions)}),this._setupHighlightInteraction(),this._setupCameraInteraction()},o.prototype._setupHighlightInteraction=function(){function e(){window.clearTimeout(C),C=window.setTimeout(function(){E.closeTooltip()},500)}function t(e){for(var t,i,n,o,s=e.humanoidInfo.options||[],a=0;a<s.length;a+=1){var r=s[a];"HumanOptionGuild"===r._type?n=r.guildInformations:"HumanOptionAlliance"===r._type?o=r.allianceInformations:"HumanOptionOrnament"===r._type?i=r.ornamentId:"HumanOptionTitle"===r._type&&(t=r.titleId)}var l=e.alignmentInfos.characterPower-e.actorId,c=window.gui.playerData.getLevelDiff(l);u.setAttributes({charName:e.name,titleId:t,ornamentId:i,guild:n,alliance:o,gender:e.humanoidInfo.sex,alignmentInfos:e.alignmentInfos,levelDiff:c}),u.display()}function i(){f.getChild("ornamentTooltip")&&f.removeChild("ornamentTooltip"),f.getChild("propertyInfoTooltip")&&f.removeChild("propertyInfoTooltip"),f.clearContent()}function n(e){window.clearTimeout(C);var t=e.bbox,i=x.convertSceneToCanvasCoordinate(t[0],t[2]),n=x.convertSceneToCanvasCoordinate(t[1],t[3]),o=(i.x+n.x)/2,s=(i.y+n.y)/2,a=n.x-i.x,r=n.y-i.y;E.openTooltipAt(o,s,a,r+2*M)}function o(t){var i=S.getFighter(t.actorId);return i?(f.appendChild(i.createStatsTooltipContent()),window.isoEngine.displayEnemyMovementZone(i),!0):(E.openState&&(e(),window.isoEngine.removeEnemyMovementZone()),!1)}function s(i,n){if(n.name&&n.humanoidInfo)return w=i,t(n),E.addClassNames("noBackground"),!1;if(n.npcData&&n.npcData.nameId)f.setText(n.npcData.nameId);else if("GameRolePlayGroupMonsterInformations"===n.type){f.appendChild(new h(n.ageBonus));for(var o=[n.staticInfos.mainCreatureLightInfos].concat(n.staticInfos.underlings),s=0,a=o.length;s<a;s+=1){var r=o[s].staticInfos;r&&f.createChild("div",{text:r.nameId+" ("+r.level+")"})}}else{if("PaddockObject"!==n.type)return E.openState&&e(),!1;var l=n.durability.durability+"/"+n.durability.durabilityMax;f.setText(n.name+" ("+l+")")}return!0}function a(e,t){var i=t.guildInfo,n=t._type,o=t.price,s=t.maxOutdoorMount,a=t.maxItems,r="",l="";switch(n){case"PaddockInformations":r=b("ui.mount.paddockPublic"),l=b("ui.mount.maxMount",s);break;case"PaddockAbandonnedInformations":r=b("ui.mount.paddockAbandonned"),l=b("ui.mount.maxMount",s);break;case"PaddockPrivateInformations":r=o>0?b("ui.mount.paddockToBuy",o):b("ui.mount.paddockPrivate"),l=b("ui.mount.paddockSize",s,a);break;case"PaddockBuyableInformations":r=t.locked?b("ui.social.paddockWithNoOwner"):b("ui.mount.paddockToBuy",o),l=b("ui.mount.paddockSize",s,a)}var c={guild:i,line1:r,line2:l};T=e,p.display(c)}function r(e,t){var i=I.playerData,n=t.ownerName,o=b("ui.house.homeOf",n),s=t.houseId,a=i.identification.nickname,r=i.position.currentMapHouses[s]||null,l=r&&r.guildInfo||null;"?"===n||""===n?o=b("ui.common.houseWithNoOwner"):n===a&&(o=b("ui.common.myHouse"));var c=null;r&&(r.isOnSale||r.isSaleLocked)&&(c=b(r.isSaleLocked?"ui.common.forSaleSoon":"ui.common.forSale"));var d={guild:l,line1:o,line2:c};T=e,p.display(d)}function l(){var t=d.convertScreenToCanvasCoordinate(c.x,c.y),l=A.holdAndMove(t.x,t.y);if(!l)return g=null,void(E.openState&&e());if(g!==l){g=l;var u,p,m,_,v=A.mapRenderer.isPaddock(l),y=A.mapRenderer.getPaddockProperties(),b=l.data,M=I.playerData.isFighting;if(v&&y)return i(),void a(l,y);if(b){if(i(),M){if(!o(b))return}else if(!s(l,b))return}else{if(u=N.interactiveElements[l.id],!u||M)return void(E.openState&&e());i();var w=u._houseData;if(u.ageBonus){var T=u.ageBonus;f.appendChild(new h(T))}if(u._name&&f.createChild("div",{className:"name",text:u._name}),w)return void r(l,w);var C;for(m=0,_=u.enabledSkills.length;m<_;m+=1)p=u.enabledSkills[m],C=f.createChild("div"),C.createChild("div",{className:["interaction","cursor","id"+p._cursor]}),C.createChild("div",{className:"interaction",text:p._name});for(m=0,_=u.disabledSkills.length;m<_;m+=1)p=u.disabledSkills[m],C=f.createChild("div"),C.createChild("div",{className:["interaction","cursor","id"+p._cursor,"disable"]}),C.createChild("div",{className:"interaction",text:p._name})}E.delClassNames("noBackground"),n(l)}}var d=this,u=new _({name:"ornamentTooltip"},{scaleFactor:.8}),p=new v({name:"propertyInfoTooltip"}),f=new y("div",{className:"sceneTooltip"});m.addTooltip(this,new y("div"));var g,w,T,C,A=window.isoEngine,I=window.gui,S=I.fightManager,E=this.appendChild(new m({content:f})),x=A.mapScene,N=A.mapRenderer;this.on("tooltipOn",function(){window.gui.tooltipBox.closeForRecomputing(),g=null,A.holdStart(),I.wBody.on("dom.touchmove",l),l()}),this.on("tooltipOut",function(){E.closeTooltip(),I.wBody.removeListener("dom.touchmove",l),A.holdEnd()}),u.on("rendered",function(){w===g&&(f.appendChild(u),n(w))}),p.on("rendered",function(){T===g&&(f.appendChild(p),n(T))})},o.prototype._setupCameraInteraction=function(){function e(e){D[I]=e[I]-E[I],D[S]=e[S],D[I]<N.min?(D[I]=N.min,E[I]=e[I]-N.min):D[I]>N.max&&(D[I]=N.max,E[I]=e[I]-N.max),b.setStyle("webkitTransform","translate3d("+D.x+"px,"+D.y+"px,0)")}function t(e){L[S]=D[S];var t=o.convertScreenToCanvasCoordinate(L.x,L.y);if(C=r.getChangeMapCellAt(t.x,t.y,M),b.arrow.setStyle("opacity",C!==-1?1:0),e[S]<w)A=Math.abs(w-e[S]),P[S]=c.min[S];else{if(!(e[S]>T))return;A=Math.abs(T-e[S]),P[S]=c.max[S]}if(P[S]!==c[S]){R.x=c.x,R.y=c.y,c.follow(R);var i=0,n=k,s=R[S],a=P[S];Math.abs(P[S]-R[S])>i&&(i=Math.abs(P[S]-R[S]),n=k*A);var l=B[S];l.playing||l.start(!1),"x"===S?l.reset().from({x:s}).to({x:a},i/n):l.reset().from({y:s}).to({y:a},i/n)}}p(this);var i,o=this,a=window.gui,r=window.isoEngine,l=r.mapScene,c=l.camera,d=a.fightManager,u=0,h=0,m=this.createChild("div",{className:["slide","left"]});m.arrow=m.createChild("div",{className:"arrow"});var _=this.createChild("div",{className:["slide","right"]});_.arrow=_.createChild("div",{className:"arrow"});var v=this.createChild("div",{className:["slide","top"]});v.arrow=v.createChild("div",{className:"arrow"});var y=this.createChild("div",{className:["slide","bottom"]});y.arrow=y.createChild("div",{className:"arrow"});var b,M,w,T,C,A,I,S,E={x:0,y:0},x={x:80,y:60},N={max:0,min:0},L={},O=5,D={x:0,y:0},R={},P={x:0,y:0},B={x:new g(R,["x"]),y:new g(R,["y"])};this.on("transformStart",function(e,t){if(this.locked)return this.cancelTransform();if(b=null,d.fightState===n.UNDEFINED&&1===e.touchCount){var o=e.x-t[0].x,a=e.y-t[0].y;E=e;var r,l=c.zoom===c.minZoom||c.zoom===c.maxZoom;if(Math.abs(o)>Math.abs(a)){if(r=l||Math.abs(a)<O,Math.abs(c.x-c.min.x)<1&&o>0&&r)return b=m,M="left",L.x=0,N.min=0,N.max=x.x,w=s.mapHeight/3,T=2*w,I="x",void(S="y");if(Math.abs(c.x-c.max.x)<1&&o<0&&r)return b=_,M="right",L.x=s.mapWidth,N.min=-x.x,N.max=0,w=s.mapHeight/3,T=2*w,I="x",void(S="y")}else{if(r=l||Math.abs(o)<O,Math.abs(c.y-c.min.y)<1&&a>0&&r)return b=v,M="top",L.y=0,N.min=0,N.max=x.y,w=s.mapWidth/3,T=2*w,I="y",void(S="x");if(Math.abs(c.y-c.max.y)<1&&a<0&&r)return b=y,M="bottom",L.y=s.mapHeight,N.min=-x.y,N.max=0,w=s.mapWidth/3,T=2*w,I="y",void(S="x")}}u=h=0,this.setTranslationEnable(!0),i=Date.now()});var k=.5;this.on("transform",function(n,o,s,a,d,p){return b?(e(p),void t(p)):(r.cancelCameraMovement(),i=Date.now(),c.zoom===c.minZoom&&(s=a=0),u=.5*u+.5*-s,h=.5*h+.5*-a,void l.move(n,o,-s,-a,d))}),this.on("transformEnd",function(){if(B.x.playing&&B.x.stop(),B.y.playing&&B.y.stop(),b){var e;if(e="x"===I?"translate3d(0,"+D.y+"px,0)":"translate3d("+D.x+"px,0,0)",f.tween(b,{webkitTransform:e},{time:200,easing:"ease-out"}),b.arrow.setStyle("opacity",0),b=null,this.locked)return;if(Math.abs(D[I])===x[I]&&C!==-1){var t=o.convertScreenToCanvasCoordinate(L.x,L.y),s=l.convertCanvasToSceneCoordinate(L.x,L.y);r._tapRoleplay(s.x,s.y,r.mapRenderer.getCellId(s.x,s.y),{canvasX:t.x,canvasY:t.y,changeMapRequest:M,mode:"roleplay"})}}else this.setTranslationEnable(d.fightState!==n.BATTLE),Date.now()-i>100||c.addInertia(u,h,.8)}),d.on("fightEnterBattle",function(){o.setTranslationEnable(!1)}),d.on("fightEnd",function(){o.setTranslationEnable(!0)}),a.playerData.position.on("mapUpdate",function(){c.follow(window.isoEngine.actorManager.userActor)})},o.prototype.convertScreenToCanvasCoordinate=function(e,t){return{x:e-s.mapLeft,y:t-s.mapTop}},o.prototype.convertCanvasToScreenCoordinate=function(e,t){return{x:e+s.mapLeft,y:t+s.mapTop}},o.prototype.convertScreenToSceneCoordinate=function(e,t){return e-=s.mapLeft,t-=s.mapTop,window.isoEngine.mapScene.convertCanvasToSceneCoordinate(e,t)},o.prototype.convertSceneToScreenCoordinate=function(e,t){var i=window.isoEngine.mapScene.convertSceneToCanvasCoordinate(e,t);return{x:i.x+s.mapLeft,y:i.y+s.mapTop}}},function(e,t,i){function n(e){e=void 0===e||e,this.castingSpellId=null,this.casterId=null,this.targetedCell=null,this.spell=null,this.spellRank=null,this.markId=null,this.markType=null,this.silentCast=null,this.weaponId=-1,this.isCriticalHit=null,this.isCriticalFail=null,e&&(this.castingSpellId=n.uniqueSpellId++)}function o(){r.call(this),this.turnCount=0,this.fightId=null,this.turnsList=[],this.deadTurnsList=[],this.currentFighterId=0,this._lastFighterId=0,this._fighters={},this.FIGHT_STATES=L,this.fightState=L.UNDEFINED,this.fightType=O,this.isInReconnection=!1,this.isInactive=!1,this.turnStartTime=0,this.spellCastCounts={},this.fightMessagesStack=[],this.isProcessing=!1,this.asyncFightMessages={GameActionFightDispellableEffectMessage:this.addDispellableEffect,GameActionFightCloseCombatMessage:this.gameActionFightCloseCombatAndSpell,GameActionFightSpellCastMessage:this.gameActionFightCloseCombatAndSpell},a=window.gui.playerData,this._isTurnEndRequestPending=!1,this._finishFightSequenceCb=null}function s(e){switch(e._messageType){case"GameFightRefreshFighterMessage":case"GameFightShowFighterMessage":return e.informations;case"GameActionFightSummonMessage":return e.summon;default:return null}}var a,r=i(188).EventEmitter,l=i(29).getText,c=i(199),d=i(172).inherits,u=i(176),h=i(348),p=i(349),m=i(350),f=i(368),g=i(353),_=i(412),v=i(365),y=i(31),b=i(194),M=i(363),w=i(414),T=w.pushStep,C=i(415).SpellData.SPELL_STATUS,A=i(258),I=1e4,S=1024,E=1097,x=1008,N=_.WEAPON_SPELL_ID,L={UNDEFINED:-1,PREPARATION:0,BATTLE:1},O=-1,D={isSecret:p.FIGHT_OPTION_SET_SECRET,isRestrictedToPartyOnly:p.FIGHT_OPTION_SET_TO_PARTY_ONLY,isClosed:p.FIGHT_OPTION_SET_CLOSED,isAskingForHelp:p.FIGHT_OPTION_ASK_FOR_HELP},R=[p.FIGHT_OPTION_SET_TO_PARTY_ONLY,p.FIGHT_OPTION_SET_CLOSED,p.FIGHT_OPTION_ASK_FOR_HELP];n.uniqueSpellId=0;var P;d(o,r),e.exports=o,o.FIGHT_STATES=L,o.FIGHT_OPTION_KEY_TO_ENUM=D,o.FIGHT_OPTION_ICON_ID=R,o.prototype.INCREMENT_MODE_SOURCE=1,o.prototype.INCREMENT_MODE_TARGET=2,o.prototype.getFighters=function(){return"fightPlacement"===window.foreground.tapOptions.mode?this.getOrdonnedPreFighters():this.turnsList},o.prototype.getDeadFighters=function(){return this.deadTurnsList},o.prototype.getAvailableFighters=function(){return this._fighters},o.prototype.getFighter=function(e){return this._fighters[e]},o.prototype.getTurnCount=function(){return this.turnCount},o.prototype.getFighterSpell=function(e,t,i){var n=this.getAvailableFighters(),o=n[t];if(!o)return i(new Error("Spell could not be found, its fighter does not exist"));if(o.spells[e])return i(null,o.spells[e]);var s=a.characters.mainCharacter.spellData;if(s.spells[e])return o.spells[e]=s.spells[e].clone(),o.spells[e].setLevel(s.spells[e].level),i(null,o.spells[e]);for(var r in n){var l=n[r];if(l.id!==t&&l.spells[e])return o.spells[e]=l.spells[e].clone(),i(null,o.spells[e])}_.createSpells([e],function(t,n){return t?i(t):(o.spells[e]=n[e],i(null,o.spells[e]))})},o.prototype._checkInactivityOnTurnStart=function(){this.isInactive&&(c.isActiveSince(this.turnStartTime)?this.isInactive=!1:this.finishTurn()),this.turnStartTime=Date.now()},o.prototype.finishTurn=function(){window.dofus.sendMessage("GameFightTurnFinishMessage"),this._isTurnEndRequestPending=!0},o.prototype._checkInactivityOnTurnEnd=function(){!this.isInactive&&!c.isActiveSince(this.turnStartTime)&&Date.now()-this.turnStartTime>I&&(this.isInactive=!0,window.gui.openSimplePopup(l("ui.fight.inactivityMessage"),l("ui.fight.inactivityTitle")))},o.prototype.initialize=function(e){function t(){e.timeline&&e.timeline.close(),r.turnsList=[],r.deadTurnsList=[],r.fightId=null,r.currentFighterId=0,r._lastFighterId=0;for(var t in r._fighters)r.removeFighter(t);r._fighters={},r.fightState=L.UNDEFINED,r.fightType=O,r.isInReconnection=!1,r.spellCastCounts={},r.fightMessagesStack=[],r.isProcessing=!1,a.isFightLeader=!1,a.isFighting=!1,a.isSpectator=!1,a.characters.switchControlledCharacter(a.characters.mainCharacterId),a.characters.mainCharacter.currentSummonedCreature=0,a.characters.mainCharacter.currentSummonedBomb=0,a.characters.clearSlaves(),window.actorManager.removeTeamCircles(),window.actorManager.clearQueuedToCarryActors(),r._isTurnEndRequestPending=!1,r._finishFightSequenceCb=null}function i(e){var t=e.id;r.currentFighterId=t,"GameFightTurnResumeMessage"!==e._messageType&&r.decrementDuration(t),a.characters.canControlCharacterId(t)&&(r.spellCastCounts={},r._checkInactivityOnTurnStart(),window.isoEngine.displayTextBanner("tablet.fight.animation.userTurn")),r.emit("GameFightTurnStart",e.id,e.waitTime,u.getValue("turnPicture")),r._isTurnEndRequestPending=!1}function n(e){if(r.fightState===L.PREPARATION){var t=s(e);r.emit("UpdatePreFightersList",t.contextualId)}}function o(e,t){var i=r.getAvailableFighters(),n=i[e];if(!n||!n.data.alive)return console.warn("Fighter was killed previously.");for(var o in i){var s=i[o];s.id!==e&&s.data.stats.summoner===e&&T(w.fightDeathStep,[P?P.castingSpellId:-1,s.id])}T(w.fightDeathStep,[P?P.castingSpellId:-1,e,!t]);var l=n.data.stats.summoner;a.characters.canControlCharacterId(l)&&(n.isBomb?a.characters.removeSummonedBomb(l):a.characters.removeSummonedCreature(l),r.emit("updateSpellsAvailability"))}var r=this,l=window.dofus.connectionManager;e.on("GameFightStartMessage",function(){r.fightState=L.BATTLE,r.emit("fightEnterBattle"),r.prepareSpellsWithInitialCooldown(a.characters.mainCharacter);for(var e in a.characters.slaves)r.prepareSpellsWithInitialCooldown(a.characters.slaves[e]);window.isoEngine.displayTextBanner("tablet.fight.animation.fightStarts"),window.actorManager.removeReadyIcon()}),e.on("GameFightStartingMessage",function(t){r.fightType=t.fightType,r.turnCount=0,e.timeline.show(),r.emit("fightStart")}),e.on("disconnect",function(){t(),M.reset()}),e.on("GameFightEndMessage",function(e){var i=r.getAvailableFighters();e.results&&e.results.length>0&&b.open("fightEnd",{msg:e,fighters:i}),M.flush(function(e){e&&console.error(e),t(),a.isSpectator||M.send(h.FIGHT_END),M.reset()})}),e.on("GameFightTurnResumeMessage",function(e){i(e)}),e.on("GameFightTurnStartMessage",function(e){i(e)}),e.on("GameFightTurnStartSlaveMessage",function(e){i(e)}),e.on("GameFightHumanReadyStateMessage",function(e){e.characterId===a.id&&r.emit("playerReady",e.isReady),window.actorManager.setReadyIconOnActor(e.characterId,e.isReady)}),e.on("confirmTurnEnd",function(){if(r._lastFighterId){var e=r._lastFighterId,t=r.getFighter(e);if(!t)return console.warn("Turn confirmation failed, fighter does not exist:",e);if(t.markFinishingBuffs(),t.data.stats.actionPoints=t.data.stats.maxActionPoints,t.data.stats.movementPoints=t.data.stats.maxMovementPoints,e===a.characters.controlledCharacterId){var i=a.characters.getControlledCharacter();i.setCharacteristic("actionPointsCurrent",t.data.stats.maxActionPoints),i.setCharacteristic("movementPointsCurrent",t.data.stats.maxMovementPoints);for(var n in t.spells){var o=t.spells[n];o.newTurn()}r._checkInactivityOnTurnEnd(),window.isoEngine.displayTextBanner("tablet.fight.animation.endOfUserTurn")}r.prepareNextPlayableCharacter(),r.emit("GameFightTurnEnd",e)}}),e.on("GameFightTurnEndMessage",function(e){var t=e.id;r._lastFighterId=t;var i=r.getFighter(t);if(!i)return console.warn("Turn end failed, fighter does not exist");if(!i.data.alive&&(r.decrementDuration(t),i.markFinishingBuffs(),i.data.stats.actionPoints=i.data.stats.maxActionPoints,i.data.stats.movementPoints=i.data.stats.maxMovementPoints,r.emit("GameFightTurnEnd",t),t===a.characters.controlledCharacterId))for(var n in i.spells){var o=i.spells[n];o.newTurn()}}),e.on("GameFightShowFighterMessage",function(e){r.loadFighter(e),n(e)}),e.on("GameFightShowFighterRandomStaticPoseMessage",function(e){r.loadFighter(e)}),e.on("GameActionFightSummonMessage",function(e){n(e);var t=e.sourceId,i=e.actionId,o=e.summon;if(t===a.id&&i!==g.ACTION_SUMMON_STATIC_CREATURE){var s=r.getFighter(o.contextualId);if(!s)return console.error(new Error("Summoning failed, fighter does not exist"));i===x||s.isBomb?a.characters.addSummonedBomb():s.isCreature&&a.characters.addSummonedCreature()}T(w.fightSummonStep,[P?P.castingSpellId:-1,t,o])}),e.on("GameFightTurnListMessage",function(e){r.turnsList=e.ids,r.deadTurnsList=e.deadsIds,r.emit("FightersListUpdated")}),e.on("GameFightSynchronizeMessage",function(e){var t=e.fighters,i=r.getAvailableFighters();if(e._synchronizeBuff)for(var n in i)i[n].enableBuffs();for(var o=0;o<t.length;o++){var s=t[o];if(s.alive){var a=i[s.contextualId];if(!a)return console.error(new Error("Synchronizing failed, fighter does not exist"));a.synchronizeData(s)}}}),e.on("GameFightLeaveMessage",function(e){var t=e.charId;t===a.id&&("fightPlacement"===window.foreground.tapOptions.mode||a.isSpectator)&&r.emit("gameFightLeave",t)}),e.on("_GameActionFightLeaveMessage",function(e){o(e.targetId,!0)}),e.on("GameActionFightDeathMessage",function(e){o(e.targetId,!1)}),e.on("GameFightRefreshFighterMessage",function(e){var t=e.informations,i=t.contextualId,n=r.getFighter(i);return n?(n.data.updateData({look:t.look,disposition:t.disposition}),void("fightPlacement"===window.foreground.tapOptions.mode&&(n.updateFighterIllustration(),r.emit("UpdatePreFightersList",i)))):console.error("Refreshing fighter failed, fighter "+i+" does not exist")}),e.on("GameFightRemoveTeamMemberMessage",function(e){var t=e.charId;r.removeFighter(t),"fightPlacement"===window.foreground.tapOptions.mode&&r.emit("UpdatePreFightersList",t)}),e.on("GameFightNewRoundMessage",function(e){r.turnCount=e.roundNumber-1,r.emit("TurnCountUpdated",e.roundNumber-1)}),e.on("GameFightResumeMessage",function(e){r.gameFightResumeMessage(e)}),e.on("GameFightResumeWithSlavesMessage",function(e){r.gameFightResumeMessage(e)}),e.on("GameFightSpectateMessage",function(e){r.gameFightResumeMessage(e)}),e.on("GameActionFightChangeLookMessage",function(e){var t=e.targetId,i=r.getFighter(t);if(!i)return console.error(new Error("Changing fighter's look failed, fighter does not exist"));var n=e.entityLook;i.data.updateData({look:n}),i.updateFighterIllustration(),r.emit(h.FIGHTER_CHANGE_LOOK,[t,n],t)}),e.on("GameActionFightDispellEffectMessage",function(e){T(w.fightDispelEffectStep,[P?P.castingSpellId:-1,e.targetId,e.boostUID])}),e.on("GameActionFightDispellSpellMessage",function(e){T(w.fightDispelSpellStep,[P?P.castingSpellId:-1,e.targetId,e.spellId])}),e.on("GameActionFightDispellMessage",function(e){T(w.fightDispelStep,[P?P.castingSpellId:-1,e.targetId])}),e.on("GameActionFightNoSpellCastMessage",function(e){var t,i=e.spellLevelId,n=a.characters.getControlledCharacter();if(t=0===i?n.spellData.spells[N]:n.spellData.getSpellBySpellLevelId(e.spellLevelId),t&&r.spellCastCounts[t.id]){r.spellCastCounts[t.id]=r.spellCastCounts[t.id]-1;var o=t.getProperty("apCost",t.level);n.setCharacteristic("actionPointsCurrent",n.characteristics.actionPointsCurrent+o)}}),e.on("GameActionFightLifePointsGainMessage",function(e){T(w.fightLifePointsVariationStep,[P?P.castingSpellId:-1,e.targetId,e.delta,0,e.actionId])}),e.on("GameActionFightLifePointsLostMessage",function(e){T(w.fightLifePointsVariationStep,[P?P.castingSpellId:-1,e.targetId,-e.loss,-e.permanentDamages,e.actionId])}),e.on("GameActionFightLifeAndShieldPointsLostMessage",function(e){T(w.fightShieldPointsVariationStep,[P?P.castingSpellId:-1,e.targetId,-e.shieldLoss,e.actionId]),0!==e.shieldLoss&&0===e.loss||T(w.fightLifePointsVariationStep,[P?P.castingSpellId:-1,e.targetId,-e.loss,-e.permanentDamages,e.actionId])}),e.on("GameActionFightPointsVariationMessage",function(e){var t=e.targetId,i=e.actionId,n=e.delta;i===g.ACTION_CHARACTER_ACTION_POINTS_USE||i===g.ACTION_CHARACTER_ACTION_POINTS_LOST||i===g.ACTION_CHARACTER_ACTION_POINTS_WIN?T(w.fightActionPointsVariationStep,[P?P.castingSpellId:-1,t,n,i===g.ACTION_CHARACTER_ACTION_POINTS_USE]):i!==g.ACTION_CHARACTER_MOVEMENT_POINTS_USE&&i!==g.ACTION_CHARACTER_MOVEMENT_POINTS_LOST&&i!==g.ACTION_CHARACTER_MOVEMENT_POINTS_WIN||T(w.fightMovementPointsVariationStep,[P?P.castingSpellId:-1,t,n,i===g.ACTION_CHARACTER_MOVEMENT_POINTS_USE])}),e.on("GameActionFightVanishMessage",function(e){var t=e.targetId,i=r.getFighter(t);return i?(i.setAlive(!1),i.dispel(!1,!1,!0),r.removeLinkedBuff(t,!1,!0),void r.reaffectBuffs(t)):console.error(new Error("Vanish failed, fighter does not exist"))}),l.on("CharacterSelectedForceMessage",function(){r.isInReconnection=!0}),e.on("GameFightJoinMessage",function(e){r.fightState=e.isFightStarted?L.BATTLE:L.PREPARATION,r.fightType=e.fightType;var t=e.isSpectator;t?window.actorManager.userActor.hide():window.actorManager.userActor.show(),a.isSpectator=t,a.isFighting=!0,e.isFightStarted?(window.isoEngine.displayTextBanner("tablet.fight.animation.fightStarts"),r.emit("fightEnterBattle","PREPARATION_SKIPPED")):(window.isoEngine.displayTextBanner("tablet.fight.animation.preparationPhase"),r.emit("fightEnterPreparation",e))}),e.on("GameActionFightSpellCooldownVariationMessage",function(e){T(w.fightSpellCooldownVariationStep,[P?P.castingSpellId:-1,e.targetId,e.spellId,e.value])}),e.on("GameActionFightModifyEffectsDurationMessage",function(e){T(w.fightModifyEffectsDurationStep,[P?P.castingSpellId:-1,e.sourceId,e.targetId,e.delta])}),e.on("GameActionFightExchangePositionsMessage",function(e){T(w.fightExchangePositionsStep,[P?P.castingSpellId:-1,e.sourceId,e.casterCellId,e.targetId,e.targetCellId])}),e.on("GameActionFightSlideMessage",function(e){T(w.fightSlideStep,[P?P.castingSpellId:-1,e.targetId,e.endCellId])}),e.on("GameActionFightTeleportOnSameMapMessage",function(e){T(w.fightTeleportOnSameMapStep,[P?P.castingSpellId:-1,e.targetId,e.cellId])}),e.on("GameMapMovementMessage",function(e){var t=e.keyMovements[e.keyMovements.length-1];T(w.mapMovementStep,[P?P.castingSpellId:-1,e.actorId,t])}),e.on("GameActionFightCarryCharacterMessage",function(e){T(w.fightCarryCharacterStep,[P?P.castingSpellId:-1,e.sourceId,e.targetId])}),e.on("GameActionFightThrowCharacterMessage",function(e){T(w.fightThrowCharacterStep,[P?P.castingSpellId:-1,e.sourceId,e.targetId,e.cellId])}),e.on("GameActionFightDropCharacterMessage",function(e){T(w.fightThrowCharacterStep,[P?P.castingSpellId:-1,e.sourceId,e.targetId,e.cellId])}),e.on("sendAllFightEvent",function(){M.flush()}),e.on("GameActionFightReduceDamagesMessage",function(e){T(w.fightReduceDamages,[P?P.castingSpellId:-1,e.targetId,e.amount])}),e.on("GameActionFightDodgePointLossMessage",function(e){var t=e.actionId;t===g.ACTION_FIGHT_SPELL_DODGED_PA?T(w.fightActionPointsLossDodge,[P?P.castingSpellId:-1,e.targetId,e.amount]):t===g.ACTION_FIGHT_SPELL_DODGED_PM&&T(w.fightMovementPointsLossDodge,[P?P.castingSpellId:-1,e.targetId,e.amount])}),e.on("GameActionFightSpellImmunityMessage",function(e){T(w.fightSpellImmunity,[P?P.castingSpellId:-1,e.targetId])}),e.on("GameActionFightReflectSpellMessage",function(e){T(w.fightReflectSpellStep,[P?P.castingSpellId:-1,e.targetId])}),e.on("GameActionFightReflectDamagesMessage",function(e){T(w.fightReflectDamagesStep,[P?P.castingSpellId:-1,e.sourceId])}),e.on("GameActionFightTackledMessage",function(e){T(w.fightTackledStep,[P?P.castingSpellId:-1,e.sourceId])}),e.on("GameActionFightKillMessage",function(e){T(w.fightKillStep,[P?P.castingSpellId:-1,e.targetId,e.sourceId])}),e.on("GameActionFightInvisibilityMessage",function(e){T(w.fightInvisibilityStep,[P?P.castingSpellId:-1,e.targetId,e.state])}),e.on("GameActionFightTriggerGlyphTrapMessage",function(e){T(w.fightTriggerGlyphTrapStep,[P?P.castingSpellId:-1,e.triggeringCharacterId,e.sourceId,e._spellId])}),e.on("GameFightUpdateTeamMessage",function(e){r.fightId=e.fightId,a.isFightLeader=e.team.leaderId===a.id}),e.on("GameFightOptionStateUpdateMessage",function(e){r.fightId=e.fightId}),e.on("GameContextDestroyMessage",function(){A.isRoleplayMode||(r.fightState=L.UNDEFINED)})},o.prototype.getNextControllableCharacterId=function(){var e=this.turnsList,t=e.length;if(0===t)return a.characters.controlledCharacterId;for(var i=e.indexOf(this.currentFighterId),n=1;n<t;n++){var o=e[(i+n)%t],s=this.getFighter(o);if(!s)return console.error(new Error("Find next controllable character failed, fighter does not exist"));if(a.characters.canControlCharacterId(o)&&s.data.alive)return o}return a.characters.controlledCharacterId},o.prototype.prepareNextPlayableCharacter=function(){var e=this.getNextControllableCharacterId();a.characters.switchControlledCharacter(e)},o.prototype.removeFighter=function(e){var t=this.getFighter(e);return t?(t.clear(),void delete this._fighters[e]):console.warn("Removing fighter failed, it does not exist")},o.prototype.loadFighter=function(e){var t=e.actionId,i="GameFightShowFighterRandomStaticPoseMessage"===e._type||t===S||t===E,n=s(e);if(!n)return void console.warn("Fighter informations could not be extracted from this message type: "+e._messageType);var o=n.contextualId,a=this.getFighter(o);a||(a=new f(o,i),this._fighters[o]=a),a.setData(n);var r=window.actorManager.getActor(a.id);r&&r.addTeamCircle()},o.prototype.prepareSpellsWithInitialCooldown=function(e){function t(e,t){return e?console.error(e):void t.resetInitialCooldown(i.turnCount)}var i=this,n=e.spellData.getSpells(C.USABLE);for(var o in n){var s=n[o];s.isItem||0===s.spellLevel.initialCooldown||this.getFighterSpell(o,e.spellData.characterId,t);
}},o.prototype.addDispellableEffect=function(e,t){function i(){function i(i,o){if(i)return console.error(i);if(o.timeCreationStarted=s,o instanceof m.StateBuff&&(952===o.actionId?T(w.fightLeavingStateStep,[P?P.castingSpellId:-1,o.targetId,o.stateId]):T(w.fightEnteringStateStep,[P?P.castingSpellId:-1,o.targetId,o.stateId,o.effect.getDurationString()])),"FightTemporaryBoostEffect"===n._type){var a=e.actionId;a!==g.ACTION_CHARACTER_MAKE_INVISIBLE&&a!==g.ACTION_CHARACTER_UPDATE_BOOST&&a!==g.ACTION_CHARACTER_CHANGE_LOOK&&a!==g.ACTION_CHARACTER_CHANGE_COLOR&&a!==g.ACTION_CHARACTER_ADD_APPEARANCE&&a!==g.ACTION_FIGHT_SET_STATE&&T(w.fightTemporaryBoostStep,[P?P.castingSpellId:-1,e.effect.targetId,o.effect.description,o.effect.duration,o.effect.getDurationString()])}return T(w.fightDisplayBuffStep,[P?P.castingSpellId:-1,o]),delete o.timeCreationStarted,t()}var n=e.effect;m.makeBuffFromEffect(n,o,e.actionId,i)}var o;o=new n(e.actionId===g.ACTION_CHARACTER_UPDATE_BOOST?!1:!P),P&&(o.castingSpellId=P.castingSpellId,P.spell.id===e.effect.spellId&&(o.spellRank=P.spellRank));var s=Date.now(),a=e.effect.spellId;o.casterId=e.sourceId,this.getFighterSpell(a,o.casterId,function(e,n){return e?t(e):n?(o.spell=n,void i()):t(new Error("unable to find spell id "+a))})},o.prototype.gameActionFightCloseCombatAndSpell=function(e,t){var i=this,o="GameActionFightCloseCombatMessage"===e._messageType,s=0;o&&(e.spellId=N,e.spellLevel=1,s=e.weaponGenericId),this.spellCastCounts[e.spellId]&&(this.spellCastCounts[e.spellId]=this.spellCastCounts[e.spellId]-1),this.getFighterSpell(e.spellId,e.sourceId,function(r,l){if(r)return t(r);if(!l)return t(new Error("unable to find spell id "+e.spellId));P=new n,P.casterId=e.sourceId,P.spell=l,P.spellRank=o?null:l.getProperty("spellLevel",e.spellLevel),P.isCriticalFail=e.critical===v.CRITICAL_FAIL,P.isCriticalHit=e.critical===v.CRITICAL_HIT,P.silentCast=e.silentCast,o&&(P.weaponId=e.weaponGenericId);var c=a.characters,d=c.controlledCharacterId,u=e.sourceId===d;u&&e.critical!==v.CRITICAL_FAIL&&l.cast(i.turnCount,[e.targetId]),o&&0!==s?T(w.fightCloseCombatStep,[P?P.castingSpellId:-1,e.sourceId,s,e.critical]):T(w.fightSpellCastStep,[P?P.castingSpellId:-1,e.sourceId,e.spellId,e.critical]);var h=i.getFighter(e.sourceId),p=i.getFighter(c.controlledCharacterId),m=p&&p.data.teamId===h.data.teamId;if(!u&&m&&!P.isCriticalFail){var f=c.getControlledCharacter().spellData.getSpells(C.USABLE),g=f[e.spellId];if(g){var _=l.getProperty("globalCooldown");_===-1&&(_=g.getProperty("minCastInterval")),_&&T(w.fightSpellCooldownVariationStep,[P.castingSpellId,d,e.spellId,_])}}t()})},o.prototype._restoreSpellCooldown=function(e,t,i){if(t.cast(this.turnCount,[],!1),63===e.cooldown)return t.forceLastCastTurn(this.turnCount+e.cooldown-t.spellLevel.minCastInterval),i();var n=t.getModifiedInterval();return t.forceLastCastTurn(this.turnCount+e.cooldown-n),i()},o.prototype._restoreCooldowns=function(e,t,i){var n=this;if(!t||0===t.length)return i();var o=this.getFighter(e);return o?void y.each(t,function(t,i){if("GameFightSpellCooldown"!==t._type)return i();var s=t.spellId,a=o.spells[s];return a?n._restoreSpellCooldown(t,a,i):void n.getFighterSpell(s,e,function(e,o){return e?i(e):n._restoreSpellCooldown(t,o,i)})},function(e){i(e)}):console.error(new Error("Restoring cooldowns failed, fighter does not exist."))},o.prototype._restoreBuffs=function(e,t){function i(e,i,n,o){m.makeBuffFromEffect(e,i,n,function(e,i){if(e)return o(e);var n=s.getFighter(i.targetId);if(!n)return o(new Error("Restoring buffs failed, fighter does not exist"));var a=!t||!(i instanceof m.StatBuff);return n.addBuff(i,a),o()})}function o(e,t){var o=e.effect;a[o.targetId]||(a[o.targetId]={}),a[o.targetId][o.turnDuration]||(a[o.targetId][o.turnDuration]={});var r=a[o.targetId][o.turnDuration][o.spellId];return r?void i(o,r,e.actionId,t):(r=new n,r.casterId=e.sourceId,s.getFighterSpell(o.spellId,r.casterId,function(n,s){return n?t(n):s?(r.spell=s,a[o.targetId][o.turnDuration][o.spellId]=r,void i(o,r,e.actionId,t)):t(new Error("unable to find spell id "+o.spellId))}))}var s=this,a={};y.eachSeries(e,function(e,t){return o(e,t)},function(e){if(s.isInReconnection=!1,e)return console.error(e)})},o.prototype.gameFightResumeMessage=function(e){var t=this;if(a.characters.mainCharacter.currentSummonedCreature=e.summonCount,a.characters.mainCharacter.currentSummonedBomb=e.bombCount,this.turnCount=e.gameTurn-1,this.emit("TurnCountUpdated",e.gameTurn-1),"GameFightSpectateMessage"===e._messageType)return t._restoreBuffs(e.effects,!0),M.flush();var i=e.slavesInfo||[];i.unshift({slaveId:a.characters.mainCharacterId,spellCooldowns:e.spellCooldowns}),y.eachSeries(i,function(e,i){return t._restoreCooldowns(e.slaveId,e.spellCooldowns,i)},function(i){return i?console.error(i):t._restoreBuffs(e.effects,!1)})},o.prototype.getOrdonnedPreFighters=function(){var e=[],t=[],i=[],n=0,o=0,s=this.getAvailableFighters();for(var a in s){var r=s[a],l=r.data.stats;if(l){l.initiative||0===l.initiative||(console.warn("Initiative stats is not defined, it will be initialized at 0."),l.initiative=0);var c=~~(l.initiative*l.lifePoints/l.maxLifePoints);0===r.data.teamId?(i.push({fighter:a,init:c}),n+=c):(t.push({fighter:a,init:c}),o+=c)}}var d=function(e,t){return e.init===t.init?t.fighter-e.fighter:t.init-e.init};i.sort(d),t.sort(d);var u=i,h=t;(0===i.length||0===t.length||n/i.length<o/t.length)&&(u=t,h=i);var p,m=Math.min(u.length,h.length);for(p=0;p<m;p++)e.push(u[p].fighter),e.push(h[p].fighter);var f=i.length>t.length?i:t;for(m=f.length;p<m;p++)e.push(f[p].fighter);return e},o.prototype.canCastThisSpell=function(e){var t=a.characters.getControlledCharacter(),i=a.characters.controlledCharacterId,n=this.getFighter(i);if(!n)return!1;var o=n.states,s=t.spellData.getSpells(C.USABLE),r=s[e];if(!r||!r.isLoaded)return!1;var l,c=r.getProperty("apCost"),d=t.characteristics.actionPointsCurrent;if(c>d)return!1;var u=r.getProperty("canSummon");if(u&&!a.characters.canSummonCreature())return!1;var h=r.getProperty("canBomb");if(h&&!a.characters.canSummonBomb())return!1;var p=r.getProperty("statesForbidden"),m=r.getProperty("statesRequired");for(l=0;l<o.length;l++){var f=window.gui.databases.SpellStates[o[l]];if(p&&p.length>0&&p.indexOf(o[l])!==-1)return!1;if(e===N&&f&&f.preventsFight)return!1}if(m)for(l=0;l<m.length;l++)if(o.indexOf(m[l])===-1)return!1;var g=n.spells[e];if(g&&g.hasBeenCast()){var _=g.getProperty("maxCastPerTurn");if(_>0&&g.castingData.castThisTurn>=_)return!1;if(g.getCooldown()>0)return!1}return!0},o.prototype.getSpellCooldown=function(e){var t=a.characters.controlledCharacterId,i=this.getFighter(t);if(!i||!i.spells[e])return 0;var n=i.spells[e].getCooldown();return Math.max(0,n)},o.prototype.decrementDuration=function(e){this.incrementDuration(e,-1)},o.prototype.incrementDuration=function(e,t,i,n){void 0===n&&(n=this.INCREMENT_MODE_SOURCE);var o,s=this.getAvailableFighters();for(var a in s){o=[];for(var r=s[a],l=r.buffs,c=0;c<l.length;c++){var d=l[c];if(n===this.INCREMENT_MODE_SOURCE&&d.aliveSource===e||n===this.INCREMENT_MODE_TARGET&&d.targetId===e){var u=d.incrementDuration(t,i);d.isActive()?(o.push(d),u&&this.emit("BuffUpdate",d,r)):(d.remove(),this.emit("BuffRemove",d,r))}else o.push(d)}r.buffs=o}},o.prototype.removeLinkedBuff=function(e,t,i){var n=this.getAvailableFighters();for(var o in n)for(var s=n[o],a=s.buffs,r=0;r<a.length;r++){var l=a[r];l.source===e&&s.dispelUniqueBuff(l.id,t,i,!1),i&&s.isSummon()&&(l.aliveSource=s.data.stats.summoner)}},o.prototype.reaffectBuffs=function(e){var t=this.getFighter(e);if(!t)return console.error(new Error("Reaffecting buffs failed, fighter does not exist"));if(t.isSummon()){var i=this.getNextFighterId(e);if(i===-1)return;var n=this.getAvailableFighters();for(var o in n)for(var s=n[o].buffs,a=0;a<s.length;a++){var r=s[a];r.aliveSource===e&&(r.aliveSource=i)}}},o.prototype.getNextFighterId=function(e){var t=this.turnsList.indexOf(e);return t===-1?-1:(t+1)%this.turnsList.length},o.prototype.spellCastSucceeded=function(e,t){if(a.characters.controlledCharacterId===t){var i=this.spellCastCounts[e];this.spellCastCounts[e]=i?i+1:1;var n=a.characters.getControlledCharacter(),o=n.spellData.spells[e],s=o.getProperty("apCost",o.level);n.setCharacteristic("actionPointsCurrent",n.characteristics.actionPointsCurrent-s)}},o.prototype.processFightSequenceMessage=function(e){function t(e){if(e&&console.error(e),i.isProcessing=!1,i.fightMessagesStack.length)i.processFightSequenceMessage(i.fightMessagesStack.shift());else if(i._finishFightSequenceCb){var t=i._finishFightSequenceCb;i._finishFightSequenceCb=null,t()}}if(this.isProcessing)return this.fightMessagesStack.push(e);var i=this;this.isProcessing=!0;var n=this.asyncFightMessages[e._messageType];return n?(window.gui.emit(e._messageType,e),n.call(this,e,t)):(window.gui.emit(e._messageType,e),void t())},o.prototype.finishFightSequence=function(e){e&&(this._finishFightSequenceCb&&console.error("FightManager.finishFightSequence: _finishFightSequenceCb was already set"),this._finishFightSequenceCb=e),this.processFightSequenceMessage({_messageType:"sendAllFightEvent"})},o.prototype.isInBattle=function(){return this.fightState===L.BATTLE},o.prototype.isFightersTurn=function(e){return this.currentFighterId===e},o.prototype.getIsTurnEndRequestPending=function(){return this._isTurnEndRequestPending},o.prototype.isFighterOnUsersTeam=function(e){var t=this.getFighter(window.actorManager.userActor.actorId),i=this.getFighter(e);return t&&i?t.data.teamId===i.data.teamId:(console.warn("fighter not found"),!1)}},function(e,t){e.exports={UNKNOWN_FIGHT_EVENT:"unknown",FIGHTER_LIFE_GAIN:"fighterLifeGain",FIGHTER_LIFE_LOSS:"fighterLifeLoss",FIGHTER_LIFE_LOSS_AND_DEATH:"fightLifeLossAndDeath",FIGHTER_NO_CHANGE:"fighterNoChange",FIGHTER_DEATH:"fighterDeath",FIGHT_END:"fightEnd",FIGHTER_LEAVE:"fighterLeave",FIGHTER_CHANGE_LOOK:"fighterChangeLook",FIGHTER_GOT_DISPELLED:"fighterGotDispelled",FIGHTER_SPELL_DISPELLED:"fighterSpellDispelled",FIGHTER_EFFECTS_MODIFY_DURATION:"fighterEffectsModifyDuration",FIGHTER_SPELL_COOLDOWN_VARIATION:"fighterSpellCooldownVariation",FIGHTER_SPELL_IMMUNITY:"fighterSpellImmunity",FIGHTER_AP_LOSS_DODGED:"fighterDodgedAPLoss",FIGHTER_MP_LOSS_DODGED:"fighterDodgedMPLoss",FIGHTERS_POSITION_EXCHANGE:"fightersExchangedPositions",FIGHTER_VISIBILITY_CHANGED:"fighterVisibilityChanged",FIGHTER_INVISIBLE_OBSTACLE:"fighterInvisibleObstacle",FIGHTER_GOT_KILLED:"fighterGotKilled",FIGHTER_TEMPORARY_BOOSTED:"fighterTemporaryBoosted",FIGHTER_AP_USED:"fighterUsedAP",FIGHTER_AP_LOST:"fighterLostAP",FIGHTER_AP_GAINED:"fighterGainedAP",FIGHTER_MP_USED:"fighterUsedMP",FIGHTER_MP_LOST:"fighterLostMP",FIGHTER_MP_GAINED:"fighterGainedMP",FIGHTER_SHIELD_GAIN:"fighterShieldGain",FIGHTER_SHIELD_LOSS:"fighterShieldLoss",FIGHTER_REDUCED_DAMAGES:"fighterReducedDamages",FIGHTER_REFLECTED_DAMAGES:"fighterReflectedDamages",FIGHTER_REFLECTED_SPELL:"fighterReflectedSpell",FIGHTER_SLIDE:"fighterSlided",FIGHTER_CASTED_SPELL:"fighterCastedSpell",FIGHTER_CLOSE_COMBAT:"fighterCloseCombat",FIGHTER_DID_CRITICAL_HIT:"fighterDidCriticalHit",FIGHTER_DID_CRITICAL_MISS:"fighterDidCriticalMiss",FIGHTER_ENTERING_STATE:"fighterEnteredState",FIGHTER_LEAVING_STATE:"fighterLeftState",FIGHTER_STEALING_KAMAS:"fighterStoleKamas",FIGHTER_SUMMONED:"fighterSummoned",FIGHTER_GOT_TACKLED:"fighterGotTackled",FIGHTER_TELEPORTED:"fighterTeleported",FIGHTER_TRIGGERED_GLYPH:"fighterTriggeredGlyph",FIGHTER_TRIGGERED_TRAP:"fighterTriggeredTrap",FIGHTER_CARRY:"fighterCarry",FIGHTER_THROW:"fighterThrow",GLYPH_APPEARED:"glyphAppeared",GLYPH_DISAPPEARED:"glyphDisappeared",TRAP_APPEARED:"trapAppeared",TRAP_DISAPPEARED:"trapDisappeared"}},function(e,t){e.exports={FIGHT_OPTION_SET_SECRET:0,FIGHT_OPTION_SET_TO_PARTY_ONLY:1,FIGHT_OPTION_SET_CLOSED:2,FIGHT_OPTION_ASK_FOR_HELP:3}},function(e,t,i){function n(e,t,i,n){var c;switch(e._type){case"FightTemporarySpellBoostEffect":c=new s(e,t,i,n);break;case"FightTriggeredEffect":c=new l(e,t,i,n);break;case"FightTemporaryBoostWeaponDamagesEffect":c=new o(e,t,i,e.weaponTypeId,e.delta,e.weaponTypeId,n);break;case"FightTemporaryBoostStateEffect":c=new r(e,t,i,n);break;case"FightTemporarySpellImmunityEffect":c=new o(e,t,i,e.immuneSpellId,null,null,n);break;case"FightTemporaryBoostEffect":c=new a(e,t,i,n)}return c}var o=i(351),s=i(356),a=i(361),r=i(362),l=i(367);o.setStateBuff(r),t.BasicBuff=o,t.SpellBuff=s,t.StatBuff=a,t.StateBuff=r,t.TriggeredBuff=l,t.makeBuffFromEffect=n},function(e,t,i){function n(e,t,i,n,o,a,r){if(!e)return r&&s.ensureAsync(function(){return r("No effect specified")});this._disabled=!1,this._removed=!1,this.id=e.uid,this.uid=e.uid,this.actionId=i,this.targetId=e.targetId,this.castingSpell=t,this.duration=e.turnDuration,this.dispelable=e.dispelable,this.source=t.casterId,this.stack=null;var l=window.gui.fightManager;l.isInReconnection||window.gui.playerData.isSpectator||0===l.currentFighterId?this.aliveSource=this.source:this.aliveSource=l.currentFighterId,this.parentBoostUid=0,this.initParam(n,o,a,r)}var o,s=i(31),a=i(352),r=i(353),l=i(354),c=i(355),d=c.EffectInstance,u=[r.ACTION_BOOST_SPELL_RANGE,r.ACTION_BOOST_SPELL_RANGEABLE,r.ACTION_BOOST_SPELL_DMG,r.ACTION_BOOST_SPELL_HEAL,r.ACTION_BOOST_SPELL_AP_COST,r.ACTION_BOOST_SPELL_CAST_INTVL,r.ACTION_BOOST_SPELL_CC,r.ACTION_BOOST_SPELL_CASTOUTLINE,r.ACTION_BOOST_SPELL_NOLINEOFSIGHT,r.ACTION_BOOST_SPELL_MAXPERTURN,r.ACTION_BOOST_SPELL_MAXPERTARGET,r.ACTION_BOOST_SPELL_CAST_INTVL_SET,r.ACTION_BOOST_SPELL_BASE_DMG,r.ACTION_DEBOOST_SPELL_RANGE,406,787,792,793,1017,1018,1019,1035,1036,1044,1045],h=function(e){e&&console.error(e)};e.exports=n,n.prototype.getParam1=function(){return"EffectInstanceDice"===this.effect._type?this.effect.diceNum:null},n.prototype.getParam2=function(){return"EffectInstanceDice"===this.effect._type?this.effect.diceSide:null},n.prototype.getParam3=function(){return"EffectInstanceInteger"===this.effect._type?this.effect.value:null},n.prototype._setParameter=function(e,t){this.effect.setParameter(e,0===t?null:t)},n.prototype.setParam1=function(e){this._setParameter(0,e)},n.prototype.setParam2=function(e){this._setParameter(1,e)},n.prototype.setParam3=function(e){this._setParameter(2,e)},n.prototype.initParam=function(e,t,i,n){n||(n=h);var o={effectId:this.actionId,duration:this.duration,trigger:this.isTrigger(),value:i};(e||t)&&(o.diceNum=e,o.diceSide=t),this.effect=new d(o);var s=this;c.collectEffectInstanceData([this.effect],function(e){return e?n(e):void n(null,s)})},n.prototype.updateParam=function(e,t,i){switch(this.actionId){case 788:this.setParam1(t);break;case 950:case 951:break;default:this.setParam1(e),this.setParam2(t),this.setParam3(i)}this.refreshDescription()},n.prototype.equals=function(e,t){var i=this.castingSpell.spellRank&&e.castingSpell.spellRank&&!t&&this.castingSpell.spellRank.id!==e.castingSpell.spellRank.id;if(this.targetId!==e.targetId||this.effect.effectId!==e.actionId||this.duration!==e.duration||this.effect.hasOwnProperty("delay")&&this.effect.delay!==e.effect.delay||i||!t&&this.castingSpell.spell.id!==e.castingSpell.spell.id||this.constructor!==e.constructor||this.source!==e.source||this.isTrigger())return!1;var n=this.actionId;if(788===n){if(this.getParam1()!==e.getParam1())return!1}else if(u.indexOf(n)!==-1){if(this.getParam1()!==e.getParam1())return!1}else{if(165===n)return!1;if(n===e.actionId&&(952===n||951===n||950===n)&&this instanceof o&&e instanceof o&&this.stateId!==e.stateId)return!1}return!0},n.prototype.apply=function(){this._disabled=!1,this._removed=!1},n.prototype.remove=function(){this._removed=!0,this._disabled||this.disable()},n.prototype.enable=function(){this._disabled=!1},n.prototype.disable=function(){this._disabled=!0},n.prototype.incrementDuration=function(e,t){return!(t&&!this.canBeDispell())&&(!(this.duration>=63)&&(this.duration+e>0?(this.duration+=e,this.effect.duration+=e,!0):this.duration>0&&(this.duration=0,this.effect.duration=0,!0)))},n.prototype.isActive=function(){return 0!==this.duration},n.prototype.isTrigger=function(){return!1},n.prototype.canBeDispell=function(e,t,i){if(t=void 0===t?Number.MIN_VALUE:t,t===this.id)return!0;switch(this.dispelable){case l.DISPELLABLE:return!0;case l.DISPELLABLE_BY_STRONG_DISPEL:return e;case l.DISPELLABLE_BY_DEATH:return i||e;case l.REALLY_NOT_DISPELLABLE:return t===this.id;default:return!1}},n.prototype.add=function(e){switch(this.stack||(this.stack=[],this.stack.push(this.clone())),this.stack.push(e),this.actionId){case 293:this.setParam1(e.getParam1()),this.setParam2(this.getParam2()+e.getParam2()),this.setParam3(this.getParam3()+e.getParam3());break;case 788:this.setParam1(this.getParam1()+e.getParam2());break;case 950:case 951:case 952:break;default:this.setParam1(this.getParam1()+e.getParam1()),this.setParam2(this.getParam2()+e.getParam2()),this.setParam3(this.getParam3()+e.getParam3())}this.refreshDescription()},n.prototype.isUnusableNextTurn=function(){if(this.duration>1||this.duration<0)return!1;var e=window.gui.fightManager,t=e.currentFighterId,i=window.gui.playerData.id;if(t===i||t===this.source)return!1;var n=e.turnsList,o=n.indexOf(i),s=n.indexOf(t),a=n.indexOf(this.source);return a<s&&(a+=n.length),o<s&&(o+=n.length),!(o<a)},n.prototype.refreshDescription=function(){this.effect.forceDescriptionRefresh()},e.exports.setStateBuff=function(e){o=e},n.prototype.getDelta=function(){return console.warn("BasicBuff.prototype.getDelta should not be called directly"),0},n.prototype._copyTo=function(e){var t=a.getOwnProperties(this).filter(function(e){return"effect"!==e});a.shallowCopyProperties(this,e,t),this.effect&&(e.effect=this.effect.clone())},n.prototype.clone=function(){var e=new n;return this._copyTo(e),e}},function(e,t){t.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},t.getOwnProperties=function(e){var t=[];if(e&&"object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t},t.shallowCopyProperties=function(e,t,i){if(e&&"object"==typeof e&&t&&"object"==typeof t&&Array.isArray(i))for(var n=0;n<i.length;n++){var o=i[n];t[o]=e[o]}}},function(e,t){function i(e){return s[e]?s[e][0]:null}function n(e){return!!s[e]&&s[e][1]}var o={ACTION_ENCAPSULATE_BINARY_COMMAND:993,ACTION_ENDS_TURN:-2,ACTION_INTERNAL_SEND_ACTION_BUFFER:-1,ACTION_NO_OPERATION:0,ACTION_SEQUENCE_START:83,ACTION_SEQUENCE_END:70,ACTION_CHARACTER_MOVEMENT:1,ACTION_CHARACTER_CHANGE_MAP:2,ACTION_CHARACTER_CHANGE_RESPAWN_MAP:3,ACTION_CHARACTER_TELEPORT_ON_SAME_MAP:4,ACTION_CHARACTER_PUSH:5,ACTION_CHARACTER_PULL:6,ACTION_CHARACTER_DIVORCE_WIFE_OR_HUSBAND:7,ACTION_CHARACTER_EXCHANGE_PLACES:8,ACTION_CHARACTER_DODGE_HIT:9,ACTION_CHARACTER_LEARN_EMOTICON:10,ACTION_CHARACTER_SET_DIRECTION:11,ACTION_CHARACTER_CREATE_GUILD:12,ACTION_USE_PUSHPULL_ELEMENT:14,ACTION_AREA_CHANGE_ALIGNMENT:15,ACTION_AREA_GIVE_KAMAS:16,ACTION_SCRIPT_START:17,ACTION_AREA_DUNGEON_ATTACKED:20,ACTION_GAIN_AREA_KAMAS:21,ACTION_AREA_DUNGEON_CITY_OPENED:23,ACTION_AREA_DUNGEON_HEART_OPENED:24,ACTION_AREA_DUNGEON_HEART_CLOSED:25,ACTION_AREA_CHANGE_ALIGNMENT_SUB:26,ACTION_QUEST_OBJECTIVE_VALIDATE:30,ACTION_QUEST_STEP_VALIDATE:31,ACTION_QUEST_QUEST_VALIDATE:32,ACTION_QUEST_STEP_START:33,ACTION_QUEST_START:34,ACTION_QUEST_CHECK_STARTED_OBJECTIVES:35,ACTION_QUEST_RESET:36,ACTION_START_DIALOG_WITH_NPC:40,ACTION_CARRY_CHARACTER:50,ACTION_THROW_CARRIED_CHARACTER:51,ACTION_NO_MORE_CARRIED:52,ACTION_CHARACTER_MOVEMENT_POINTS_STEAL:77,ACTION_CHARACTER_MOVEMENT_POINTS_WIN:78,ACTION_CHARACTER_MULTIPLY_RECEIVED_DAMAGE_OR_GIVE_LIFE_WITH_RATIO:79,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_PUSH:80,ACTION_CHARACTER_LIFE_POINTS_WIN_WITHOUT_ELEMENT:81,ACTION_CHARACTER_LIFE_POINTS_STEAL_WITHOUT_BOOST:82,ACTION_CHARACTER_ACTION_POINTS_STEAL:84,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_FROM_WATER:85,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_FROM_EARTH:86,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_FROM_AIR:87,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_FROM_FIRE:88,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE:89,ACTION_CHARACTER_DISPATCH_LIFE_POINTS_PERCENT:90,ACTION_CHARACTER_LIFE_POINTS_STEAL_FROM_WATER:91,ACTION_CHARACTER_LIFE_POINTS_STEAL_FROM_EARTH:92,ACTION_CHARACTER_LIFE_POINTS_STEAL_FROM_AIR:93,ACTION_CHARACTER_LIFE_POINTS_STEAL_FROM_FIRE:94,ACTION_CHARACTER_LIFE_POINTS_STEAL:95,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_WATER:96,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_EARTH:97,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_AIR:98,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_FIRE:99,ACTION_CHARACTER_LIFE_POINTS_MALUS:1047,ACTION_CHARACTER_LIFE_POINTS_MALUS_PERCENT:1048,ACTION_CHARACTER_LIFE_POINTS_LOST:100,ACTION_CHARACTER_ACTION_POINTS_LOST:101,ACTION_CHARACTER_ACTION_POINTS_USE:102,ACTION_CHARACTER_DEATH:103,ACTION_CHARACTER_ACTION_TACKLED:104,ACTION_CHARACTER_LIFE_LOST_MODERATOR:105,ACTION_CHARACTER_LIFE_LOST_CASTER_MODERATOR:265,ACTION_CHARACTER_SPELL_REFLECTOR:106,ACTION_CHARACTER_LIFE_LOST_REFLECTOR:107,ACTION_CHARACTER_LIFE_POINTS_WIN:108,ACTION_CHARACTER_LIFE_POINTS_LOST_CASTER:109,ACTION_CHARACTER_BOOST_LIFE_POINTS:110,ACTION_CHARACTER_BOOST_ACTION_POINTS:111,ACTION_CHARACTER_BOOST_DAMAGES:112,ACTION_CHARACTER_MULTIPLY_DAMAGES:114,ACTION_CHARACTER_BOOST_CRITICAL_HIT:115,ACTION_CHARACTER_DEBOOST_RANGE:116,ACTION_CHARACTER_BOOST_RANGE:117,ACTION_CHARACTER_BOOST_STRENGTH:118,ACTION_CHARACTER_BOOST_AGILITY:119,ACTION_CHARACTER_ACTION_POINTS_WIN:120,ACTION_CHARACTER_BOOST_DAMAGES_FOR_ALL_GAME:121,ACTION_CHARACTER_BOOST_CRITICAL_MISS:122,ACTION_CHARACTER_BOOST_CHANCE:123,ACTION_CHARACTER_BOOST_WISDOM:124,ACTION_CHARACTER_BOOST_VITALITY:125,ACTION_CHARACTER_BOOST_INTELLIGENCE:126,ACTION_CHARACTER_MOVEMENT_POINTS_LOST:127,ACTION_CHARACTER_BOOST_MOVEMENT_POINTS:128,ACTION_CHARACTER_MOVEMENT_POINTS_USE:129,ACTION_CHARACTER_STEAL_GOLD:130,ACTION_CHARACTER_MANA_USE_KILL_LIFE:131,ACTION_CHARACTER_REMOVE_ALL_EFFECTS:132,ACTION_CHARACTER_ACTION_POINTS_LOST_CASTER:133,ACTION_CHARACTER_MOVEMEMT_POINTS_LOST_CASTER:134,ACTION_CHARACTER_DEBOOST_RANGE_CASTER:135,ACTION_CHARACTER_BOOST_RANGE_CASTER:136,ACTION_CHARACTER_BOOST_DAMAGES_CASTER:137,ACTION_CHARACTER_BOOST_DAMAGES_PERCENT:138,ACTION_CHARACTER_DEBOOST_DAMAGES_PERCENT:186,ACTION_CHARACTER_ENERGY_POINTS_WIN:139,ACTION_CHARACTER_PASS_NEXT_TURN:140,ACTION_CHARACTER_KILL:141,ACTION_CHARACTER_BOOST_PHYSICAL_DAMAGES:142,ACTION_CHARACTER_LIFE_POINTS_WIN_WITHOUT_BOOST:143,ACTION_CHARACTER_LIFE_POINTS_LOST_WITHOUT_BOOST:144,ACTION_CHARACTER_DEBOOST_DAMAGES:145,ACTION_CHARACTER_CURSE:146,ACTION_CHARACTER_RESURECT_ALLY_IN_FIGHT:147,ACTION_CHARACTER_ADD_FOLLOWING_CHARACTER:148,ACTION_CHARACTER_MAKE_INVISIBLE:150,ACTION_SPELL_INVISIBLE_OBSTACLE:151,ACTION_CHARACTER_CHANGE_COLOR:333,ACTION_CHARACTER_CHANGE_LOOK:149,ACTION_CHARACTER_ADD_APPEARANCE:335,ACTION_CHARACTER_DEBOOST_CHANCE:152,ACTION_CHARACTER_DEBOOST_VITALITY:153,ACTION_CHARACTER_DEBOOST_AGILITY:154,ACTION_CHARACTER_DEBOOST_INTELLIGENCE:155,ACTION_CHARACTER_DEBOOST_WISDOM:156,ACTION_CHARACTER_DEBOOST_STRENGTH:157,ACTION_CHARACTER_BOOST_MAXIMUM_WEIGHT:158,ACTION_CHARACTER_DEBOOST_MAXIMUM_WEIGHT:159,ACTION_CHARACTER_BOOST_ACTION_POINTS_LOST_DODGE:160,ACTION_CHARACTER_BOOST_MOVEMENT_POINTS_LOST_DODGE:161,ACTION_CHARACTER_DEBOOST_ACTION_POINTS_LOST_DODGE:162,ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS_LOST_DODGE:163,ACTION_CHARACTER_BOOST_DODGE:752,ACTION_CHARACTER_BOOST_TACKLE:753,ACTION_CHARACTER_DEBOOST_DODGE:754,ACTION_CHARACTER_DEBOOST_TACKLE:755,ACTION_CHARACTER_BOOST_WEAPON_DAMAGE_PERCENT:165,ACTION_CHARACTER_DEBOOST_ACTION_POINTS:168,ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS:169,ACTION_CHARACTER_LIFE_POINTS_WIN_IN_RP:170,ACTION_CHARACTER_DEBOOST_CRITICAL_HIT:171,ACTION_CHARACTER_DEBOOST_MAGICAL_REDUCTION:172,ACTION_CHARACTER_DEBOOST_PHYSICAL_REDUCTION:173,ACTION_CHARACTER_BOOST_INITIATIVE:174,ACTION_CHARACTER_DEBOOST_INITIATIVE:175,ACTION_CHARACTER_BOOST_MAGIC_FIND:176,ACTION_CHARACTER_DEBOOST_MAGIC_FIND:177,ACTION_CHARACTER_BOOST_HEAL_BONUS:178,ACTION_CHARACTER_DEBOOST_HEAL_BONUS:179,ACTION_CHARACTER_ADD_DOUBLE:180,ACTION_SUMMON_CREATURE:181,ACTION_CHARACTER_BOOST_MAXIMUM_SUMMONED_CREATURES:182,ACTION_CHARACTER_BOOST_MAGICAL_REDUCTION:183,ACTION_CHARACTER_BOOST_PHYSICAL_REDUCTION:184,ACTION_SUMMON_STATIC_CREATURE:185,ACTION_CHARACTER_ALIGNMENT_RANK_SET:187,ACTION_CHARACTER_ALIGNMENT_SIDE_SET:188,ACTION_CHARACTER_ALIGNMENT_VALUE_SET:189,ACTION_CHARACTER_ALIGNMENT_VALUE_MODIFICATION:190,ACTION_CHARACTER_INVENTORY_CLEAR:191,ACTION_CHARACTER_INVENTORY_REMOVE_ITEM:192,ACTION_CHARACTER_INVENTORY_ADD_ITEM:193,ACTION_CHARACTER_INVENTORY_ADD_ITEM_NOCHECK:209,ACTION_CHARACTER_INVENTORY_ADD_ITEM_RANDOM_NOCHECK:221,ACTION_CHARACTER_INVENTORY_ADD_ITEM_FROM_RANDOM_DROP:222,ACTION_CHARACTER_INVENTORY_GAIN_KAMAS:194,ACTION_CHARACTER_INVENTORY_LOSE_KAMAS:195,ACTION_CHARACTER_OPEN_MY_STORAGE:196,ACTION_CHARACTER_TRANSFORM:197,ACTION_CHARACTER_CLEAR_ALL_JOB:198,ACTION_CHARACTER_REPAIR_OBJECT:199,ACTION_CHARACTER_INVENTORY_ADD_ITEM_ON_RP_MAP:232,ACTION_CHARACTER_INVENTORY_REMOVE_ITEM_ON_RP_MAP:233,ACTION_DECORS_PLAY_OBJECT_ANIMATION:200,ACTION_DECORS_ADD_OBJECT:201,ACTION_DECORS_REVEAL_UNVISIBLE:202,ACTION_DECORS_OBSTACLE_CLOSE:203,ACTION_DECORS_OBSTACLE_OPEN:204,ACTION_CHARACTER_CHANGE_RESTRICTION:205,ACTION_CHARACTER_RESURRECTION:206,ACTION_COLLECT_RESOURCE:207,ACTION_DECORS_PLAY_ANIMATION:208,ACTION_DECORS_PLAY_ANIMATION_UNLIGHTED:228,ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PERCENT:210,ACTION_CHARACTER_BOOST_WATER_ELEMENT_PERCENT:211,ACTION_CHARACTER_BOOST_AIR_ELEMENT_PERCENT:212,ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PERCENT:213,ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PERCENT:214,ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_PERCENT:215,ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_PERCENT:216,ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_PERCENT:217,ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_PERCENT:218,ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_PERCENT:219,ACTION_CHARACTER_REFLECTOR_UNBOOSTED:220,ACTION_DECORS_OBSTACLE_CLOSE_RANDOM:223,ACTION_DECORS_OBSTACLE_OPEN_RANDOM:224,ACTION_CHARACTER_BOOST_TRAP:225,ACTION_CHARACTER_BOOST_TRAP_PERCENT:226,ACTION_CHARACTER_GAIN_RIDE:229,ACTION_CHARACTER_ENERGY_LOSS_BOOST:230,ACTION_CHARACTER_ENERGY_POINTS_LOOSE:231,ACTION_CHARACTER_BOOST_EARTH_ELEMENT_RESIST:240,ACTION_CHARACTER_BOOST_WATER_ELEMENT_RESIST:241,ACTION_CHARACTER_BOOST_AIR_ELEMENT_RESIST:242,ACTION_CHARACTER_BOOST_FIRE_ELEMENT_RESIST:243,ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_RESIST:244,ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_RESIST:245,ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_RESIST:246,ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_RESIST:247,ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_RESIST:248,ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_RESIST:249,ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PVP_PERCENT:250,ACTION_CHARACTER_BOOST_WATER_ELEMENT_PVP_PERCENT:251,ACTION_CHARACTER_BOOST_AIR_ELEMENT_PVP_PERCENT:252,ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PVP_PERCENT:253,ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PVP_PERCENT:254,ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_PVP_PERCENT:255,ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_PVP_PERCENT:256,ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_PVP_PERCENT:257,ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_PVP_PERCENT:258,ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_PVP_PERCENT:259,ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PVP_RESIST:260,ACTION_CHARACTER_BOOST_WATER_ELEMENT_PVP_RESIST:261,ACTION_CHARACTER_BOOST_AIR_ELEMENT_PVP_RESIST:262,ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PVP_RESIST:263,ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PVP_RESIST:264,ACTION_CHARACTER_STEAL_CHANCE:266,ACTION_CHARACTER_STEAL_VITALITY:267,ACTION_CHARACTER_STEAL_AGILITY:268,ACTION_CHARACTER_STEAL_INTELLIGENCE:269,ACTION_CHARACTER_STEAL_WISDOM:270,ACTION_CHARACTER_STEAL_STRENGTH:271,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING_FROM_WATER:275,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING_FROM_EARTH:276,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING_FROM_AIR:277,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING_FROM_FIRE:278,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING:279,ACTION_CHARACTER_BOOST_SHIELD_BASED_ON_CASTER_LIFE:1039,ACTION_CHARACTER_BOOST_SHIELD:1040,ACTION_CHARACTER_ADD_SPELL_COOLDOWN:1035,ACTION_CHARACTER_REMOVE_SPELL_COOLDOWN:1036,ACTION_CHARACTER_UPDATE_BOOST:515,ACTION_CHARACTER_BOOST_DISPELLED:514,ACTION_BOOST_SPELL_RANGE:281,ACTION_BOOST_SPELL_RANGEABLE:282,ACTION_BOOST_SPELL_DMG:283,ACTION_BOOST_SPELL_HEAL:284,ACTION_BOOST_SPELL_AP_COST:285,ACTION_BOOST_SPELL_CAST_INTVL:286,ACTION_BOOST_SPELL_CC:287,ACTION_BOOST_SPELL_CASTOUTLINE:288,ACTION_BOOST_SPELL_NOLINEOFSIGHT:289,ACTION_BOOST_SPELL_MAXPERTURN:290,ACTION_BOOST_SPELL_MAXPERTARGET:291,ACTION_BOOST_SPELL_CAST_INTVL_SET:292,ACTION_BOOST_SPELL_BASE_DMG:293,ACTION_DEBOOST_SPELL_RANGE:294,ACTION_FIGHT_CAST_SPELL:300,ACTION_FIGHT_CAST_SPELL_CRITICAL_HIT:301,ACTION_FIGHT_CAST_SPELL_CRITICAL_MISS:302,ACTION_FIGHT_CLOSE_COMBAT:303,ACTION_FIGHT_CLOSE_COMBAT_CRITICAL_HIT:304,ACTION_FIGHT_CLOSE_COMBAT_CRITICAL_MISS:305,ACTION_FIGHT_TRIGGER_TRAP:306,ACTION_FIGHT_TRIGGER_GLYPH:307,ACTION_FIGHT_SPELL_DODGED_PA:308,ACTION_FIGHT_SPELL_DODGED_PM:309,ACTION_CHARACTER_STEAL_RANGE:320,ACTION_FIGHT_ADD_TRAP_CASTING_SPELL:400,ACTION_FIGHT_ADD_GLYPH_CASTING_SPELL:401,ACTION_FIGHT_ADD_GLYPH_CASTING_SPELL_ENDTURN:402,ACTION_FIGHT_KILL_AND_SUMMON:405,ACTION_INTERACTIVE_ELEMENT:500,ACTION_SKILL_ANIMATION:501,ACTION_EXCHANGE_CRAFT_OPEN:502,ACTION_USE_WAYPOINT:503,ACTION_DO_ELEMENT_PARAMETERIZED_OPERATION:505,ACTION_INTERACTIVE_ELEMENT_AT_HOME_INNER_DOOR:507,ACTION_SAVE_WAYPOINT:508,ACTION_CHANGE_COMPASS:509,ACTION_USE_SUBWAY:510,ACTION_EXCHANGE_JOBINDEX_OPEN:511,ACTION_USE_PRISM:512,ACTION_ADD_PRISM:513,ACTION_GOTO_WAYPOINT:600,ACTION_GOTO_MAP:601,ACTION_CHARACTER_LEARN_JOB:603,ACTION_CHARACTER_LEARN_SPELL:604,ACTION_CHARACTER_GAIN_XP:605,ACTION_CHARACTER_GAIN_WISDOM:606,ACTION_CHARACTER_GAIN_STRENGTH:607,ACTION_CHARACTER_GAIN_CHANCE:608,ACTION_CHARACTER_GAIN_AGILITY:609,ACTION_CHARACTER_GAIN_VITALITY:610,ACTION_CHARACTER_GAIN_INTELLIGENCE:611,ACTION_CHARACTER_GAIN_STATS_POINTS:612,ACTION_CHARACTER_GAIN_SPELL_POINTS:613,ACTION_CHARACTER_GAIN_JOB_XP:614,ACTION_CHARACTER_UNLEARN_JOB:615,ACTION_CHARACTER_UNBOOST_SPELL:616,ACTION_CHARACTER_GET_MARRIED:617,ACTION_CHARACTER_GET_MARRIED_ACCEPT:618,ACTION_CHARACTER_GET_MARRIED_DECLINE:619,ACTION_CHARACTER_READ_BOOK:620,ACTION_CHARACTER_SUMMON_MONSTER:621,ACTION_GOTO_HOUSE:622,ACTION_CHARACTER_SUMMON_MONSTER_GROUP:623,ACTION_CHARACTER_SUMMON_MONSTER_GROUP_SET_MAP:627,ACTION_CHARACTER_SUMMON_MONSTER_GROUP_DYNAMIC:628,ACTION_CHARACTER_UNLEARN_GUILDSPELL:624,ACTION_CHARACTER_UNBOOST_CARACS:625,ACTION_CHARACTER_UNBOOST_CARACS_TO_101:626,ACTION_CHARACTER_SEND_INFORMATION_TEXT:630,ACTION_CHARACTER_SEND_DIALOG_ACTION:631,ACTION_CHARACTER_GAIN_HONOUR:640,ACTION_CHARACTER_GAIN_DISHONOUR:641,ACTION_CHARACTER_LOOSE_HONOUR:642,ACTION_CHARACTER_LOOSE_DISHONOUR:643,ACTION_MAP_RESURECTION_ALLIES:645,ACTION_MAP_HEAL_ALLIES:646,ACTION_MAP_FORCE_ENNEMIES_GHOST:647,ACTION_FORCE_ENNEMY_GHOST:648,ACTION_FAKE_ALIGNMENT:649,ACTION_TELEPORT_NOOBY_MAP:650,ACTION_USE_ELEMENT_ACTIONS:651,ACTION_SET_STATED_ELEMENT_STATE:652,ACTION_RESET_STATED_ELEMENT:653,ACTION_HOUSE_LEAVE:654,ACTION_NOOP:666,ACTION_INCARNATION:669,ACTION_CHARACTER_REFERENCEMENT:699,ACTION_ITEM_CHANGE_EFFECT:700,ACTION_ITEM_ADD_EFFECT:701,ACTION_ITEM_ADD_DURABILITY:702,ACTION_CAPTURE_SOUL:705,ACTION_CAPTURE_RIDE:706,ACTION_CHARACTER_ADD_COST_TO_ACTION:710,ACTION_LADDER_SUPERRACE:715,ACTION_LADDER_RACE:716,ACTION_LADDER_ID:717,ACTION_PVP_LADDER:720,ACTION_VICTIM_OF:721,ACTION_GAIN_TEMP_SPELL:722,ACTION_GAIN_AURA:723,ACTION_GAIN_TITLE:724,ACTION_CHARACTER_RENAME_GUILD:725,ACTION_TELEPORT_NEAREST_PRISM:730,ACTION_AUTO_AGGRESS_ENEMY_PLAYER:731,ACTION_SHUSHU_STACK_RUNE:742,ACTION_BOOST_SOUL_CAPTURE_BONUS:750,ACTION_BOOST_RIDE_XP_BONUS:751,ACTION_REMOVE_ON_MOVE:760,ACTION_CHARACTER_SACRIFY:765,ACTION_HOURLY_CONFUSION_DEGREE:770,ACTION_HOURLY_CONFUSION_PI_2:771,ACTION_HOURLY_CONFUSION_PI_4:772,ACTION_UNHOURLY_CONFUSION_DEGREE:773,ACTION_UNHOURLY_CONFUSION_PI_2:774,ACTION_UNHOURLY_CONFUSION_PI_4:775,
ACTION_CHARACTER_BOOST_PERMANENT_DAMAGE_PERCENT:776,ACTION_CHARACTER_SUMMON_DEAD_ALLY_IN_FIGHT:780,ACTION_CHARACTER_UNLUCKY:781,ACTION_CHARACTER_MAXIMIZE_ROLL:782,ACTION_CHARACTER_WALK_FOUR_DIR:785,ACTION_FIND_BOUNTY_TARGET:790,ACTION_MARK_TARGET_MERCENARY:791,ACTION_ITEM_CHANGE_PETS_LIFE:800,ACTION_ITEM_CHANGE_DURATION:805,ACTION_ITEM_PETS_SHAPE:806,ACTION_ITEM_PETS_EAT:807,ACTION_PETS_LAST_MEAL:808,ACTION_ITEM_CHANGE_DURABILITY:812,ACTION_ITEM_UPDATE_DATE:813,ACTION_ITEM_CHOOSE_IN_ITEM_LIST:820,ACTION_CLIENT_OPEN_UI:830,PARAM_CLIENT_OPEN_UI_GUILD_TELEPORT_HOUSE:1,PARAM_CLIENT_OPEN_UI_GUILD_TELEPORT_FARM:2,ACTION_CLIENT_OPEN_UI_SPELL_FORGET:831,ACTION_FIGHT_TURN_FINISHED:899,ACTION_FIGHT_CHALLENGE:900,ACTION_FIGHT_CHALLENGE_ACCEPT:901,ACTION_FIGHT_CHALLENGE_DECLINE:902,ACTION_FIGHT_CHALLENGE_JOIN:903,ACTION_FIGHT_CHALLENGE_AGAINST_MONSTER:905,ACTION_FIGHT_AGGRESSION:906,ACTION_FIGHT_AGAINST_TAXCOLLECTOR:909,ACTION_FIGHT_CHALLENGE_AGAINST_MUTANT:910,ACTION_FIGHT_CHALLENGE_MIXED_VERSUS_MONSTER:911,ACTION_FIGHT_AGAINST_PRISM:912,ACTION_TOOLTIP_ACTIVATE_TIP:915,ACTION_PNJ_REMOVE_RIDE:938,ACTION_PET_SET_POWER_BOOST:939,ACTION_FARM_WITHDRAW_ITEM:947,ACTION_FARM_PLACE_ITEM:948,ACTION_MOUNT_RIDE:949,ACTION_FIGHT_SET_STATE:950,ACTION_FIGHT_UNSET_STATE:951,ACTION_CREATED_SINCE:963,ACTION_SHOW_PLAYERNAME:964,ACTION_ID_LIVING_OBJECT_MOOD:971,ACTION_ID_LIVING_OBJECT_SKIN:972,ACTION_ID_LIVING_OBJECT_CATEGORY:973,ACTION_ID_LIVING_OBJECT_LEVEL:974,ACTION_BOOST_GLOBAL_RESISTS_BONUS:1076,ACTION_BOOST_GLOBAL_RESISTS_MALUS:1077},s={};s[o.ACTION_CHARACTER_BOOST_LIFE_POINTS]=["lifePoints",!0],s[o.ACTION_CHARACTER_MOVEMENT_POINTS_LOST]=["movementPoints",!1],s[o.ACTION_CHARACTER_BOOST_MOVEMENT_POINTS]=["movementPoints",!0],s[o.ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS]=["movementPoints",!1],s[o.ACTION_CHARACTER_ACTION_POINTS_LOST]=["actionPoints",!1],s[o.ACTION_CHARACTER_BOOST_ACTION_POINTS]=["actionPoints",!0],s[o.ACTION_CHARACTER_DEBOOST_ACTION_POINTS]=["actionPoints",!1],s[o.ACTION_CHARACTER_DEBOOST_DAMAGES]=["allDamagesBonus",!1],s[o.ACTION_CHARACTER_BOOST_DAMAGES]=["allDamagesBonus",!0],s[o.ACTION_CHARACTER_BOOST_PHYSICAL_DAMAGES]=["physicalDamagesBonus",!0],s[o.ACTION_CHARACTER_DEBOOST_DAMAGES_PERCENT]=["damagesBonusPercent",!1],s[o.ACTION_CHARACTER_BOOST_DAMAGES_PERCENT]=["damagesBonusPercent",!0],s[o.ACTION_CHARACTER_BOOST_MAXIMUM_SUMMONED_CREATURES]=["summonableCreaturesBoost",!0],s[o.ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_PERCENT]=["earthElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PERCENT]=["earthElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_PERCENT]=["waterElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_WATER_ELEMENT_PERCENT]=["waterElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_PERCENT]=["airElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_AIR_ELEMENT_PERCENT]=["airElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_PERCENT]=["fireElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PERCENT]=["fireElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_PERCENT]=["neutralElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PERCENT]=["neutralElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_PVP_PERCENT]=["pvpEarthElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PVP_PERCENT]=["pvpEarthElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_PVP_PERCENT]=["pvpWaterElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_WATER_ELEMENT_PVP_PERCENT]=["pvpWaterElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_PVP_PERCENT]=["pvpAirElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_AIR_ELEMENT_PVP_PERCENT]=["pvpAirElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_PVP_PERCENT]=["pvpFireElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PVP_PERCENT]=["pvpFireElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_PVP_PERCENT]=["pvpNeutralElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PVP_PERCENT]=["pvpNeutralElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_RANGE]=["range",!1],s[o.ACTION_CHARACTER_BOOST_RANGE]=["range",!0],s[o.ACTION_CHARACTER_DEBOOST_STRENGTH]=["strength",!1],s[o.ACTION_CHARACTER_BOOST_STRENGTH]=["strength",!0],s[o.ACTION_CHARACTER_DEBOOST_AGILITY]=["agility",!1],s[o.ACTION_CHARACTER_BOOST_AGILITY]=["agility",!0],s[o.ACTION_CHARACTER_DEBOOST_CHANCE]=["chance",!1],s[o.ACTION_CHARACTER_BOOST_CHANCE]=["chance",!0],s[o.ACTION_CHARACTER_DEBOOST_WISDOM]=["wisdom",!1],s[o.ACTION_CHARACTER_BOOST_WISDOM]=["wisdom",!0],s[o.ACTION_CHARACTER_DEBOOST_VITALITY]=["vitality",!1],s[o.ACTION_CHARACTER_BOOST_VITALITY]=["vitality",!0],s[o.ACTION_CHARACTER_DEBOOST_INTELLIGENCE]=["intelligence",!1],s[o.ACTION_CHARACTER_BOOST_INTELLIGENCE]=["intelligence",!0],s[o.ACTION_CHARACTER_BOOST_TRAP]=["trapBonus",!0],s[o.ACTION_CHARACTER_BOOST_TRAP_PERCENT]=["trapBonusPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_RESIST]=["earthElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_EARTH_ELEMENT_RESIST]=["earthElementReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_RESIST]=["waterElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_WATER_ELEMENT_RESIST]=["waterElementReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_RESIST]=["airElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_AIR_ELEMENT_RESIST]=["airElementReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_RESIST]=["fireElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_FIRE_ELEMENT_RESIST]=["fireElementReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_RESIST]=["neutralElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_RESIST]=["neutralElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PVP_RESIST]=["pvpEarthElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_WATER_ELEMENT_PVP_RESIST]=["pvpWaterElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_AIR_ELEMENT_PVP_RESIST]=["pvpAirElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PVP_RESIST]=["pvpFireElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PVP_RESIST]=["pvpNeutralElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_CRITICAL_MISS]=["criticalMiss",!0],s[o.ACTION_CHARACTER_BOOST_CRITICAL_HIT]=["criticalHit",!0],s[o.ACTION_CHARACTER_DEBOOST_CRITICAL_HIT]=["criticalHit",!1],s[o.ACTION_CHARACTER_BOOST_INITIATIVE]=["initiative",!0],s[o.ACTION_CHARACTER_DEBOOST_INITIATIVE]=["initiative",!1],s[o.ACTION_CHARACTER_BOOST_MAGIC_FIND]=["prospecting",!0],s[o.ACTION_CHARACTER_DEBOOST_MAGIC_FIND]=["prospecting",!1],s[o.ACTION_CHARACTER_BOOST_HEAL_BONUS]=["healBonus",!0],s[o.ACTION_CHARACTER_BOOST_SHIELD_BASED_ON_CASTER_LIFE]=["shieldPoints",!0],s[o.ACTION_CHARACTER_BOOST_SHIELD]=["shieldPoints",!0],s[o.ACTION_CHARACTER_LIFE_POINTS_MALUS]=["lifePointsMalus",!1],s[o.ACTION_CHARACTER_LIFE_POINTS_MALUS_PERCENT]=["lifePointsMalus",!1],s[o.ACTION_CHARACTER_REFLECTOR_UNBOOSTED]=["reflectorUnboosted",!0],s[o.ACTION_CHARACTER_DEBOOST_ACTION_POINTS_LOST_DODGE]=["dodgePALostProbability",!1],s[o.ACTION_CHARACTER_BOOST_ACTION_POINTS_LOST_DODGE]=["dodgePALostProbability",!0],s[o.ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS_LOST_DODGE]=["dodgePMLostProbability",!1],s[o.ACTION_CHARACTER_BOOST_MOVEMENT_POINTS_LOST_DODGE]=["dodgePMLostProbability",!0],s[o.ACTION_CHARACTER_BOOST_DAMAGES_FOR_ALL_GAME]=["allDamagesBonus",!0],s[o.ACTION_CHARACTER_DEBOOST_MAXIMUM_WEIGHT]=["maximumWeight",!1],s[o.ACTION_CHARACTER_BOOST_MAXIMUM_WEIGHT]=["maximumWeight",!0],s[o.ACTION_CHARACTER_DEBOOST_PHYSICAL_REDUCTION]=["physicalReduction",!1],s[o.ACTION_CHARACTER_BOOST_PHYSICAL_REDUCTION]=["physicalReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_MAGICAL_REDUCTION]=["magicalReduction",!1],s[o.ACTION_CHARACTER_BOOST_MAGICAL_REDUCTION]=["magicalReduction",!0],s[o.ACTION_CHARACTER_BOOST_DODGE]=["tackleEvade",!0],s[o.ACTION_CHARACTER_BOOST_TACKLE]=["tackleBlock",!0],s[o.ACTION_CHARACTER_DEBOOST_DODGE]=["tackleEvade",!1],s[o.ACTION_CHARACTER_DEBOOST_TACKLE]=["tackleBlock",!1],s[o.ACTION_CHARACTER_BOOST_PERMANENT_DAMAGE_PERCENT]=["permanentDamagePercent",!0],s[o.ACTION_BOOST_GLOBAL_RESISTS_BONUS]=["globalResistPercentBonus",!0],s[o.ACTION_BOOST_GLOBAL_RESISTS_MALUS]=["globalResistPercentMalus",!0],o.getActionStatName=i,o.getIsABoost=n,e.exports=o},function(e,t){e.exports={DISPELLABLE:1,DISPELLABLE_BY_DEATH:2,DISPELLABLE_BY_STRONG_DISPEL:3,REALLY_NOT_DISPELLABLE:4}},function(e,t,i){function n(e){var t=e.substr(0,1),i=e.length>1?e.substr(1).split(","):[],n=0,o=0,s=0,a=0;switch(i.length){case 1:n=parseInt(i[0],10);break;case 2:n=parseInt(i[0],10),T[t].hasMinSize?o=parseInt(i[1],10):s=parseInt(i[1],10);break;case 3:n=parseInt(i[0],10),T[t].hasMinSize?(o=parseInt(i[1],10),s=parseInt(i[2],10)):(s=parseInt(i[1],10),a=parseInt(i[2],10));break;case 4:n=parseInt(i[0],10),o=parseInt(i[1],10),s=parseInt(i[2],10),a=parseInt(i[3],10)}return{zoneShape:t,zoneSize:n,zoneMinSize:o,zoneEfficiencyPercent:s,zoneMaxEfficiency:a}}function o(e){if(!e)return"";var t=e.zoneShape,i=e.zoneSize;return"L"===t&&(i+=1),T[t].desc?v(T[t].desc,i):""}function s(e){return void 0===e||null===e}function a(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this._init()}function r(e,t){var i=window.gui.databases.IncarnationLevels,n=100*e+t;return i[n]}function l(e,t){e instanceof Array||(e=[e]);for(var i=[],n=0;n<e.length;n++)i.push(new a(e[n]));p(i,t)}function c(e,t){var i=[];for(var n in e)e.hasOwnProperty(n)&&(i.push(e[n]),e[n]=i.length-1);l(i,function(i,n){if(i)return t(i);for(var o in e)e.hasOwnProperty(o)&&(e[o]=n[e[o]]);return t(null,e)})}function d(e){if(null!==e.effectId&&"null"!==e.effectId)return!0;var t="effectInstanceFactory: an effectId is null. ";return t+="description: "+e.description+" ",t+="type: "+e._type+" ",t+="keys: "+JSON.stringify(Object.keys(e)),console.error(new Error(t)),!1}function u(e,t){for(var i={},n=0;n<e.length;n++){var o=e[n];d(o)&&(i[o.effectId]=!0)}return i=Object.keys(i),0===i.length?t(null,{}):void M.getData("Effects",i,function(e,n){return e?t(e):void t(null,y.extractElementsFrom(i,n,!0))})}function h(e,t){var i=S[t],n=E[i],o={_type:i};for(var s in n)o[s]=e[s];return o}var p,m,f,g,_=i(31),v=i(29).getText,y=i(339),b=i(29).processText,M=i(30),w=i(352),T={X:{code:88,desc:"ui.spellarea.cross",alt:"",hasMinSize:!0},L:{code:76,desc:"ui.spellarea.line",alt:"",hasMinSize:!1},T:{code:84,desc:"ui.spellarea.tarea",alt:"",hasMinSize:!1},P:{code:80,desc:"",alt:"",hasMinSize:!1},D:{code:68,desc:"ui.spellarea.chessboard",alt:"",hasMinSize:!1},C:{code:67,desc:"ui.spellarea.circle",alt:"",hasMinSize:!0},O:{code:79,desc:"ui.spellarea.ring",alt:"",hasMinSize:!1},Q:{code:81,desc:"ui.spellarea.crossVoid",alt:"",hasMinSize:!0},V:{code:86,desc:"ui.spellarea.cone",alt:"",hasMinSize:!1},W:{code:87,desc:"",alt:"",hasMinSize:!1},"+":{code:43,desc:"",alt:"plus",hasMinSize:!0},"#":{code:35,desc:"",alt:"sharp",hasMinSize:!0},"*":{code:42,desc:"",alt:"star",hasMinSize:!1},"/":{code:47,desc:"",alt:"slash",hasMinSize:!1},"-":{code:45,desc:"ui.spellarea.diagonal",alt:"minus",hasMinSize:!1},G:{code:71,desc:"ui.spellarea.square",alt:"",hasMinSize:!1},I:{code:73,desc:"",alt:"",hasMinSize:!1},U:{code:85,desc:"ui.spellarea.halfcircle",alt:"",hasMinSize:!1},A:{code:65,desc:"ui.spellarea.everyone",alt:"",hasMinSize:!1}},C={effectId:0,targetId:0,targetMask:null,duration:0,delay:0,random:0,group:0,modificator:0,trigger:!1,triggers:null,hidden:!0,zoneSize:0,zoneShape:0,zoneMinSize:0,zoneEfficiencyPercent:0,zoneMaxEfficiency:0},A={ObjectEffectString:"EffectInstanceString",ObjectEffectInteger:"EffectInstanceInteger",ObjectEffectMinMax:"EffectInstanceMinMax",ObjectEffectDice:"EffectInstanceDice",ObjectEffectDate:"EffectInstanceDate",ObjectEffectDuration:"EffectInstanceDuration",ObjectEffectLadder:"EffectInstanceLadder",ObjectEffectCreature:"EffectInstanceCreature",ObjectEffectMount:"EffectInstanceMount"},I={undefined:-1,miscellaneous:0,resistance:1,damage:2,special:3};a.prototype._init=function(){if(this.description="",this.subEffectDescription="",this.effect=null,this._retrieveInstanceType(),this.hasOwnProperty("actionId"))if(this.duration=0,this.effectId=this.actionId,"EffectInstanceDice"===this._type&&669===this.effectId){this._type="EffectInstanceDate",this.year=this.diceNum,this.month=32768*this.diceSide+this.diceConst;var e=1,t=0;do{e++;var i=r(this.diceNum,e);i&&(t=i.requiredXp)}while(t<this.month&&e<51);e--,this.day=e,this.hour=0,this.minute=0}else switch(this._type){case"EffectInstanceString":this.text=this.value,delete this.value;break;case"EffectInstanceDice":this.value=this.diceConst,delete this.diceConst;break;case"EffectInstanceDate":this.month+=1}},a.prototype._retrieveInstanceType=function(){return this._type?void(A[this._type]&&(this._type=A[this._type])):void(this.hasOwnProperty("diceNum")?this._type="EffectInstanceDice":this.hasOwnProperty("year")?this._type="EffectInstanceDate":this.hasOwnProperty("days")?this._type="EffectInstanceDuration":this.hasOwnProperty("min")?this._type="EffectInstanceMinMax":this.hasOwnProperty("monsterCount")?this._type="EffectInstanceLadder":this.hasOwnProperty("monsterFamilyId")?this._type="EffectInstanceCreature":this.hasOwnProperty("mountId")?this._type="EffectInstanceMount":this.hasOwnProperty("text")?this._type="EffectInstanceString":this._type="EffectInstanceInteger")},a.prototype.clone=function(){var e=new a,t=w.getOwnProperties(this).filter(function(e){return"effect"!==e});w.shallowCopyProperties(this,e,t);var i=this.effect;return i&&(e.effect={},w.shallowCopyProperties(i,e.effect,w.getOwnProperties(i))),e},a.prototype.getParams=function(){switch(this._type){case"EffectInstanceString":return[null,null,null,this.text];case"EffectInstanceInteger":return[this.value];case"EffectInstanceMinMax":return[this.min,this.min!==this.max?this.max:null];case"EffectInstanceDice":var e=this.value||null,t=this.diceSide||null;return[0!==this.diceNum?this.diceNum:null,t,e];case"EffectInstanceDate":var i=this.month>9?this.month:"0"+this.month,n=this.day>9?this.day:"0"+this.day,o=this.hour>9?this.hour:"0"+this.hour,s=this.minute>9?this.minute:"0"+this.minute;return[this.year,i+""+n,o+""+s,this.month,this.day];case"EffectInstanceDuration":return[this.days,this.hours,this.minutes];case"EffectInstanceLadder":return[this.monsterFamilyId,this.monsterCount];case"EffectInstanceCreature":return[this.monsterFamilyId];case"EffectInstanceMount":return[this.date,this.modelId,this.mountId];default:return[]}},a.prototype.setParameter=function(e,t){switch(this._type){case"EffectInstanceString":return void(3===e&&(this.text=t.toString()));case"EffectInstanceInteger":return void(2===e&&(this.value=t));case"EffectInstanceMinMax":return void(0===e?this.min=t:1===e&&(this.max=t));case"EffectInstanceDice":return void(0===e?this.diceNum=t:1===e?this.diceSide=t:2===e&&(this.value=t));case"EffectInstanceDate":return void(0===e?this.year=t:1===e?(this.month=t.substr(0,2),this.day=t.substr(2,2)):2===e?(this.hour=t.substr(0,2),this.minute=t.substr(2,2)):3===e?this.month=t:4===e&&(this.day=t));case"EffectInstanceDuration":return void(0===e?this.days=t:1===e?this.hours=t:2===e&&(this.minutes=t));case"EffectInstanceLadder":return void(0===e?this.monsterFamilyId=t:2===e&&(this.monsterCount=t));case"EffectInstanceCreature":return void(0===e&&(this.monsterFamilyId=t));case"EffectInstanceMount":return void(0===e?this.date=Number(t):1===e?this.modelId=Number(t):2===e&&(this.mountId=Number(t)));default:return}},a.prototype.getValue=function(e){return this.hasOwnProperty(e)?this[e]:C[e]},a.prototype.setDescription=function(e){if(this.effect.hasOwnProperty("descriptionId")){e.unshift(this.effect.descriptionId);var t=b.apply(null,e);this.description=t||"";var i=this.getValue("modificator");0!==i&&(this.description+=" "+v("ui.effect.boosted.spell.complement",[i],"%"));var n=this.getValue("random");n>0&&(this.getValue("group")>0?this.description+=" ("+v("ui.common.random")+")":this.description+=" "+v("ui.effect.randomProbability",[n],"%")),this.trigger&&(this.description=v("ui.spell.trigger",this.description))}},a.prototype.getDurationString=function(e){return this.delay?v("ui.common.delayTurn",this.delay,this.delay<=1):!this.duration||isNaN(this.duration)?"":this.duration<0?v("ui.common.infinit"):this.duration>1?v("ui.common.turn",this.duration,!0):e?v("ui.common.lastTurn"):v("ui.common.turn",this.duration,!1)},a.prototype.isDamageEffect=function(){return this.effect&&this.effect.category===I.damage},a.prototype.getZoneEffect=function(){return this.rawZone?n(this.rawZone):{zoneShape:this.getValue("zoneShape"),zoneSize:this.getValue("zoneSize"),zoneMinSize:this.getValue("zoneMinSize"),zoneEfficiencyPercent:this.getValue("zoneEfficiencyPercent"),zoneMaxEfficiency:this.getValue("zoneMaxEfficiency")}},a.prototype.getHumanReadableZoneInfo=function(){return o(this.getZoneEffect())},a.prototype.requiresInvocationDescription=function(){return 181===this.effectId||1011===this.effectId},a.prototype.requiresGlyphDescription=function(){return 401===this.effectId||402===this.effectId},a.prototype.requiresTrapDescription=function(){return 400===this.effectId},a.prototype.requiresBombDescription=function(){return 1008===this.effectId},a.prototype.forceDescriptionRefresh=function(e){this.description="",this.subEffectDescription="",g([this],null,function(t){return e?e(t):void(t&&console.error(t))})},g=function(e,t,i){var n,o={},s=function(e,t){o[e]||(o[e]={}),o[e][t]=!0};_.each(e,function(e,i){return e?(e.description||(n=e.getParams(),m(e,n,t,s)),void(""===e.subEffectDescription?(n=e.getParams(),f(e,n,t,s,i)):i())):i()},function(n){if(n)return i(n);if(0===Object.keys(o).length)return i(null,e);for(var s in o)o.hasOwnProperty(s)&&(o[s]=Object.keys(o[s]));_.each(Object.keys(o),function(e,i){M.getData(e,o[e],function(n,s){if(n)return i(n);for(var a=y.extractElementsFrom(o[e],s,!0),r=0;r<o[e].length;r++){var l=o[e][r];if(!a[l])return i(new Error("id "+l+" unavailable in table "+e))}o[e]=a,t||(t={}),t[e]||(t[e]={});for(var c in o[e])o[e].hasOwnProperty(c)&&(t[e][c]=o[e][c]);i()})},function(n){return n?i(n):void g(e,t,i)})})},m=function(e,t,i,n){switch(e.effectId){case 10:null===t[0]&&t[2]&&(t[0]=t[2]),i?(t[2]=i.Emoticons[t[0]].nameId,e.setDescription(t)):n("Emoticons",t[0]);break;case 165:case 1084:i?(t[0]=i.ItemTypes[t[0]].nameId,e.setDescription(t)):n("ItemTypes",t[0]);break;case 197:case 181:case 185:case 717:case 1008:case 1011:i?(t[0]=i.Monsters[t[0]].nameId,e.setDescription(t)):n("Monsters",t[0]);break;case 281:case 282:case 283:case 284:case 285:case 286:case 287:case 288:case 289:case 290:case 291:case 292:case 293:case 294:case 1160:case 787:case 792:case 793:case 1017:case 1018:case 1019:case 1035:case 1036:case 1044:case 1045:i?(t[0]=i.Spells[t[0]].nameId,e.setDescription(t)):n("Spells",t[0]);break;case 406:if(!t[2])break;i?(t[2]=i.Spells[t[2]].nameId,e.setDescription(t)):n("Spells",t[2]);break;case 603:case 615:null===t[0]&&t[2]&&(t[0]=t[2]),i?(t[2]=i.Jobs[t[0]].nameId,e.setDescription(t)):n("Jobs",t[0]);break;case 604:s(t[2])&&(t[2]=t[0]),i&&i.SpellLevels&&i.SpellLevels[t[2]]?i.Spells&&i.Spells[i.SpellLevels[t[2]].spellId]?(t[2]=i.Spells[i.SpellLevels[t[2]].spellId].nameId,e.setDescription(t)):n("Spells",i.SpellLevels[t[2]].spellId):n("SpellLevels",t[2]);break;case 614:case 1050:t[0]=t[2],i?(t[1]=i.Jobs[t[1]].nameId,e.setDescription(t)):n("Jobs",t[1]);break;case 616:case 624:if(s(t[0]))break;i?(t[2]=i.Spells[t[0]].nameId,e.setDescription(t)):n("Spells",t[0]);break;case 620:if(s(t[0]))break;i?(t[2]=i.Documents[t[0]].titleId,e.setDescription(t)):n("Documents",t[0]);break;case 621:i?(t[2]=i.Monsters[t[1]].nameId,e.setDescription(t)):n("Monsters",t[1]);break;case 623:case 628:if(s(t[2]))break;if(i){var o=i.Monsters[t[2]];t[1]=o.grades[t[0]-1].level,t[2]=o.nameId,e.setDescription(t)}else n("Monsters",t[2]);break;case 649:case 960:i?(t[2]=i.AlignmentSides[t[0]].titleId,e.setDescription(t)):n("AlignmentSides",t[0]);break;case 699:i?(t[0]=i.Jobs[t[0]].nameId,e.setDescription(t)):n("Jobs",t[0]);break;case 716:i?(t[0]=i.MonsterRaces[t[0]].nameId,e.setDescription(t)):n("MonsterRaces",t[0]);break;case 724:if(s(t[0])&&!s(t[2])&&(t[0]=t[2]),i){var a=window.gui.playerData.characterBaseInformations&&window.gui.playerData.characterBaseInformations.sex?"nameFemaleId":"nameMaleId";t[2]=i.Titles[t[0]][a],e.setDescription(t)}else n("Titles",t[0]);break;case 800:t[2]=t[0],e.setDescription(t);break;case 806:t[1]>6?t[0]=v("ui.petWeight.fat",[t[1]]):t[2]>6?t[0]=v("ui.petWeight.lean",[t[2]]):"EffectInstanceInteger"===e._type&&t[0]>6?t[0]=v("ui.petWeight.lean",[t[0]]):t[0]=v("ui.petWeight.nominal"),e.setDescription(t);break;case 807:t[0]?i?(t[0]=i.Items[t[0]].nameId,e.setDescription(t)):n("Items",t[0]):(t[0]=v("ui.common.none"),e.setDescription(t));break;case 814:case 1151:if(i){var r=i.Items[t[0]];t[0]=r.nameId,e.setDescription(t),e.iconId=r.iconId}else n("Items",t[0]);break;case 905:i?(t[1]=i.Monsters[t[1]].nameId,e.setDescription(t)):n("Monsters",t[1]);break;case 939:if(s(t[0]))break;i?(t[2]=i.Items[t[0]].nameId,e.setDescription(t)):n("Items",t[0]);break;case 950:case 951:case 952:if(t[2]||(t[2]=t[0]),s(t[2]))break;i?(t[2]=i.SpellStates[t[2]].nameId,e.setDescription(t)):n("SpellStates",t[2]);break;case 961:case 962:t[2]=t[0],e.setDescription(t);break;case 988:case 987:case 985:case 996:e.setDescription(t);break;case 1111:t[2]=t[0],e.setDescription(t);break;case 1161:i?(t[0]=i.Companions[t[0]].nameId,e.setDescription(t)):n("Companions",t[0]);break;case 805:case 808:case 983:if(t[2]=s(t[2])?"0":t[2],"string"!=typeof t[1]||"string"!=typeof t[2])break;var l=t[0],c=t[1].substr(0,2),d=t[1].substr(2,2),u=t[2].substr(0,2),h=t[2].substr(2,2),p=window.Config.language;switch(p){case"fr":t[0]=d+"/"+c+"/"+l+" "+u+":"+h;break;default:t[0]=c+"/"+d+"/"+l+" "+u+":"+h}e.setDescription(t);break;default:e.setDescription(t)}},f=function(e,t,i,n,o){if(e.requiresInvocationDescription()){var s=t[0];if(!i||!i.Monsters||!i.Monsters[s])return n("Monsters",s),o();var a=i.Monsters[s],r=[],c=t[1];(c<1||c>a.grades.length)&&(c=a.grades.length);var d=a.grades[c-1],u=1;window.gui.playerData.characterBaseInformations&&window.gui.playerData.characterBaseInformations.level&&(u=window.gui.playerData.characterBaseInformations.level);var h=Math.floor(d.lifePoints+d.lifePoints*u/100),p=Math.floor((d.wisdom+d.wisdom*u/100)/10);r.push(v("ui.stats.HP")+v("ui.common.colon")+h),r.push(v("ui.stats.shortAP")+v("ui.common.colon")+d.actionPoints),r.push(v("ui.stats.shortMP")+v("ui.common.colon")+d.movementPoints),r.push(v("ui.stats.dodgeAP")+v("ui.common.colon")+(d.paDodge+p)),r.push(v("ui.stats.dodgeMP")+v("ui.common.colon")+(d.pmDodge+p)),r.push(v("ui.stats.neutralReductionPercent")+v("ui.common.colon")+d.neutralResistance),r.push(v("ui.stats.earthReductionPercent")+v("ui.common.colon")+d.earthResistance),r.push(v("ui.stats.fireReductionPercent")+v("ui.common.colon")+d.fireResistance),r.push(v("ui.stats.waterReductionPercent")+v("ui.common.colon")+d.waterResistance),r.push(v("ui.stats.airReductionPercent")+v("ui.common.colon")+d.airResistance),e.subEffectDescription=r,o()}else if(e.requiresGlyphDescription()||e.requiresTrapDescription()||e.requiresBombDescription()){var m=t[0];if(e.requiresBombDescription()){var f=t[0];if(!i||!i.SpellBombs||!i.SpellBombs[f])return n("SpellBombs",f),o();m=i.SpellBombs[f].explodSpellId}if(!i||!i.Spells||!i.Spells[m])return n("Spells",m),o();var g=i.Spells[m].spellLevels[t[1]-1||0];if(!i||!i.SpellLevels||!i.SpellLevels[g])return n("SpellLevels",g),o();var _=i.SpellLevels[g].effects;l(_,function(t,i){if(t)return o(t);for(var n=[],s=0;s<i.length;s++)if(i[s].description){if(i[s].hidden)continue;n.push(i[s].description);var a=i[s].getDurationString();a&&(n[n.length-1]+=" ("+a+")")}e.subEffectDescription=n.length>0&&n,o()})}else e.subEffectDescription=!1,o()},p=function(e,t){u(e,function(i,n){if(i)return t(i);for(var o=0;o<e.length;o++){var s=e[o],a=n[s.effectId];a?s.effect=a:e[o]=null}g(e,null,t)})};var S={EffectInstanceCreature:"ObjectEffectCreature",EffectInstanceDate:"ObjectEffectDate",EffectInstanceDice:"ObjectEffectDice",EffectInstanceDuration:"ObjectEffectDuration",EffectInstanceInteger:"ObjectEffectInteger",EffectInstanceLadder:"ObjectEffectLadder",EffectInstanceMinMax:"ObjectEffectMinMax",EffectInstanceMount:"ObjectEffectMount",EffectInstanceString:"ObjectEffectString"},E={ObjectEffectInteger:{actionId:1,value:1},ObjectEffectString:{actionId:1,value:1},ObjectEffectMinMax:{actionId:1,min:1,max:1},ObjectEffectMount:{actionId:1,mountId:1,date:1,modelId:1},ObjectEffectDuration:{actionId:1,days:1,hours:1,minutes:1},ObjectEffectDice:{actionId:1,diceNum:1,diceSide:1,diceConst:1},ObjectEffectDate:{actionId:1,year:1,month:1,day:1,hour:1,minute:1},ObjectEffectCreature:{actionId:1,monsterFamilyId:1},ObjectEffectLadder:{actionId:1,monsterFamilyId:1,monsterCount:1}};a.prototype.serialize=function(){var e,t=this._type;switch(t){case"EffectInstanceDate":return 669===this.effectId?e=h(this,"EffectInstanceDice"):(e=h(this,t),e.month--),e;case"EffectInstanceString":return e=h(this,t),e.value=this.text,e;case"EffectInstanceDice":return e=h(this,t),e.diceConst=this.value,e;default:return e=h(this,t)}},e.exports={createEffectInstances:l,createEffectInstancesIndexed:c,EffectInstance:a,collectEffectInstanceData:p,category:I,getHumanReadableZoneInfo:o,parseZone:n,EFFECT_SHAPES:T}},function(e,t,i){function n(e,t,i,n){var s=this,a=e&&e.boostedSpellId,r=e&&e.delta;o.call(this,e,t,i,a,null,r,function(e,t){return e?n&&n(e):(s.modifType=0,s.spellId=a,s._delta=r,n&&n(null,t))})}var o=i(351),s=i(353),a=i(357),r=i(172).inherits,l=i(359);r(n,o),e.exports=n,n.prototype.getDelta=function(){return this._delta},n.prototype.apply=function(){if(this.targetId===window.gui.playerData.characters.controlledCharacterId){this.modifType=a(this.actionId),this.actionId===s.ACTION_DEBOOST_SPELL_RANGE&&(this._delta*=-1);for(var e=!1,t=window.gui.playerData.characters.mainCharacter.characteristics.spellModifications,i=0;i<t.length;i++){var n=t[i];this.spellId===n.spellId&&n.modificationType===this.modifType&&(e=!0,n.value.contextModif+=this._delta)}if(!e){var r=new l;r.modificationType=this.modifType,r.spellId=this.spellId,r.value.contextModif=this._delta,t.push(r)}}o.prototype.apply.call(this)},n.prototype.remove=function(){if(!this._removed&&this.targetId===window.gui.playerData.characters.controlledCharacterId)for(var e=window.gui.playerData.characters.mainCharacter.characteristics.spellModifications,t=0;t<e.length;t++){var i=e[t];this.spellId===i.spellId&&i.modificationType===this.modifType&&(e[t].value.contextModif-=this._delta)}o.prototype.remove.call(this)},n.prototype.clone=function(){var e=new n;return this._copyTo(e),e}},function(e,t,i){function n(e){return a[e]}var o=i(353),s=i(358),a={};a[o.ACTION_BOOST_SPELL_RANGEABLE]=s.RANGEABLE,a[o.ACTION_BOOST_SPELL_DMG]=s.DAMAGE,a[o.ACTION_BOOST_SPELL_BASE_DMG]=s.BASE_DAMAGE,a[o.ACTION_BOOST_SPELL_HEAL]=s.HEAL_BONUS,a[o.ACTION_BOOST_SPELL_AP_COST]=s.AP_COST,a[o.ACTION_BOOST_SPELL_CAST_INTVL]=s.CAST_INTERVAL,a[o.ACTION_BOOST_SPELL_CAST_INTVL_SET]=s.CAST_INTERVAL_SET,a[o.ACTION_BOOST_SPELL_CC]=s.CRITICAL_HIT_BONUS,a[o.ACTION_BOOST_SPELL_CASTOUTLINE]=s.CAST_LINE,a[o.ACTION_BOOST_SPELL_NOLINEOFSIGHT]=s.LOS,a[o.ACTION_BOOST_SPELL_MAXPERTURN]=s.MAX_CAST_PER_TURN,a[o.ACTION_BOOST_SPELL_MAXPERTARGET]=s.MAX_CAST_PER_TARGET,a[o.ACTION_BOOST_SPELL_RANGE]=s.RANGE,a[o.ACTION_DEBOOST_SPELL_RANGE]=s.RANGE,e.exports=n},function(e,t){e.exports={INVALID_MODIFICATION:0,RANGEABLE:1,DAMAGE:2,BASE_DAMAGE:3,HEAL_BONUS:4,AP_COST:5,CAST_INTERVAL:6,CAST_INTERVAL_SET:7,CRITICAL_HIT_BONUS:8,CAST_LINE:9,LOS:10,MAX_CAST_PER_TURN:11,MAX_CAST_PER_TARGET:12,RANGE:13}},function(e,t,i){function n(){this._type="CharacterSpellModification",this.modificationType=0,this.spellId=0,this.value=new o}var o=i(360);e.exports=n},function(e,t){function i(){this._type="CharacterBaseCharacteristic",this.base=0,this.objectsAndMountBonus=0,this.alignGiftBonus=0,this.contextModif=0}e.exports=i},function(e,t,i){function n(e,t,i,n){var s=this,r=e&&e.delta;o.call(this,e,t,i,r,null,null,function(e,t){return e?n&&n(e):(s.statName=a.getActionStatName(i),s.isABoost=a.getIsABoost(i),n&&n(null,t))})}var o=i(351),s=i(172).inherits,a=i(353);s(n,o),e.exports=n,n.prototype.getDelta=function(){return"EffectInstanceDice"===this.effect._type?this.isABoost?this.effect.diceNum:-this.effect.diceNum:0},n.prototype.apply=function(){var e=this.getDelta();this.incrementStats(e),o.prototype.apply.call(this)},n.prototype.remove=function(){if(!this._removed&&!this.effect.effect.active){var e=this.getDelta();this.decrementStats(e)}o.prototype.remove.call(this)},n.prototype.disable=function(){if(!this._disabled&&this.effect.effect.active){var e=this.getDelta();this.decrementStats(e)}o.prototype.disable.call(this)},n.prototype.incrementStats=function(e){var t=window.gui,i=t.fightManager.getFighter(this.targetId);if(!i)return void console.error("Trying to apply a stats buff on non-existing fighter "+this.targetId);var n=i.data.stats;switch(this.statName){case"vitality":n.lifePoints+=e,n.maxLifePoints+=e;break;case"lifePointsMalus":n.lifePoints=Math.min(n.lifePoints+e,n.maxLifePoints);break;case"lifePoints":case"shieldPoints":case"dodgePALostProbability":case"dodgePMLostProbability":n[this.statName]=Math.max(n[this.statName]+e,0);break;case"agility":n.tackleEvade+=~~(e/10),n.tackleBlock+=~~(e/10);break;case"globalResistPercentMalus":case"globalResistPercentBonus":var o="globalResistPercentBonus"===this.statName?1:-1;n.neutralElementResistPercent+=e*o,n.airElementResistPercent+=e*o,n.waterElementResistPercent+=e*o,n.earthElementResistPercent+=e*o,n.fireElementResistPercent+=e*o;break;case"actionPoints":n.actionPoints+=e,n.maxActionPoints+=e;break;case"movementPoints":n.movementPoints+=e,n.maxMovementPoints+=e;break;default:n.hasOwnProperty(this.statName)&&(n[this.statName]+=e)}var s=t.playerData.characters;if(s.mainCharacterId===this.targetId||s.controlledCharacterId===this.targetId){var a;if(a=s.mainCharacterId===this.targetId?s.mainCharacter:s.getControlledCharacter(),a.timeStatsSynchronized-this.timeCreationStarted>0)return void("summonableCreaturesBoost"===this.statName?t.fightManager.emit("updateSpellsAvailability"):"range"===this.statName&&window.foreground.refreshSpellRange());var r=a.characteristics;switch(r.hasOwnProperty(this.statName)&&(r[this.statName].contextModif+=e),this.statName){case"vitality":a.setCharacteristic("maxLifePoints",Math.max(0,r.maxLifePoints+e)),a.setCharacteristic("lifePoints",Math.max(0,r.lifePoints+e));break;case"lifePoints":case"lifePointsMalus":a.setCharacteristic("lifePoints",Math.max(0,r.lifePoints+e));break;case"movementPoints":a.setCharacteristic("movementPointsCurrent",r.movementPointsCurrent+e);break;case"actionPoints":a.setCharacteristic("actionPointsCurrent",r.actionPointsCurrent+e);break;case"summonableCreaturesBoost":t.fightManager.emit("updateSpellsAvailability");break;case"range":window.foreground.refreshSpellRange()}}},n.prototype.decrementStats=function(e){this.incrementStats(-e)},n.prototype.clone=function(){var e=new n;return this._copyTo(e),e}},function(e,t,i){function n(e,t,i,n){var s=this,r=e&&e.stateId;o.call(this,e,t,i,r,null,null,function(e,t){return e?n&&n(e):(s.statName=a.getActionStatName(i),s.stateId=r,n&&n(null,t))})}var o=i(351),s=i(172).inherits,a=i(353),r=i(363),l=i(348);s(n,o),e.exports=n,n.prototype.apply=function(){var e=window.gui.fightManager.getFighter(this.targetId);return e?(e.addState(this.stateId),window.gui.shortcutBar.updateSpellsAvailability(),void o.prototype.apply.call(this)):console.error("Applying state buff failed, fighter does not exist.")},n.prototype.remove=function(){if(!this._removed){var e=window.gui.fightManager.getFighter(this.targetId);if(!e)return console.error("Removing state buff failed, fighter does not exist.");e.removeState(this.stateId),window.gui.shortcutBar.updateSpellsAvailability();var t=this.targetId;window.gui.fightManager.deadTurnsList.indexOf(t)===-1&&(952===this.actionId?r.send(l.FIGHTER_ENTERING_STATE,[t,this.stateId],t,-1):r.send(l.FIGHTER_LEAVING_STATE,[t,this.stateId],t,-1));
}o.prototype.remove.call(this)},n.prototype.clone=function(){var e=new n;return this._copyTo(e),e}},function(e,t,i){function n(e,t,i,n,o,s){return void 0===o&&(o=0),void 0===s&&(s=1),{name:e,targetId:i,params:t,checkParams:o,castingSpellId:n,order:M.length,firstParamToCheck:s}}function o(e,t){var i,n=window.gui.databases.TypeActions[t],o=n?n.elementId:-1;switch(e="-"+e,o){case-1:i="multi";break;case 0:i="neutral";break;case 1:i="earth";break;case 2:i="fire";break;case 3:i="water";break;case 4:i="air"}return i?"{style:"+i+"Damage,"+e+"}":e}function s(e,t){if(e.name===h.FIGHT_END)return t(null,_("ui.fight.fightEnd"));var i,n,s=window.gui.fightManager,a=e.params,r=s.getFighter(a[0]);if(!r)return t(new Error("Fighter does not exist."));var l;if(e.name===h.FIGHTER_DEATH)i=v(_("ui.fight.isDead"),0,r.name);else{if(e.name===h.FIGHTER_TRIGGERED_GLYPH)return l=s.getFighter(a[1]),l?s.getFighterSpell(a[2],a[1],function(e,n){return e?t(e):(i=_("ui.fight.startTrap",r.name,n.getName(),l.name),t(null,i))}):t(new Error("Second fighter does not exist."));if(e.name===h.FIGHTER_ENTERING_STATE){var c=a[2]?"</b> ("+a[2]+")<b>":"";n=window.gui.databases.SpellStates[a[1]],i=_("ui.fight.enterState",r.name,n.nameId+c)}else if(e.name===h.FIGHTER_LEAVING_STATE)n=window.gui.databases.SpellStates[a[1]],i=_("ui.fight.exitState",r.name,n.nameId);else{if(e.name===h.FIGHTER_SPELL_DISPELLED)return s.getFighterSpell(a[1],a[0],function(e,n){return e?t(e):(i=_("ui.fight.dispellSpell",r.name,n.getName()),t(null,i))});if(e.name===h.FIGHTER_CASTED_SPELL)return s.getFighterSpell(a[1],a[0],function(e,n){return e?t(e):(i=_("ui.fight.launchSpell",r.name,n.getName()),a[2]===m.CRITICAL_HIT?i+=" "+_("ui.fight.criticalHit"):a[2]===m.CRITICAL_FAIL&&(i+=" "+_("ui.fight.criticalMiss")),t(null,i))});if(e.name===h.FIGHTER_CLOSE_COMBAT)return f.getData("Items",[a[1]],function(e,n){return e?t(e):(i=_("ui.fight.closeCombat",r.name,n[0].nameId),a[2]===m.CRITICAL_HIT?i+=" "+_("ui.fight.criticalHit"):a[2]===m.CRITICAL_FAIL&&(i+=" "+_("ui.fight.criticalMiss")),t(null,i))});if(e.name===h.FIGHTER_LIFE_LOSS_AND_DEATH)i=_("ui.fight.lifeLossAndDeath",r.name,o(a[1],a[2]));else if(e.name===h.FIGHTER_LIFE_LOSS)i=_("ui.fight.lifeLoss",r.name,o(a[1],a[2]));else if(e.name===h.FIGHTER_SHIELD_LOSS)i=_("ui.fight.lostShieldPoints",r.name,o(a[1],a[2]));else if(e.name===h.FIGHTER_REDUCED_DAMAGES)i=_("ui.fight.reduceDamages",r.name,a[1]);else if(e.name===h.FIGHTER_LIFE_GAIN)i=_("ui.fight.lifeGain",r.name,a[1]);else if(e.name===h.FIGHTER_AP_LOST)i=_("ui.fight.lostAP",r.name,a[1]);else if(e.name===h.FIGHTER_AP_GAINED)i=_("ui.fight.winAP",r.name,a[1]);else if(e.name===h.FIGHTER_AP_LOSS_DODGED)i=_("ui.fight.dodgeAP",r.name,a[1]);else if(e.name===h.FIGHTER_MP_LOST)i=_("ui.fight.lostMP",r.name,a[1]);else if(e.name===h.FIGHTER_MP_GAINED)i=_("ui.fight.winMP",r.name,a[1]);else if(e.name===h.FIGHTER_MP_LOSS_DODGED)i=_("ui.fight.dodgeMP",r.name,a[1]);else if(e.name===h.FIGHTER_TEMPORARY_BOOSTED){var d=~~a[2];i=_("ui.fight.effect",r.name,d?a[1]+" ("+a[3]+")":a[1])}else if(e.name===h.FIGHTER_EFFECTS_MODIFY_DURATION)i=_("ui.fight.effectsModifyDuration",r.name,a[2]);else if(e.name===h.FIGHTER_SPELL_IMMUNITY)i=_("ui.fight.noChange",r.name);else if(e.name===h.FIGHTER_NO_CHANGE)i=_("ui.fight.noChange",r.name);else if(e.name===h.FIGHTER_LEAVE)i=_("ui.fight.leave",r.name);else if(e.name===h.FIGHTER_GOT_DISPELLED)i=_("ui.fight.dispell",r.name);else if(e.name===h.FIGHTER_REFLECTED_SPELL)i=_("ui.fight.reflectSpell",r.name);else if(e.name===h.FIGHTER_REFLECTED_DAMAGES)i=_("ui.fight.reflectDamages",r.name);else if(e.name===h.FIGHTER_GOT_TACKLED)i=_("ui.fight.dodgeFailed");else if(e.name===h.FIGHTER_VISIBILITY_CHANGED){var u=a[1]===p.INVISIBLE;i=u?_("ui.fight.invisibility",r.name):_("ui.fight.visibility",r.name)}else if(e.name===h.FIGHTER_GOT_KILLED){if(l=s.getFighter(a[1]),!l)return t(new Error("Second fighter does not exist."));if(a[0]===a[1])return t();i=_("ui.fight.killed",r.name,l.name)}}}return t(null,i)}function a(e,t){if(t||(t=I),window.gui.fightManager.emit(e.name,e.params),e.name===h.FIGHTER_LIFE_LOSS&&w[e.params[0]])e.name=h.FIGHTER_LIFE_LOSS_AND_DEATH;else if(e.name===h.FIGHTER_DEATH&&T[e.params[0]])return t();s(e,function(e,i){return e?t(e):i?(window.gui.chat.logMsg(i,b.PSEUDO_CHANNEL_FIGHT_LOG),t()):t()})}function r(e,t,i,o,s,r){var l=n(e,t,i,o,s,r);a(l)}function l(e,t,i,o,s,a){var r=n(e,t,i,o,s,a);r.name===h.FIGHTER_LIFE_LOSS?T[r.params[0]]=!0:r.name===h.FIGHTER_DEATH&&(w[r.params[0]]=!0),M.push(r)}function c(){M=[],w={},T={},C=!1,A=[]}function d(e,t){C=!0,t||(t=I),y.eachSeries(e,function(e,t){a(e,t)},function(e){if(C=!1,w={},T={},e)return t(e);if(t(),A.length){var i=A.shift();return d(i[0],i[1])}})}function u(e){var t=M;return M=[],C?A.push([t,e]):void d(t,e)}var h=i(348),p=i(364),m=i(365),f=i(30),g=i(29),_=g.getText,v=g.processTextWithModifier,y=i(31),b=i(366),M=[],w={},T={},C=!1,A=[],I=function(e){if(e)return console.error(e)};t.send=r,t.push=l,t.reset=c,t.flush=u},function(e,t){e.exports={INVISIBLE:1,DETECTED:2,VISIBLE:3}},function(e,t){e.exports={NORMAL:1,CRITICAL_HIT:2,CRITICAL_FAIL:3}},function(e,t){e.exports={CHANNEL_GLOBAL:0,CHANNEL_TEAM:1,CHANNEL_GUILD:2,CHANNEL_ALLIANCE:3,CHANNEL_PARTY:4,CHANNEL_SALES:5,CHANNEL_SEEK:6,CHANNEL_NOOB:7,CHANNEL_ADMIN:8,CHANNEL_ADS:12,CHANNEL_ARENA:13,PSEUDO_CHANNEL_PRIVATE:9,PSEUDO_CHANNEL_INFO:10,PSEUDO_CHANNEL_FIGHT_LOG:11}},function(e,t,i){function n(e,t,i,n){var s=this,a=e&&e.param1,r=e&&e.param2,l=e&&e.param3;o.call(this,e,t,i,a,r,l,function(t,i){return t?n&&n(t):(s.delay=e.delay,s.effect.delay=e.delay,n&&n(null,i))})}var o=i(351),s=i(172).inherits;s(n,o),e.exports=n,n.prototype.isActive=function(){return this.delay>0||o.prototype.isActive.call(this)},n.prototype.isTrigger=function(){return!0},n.prototype.incrementDuration=function(e,t){return this.delay>0&&!t&&(this.delay+e>=0?(this.delay--,this.effect.delay--):(e+=this.delay,this.delay=0,this.effect.delay=0)),0===e||o.prototype.incrementDuration.call(this,e,t)},n.prototype.isUnusableNextTurn=function(){return this.delay<=1&&o.prototype.isUnusableNextTurn.call(this)},n.prototype.clone=function(){var e=new n;return this._copyTo(e),e}},function(e,t,i){function n(e,t){this.data=new d,this.id=e,this.name=null,this.level=null,this.isBomb=!1,this.isCreature=!1,this.canTackle=!0,this.buffs=[],this._finishingBuffs=[],this.states=[],this.spells={},t||(this.picto=this.createPicto(e),this.isShieldBarVisible=!1,window.gui.timeline.linkToTimeline(this))}var o=i(321),s=i(369),a=i(410),r=i(171),l=i(343),c=i(350),d=i(411),u=i(29).getText,h=40,p=30,m=7,f=50,g=0;e.exports=n,n.prototype.clear=function(){this.picto&&this.picto.destroy()},n.prototype.createPicto=function(e){var t=new o("div",{name:e,className:"fighter"});return t.fighterTimeBar=t.createChild("div",{className:"fighterTimeBar"}),t.fighterTimeValue=t.fighterTimeBar.createChild("div",{className:"fighterTimeValue"}),t.fighterIllus=t.appendChild(new s({className:"fighterIllus",scale:"fitin"})),t.fighterHPBar=t.createChild("div",{className:"fighterHPBar"}),t.fighterHPValue=t.fighterHPBar.createChild("div",{className:"fighterHPValue"}),t.fighterShieldBar=t.createChild("div",{className:"fighterShieldBar",hidden:!0}),t.fighterShieldValue=t.fighterShieldBar.createChild("div",{className:"fighterShieldValue"}),t.fighterNumber=t.createChild("div",{className:"fighterNumber"}),t.fighterNumber.toggleDisplay(!!r.orderFighters),t},n.prototype.createStatsTooltipContent=function(){var e,t=new o("table",{className:"statsDetails",name:"statsDetails"});return e=t.createChild("tr"),t.fighterName=e.createChild("td",{className:"fighterName",attr:{colspan:3}}),t.level=e.createChild("td",{className:"fighterLevel",attr:{colspan:2}}),e=t.createChild("tr"),t.lifePoints=e.createChild("td",{className:["label","iconLifePoints"],attr:{colspan:2}}),t.shieldPoints=e.createChild("td",{className:["label","iconShieldPoints"]}),t.fighterUsedAP=e.createChild("td",{className:["label","iconActionPoints"]}),t.movementPoints=e.createChild("td",{className:["label","iconMovementPoints"]}),e=t.createChild("tr"),t.dodgePALostProbability=e.createChild("td",{className:["label","iconActionPoints"]}),t.dodgePMLostProbability=e.createChild("td",{className:["label","iconMovementPoints"]}),t.tackleBlock=e.createChild("td",{className:["label","iconTackle"]}),t.criticalDamageReduction=e.createChild("td",{className:["label","iconCriticalDamage"]}),t.pushDamageReduction=e.createChild("td",{className:["label","iconPushDamageReduction"]}),e=t.createChild("tr"),t.neutral=e.createChild("td",{className:["label","iconYinyang"]}),t.strength=e.createChild("td",{className:["label","iconStrength"]}),t.intelligence=e.createChild("td",{className:["label","iconIntelligence"]}),t.chance=e.createChild("td",{className:["label","iconChance"]}),t.agility=e.createChild("td",{className:["label","iconAgility"]}),e=t.createChild("tr"),t.neutralPercent=e.createChild("td",{className:["label","iconYinyang"]}),t.strengthPercent=e.createChild("td",{className:["label","iconStrength"]}),t.intelligencePercent=e.createChild("td",{className:["label","iconIntelligence"]}),t.chancePercent=e.createChild("td",{className:["label","iconChance"]}),t.agilityPercent=e.createChild("td",{className:["label","iconAgility"]}),this.refreshStatsTooltipContent(t),t},n.prototype.refreshStatsTooltipContent=function(e){var t=this.data.stats;e.fighterName.setText(this.name),e.level.setText(u("ui.common.short.level")+" "+this.level),e.lifePoints.setText(t.lifePoints+" / "+t.maxLifePoints),e.shieldPoints.setText(t.shieldPoints),e.fighterUsedAP.setText(t.actionPoints),e.movementPoints.setText(t.movementPoints),e.dodgePALostProbability.setText(t.dodgePALostProbability),e.dodgePMLostProbability.setText(t.dodgePMLostProbability),e.tackleBlock.setText(Math.max(g,t.tackleBlock)),e.criticalDamageReduction.setText(t.criticalDamageFixedResist),e.pushDamageReduction.setText(t.pushDamageFixedResist),e.neutral.setText(t.neutralElementReduction),e.strength.setText(t.earthElementReduction),e.intelligence.setText(t.fireElementReduction),e.chance.setText(t.waterElementReduction),e.agility.setText(t.airElementReduction),"GameFightCharacterInformations"===this.data._type?(e.neutralPercent.setText(Math.min(f,t.neutralElementResistPercent)+"%"),e.strengthPercent.setText(Math.min(f,t.earthElementResistPercent)+"%"),e.intelligencePercent.setText(Math.min(f,t.fireElementResistPercent)+"%"),e.chancePercent.setText(Math.min(f,t.waterElementResistPercent)+"%"),e.agilityPercent.setText(Math.min(f,t.airElementResistPercent)+"%")):(e.neutralPercent.setText(t.neutralElementResistPercent+"%"),e.strengthPercent.setText(t.earthElementResistPercent+"%"),e.intelligencePercent.setText(t.fireElementResistPercent+"%"),e.chancePercent.setText(t.waterElementResistPercent+"%"),e.agilityPercent.setText(t.airElementResistPercent+"%"))},n.prototype.getFinishingBuffs=function(){var e=this._finishingBuffs;return this._finishingBuffs=[],e},n.prototype.synchronizeData=function(e){this.applyFinishingBuffs(e),this.setAlive(e.alive),this.data.updateData(e),this.setHP(e.stats.lifePoints),this.setShield(e.stats.shieldPoints)},n.prototype.applyFinishingBuffs=function(e){var t=this.getFinishingBuffs();if(0!==t.length)for(var i=0;i<t.length;i++)for(var n=t[i],o=n.statName,s=0;s<this.buffs.length;s++){var a=this.buffs[s];a.id===n.id&&o&&e.stats.hasOwnProperty(o)&&a.effect.effect.active&&("actionPoints"===o&&(e.stats.maxActionPoints=e.stats.maxActionPoints-n.getDelta()),e.stats[o]=e.stats[o]-n.getDelta())}},n.prototype.getAvailableWidth=function(){var e=this.isSummon()?p:h;return this.isShieldBarVisible?e-m:e},n.prototype.isSummon=function(){return this.data.stats.summoned},n.prototype.resizeFighterIllustration=function(){if(this.picto){var e=this.getAvailableWidth();this.picto.fighterTimeBar.setStyles({width:e+"px"}),this.picto.fighterIllus.setStyles({width:e+"px"}),this.picto.fighterIllus.resize()}},n.prototype.setData=function(e){this.data.updateData(e);var t=e.alive;this.data.alive=null,this.setAlive(t),this.setHP(this.data.stats.lifePoints),this.setShield(this.data.stats.shieldPoints),this.setNameAndLevel(e),this.picto&&(e.teamId===l.TEAM_CHALLENGER&&this.picto.addClassNames("challenger"),e.stats.summoned&&this.picto.addClassNames("summoned"),this.data.look&&this.updateFighterIllustration(),this.resizeFighterIllustration())},n.prototype.setAlive=function(e,t){(this.data.alive!==e||t)&&(this.data.alive=e,e||(this.setHP(0),this.setShield(0)),this.picto&&(this.picto.toggleClassName("dead",!e),t&&this.picto.toggleDisplay(e||!r.hideDeadFighters)))},n.prototype.setHP=function(e){if(this.data.stats){e=Math.max(0,e);var t=this.data.stats;t.lifePoints=e;var i=this.id===window.gui.playerData.characters.controlledCharacterId;if(i){var n=window.gui.playerData.characters.getControlledCharacter();n.setCharacteristic("lifePoints",t.lifePoints),n.setCharacteristic("maxLifePoints",t.maxLifePoints)}this.picto&&this.picto.fighterHPValue.setStyle("height",Math.min(e/t.maxLifePoints*100,100)+"%")}},n.prototype.setShield=function(e){if(this.data.stats){e=Math.max(0,e);var t=this.data.stats;if(t.shieldPoints=e,this.picto){var i=0!==t.shieldPoints;i&&this.picto.fighterShieldValue.setStyle("height",e/t.maxLifePoints*100+"%"),this.isShieldBarVisible!==i&&(this.isShieldBarVisible=i,this.picto.fighterShieldBar.toggleDisplay(i),this.resizeFighterIllustration())}window.gui.fightManager.emit("shieldPointsUpdated",this.id,e)}},n.prototype.setNameAndLevel=function(e){switch(e._type){case"GameFightCharacterInformations":this.name=e.name,this.level=e.level;break;case"GameFightMutantInformations":this.name=e.name,this.level=e.powerLevel;break;case"GameFightMonsterInformations":case"GameFightMonsterWithAlignmentInformations":this.name=e._name,this.level=e._level,this.isBomb=e._isBomb,this.isCreature=e._isCreature,this.canTackle=e._canTackle;break;case"GameFightTaxCollectorInformations":this.name=e._name,this.level=e.level;break;default:console.warn('Retrieving details of fighter type "'+e._type+'" not supported')}},n.prototype.updateFighterIllustration=function(){this.picto&&this.picto.fighterIllus.setLook(this.data.look,{riderOnly:!0,direction:a.DIRECTION_SOUTH_EAST,animation:"AnimArtwork",boneType:"timeline/",skinType:"timeline/",showSubentities:!1})},n.prototype.refreshHP=function(){this.data.alive&&this.setHP(this.data.stats.lifePoints)},n.prototype.refreshShield=function(){this.setShield(this.data.stats.shieldPoints)},n.prototype.updateNumber=function(e){if(this.picto){var t=e||"";this.picto.fighterNumber.setText(t),r.orderFighters&&window.actorManager.turnNumberOn(this.id,t)}},n.prototype.addBuff=function(e,t){t=void 0===t||t;for(var i,n=0,o=this.buffs.length;n<o;n++)if(e.equals(this.buffs[n])){i=this.buffs[n];break}if(i){var s=i.castingSpell.spellRank&&i.castingSpell.spellRank.maxStack>0,a=s&&i.stack&&i.stack.length===i.castingSpell.spellRank.maxStack;if(a)return;i.add(e)}else this.buffs.push(e);t&&e.apply(),i?window.gui.fightManager.emit("BuffUpdate",i,this):window.gui.fightManager.emit("BuffAdd",e,this)},n.prototype.updateBuff=function(e){var t=this.getBuffIndex(e.id);if(t===-1)return!1;var i=this.buffs[t];return i.remove(),i.updateParam(e.getParam1(),e.getParam2(),e.getParam3(),e.id),i.apply(),window.gui.fightManager.emit("BuffUpdate",i,this),!0},n.prototype.getBuff=function(e){for(var t=0;t<this.buffs.length;t++){var i=this.buffs[t];if(e===i.id)return i}return null},n.prototype.getBuffIndex=function(e){for(var t=0;t<this.buffs.length;t++){var i=this.buffs[t];if(e===i.id)return t;if(i.stack)for(var n=0;n<i.stack.length;n++)if(e===i.stack[n].id)return t}return-1},n.prototype.addState=function(e){this.states.push(e)},n.prototype.removeState=function(e){this.states.indexOf(e)!==-1&&this.states.splice(this.states.indexOf(e),1)},n.prototype.hasState=function(e){return this.states.indexOf(e)!==-1},n.prototype.dispel=function(e,t,i){for(var n=[],o=0;o<this.buffs.length;o++){var s=this.buffs[o];s.canBeDispell(e,Number.MIN_VALUE,i)?(window.gui.fightManager.emit("BuffRemove",s,this),s.remove()):n.push(s)}this.buffs=n},n.prototype.dispelSpell=function(e,t,i,n){var o,s=[],a=[];for(o=0;o<this.buffs.length;o++){var r=this.buffs[o];e===r.castingSpell.spell.id&&r.canBeDispell(t,Number.MIN_VALUE,n)?(r.remove(),s.push(r)):a.push(r)}for(this.buffs=a,o=0;o<s.length;o++)window.gui.fightManager.emit("BuffRemove",s[o],this)},n.prototype.dispelUniqueBuff=function(e,t,i,n){var o=this.getBuffIndex(e);if(o===-1)return console.warn("Buff id",e,"does not exist");var s=this.buffs[o],a=window.gui.fightManager;if(s.canBeDispell(t,n?e:Number.MIN_VALUE,i))if(!i&&s.stack&&s.stack.length>1){switch(s.remove(),s.actionId){case 293:s.setParam1(s.stack[0].getParam1()),s.setParam2(s.getParam2()-s.stack[0].getParam2()),s.setParam3(s.getParam3()-s.stack[0].getParam3());break;case 788:s.setParam1(s.getParam1()-s.stack[0].getParam2());break;case 950:case 951:break;default:s.setParam1(s.getParam1()-s.stack[0].getParam1()),s.setParam2(s.getParam2()-s.stack[0].getParam2()),s.setParam3(s.getParam3()-s.stack[0].getParam3())}s.stack.shift(),s.refreshDescription(),s.apply(),a.emit("BuffUpdate",s,this)}else this.buffs.splice(o,1),s.remove(),a.emit("BuffRemove",s,this),a.emit("BuffRemove",s,this)},n.prototype.markFinishingBuffs=function(){var e=window.gui.fightManager;for(var t in this.buffs){var i=this.buffs[t];if(1===i.duration){for(var n=!1,o=0,s=!1,a=0;a<e.turnsList.length;a++){var r=e.turnsList[a];r===i.aliveSource&&(s=!0),r===e.currentFighterId&&(o=1),1===o&&(s&&r!==e.currentFighterId?(o=2,n=!0):r===this.id&&r!==e.currentFighterId&&(o=2,n=!1))}if(n){if(i instanceof c.StatBuff&&this.id!==window.gui.playerData.characters.mainCharacterId&&i.statName){var l=e.getFighter(i.targetId);if(!l)return console.error("Mark finishing buffs failed, fighter does not exist");l._finishingBuffs.push(i)}i.disable()}}}},n.prototype.enableBuffs=function(){for(var e in this.buffs)this.buffs[e].enable()}},function(e,t,i){function n(){return null}function o(){return p=document.createElement("canvas"),p.id="characterDisplayCanvas",p.width=g,p.height=_,m=new u(p,g,_,d.MAX_SPRITES_BUFFER_CHARACTER_DISPLAY,d.MAX_TEXTURE_MEMORY_CHARACTER_DISPLAY,d.PRERENDER_RATIO_CHARACTER_DISPLAY,(!0)),f={renderer:m,updateList:{push:n},displayList:{add:n,removeByRef:n}}}function s(e){r.call(this,"div",e),this.addClassNames("CharacterDisplay"),e=e||{},this.canvas=this.appendChild(new l),this.ctx=this.canvas.getContext("2d"),this.entity=null,this.scale=void 0!==e.scale?e.scale:1,this._scale=1/0,this.only4Directions=!1,"fitin"===this.scale?(this.horizontalAlign=e.horizontalAlign||"left",this.verticalAlign=e.verticalAlign||"bottom"):(this.horizontalAlign=e.horizontalAlign||"none",this.verticalAlign=e.verticalAlign||"none"),this.canvasInitialized=!1,this.renderingRequired=!1;var t=this;window.setTimeout(function(){t.rootElement&&(t.canvasInitialized=!0,t.resize())},0)}i(370);var a=i(172).inherits,r=i(321),l=i(371),c=i(373),d=i(167),u=i(398),h=i(392).Delay,p=null,m=null,f=null,g=Math.ceil(512*d.PIXEL_RATIO),_=Math.ceil(512*d.PIXEL_RATIO),v=2.5;a(s,r),e.exports=s,s.prototype.setLook=function(e,t,i){var n=this;if(t=t||{},null===this.entity){this.entity=new c({scene:f||o()});var s=t.showSubentities;this.entity.showSubentities=null===s||void 0===s||s}var a=void 0!==t.direction?t.direction:1;t.keepDirection||(this.entity.direction=a),t.riderOnly&&(e=c.getLookWithoutMount(e));var r=!1,l=!1,d=new h(30,function(){l||n.rootElement&&(n.addClassNames("spinner"),r=!0)});d.start(!1),this.entity.setLook(e,t,function(){return l=!0,r&&n.rootElement&&n.delClassNames("spinner"),null!==n.entity&&n.rootElement?(1===e.bonesId&&e.skins[0]&&n.entity.animManager.addAnimationModifier("AnimStatique","AnimStatique"+e.skins[0]),n.only4Directions=n.entity.animManager.only4Directions,t.animation&&(n.entity.animSymbol.base=t.animation),n._scale=1/0,n._render(),i&&i()):i&&i()})},s.prototype.release=function(){m&&(null!==this.entity&&(this.entity.remove(),this.entity=null),this._scale=1/0,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height))},s.prototype.clear=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},s.prototype.rotateCharacter=function(e){if(this.canvasInitialized){var t=this.entity.direction;return this.only4Directions?(0===(1&t)&&(t+=1),t+=e?2:-2,t>7&&(t=1),t<0&&(t=7)):(t+=e?1:-1,t>7&&(t=0),t<0&&(t=7)),this.entity.direction=t,this._render(),t}},s.prototype.resize=function(){var e=this.canvas,t=parseInt(this.getComputedStyle("width"),10),i=parseInt(this.getComputedStyle("height"),10),n=e.width,o=e.height;e.width=t*d.PIXEL_RATIO,e.height=i*d.PIXEL_RATIO,e.style.width=t+"px",e.style.height=i+"px",0!==e.width&&0!==e.height&&(this.renderingRequired||e.width!==n||e.height!==o)&&this._render()},s.prototype.setScale=function(e){e!==this.scale&&(this.scale=e,this._render())},s.prototype._computeScale=function(e,t,i,n,o,s){var a;if("cover"===e)a=this._scale=Math.min(this._scale,n/Math.abs(s[0]),n/Math.abs(s[1]),o/Math.abs(s[2]),o/Math.abs(s[3]));else if("width"===e)a=this._scale=Math.min(this._scale,t/(s[1]-s[0]));else if("height"===e)a=this._scale=Math.min(this._scale,i/(s[2]-s[3]));else if("fitin"===e)a=this._scale=Math.min(this._scale,t/(s[1]-s[0]),i/(s[2]-s[3])),a=Math.min(a,v);else if("%"===e[e.length-1]){var r=parseFloat(e);isNaN(r)?r=this._scale:r*=.01;var l=t/(s[1]-s[0]),c=i/(s[2]-s[3]),d=l>c?c:l;a=this._scale=r*d,a=Math.min(a,v)}return a||this._scale},s.prototype._render=function(){if(!this.canvasInitialized)return void(this.renderingRequired=!0);if(m&&this.entity){var e=this.canvas,t=e.width,i=e.height,n=m.gl,o=this.entity,s=this.scale;if(0===t||0===i){var a=this;return void window.setTimeout(function(){if(a.resize(),0===e.width||0===e.height)return console.warn("[CharacterDisplay._render] Character display size must be greater than zero.")},0)}m.clear(),o.x=0,o.y=0,o.scaleX=d.PIXEL_RATIO,o.scaleY=-d.PIXEL_RATIO,o.updateAnimation(),o.refreshAnimation();var r=o.bbox;if(r[1]<r[0]||r[2]<r[3]){var l=o.animManager.template.id,c=o.animSymbol.base;return void console.error(new Error("Entity animation frame is empty, template:"+l+", animation:"+c))}var u=.5*t,h=.85*i;"string"==typeof s&&(s=this._computeScale(s,t,i,u,h,r)),o.scaleX*=s,o.scaleY*=s;var p=Math.floor(r[0]*s),f=Math.ceil(r[1]*s),g=-Math.floor(r[2]*s),v=-Math.ceil(r[3]*s),y=f-p,b=v-g;if(0===y||0===b)return console.warn("[CharacterDisplay._render] Character to render is of size 0.");o.x=-p,o.y=v,o.render(),o.animManager.releaseBuffer();var M=new Uint8Array(y*b*4);n.readPixels(0,_-b,y,b,n.RGBA,n.UNSIGNED_BYTE,M);for(var w=this.ctx.createImageData(y,b),T=w.data,C=0;C<M.length;C++)T[C]=M[C];var A,I;switch(this.horizontalAlign){case"left":A=0;break;case"center":A=(t-y)/2;break;case"right":A=t-y;break;default:A=u+p}switch(this.verticalAlign){case"top":I=0;break;case"center":I=(i-b)/2;break;case"bottom":I=i-b;break;default:I=h+g}this.ctx.clearRect(0,0,t,i),this.ctx.putImageData(w,A,I)}}},function(e,t){},function(e,t,i){function n(e){s.call(this,"canvas",e),this.addClassNames("Canvas"),this.style=this.rootElement.style}i(372);var o=i(172).inherits,s=i(321);o(n,s),e.exports=n,n.prototype.getContext=function(e){return e=e||"2d",this.rootElement.getContext(e)},Object.defineProperty(n.prototype,"width",{get:function(){return this.rootElement.width},set:function(e){this.rootElement.width=e}}),Object.defineProperty(n.prototype,"height",{get:function(){return this.rootElement.height},set:function(e){this.rootElement.height=e}})},function(e,t){},function(e,t,i){function n(e,t){s.call(this,e,t),this.direction=void 0!==e.direction?e.direction:1,this.animSymbol={base:"AnimStatique",type:null,direction:this.direction},this.look=null,this.showSubentities=!0}var o=i(172).inherits,s=i(374),a=i(378),r=i(379),l=i(380),c=i(394),d=i(397);o(n,s),e.exports=n,n.prototype.updateAnimation=function(){this.animSymbol.direction=this.direction,this.animManager.assignSymbol(this.animSymbol,!1)},n.prototype.addSubentity=function(e,t,i){if(this.showSubentities){var n=e.subEntityLook;if(!n)return void console.error(new Error("Subentity has no look: "+Object.keys(e).join(";")));var o=n.bonesId+"/motion",s=n.skins,r=n.scales[0],d=a.parseIndexedColors(n.indexedColors),u=this;t.addToSprite=!1,l.loadCharacterAnimationManager(this,o,s,d,r,t,function(t){return u.animManager.addSubentity({animManager:t,bindingPoint:"carried_"+e.bindingPointCategory+"_"+e.bindingPointIndex,symbolModifier:c[e.bindingPointCategory],bindingPointCategory:e.bindingPointCategory}),i&&i(t)})}},n.prototype.addSubentities=function(e,t,i){function n(){if(s+=1,s===o)return i&&i()}if(!e)return i&&i();for(var o=e.length+1,s=0,a=0;a<e.length;a+=1)this.addSubentity(e[a],t,n);n()},n.prototype.setLook=function(e,t,i){function n(){return m.clear(!0),i&&i()}for(var o=this.look,s=e.scales[0],c=e.skins,d=o&&this.look.bonesId===e.bonesId&&this.look.skins.length===c.length&&this.look.scales[0]===s,u=0;d&&u<c.length;u+=1)d=d&&c[u]===this.look.skins[u];this.look=e;var h=a.parseIndexedColors(e.indexedColors);if(d)return this.animManager.setTints(h),this.animManager.cleanupAnimationsAndRemoveSubentities(),void this.addSubentities(e.subentities,t,i);if(o&&this.isDisplayed){var p=new r({x:this.x,y:this.y,position:this.position+1,scene:this.scene});l.loadAnimationManager(p,"bone","1165/FX",function(e){e.assignSymbol({base:"FX",direction:0},!1,function(){p.remove()})})}var m=this.animManager;l.loadLook(this,e,t,n)};var u=d.HOOK_POINT_CATEGORY_MOUNT_DRIVER,h={};h[2]=1,h[1084]=44,h[1068]=113,h[1202]=453,h[1575]=1,h[1576]=1,h[2456]=1107,n.getLookWithoutMount=function(e){var t=n.getLookOfRider(e);return t?{_type:"EntityLook",bonesId:h[t.bonesId]||t.bonesId,indexedColors:t.indexedColors,scales:t.scales,skins:t.skins,subentities:t.subentities}:e},n.getLookOfRider=function(e){var t=e.subentities;if(!t)return null;for(var i=0;i<t.length;i++){var n=t[i];if(n.bindingPointCategory===u&&0===n.bindingPointIndex)return n.subEntityLook}return null}},function(e,t,i){function n(e,t){s.call(this,e),this.animManager=t||new a(this)}var o=i(172).inherits,s=i(375),a=i(377);o(n,s),e.exports=n,n.prototype.setAnimManager=function(e){this.animManager.switchAnimationManager(e),this.animManager=e},n.prototype.render=function(){this.renderer.save(),this.renderer.multiplyColor(this.tint[0],this.tint[1],this.tint[2],this.tint[3]),this.renderer.translate(this._x,this._y),0!==this._rotation&&this.renderer.rotate(this._rotation),this.renderer.scale(this._scaleX,this._scaleY),this.animManager.draw(this.renderer),this.renderer.restore()},n.prototype.remove=function(){return this.hide(),this.isWhiteListed===!0?this.animManager.stop():void(this._cleared!==!0&&(this._cleared=!0,this.animManager.clear()))},n.prototype.refreshAnimation=function(e){if(this.isOutdated=!1,this.isDisplayed===!1)return void 0!==e&&e.push(this.bbox),void(this.bbox=[1/0,-(1/0),1/0,-(1/0)]);var t=this.bbox,i=this.animManager.generateCurrentFrameData();if(0===this._rotation)this.bbox=[this._x+this._scaleX*(this._scaleX>0?i[0]:i[1]),this._x+this._scaleX*(this._scaleX>0?i[1]:i[0]),this._y+this._scaleY*i[2],this._y+this._scaleY*i[3]];else{var n=Math.cos(this._rotation),o=Math.sin(this._rotation),s=this._scaleX*i[0],a=this._scaleX*i[1],r=this._scaleY*i[2],l=this._scaleY*i[3],c=n*s-o*r,d=o*s+n*r,u=n*a-o*r,h=o*a+n*r,p=n*s-o*l,m=o*s+n*l,f=n*a-o*l,g=o*a+n*l;this.bbox=[this._x+Math.min(c,u,p,f),this._x+Math.max(c,u,p,f),this._y+Math.min(d,h,m,g),this._y+Math.max(d,h,m,g)]}t[0]=Math.floor(Math.min(t[0],this.bbox[0])),t[1]=Math.ceil(Math.max(t[1],this.bbox[1])),t[2]=Math.floor(Math.min(t[2],this.bbox[2])),t[3]=Math.ceil(Math.max(t[3],this.bbox[3])),void 0!==e&&e.push(t)},n.prototype._refreshAnimation=n.prototype.refreshAnimation},function(e,t,i){function n(e){a.call(this,e),this._layer=e.layer||0,this._x=e.x||0,this._y=e.y||0,this._scaleX=e.sx||1,this._scaleY=e.sy||1,this._rotation=e.rotation||0,this._spriteRef=null,this.isDisplayed=!1,this.isWhiteListed=!1,this.scene=e.scene,this.renderer=this.scene.renderer,this.updateList=this.scene.updateList,this.displayList=this.scene.displayList,this.holdsStatics&&(this.displayList=this.scene.staticElements),e.isHudElement&&(this.displayList=this.scene.hudDisplayList),this._cleared=!1,this.show()}function o(e){var t=document.createElement("canvas");t.width=l,t.height=l;var i=t.getContext("2d");return i.fillStyle="#FF0000",i.fillRect(0,0,l,l),r=e.createTexture(t,null,"nearest","permanent")}var s=i(172).inherits,a=i(376);s(n,a),e.exports=n,Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"scaleX",{get:function(){return this._scaleX},set:function(e){this._scaleX=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"scaleY",{get:function(){return this._scaleY},set:function(e){this._scaleY=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"layer",{get:function(){return this._layer},set:function(e){e!==this._layer&&(this._layer=e,this.isDisplayed&&this._show(),this.forceRefresh())}}),n.prototype.render=function(){this.renderer.save(),this.renderer.multiplyColor(this.tint[0],this.tint[1],this.tint[2],this.tint[3]),this.renderer.translate(this._x,this._y),0!==this._rotation&&this.renderer.rotate(this._rotation),this.renderer.scale(this._scaleX,this._scaleY),this.draw(this.renderer),this.renderer.restore()},n.prototype._show=function(){null===this._spriteRef?this._spriteRef=this.displayList.add(this):this._spriteRef=this.displayList.reposition(this._spriteRef)},n.prototype._hide=function(){null!==this._spriteRef&&(this.displayList.removeByRef(this._spriteRef)||console.warn("[Sprite.remove] Sprite not found in display list",this,this.displayList),this._spriteRef=null)},n.prototype.show=function(){this._show(),this.isDisplayed=!0,this.forceRefresh()},n.prototype.hide=function(){this._hide(),this.isDisplayed=!1,this.forceRefresh()},n.prototype.forceRefresh=function(){this.isOutdated===!1&&(this.updateList.push(this),this.isOutdated=!0)},n.prototype.setWhiteListedness=function(e){this.isWhiteListed=e},n.prototype.remove=function(){if(this.hide(),this.isWhiteListed===!1){if(this._cleared===!0)return;this._cleared=!0,this.clear()}},n.prototype.isWithinBounds=function(e,t){return this.bbox[0]<=e&&e<=this.bbox[1]&&this.bbox[2]<=t&&t<=this.bbox[3]},n.prototype.refreshAnimation=function(e){if(this.isOutdated=!1,this.isDisplayed===!1)return void 0!==e&&e.push(this.bbox),void(this.bbox=[1/0,-(1/0),1/0,-(1/0)]);var t=this.bbox,i=this.generateCurrentFrameData();if(0===this._rotation)this.bbox=[this._x+this._scaleX*(this._scaleX>0?i[0]:i[1]),this._x+this._scaleX*(this._scaleX>0?i[1]:i[0]),this._y+this._scaleY*i[2],this._y+this._scaleY*i[3]];else{var n=Math.cos(this._rotation),o=Math.sin(this._rotation),s=this._scaleX*i[0],a=this._scaleX*i[1],r=this._scaleY*i[2],l=this._scaleY*i[3],c=n*s-o*r,d=o*s+n*r,u=n*a-o*r,h=o*a+n*r,p=n*s-o*l,m=o*s+n*l,f=n*a-o*l,g=o*a+n*l;this.bbox=[this._x+Math.min(c,u,p,f),this._x+Math.max(c,u,p,f),this._y+Math.min(d,h,m,g),this._y+Math.max(d,h,m,g)]}t[0]=Math.floor(Math.min(t[0],this.bbox[0])),t[1]=Math.ceil(Math.max(t[1],this.bbox[1])),t[2]=Math.floor(Math.min(t[2],this.bbox[2])),t[3]=Math.ceil(Math.max(t[3],this.bbox[3])),void 0!==e&&e.push(t)};var r=null,l=32;n.prototype.draw=function(){window.isoEngine.debug&&this.renderer.drawImage(r||o(this.renderer),-l/2,-l/2,l,l)},n.prototype.generateCurrentFrameData=function(){return[-l/2,l/2,-l/2,l/2]},n.prototype.clear=n.prototype.releaseBuffer=function(){}},function(e,t){function i(e){this.sprite=e,this._red=1,this._green=1,this._blue=1,this._alpha=1}function n(e){this.id=e.id,this._position=e.position||0,this.bbox=[1/0,-(1/0),1/0,-(1/0)],this.renderer=null,this._highlight=new i(this),
this._hue=e.hue||[1,1,1,1],this.tint=this.hue.slice(),this._alpha=1,this.alpha=void 0===e.alpha?1:e.alpha,this.isOutdated=!1}Object.defineProperty(i.prototype,"red",{get:function(){return this._red},set:function(e){this._red=e;var t=this.sprite;t.tint[0]=t.hue[0]*e,t.forceRefresh()}}),Object.defineProperty(i.prototype,"green",{get:function(){return this._green},set:function(e){this._green=e;var t=this.sprite;t.tint[1]=t.hue[1]*e,t.forceRefresh()}}),Object.defineProperty(i.prototype,"blue",{get:function(){return this._blue},set:function(e){this._blue=e;var t=this.sprite;t.tint[2]=t.hue[2]*e,t.forceRefresh()}}),Object.defineProperty(i.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e;var t=this.sprite;t.tint[3]=t.hue[3]*e,t.forceRefresh()}}),e.exports=n,Object.defineProperty(n.prototype,"position",{get:function(){return this._position},set:function(e){e!==this._position&&(this._position=e,this.isDisplayed&&this._show(),this.forceRefresh())}}),Object.defineProperty(n.prototype,"hue",{get:function(){return this._hue},set:function(e){e!==this._hue&&(this._hue=e,this.tint[0]=this.hue[0]*this._highlight.red,this.tint[1]=this.hue[1]*this._highlight.green,this.tint[2]=this.hue[2]*this._highlight.blue,this.tint[3]=this.hue[3]*this._highlight.alpha*this._alpha,this.isDisplayed&&this._show(),this.forceRefresh())}}),Object.defineProperty(n.prototype,"highlight",{get:function(){return this._highlight},set:function(e){this.setHighlight(e)}}),Object.defineProperty(n.prototype,"alpha",{get:function(){return this._alpha},set:function(e){e!==this._alpha&&(this._alpha=e,this.tint[3]=this.hue[3]*this._highlight.alpha*this._alpha,this.forceRefresh())}}),n.prototype.setHighlight=function(e){return null===e?void this.removeHighlight():(this._highlight._red=e.red,this._highlight._green=e.green,this._highlight._blue=e.blue,this._highlight._alpha=e.alpha,this.tint[0]=this.hue[0]*e.red,this.tint[1]=this.hue[1]*e.green,this.tint[2]=this.hue[2]*e.blue,this.tint[3]=this.hue[3]*e.alpha*this._alpha,void this.forceRefresh())},n.prototype.removeHighlight=function(){this.tint[0]=this.hue[0],this.tint[1]=this.hue[1],this.tint[2]=this.hue[2],this.tint[3]=this.hue[3]*this._alpha,this.forceRefresh()},n.prototype.forceRefresh=function(){}},function(e,t){function i(e){this.sprite=e,this.hasSubentities=!1,this.subentities=[],this.animationModifiers={}}function n(e){var t=document.createElement("canvas");t.width=s,t.height=s;var i=t.getContext("2d");return i.fillStyle="#FF0000",i.fillRect(0,0,s,s),o=e.createTexture(t,null,"nearest","permanent")}e.exports=i,i.prototype.isTemporary=!0,i.prototype.switchAnimationManager=function(e){e.hasSubentities=this.hasSubentities,e.subentities=this.subentities,e.animationModifiers=this.animationModifiers},i.prototype.addSubentity=function(e){this.subentities.push(e),this.hasSubentities=!0},i.prototype.removeSubentity=function(e){var t=this.subentities.indexOf(e);return t===-1?console.error("Subentity does not exist."):(e.animManager.cleanupAnimations(),this.subentities.splice(t,1),void(this.hasSubentities=this.subentities.length>0))},i.prototype.addAnimationModifier=function(e,t){this.animationModifiers[e]=t},i.prototype.removeAnimationModifier=function(e){delete this.animationModifiers[e]},i.prototype.cleanupAnimations=function(){for(var e=0;e<this.subentities.length;e++)this.subentities[e].animManager.cleanupAnimations()},i.prototype.cleanupAnimationsAndRemoveSubentities=function(){for(var e=0;e<this.subentities.length;e++)this.subentities[e].animManager.cleanupAnimations();this.subentities=[],this.hasSubentities=!1};var o=null,s=32;i.prototype.draw=function(){window.isoEngine.debug&&this.sprite.renderer.drawImage(o||n(this.sprite.renderer),-s/2,-s/2,s,s)},i.prototype.generateCurrentFrameData=function(){return[-s/2,s/2,-s/2,s/2]},i.prototype.assignSymbol=function(e,t,i){return console.warn("Attempt to call abstract method TemporaryAnimationManager.assignSymbol",e),i&&i()},i.prototype.getSymbolDuration=function(){return 0},i.prototype.clear=i.prototype.stop=i.prototype.releaseBuffer=i.prototype.addAnimation=i.prototype.applyAnimationModifier=i.prototype.setTints=i.prototype.prepareCurrentAnimationFrame=function(){}},function(e,t){function i(e,t){var i=e.toString(16).toUpperCase();if(t)for(;i.length<t;)i="0"+i;return i}function n(e){var t=i(e[0],2),n=i(e[1],2),o=i(e[2],2);return"#"+t+n+o}function o(e){return e=e.substr(1),3===e.length?[parseInt(e[0]+e[0],16)/255,parseInt(e[1]+e[1],16)/255,parseInt(e[2]+e[2],16)/255,1]:[parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,1]}function s(e){var t=e.indexOf("("),i=e.indexOf(","),n=e.indexOf(",",i+1),o=e.indexOf(",",n+1),s=e.indexOf(")",o+1);return[parseInt(e.substr(t+1,i),10)/255,parseInt(e.substr(i+1,n),10)/255,parseInt(e.substr(n+1,o),10)/255,parseFloat(e.substr(o+1,s))]}function a(e){var t=(251658240&e)>>24,i=(16711680&e)>>16,n=(65280&e)>>8,o=255&e;return{index:t,color:{r:i,g:n,b:o}}}function r(e,t){return e+(t<<24)}function l(e){for(var t=[],i=0;i<e.length;i++)t.push(r(e[i],i+1));return t}function c(e){if("string"==typeof e){if(0===e.indexOf("#"))return o(e);if(0===e.indexOf("rgba("))return s(e)}return e}function d(e){var t=null;if(e&&e.length>0){t=[null,null,null,null,null,null];for(var i=0;i<e.length;i++){var n=a(e[i]);t[n.index]=n.color}}return t}function u(e,t,i,n){var o=0;return o|=(15&e)<<24,o|=(255&t)<<16,o|=(255&i)<<8,o|=255&n}function h(e){var t=parseInt(e,16);if(6===e.length)return{r:(16711680&t)>>16,g:(65280&t)>>8,b:255&t};if(3===e.length){var i=(3840&t)>>8,n=(240&t)>>4,o=15&t;return{r:i+(i<<4),g:n+(n<<4),b:o+(o<<4)}}return console.warn("[hexToRgb] Invalid hex value"),null}t.colorArrayToHexa=n,t.hexToColorArray=o,t.rgbaToColorArray=s,t.parseIndexedColor=a,t.addIndex=r,t.addIndexes=l,t.anyToColorArray=c,t.parseIndexedColors=d,t.getIndexedColor=u,t.hexToRgb=h},function(e,t,i){function n(e){s.call(this,e,e.animManager),this.offsetY=e.offsetY||0}var o=i(172).inherits,s=i(374);o(n,s),e.exports=n,n.prototype.isFx=!0},function(e,t,i){function n(e,t,i){this.type=e,this.id=t,this.usage=i||""}function o(e,i,n,o,a,r){var l=i.subEntityLook,c=l.bonesId+"/motion",u=l.skins,h=l.scales[0],p=s.parseIndexedColors(l.indexedColors);t.loadCharacterAnimationManager(e,c,u,p,h,a,function(t){o[n]=t,i.bindingPointCategory===d&&(e.riderEntity=t),r()})}var s=i(378),a=i(381),r=i(391),l=i(394),c=i(397),d=c.HOOK_POINT_CATEGORY_MOUNT_DRIVER;t.loadCharacterAnimationManager=function(e,t,i,o,s,l,c){function d(i){for(var n=i[0],a=i.length-1,l=1;l<=a;l+=1){var d=i[l];n.merge(d,!0)}var u=t.split("/")[0],h=new r(e,n,s?s/100:1,u,o);return m!==!1&&e.setAnimManager(h),c&&c(h)}l=l||{};var u=[];u.push(new n("bone",t,l.boneType));for(var h=i.length,p=0;p<h;p+=1)u.push(new n("skin",i[p],l.skinType));var m=l.addToSprite,f=l.textureCache||e.renderer;a.loadTemplates(u,d,f,"archivable")},t.loadAnimationManager=function(e,t,i,n){function o(t){var o="string"==typeof i?i.split("/").shift():i,s=new r(e,t,1,o);return e.setAnimManager(s),n&&n(s)}var s=e.renderer;a.loadTemplate(t,i,"",o,s,"archivable")},t.loadLook=function(e,i,n,a){function r(){if(p+=1,p===m){for(var e=0;e<h;e+=1){var t=u[e];c.addSubentity({animManager:d[e],bindingPoint:"carried_"+t.bindingPointCategory+"_"+t.bindingPointIndex,symbolModifier:l[t.bindingPointCategory],bindingPointCategory:t.bindingPointCategory})}return a&a(c)}}n=n||{};var c=null,d=[],u=e.showSubentities?i.subentities:null,h=u?u.length:0,p=0,m=2+h,f=i.bonesId+"/motion",g=i.skins,_=s.parseIndexedColors(i.indexedColors),v=i.scales[0];t.loadCharacterAnimationManager(e,f,g,_,v,n,function(e){c=e,r()}),n.addToSprite=!1;for(var y=0;y<h;y+=1)o(e,u[y],y,d,n,r);r()}},function(e,t,i){function n(e,t,i){this.symbols=e,this.matrices=t,this.colors=i}function o(e,t,i){if(t===a.EMPTY_JSON)return M;g.jeffVersionDowngrader(t);var o,s,r,l=!!t.symbols,c={};l?(s=new n(c,t.matrices,t.colors),r=h,o=t.symbols):(s=c,r=p,o=t);for(var d=Object.keys(o),m=0;m<d.length;m+=1){var f=d[m],_=o[f];_.isGraphic&&(c[f]=new u(_,s,i)),_.isAnim&&(c[f]=new r(_,s,i))}return y.addAndHoldElement(s,1,e)}function s(e,t,i,n){var o=!!n.element.symbols,s=o?new m(t):new f(t);return s.generateTemplate(i,n),d.createAnimSoundGroups(s.getAnimationSounds(t),"sfx"),s}var a=i(167),r=i(382),l=i(182),c=i(384),d=i(247),u=i(385),h=i(386),p=i(387),m=i(388),f=i(390),g=i(339),_={skin:a.SKIN_PATH,bone:a.BONE_PATH,icon:a.ICON_PATH,ornaments:a.ORNAMENT_PATH,embedded:a.EMBEDDED_PATH,loader:a.LOADER_PATH},v={skin:"mipmap",bone:"mipmap",icon:"linear",ornaments:"linear",embedded:"linear",loader:"linear"},y=new r(a.MAX_ANIMATIONS),b={};t.loadMissingTemplatesInfo=function(){l.loadJson(a.MISSING_ANIM_PATH,function(e){for(var t=0;t<e.length;t++)b[e[t]]=!0})};var M={element:new n({},[],[]),release:function(){}};t.loadTemplate=function(e,t,i,n,a,r){function d(i){if(m=i,T+=1,T===C){A=o(w,m,p);var a=s(e,t,p,A);return n&&n(a)}}function u(i){if(p=i,T+=1,T===C){void 0===A&&(A=o(w,m,p));var a=s(e,t,p,A);return n&&n(a)}}if(b[t]){var h=a.getEmptyTexture();return n&&n(s(e,t,h,M))}var p,m,f=_[e]+i+t,g=f+".png",w=f+".json",T=0,C=1,A=y.holdElement(w);void 0===A&&(C+=1,l.loadJson(w,d)),c.loadTexture(g,u,a,v[e],r)},t.loadTemplates=function(e,t,i,n){function a(i,n){var a=w[n],r=d[a];if(void 0===r)h[a]=i;else{var l=f[a],c=o(l,i,r);u[a]=c;var m=e[a];p[a]=s(m.type,m.id,r,c)}if(C+=1,C===A)return t&&t(p)}function r(i,n){d[n]=i;var a,r,l=h[n];if(void 0===l)a=u[n],void 0!==a&&(r=e[n],p[n]=s(r.type,r.id,i,a));else{var c=f[n];a=o(c,l,i),r=e[n],p[n]=s(r.type,r.id,i,a)}if(C+=1,C===A)return t&&t(p)}for(var d=[],u=[],h=[],p=[],m=[],f=[],g=[],w=[],T=e.length,C=0,A=0,I=0;I<T;I+=1){var S=e[I],E=S.type,x=S.id;if(b[x]){var N=i.getEmptyTexture();p[I]=s(E,x,N,M)}else{var L=_[E]+S.usage+x,O=L+".png",D=L+".json";m.push(O),f.push(D),A+=1;var R=y.holdElement(D);void 0===R?(g.push(D),w.push(I),A+=1):u[I]=R}}var P=v[e[0].type];c.loadTextures(m,r,null,i,P,n),l.loadJsons(g,a,null)}},function(e,t,i){function n(e,t,i,n,o){this.id=n,this.cache=e,this.element=t,this.memorySize=i,this.type=a[o],this.nLocks=0,this.reference=null,this.attachment=null}function o(e,t){this.elementsById={},this.actives=new s,this.archives=new s,this.memoryUsed=0,this.memoryAllocated=e,this.onElementRemoved=t||null,this.unidentifiedElementsCount=0,this.addCount=0,this.removeCount=0}var s=i(383),a={permanent:0,archivable:1,throwable:2};n.prototype.isPermanent=function(){return this.type===a.permanent},n.prototype._hold=function(){return this.type===a.permanent?this:(this.nLocks+=1,this.cache._holdElement(this),this)},n.prototype.release=function(){return this.type===a.permanent?this:(this.nLocks-=1,void(0===this.nLocks?this.cache._releaseElement(this):this.nLocks<0&&console.error(new Error("[ElementHandle.release] Number of locks is negative: "+this.id))))},n.prototype.isFree=function(){return 0===this.nLocks},e.exports=o,o.prototype._clean=function(){for(var e=this.archives.first;null!==e&&this.memoryUsed>this.memoryAllocated;){var t=e.object;e=e.next,t.nLocks<=0&&this._removeElement(t)}},o.prototype.log=function(){console.log("***** Cache Stats *****"),console.log("  Actives",this.actives.length),console.log("  Archives",this.archives.length),console.log("  Total",Object.keys(this.elementsById).length),console.log("  Usage (units)",this.memoryUsed),console.log("  Usage (percentage)",(100*this.memoryUsed/this.memoryAllocated).toFixed(0),"%"),console.log("  Elements",this.elementsById)},o.prototype._holdElement=function(e){e.type!==a.permanent&&(e.reference.container===this.actives?this.actives.moveToTheEnd(e.reference):(this.archives.removeByReference(e.reference),e.reference=this.actives.addBack(e)))},o.prototype._releaseElement=function(e){this._archiveElement(e)},o.prototype._archiveElement=function(e){return e.reference.container!==this.actives?void console.warn("[Cache3State.archiveElement] The element cannot be archived:",e.id):void(e.type===a.throwable?this._removeElement(e):(this.actives.removeByReference(e.reference),e.reference=this.archives.addBack(e),this._clean()))},o.prototype._addElement=function(e){this.elementsById[e.id]=e,this.memoryUsed+=e.memorySize,this._clean(),e.type!==a.permanent&&(e.reference=this.actives.addBack(e)),this.addCount+=1},o.prototype.addAndHoldElement=function(e,t,i,o,s){var r=Boolean(i);r===!1&&(i="unidentified"+String(this.unidentifiedElementsCount++)),void 0!==o&&null!==o||(o=r?"archivable":"throwable");var l=this.elementsById[i];if(void 0!==l){if(!s)return l.type!==a[o]&&console.warn("[Cache3State.addElement] Trying to change type of an exisiting element",i),l._hold();if(l.isFree()===!1)return console.warn("[Cache3State.addElement] Trying to replace a locked element",i),l._hold();this._removeElement(l)}return l=new n(this,e,t,i,o),this._addElement(l),l._hold()},o.prototype.holdElement=function(e){var t=this.elementsById[e];if(void 0!==t)return t._hold()},o.prototype.useElement=function(e){var t=this.elementsById[e];if(void 0!==t)return t},o.prototype._removeElement=function(e){delete this.elementsById[e.id],this.memoryUsed-=e.memorySize,e.type!==a.permanent&&(e.reference.container===this.actives?e.reference=this.actives.removeByReference(e.reference):e.reference=this.archives.removeByReference(e.reference)),null!==this.onElementRemoved&&this.onElementRemoved(e.element),this.removeCount+=1}},function(e,t){function i(e,t,i,n){this.object=e,this.previous=t,this.next=i,this.container=n}function n(){this.first=null,this.last=null,this.length=0}e.exports=n,n.prototype.addFront=function(e){var t=new i(e,null,this.first,this);return null===this.first?(this.first=t,this.last=t):(this.first.previous=t,this.first=t),this.length+=1,t},n.prototype.add=n.prototype.addFront,n.prototype.addBack=function(e){var t=new i(e,this.last,null,this);return null===this.first?(this.first=t,this.last=t):(this.last.next=t,this.last=t),this.length+=1,t},n.prototype.popFront=function(){var e=this.first.object;return this.removeByReference(this.first),e},n.prototype.pop=n.prototype.popFront,n.prototype.popBack=function(){var e=this.last.object;return this.removeByReference(this.last),e},n.prototype.addBefore=function(e,t){var n=new i(t,e.previous,e,this);return null!==e.previous&&(e.previous.next=n),e.previous=n,this.first===e&&(this.first=n),this.length+=1,n},n.prototype.addAfter=function(e,t){var n=new i(t,e,e.next,this);return null!==e.next&&(e.next.previous=n),e.next=n,this.last===e&&(this.last=n),this.length+=1,n},n.prototype.moveToTheBeginning=function(e){return!(!e||e.container!==this)&&(null===e.previous||(e.previous.next=e.next,this.last===e?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=this.first,e.next.previous=e,this.first=e,!0))},n.prototype.moveToTheEnd=function(e){return!(!e||e.container!==this)&&(null===e.next||(e.next.previous=e.previous,this.first===e?this.first=e.next:e.previous.next=e.next,e.next=null,e.previous=this.last,e.previous.next=e,this.last=e,!0))},n.prototype.removeByReference=function(e){return e.container!==this?(console.warn("[DoublyList.removeByReference] Trying to remove a node that does not belong to the list"),e):(null===e.next?this.last=e.previous:e.next.previous=e.previous,null===e.previous?this.first=e.next:e.previous.next=e.next,e.container=null,this.length-=1,null)},n.prototype.remove=function(e){for(var t=this.first;null!==t;t=t.next)if(t.object===e)return this.removeByReference(t),!0;return!1},n.prototype.clear=function(){for(var e=this.first;null!==e;e=e.next)e.container=null;this.first=null,this.last=null,this.length=0},n.prototype.forEach=function(e,t){for(var i=this.first;i;i=i.next)e(i.object,t)},n.prototype.toArray=function(){for(var e=[],t=this.first;null!==t;t=t.next)e.push(t.object);return e}},function(e,t,i){var n=i(167),o=i(182);t.loadTexture=function(e,t,i,s,a){var r=i.holdTexture(e);return r?void t(r):void o.loadImage(e,function(o){var r;r=o===n.EMPTY_IMAGE?i.getEmptyTexture():i.createTexture(o,e,s,a),t(r)})},t.loadTextures=function(e,t,i,s,a,r){for(var l=[],c=[],d=e.length,u=0;u<d;u+=1){var h=e[u],p=s.holdTexture(h);p?t(p,u):(l.push(h),c.push(u))}return 0===l.length?i&&i():void o.loadImages(l,function(e,i){var o,d=l[i];o=e===n.EMPTY_IMAGE?s.getEmptyTexture():s.createTexture(e,d,a,r),t(o,c[i])},i)}},function(e,t){function i(e,t,i){this.vertexPos=[e.x,e.y,e.x+e.w,e.y+e.h],this.textureCoord=[e.sx/i.element.width,e.sy/i.element.height,(e.sx+e.sw)/i.element.width,(e.sy+e.sh)/i.element.height],this.id=e.id,this.tint=e.tint,this.texture=i,this.className=e.className,this.nbFrames=1,this.animationData=t}i.prototype.isGraphic=!0,e.exports=i},function(e,t){function i(e){this.id=e.id,this.matrices=e.matrices,this.colors=e.colors,this.frames=e.frames,this.maskStart=e.maskStart||!1,this.maskEnd=e.maskEnd||!1}function n(e,t){var n=e.children;this.children=[];for(var o=0,s=0;s<n.length;s+=1){var a=n[s];this.children.push(new i(a)),o<a.frames[1]&&(o=a.frames[1])}this.id=e.id,this.duration=e.duration,this.className=e.className,this.sounds=e.sounds,this.nbFrames=o+1,this.animationData=t}n.prototype.isAnim=!0,e.exports=n},function(e,t,i){function n(e,t,i){var n=e.frames;this.frames=[];for(var s=0;s<n.length;s+=1)this.frames.push(new o(n[s].position,t,i));this.id=e.id,this.className=e.className,this.sounds=e.sounds,this.duration=e.duration,this.nbFrames=this.frames.length,this.animationData=t}var o=i(385);n.prototype.isAnim=!0,e.exports=n},function(e,t,i){function n(e){this._id=e,c.call(this,e),this.externalSymbols={},this.mergedTemplates={},this.mergedSymbols={},this.matrices=[],this.colors=[],this.only4Directions=!1}function o(e,t,i,n){this.color=n,this.texture=e,this.vertexPos=t,this.textureCoord=i}function s(e){this.id=e}function a(e){this.id=e}function r(e){this.id=e}var l=i(383),c=i(389),d=i(172).inherits;d(n,c),e.exports=n,n.prototype._updateId=function(){this.id=this._id;for(var e=Object.keys(this.mergedTemplates),t=0;t<e.length;t+=1)this.id+="#"+this.mergedTemplates[e[t]].id;for(e=Object.keys(this.parentTemplates),t=0;t<e.length;t+=1)this.parentTemplates[e[t]]._updateId()},n.prototype.clear=function(){c.prototype.clear.call(this);for(var e=Object.keys(this.mergedTemplates),t=0;t<e.length;t+=1)this.mergedTemplates[e[t]].clear()},n.prototype.merge=function(e,t){var i=e.name,n={};this.mergedSymbols[i]=n,this.mergedTemplates[i]=e,e.parentTemplates[this.name]=this;var o=e.exposedSymbols;for(var s in o){var a=o[s],r=this.externalSymbols[a.className];r||(r=new l,this.externalSymbols[a.className]=r),n[a.className]=t?r.addBack(a):r.addFront(a)}return this._updateId(),i},n.prototype.unmerge=function(e){var t=e.name,i=this.mergedSymbols[t];if(i){for(var n in i){var o=this.externalSymbols[n];o.removeByReference(i[n]),0===o.length&&delete this.externalSymbols[n]}delete e.parentTemplates[this.name],delete this.mergedTemplates[t],delete this.mergedSymbols[t],e.clear(),this._updateId()}},n.prototype.generateTemplate=function(e,t){this.animationHandle=t;var i=t.element;this.texture=e,this.symbols=i.symbols,this.matrices=i.matrices,this.colors=i.colors;for(var n=Object.keys(this.symbols),o=0;o<n.length;o+=1){var s=this.symbols[n[o]];s.className&&(this.exposedSymbols[s.className]=s)}this.isEmpty=0===n.length},n.prototype.getSymbol=function(e){var t=this.exposedSymbols[e];return t?t:(t=this.externalSymbols[e],t?t.last.object:null)},s.prototype.isMaskTag=!0,s.prototype.isMaskDef=!0,a.prototype.isMaskTag=!0,a.prototype.isMaskUse=!0,r.prototype.isMaskTag=!0,r.prototype.isMaskStop=!0,n.prototype.createSprites=function(e,t,i,n,l,c,d){if(void 0===i)return[];var u,h,p,m,f,g,_,v,y,b,M,w,T,C=i.animationData,A=C.matrices[e.matrices[t]],I=C.colors[e.colors[t]],S=A[0],E=A[1],x=A[2],N=A[3],L=A[4]*l,O=A[5]*c,D=I[0],R=I[1],P=I[2],B=I[3],k=I[4],z=I[5],F=I[6],H=I[7];if(i.className){if(d[i.className]){var q=d[i.className];q.mirrored&&(S=-S,E=-E),f=q.prepareCurrentAnimationFrame();var W=[],U=f.length;for(p=0;p<U;p+=1)m=f[p],W.push(m),m.isMaskTag||(h=m.color,m.color=[h[0]*D,h[1]*R,h[2]*P,h[3]*B,h[4]*D+k,h[5]*R+z,h[6]*P+F,h[7]*B+H],u=m.vertexPos,g=u[0],_=u[1],v=u[2],y=u[3],b=u[4],M=u[5],w=u[6],T=u[7],m.vertexPos=[S*g+x*_+L,E*g+N*_+O,S*v+x*y+L,E*v+N*y+O,S*b+x*M+L,E*b+N*M+O,S*w+x*T+L,E*w+N*T+O]);return W}var G=this.externalSymbols[i.className];G&&G.length>0&&(i=G.last.object,C=i.animationData)}if(S*=l,E*=c,x*=l,N*=c,i.isGraphic){if(h=[D,R,P,B,k,z,F,H],void 0!==i.tint){var j=n[i.tint]||{r:1,g:1,b:1};h[0]*=j.r,h[1]*=j.g,h[2]*=j.b}var Y=i.vertexPos;return g=Y[0],_=Y[1],v=Y[2],y=Y[3],u=[S*g+x*_+L,E*g+N*_+O,S*v+x*_+L,E*v+N*_+O,S*g+x*y+L,E*g+N*y+O,S*v+x*y+L,E*v+N*y+O],[new o(i.texture,u,i.textureCoord,h)]}if(i.isAnim){t%=i.nbFrames;for(var V,X,Q,K,J,Z,$,ee,te=[],ie=i.children,ne=ie.length-1;ne>=0;ne-=1){var oe=ie[ne];if(!(t<oe.frames[0]||t>oe.frames[1]))if(oe.maskEnd)te.push(new r(oe.id));else{for(oe.maskStart&&te.push(new s(oe.id)),f=this.createSprites(oe,t-oe.frames[0],C.symbols[oe.id],n,1,1,d),p=0;p<f.length;p+=1)m=f[p],te.push(m),m.isMaskTag||(u=m.vertexPos,V=u[0],X=u[1],Q=u[2],K=u[3],J=u[4],Z=u[5],$=u[6],ee=u[7],u[0]=S*V+x*X+L,u[1]=E*V+N*X+O,u[2]=S*Q+x*K+L,u[3]=E*Q+N*K+O,u[4]=S*J+x*Z+L,u[5]=E*J+N*Z+O,u[6]=S*$+x*ee+L,u[7]=E*$+N*ee+O,h=m.color,h[0]*=D,h[1]*=R,h[2]*=P,h[3]*=B,h[4]=h[4]*D+k,h[5]=h[5]*R+z,h[6]=h[6]*P+F,h[7]=h[7]*B+H);oe.maskStart&&te.push(new a(oe.id))}}return te}return[]},n.prototype.prepareAnimationFrame=function(e,t,i,n,l,c){var d=this.getSymbol(e);if(!d)return console.warn("Symbol "+e+" not registered in character's template"),[];var u=d.animationData;if(d.isGraphic){var h=d.vertexPos,p=[h[0],h[1],h[2],h[1],h[0],h[3],h[2],h[3]];return[new o(d.texture,p,d.textureCoord,[1,1,1,1,0,0,0,0])]}for(var m=[],f=d.children,g=f.length-1;g>=0;g-=1){var _=f[g];if(_.frames[0]<=t&&t<=_.frames[1]){if(_.maskEnd){m.push(new r(_.id));continue}var v=this.createSprites(_,t-_.frames[0],u.symbols[_.id],i,n,l,c);_.maskStart?(m.push(new s(_.id)),Array.prototype.push.apply(m,v),m.push(new a(_.id))):Array.prototype.push.apply(m,v)}}return m}},function(e,t){function i(e){this.id=e,this.name="t"+n++,this.exposedSymbols={},this.texture=null,this.animationHandle=null,this.symbols={},this.parentTemplates={},this.isEmpty=!0}var n=0;e.exports=i,i.prototype.getFullId=function(){return this.id},i.prototype.clear=function(){this.texture&&this.texture.release(),this.animationHandle&&this.animationHandle.release()},i.prototype.merge=function(){},i.prototype.unmerge=function(){},i.prototype.generateTemplate=function(){},i.prototype.getSymbol=function(e){var t=this.exposedSymbols[e];return t?t:null},i.prototype.hasAnimation=function(e){return!!this.getSymbol(e)},i.prototype.getAnimationNbFrames=function(e){var t=this.getSymbol(e);return t?t.nbFrames:(console.warn("Symbol "+e+" not registered in character's template"),0)},i.prototype.getAnimationDuration=function(e){var t=this.getSymbol(e);return t?t.duration:(console.warn("Symbol "+e+" not registered in character's template"),0)},i.prototype.getAnimationFrameSound=function(e,t){var i=this.getSymbol(e);return i?i.sounds?i.sounds[t]:null:(console.warn("Symbol "+e+" not registered in character's template"),null)},i.prototype.getAnimationSounds=function(e){var t="string"==typeof e?e.split("/").shift():e,i={};for(var n in this.exposedSymbols){var o=this.exposedSymbols[n],s=o.sounds;if(s)for(var a in s)i[t+"/"+n+":"+a]=s[a]}return i}},function(e,t,i){function n(e){s.call(this,e)}function o(e,t,i,n){this.color=n,this.texture=e,this.vertexPos=t,this.textureCoord=i}var s=i(389),a=i(172).inherits;a(n,s),e.exports=n,n.prototype.merge=function(){console.error(new Error("[AtlasAnimationTemplate.merge]It is not possible to merge a template with an atlas template"))},n.prototype.unmerge=function(){console.error(new Error("[AtlasAnimationTemplate.merge]It is not impossible to merge a template with an atlas template and therefore to unmerge"))},n.prototype.generateTemplate=function(e,t){this.animationHandle=t,this.texture=e,this.symbols=t.element;for(var i=Object.keys(this.symbols),n=0;n<i.length;n+=1){var o=this.symbols[i[n]];o.className&&(this.exposedSymbols[o.className]=o)}this.isEmpty=0===i.length},n.prototype.prepareAnimationFrame=function(e,t,i,n,s){var a=this.getSymbol(e);if(!a)return console.warn("Symbol "+e+" not registered in character's template"),[];if(a.isAnim){var r=a.frames;t>=0&&t<=r.length&&(a=r[t])}var l=a.vertexPos,c=l[0]*n,d=l[1]*s,u=l[2]*n,h=l[3]*s,p=[1,1,1,1,0,0,0,0],m=[c,d,u,d,c,h,u,h],f=new o(a.texture,m,a.textureCoord,p);return[f]}},function(e,t,i){function n(){this.id="",this.sounds=null}function o(e,t,i,o,s){u.call(this,e),this.animationId=null,this.animationName="",this.template=t,this.bonesId=o,this.audioVol=1,this.scaleX=i||1,this.scaleY=i||1,this.mirrored=!1,this._frame=-1,this._prevFrame=-1,this.nbFrames=0,this.frameData=new n,this.tints=[],this.tintsString="",this._setTints(s),this.loadedAnimations={};var a=t.exposedSymbols;this.only4Directions=a&&!(a.AnimStatique_0||a.AnimStatique_4),this.isFx=this.sprite.isFx,this.tween=new r(this,["frame"]),this.tween.from({frame:0}),this._cleared=!1}function s(e){for(var t=0,i=[],n=[1/0,-(1/0),1/0,-(1/0)],o=0;o<e.length;o+=1){var s=e[o];if(s.isMaskTag){if(s.isMaskDef&&(i.push(n),n=[1/0,-(1/0),1/0,-(1/0)]),s.isMaskUse&&(i.push(n),n=[1/0,-(1/0),1/0,-(1/0)]),s.isMaskStop){var a=n,r=i.pop();n=i.pop(),n[0]=Math.min(n[0],Math.max(a[0],r[0])),n[1]=Math.max(n[1],Math.min(a[1],r[1])),n[2]=Math.min(n[2],Math.max(a[2],r[2])),n[3]=Math.max(n[3],Math.min(a[3],r[3]))}}else{var l=s.vertexPos;n[0]=Math.min(n[0],l[0],l[2],l[4],l[6]),n[1]=Math.max(n[1],l[0],l[2],l[4],l[6]),n[2]=Math.min(n[2],l[1],l[3],l[5],l[7]),n[3]=Math.max(n[3],l[1],l[3],l[5],l[7]),t+=1}}return{bbox:n,nbSprites:t,spriteBatch:e}}var a=i(172).inherits,r=i(392).Tween,l=i(167),c=i(247),d=i(381),u=i(377),h=l.ANIM_SYMBOLS,p=l.ANIM_SYMETRY,m=l.MAP_SCENE_WIDTH/2,f=[4,3,2,3,4,7,6,7];a(o,u),e.exports=o,Object.defineProperty(o.prototype,"frame",{get:function(){return this._frame},set:function(e){e=e<this.nbFrames?Math.floor(e):this.nbFrames-1,this._frame!==e&&(this._frame=e,this.sprite.forceRefresh())}}),o.prototype.switchAnimationManager=function(){},o.prototype.isTemporary=!1,o.prototype._computeSymbolDirection=function(e){return e.direction===-1?-1:this.isFx&&0===e.direction?0:this.only4Directions&&0===(1&e.direction)?e.direction+1:e.direction},o.prototype._getSymbolId=function(e){e=this.applyAnimationModifier(e);var t=e.type||0===e.type?e.type:"",i=e.param||0===e.param?"_"+e.param:"",n=e.base+t+i,o=this._computeSymbolDirection(e);return o!==-1&&(n+="_"+h[o]),n},o.prototype._getSymbolModelId=function(e){return this.bonesId+"/"+this._getSymbolId(e)},o.prototype.addAnimation=function(e,t){function i(){if(n+=1,n===o)return t&&t()}var n=0,o=1;if(!this.hasSubentities)return this._addAnimation(this._getSymbolModelId(e),i);for(var s=this.subentities,a=!0,r=0;r<s.length;r++){var l=s[r],c=l.symbolModifier(e);if(c.parent){var d=c.parent;o+=1,a=a&&this._addAnimation(this._getSymbolModelId(d),i)}c.child&&(o+=1,a=a&&l.animManager.addAnimation(c.child,i))}return i(),a},o.prototype._addAnimation=function(e,t){if(!this.bonesId)return console.warn("Incorrect bones id:",this.bonesId),t(),!1;if(this.loadedAnimations[e])return t(),!0;var i=this;return d.loadTemplate("bone",e,"",function(n){i.template.merge(n,!1),i.loadedAnimations[e]=n,t()},this.sprite.renderer),!0},o.prototype.applyAnimationModifier=function(e){var t=this.animationModifiers[e.base];if(!t)return e;switch(typeof t){case"string":return{base:t,type:e.type,param:e.param,direction:e.direction};case"function":return t(e);default:return console.error("Wrong animation modifier type"),e}},o.prototype.cleanupAnimations=function(){var e=this.template;for(var t in this.loadedAnimations){var i=this.loadedAnimations[t];e.unmerge(i)}this.loadedAnimations={};for(var n=0;n<this.subentities.length;n++)this.subentities[n].animManager.cleanupAnimations()},o.prototype.cleanupAnimationsAndRemoveSubentities=function(){var e=this.template;for(var t in this.loadedAnimations){var i=this.loadedAnimations[t];e.unmerge(i)}this.loadedAnimations={};for(var n=0;n<this.subentities.length;n++)this.subentities[n].animManager.cleanupAnimations();this.subentities=[],this.hasSubentities=!1},o.prototype.clear=function(e){return this._cleared?void console.warn("[AnimationManager.clear] Trying to clear an already cleared animation manager"):(e?this.tween.fastForwardToEnd():this.stop(),this.cleanupAnimationsAndRemoveSubentities(),this.template.clear(),this.sprite.renderer.unlockBuffer(this.frameData.id),this.frameData.id="",void(this._cleared=!0))},o.prototype._setTints=function(e){e||(e=[]);for(var t,i=[],n=this.tints.length!==e.length,o=0;o<e.length;o+=1){var s=e[o];if(t=s?{r:s.r/128,g:s.g/128,b:s.b/128}:{r:1,g:1,b:1},i[o]=t,!n){var a=this.tints[o];n=a.r!==t.r||a.g!==t.g||a.b!==t.b}}if(this.tints=i,n)for(this.tintsString="#",o=0;o<i.length;o+=1)t=i[o],this.tintsString+=Math.round(255*t.r).toString(16)+Math.round(255*t.g).toString(16)+Math.round(255*t.b).toString(16);return n},o.prototype.setTints=function(e){this._setTints(e)&&this.releaseBuffer()},o.prototype.prepareCurrentAnimationFrame=function(){return this.template.prepareAnimationFrame(this.animationName,this._frame,this.tints,this.scaleX,this.scaleY,this.subentityRefs)},o.prototype.getSymbolDuration=function(e){var t=this.template.exposedSymbols[e];return t?t.duration:0},o.prototype.releaseBuffer=function(){this.sprite.renderer.releaseBuffer(this.frameData.id),this.frameData.id="",this.sprite.forceRefresh()},o.prototype.generateCurrentFrameData=function(){if(null===this.animationId)return[1/0,-(1/0),1/0,-(1/0)];var e=this.sprite.renderer,t=this.frameData.id;this.frameData.id="",this.frameData.sounds=[],this._generateCurrentFrameIdAndSounds(this.frameData);var i=e.getBufferData(this.frameData.id);void 0===i&&(i=s(this.prepareCurrentAnimationFrame()),e.prepareBatchFromSpriteList(this.frameData.id,i)),this.frameData.id!==t&&(e.unlockBuffer(t),e.lockBuffer(this.frameData.id));for(var n=this.frameData.sounds,o=Math.max(-1,Math.min(1,this.sprite._x/m-1)),a=0;a<n.length;a++)c.playSoundGroup("sfx",n[a],this.audioVol,o);return i.bbox},o.prototype._generateCurrentFrameIdAndSounds=function(e){var t=this._frame;if(e.id+=this.animationId+t.toString(),this._prevFrame!==t){this._prevFrame=t;var i=this.template.getAnimationFrameSound(this.animationName,t);i&&e.sounds.push(this.bonesId+"/"+this.animationName+":"+t)}for(var n=0;n<this.subentities.length;n+=1)this.subentities[n].animManager._generateCurrentFrameIdAndSounds(e)},o.prototype.draw=function(e){e.drawSpriteBatch(this.frameData.id)},o.prototype._setMirroring=function(e,t){e!==-1&&p[e]^t?this.scaleX>0&&(this.mirrored=!0,this.scaleX*=-1):this.scaleX<0&&(this.mirrored=!1,this.scaleX*=-1)},o.prototype.assignSymbol=function(e,t,i){if(this.subentityRefs={},this.hasSubentities){for(var n=null,o={base:"AnimStatique",direction:e.direction},s=0;s<this.subentities.length;s++){var a=this.subentities[s],r=a.animManager,l=a.symbolModifier(e);n=l.parent||n,l.child?(r.assignSymbol(l.child,t,i),i=null):r.assignSymbol(o,!1),this.subentityRefs[a.bindingPoint]=r,r.mirrored=!1}e=n||o}(this.tween.playing||this.tween.starting)&&this.tween.stop();var c=this._getSymbolId(e),d=this._computeSymbolDirection(e);if(this.template.hasAnimation(c))this._setMirroring(d);else{e=this.applyAnimationModifier(e);var u=e.type||0===e.type?e.type:"",h=e.param||0===e.param?"_"+e.param:"";if(c=e.base+u+h+"_"+f[d],this.template.hasAnimation(c))this._setMirroring(d,!0);else{for(var p=!1,m=0;m<8;m++)if(c=e.base+u+h+"_"+m,this.template.hasAnimation(c)){this._setMirroring(m),p=!0;break}if(!p)return console.warn("Could not find any Animation "+e.base+" in template",this.template.id),i&&i()}}this.animationName=c;var g=this.template.id+"#"+c;return this.animationId=g+"#"+this.scaleY+this.tintsString+(this.mirrored?"M#":"#"),this.nbFrames=this.template.getAnimationNbFrames(c),this._prevFrame=-1,this._frame=-1,this.frame=0,0===this.nbFrames?i&&i():(this.tween.reset().to({frame:this.nbFrames},this.nbFrames).start(t),
void(i&&this.tween.onceFinish(i)))},o.prototype.stop=function(){(this.tween.playing||this.tween.starting)&&this.tween.stop()}},function(e,t,i){"use strict";function n(){this._time=0,this._duration=0,this.playing=!1,this.stopping=!1,this.starting=!1,this._iterations=0,this._onStart=null,this._onStop=null,this._onFinish=null,this._onUpdate=null,this._onceFinish=null,this.reference=null}function o(e,t){return this instanceof o==!1?new o(e,t):(n.call(this),this._duration=e,void this.onFinish(t))}function s(e,t,i,n,o,s){this.start=i,this.end=i+n,this.duration=n,this.fromObject=e,this.toObject=t,this.easing=o,this.easingParam=s}function a(e,t){return this instanceof a==!1?new a(e,t):(n.call(this),e||(console.error(new Error("Invalid tween element: "+e)),e={}),this._element=e,this._properties=t,this._transitions=[],this._currentTransitionIndex=0,this._duration=0,void(this._from=null))}function r(e,t){if(this instanceof r==!1)return new r(e,t);n.call(this),e||(console.error(new Error("Invalid tween element: "+e)),e={}),this._element=e,this._properties=t,this._previousValues={};for(var i=0;i<this._properties.length;i+=1)this._previousValues[this._properties[i]]=0;this._transitions=[],this._currentTransitionIndex=0,this._duration=0,this._from=null}var l=i(172).inherits,c=i(167),d=i(393),u=i(383),h=window.performance?window.performance:Date,p={tups:c.TIME_UNITS_PER_SECOND,easing:d,_startingTime:h.now(),_previousTime:h.now(),_playables:new u,_addList:[],_removeList:[],_silent:!0,_debug:!1,restart:function(){this._startingTime=h.now(),this._previousTime=h.now()},getFramesSinceStart:function(){return Math.floor((h.now()-this._startingTime)*this.tups/1e3)},update:function(){var e=h.now(),t=(e-this._previousTime)*this.tups/1e3;for(this._previousTime=e;this._addList.length>0;){var i=this._addList.pop();i.reference=this._playables.add(i)}for(var n=this._playables.first;null!==n;n=n.next)n.object.update(t);for(;this._removeList.length>0;)this._playables.removeByReference(this._removeList.pop().reference)},start:function(e){e.start(this)},_add:function(e){var t=this._addList.indexOf(e);t===-1&&(t=this._removeList.indexOf(e),t!==-1?this._removeList.splice(t,1):this._addList.push(e))},_remove:function(e){var t=this._removeList.indexOf(e);t===-1&&(t=this._addList.indexOf(e),t!==-1?this._addList.splice(t,1):this._removeList.push(e))},stop:function(){for(var e=this._playables.first;null!==e;e=e.next)e.object._stopped();this._playables.clear()},silent:function(e){this._silent=e||!1},debug:function(e){this._debug=e||!1},_warn:function(e){this._silent===!1&&console.warn(e)}};e.exports=p,n.prototype.start=function(e){return this._iterations=e===!0?1/0:e?e:1,0===this._iterations?(p._warn("[Playable.start] playable is required to run 0 times"),this):this.starting?(p._warn("[Playable.start] playable is already starting"),this):this.playing&&!this.stopping?(p._warn("[Playable.start] playable is already playing"),this):(this.starting=!0,p._add(this),this)},n.prototype.stop=function(){return this.stopping?(p._warn("[Playable.stop] playable is already stopping"),this):this.playing||this.starting?(this.stopping=!0,this.starting=!1,p._remove(this),this):(p._warn("[Playable.stop] playable is not playing"),this)},n.prototype.fastForwardToEnd=function(){this._time=this._duration},n.prototype._stopped=function(){this.stopping=!1,this.playing=!1,null!==this._onStop&&this._onStop()},n.prototype._started=function(){this.starting=!1,this.playing=!0,null!==this._onStart&&this._onStart()},n.prototype._finished=function(){if(this.playing=!1,p._remove(this),null!==this._onceFinish){var e=this._onceFinish.slice();this._onceFinish=null;for(var t=0;t<e.length;t+=1)e[t]()}null!==this._onFinish&&this._onFinish()},n.prototype._reset=function(){this._time=0},n.prototype.update=function(e){if(!this.stopping||(this._stopped(),this.starting))if(this.starting)this._time=0,this._update(),this._started();else{var t=this._time+e;t>=this._duration?1===this._iterations?(this._time=this._duration,this._update(),null!==this._onUpdate&&this._onUpdate(),this._finished()):(this._time=t%this._duration,this._update(),null!==this._onUpdate&&this._onUpdate(),this._iterations-=1):(this._time=t,this._update(),null!==this._onUpdate&&this._onUpdate())}},n.prototype.onUpdate=function(e){return this._onUpdate=e||null,this},n.prototype.onStart=function(e){return this._onStart=e||null,this},n.prototype.onStop=function(e){return this._onStop=e||null,this},n.prototype.onFinish=function(e){return this._onFinish=e||null,this},n.prototype.onceFinish=function(e){return null===this._onceFinish?this._onceFinish=[e]:this._onceFinish.push(e),this},n.prototype.removeOnFinish=function(){return this._onFinish=null,this._onceFinish=null,this},n.prototype.removeOnUpdate=function(){return this._onUpdate=null,this},n.prototype.removeOnStart=function(){return this._onStart=null,this},n.prototype.removeOnStop=function(){return this._onStop=null,this},n.prototype.getElapsedTime=function(){return this._time},n.prototype.getRemainingTime=function(){return this._duration-this._time},l(o,n),p.Delay=o,o.prototype.reset=function(e,t){this._duration=e,this.removeOnFinish(),this.onFinish(t)},o.prototype._update=function(){},l(a,n),p.Tween=a,a.prototype.reset=function(){return this._from=null,this._duration=0,this._currentTransitionIndex=0,this._transitions=[],this._reset(),this},a.prototype.from=function(e){return this._from=e,this._transitions.length>0&&(this._transitions[0].from=e),this},a.prototype._setFrom=function(){this._from={};for(var e=0;e<this._properties.length;e+=1){var t=this._properties[e];this._from[t]=this._element[t]}return this._from},a.prototype._getLastTransitionEnding=function(){return this._transitions.length>0?this._transitions[this._transitions.length-1].toObject:null===this._from?this._setFrom():this._from},a.prototype.to=function(e,t,i,n){void 0===i&&(i=d.linear);var o=this._getLastTransitionEnding();return this._transitions.push(new s(o,e,this._duration,t,i,n)),this._duration+=t,this},a.prototype.wait=function(e){if(0===e)return this;var t=this._getLastTransitionEnding();return this._transitions.push(new s(t,t,this._duration,e,d.linear,null)),this._duration+=e,this},a.prototype._update=function(){for(;this._time<this._transitions[this._currentTransitionIndex].start;)this._currentTransitionIndex--;for(;this._time>this._transitions[this._currentTransitionIndex].end;)this._currentTransitionIndex++;for(var e=this._transitions[this._currentTransitionIndex],t=e.easing((this._time-e.start)/e.duration,e.easingParam),i=e.fromObject,n=e.toObject,o=0;o<this._properties.length;o++){var s=this._properties[o];this._element[s]=i[s]*(1-t)+n[s]*t}},l(r,n),p.RelativeTween=r,r.prototype.reset=function(){this._from=null,this._duration=0,this._currentTransitionIndex=0,this._transitions=[],this._reset(),this._previousValues={};for(var e=0;e<this._properties.length;e+=1)this._previousValues[this._properties[e]]=0;return this},r.prototype.from=function(e){return this._from=e,this._transitions.length>0&&(this._transitions[0].from=e),this},r.prototype._setFrom=function(){this._from={};for(var e=0;e<this._properties.length;e+=1)this._from[this._properties[e]]=0;return this._from},r.prototype._getLastTransitionEnding=function(){return this._transitions.length>0?this._setFrom():null===this._from?this._setFrom():this._from},r.prototype.to=function(e,t,i,n){void 0===i&&(i=d.linear);var o=this._getLastTransitionEnding();return this._transitions.push(new s(o,e,this._duration,t,i,n)),this._duration+=t,this},r.prototype.wait=function(e){if(0===e)return this;var t=this._getLastTransitionEnding();return this._transitions.push(new s(t,t,this._duration,e,d.linear,null)),this._duration+=e,this},r.prototype._update=function(){for(;this._time<this._transitions[this._currentTransitionIndex].start;)this._currentTransitionIndex--;for(;this._time>this._transitions[this._currentTransitionIndex].end;)this._currentTransitionIndex++;for(var e=this._transitions[this._currentTransitionIndex],t=e.easing((this._time-e.start)/e.duration,e.easingParam),i=e.fromObject,n=e.toObject,o=0;o<this._properties.length;o++){var s=this._properties[o],a=i[s]*(1-t)+n[s]*t;this._element[s]+=a-this._previousValues[s],this._previousValues[s]=a}}},function(e,t){var i=Math.PI,n=Math.PI/2,o=2*Math.PI,s=2.718281828;t.none=function(){return 1},t.linear=function(e){return e},t.flash=function(e,t){return e+e*t-e*e*t},t.parabolic=function(e){var t=2*e-1;return 1-t*t},t.trigo=function(e,t){return.5*(1-Math.cos(o*e*t))},t.elastic=function(e,t){if(1===e)return 1;t/=t+1;var i=(1+t)*Math.log(1-e)/Math.log(t);return Math.cos(i-n)*Math.pow(t,i)},t.quadIn=function(e){return e*e},t.quadOut=function(e){return 2*e-e*e},t.quadInOut=function(e){return e<.5?2*e*e:2*(2*e-e*e)-1},t.cubicIn=function(e){return e*e*e},t.cubicOut=function(e){return 3*e-3*e*e+e*e*e},t.cubicInOut=function(e){return e<.5?4*e*e*e:4*(3*e-3*e*e+e*e*e)-3},t.quarticIn=function(e){return e*e*e*e},t.quarticOut=function(e){var t=e*e;return 4*e-6*t+4*t*e-t*t},t.quarticInOut=function(e){if(e<.5)return 8*e*e*e*e;var t=e*e;return 8*(4*e-6*t+4*t*e-t*t)-7},t.polyIn=function(e,t){return Math.pow(e,t)},t.polyOut=function(e,t){return 1-Math.pow(1-e,t)},t.polyInOut=function(e,t){return e<.5?Math.pow(2*e,t)/2:(2-Math.pow(2*(1-e),t))/2},t.sineIn=function(e){return 1-Math.cos(n*e)},t.sineOut=function(e){return Math.sin(n*e)},t.sineInOut=function(e){return e<.5?(1-Math.cos(i*e))/2:(1+Math.sin(i*(e-.5)))/2},t.expIn=function(e,t){return(1-Math.pow(s,t*e))/(1-Math.pow(s,t))},t.expOut=function(e,t){return(1-Math.pow(s,-t*e))/(1-Math.pow(s,-t))},t.expInOut=function(e,t){return e<.5?(1-Math.pow(s,2*t*e))/(1-Math.pow(s,t))/2:.5+(1-Math.pow(s,t-2*t*e))/(1-Math.pow(s,-t))/2},t.circIn=function(e){return 1-Math.sqrt(1-Math.pow(e,2))},t.circOut=function(e){return Math.sqrt(1-Math.pow(1-e,2))},t.circInOut=function(e){return e<.5?(1-Math.sqrt(1-4*e*e))/2:(1+Math.sqrt(-3+8*e-4*e*e))/2},t.elasticIn=function(e,t){if(0===e)return 0;t/=t+1;var i=(1+t)*Math.log(e)/Math.log(t);return Math.cos(i)*Math.pow(t,i)},t.elasticOut=function(e,t){if(1===e)return 1;t/=t+1;var i=(1+t)*Math.log(1-e)/Math.log(t);return 1-Math.cos(i)*Math.pow(t,i)},t.elasticInOut=function(e,t){var i;return e<.5?0===e?0:(t/=t+1,i=(1+t)*Math.log(2*e)/Math.log(t),.5*Math.cos(i)*Math.pow(t,i)):1===e?1:(t/=t+1,i=(1+t)*Math.log(2-2*e)/Math.log(t),.5+.5*(1-Math.cos(i)*Math.pow(t,i)))},t.bounceIn=function(e,t){if(0===e)return 0;t/=t+1;var i=(1+t)*Math.log(e)/Math.log(t);return Math.abs(Math.cos(i)*Math.pow(t,i))},t.bounceOut=function(e,t){if(1===e)return 1;t/=t+1;var i=(1+t)*Math.log(1-e)/Math.log(t);return 1-Math.abs(Math.cos(i)*Math.pow(t,i))},t.bounceInOut=function(e,t){var i;return e<.5?0===e?0:(t/=t+1,i=(1+t)*Math.log(2*e)/Math.log(t),Math.abs(.5*Math.cos(i)*Math.pow(t,i))):1===e?1:(t/=t+1,i=(1+t)*Math.log(2-2*e)/Math.log(t),.5+.5*(1-Math.abs(Math.cos(i)*Math.pow(t,i))))},t.backIn=function(e,t){return e*e*((t+1)*e-t)},t.backOut=function(e,t){return e-=1,e*e*((t+1)*e+t)+1},t.backInOut=function(e,t){return e<.5?(e*=2,.5*(e*e*((t+1)*e-t))):(e=2*e-2,.5*(e*e*((t+1)*e+t))+1)}},function(e,t,i){function n(e){return{parent:e,child:null}}var o=i(395),s=i(396),a=[n,s,o,n,n,n,n];e.exports=a},function(e,t,i){function n(e){return 0===e.type?{parent:e,child:null}:{parent:null,child:e}}function o(e){var t=e;return e.type&&(t={id:e.base+"0_"+d[e.direction],type:0,base:e.base,direction:e.direction}),{parent:null,child:t}}function s(e){return u[e.type]?{parent:e,child:null}:h[e.type]?{parent:e,child:e}:{parent:null,child:e}}function a(e){var t={base:"AnimCueillirSol0",direction:e.direction};return{parent:null,child:t}}function r(e){var t={base:"AnimEmoteWeap_0",direction:e.direction};return{parent:null,child:t}}function l(e){var t=e.base,i=p[t];if(!i)return console.error("No modifier for symbol base "+t),{parent:null,child:null};if("function"==typeof i)return i(e);var n={parent:null,child:null};return i.parent&&(n.parent=e),i.child&&(n.child=e),n}var c=i(167),d=c.ANIM_SYMBOLS,u={Rest_0:!0,Sit_0:!0,Oups_0:!0,Shit_0:!0},h={Appl_0:!0,Bye_0:!0,Champ_0:!0,Cross_0:!0,Drink_0:!0,Eat_0:!0,Fear_0:!0,Hi_0:!0,Kiss_0:!0,Mad_0:!0,Pfc1_0:!0,Pfc2_0:!0,Pfc3_0:!0,Pipo_0:!0,Point_0:!0},p={AnimArme:n,AnimAttaque:o,AnimEmote:s,AnimLevelUpRiding:r,AnimCueillirSol1:a,AnimConsulter:{parent:null,child:!0},AnimCueillir0:{parent:null,child:!0},AnimCueillirSol0:{parent:null,child:!0},AnimDrop:{parent:null,child:!0},AnimFaucher:{parent:null,child:!0},AnimHache:{parent:null,child:!0},AnimPeche:{parent:null,child:!0},AnimPickup:{parent:null,child:!0},AnimPioche:{parent:null,child:!0},AnimPuiser:{parent:null,child:!0},AnimThrow:{parent:null,child:!0},carrying:{parent:null,child:!0},AnimCourse:{parent:!0,child:null},AnimMarche:{parent:!0,child:null},AnimTacle:{parent:!0,child:null},AnimStatique:{parent:!0,child:!0},AnimMort:{parent:!0,child:!0},AnimHit:{parent:!0,child:!0},AnimVanish:{parent:!0,child:!0}};e.exports=l},function(e,t){function i(e){var t=e.base;return{parent:e,child:"AnimMarche"===t||"AnimCourse"===t?e:null}}e.exports=i},function(e,t){e.exports={HOOK_POINT_CATEGORY_UNUSED:0,HOOK_POINT_CATEGORY_PET:1,HOOK_POINT_CATEGORY_MOUNT_DRIVER:2,HOOK_POINT_CATEGORY_LIFTED_ENTITY:3,HOOK_POINT_CATEGORY_BASE_BACKGROUND:4,HOOK_POINT_CATEGORY_MERCHANT_BAG:5,HOOK_POINT_CATEGORY_BASE_FOREGROUND:6}},function(e,t,i){i(399),i(404),i(405),i(406),i(407),i(408),i(409),e.exports=i(400)},function(e,t,i){var n=i(400);n.shadersData={vertexLine:{type:"vertex",script:"attribute vec2 aPosition;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec4 vColor;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvec4 colorMul = aColorMul * cm * 2.0;\tvec4 colorAdd = aColorAdd * cm + ca;\tvColor = colorMul + colorAdd;\tvColor.rgb *= colorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},fragmentLine:{type:"fragment",script:"varying mediump vec4 vColor;void main() {\tgl_FragColor = vColor;}"},vertexBox:{type:"vertex",script:"attribute vec2 aPosition;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying mediump vec4 vColor;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvec4 colorMul = aColorMul * cm * 2.0;\tvec4 colorAdd = aColorAdd * cm + ca;\tvColor = colorMul + colorAdd;\tvColor.rgb *= colorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},fragmentBox:{type:"fragment",script:"varying mediump vec4 vColor;void main() {\tgl_FragColor = vColor;}"},vertexRegular:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec2 vTexCoord;varying   vec4 vColorMul;varying   vec4 vColorAdd;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvTexCoord = aTexCoord;\tvColorMul = aColorMul * cm * 2.0;\tvColorAdd = aColorAdd * cm + ca;\tvColorMul.rgb *= vColorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},fragmentRegular:{type:"fragment",script:"varying mediump vec2 vTexCoord;varying mediump vec4 vColorMul;varying mediump vec4 vColorAdd;uniform sampler2D uTexture;void main() {\tmediump vec4 color = texture2D(uTexture, vTexCoord);\tmediump float colorAddAlpha = vColorAdd.a * color.a;\tcolor *= vColorMul;\tcolor.rgb /= color.a;\tcolor.rgb += vColorAdd.rgb;\tcolor.a += colorAddAlpha;\tcolor.rgb *= color.a;\tif (color.a <= 0.05) { discard; }\tgl_FragColor = color;}"},vertexRelativeScale:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec2 vTexCoord;varying   vec4 vColorMul;varying   vec4 vColorAdd;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvTexCoord = aTexCoord;\tvColorMul = aColorMul * cm * 2.0;\tvColorAdd = ca;\tvColorMul.rgb *= vColorMul.a;\tfloat x = aPosition.x + tx.w * (aColorAdd.r * 127.0 + aColorAdd.g);\tfloat y = aPosition.y + ty.w * (aColorAdd.b * 127.0 + aColorAdd.a);\tgl_Position = vec4(\t\tx * tx.x + y * tx.y + tx.z,\t\tx * ty.x + y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},vertexAbsoluteScale:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec2 vTexCoord;varying   vec4 vColorMul;varying   vec4 vColorAdd;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvTexCoord = aTexCoord;\tvColorMul = aColorMul * cm * 2.0;\tvColorAdd = ca;\tvColorMul.rgb *= vColorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z + tx.w * 127.0 * aColorAdd.r * aColorAdd.b,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z - ty.w * 127.0 * aColorAdd.g * aColorAdd.a,\t\t0.0, 1.0\t);}"},vertexMask:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;uniform   vec4 uBbox;varying   vec2 vPosition;varying   vec2 vTexCoord;varying   vec4 vColorMul;varying   vec4 vColorAdd;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvTexCoord = aTexCoord;\tvColorMul = aColorMul * cm * 2.0;\tvColorAdd = aColorAdd * cm + ca;\tvColorMul.rgb *= vColorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);\tvPosition = (aPosition - vec2(uBbox.x, uBbox.z)) / vec2(uBbox.y - uBbox.x, uBbox.w - uBbox.z);}"},fragmentMask:{type:"fragment",script:"varying mediump vec2 vPosition;varying mediump vec2 vTexCoord;varying mediump vec4 vColorMul;varying mediump vec4 vColorAdd;uniform sampler2D uTexture;uniform sampler2D uMask;void main() {\tmediump vec4 color = texture2D(uTexture, vTexCoord);\tmediump float colorAddAlpha = vColorAdd.a * color.a;\tcolor *= vColorMul;\tcolor.rgb /= color.a;\tcolor.rgb += vColorAdd.rgb;\tcolor.a += colorAddAlpha;\tcolor.rgb *= color.a;\tif (color.a <= 0.05) { discard; }\tmediump float mask = texture2D(uMask, vPosition).a;\tif (mask == 0.0) { discard; }\tif (mask <= 0.2) {\t\tcolor *= mask * 5.0;\t}\tgl_FragColor = color;}"},vertexOutline:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec2 vTexCoord;varying   vec4 vColorOutline;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvColorOutline = uMatrix[2] * aColorMul + aColorAdd;\tvTexCoord = aTexCoord;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},fragmentOutline:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;varying mediump vec4 vColorOutline;uniform sampler2D uTexture;void main() {\tvec4 color = texture2D(uTexture, vTexCoord);\tif (color.a == 1.0) {\t\tdiscard;\t} else {\t\tfloat gradX = texture2D(uTexture, vTexCoord + vec2(0.05, 0.0)).a - texture2D(uTexture, vTexCoord - vec2(0.05, 0.0)).a;\t\tfloat gradY = texture2D(uTexture, vTexCoord + vec2(0.0, 0.05)).a - texture2D(uTexture, vTexCoord - vec2(0.0, 0.05)).a;\t\tvec4 outlineColor = 0.5 * vColorOutline * (abs(gradX) + abs(gradY));\t\tgl_FragColor = outlineColor * outlineColor.a;\t}}"},fragmentFiltering:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;uniform float uRatio;uniform sampler2D uTexture;void main() {\tvec2 res = vec2(1267.0, 865.5);\tvec4 color  = texture2D(uTexture, vTexCoord);\tvec4 color1 = texture2D(uTexture, vTexCoord + vec2(-0.7, -0.7) / res);\tvec4 color2 = texture2D(uTexture, vTexCoord + vec2(-0.7,  0.7) / res);\tvec4 color3 = texture2D(uTexture, vTexCoord + vec2( 0.7, -0.7) / res);\tvec4 color4 = texture2D(uTexture, vTexCoord + vec2( 0.7,  0.7) / res);\tgl_FragColor = color * (1.0 + 4.0 * uRatio) - uRatio * (color1 + color2 + color3 + color4);}"},fragmentMapTransition:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;varying mediump vec4 vColorMul;uniform float uRatio;uniform sampler2D uTexture;void main() {\tvec2 offsetToCenter = vTexCoord - 0.5;\tfloat distToCenter = length(offsetToCenter);\tfloat c1 = 2.0 * (0.5 - distToCenter * pow(uRatio, 2.0) * 0.02);\tvec2 textureCoord = vec2(0.5 + c1 * offsetToCenter.x, 0.5 + c1 * offsetToCenter.y);\tvec4 color = texture2D(uTexture, textureCoord);\tfloat avg = (color.r + color.g + color.b) / 3.0;\tfloat greyRatio = uRatio * 1.0;\tvec4 greyedColor = color * (1.0 - greyRatio) + vec4(avg) * greyRatio;\tfloat blackRatio = uRatio * 0.2;\tgl_FragColor = vec4((greyedColor * (1.0 - blackRatio)).rgb, 1.0) * vColorMul;}"},fragmentPixelArt:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;uniform float uResolution;uniform sampler2D uTexture;void main() {\tvec4 color = texture2D(uTexture, floor(vTexCoord * uResolution) / uResolution);\tcolor.rgb = floor(color.rgb * 8.0) / 8.0;\tgl_FragColor = color;}"},fragmentEnteringFight:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;uniform float uRatio;uniform sampler2D uTexture;void main() {\tfloat u = 2.0 * (vTexCoord.x - 0.5);\tfloat v = 2.0 * (vTexCoord.y - 0.5);\tfloat r = uRatio * (pow(1.0 - max(abs(u), abs(v)), 2.0));\tvec2 uv = vTexCoord + vec2(u, v) * r;\tvec4 color = texture2D(uTexture, uv) + 0.8 * vec4(1.0, 1.0, 1.0, 0.0) * r;\tgl_FragColor = color;}"},fragmentColorSplit:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;uniform sampler2D uTexture;void main() {\tvec4 color = vec4(0.0, 0.0, 0.0, 1.0);\tcolor.r = texture2D(uTexture, vTexCoord + vec2(-0.007, - 0.007)).r;\tcolor.g = texture2D(uTexture, vTexCoord + vec2(0.007, - 0.007)).g;\tcolor.b = texture2D(uTexture, vTexCoord + vec2(0.0, 0.01)).b;\tgl_FragColor = color;}"}}},function(e,t,i){function n(e,t,i,s,r,l,c){this.canvas=e;var d=this.gl=n.getWebGlContext(this.canvas,!1,c);d.blendFunc(d.ONE,d.ONE_MINUS_SRC_ALPHA),d.enable(d.BLEND),d.activeTexture(d.TEXTURE0),this.resetClearColor();var u=4,h=2,p=1,m=2,f=2,g=8;this._vertexSize=u*m+h*f+p*g,this._spriteSize=6*this._vertexSize,this._lineSize=2*this._vertexSize,this._boxSize=6*this._vertexSize,this._initPrograms(),this.initBuffer(s),this.sFMPartitioner=new a(this._spriteSize,s*this._spriteSize),this._initTextureCache(r),this._programs=[],this.useProgram(this._programRegular);var _=d.getParameter(d.FRAMEBUFFER_BINDING);this._renderTarget=this._createRenderTarget(null,_,1,1),this._renderTargetStack=[this._renderTarget],this._matrixStack=this._renderTarget.matrixStack,this._width=1,this._height=1,this.resetDimension(t||0,i||0),this._maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE),this.prerenderRatio=l,this.maskQuality=.5,this._drawModes={lines:d.LINES,triangles:d.TRIANGLES},this.emptyTexture=this.createTexture(o.EMPTY_IMAGE,"empty_texture","linear","permanent")}var o=i(167),s=i(382),a=i(401),r=null;e.exports=n,n.prototype.resetClearColor=function(){this.gl.clearColor(0,0,0,0)},n.prototype.setClearColor=function(e,t,i,n){this.gl.clearColor(e,t,i,n)},n.prototype._initTextureCache=function(e){function t(e){i.deleteTexture(e.binder)}var i=this.gl;this.textureCache=new s(e,t)},n.prototype.resetDimension=function(e,t){var i=this._width,n=this._height;this._width=e,this._height=t,this.gl.viewport(0,0,e,t);var o=this._renderTargetStack[0];o.width=e,o.height=t;for(var s=i/this._width,a=n/this._height,r=o.matrixStack,l=0;l<r.length;l+=1){var c=r[l];c[0]*=s,c[1]*=s,c[2]=(c[2]+1)*s-1,c[4]*=a,c[5]*=a,c[6]=(c[6]-1)*a+1}},n.prototype.getNbBytesPerSprite=function(){return this._spriteSize},n.prototype.getNbBytesPerLine=function(){return this._lineSize},n.prototype.getNbBytesPerBox=function(){return this._boxSize},n.prototype.getNbBytesPerVertex=function(){return this._vertexSize},n.prototype.enableBlending=function(){var e=this.gl;e.enable(e.BLEND)},n.prototype.disableBlending=function(){var e=this.gl;e.disable(e.BLEND)},n.prototype.drawImage=function(e,t,i,n,o){if(e){var s=this._matrixStack[0],a=s[0],r=s[4],l=s[1],c=s[5],d=s[2],u=s[6];s[2]+=a*t+l*i,s[6]+=r*t+c*i,s[0]*=n,s[4]*=n,s[1]*=o,s[5]*=o,this.gl.uniformMatrix4fv(this._currentProgram.uniforms.uMatrix,!1,s);var h=this.textureCache.useElement(e.id).element.binder;this.gl.bindTexture(this.gl.TEXTURE_2D,h),this.gl.drawArrays(this.gl.TRIANGLES,0,6),s[0]=a,s[4]=r,s[1]=l,s[5]=c,s[2]=d,s[6]=u}},n.prototype.clear=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)},n.isWebGlSupported=function(){if(null!==r)return r;var e=document.createElement("canvas");return r=!!n.getWebGlContext(e,!0)},n.getWebGlContext=function(e,t,i){var n=null;try{var o={alpha:i,depth:!1,stencil:!1,antialias:!1};n=e.getContext("webgl",o)||e.getContext("experimental-webgl",o)}catch(s){if(!t)throw new Error("Could not initialise WebGL ("+s.message+")");return null}if(!n){if(!t)throw new Error("Could not initialise WebGL, sorry :-(");return null}return n}},function(e,t,i){function n(e,t){this.start=e,this.nBytes=t,this.update=0,this.prevChunk=null,this.nextChunk=null,this.id=null,this.obj=null,this.ref=null,this.nLocks=0}function o(e,t){this.memoryChunksFree=new s(function(e,t){return e.nBytes-t.nBytes}),this.memoryChunksUsed=new a(function(e,t){return e.update-t.update}),this.memoryChunksLocked=new a(function(){return 1});var i=t-e,o=new n(e,i);o.ref=this.memoryChunksFree.add(o),this.firstByte=e,this.nBytes=i,this.update=0,this.chunksById={}}var s=i(402),a=i(403);n.prototype.set=function(e,t,i){this.start=e,this.nBytes=t,this.update=i},e.exports=o,o.prototype.touch=function(e){var t=this.chunksById[e];if(void 0!==t)return 0===t.nLocks&&(t.update=this.update++,this.memoryChunksUsed.moveToTheEnd(t.ref)),t.obj},o.prototype.getChunk=function(e){return this.chunksById[e]},o.prototype.addLock=function(e){var t=this.chunksById[e];if(void 0!==t)return 0===t.nLocks&&(this.memoryChunksUsed.removeByRef(t.ref)||console.warn("[SuperFastMemoryPartitioner.lock] Trying to lock an already locked chunk",e),t.ref=this.memoryChunksLocked.add(t),t.update=1/0),t.nLocks+=1,t.obj},o.prototype.removeLock=function(e){var t=this.chunksById[e];void 0!==t&&(t.nLocks-=1,0===t.nLocks&&(this.memoryChunksLocked.removeByRef(t.ref),t.ref=this.memoryChunksUsed.add(t),t.update=this.update++),t.nLocks<0&&console.warn("[SuperFastMemoryPartitioner.unlock] Trying to unlock a non-locked chunk",e))},o.prototype.possess=function(e){return!!this.chunksById[e]},o.prototype.release=function(e){var t=this.chunksById[e];if(void 0!==t){if(t.ref.container===this.memoryChunksLocked?this.memoryChunksLocked.removeByRef(t.ref):this.memoryChunksUsed.removeByRef(t.ref),t.prevChunk&&t.prevChunk.ref.container===this.memoryChunksFree){var i=t.prevChunk;t.start=i.start,t.nBytes+=i.nBytes,t.prevChunk=i.prevChunk,i.prevChunk&&(i.prevChunk.nextChunk=t),this.memoryChunksFree.removeByReference(i.ref)}if(t.nextChunk&&t.nextChunk.ref.container===this.memoryChunksFree){var n=t.nextChunk;t.nBytes+=n.nBytes,t.nextChunk=n.nextChunk,n.nextChunk&&(n.nextChunk.prevChunk=t),this.memoryChunksFree.removeByReference(n.ref)}t.ref=this.memoryChunksFree.add(t),t.nLocks=0,t.update=0,delete this.chunksById[e]}},o.prototype.bindObject=function(e,t){var i=this.chunksById[e];return void 0!==i&&(i.obj=t,!0)},o.prototype._selectChunks=function(e){var t=this.memoryChunksFree.getSmallestAbove({nBytes:e});if(t)return[t];if(0===this.memoryChunksUsed.count)throw new Error("No available chunk can hold "+e+" Bytes.Make sure that enough space is allocated (currently "+this.nBytes+") or that locked chunks are correctly unlocked.");var i=this.memoryChunksUsed.first;if(i.object.nBytes>=e)return[i.object];for(var n,o=0,s=7,a=1/0;(o<s||a===1/0)&&null!==i;){for(var r=i.object,l=[r],c=r.nBytes,d=r.prevChunk,u=r.nextChunk,h=r.update;c<e;)null===d||null!==u&&u.update<=d.update?(h<u.update&&(h=u.update),l.push(u),c+=u.nBytes,u=u.nextChunk):(h<d.update&&(h=d.update),l.unshift(d),c+=d.nBytes,d=d.prevChunk);h<a&&(a=h,n=l),i=i.next,o+=1}if(a===1/0)throw new Error("No available chunk can hold "+e+" Bytes.Make sure that enough space is allocated (currently "+this.nBytes+") or that locked chunks are correctly unlocked.");return n},o.prototype.reserve=function(e,t){for(var i=this._selectChunks(t),o=0;o<i.length;o+=1){var s=i[o];s.ref.container===this.memoryChunksUsed?(this.memoryChunksUsed.removeByRef(s.ref),delete this.chunksById[s.id]):this.memoryChunksFree.removeByReference(s.ref)}var a=i[0],r=i[i.length-1],l=a.start,c=r.start+r.nBytes;a.set(l,t,this.update),a.ref=this.memoryChunksUsed.add(a),a.id=e,this.chunksById[e]=a;var d=c-l;if(d===t)a.nextChunk=r.nextChunk,null!==a.nextChunk&&(a.nextChunk.prevChunk=a);else{var u;if(a===r?(u=new n(l+t,d-t),u.nextChunk=r.nextChunk,null!==u.nextChunk&&(u.nextChunk.prevChunk=u)):(u=r,u.set(l+t,d-t,0)),u.prevChunk=a,a.nextChunk=u,u.nextChunk&&u.nextChunk.ref.container===this.memoryChunksFree){var h=u.nextChunk;u.nBytes+=h.nBytes,u.nextChunk=h.nextChunk,h.nextChunk&&(h.nextChunk.prevChunk=u),this.memoryChunksFree.removeByReference(h.ref)}u.ref=this.memoryChunksFree.add(u)}return this.update+=1,a},o.prototype.debug=function(){console.log("***** SFMP *****"),console.log(" FREE CHUNKS"),this.memoryChunksFree.forEach(function(e){console.log(e)}),console.log(" USED CHUNKS"),this.memoryChunksUsed.forEach(function(e){console.log(e)}),console.log(" LOCKED CHUNKS"),this.memoryChunksLocked.forEach(function(e){console.log(e)})}},function(e,t){function i(e,t){this.object=e,this.height=1,this.left=null,this.right=null,this.parent=null,this.container=t}function n(e){this.length=0,this.root=null,this.cmpFunc=e}n.prototype._addLeft=function(e,t){e.parent=t,t.left=e},n.prototype._addRight=function(e,t){e.parent=t,t.right=e},n.prototype.popSmallest=function(){for(var e=this.root;null!==e.left;)e=e.left;return this.removeByReference(e),e.object},n.prototype.popGreatest=function(){for(var e=this.root;null!==e.right;)e=e.right;return this.removeByReference(e),e.object},n.prototype.add=function(e){this.length+=1;var t=new i(e,this);if(null===this.root)return this.root=t,t;for(var n=this.root;;){var o=this.cmpFunc(e,n.object);if(o<0){if(null===n.left){this._addLeft(t,n);break}n=n.left}else if(o>0){if(null===n.right){this._addRight(t,n);break}n=n.right}else{if(null===n.left){this._addLeft(t,n);break}if(null===n.right){this._addRight(t,n);break}n=n.right.height<n.left.height?n.right:n.left}}return 1===n.height&&this._balance(t.parent,!1),t},n.prototype._balanceLeftRight=function(e){var t=e.left,i=t.right,n=t.left,o=i.left;i.left=t,e.left=i,i.parent=e,t.parent=i,t.left=n,t.right=o;var s=0;null!==n&&(s=n.height,n.parent=t);var a=0;null!==o&&(a=o.height,o.parent=t);var r=(s>a?s:a)+1;t.height=r;var l=null===i.right?0:i.right.height;i.height=(r>l?r:l)+1},n.prototype._balanceLeftLeft=function(e){var t=e.left,i=t.right,n=e.parent;e===this.root?this.root=t:n.right===e?n.right=t:n.left=t,t.right=e,t.parent=n,e.parent=t,e.left=i;var o;null===i?o=0:(i.parent=e,o=i.height);var s=null===e.right?0:e.right.height;e.height=(o>s?o:s)+1},n.prototype._balanceRightLeft=function(e){var t=e.right,i=t.left,n=t.right,o=i.right;i.right=t,e.right=i,i.parent=e,t.parent=i,t.right=n,t.left=o;var s=0;null!==n&&(s=n.height,n.parent=t);var a=0;null!==o&&(a=o.height,o.parent=t);var r=(s>a?s:a)+1;t.height=r;var l=null===i.left?0:i.left.height;i.height=(l>r?l:r)+1},n.prototype._balanceRightRight=function(e){var t=e.right,i=t.left;e===this.root?this.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,t.parent=e.parent,e.parent=t,e.right=i;var n;null===i?n=0:(i.parent=e,n=i.height);var o=null===e.left?0:e.left.height;
e.height=(o>n?o:n)+1},n.prototype._balance=function(e,t){for(var i=e;null!==i;){var n=i.left,o=i.right,s=null===n?0:n.height,a=null===o?0:o.height;if(s-a>1)null!==n.right&&(null===n.left||n.left.height<n.right.height)&&this._balanceLeftRight(i),this._balanceLeftLeft(i);else if(a-s>1)null!==o.left&&(null===o.right||o.right.height<o.left.height)&&this._balanceRightLeft(i),this._balanceRightRight(i);else{var r=(s>a?s:a)+1;if(!t&&r===i.height)break;i.height=r}i=i.parent}},n.prototype.removeByReference=function(e){if(e.container!==this)return e;this.length-=1;var t=e.parent,i=e.left,n=e.right;if(null===e.right)return null!==i&&(i.parent=t),null===t?this.root=i:(t.right===e?t.right=i:t.left=i,null===i?this._balance(t,!0):i.height+3<=t.height&&this._balance(t,!0)),!0;var o=e.right;if(null===o.left)return null!==i&&(i.parent=o),o.left=i,null===t?this.root=o:t.right===e?t.right=o:t.left=o,o.parent=t,this._balance(o,!0),!0;for(o=o.left;null!==o.left;)o=o.left;null!==o.right&&(o.right.parent=o.parent),o.parent.left=o.right,null!==n&&(n.parent=o),o.right=n,null!==i&&(i.parent=o),o.left=i,null===t?this.root=o:t.right===e?t.right=o:t.left=o;var s=o.parent;return o.parent=t,this._balance(s,!0),e.left=null,e.right=null,e.parent=null,e.container=null,null},n.prototype.getSmallestAbove=function(e){if(null===this.root)return null;for(var t=null,i=this.root;null!==i;){var n=this.cmpFunc(e,i.object);if(n<0)t=i.object,i=i.left;else{if(!(n>0))return i.object;i=i.right}}return t},n.prototype.getGreatestBelow=function(e){if(null===this.root)return null;for(var t=null,i=this.root;null!==i;){var n=this.cmpFunc(e,i.object);if(n<0)i=i.left;else{if(!(n>0))return i.object;t=i.object,i=i.right}}return t},n.prototype._forEach=function(e,t,i){null!==e&&(this._forEach(e.left,t,i),t(e.object,i),this._forEach(e.right,t,i))},n.prototype.forEach=function(e,t){this._forEach(this.root,e,t)},n.prototype._forEachReverse=function(e,t,i){null!==e&&(this._forEachReverse(e.right,t,i),t(e.object,i),this._forEachReverse(e.left,t,i))},n.prototype.forEachReverse=function(e,t){this._forEachReverse(this.root,e,t)},n.prototype.clear=function(){this._clearEachNode(this.root),this.length=0,this.root=null},n.prototype._clearEachNode=function(e){null!==e&&(this._clearEachNode(e.left),this._clearEachNode(e.right),e.left=null,e.right=null,e.parent=null,e.container=null)},n.prototype._toArray=function(e,t){null!==e&&(this._toArray(e.left,t),t.push(e.object),this._toArray(e.right,t))},n.prototype.toArray=function(){var e=[];return this._toArray(this.root,e),e},e.exports=n},function(e,t){function i(e){this.count=0,this.first=null,this.last=null,this.cmpFunc=e}function n(e,t,i,n){this.object=e,this.previous=t,this.next=i,this.container=n}i.prototype.add=function(e){var t=new n(e,null,null,this);if(this.count+=1,null===this.first)return this.first=t,this.last=t,t;var i=this.cmpFunc(e,this.first.object);if(i<0)return t.next=this.first,this.first.previous=t,this.first=t,t;var o=this.cmpFunc(e,this.last.object);if(o>=0)return t.previous=this.last,this.last.next=t,this.last=t,t;var s;if(i+o<0){for(s=this.first.next;this.cmpFunc(e,s.object)>=0;)s=s.next;t.next=s,t.previous=s.previous,t.previous.next=t,s.previous=t}else{for(s=this.last.previous;this.cmpFunc(e,s.object)<0;)s=s.previous;t.previous=s,t.next=s.next,t.next.previous=t,s.next=t}return t},i.prototype.removeByRef=function(e){return!(!e||e.container!==this)&&(this.count-=1,null===e.previous?this.first=e.next:e.previous.next=e.next,null===e.next?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=null,e.container=null,!0)},i.prototype.moveToTheBeginning=function(e){return!(!e||e.container!==this)&&(null===e.previous||(e.previous.next=e.next,this.last===e?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=this.first,e.next.previous=e,this.first=e,!0))},i.prototype.moveToTheEnd=function(e){return!(!e||e.container!==this)&&(null===e.next||(e.next.previous=e.previous,this.first===e?this.first=e.next:e.previous.next=e.next,e.next=null,e.previous=this.last,e.previous.next=e,this.last=e,!0))},i.prototype.possess=function(e){return e&&e.container===this},i.prototype.popFirst=function(){var e=this.first;if(!e)return null;this.count-=1;var t=e.object;return this.first=e.next,null!==this.first&&(this.first.previous=null),e.next=null,e.container=null,t},i.prototype.popLast=function(){var e=this.last;if(!e)return null;this.count-=1;var t=e.object;return this.last=e.previous,null!==this.last&&(this.last.next=null),e.previous=null,e.container=null,t},i.prototype.getFirst=function(){return this.first&&this.first.object},i.prototype.getLast=function(){return this.last&&this.last.object},i.prototype.clear=function(){for(var e=this.first;e;e=e.next)e.container=null;this.count=0,this.first=null,this.last=null},i.prototype.getCount=function(){return this.count},i.prototype.toArray=function(){for(var e=[],t=this.first;t;t=t.next)e.push(t.object);return e},i.prototype.forEach=function(e,t){for(var i=this.first;i;i=i.next)e(i.object,t)},i.prototype.forEachReverse=function(e,t){for(var i=this.last;i;i=i.previous)e(i.object,t)},i.prototype.reposition=function(e){if(e.container!==this)return this.add(e.object);var t=e.previous,i=e.next,n=e.object;for(null===i?this.last=t:i.previous=t,null===t?this.first=i:t.next=i;null!==t&&this.cmpFunc(n,t.object)<0;)i=t,t=t.previous;for(;null!==i&&this.cmpFunc(n,i.object)>=0;)t=i,i=i.next;return e.next=i,null===i?this.last=e:i.previous=e,e.previous=t,null===t?this.first=e:t.next=e,e},e.exports=i},function(e,t,i){function n(e,t){this.program=e,this.data=t||null}function o(e,t,i,n,o){this.binder=null,this.vertexShaderId=t,this.fragmentShaderId=i,this.uniformIds=n,this.attributeIds=o,this.uniforms={},this.attributes={},this.lastAttributeIndex=o.length-1,this.vertexSize=e._vertexSize,this.gl=e.gl}function s(e,t,i,n,s){o.call(this,e,t,i,n,s)}var a=i(400),r={uTexture:0,uMask:1};o.prototype.setAttributes=function(){var e=4,t=2,i=1;this.gl.vertexAttribPointer(this.attributes.aPosition,2,this.gl.FLOAT,!1,this.vertexSize,0),this.gl.vertexAttribPointer(this.attributes.aColorMul,4,this.gl.BYTE,!0,this.vertexSize,2*e+2*t),this.gl.vertexAttribPointer(this.attributes.aColorAdd,4,this.gl.BYTE,!0,this.vertexSize,2*e+2*t+4*i)},s.prototype.setAttributes=function(){var e=4,t=2,i=1;this.gl.vertexAttribPointer(this.attributes.aPosition,2,this.gl.FLOAT,!1,this.vertexSize,0),this.gl.vertexAttribPointer(this.attributes.aTexCoord,2,this.gl.UNSIGNED_SHORT,!0,this.vertexSize,2*e),this.gl.vertexAttribPointer(this.attributes.aColorMul,4,this.gl.BYTE,!0,this.vertexSize,2*e+2*t),this.gl.vertexAttribPointer(this.attributes.aColorAdd,4,this.gl.BYTE,!0,this.vertexSize,2*e+2*t+4*i)},a.prototype._initPrograms=function(){this._shaders={};var e=["uMatrix"],t=["uMatrix"],i=["uMatrix","uTexture"],n=["uMatrix","uTexture","uRatio"],a=["uMatrix","uTexture","uMask","uBbox"],r=["aPosition","aColorMul","aColorAdd"];this._programLine=new o(this,"vertexLine","fragmentLine",e,r),this._programBox=new o(this,"vertexBox","fragmentBox",t,r);var l=["aPosition","aTexCoord","aColorMul","aColorAdd"];this._programMask=new s(this,"vertexMask","fragmentMask",a,l),this._programAbsoluteScale=new s(this,"vertexAbsoluteScale","fragmentRegular",i,l),this._programPixelArt=new s(this,"vertexRegular","fragmentPixelArt",n,l),this._programFiltering=new s(this,"vertexRegular","fragmentFiltering",n,l),this._programMapTransition=new s(this,"vertexRegular","fragmentMapTransition",n,l),this._programRegular=new s(this,"vertexRegular","fragmentRegular",i,l),this._currentProgram={lastAttributeIndex:-1}},a.prototype._getShader=function(e){if(this._shaders[e])return this._shaders[e];var t,i=this.gl,n=a.shadersData[e];if("fragment"===n.type)t=i.createShader(i.FRAGMENT_SHADER);else{if("vertex"!==n.type)return null;t=i.createShader(i.VERTEX_SHADER)}if(i.shaderSource(t,n.script),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS))throw new Error(i.getShaderInfoLog(t));return this._shaders[e]=t,t},a.prototype._buildProgram=function(e){var t=this.gl,i=t.createProgram();if(t.attachShader(i,this._getShader(e.vertexShaderId)),t.attachShader(i,this._getShader(e.fragmentShaderId)),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){var n=t.getProgramInfoLog(i);throw t.deleteProgram(i),new Error("Error linking the program:"+n)}t.useProgram(i);for(var o=e.attributeIds,s=e.attributes,a=0;a<o.length;a+=1){var l=o[a];s[l]=t.getAttribLocation(i,l)}for(var c=e.uniformIds,d=e.uniforms,u=0;u<c.length;u+=1){var h=c[u],p=t.getUniformLocation(i,h);r[h]&&t.uniform1i(p,r[h]),d[h]=p}e.binder=i},a.prototype._useProgram=function(e){var t=e.program;if(t!==this._currentProgram){var i,n=this._currentProgram.lastAttributeIndex,o=t.lastAttributeIndex;if(n>o)for(i=n;i>o;i-=1)this.gl.disableVertexAttribArray(i);else if(n<o)for(i=n+1;i<=o;i+=1)this.gl.enableVertexAttribArray(i);var s=t.binder;null===s?this._buildProgram(t):this.gl.useProgram(t.binder),t.setAttributes(),this._currentProgram=t}var a=e.data;if(null!==a){var r=this.gl;void 0!==a.mask&&(r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,a.mask),r.activeTexture(r.TEXTURE0)),void 0!==a.ratio&&r.uniform1f(this._currentProgram.uniforms.uRatio,a.ratio),void 0!==a.resolution&&r.uniform1f(this._currentProgram.uniforms.uResolution,a.resolution)}},a.prototype.useProgram=function(e,t){var i=new n(e,t);this._programs.push(i),this._useProgram(i)},a.prototype.stopProgram=function(){this._programs.pop(),this._useProgram(this._programs[this._programs.length-1])}},function(e,t,i){function n(e,t,i,n){this.textureBinder=e,this.frameBufferBinder=t,this.width=i,this.height=n,this.matrixStack=[[2,0,-1,0,0,-2,1,0,1,1,1,1,0,0,0,0]],this.scissor=null,this.texture=null}var o=i(400);o.prototype._createRenderTarget=function(e,t,i,o){return new n(e,t,i,o)},o.prototype._setScissor=function(e){var t=this.gl;null===e?t.disable(t.SCISSOR_TEST):(t.enable(t.SCISSOR_TEST),t.scissor(e[0],e[1],e[2],e[3]))},o.prototype.enableScissor=function(e,t,i,n){var o=[e,t,i,n];this._renderTarget.scissor=o,this._setScissor(o)},o.prototype.disableScissor=function(){var e=null;this._renderTarget.scissor=e,this._setScissor(e)},o.prototype.startTextureUsage=function(e,t,i,o,s){var a=this.gl;i=i||this.prerenderRatio,e*i>this._maxTextureSize&&(i=this._maxTextureSize/e),t*i>this._maxTextureSize&&(i=this._maxTextureSize/t),e=Math.ceil(e*i),t=Math.ceil(t*i);var r=a.createTexture(),l=a.createFramebuffer(),c=new n(r,l,e,t);a.bindTexture(a.TEXTURE_2D,r),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,e,t,0,a.RGBA,a.UNSIGNED_BYTE,null),this._setFiltering(c,s),a.bindFramebuffer(a.FRAMEBUFFER,l),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,r,0),a.bindFramebuffer(a.FRAMEBUFFER,this._renderTarget.frameBufferBinder);var d={binder:r,width:e,height:t};return c.texture=this.textureCache.addAndHoldElement(d,4*e*t,o),c},o.prototype._setRenderTarget=function(e,t){var i=this.gl;this._renderTarget=e,i.bindFramebuffer(i.FRAMEBUFFER,e.frameBufferBinder),i.viewport(0,0,e.width,e.height),this._setScissor(e.scissor),t&&i.clear(i.COLOR_BUFFER_BIT),this._matrixStack=e.matrixStack},o.prototype.startTextureRendering=function(e,t,i,n,o,s){this._renderTargetStack.push(e),this._setRenderTarget(e,s);var a=2/Math.max(i-t,1),r=2/Math.max(o-n,1),l=this._matrixStack[0];l[0]=a,l[4]=0,l[1]=0,l[5]=r,l[2]=-t*a-1,l[6]=-n*r-1,l[8]=1,l[9]=1,l[10]=1,l[11]=1,l[12]=0,l[13]=0,l[14]=0,l[15]=0},o.prototype.stopTextureRendering=function(e){var t=this._renderTargetStack.pop();this._setRenderTarget(this._renderTargetStack[this._renderTargetStack.length-1]),e&&this.gl.deleteFramebuffer(t.frameBufferBinder)},o.prototype._debugRenderTarget=function(){var e=this._renderTargetStack[this._renderTargetStack.length-1],t=e.width,i=e.height,n=this.gl,o=new Uint8Array(t*i*4);n.readPixels(0,0,t,i,n.RGBA,n.UNSIGNED_BYTE,o);for(var s=o.length,a=0,r=3;r<s;r+=4)a+=o[r];var l=document.createElement("canvas"),c=l.getContext("2d");l.width=t,l.height=i,document.body.appendChild(l),l.style.position="absolute",l.style.left="100px",l.style.top="100px";var d=c.getImageData(0,0,t,i),u=d.data;for(r=3;r<s;r+=4)u[r-3]=o[r-3],u[r-2]=o[r-2],u[r-1]=o[r-1],u[r-0]=o[r-0];c.putImageData(d,0,0),c.fillRect(t/2-5,i/2-5,10,10)}},function(e,t,i){var n=i(400);n.prototype.initBuffer=function(e){var t=this.gl,i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i);var n=new ArrayBuffer(e*this._spriteSize),o=new Float32Array(n),s=new Uint32Array(n);o[0]=0,o[1]=0,s[2]=0,o[5]=0,o[6]=1,s[7]=4294901760,o[10]=1,o[11]=1,s[12]=4294967295,o[15]=0,o[16]=0,s[17]=0,o[20]=1,o[21]=1,s[22]=4294967295,o[25]=1,o[26]=0,s[27]=65535,s[3]=s[8]=s[13]=s[18]=s[23]=s[28]=1077952576,s[4]=s[9]=s[14]=s[19]=s[24]=s[29]=0,t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)},n.prototype.updateGPUBuffer=function(e,t){var i=this.gl;i.bufferSubData(i.ARRAY_BUFFER,e,t)},n.prototype.isInBuffer=function(e){return this.sFMPartitioner.possess(e)},n.prototype.getBufferData=function(e){return this.sFMPartitioner.touch(e)},n.prototype.lockBuffer=function(e){return this.sFMPartitioner.addLock(e)},n.prototype.releaseBuffer=function(e){return this.sFMPartitioner.release(e)},n.prototype.unlockBuffer=function(e){this.sFMPartitioner.removeLock(e)}},function(e,t,i){function n(e){return 0===(e&e-1)}var o=i(400);o.prototype._setFiltering=function(e,t,i){var o=this.gl,s=o.LINEAR,a=o.LINEAR;switch(t){case"nearest":a=o.NEAREST;break;case"mipmap":n(e.width)&&n(e.height)?(s=o.LINEAR_MIPMAP_LINEAR,o.generateMipmap(o.TEXTURE_2D)):console.warn("[WebGLRenderer._setFiltering]","Cannot build mipmap from image",i," because its dimensions are not a power of 2.")}o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,s),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,a),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE)},o.prototype.holdTexture=function(e){return this.textureCache.holdElement(e)},o.prototype.useTexture=function(e){return this.textureCache.useElement(e)},o.prototype.createTexture=function(e,t,i,n){var o=this.textureCache.holdElement(t);if(o)return o;var s=this.gl,a=s.createTexture();s.bindTexture(s.TEXTURE_2D,a),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,e),this._setFiltering(e,i,t);var r={binder:a,width:e.width,height:e.height};return this.textureCache.addAndHoldElement(r,4*e.width*e.height,t,n)},o.prototype.getEmptyTexture=function(){return this.emptyTexture}},function(e,t,i){var n=i(400);n.prototype.save=function(){this._matrixStack.unshift(this._matrixStack[0].slice())},n.prototype.restore=function(){this._matrixStack.shift()},n.prototype.setTransform=function(e,t,i,n,o,s,a,r){var l=this._matrixStack[0];a=2/(a||this._width),r=-2/(r||this._height),l[0]=e*a,l[4]=t*r,l[1]=i*a,l[5]=n*r,l[2]=o*a-1,l[6]=s*r+1},n.prototype.rotate=function(e){if(0!==e){var t=this._matrixStack[0],i=Math.cos(e),n=Math.sin(e),o=t[0],s=t[4],a=t[1],r=t[5];t[0]=o*i+a*n,t[4]=s*i+r*n,t[1]=a*i-o*n,t[5]=r*i-s*n}},n.prototype.translate=function(e,t){var i=this._matrixStack[0];i[2]+=i[0]*e+i[1]*t,i[6]+=i[4]*e+i[5]*t},n.prototype.scale=function(e,t){var i=this._matrixStack[0];i[0]*=e,i[4]*=e,i[1]*=t,i[5]*=t},n.prototype.transform=function(e,t,i,n,o,s){var a=this._matrixStack[0],r=a[0],l=a[4],c=a[1],d=a[5],u=a[2],h=a[6];a[0]=r*e+c*t,a[4]=l*e+d*t,a[1]=r*i+c*n,a[5]=l*i+d*n,a[2]=r*o+c*s+u,a[6]=l*o+d*s+h},n.prototype.getTransform=function(){var e=this._matrixStack[0];return[e[0],e[4],e[1],e[5],e[2],e[6]]},n.prototype.setTint=function(e,t,i,n,o,s,a,r){var l=this._matrixStack[0];l[8]=e,l[9]=t,l[10]=i,l[11]=n,l[12]=o/255,l[13]=s/255,l[14]=a/255,l[15]=r/255},n.prototype.tint=function(e,t,i,n,o,s,a,r){var l=this._matrixStack[0],c=l[8],d=l[9],u=l[10],h=l[11];l[8]=e*c,l[9]=t*d,l[10]=i*u,l[11]=n*h,l[12]=o/255+l[12]*e,l[13]=s/255+l[13]*t,l[14]=a/255+l[14]*i,l[15]=r/255+l[15]*n},n.prototype.setTintMult=function(e,t,i,n){var o=this._matrixStack[0];o[8]=e,o[9]=t,o[10]=i,o[11]=n},n.prototype.setTintAdd=function(e,t,i,n){var o=this._matrixStack[0];o[12]=e/255,o[13]=t/255,o[14]=i/255,o[15]=n/255},n.prototype.multiplyColor=function(e,t,i,n){var o=this._matrixStack[0];o[8]*=e,o[9]*=t,o[10]*=i,o[11]*=n},n.prototype.addColor=function(e,t,i,n){var o=this._matrixStack[0];o[12]+=e*o[8]/255,o[13]+=t*o[9]/255,o[14]+=i*o[10]/255,o[15]+=n*o[11]/255}},function(e,t,i){function n(e,t,i,n){var o=n.vertexPos,s=n.textureCoord,a=n.color;e[i+0]=o[0],e[i+1]=o[1],t[i+2]=(65535*s[0]&65535)+(4294901760*s[1]&4294901760),e[i+5]=o[4],e[i+6]=o[5],t[i+7]=(65535*s[0]&65535)+(4294901760*s[3]&4294901760),e[i+10]=o[6],e[i+11]=o[7],t[i+12]=(65535*s[2]&65535)+(4294901760*s[3]&4294901760),e[i+15]=o[0],e[i+16]=o[1],t[i+17]=(65535*s[0]&65535)+(4294901760*s[1]&4294901760),e[i+20]=o[6],e[i+21]=o[7],t[i+22]=(65535*s[2]&65535)+(4294901760*s[3]&4294901760),e[i+25]=o[2],e[i+26]=o[3],t[i+27]=(65535*s[2]&65535)+(4294901760*s[1]&4294901760);var r=Math.max(-128,Math.min(127,64*a[0])),l=Math.max(-128,Math.min(127,64*a[1])),c=Math.max(-128,Math.min(127,64*a[2])),d=Math.max(-128,Math.min(127,64*a[3])),u=Math.max(-128,Math.min(127,128*a[4])),h=Math.max(-128,Math.min(127,128*a[5])),p=Math.max(-128,Math.min(127,128*a[6])),m=Math.max(-128,Math.min(127,128*a[7])),f=(d<<24&4278190080)+(c<<16&16711680)+(l<<8&65280)+(255&r),g=(m<<24&4278190080)+(p<<16&16711680)+(h<<8&65280)+(255&u);t[i+3]=t[i+8]=t[i+13]=f,t[i+18]=t[i+23]=t[i+28]=f,t[i+4]=t[i+9]=t[i+14]=g,t[i+19]=t[i+24]=t[i+29]=g}function o(e,t,i,n){this.nBytes=t,this.drawMode=i,this.texture=n||null,this.startingByte=e}function s(e,t,i){this.bbox=t,this.prerender=i,this.spriteBatches=e}var a=i(400);a.prototype.prepareBatchFromSpriteList=function(e,t,i){i=!!i;for(var a=t.spriteBatch,r=a.length-1,l=t.nbSprites*this._spriteSize,c=this.sFMPartitioner.reserve(e,l),d=c.start,u=d,h=d,p=new ArrayBuffer(l),m=new Float32Array(p),f=new Uint32Array(p),g=this._spriteSize/4,_=0,v=[],y=0;y<=r;y+=1){var b=a[y];if(b.isMaskTag)i=!0,v.push(b);else{n(m,f,_*g,b),h+=this._spriteSize,_+=1;var M=a[y+1];(y===r||b.texture!==M.texture||M.isMaskTag)&&(v.push(new o(u,h-u,this._drawModes.triangles,b.texture)),u=h)}}this.updateGPUBuffer(d,m),c.obj=new s(v,t.bbox,i)},a.prototype.loadSpriteBuffer=function(e,t,i,n,o){this._loadVertexBuffer(e,t,i,n,this._drawModes.triangles,o)},a.prototype.loadLineBuffer=function(e,t,i,n){this._loadVertexBuffer(e,t,null,i,this._drawModes.lines,n)},a.prototype._loadVertexBuffer=function(e,t,i,n,a,r){var l=t.byteLength,c=this.sFMPartitioner.reserve(e,l),d=c.start,u=new o(d,l,a,i);c.obj=new s([u],n,r),this.updateGPUBuffer(d,t)},a.prototype.updateVertexBuffer=function(e,t,i,n){var o=this.sFMPartitioner.getChunk(e);if(void 0===o)return void console.warn("[WebGLRenderer.updateVertexBuffer] No buffer loaded for",e);var s=o.start;this.updateGPUBuffer(s+i,t,n)},a.prototype.drawLineBatch=function(e,t){this.useProgram(this._programLine),this.gl.lineWidth(t);var i=this.sFMPartitioner.touch(e);return void 0===i?(console.warn("[WebGLRenderer.drawLineBatch] No buffer loaded for",e),void this.stopProgram()):(this._drawBatch(i),void this.stopProgram())},a.prototype.drawBoxBatch=function(e){this.useProgram(this._programBox);var t=this.sFMPartitioner.touch(e);return void 0===t?(console.warn("[WebGLRenderer.drawBoxBatch] No buffer loaded for",e),void this.stopProgram()):(this._drawBatch(t),void this.stopProgram())},a.prototype.drawSpriteBatchAbsoluteScale=function(e,t){this.useProgram(this._programAbsoluteScale);var i=this._matrixStack[0];i[3]=t/this._renderTarget.width,i[7]=t/this._renderTarget.height,this.drawSpriteBatch(e),this.stopProgram()},a.prototype.drawSpriteBatch=function(e){var t=this.sFMPartitioner.touch(e);if(void 0===t)return void console.warn("[WebGLRenderer.drawSpriteBatch] No buffer loaded for",e);if(t.prerender){var i=this.textureCache.holdElement(e),n=t.bbox;if(void 0===i){var o=n[0],s=n[1],a=n[2],r=n[3],l=this._matrixStack[0],c=this._renderTarget.width*l[0]/2,d=this._renderTarget.width*l[4]/2,u=this._renderTarget.height*l[1]/2,h=this._renderTarget.height*l[5]/2,p=Math.sqrt(Math.max(c*c+d*d,u*u+h*h))*this.prerenderRatio,m=this.startTextureUsage(s-o,r-a,p,e,"nearest");this.startTextureRendering(m,o,s,a,r),this._drawBatch(t),this.stopTextureRendering(!0,!0),i=m.texture}this.drawImage(i,n[0],n[2],n[1]-n[0],n[3]-n[2]),i.release()}else this._drawBatch(t)},a.prototype.handleMaskTag=function(e,t,i){if(e.isMaskDef){var n=t[0],o=t[1],s=t[2],a=t[3],r=this.startTextureUsage(o-n,a-s,this.maskQuality);return this.startTextureRendering(r,n,o,s,a),void i.push(r)}var l=this.gl;return e.isMaskUse?(this.useProgram(this._programMask,{mask:this._renderTarget.textureBinder}),l.uniform4fv(this._currentProgram.uniforms.uBbox,t),void this.stopTextureRendering(!0,!0)):e.isMaskStop?(i.pop().texture.release(),void this.stopProgram()):void 0},a.prototype._drawBatch=function(e){for(var t=e.spriteBatches,i=null,n=0;n<t.length;n+=1){var o=t[n];if(o.isMaskTag)null===i&&(i=[]),this.handleMaskTag(o,e.bbox,i);else{var s=o.startingByte/this._vertexSize,a=o.nBytes/this._vertexSize;this._drawSubBatch(s,a,o.texture,o.drawMode)}}},a.prototype.drawSpriteSubBatch=function(e,t,i){var n=this.sFMPartitioner.touch(e);if(void 0===n)return void console.warn("[WebGLRenderer.drawSpriteSubBatch] No buffer loaded for",e);var o=n.spriteBatches[0],s=o.startingByte/this._vertexSize+t,a=i-t;this._drawSubBatch(s,a,o.texture,o.drawMode)},a.prototype._drawSubBatch=function(e,t,i,n){if(!(t<=0)){var o=this.gl;if(null!==i){var s=this.textureCache.useElement(i.id);if(void 0===s)return void console.warn("[WebGLRenderer._drawSubBatch] Texture not loaded:",i.id);o.bindTexture(o.TEXTURE_2D,s.element.binder)}o.uniformMatrix4fv(this._currentProgram.uniforms.uMatrix,!1,this._matrixStack[0]),o.drawArrays(n,e,t)}}},function(e,t){e.exports={DIRECTION_EAST:0,DIRECTION_SOUTH_EAST:1,DIRECTION_SOUTH:2,DIRECTION_SOUTH_WEST:3,DIRECTION_WEST:4,DIRECTION_NORTH_WEST:5,DIRECTION_NORTH:6,DIRECTION_NORTH_EAST:7}},function(e,t){function i(){this._type=null,this.alive=!0,this.teamId=0,this.isCarryied=!1,this.disposition={cellId:-1,direction:0,carryingCharacterId:0},this.look=null,this.stats={actionPoints:0,airElementReduction:0,airElementResistPercent:0,baseMaxLifePoints:0,criticalDamageFixedResist:0,dodgePALostProbability:0,dodgePMLostProbability:0,earthElementReduction:0,earthElementResistPercent:0,fireElementReduction:0,fireElementResistPercent:0,invisibilityState:0,initiative:0,lifePoints:0,maxActionPoints:0,maxLifePoints:0,maxMovementPoints:0,movementPoints:0,neutralElementReduction:0,neutralElementResistPercent:0,permanentDamagePercent:0,pushDamageFixedResist:0,shieldPoints:0,summoned:!1,summoner:0,tackleBlock:0,tackleEvade:0,waterElementReduction:0,waterElementResistPercent:0}}function n(e,t){for(var i in e)void 0!==t[i]&&(e[i]=t[i])}e.exports=i,i.prototype.updateData=function(e){void 0!==e._type&&(this._type=e._type),void 0!==e.alive&&(this.alive=e.alive),void 0!==e.teamId&&(this.teamId=e.teamId),e.disposition&&n(this.disposition,e.disposition),e.look&&(this.look=e.look),e.stats&&n(this.stats,e.stats)},i.prototype.pointVariation=function(e,t){this.stats[e]+=t,this.stats[e]<0&&(this.stats[e]=0)}},function(e,t,i){function n(e){T.preloadImage("ui/SpellPlaceholder.png",function(e){t.placeHolder=e}),S([I],null,function(t,i){return t?e(t):(_=i,void e())})}function o(e,t){return e?console.error(e):void console.log("data:",t)}function s(){return++L}function a(){this._uid=s()}function r(e,t,i){var n=this;this.id=parseInt(e,10),this.ownerId=null,this.position=null,this.isItem=!1,this.level=null,this.isLoaded=!1,this.spell=null,this._tables={},S(e,t,function(e,t){return e?i(e):(n.effectInstances=t.effectInstances,delete t.effectInstances,n._tables=t,n.spell=t.spells[n.id],n.spell?(n.setLevel(n.level||1),n.isLoaded=!0,void i()):i("missing static data for spell id "+n.id))})}function l(e,t){this.id=I,this.ownerId=null,this.position=null,this.isItem=!0,this.level=1,this.isLoaded=!1,this._item=e,this.effectInstances={};for(var i=0;i<this._item.effects.length;i++)this.effectInstances[this.getSpellLevelId()+"-effects-"+i]=this._item.effects[i];if(!e.isInitialised){var n=this;return e.once("initialised",function(){l.call(n,e,t)})}this.isLoaded=!0,window.gui.shortcutBar.updateSpellAvailability(this.id),t&&t()}function c(){this.castingData={lastCastTurn:0,targetsThisTurn:{},castThisTurn:0,lastInitialCooldownReset:0}}function d(e,t){e instanceof Array||(e=[e]),S(e,function(i,n){if(i)return t(i);var o={};v.each(e,function(e,t){if(o[e]=new a,~~e===I){var i=window.gui.playerData.inventory.getCurrentWeapon();if(i)return l.call(o[e],i,t)}r.call(o[e],e,n,t)},function(e){return e?t(e):void t(null,o)})})}function u(e,t,i){return t&&t.spells?i(null,M.extractElementsFrom(e,t.spells,!0)):void w.getData("Spells",e,function(t,n){return t?i(t):void i(null,M.extractElementsFrom(e,n,!0))})}function h(e,t,i){var n={};for(var o in e.spells)for(var s=e.spells[o],a=0;a<s.spellLevels.length;a++)n[s.spellLevels[a]]=!0;return n=Object.keys(n),0===n.length?i(null,{}):t&&t.spellLevels?i(null,M.extractElementsFrom(n,t.spellLevels,!0)):void w.getData("SpellLevels",n,function(e,t){return e?i(e):void i(null,M.extractElementsFrom(n,t,!0))})}function p(e,t,i){var n={};for(var o in e.spellLevels){var s,a=e.spellLevels[o];for(s=0;s<a.statesRequired.length;s++)n[a.statesRequired[s]]=!0;for(s=0;s<a.statesForbidden.length;s++)n[a.statesForbidden[s]]=!0}return n=Object.keys(n),0===n.length?i(null,{}):t&&t.spellStates?i(null,M.extractElementsFrom(n,t.spellStates,!0)):void w.getData("SpellStates",n,function(e,t){return e?i(e):void i(null,M.extractElementsFrom(n,t,!0))})}function m(e,t,i){var n,o,s={},a={},r=["effects","criticalEffect"];for(var l in e.spellLevels)if(e.spellLevels.hasOwnProperty(l))for(var c=e.spellLevels[l],d=0;d<r.length;d++){var u=r[d];for(o=0;o<c[u].length;o++)n=l+"-"+u+"-"+o,t&&t.effectInstances&&t.effectInstances[n]?a[n]=t.effectInstances[n]:s[n]=c[u][o]}return 0===Object.keys(s).length?i(null,a):void y.createEffectInstancesIndexed(s,function(e,t){if(e)return i(e);if(0===Object.keys(a).length)return i(null,t);for(var n in a)a.hasOwnProperty(n)&&(t[n]=a[n]);i(null,t)})}function f(e,t,i){function n(e,i){var n=e.getProperty(t),o=i.getProperty(t);return n>o?-a:n<o?a:e.id>i.id?-a:void 0}var o=Array.isArray(e)?e:[];if(!o.length)for(var s in e)o.push(e[s]);var a=i?1:-1;return o.sort(n)}function g(e,t){for(var i in t)if(t.hasOwnProperty(i)){e[i]||(e[i]={});for(var n in t[i])t[i].hasOwnProperty(n)&&(e[i][n]=t[i][n])}}var _,v=i(31),y=i(355),b=i(358),M=i(339),w=i(30),T=i(182),C=i(167),A=i(413),I=t.WEAPON_SPELL_ID=0;t.placeHolder=C.MISSING_TEXTURE_IMAGE_SRC;var S,E,x,N,L=0;a.prototype.setLevel=function(e){return this.isItem?void(1!==e&&console.warn("Spell#setLevel called on item with level != 1",e)):(this.level=e,!e||e<1||e>this.spell.spellLevels.length?console.error(new Error("invalid level "+e+" for spell #"+this.id)):void(this.spellLevel=this._getSpellLevelByLevel(this.level)))},a.prototype.setPosition=function(e){this.position=e},a.prototype._getSpellLevelByLevel=function(e){return this.isItem?console.error(new Error("Spell#_getSpellLevelByLevel called on item for Spell id "+this.id)):this._tables.spellLevels[this.spell.spellLevels[e-1]]},a.prototype.getSpellLevelId=function(e){return this.isItem?"weapon":(e=void 0!==e?e:this.level,this._getSpellLevelByLevel(e).id)},a.prototype.getZoneEffect=function(){for(var e,t=63,i=this.id===I&&window.gui.playerData.inventory.getCurrentWeapon(),n=i?this._item.effects:this.spellLevel.effects,o=0;o<n.length;o++){var s=this.effectInstances[this.getSpellLevelId()+"-effects-"+o].getZoneEffect();s.zoneShape&&s.zoneSize>0&&s.zoneSize<t&&(t=s.zoneSize,e=s)}return e||y.parseZone("P")},a.prototype.getZoneEffectWhenCasting=function(){for(var e,t=this.id===I&&window.gui.playerData.inventory.getCurrentWeapon(),i=t?this._item.effects:this.spellLevel.effects,n=0;n<i.length;n++){var o=this.effectInstances[this.getSpellLevelId()+"-effects-"+n].getZoneEffect();o.zoneShape&&o.zoneSize>0&&(e=o)}return e||y.parseZone("P")},a.prototype.getHumanReadableZoneInfo=function(){return y.getHumanReadableZoneInfo(this.getZoneEffect())},a.prototype.getMaxLevel=function(){return this.isItem||this.id===I?1:this.spell.spellLevels.length},a.prototype.getHumanReadableSpellType=function(){return window.gui.databases.SpellTypes[this.getProperty("typeId")].longNameId},a.prototype.getEffectsIds=function(e){return this.isItem?Object.keys(this.effectInstances):this._getSpellLevelByLevel(e||this.level).effects},a.prototype.getCriticalEffectsIds=function(e){return this.isItem?[]:this._getSpellLevelByLevel(e||this.level).criticalEffect},a.prototype.getUpgradeCost=function(e,t){if(this.isItem)return null;void 0===t&&void 0===e?(e=this.level,t=e+1):void 0===t&&(t=e,e=this.level);for(var i=0,n=0,o=1;o<=e;o+=1)n+=o-1,i+=o-1;for(;o<=t;o+=1)i+=o-1;return i-n},a.prototype.getName=function(){return this.getProperty("nameId")},a.prototype.getProperty=function(e,t){t=t||this.level;var i=this.isItem?x.call(this,e):N.call(this,e,t);if("range"===e){var n=window.gui.playerData.characters.getControlledCharacter().characteristics;if(!n)return i;var o=n.range,s=this.isItem?x.call(this,"rangeCanBeBoosted"):N.call(this,"rangeCanBeBoosted",t);if(s){var a=this.isItem?x.call(this,"minRange"):N.call(this,"minRange",t),r=o.base+o.objectsAndMountBonus+o.alignGiftBonus+o.contextModif;i+r<a?i=a:i+=r}}return i},N=function(e,t){var i,n,o=this._getSpellLevelByLevel(t),s=window.gui.playerData.characters.getSpellModifications;switch(e){case"id":case"nameId":case"descriptionId":case"typeId":case"iconId":case"scriptParams":case"scriptParamsCritical":case"scriptId":case"scriptIdCritical":case"spellLevels":case"useParamCache":return this.spell[e];case"minCastInterval":if(i=s(this.ownerId,this.id,b.CAST_INTERVAL),!i)return o[e];n=i.value;var a=n.contextModif+n.objectsAndMountBonus+n.base+n.alignGiftBonus;return o[e]-a;case"apCost":if(i=s(this.ownerId,this.id,b.AP_COST),!i)return o[e];n=i.value;var r=n.contextModif+n.objectsAndMountBonus+n.base+n.alignGiftBonus;return o[e]-r;case"maxCastPerTurn":return i=s(this.ownerId,this.id,b.MAX_CAST_PER_TURN),i?o[e]+i.value.contextModif+i.value.objectsAndMountBonus:o[e];case"range":return i=s(this.ownerId,this.id,b.RANGE),i?o[e]+i.value.contextModif+i.value.objectsAndMountBonus:o[e];case"maxCastPerTarget":return i=s(this.ownerId,this.id,b.MAX_CAST_PER_TARGET),i?o[e]+i.value.contextModif+i.value.objectsAndMountBonus:o[e];case"castInLine":return(i=s(this.ownerId,this.id,b.CAST_LINE))?!!o[e]&&(n=i.value,n.contextModif+n.objectsAndMountBonus+n.base+n.alignGiftBonus===0):o[e];case"castTestLos":return(i=s(this.ownerId,this.id,b.LOS))?!!o[e]&&(n=i.value,n.contextModif+n.objectsAndMountBonus+n.base+n.alignGiftBonus===0):o[e];case"rangeCanBeBoosted":return i=s(this.ownerId,this.id,b.RANGEABLE),!i||o[e]?o[e]:(n=i.value,n.contextModif+n.objectsAndMountBonus+n.base+n.alignGiftBonus>0);case"maxStack":case"castInDiagonal":case"criticalFailureProbability":case"spellBreed":case"needFreeCell":case"needTakenCell":case"criticalFailureEndsTurn":case"globalCooldown":case"statesRequired":case"statesForbidden":case"minRange":case"minPlayerLevel":case"canSummon":case"canBomb":return o[e];case"spellLevel":return o;case"grade":return o[e]||t;case"isSpellWeapon":return this.id===I;case"isDefaultSpellWeapon":return this.id===I&&!window.gui.playerData.inventory.getCurrentWeapon();case"criticalHitProbability":return E.call(this);default:return null}},x=function(e){var t=this._item.item;if(!t)return console.error(new Error("SpellFactory getPropertyFromItem: item is not ready yet")),null;switch(e){case"nameId":case"descriptionId":case"apCost":case"criticalFailureProbability":case"criticalHitProbability":case"range":case"castInLine":case"castInDiagonal":case"castTestLos":case"minRange":case"maxCastPerTurn":return t[e];case"iconId":return this._item.getProperty("iconId");case"id":case"minCastInterval":case"minPlayerLevel":case"maxStack":case"maxCastPerTarget":case"scriptId":
case"scriptIdCritical":case"spellBreed":return 0;case"grade":return 1;case"typeId":return 24;case"useParamCache":case"needTakenCell":case"rangeCanBeBoosted":case"isDefaultSpellWeapon":case"needFreeCell":return!1;case"criticalFailureEndsTurn":case"isSpellWeapon":return!0;case"scriptParams":case"scriptParamsCritical":case"spellLevels":return null;default:return null}},E=function(){var e=window.gui.playerData.characters.getSpellModifications,t=e(this.ownerId,this.id,b.CRITICAL_HIT_BONUS);if(!t)return this.spellLevel.criticalHitProbability;var i=t.value;return i.contextModif+i.objectsAndMountBonus+i.alignGiftBonus+i.base},a.prototype.getIconUri=function(){var e=this.isItem?"/gfx/items/":"/gfx/spells/sort_";return e+this.getProperty("iconId")+".png"},a.prototype.getIconUrl=function(){return this.isItem?this._item.item&&this._item.getProperty("image"):this.spell&&this.spell.image},a.prototype.update=function(e){if(this.id!==I)return e();var t=window.gui.playerData.inventory.getCurrentWeapon();return t?l.call(this,t,e):r.call(this,0,null,e)},a.prototype.clone=function(){var e=new a;for(var t in this)this.hasOwnProperty(t)&&"_uid"!==t&&"castingData"!==t&&(e[t]=this[t]);return e.setLevel(1),e},a.prototype.cast=function(e,t,i){t=t||[],c.call(this),i=i!==!1,this.castingData.lastCastTurn=e;for(var n=0;n<t.length;n++){var o=t[n];this.castingData.targetsThisTurn[o]||(this.castingData.targetsThisTurn[o]=0),this.castingData.targetsThisTurn[o]++}i&&this.castingData.castThisTurn++,window.gui.shortcutBar.updateSpellAvailability(this.id)},a.prototype.newTurn=function(){this.castingData||(console.warn('You should not call "newTurn" on a spell that has not been casted'),c.call(this)),this.castingData.castThisTurn=0,this.castingData.targetsThisTurn={}},a.prototype.getModifiedInterval=function(){if(this.isItem)return 0;for(var e=new A,t=window.gui.playerData.characters.mainCharacter.characteristics.spellModifications,i=0;i<t.length;i++){var n=t[i];if(n.spellId===this.id){var o=n.modificationType;o===b.CAST_INTERVAL?e.castInterval=n.value:o===b.CAST_INTERVAL_SET&&(e.castIntervalSet=n.value)}}var s,a=e.getTotalBonus(e.castInterval),r=e.getTotalBonus(e.castIntervalSet);return s=r?r-a:this.spellLevel.minCastInterval-a},a.prototype.getCooldown=function(){if(!this.castingData||this.isItem)return 0;var e=this.getModifiedInterval();if(63===e)return 63;var t;return t=0===this.spellLevel.initialCooldown||this.castingData.lastCastTurn>=this.castingData.lastInitialCooldownReset+this.spellLevel.initialCooldown?e+this.castingData.lastCastTurn-window.gui.fightManager.turnCount:this.castingData.lastInitialCooldownReset+this.spellLevel.initialCooldown-window.gui.fightManager.turnCount,t=Math.max(0,t)},a.prototype.resetInitialCooldown=function(e){this.castingData||c.call(this),this.castingData.lastInitialCooldownReset=e},a.prototype.forceCooldown=function(e){this.castingData||(console.warn('You should not call "forceCooldown" on a spell that has not been casted'),c.call(this));var t=this.isItem?0:this.spellLevel.minCastInterval;this.castingData.lastCastTurn=e+window.gui.fightManager.turnCount-t},a.prototype.forceLastCastTurn=function(e){this.castingData||(console.warn('You should not call "forceLastCastTurn" on a spell that has not been casted'),c.call(this)),this.castingData.lastCastTurn=e},a.prototype.hasBeenCast=function(){return!!this.castingData},S=function(e,t,i){if("function"!=typeof t||i||(i=t,t=null),i=i||o,e instanceof Array||(e=[e]),e=e.filter(function(e){return!isNaN(e)}),0===e.length)return i(new Error("No valid spell id"));e.indexOf(I)!==-1&&(t||(t={}),g(t,_));var n={};u(e,t,function(e,o){return e?i(e):(n.spells=o,void h(n,t,function(e,o){return e?i(e):(n.spellLevels=o,void p(n,t,function(e,o){return e?i(e):(n.spellStates=o,void m(n,t,function(e,t){return e?i(e):(n.effectInstances=t,void i(null,n))}))}))}))})},t.initialize=n,t.createSpells=d,t.sortSpells=f},function(e,t,i){function n(){this._type="SpellModificator",this.apCost=new o,this.castInterval=new o,this.castIntervalSet=new o,this.maxCastPerTurn=new o,this.maxCastPerTarget=new o}var o=i(360);e.exports=n,n.prototype.getTotalBonus=function(e){return e?e.alignGiftBonus+e.base+e.contextModif+e.objectsAndMountBonus:0}},function(e,t,i){function n(e,t){e.apply(null,t)}function o(e,t,i,n,o,s){void 0===o&&(o=!0),void 0===s&&(s=!0);var a=window.gui.fightManager.getFighter(t);if(!a)return console.error("Movement points variation step failed, fighter does not exist");if(o&&(a.data.stats.movementPoints+=i,window.gui.playerData.characters.controlledCharacterId===t)){var r=window.gui.playerData.characters.getControlledCharacter();r.setCharacteristic("movementPointsCurrent",a.data.stats.movementPoints)}s&&(i>0?q.push(k.FIGHTER_MP_GAINED,[t,i],t,e,!1,2):i<0&&(n?q.push(k.FIGHTER_MP_USED,[t,Math.abs(i)],t,e,!1,2):q.push(k.FIGHTER_MP_LOST,[t,Math.abs(i)],t,e,!1,2)))}function s(e,t,i,n,o,s){void 0===o&&(o=!0),void 0===s&&(s=!0);var a=window.gui.fightManager.getFighter(t);if(!a)return console.error("Action points variation step failed, fighter does not exist");if(o&&(a.data.stats.actionPoints+=i,window.gui.playerData.characters.controlledCharacterId===t&&!n)){var r=window.gui.playerData.characters.getControlledCharacter();r.setCharacteristic("actionPointsCurrent",r.characteristics.actionPointsCurrent+i)}s&&(i>0?q.push(k.FIGHTER_AP_GAINED,[t,i],t,e,!1,2):i<0&&(n?q.push(k.FIGHTER_AP_USED,[t,Math.abs(i)],t,e,!1,2):q.push(k.FIGHTER_AP_LOST,[t,Math.abs(i)],t,e,!1,2)))}function a(e,t,i){q.push(k.FIGHTER_LEAVING_STATE,[t,i],t,-1)}function r(e,t,i,n){q.push(k.FIGHTER_ENTERING_STATE,[t,i,n],t,-1)}function l(e,t,i,n,o){q.push(k.FIGHTER_TEMPORARY_BOOSTED,[t,i,n,o],t,e,!1,2)}function c(e,t){var i=window.gui.fightManager.getFighter(t.targetId);return i?t.actionId===F.ACTION_CHARACTER_UPDATE_BOOST?i.updateBuff(t):(i.addBuff(t),void(t instanceof H.StatBuff&&("movementPoints"===t.statName?o(e,t.targetId,t.getDelta(),!1,!1,!1):"actionPoints"===t.statName&&s(e,t.targetId,t.getDelta(),!1,!1,!1)))):console.error("Display buff step failed, fighter does not exist")}function d(e,t,i){var n=window.gui.fightManager;n.emit("updateSpellsAvailability");var o=i.contextualId,s=n.deadTurnsList.indexOf(o);s!==-1&&n.deadTurnsList.splice(s,1);var a=window.gui.playerData;if(o===a.id){var r=a.characters.mainCharacter;n.prepareSpellsWithInitialCooldown(r),r.setCharacteristic("lifePoints",i.stats.lifePoints)}n.emit(k.FIGHTER_SUMMONED,[t,o],o,e)}function u(e,t,i,n){var o=window.gui.fightManager,s=window.gui.playerData;t===s.characters.controlledCharacterId&&o.getFighterSpell(i,t,function(e,t){return e?console.error(e):(t.castingData||t.cast(o.turnCount,[],!1),t.forceCooldown(n),void window.gui.shortcutBar.updateSpellAvailability(i))})}function h(e,t,i,n){var o=window.gui.fightManager;o.incrementDuration(i,n,!0,o.INCREMENT_MODE_TARGET),q.push(k.FIGHTER_EFFECTS_MODIFY_DURATION,[i,t,n],i,e)}function p(e,t,i,n,o){var s=window.gui.fightManager,a=s.getFighter(t),r=s.getFighter(n);return a&&r?(a.data.disposition.cellId=i,r.data.disposition.cellId=o,void s.emit(k.FIGHTERS_POSITION_EXCHANGE,[t,n],0,e)):console.error("Exchange position step failed, fighters do not exist")}function m(e,t,i){var n=window.gui.fightManager,o=n.getFighter(t);return o?(o.data.disposition.cellId=i,void n.emit(k.FIGHTER_SLIDE,[t],t,e)):console.error("Slide step failed, fighter does not exist")}function f(e,t,i){var n=window.gui.fightManager,o=n.getFighter(t);return o?(o.data.disposition.cellId=i,void n.emit(k.FIGHTER_TELEPORTED,[t],0,e)):console.error("Teleport step failed, fighter does not exist")}function g(e,t,i){var n=window.gui.fightManager.getFighter(t);return n?void(n.data.disposition.cellId=i):console.error("Map movement step failed, fighter does not exist")}function _(e,t,i){window.gui.fightManager.emit(k.FIGHTER_CARRY,[t,i],0,e)}function v(e,t,i,n){var o=window.gui.fightManager;if(n!==-1){var s=o.getFighter(i);if(!s)return console.error("Throw character step failed, fighter does not exist");s.data.disposition.cellId=n}o.emit(k.FIGHTER_THROW,[t,i,n],0,e)}function y(e,t,i,n){var o=window.gui.fightManager.getFighter(t);if(!o)return console.error("Fighter "+t+" does not exist.");var s=o.data.stats.shieldPoints+i;o.setShield(s),i<0?q.push(k.FIGHTER_SHIELD_LOSS,[t,Math.abs(i),n],t,e):i>0?q.push(k.FIGHTER_SHIELD_GAIN,[t,i],t,e):q.push(k.FIGHTER_NO_CHANGE,[t],t,e)}function b(e,t,i,n,o){var s=window.gui.fightManager,a=s.getFighter(t);if(!a)return console.error("Fighter "+t+" does not exist.");var r=a.data.stats;r.maxLifePoints=Math.max(1,r.maxLifePoints+n);var l=Math.min(Math.max(0,r.lifePoints+i),r.maxLifePoints);a.setHP(l),i<=0?q.push(k.FIGHTER_LIFE_LOSS,[t,Math.abs(i),o],t,e,!1,2):i>0&&q.push(k.FIGHTER_LIFE_GAIN,[t,i,o],t,e,!1,2)}function M(e,t,i){q.push(k.FIGHTER_REDUCED_DAMAGES,[t,i],t,e)}function w(e,t,i){q.push(k.FIGHTER_AP_LOSS_DODGED,[t,i],t,e)}function T(e,t,i){q.push(k.FIGHTER_MP_LOSS_DODGED,[t,i],t,e)}function C(e,t){q.push(k.FIGHTER_SPELL_IMMUNITY,[t],0,e)}function A(e,t,i){var n=window.gui.fightManager.getFighter(t);if(!n)return console.error("Fighter "+t+" does not exist.");var o=n.getBuff(i);o&&o instanceof H.StateBuff&&(952===o.actionId?r(-1,o.targetId,o.stateId,o.effect.getDurationString()):a(-1,o.targetId,o.stateId)),n.dispelUniqueBuff(i,!0,!1,!0)}function I(e,t,i){var n=window.gui.fightManager.getFighter(t);return n?(n.dispelSpell(i,!0),void q.push(k.FIGHTER_SPELL_DISPELLED,[t,i],t,e)):console.error("Fighter "+t+" does not exist.")}function S(e,t){var i=window.gui.fightManager.getFighter(t);return i?(i.dispel(),void q.push(k.FIGHTER_GOT_DISPELLED,[t],t,e)):console.error("Fighter "+t+" does not exist.")}function E(e,t){q.push(k.FIGHTER_REFLECTED_SPELL,[t],t,e)}function x(e,t){q.push(k.FIGHTER_REFLECTED_DAMAGES,[t],t,e)}function N(e,t){q.push(k.FIGHTER_GOT_TACKLED,[t],0,e)}function L(e,t,i){q.push(k.FIGHTER_GOT_KILLED,[i,t],t,e)}function O(e,t,i){var n=window.gui.fightManager.getFighter(t);if(!n)return console.error("Fighter "+t+" does not exist.");var o,s=n.data.stats.invisibilityState;i!==z.VISIBLE&&s===z.VISIBLE?o=z.INVISIBLE:i===z.VISIBLE&&s!==z.VISIBLE&&(o=z.VISIBLE),o&&q.push(k.FIGHTER_VISIBILITY_CHANGED,[t,o],t,e),n.data.stats.invisibilityState=i}function D(e,t,i,n){q.push(k.FIGHTER_TRIGGERED_GLYPH,[t,i,n],0,e)}function R(e,t,i,n){q.send(k.FIGHTER_CLOSE_COMBAT,[t,i,n],t,e)}function P(e,t,i,n){q.push(k.FIGHTER_CASTED_SPELL,[t,i,n],0,e)}function B(e,t,i){void 0===i&&(i=!0);var n=window.gui.fightManager,o=n.getFighter(t);return o?(n.deadTurnsList.push(t),o.dispel(!1,!1,!0),n.removeLinkedBuff(t,!1,!0),n.reaffectBuffs(t),o.setAlive(!1),void q.push(i?k.FIGHTER_DEATH:k.FIGHTER_LEAVE,[t],t,e)):console.error("Fighter "+t+" does not exist.")}var k=i(348),z=i(364),F=i(353),H=i(350),q=i(363);t.pushStep=n,t.fightMovementPointsVariationStep=o,t.fightActionPointsVariationStep=s,t.fightLeavingStateStep=a,t.fightEnteringStateStep=r,t.fightTemporaryBoostStep=l,t.fightDisplayBuffStep=c,t.fightSummonStep=d,t.fightSpellCooldownVariationStep=u,t.fightModifyEffectsDurationStep=h,t.fightExchangePositionsStep=p,t.fightSlideStep=m,t.fightTeleportOnSameMapStep=f,t.mapMovementStep=g,t.fightCarryCharacterStep=_,t.fightThrowCharacterStep=v,t.fightShieldPointsVariationStep=y,t.fightLifePointsVariationStep=b,t.fightReduceDamages=M,t.fightActionPointsLossDodge=w,t.fightMovementPointsLossDodge=T,t.fightSpellImmunity=C,t.fightDispelEffectStep=A,t.fightDispelSpellStep=I,t.fightDispelStep=S,t.fightReflectSpellStep=E,t.fightReflectDamagesStep=x,t.fightTackledStep=N,t.fightKillStep=L,t.fightInvisibilityStep=O,t.fightTriggerGlyphTrapStep=D,t.fightCloseCombatStep=R,t.fightSpellCastStep=P,t.fightDeathStep=B},function(e,t,i){function n(){o.call(this),this.characteristics=null,this.spellShortcuts=[],this.spellData=new a,this.currentSummonedCreature=0,this.currentSummonedBomb=0,this.timeStatsSynchronized=0}var o=i(188).EventEmitter,s=i(172).inherits,a=i(416),r={actionPointsCurrent:!0,alignmentInfos:!0,lifePoints:!0,maxLifePoints:!0,movementPointsCurrent:!0,spellsPoints:!0};s(n,o),e.exports=n,n.prototype.disconnect=function(){this.characteristics=null,this.spellShortcuts=null,this.spellData.disconnect(),this.currentSummonedCreature=0,this.currentSummonedBomb=0},n.prototype.setCharacteristics=function(e){this.characteristics=e;var t=window.gui.playerData.characters.getControlledCharacter()===this;t&&this.emitCharacteristicsUpdate(),this.timeStatsSynchronized=Date.now()},n.prototype.emitCharacteristicsUpdate=function(){var e=window.gui.playerData;for(var t in r)void 0!==this.characteristics[t]?e.emit(t+"Updated",this.characteristics[t]):console.error("No characteristic named: "+t)},n.prototype.setCharacteristic=function(e,t){if(void 0===this.characteristics[e])return void console.error("No characteristic named: "+e);this.characteristics[e]=t;var i=window.gui.playerData.characters.getControlledCharacter()===this;i&&r[e]&&window.gui.playerData.emit(e+"Updated",t)},n.prototype.setCharacterId=function(e){this.spellData.characterId=e},n.prototype.getMaxSummonedCreature=function(){return this.characteristics.summonableCreaturesBoost.base+this.characteristics.summonableCreaturesBoost.objectsAndMountBonus+this.characteristics.summonableCreaturesBoost.alignGiftBonus+this.characteristics.summonableCreaturesBoost.contextModif},n.prototype.setSpellShortcuts=function(e){this.spellShortcuts=[];for(var t=0;t<e.length;t++)this.spellShortcuts.push(e[t])},n.prototype.updateSpellShortcut=function(e){for(var t=0;t<this.spellShortcuts.length;t++)if(this.spellShortcuts[t].slotIndex===e.slotIndex)return void(this.spellShortcuts[t]=e);this.spellShortcuts.push(e)},n.SpellData=a},function(e,t,i){function n(){o.call(this),this.spells={},this.characterId=null,this.isLoaded=!1,this._requestsPendingCount=0,this._spellsStatus={}}var o=i(188).EventEmitter,s=i(172).inherits,a=i(412),r=i(7),l={UNAVAILABLE:0,VISIBLE:1,USABLE:2};s(n,o),e.exports=n,n.prototype.disconnect=function(){this.spells={},this.characterId=null,this.isLoaded=!1,this._requestsPendingCount=0,this._spellsStatus={}},n.prototype.weaponChanged=function(e){this.spells[a.WEAPON_SPELL_ID]&&this.spells[a.WEAPON_SPELL_ID].update(e)},n.prototype.getSpells=function(e){e=e||0;var t={};for(var i in this.spells){var n=this._spellsStatus[i]||0;n>=e&&(t[i]=this.spells[i])}return t},n.prototype._createSpells=function(e,t,i){var n=this;t=t||{},this._requestsPendingCount++,this.isLoaded=!1,this.spells[a.WEAPON_SPELL_ID]||e.indexOf(a.WEAPON_SPELL_ID)!==-1||e.indexOf(a.WEAPON_SPELL_ID.toString())!==-1||e.push(a.WEAPON_SPELL_ID.toString()),a.createSpells(e,function(e,o){if(e)return console.error(e);for(var s in o){o[s].ownerId=n.characterId,n.spells[s]=o[s];var a=t[s];a&&(void 0!==a.level&&o[s].setLevel(a.level),void 0!==a.position&&o[s].setPosition(a.position))}n._requestsPendingCount--,0===n._requestsPendingCount&&(n.isLoaded=!0,n.emit("loaded")),i&&i()})},n.prototype.addSpells=function(e,t){var i=[],n={};for(var o in e){var s=e[o];this._spellsStatus[o]=s.spellStatus,this.spells[o]?void 0!==s.spellLevel&&void 0!==s.position&&(this.spells[o].setLevel(s.spellLevel),this.spells[o].setPosition(s.position)):(n[o]={level:s.spellLevel,position:s.position},i.push(o))}return 0===i.length?t&&t():void this._createSpells(i,n,t)},n.prototype.resetSpellsStatus=function(){this._spellsStatus={}},n.prototype.upgradeSpell=function(e,t,i,n){var o=-1,s=this.spells[e];if(s)o=s.level,s.setLevel(t),n&&n();else{var a={};a[e]={},a[e].level=t,this._createSpells([e],a,n)}this._spellsStatus[e]=i,r.log("character_progression.spell_level_change",{spell_level_before:o,spell_level_after:t,spell_id:e})},n.prototype.getSpellBySpellLevelId=function(e){for(var t in this.spells){var i=this.spells[t];if(!i.isItem&&i.spellLevel.id===e)return i}return null},n.SPELL_STATUS=l},function(e,t,i){function n(e){var t=this;s.call(this,"div",{className:"StarCounter"}),this.stars=[];for(var i=0;i<l;i++){var n=this.createChild("div",{className:"star"});this.stars[i]=n}this.bonusContainer=this.createChild("div",{className:"bonusContainer"}),this.bonusContainer.createChild("div",{className:"bonusContainerPlus",text:"+"});for(var o=0;o<3;o++){var c=this.bonusContainer.createChild("div",{className:"bonusStar"});c.addClassNames("star"+(o+1))}this.linkToShop=this.bonusContainer.appendChild(new a({className:"linkToShop",scaleOnPress:!1})),this.linkToShop.on("tap",function(){r.open("market",{tabId:"shop",tabParams:{category:"bonuspack"}}),t.emit("shopOpened")}),void 0!==e&&this.setValue(e)}i(418);var o=i(172).inherits,s=i(321),a=i(335),r=i(194),l=5;o(n,s),e.exports=n,n.prototype.setValue=function(e){var t="level1",i="";e>100&&(t="level2",i="level1",e-=100),e/=20,e-=.5;for(var n=0;n<l;n++)this.stars[n].delClassNames(["level1","level2"]),this.stars[n].addClassNames(n<=e?t:i);window.gui.playerData.isSubscriber()?this.bonusContainer.addClassNames("bonusPackActive"):this.bonusContainer.delClassNames("bonusPackActive")}},function(e,t){},function(e,t,i){function n(e,t){function i(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function n(e,t){var n=f[0];if(!b){var o=i(e,n),s=Date.now()-g;if(o/l+s/c>=M)return!0}if(!t)return!1;var a=f[1];a||(a=f[1]=t);var r=Math.abs(i(n,a)-i(e,t));return r>d}function u(t){var a=o(t),r=a.touches[0],l=a.touches[1];if(!y){if(!n(r,l))return;return void(s.requestInteractionHandle(e)?(y=!0,e.isTransforming=!0,e.emit("transformStart",a,f)):e.cancelTransform())}var c=r,d=1;if(l){c={x:(r.x+l.x)/2,y:(r.y+l.y)/2};var u=i(r,l);m&&(d=u/m),m=u}c.x-=h.left,c.y-=h.top,p=p||c;var g=b?0:c.x-p.x,_=b?0:c.y-p.y;e.emit("transform",c.x,c.y,g,_,d,a),p=c}if(!e._transformBehavior){e._transformBehavior=!0,e.allowDomEvents();var h,p,m,f,g,_=!1,v=!1,y=!1;a||e.on("dom.wheel",function(t){if(s.requestInteractionHandle(e)){h=e.rootElement.getBoundingClientRect();var i=t.wheelDeltaY>0?r:1/r;e.emit("transform",t.x-h.left,t.y-h.top,0,0,i)}}),e.isTransforming=!1;var b=!1;e.setTranslationEnable=function(e){b=!e};var M=2/("HIGH"===t?3:1);e.cancelTransform=function(){v&&(_=!0,p=m=null,v=!1,e.removeListener("dom.touchmove",u),e.isTransforming=!1,y&&e.emit("transformEnd"))},e.on("dom.touchstart",function(t){if(p=m=null,!v&&!_){var i=o(t);b&&2!==i.touchCount||i.touchCount>2||(h=e.rootElement.getBoundingClientRect(),v=!0,y=!1,f=i.touches,g=Date.now(),e.on("dom.touchmove",u))}}),e.on("dom.touchend",function(t){p=m=null;var i=o(t);return _||0!==i.touchCount?void(_=!1):(e.removeListener("dom.touchmove",u),v=!1,void(y&&(e.isTransforming=!1,e.emit("transformEnd",i))))})}}var o=i(198).getPosition,s=i(200),a=i(168).isDevice,r=1.2,l=40,c=100,d=10;e.exports=n},function(e,t,i){function n(e,t){t=t||{},d.call(this,"div",e),this.addClassNames("Ornament"),this._charName=null,this._title=null,this._titleId=null,this._ornamentId=null,this._ornamentAssetId=null,this._guild=null,this._gender=null,this._alliance=null,this._alignment=null,this._scaleFactor=(t.scaleFactor||1)*p.PIXEL_RATIO;var i=this.createChild("div",{className:"alignmentWingsWrapper"});this._wingsTopCanvas=i.appendChild(new s),this._wingsTopCtx=this._wingsTopCanvas.getContext();var n=this.createChild("div",{className:"alignmentTailWrapper"});this._wingsBottomCanvas=n.appendChild(new s),this._wingsBottomCtx=this._wingsBottomCanvas.getContext(),this._canvas=this.appendChild(new s),this._ctx=this._canvas.getContext(),this._width=this._canvas.width=400,this._height=this._canvas.height=400,this._guildEmblem=new a({width:40,height:40}),this._allianceEmblem=new a({width:40,height:40})}i(421);var o=i(31),s=i(371),a=i(422),r=i(172).inherits,l=i(424),c=i(30),d=i(321),u=i(425),h=i(182),p=i(167),m=160,f=40,g=16,_=16,v=19,y=g+"px Arial",b=_+"px Arial",M=v+"px Arial",w=10,T=5,C=40,A=10,I=C+A;r(n,d),e.exports=n,n.prototype.setAttributes=function(e){e=e||{},this._charName=e.hasOwnProperty("charName")?e.charName:null,this._guild=e.hasOwnProperty("guild")?e.guild:null,this._alliance=e.hasOwnProperty("alliance")?e.alliance:null,this._alignment=e.hasOwnProperty("alignmentInfos")?e.alignmentInfos:null,this._levelDiff=e.levelDiff,this._ornamentId=e.hasOwnProperty("ornamentId")?e.ornamentId:null,this._ornamentAssetId=e.hasOwnProperty("ornamentAssetId")?e.ornamentAssetId:null,this._title=e.hasOwnProperty("title")?e.title:null,this._titleId=e.hasOwnProperty("titleId")?e.titleId:null,this._gender=e.hasOwnProperty("gender")?e.gender:null},n.prototype.changeAttributes=function(e){e=e||{};for(var t in e)this.hasOwnProperty("_"+t)&&(this["_"+t]=e[t])},n.prototype.display=function(){var e=this,t=this._ctx;t.clearRect(0,0,this._width,this._height),this._preload(function(t){return t?console.error(t):(e._calculateDimension(),!e._ornamentAssetId||e._alignment&&0!==e._alignment.alignmentGrade?(e._resizeCanvas(e._textWidth,e._textHeight,0,0),e._displayText(),void e.emit("rendered")):(e._displayTextAndOrnament(),void e.emit("rendered")))})},n.prototype._loadOrnament=function(e){var t=this;o.series([function(e){return t._ornamentId?void c.getData("Ornaments",t._ornamentId,function(i,n){return i?e(i):(t._ornamentAssetId=n.assetId,void e())}):e()},function(e){return t._ornamentAssetId?void l.loadModel("ornaments","ornament_"+t._ornamentAssetId,function(i,n){t._jsonObj=i,t._image=n,e()}):e()}],e)},n.prototype._preload=function(e){var t=this;o.parallel([function(e){t._loadOrnament(e)},function(e){return t._titleId?void c.getData("Titles",t._titleId,function(i,n){return i?e(i):(t._title=t._gender?n.nameFemaleId:n.nameMaleId,void e())}):e()},function(e){return t._guild&&t._guild.guildEmblem?void t._guildEmblem.setValue(t._guild.guildEmblem,!0,e):e()},function(e){return t._alliance&&t._alliance.allianceEmblem?void t._allianceEmblem.setValue(t._alliance.allianceEmblem,!0,e):e()}],e)},n.prototype._calculateDimension=function(){var e=this._ctx,t=[],i=0,n=0;if(e.font=b,this._nameWidth=e.measureText(this._charName).width,t.push(this._nameWidth),n=_,this._guild){var o=this._guild.guildName;e.font=y,this._guildNameWidth=e.measureText(o).width,t.push(this._guildNameWidth+I),t.push(this._nameWidth+I),n+=T+g}if(this._alliance&&(t.push(this._guildNameWidth+2*I),t.push(this._nameWidth+2*I)),this._title){e.font=M;var s="<< "+this._title+" >>",a=e.measureText(s).width;t.push(a),n+=T+v}i=Math.max.apply(null,t)+2*w,n+=2*w,i=Math.round(i),n=Math.round(n),this._textWidth=Math.max(i,m),this._textHeight=Math.max(n,f),this._diffWidth=this._textWidth-m,this._diffHeight=this._textHeight-f},n.prototype._displayText=function(){var e=this,t=this._ctx,i=this._textWidth,n=this._textHeight;t.fillStyle="rgba(0, 0, 0, 0.8)";var o=5;t.beginPath(),t.moveTo(o,0),t.lineTo(i-o,0),t.quadraticCurveTo(i,0,i,o),t.lineTo(i,n-o),t.quadraticCurveTo(i,n,i-o,n),t.lineTo(o,n),t.quadraticCurveTo(0,n,0,n-o),t.lineTo(0,o),t.quadraticCurveTo(0,0,o,0),t.closePath(),t.fill(),t.textAlign="center";var s=Math.max(this._guildNameWidth||0,this._nameWidth),a=s+(this._guild?I:0)+(this._alliance?I:0),r=Math.round(s/2),l=Math.round((i-a)/2)+(this._guild?I:0),c=w;if(this._guild){var d=this._guild.guildName;t.font=y,t.fillStyle="#ffffff",c+=g,t.fillText(d,l+r,c),c+=T}if(this._charName&&(t.font=b,t.fillStyle="#ffffff",c+=_,t.fillText(this._charName,l+r,c),c+=T),this._title){t.font=M,t.fillStyle="#00B346";var p="<< "+this._title+" >>";c+=v,t.fillText(p,Math.round(i/2),c)}if(this._guild&&t.drawImage(this._guildEmblem.getContext().canvas,l-I,w,40,40),this._alliance&&t.drawImage(this._allianceEmblem.getContext().canvas,l+s+A,w,40,40),this._alignment&&this._alignment.alignmentSide!==u.ALIGNMENT_NEUTRAL&&0!==this._alignment.alignmentGrade){var m=window.gui.playerData.alignment,f=20,C=this._levelDiff===-1?.6:1,S=1===this._levelDiff?f:0,E=this._alignment.alignmentSide===u.ALIGNMENT_ANGEL?"#ffffff":"#ff0018",x=function(e,t,i,n,o){var s=t.width+2*f,a=t.height+2*f,r=t.left-f,l=t.top;l+=o?-f:f,i.width=s,i.height=a,i.setStyles({left:r+"px",top:l+"px",width:s+"px",height:a+"px",opacity:C}),n.shadowBlur=S,n.shadowColor=E,n.drawImage(e,f,f)};m.getTopWings(this._alignment,function(t){h.loadImage(t.imagePath,function(i){x(i,t,e._wingsTopCanvas,e._wingsTopCtx,!0),e._wingsTopCanvas.show()})}),m.getBottomWings(this._alignment,function(t){t?h.loadImage(t.imagePath,function(i){x(i,t,e._wingsBottomCanvas,e._wingsBottomCtx,!1),e._wingsBottomCanvas.show()}):e._wingsBottomCanvas.hide()})}else e._wingsTopCanvas.hide(),e._wingsBottomCanvas.hide()},n.prototype._displayTextAndOrnament=function(){var e=this._ctx,t=this._diffWidth,i=this._diffHeight,n=this._jsonObj,o=this._image,s=Math.round(t/2),a=Math.round(i/2);for(var r in n.symbols){var l=n.symbols[r];if(l.isAnim){this._resizeOrnament(l);for(var c=l.children.length-1;c>=0;c--){var d=l.children[c],u=d.id,h=n.symbols[u],p=d.matrices[0],g=n.matrices[p],_=g[0],v=g[1],y=g[2],b=g[3],M=g[4],w=g[5];switch(d.name){case"left":w+=a;break;case"right":M+=t,w+=a;break;case"picto":M+=s;break;case"top":M+=s;break;case"bottom":M+=s,w+=i}if(e.save(),e.transform(_,v,y,b,M,w),"bg"===d.name){this._displayText();var T=h.sw/h.w,C=h.sh/h.h,A=.5*m-h.x,I=.5*f-h.y,S=h.w+h.x-.5*m,E=h.h+h.y-.5*f;e.drawImage(o,h.sx,h.sy,A*T,I*C,h.x,h.y,A,I),e.drawImage(o,h.sx+A*T,h.sy,S*T,I*C,h.x+A+t,h.y,S,I),e.drawImage(o,h.sx,h.sy+I*C,A*T,E*C,h.x,h.y+I+i,A,E),e.drawImage(o,h.sx+A*T,h.sy+I*C,S*T,E*C,h.x+A+t,h.y+I+i,S,E),e.drawImage(o,h.sx+A*T,h.sy,1*T,I*C,h.x+A,h.y,t,I),e.drawImage(o,h.sx+A*T,h.sy+I*C,1*T,E*C,h.x+A,h.y+I+i,t,E),e.drawImage(o,h.sx,h.sy+I*C,A*T,1*C,h.x,h.y+I,A,i),e.drawImage(o,h.sx+A*T,h.sy+I*C,A*T,1*C,h.x+A+t,h.y+I,A,i)}else e.drawImage(o,h.sx,h.sy,h.sw,h.sh,h.x,h.y,h.w,h.h);e.restore()}}}},n.prototype._resizeCanvas=function(e,t,i,n){var o=this._ctx;this._width=e*this._scaleFactor,this._height=t*this._scaleFactor,this._canvas.width=this._width,this._canvas.height=this._height,this._cssWidth=this._width/p.PIXEL_RATIO,this._cssHeight=this._height/p.PIXEL_RATIO,this._canvas.setStyles({width:this._cssWidth+"px",height:this._cssHeight+"px"}),o.clearRect(0,0,this._width,this._height),o.scale(this._scaleFactor,this._scaleFactor),o.translate(i,n),this.emit("sizeChanged")},n.prototype._resizeOrnament=function(e){for(var t=1/0,i=1/0,n=-(1/0),o=-(1/0),s=e.children.length-1;s>=0;s--){var a=e.children[s],r=a.id,l=this._jsonObj.symbols[r],c=a.matrices[0],d=this._jsonObj.matrices[c],u=d[4]+l.x,h=d[5]+l.y;t=Math.min(t,h),i=Math.min(i,u),n=Math.max(n,u+l.w),o=Math.max(o,h+l.h)}var p=Math.round(n-i+this._diffWidth),m=Math.round(o-t+this._diffHeight);this._resizeCanvas(p,m,-i,-t)},n.prototype.getHeight=function(){return this._cssHeight}},function(e,t){},function(e,t,i){function n(e){e=e||{},a.call(this,{className:"EmblemLogo"}),this.addClassNames(e.className);var t=this;this.width=e.width||100,this.height=e.height||100,this.images={crownImage:null,backgroundShape:null,symbolShape:null},this.symbolWidth=Math.round(this.width*p),this.symbolHeight=Math.round(this.height*p),this.symbolPosX=Math.round((this.width-this.symbolWidth)/2),this.symbolPosY=Math.round((this.height-this.symbolHeight)/2),this.crownWidth=Math.round(this.width*m),this.crownHeight=Math.round(this.height*m),this.crownPosX=0,this.crownPosY=0;var i=new a;i.width=this.width,i.height=this.height,this.tempCtx=i.getContext(),o(this,function(){if(t.isLeader)return r("ui.guild.right.leader")})}i(423);var o=i(337).addTooltip,s=i(182),a=i(371),r=i(29).getText,l=i(339),c=i(172).inherits,d=227,u=223,h=189,p=.5,m=.35;c(n,a),e.exports=n,n.prototype._generateEmblem=function(){var e=this.images;if(e.backgroundShape&&e.symbolShape){var t=this.getContext(),i=this.tempCtx;t.clearRect(0,0,this.width,this.height),t.drawImage(e.backgroundShape,0,0,this.width,this.height);var n,o=this.backgroundColor;if(o){var s=t.getImageData(0,0,this.width,this.height),a=s.data,r=o[0]/d,l=o[1]/u,c=o[2]/h;for(n=0;n<a.length;n+=4)a[n]*=r,a[n+1]*=l,a[n+2]*=c;t.putImageData(s,0,0)}i.clearRect(0,0,this.width,this.height),i.drawImage(e.symbolShape,this.symbolPosX,this.symbolPosY,this.symbolWidth,this.symbolHeight);var p=this.symbolColor;if(p){var m=i.getImageData(0,0,this.width,this.height),f=m.data;for(n=0;n<f.length;n+=4)0!==f[n+3]&&(f[n]=p[0],f[n+1]=p[1],f[n+2]=p[2]);i.putImageData(m,0,0)}t.drawImage(i.canvas,0,0,this.width,this.height),this.isLeader&&t.drawImage(e.crownImage,this.crownPosX,this.crownPosY,this.crownWidth,this.crownHeight)}},n.prototype.setValue=function(e,t,i){var n=this,o=[],a=[];if(t=t||e.dec2rgb,e.hasOwnProperty("guild")&&(t=!0,this.isLeader=e.guild.allianceLeader,e=e.guild.guildEmblem),e.hasOwnProperty("backgroundColor")&&(this.backgroundColor=t?l.hexToRgb((+e.backgroundColor).toString(16)):e.backgroundColor),e.hasOwnProperty("symbolColor")&&(this.symbolColor=t?l.hexToRgb((+e.symbolColor).toString(16)):e.symbolColor),e.hasOwnProperty("backgroundShape")){var r="gfx/emblems/icons/"+(e.isAlliance?"backalliance":"back")+"/"+e.backgroundShape+".png";o.push(r),a.push("backgroundShape")}if(e.hasOwnProperty("symbolShape")){var c="gfx/emblems/icons/up/"+e.symbolShape+".png";o.push(c),a.push("symbolShape")}this.isLeader&&!this.images.crownImage&&(o.push("ui/tx_crown.png"),a.push("crownImage")),s.loadImages(o,null,function(e){if(!n||!n.rootElement)return void("function"==typeof i&&i());for(var t=0;t<a.length;t+=1)n.images[a[t]]=e[t];n._generateEmblem(),"function"==typeof i&&i()})}},function(e,t){},function(e,t,i){var n=i(167),o=i(182),s=i(339),a={skin:n.SKIN_PATH,bone:n.BONE_PATH,icon:n.ICON_PATH,bitmapFonts:n.BITMAP_FONTS,ornaments:n.ORNAMENT_PATH,embedded:n.EMBEDDED_PATH};t.loadModel=function(e,t,i,n,r,l){function c(e){if(h=e,s.jeffVersionDowngrader(h),_+=1,_===v)return i&&i(h,u)}function d(e){if(u=n?n.createTexture(e,f,r,l):e,_+=1,_===v)return i&&i(h,u)}var u,h,p,m=a[e]+t,f=m+".png",g=m+".json",_=0,v=1;n?(u=n.holdTexture(f),u?p=!1:(p=!0,v+=1)):(p=!0,v+=1),o.loadJson(g,c),p!==!1&&o.loadImage(f,d)}},function(e,t){e.exports={ALIGNMENT_UNKNOWN:-2,ALIGNMENT_WITHOUT:-1,ALIGNMENT_NEUTRAL:0,ALIGNMENT_ANGEL:1,ALIGNMENT_EVIL:2,ALIGNMENT_MERCENARY:3}},function(e,t,i){function n(e,t){t=t||{},a.call(this,"div",e),this.addClassNames("PropertyInfo"),this._guild=null,this._guildEmblem=new o({width:40,height:40}),this._emblemContainer=this.createChild("div",{className:"emblemContainer"}),this._emblemContainer.appendChild(this._guildEmblem),this._infoContainer=this.createChild("div",{className:"infoContainer"})}i(427);var o=i(422),s=i(172).inherits,a=i(321);s(n,a),e.exports=n,n.prototype._preload=function(e){return this._guild&&this._guild.guildEmblem?this._guildEmblem.setValue(this._guild.guildEmblem,!0,e):e(null,null)},n.prototype.display=function(e){var t=this;e=e||{},this._guild=e.hasOwnProperty("guild")?e.guild:null,this._emblemContainer.hide(),this._infoContainer.clearContent(),this._preload(function(i){return i?console.error("PropertyInfo preload",i):(t._display(e.line1,e.line2),void t.emit("rendered"))})},n.prototype._display=function(e,t){this._guild&&this._guild.guildEmblem&&(this._infoContainer.createChild("div",{text:this._guild.guildName,className:"guildName"}),this._emblemContainer.show()),this._infoContainer.createChild("div",{text:e,className:"line1"}),t&&this._infoContainer.createChild("div",{text:t,className:"line2"})}},function(e,t){},function(e,t,i){var n=i(316);n.prototype._setupBorderArrow=function(){this._borderArrow=this.createChild("div",{className:"BorderArrow"})},n.prototype.showBorderArrow=function(e,t,i){switch(e){case"top":case"bottom":this._borderArrow.setStyles({left:t+"px",top:""});break;case"left":case"right":this._borderArrow.setStyles({top:i+"px",left:""})}this._borderArrow.setClassNames(["BorderArrow",e]),this._borderArrow.show()},n.prototype.hideBorderArrow=function(){this._borderArrow.hide()}},function(e,t,i){function n(){a.call(this),this.windowsContainer=null,this.playerData=new Y,this.serversData=new Z,this.boxArranger=new f,this.isConnected=!1,this.wBody=Se,Se.allowDomEvents(),this.on("IdentificationSuccessMessage",this.onIdentificationSuccess),this.on("IdentificationSuccessWithLoginTokenMessage",this.onIdentificationSuccess),this.on("ServersListMessage",this.onServerListReceived),this.on("CurrentMapMessage",this.onCurrentMapMessage),
R.initialize(this),this.setupAppTransition()}i(430);var o=i(31),s=i(172).inherits,a=i(188).EventEmitter,r=i(321),l=i(320),c=i(197),d=i(28),u=i(431),h=(i(594),i(168)),p=i(166),m=i(583),f=i(595),g=i(596),_=i(601),v=i(602),y=i(625),b=i(627),M=i(630),w=i(632),T=i(317),C=i(347),A=i(633),I=i(475),S=i(171),E=i(29),x=E.getText,N=i(635),L=i(478),O=i(641),D=i(461),R=i(199),P=i(412),B=i(643),k=i(204),z=i(652),F=i(654),H=i(660),q=i(674),W=i(677),U=i(678),G=i(680),j=i(682),Y=i(684),V=i(713),X=i(714),Q=i(716),K=i(718),J=i(729),Z=i(645),$=i(730),ee=i(747),te=i(749),ie=i(183),ne=i(758),oe=i(760),se=i(763),ae=i(337),re=i(176),le=i(765),ce=i(770),de=i(772),ue=i(194),he=i(435),pe=i(775),me=i(798),fe=i(800),ge=i(801),_e=i(803),ve=i(1151),ye=i(1153),be=i(1172),Me=i(1174),we=i(1177),Te=i(1179),Ce=i(1181),Ae=i(1183),Ie=i(808),Se=new r(document.getElementById("dofusBody"));c.initialize(Se),h.isIOS&&!h.isPhoneGap&&i(1185),s(n,a),e.exports=n,n.prototype.setupAppTransition=function(){function e(){n.emit("appGoBackground")}function t(){n.emit("appLeaveBackground"),o&&(window.dofus.sendMessage("BasicPingMessage",{quiet:!0}),s=!0)}var i=window.dofus.connectionManager,n=this,o=!1,s=!1;i.on("open",function(){o=!0}),i.on("disconnect",function(){o=!1,s=!1}),i.on("BasicPongMessage",function(){s&&(n.emit("connectedAfterAppLeaveBackground"),s=!1)}),h.isIOSApp?(document.addEventListener("pause",e,!1),document.addEventListener("resume",t,!1)):document.addEventListener("visibilitychange",function(i){i.target.hidden?e():t()},!1)},n.prototype.transmitMessage=function(e){this.emit(e._messageType,e)},n.prototype.transmitFightSequenceMessage=function(e){this.fightManager.processFightSequenceMessage(e)},n.prototype.initialize=function(e){function t(){window.gui.isConnected?ue["switch"]("global"):window.gui.loginScreen.isVisible()?navigator.app.exitApp():window.dofus.disconnect()}this.loginScreen||this._createUiForLogin(),e&&(console.debug("Gui.initialize:",e),document.addEventListener("backbutton",t,!1))},n.prototype.initializeAfterLogin=function(e){if(this.initialized)return e();ie.initialize(this),this.fightManager=new C,this.tutorialManager=new le,this.playerData.initialize(this),this.serversData.initialize(this),this.fightManager.initialize(this),this.tutorialManager.initialize(this),this.boxArranger.initialize(),this.GPS=new N,this.pingSystem=new K,this.gifts=new J,this.npcDialogHandler=new W,this.uiLocker=new fe,L.initialize(this),m.initialize(this),d.initialize(this),I.initialize(this),ce.initialize(this),l.initialize(Se),b.initialize(this),_.initialize(this),pe.initialize(),V.initialize(),me.initialize(),ge.initialize(this);var t=this;o.series([w.load,P.initialize,D.initialize],function(i){return i?e(i):(t._initUserInterface(),t._initAutoResize(),t.initialized=!0,t.emit("initialized"),void e())})},n.prototype.onServerListReceived=function(e){this.initialized?this.serversData.onServerList(e):this.once("initialized",function(){this.serversData.onServerList(e)})},n.prototype._createUiForLogin=function(){ue.initialize(this),Se.setStyles({width:p.dimensions.screenWidth+"px",height:p.dimensions.screenHeight+"px"}),this.loginScreen=Se.appendChild(new ye),this.splashScreen=Se.appendChild(new be),this.connectionSplashScreen=Se.appendChild(new ve),this.windowsContainer=new r("div",{className:"windowsContainer"}),Se.appendChild(this.windowsContainer),ue.addWindow("connectionQueue",new Ce,{fixed:!0}),ue.addWindow("popup",new Ae),ue.addWindow("confirm",new Ie),ue.addWindow("nickname",new Me,{fixed:!0}),ue.addWindow("register",new we,{fixed:!0}),ue.addWindow("preloadMap",new Te),this.dropDown=Se.appendChild(new ne)},n.prototype._addWindows=function(){_e()},n.prototype._initUserInterface=function(){this.gameGuiContainer=new r("div",{className:"gameGuiContainer",hidden:!0}),Se.appendChild(this.gameGuiContainer),this.sidebarBackground=this.gameGuiContainer.createChild("div",{className:"blackStripe"}),this.mapBorder1=this.gameGuiContainer.createChild("div",{className:"mapBorder"}),this.mapBorder2=this.gameGuiContainer.createChild("div",{className:["mapBorder","flipped"]}),this.screenLeftover=this.gameGuiContainer.createChild("div",{className:"blackStripe"}),this.gameGuiContainer.appendChild(window.foreground),u.initialize(this.gameGuiContainer,Se),this.tooltipBox=Se.appendChild(ae.initialiseTooltipBehavior(Se)),this.numberInputPad=this.gameGuiContainer.appendChild(new G),this._addWindows(),this.chat=this.gameGuiContainer.appendChild(new v),this.gameGuiContainer.appendChild(new y),this.mainControls=this.gameGuiContainer.appendChild(new H),this.shortcutBar=this.gameGuiContainer.appendChild(new $),this.menuBar=this.gameGuiContainer.appendChild(new F),this.textNotification=this.gameGuiContainer.appendChild(new M),this.roleplayBuffs=this.gameGuiContainer.appendChild(new de(this.playerData.inventory)),this.timeline=this.gameGuiContainer.appendChild(new te),this.progressGauge=this.shortcutBar.appendChild(new X),this.compass=this.gameGuiContainer.appendChild(new oe),this.hintArrow=this.gameGuiContainer.appendChild(new se),this.kohBox=this.windowsContainer.appendChild(new B),this.party=this.gameGuiContainer.appendChild(new j),this.challengeIndicator=this.gameGuiContainer.appendChild(new g),this.rewardsIndicator=this.gameGuiContainer.appendChild(new Q),this.npcDialogUi=this.gameGuiContainer.appendChild(new U),this.notificationBar=this.gameGuiContainer.appendChild(new q),this.mapCoordinates=this.gameGuiContainer.appendChild(new z),this.houseMenuButton=this.gameGuiContainer.appendChild(new O),window.Config.disabledFeatures.shop?this.shopFloatingToolbar=null:this.shopFloatingToolbar=this.gameGuiContainer.appendChild(new A),T.init(this.gameGuiContainer)},n.prototype.onCurrentMapMessage=function(){window.foreground.hideBorderArrow()},n.prototype.openContextualMenu=function(e,t,i){i=i||{};var n=i.x,o=i.y;if(i.isCanvasCoordinate){var s=window.foreground.convertCanvasToScreenCoordinate(n,o);n=s.x,o=s.y}u.openAt(e,n,o,t)},n.prototype.openContextualMenuAround=function(e,t,i){u.openAround(e,t,i)},n.prototype.closeContextualMenu=function(e){u.close(e)},n.prototype.showHintArrow=function(e,t){this.hintArrow.showArrow(e,t)},n.prototype.hideHintArrow=function(){this.hintArrow.hideArrow()},n.prototype.newSpeechBubble=function(e){return new ee(e)},n.prototype.disconnect=function(e){this.isConnected=!1,"SOCKET_LOST"!==e&&"ASSET_MISSING"!==e||this.expectedDisconnectionReason||(console.warn("[Gui] disconnected:",e),this.openSimplePopup(x("ui.popup.connectionFailed.text"))),this._shutDownUI(),this.emit("disconnect",e),this.playerData.disconnectModules()},n.prototype.connectionGonnaBeClosed=function(e){this.expectedDisconnectionReason=e;var t=this;window.setTimeout(function(){t.expectedDisconnectionReason=null},6e4)},n.prototype._shutDownUI=function(){this.splashScreen.show(),k.backToLogin(),re.close(),ue.closeAll(),this.gameGuiContainer&&this.gameGuiContainer.hide(),this.houseMenuButton&&this.houseMenuButton.hide(),this.tooltipBox&&this.tooltipBox.closeTooltip(),this.kohBox&&this.kohBox.hide()},n.prototype.onIdentificationSuccess=function(){this.loginScreen.hide(),this.splashScreen.show()},n.prototype.onConnect=function(e){this.isConnected=!0,S.initialize(this),this.gameGuiContainer.show(),this._resizeUi(),this.playerData.connectModules(e,this.fightManager.isInReconnection),window.gui.emit("connected",this.fightManager.isInReconnection),window.Config.disabledFeatures.shop||window.dofus.send("restoreMysteryBox")},n.prototype.openPopup=function(e){ue.getWindow("popup").addContent(e),ue.open("popup")},n.prototype.openSimplePopup=function(e,t){this.openPopup({title:t||x("ui.common.error"),message:e})},n.prototype.openConfirmPopup=function(e,t){ue.getWindow("confirm").update(e),ue.open("confirm",t)},n.prototype.openCancelPopup=function(e){ue.getWindow("cancel").update(e),ue.open("cancel")},n.prototype._resizeUi=function(e){void 0===e&&(e=window.gui.playerData.isFighting),h.isDevice?Se.replaceClassNames(["no-touch"],["touch"]):Se.replaceClassNames(["touch"],["no-touch"]),p.updateScreen();var t=p.dimensions;Se.setStyles({width:t.screenWidth+"px",height:t.screenHeight+"px"});var i=t.screenWidth/t.screenHeight;i<=1.5?(this.ipadRatio=!0,Se.replaceClassNames(["largeRatio"],["ipadRatio"]),p.resizeNarrowScreen(e),this.sidebarBackground.setStyles({left:0,top:t.mapBottom-1+"px",width:t.screenWidth+"px",height:t.screenHeight-t.mapBottom+1+"px"}),this.mapBorder1.addClassNames("vertical"),this.mapBorder1.setStyles({left:0,top:0,width:t.mapLeft+"px",height:t.mapHeight+"px"}),this.mapBorder2.addClassNames("vertical"),this.mapBorder2.setStyles({left:t.mapRight+"px",top:0,width:t.screenWidth-t.mapRight+"px",height:t.mapHeight+"px"}),this.screenLeftover.setStyles({left:0,top:0,width:t.screenWidth+"px",height:t.mapTop+"px"})):(this.ipadRatio=!1,Se.replaceClassNames(["ipadRatio"],["largeRatio"]),p.resizeWideScreen(e),this.sidebarBackground.setStyles({left:t.mapRight+"px",top:0,width:t.screenWidth-t.mapRight+"px",height:t.screenHeight+"px"}),this.mapBorder1.delClassNames("vertical"),this.mapBorder1.setStyles({left:t.mapLeft+"px",top:0,width:t.mapWidth+"px",height:t.mapTop+"px"}),this.mapBorder2.delClassNames("vertical"),this.mapBorder2.setStyles({left:t.mapLeft+"px",top:t.mapBottom-1+"px",width:t.mapWidth+"px",height:t.screenHeight-t.mapBottom+1+"px"}),this.screenLeftover.setStyles({left:0,top:0,width:t.mapLeft+"px",height:t.screenHeight+"px"})),window.isoEngine.updateDimensions(t),this.emit("resize",t)},n.prototype._initAutoResize=function(){function e(){clearTimeout(t),t=setTimeout(function(){i._resizeUi()},250)}he.hide(),this._resizeUi();var t,i=this;h.isDevice||(window.addEventListener("scroll",e),window.addEventListener("resize",e)),this.fightManager.on("fightEnterPreparation",function(){i._resizeUi()}),this.fightManager.on("fightEnterBattle",function(e){"PREPARATION_SKIPPED"===e&&i._resizeUi()}),this.fightManager.on("fightEnd",function(){i._resizeUi()}),S.on("menubarSize",this.resizeToolbarForRoleplay.bind(this)),S.on("menubarSizeInFight",this.resizeToolbarForFight.bind(this)),S.on("toolbarThicknessInFight",this.resizeToolbarForFight.bind(this))},n.prototype._resizeToolbar=function(e){var t=window.gui.playerData.isFighting;e===t&&this._resizeUi(t)},n.prototype.resizeToolbarForFight=function(){this._resizeToolbar(!0)},n.prototype.resizeToolbarForRoleplay=function(){this._resizeToolbar(!1)},n.prototype.showFightingToolbar=function(e){this._resizeUi(e)},n.prototype.getBuildVersion=function(){var e=window.appInfo&&window.appInfo.version,t=window.buildVersion,i=[];return e&&i.push("Client v"+e),t&&i.push("Build v"+t),i.join("/")}},function(e,t){},function(e,t,i){function n(){a=!0}function o(e){p=null,d="clickAway"===e}function s(e,t){e=e||"generic";var i=h[e];return i?t&&d?(r=null,l=c=-1,!1):(p=i,!0):(console.error('Contextual menu "'+e+'" does not exist.'),!1)}var a,r,l,c,d,u=i(198).getPosition,h={admin:i(432),emote:i(439),fightTeam:i(440),generic:i(442),interactive:i(443),item:i(447),map:i(565),merchant:i(568),monster:i(569),npc:i(571),offlinePlayer:i(572),paddockObject:i(573),partyOptions:i(574),player:i(576),preset:i(581),prism:i(582),smiley:i(585),spell:i(586),spellUpgrade:i(587),storage:i(589),taxCollector:i(590),userStatus:i(591)},p=null,m={x:0,y:0};t.getContextMenu=function(e){return h[e]},t.initialize=function(e,t){t.on("dom.touchstart",function(e){return m=u(e),p?void(a?a=!1:p.close("clickAway")):void(d=!1)});for(var i in h){var s=h[i],r=h[i]=e.appendChild(new s);r.allowDomEvents(),r.on("dom.touchstart",n),r.on("close",o)}},t.openAt=function(e,t,i,n){s(e,Math.abs(l-t)<5&&Math.abs(c-i)<5)&&(l=t,c=i,t=void 0===t?m.x:t,i=void 0===i?m.y:i,p.openAt(t,i,n))},t.openAround=function(e,t,i){s(e,t===r)&&(r=t,p.openAround(t,i))},t.close=function(e){p&&p.close(e)}},function(e,t,i){function n(){r.call(this,{className:"ContextualMenuAdmin"});var e=this;e.targetPlayer=null,e.adminData=null,e.curItems=null,e.prevItems=[],this.once("open",function(){e.container=e.entryList.appendChild(new l("div")),e._addCancel()}),this.on("open",function(t,i){e.targetPlayer=t,e.updateContent(i)}),this.on("close",function(){e.container.clearContent(),e.targetPlayer=null,e.adminData=null,e.curItems=null,e.prevItems=[]})}function o(e){if(e.status<400||e.status>599)return e;var t=new Error(e.statusText);throw t.response=e,t}function s(e){return e.json().then(function(t){if(t._statusCode||e.status>599)throw t;return t})}var a=i(172).inherits,r=i(433),l=i(321),c=i(335),d=i(194);a(n,r),e.exports=n,n.prototype.replaceSymbols=function(e){var t=window.gui.playerData.characterBaseInformations.name,i=this.targetPlayer.name,n=e.replace("%n",t);return n=n.replace("%p",i)},n.prototype._addStartup=function(e){console.debug(e)},n.prototype._addStatic=function(e){var t=this.replaceSymbols(e.label);this.container.appendChild(new l("div",{text:t,className:"contextHeader"}))},n.prototype._addMenu=function(e){function t(){e.label&&i.prevItems.push(i.curItems),i._addItems(e.item)}var i=this,n=this.replaceSymbols(e.label||"");n+=" >",this.container.appendChild(new c({text:n,className:"cmButton"},t))},n.prototype._addSendCommand=function(e){function t(){var e=d.getWindow("adminConsole");d.open("adminConsole"),e.runCommand(o),i.close()}var i=this,n=this.replaceSymbols(e.label),o=this.replaceSymbols(e.command);this.container.appendChild(new c({text:n,className:"cmButton"},t))},n.prototype._addPrepareCommand=function(e){function t(){var e=d.getWindow("adminConsole");d.open("adminConsole"),e.cmdInput.setValue(o),i.close()}var i=this,n=this.replaceSymbols(e.label),o=this.replaceSymbols(e.command);this.container.appendChild(new c({text:n,className:"cmButton"},t))},n.prototype._addBatch=function(e){function t(){var t,n=d.getWindow("adminConsole"),o=e.item;d.open("adminConsole");for(var s=0;s<o.length;s+=1)t=i.replaceSymbols(o[s].command),n.runCommand(t);i.close()}var i=this,n=e.label;this.container.appendChild(new c({text:n,className:"cmButton"},t))},n.prototype._addItem=function(e){var t=e.type;switch(t){case"startup":this._addStartup(e);break;case"static":this._addStatic(e);break;case"menu":this._addMenu(e);break;case"sendCommand":this._addSendCommand(e);break;case"prepareCommand":this._addPrepareCommand(e);break;case"batch":this._addBatch(e)}},n.prototype._addItems=function(e){var t=this;e&&!Array.isArray(e)&&(e=[e]),t.curItems=e,this.container.clearContent();for(var i,n=0;n<e.length;n+=1)i=e[n],this._addItem(i);this.prevItems.length&&this.container.appendChild(new c({text:"< Back",className:"cmButton"},function(){var e=t.prevItems.pop();t._addItems(e)})),this.scroller.refresh()},n.prototype.updateContent=function(e){var t=this,i=window.gui.playerData.adminMenu.getURL(),n=window.gui.playerData.adminMenu.getAdminMenuId();if(!i||null===n)return this.close(),e();var a=i+n+".json";window.fetch(a).then(o).then(s).then(function(i){return t.adminData=i,t._addItems(i.menu.item),e()})["catch"](function(i){return console.error(i),t.close(),e()})}},function(e,t,i){function n(e){p.call(this,"div",{className:"ContextualMenu",hidden:!0}),e=e||{},this.addClassNames(e.className),this._position={},this.header=this.createChild("div",{className:"contextHeader"}),e.noHeader&&this._displayHeader(!1),this.entryContainer=this.createChild("div",{className:"entryContainer"}),this.scroller=this.entryContainer.appendChild(new d({className:"entryList"},{showHintArrows:!0})),this.entryList=this.scroller.content,this.maxHeight=s.screenHeight-2*m-(e.noHeader?0:f),this.requestedHeight=this.maxHeight,this.currentHeight=0;var t=this;l.on("show",function(e){t._refreshScroller(t.maxHeight-e)}),l.on("hide",function(){t._refreshScroller(t.maxHeight)})}i(434);var o=i(335),s=i(166).dimensions,a=i(29).getText,r=i(334),l=i(435),c=i(172).inherits,d=i(436),u=i(198).position,h=i(196),p=i(321),m=10,f=40;c(n,p),e.exports=n,n.prototype._refreshScroller=function(e){if(void 0!==e){if(this.requestedHeight=e,!this.isOpen&&!this.isOpening)return;if(this.requestedHeight===this.currentHeight)return}this.currentHeight=this.requestedHeight,this.scroller.setStyle("maxHeight",this.currentHeight+"px"),void 0===e&&this.scroller.goToTop(),this.scroller.refresh()},n.prototype._displayHeader=function(e){this.toggleClassName("noHeader",!e),this.header.toggleDisplay(e)},n.prototype._setPosition=function(e,t){this._position.x=u.x,this._position.y=u.y,this.setStyles({left:e+"px",top:t+25+"px"})},n.prototype._addEntry=function(e,t){var i=this,n=this.entryList.appendChild(new o({text:e,className:"cmButton"},t));return n.on("tap",function(){i.close()}),n},n.prototype._addCancel=function(){return this._addSeparator(),this._addEntry(a("ui.common.cancel"),function(){})},n.prototype._addSeparator=function(){this.entryList.createChild("div",{className:"separator"})},n.prototype._openingAnimation=function(e,t){function i(){n._tween1=h.tween(n,{webkitTransform:"translate3d(0,-25px,0)",opacity:1},{time:100,easing:"ease-out"},function(){n._tween1=null}),n._tween2=h.tween(n.entryList,{webkitTransform:"translate3d(0,0,0)"},{time:200,easing:"cubic-bezier(0,1,0.62,1)"},function(){this.setStyle("webkitTransform",""),n._tween2=null,n.isOpening=!1,n._tween=null,n.isOpen=!0,n.closeRequest&&(n.closeRequest=null,n.close("reopen"))})}if(!this.isOpening){if(this.isOpen)return this.close(),void(this.next={positioningMethod:e,params:t});if(e()){this.isOpening=!0,this._tween1&&this._tween1.cancel(),this._tween2&&this._tween2.cancel(),this.show(),this.entryContainer.setStyle("overflow","visible"),this.entryList.setStyle("webkitTransform","translate3d(0,-100%,0)");var n=this;this.emit("open",t,function(){n._refreshScroller();var t=e();n._setPosition(t.x,t.y),n.entryContainer.setStyle("overflow","hidden"),window.setTimeout(i,0)})}}},n.prototype.openAt=function(e,t,i){var n=this;this._openingAnimation(function(){return r.getElementPositionAt(n,e,t)},i)},n.prototype.openAround=function(e,t){var i=this;this._openingAnimation(function(){return i.rootElement&&e.rootElement?r.getElementPositionAround(i,e):null},t)},n.prototype.close=function(e){if(this.isOpening)return void(this.closeRequest=!0);if(!this.isClosing&&this.isOpen){this.isClosing=!0,this._tween1&&this._tween1.cancel(),this._tween2&&this._tween2.cancel();var t=this;this.emit("close",e),this._tween1=h.tween(this.entryList,{webkitTransform:"translate3d(0,-100%,0)"},{time:200,easing:"ease-out"},function(){t._tween1=null,t.isClosing=!1,t.isOpen=!1,t.next&&(t._openingAnimation(t.next.positioningMethod,t.next.params),t.next=null)}),this._tween2=h.tween(this,{webkitTransform:"translate3d(0,0,0)",opacity:0},{delay:100,time:100,easing:"ease-out"},function(){t.hide(),t._tween2=null})}}},function(e,t){},function(e,t,i){var n=i(168),o=i(188),s=window.cordova,a=i(198),r=a.events,l=new o;e.exports=l;var c=!0;l.show=function(){n.isPhoneGap&&s.plugins.Keyboard.show()},l.hide=function(){"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),n.isPhoneGap&&s.plugins.Keyboard.close()},l.disableScroll=function(e){n.isPhoneGap&&s.plugins.Keyboard.disableScroll(e)},l.hideKeyboardAccessoryBar=function(e){n.isPhoneGap&&s.plugins.Keyboard.hideKeyboardAccessoryBar(e)},l.setAutomaticHide=function(e){c=!!e},document.body.addEventListener(r.end,function(e){"INPUT"===document.activeElement.tagName&&"INPUT"!==e.target.tagName&&c&&l.hide()},!1),n.isPhoneGap&&(window.addEventListener("native.keyboardshow",function(e){l.emit("show",e.keyboardHeight)}),window.addEventListener("native.keyboardhide",function(){var e="INPUT"===document.activeElement.tagName&&document.activeElement;setTimeout(function(){var t="INPUT"===document.activeElement.tagName;t&&e!==document.activeElement||(l.emit("hide"),e&&document.activeElement.blur())},0)}))},function(e,t,i){function n(e,t){p.call(this,"div",e),this.addClassNames("Scroller"),t=t||{};var i=!!t.isHorizontal,n=i?["scrollerContent","horizontal"]:"scrollerContent";this.content=this.createChild("div",{className:n}),this.iScroll=new u(this.rootElement,{scrollbars:"custom",fadeScrollbars:!1,bounce:t.bounce,maxSpeed:t.maxSpeed,scrollX:i,scrollY:!i,mouseWheel:!0,preventDefault:!1,directionLockThreshold:m}),this.iScroll.myScroller=this,this.on("destroy",this._destroyHandler),t.showHintArrows&&(this.scrollUpHint=this.createChild("div",{className:"scrollUpHint"}),this.scrollDownHint=this.createChild("div",{className:"scrollDownHint"}),this.notifyInterval=null,this.notifyCount=0),this.isEnable=!0,this._handleRegistered=!1;var o=this;window.setTimeout(function(){o.refresh()},200),this._setupEventListeners()}function o(){var e=this.myScroller;return d.requestInteractionHandle(e)?(e.scrollUpHint&&(e.scrollUpHint.hide(),e.scrollDownHint.hide()),void e.emit("scrollStart")):e.cancel()}function s(){var e=this.myScroller;e._refreshHints(),e.emit("scrollEnd")}function a(){this.myScroller.emit("scrollCancel")}function r(e){e!==this&&this.cancel()}function l(){this.requestRefresh&&this.refresh(!0),this._handleRegistered||(this._handleRegistered=!0,d.once("handleTaken",r.bind(this)))}function c(){d.removeListener("handleTaken",r.bind(this)),this.isEnable&&this.iScroll.enable(),this._handleRegistered=!1}i(437);var d=i(200),u=i(438),h=i(172).inherits,p=i(321),m=10,f=17,g=200,_=8;h(n,p),n.ease=u.utils.ease,n.prototype._destroyHandler=function(){window.clearInterval(this.notifyInterval),this.iScroll.destroy()},n.prototype._setupEventListeners=function(){this.allowDomEvents(),this.on("dom.touchstart",l),this.on("dom.touchend",c),this.iScroll.on("scrollStart",o),this.iScroll.on("scrollEnd",s),this.iScroll.on("scrollCancel",a)},n.prototype._refreshHints=function(){this.scrollUpHint&&(this.scrollUpHint.toggleDisplay(this.canScrollUp(f)),this.scrollDownHint.toggleDisplay(this.canScrollDown(f)))},n.prototype.cancel=function(){this.iScroll.disable()},n.prototype.refresh=function(e){return e||0!==this.rootElement.clientHeight?(this.iScroll.refresh(),this.toggleClassName("scrollBgVisible",this.iScroll.hasVerticalScroll||this.iScroll.hasHorizontalScroll),this._refreshHints(),void(this.requestRefresh=!1)):void(this.requestRefresh=!0)},n.prototype.notify=function(){if(this.scrollUpHint&&this.canScrollDown()&&(this.notifyCount=_,!this.notifyInterval)){var e=this;this.notifyInterval=window.setInterval(function(){e.scrollDownHint.toggleDisplay(),e.notifyCount--,e.notifyCount>0||(window.clearInterval(e.notifyInterval),e.notifyInterval=null,e._refreshHints())},g)}},n.prototype.scrollToElement=function(e,t,i,n,o){this.iScroll.scrollToElement(e.rootElement,t,i,n,o),t||this._refreshHints()},n.prototype.showElement=function(e,t,i){var n=this.iScroll,o=e.rootElement;o=o.nodeType?o:n.scroller.querySelector(o);var s=u.utils.offset(o);s.left-=n.wrapperOffset.left,s.top-=n.wrapperOffset.top;var a=o.offsetHeight,r=o.offsetWidth;s.top<n.y&&a<=n.wrapperHeight&&(s.top=Math.min(s.top-a+n.wrapperHeight,n.y)),s.left<n.x&&r<=n.wrapperWidth&&(s.left=Math.min(s.left-r+n.wrapperWidth,n.x)),s.left=Math.min(0,Math.max(n.maxScrollX,s.left)),s.top=Math.min(0,Math.max(n.maxScrollY,s.top)),s.left===n.x&&s.top===n.y||(t=void 0===t||null===t||"auto"===t?Math.max(Math.abs(n.x-s.left),Math.abs(n.y-s.top)):t,this.scrollTo(s.left,s.top,t,i))},n.prototype.scrollTo=function(e,t,i,n){this.iScroll.scrollTo(e,t,i,n),i||this._refreshHints()},n.prototype.scrollBy=function(e,t,i,n){this.iScroll.scrollBy(e,t,i,n),i||this._refreshHints()},n.prototype.setEnable=function(e){e?this.iScroll.enable():this.iScroll.disable(),this.isEnable=e},n.prototype.canScrollUp=function(e){return e=e||1,this.iScroll.options.scrollY?this.iScroll.y<=-e:this.iScroll.x<=-e},n.prototype.canScrollDown=function(e){return e=e||1,this.iScroll.options.scrollY?this.iScroll.maxScrollY-this.iScroll.y<=-e:this.iScroll.maxScrollX-this.iScroll.x<=-e},n.prototype.goToTop=function(e,t){return this.iScroll.options.scrollY?this.scrollTo(this.iScroll.x,0,e,t):void this.scrollTo(0,this.iScroll.y,e,t)},n.prototype.goToBottom=function(e,t){return this.iScroll.options.scrollY?this.scrollTo(this.iScroll.x,this.iScroll.maxScrollY,e,t):void this.scrollTo(this.iScroll.maxScrollX,this.iScroll.y,e,t)},n.prototype.getScrollPosition=function(){return{x:this.iScroll.x,y:this.iScroll.y}},e.exports=n},function(e,t){},function(e,t){/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
!function(t,i,n){function o(e,t){this.wrapper="string"==typeof e?i.querySelector(e):e,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var n in t)this.options[n]=t[n];this.translateZ=this.options.HWCompositing&&l.hasPerspective?" translateZ(0)":"",this.options.useTransition=l.hasTransition&&this.options.useTransition,this.options.useTransform=l.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"!=this.options.eventPassthrough&&this.options.scrollY,this.options.scrollX="horizontal"!=this.options.eventPassthrough&&this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?l.ease[this.options.bounceEasing]||l.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function s(e,t,n){var o=i.createElement("div"),s=i.createElement("div");return n===!0&&(o.style.cssText="position:absolute;z-index:9999",s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),s.className="iScrollIndicator","h"==e?(n===!0&&(o.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",s.style.height="100%"),o.className="iScrollHorizontalScrollbar"):(n===!0&&(o.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",s.style.width="100%"),o.className="iScrollVerticalScrollbar"),o.style.cssText+=";overflow:hidden",t||(o.style.pointerEvents="none"),o.appendChild(s),o}function a(e,n){this.wrapper="string"==typeof n.el?i.querySelector(n.el):n.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=e,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var o in n)this.options[o]=n[o];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(l.addEvent(this.indicator,"touchstart",this),l.addEvent(t,"touchend",this)),this.options.disablePointer||(l.addEvent(this.indicator,l.prefixPointerEvent("pointerdown"),this),l.addEvent(t,l.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(l.addEvent(this.indicator,"mousedown",this),l.addEvent(t,"mouseup",this))),this.options.fade&&(this.wrapperStyle[l.style.transform]=this.scroller.translateZ,this.wrapperStyle[l.style.transitionDuration]=l.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var r=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)},l=function(){function e(e){return a!==!1&&(""===a?e:a+e.charAt(0).toUpperCase()+e.substr(1))}var o={},s=i.createElement("div").style,a=function(){for(var e,t=["t","webkitT","MozT","msT","OT"],i=0,n=t.length;i<n;i++)if(e=t[i]+"ransform",e in s)return t[i].substr(0,t[i].length-1);return!1}();o.getTime=Date.now||function(){return(new Date).getTime()},o.extend=function(e,t){for(var i in t)e[i]=t[i]},o.addEvent=function(e,t,i,n){e.addEventListener(t,i,!!n)},o.removeEvent=function(e,t,i,n){e.removeEventListener(t,i,!!n)},o.prefixPointerEvent=function(e){return t.MSPointerEvent?"MSPointer"+e.charAt(9).toUpperCase()+e.substr(10):e},o.momentum=function(e,t,i,o,s,a,r){var l,c,d=e-t,u=n.abs(d)/i;return r&&u>r&&(u=r),a=void 0===a?6e-4:a,l=e+u*u/(2*a)*(d<0?-1:1),c=u/a,l<o?(l=s?o-s/2.5*(u/8):o,d=n.abs(l-e),c=d/u):l>0&&(l=s?s/2.5*(u/8):0,d=n.abs(e)+l,c=d/u),{destination:n.round(l),duration:c}};var r=e("transform");return o.extend(o,{hasTransform:r!==!1,hasPerspective:e("perspective")in s,hasTouch:"ontouchstart"in t,hasPointer:t.PointerEvent||t.MSPointerEvent,hasTransition:e("transition")in s}),o.isBadAndroid=/Android /.test(t.navigator.appVersion)&&!/Chrome\/\d/.test(t.navigator.appVersion),o.extend(o.style={},{transform:r,transitionTimingFunction:e("transitionTimingFunction"),transitionDuration:e("transitionDuration"),transitionDelay:e("transitionDelay"),transformOrigin:e("transformOrigin")}),o.hasClass=function(e,t){var i=new RegExp("(^|\\s)"+t+"(\\s|$)");return i.test(e.className)},o.addClass=function(e,t){if(!o.hasClass(e,t)){var i=e.className.split(" ");i.push(t),e.className=i.join(" ")}},o.removeClass=function(e,t){if(o.hasClass(e,t)){var i=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(i," ")}},o.offset=function(e){for(var t=-e.offsetLeft,i=-e.offsetTop;e=e.offsetParent;)t-=e.offsetLeft,i-=e.offsetTop;return{left:t,top:i}},o.preventDefaultException=function(e,t){for(var i in t)if(t[i].test(e[i]))return!0;return!1},o.extend(o.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),o.extend(o.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return n.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e-=1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){return(e/=1)<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}},elastic:{style:"",fn:function(e){var t=.22,i=.4;return 0===e?0:1==e?1:i*n.pow(2,-10*e)*n.sin((e-t/4)*(2*n.PI)/t)+1}}}),o.tap=function(e,t){var n=i.createEvent("Event");n.initEvent(t,!0,!0),n.pageX=e.pageX,n.pageY=e.pageY,e.target.dispatchEvent(n)},o.click=function(e){var t,n=e.target;/(SELECT|INPUT|TEXTAREA)/i.test(n.tagName)||(t=i.createEvent("MouseEvents"),t.initMouseEvent("click",!0,!0,e.view,1,n.screenX,n.screenY,n.clientX,n.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),t._constructed=!0,n.dispatchEvent(t))},o}();o.prototype={version:"5.1.3",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){e.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(e){if((1==l.eventType[e.type]||0===e.button)&&this.enabled&&(!this.initiated||l.eventType[e.type]===this.initiated)){!this.options.preventDefault||l.isBadAndroid||l.preventDefaultException(e.target,this.options.preventDefaultException)||e.preventDefault();var t,i=e.touches?e.touches[0]:e;this.initiated=l.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=l.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,t=this.getComputedPosition(),this._translate(n.round(t.x),n.round(t.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=i.pageX,this.pointY=i.pageY,this._execEvent("beforeScrollStart")}},_move:function(e){if(this.enabled&&l.eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault();var t,i,o,s,a=e.touches?e.touches[0]:e,r=a.pageX-this.pointX,c=a.pageY-this.pointY,d=l.getTime();if(this.pointX=a.pageX,this.pointY=a.pageY,this.distX+=r,this.distY+=c,o=n.abs(this.distX),s=n.abs(this.distY),!(d-this.endTime>300&&o<10&&s<10)){if(this.directionLocked||this.options.freeScroll||(o>s+this.options.directionLockThreshold?this.directionLocked="h":s>=o+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)e.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);c=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)e.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);r=0}r=this.hasHorizontalScroll?r:0,c=this.hasVerticalScroll?c:0,t=this.x+r,i=this.y+c,(t>0||t<this.maxScrollX)&&(t=this.options.bounce?this.x+r/3:t>0?0:this.maxScrollX),(i>0||i<this.maxScrollY)&&(i=this.options.bounce?this.y+c/3:i>0?0:this.maxScrollY),this.directionX=r>0?-1:r<0?1:0,this.directionY=c>0?-1:c<0?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(t,i),d-this.startTime>300&&(this.startTime=d,this.startX=this.x,this.startY=this.y)}}},_end:function(e){if(this.enabled&&l.eventType[e.type]===this.initiated){this.options.preventDefault&&!l.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();var t,i,o=(e.changedTouches?e.changedTouches[0]:e,l.getTime()-this.startTime),s=n.round(this.x),a=n.round(this.y),r=n.abs(s-this.startX),c=n.abs(a-this.startY),d=0,u="";if(this.isInTransition=0,this.initiated=0,this.endTime=l.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(s,a),!this.moved)return this.options.tap&&l.tap(e,this.options.tap),this.options.click&&l.click(e),void this._execEvent("scrollCancel");if(this._events.flick&&o<200&&r<100&&c<100)return void this._execEvent("flick");if(this.options.momentum&&o<300&&(t=this.hasHorizontalScroll?l.momentum(this.x,this.startX,o,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration,this.options.maxSpeed):{destination:s,duration:0},i=this.hasVerticalScroll?l.momentum(this.y,this.startY,o,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration,this.options.maxSpeed):{destination:a,duration:0},s=t.destination,a=i.destination,d=n.max(t.duration,i.duration),this.isInTransition=1),this.options.snap){var h=this._nearestSnap(s,a);this.currentPage=h,d=this.options.snapSpeed||n.max(n.max(n.min(n.abs(s-h.x),1e3),n.min(n.abs(a-h.y),1e3)),300),s=h.x,a=h.y,this.directionX=0,this.directionY=0,u=this.options.bounceEasing}return s!=this.x||a!=this.y?((s>0||s<this.maxScrollX||a>0||a<this.maxScrollY)&&(u=l.ease.quadratic),void this.scrollTo(s,a,d,u)):void this._execEvent("scrollEnd")}}},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.refresh()},this.options.resizePolling)},resetPosition:function(e){var t=this.x,i=this.y;return e=e||0,!this.hasHorizontalScroll||this.x>0?t=0:this.x<this.maxScrollX&&(t=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),(t!=this.x||i!=this.y)&&(this.scrollTo(t,i,e,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=l.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},off:function(e,t){if(this._events[e]){var i=this._events[e].indexOf(t);i>-1&&this._events[e].splice(i,1)}},_execEvent:function(e){if(this._events[e]){var t=0,i=this._events[e].length;if(i)for(;t<i;t++)this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,i,n){e=this.x+e,t=this.y+t,i=i||0,this.scrollTo(e,t,i,n)},scrollTo:function(e,t,i,n){n=n||l.ease.circular,this.isInTransition=this.options.useTransition&&i>0,!i||this.options.useTransition&&n.style?(this._transitionTimingFunction(n.style),this._transitionTime(i),this._translate(e,t)):this._animate(e,t,i,n.fn)},scrollToElement:function(e,t,i,o,s){if(e=e.nodeType?e:this.scroller.querySelector(e)){var a=l.offset(e);a.left-=this.wrapperOffset.left,a.top-=this.wrapperOffset.top,i===!0&&(i=n.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)),o===!0&&(o=n.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)),a.left-=i||0,a.top-=o||0,a.left=a.left>0?0:a.left<this.maxScrollX?this.maxScrollX:a.left,a.top=a.top>0?0:a.top<this.maxScrollY?this.maxScrollY:a.top,t=void 0===t||null===t||"auto"===t?n.max(n.abs(this.x-a.left),n.abs(this.y-a.top)):t,this.scrollTo(a.left,a.top,t,s)}},_transitionTime:function(e){if(e=e||0,this.scrollerStyle[l.style.transitionDuration]=e+"ms",!e&&l.isBadAndroid&&(this.scrollerStyle[l.style.transitionDuration]="0.001s"),this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTime(e)},_transitionTimingFunction:function(e){if(this.scrollerStyle[l.style.transitionTimingFunction]=e,this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTimingFunction(e)},_translate:function(e,t){if(this.options.useTransform?this.scrollerStyle[l.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ:(e=n.round(e),t=n.round(t),this.scrollerStyle.left=e+"px",this.scrollerStyle.top=t+"px"),this.x=e,this.y=t,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].updatePosition()},_initEvents:function(e){var i=e?l.removeEvent:l.addEvent,n=this.options.bindToWrapper?this.wrapper:t;i(t,"orientationchange",this),i(t,"resize",this),this.options.click&&i(this.wrapper,"click",this,!0),this.options.disableMouse||(i(this.wrapper,"mousedown",this),i(n,"mousemove",this),i(n,"mousecancel",this),i(n,"mouseup",this)),l.hasPointer&&!this.options.disablePointer&&(i(this.wrapper,l.prefixPointerEvent("pointerdown"),this),i(n,l.prefixPointerEvent("pointermove"),this),i(n,l.prefixPointerEvent("pointercancel"),this),i(n,l.prefixPointerEvent("pointerup"),this)),l.hasTouch&&!this.options.disableTouch&&(i(this.wrapper,"touchstart",this),i(n,"touchmove",this),i(n,"touchcancel",this),i(n,"touchend",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var e,i,n=t.getComputedStyle(this.scroller,null);return this.options.useTransform?(n=n[l.style.transform].split(")")[0].split(", "),e=+(n[12]||n[4]),i=+(n[13]||n[5])):(e=+n.left.replace(/[^-\d.]/g,""),i=+n.top.replace(/[^-\d.]/g,"")),{x:e,y:i}},_initIndicators:function(){function e(e){for(var t=r.indicators.length;t--;)e.call(r.indicators[t])}var t,i=this.options.interactiveScrollbars,n="string"!=typeof this.options.scrollbars,o=[],r=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(t={el:s("v",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(t.el),o.push(t)),this.options.scrollX&&(t={el:s("h",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(t.el),o.push(t))),this.options.indicators&&(o=o.concat(this.options.indicators));for(var l=o.length;l--;)this.indicators.push(new a(this,o[l]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){e(function(){this.fade()})}),this.on("scrollCancel",function(){e(function(){this.fade()})}),this.on("scrollStart",function(){e(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){e(function(){this.fade(1,!0)})})),this.on("refresh",function(){e(function(){this.refresh()})}),this.on("destroy",function(){e(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){l.addEvent(this.wrapper,"wheel",this),l.addEvent(this.wrapper,"mousewheel",this),l.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){l.removeEvent(this.wrapper,"wheel",this),l.removeEvent(this.wrapper,"mousewheel",this),l.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(this.enabled){e.preventDefault(),e.stopPropagation();var t,i,o,s,a=this;if(void 0===this.wheelTimeout&&a._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){a._execEvent("scrollEnd"),a.wheelTimeout=void 0},400),"deltaX"in e)1===e.deltaMode?(t=-e.deltaX*this.options.mouseWheelSpeed,i=-e.deltaY*this.options.mouseWheelSpeed):(t=-e.deltaX,i=-e.deltaY);else if("wheelDeltaX"in e)t=e.wheelDeltaX/120*this.options.mouseWheelSpeed,i=e.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in e)t=i=e.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in e))return;t=i=-e.detail/3*this.options.mouseWheelSpeed}if(t*=this.options.invertWheelDirection,i*=this.options.invertWheelDirection,this.hasVerticalScroll||(t=i,i=0),this.options.snap)return o=this.currentPage.pageX,s=this.currentPage.pageY,t>0?o--:t<0&&o++,i>0?s--:i<0&&s++,void this.goToPage(o,s);o=this.x+n.round(this.hasHorizontalScroll?t:0),s=this.y+n.round(this.hasVerticalScroll?i:0),o>0?o=0:o<this.maxScrollX&&(o=this.maxScrollX),s>0?s=0:s<this.maxScrollY&&(s=this.maxScrollY),this.scrollTo(o,s,0)}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var e,t,i,o,s,a,r=0,l=0,c=0,d=this.options.snapStepX||this.wrapperWidth,u=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(i=n.round(d/2),o=n.round(u/2);c>-this.scrollerWidth;){for(this.pages[r]=[],e=0,s=0;s>-this.scrollerHeight;)this.pages[r][e]={x:n.max(c,this.maxScrollX),y:n.max(s,this.maxScrollY),width:d,height:u,cx:c-i,cy:s-o},s-=u,e++;c-=d,r++}else for(a=this.options.snap,e=a.length,t=-1;r<e;r++)(0===r||a[r].offsetLeft<=a[r-1].offsetLeft)&&(l=0,t++),this.pages[l]||(this.pages[l]=[]),c=n.max(-a[r].offsetLeft,this.maxScrollX),s=n.max(-a[r].offsetTop,this.maxScrollY),i=c-n.round(a[r].offsetWidth/2),o=s-n.round(a[r].offsetHeight/2),this.pages[l][t]={x:c,y:s,width:a[r].offsetWidth,height:a[r].offsetHeight,cx:i,cy:o},c>this.maxScrollX&&l++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=n.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=n.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var e=this.options.snapSpeed||n.max(n.max(n.min(n.abs(this.x-this.startX),1e3),n.min(n.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e)})},_nearestSnap:function(e,t){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var i=0,o=this.pages.length,s=0;if(n.abs(e-this.absStartX)<this.snapThresholdX&&n.abs(t-this.absStartY)<this.snapThresholdY)return this.currentPage;for(e>0?e=0:e<this.maxScrollX&&(e=this.maxScrollX),t>0?t=0:t<this.maxScrollY&&(t=this.maxScrollY);i<o;i++)if(e>=this.pages[i][0].cx){e=this.pages[i][0].x;break}for(o=this.pages[i].length;s<o;s++)if(t>=this.pages[0][s].cy){t=this.pages[0][s].y;break}return i==this.currentPage.pageX&&(i+=this.directionX,i<0?i=0:i>=this.pages.length&&(i=this.pages.length-1),e=this.pages[i][0].x),s==this.currentPage.pageY&&(s+=this.directionY,s<0?s=0:s>=this.pages[0].length&&(s=this.pages[0].length-1),t=this.pages[0][s].y),{x:e,y:t,pageX:i,pageY:s}},goToPage:function(e,t,i,o){o=o||this.options.bounceEasing,e>=this.pages.length?e=this.pages.length-1:e<0&&(e=0),t>=this.pages[e].length?t=this.pages[e].length-1:t<0&&(t=0);var s=this.pages[e][t].x,a=this.pages[e][t].y;i=void 0===i?this.options.snapSpeed||n.max(n.max(n.min(n.abs(s-this.x),1e3),n.min(n.abs(a-this.y),1e3)),300):i,this.currentPage={x:s,y:a,pageX:e,pageY:t},this.scrollTo(s,a,i,o)},next:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;i++,i>=this.pages.length&&this.hasVerticalScroll&&(i=0,n++),this.goToPage(i,n,e,t)},prev:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;i--,i<0&&this.hasVerticalScroll&&(i=0,n--),this.goToPage(i,n,e,t)},_initKeys:function(e){var i,n={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(i in this.options.keyBindings)"string"==typeof this.options.keyBindings[i]&&(this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(i in n)this.options.keyBindings[i]=this.options.keyBindings[i]||n[i];l.addEvent(t,"keydown",this),this.on("destroy",function(){l.removeEvent(t,"keydown",this)})},_key:function(e){if(this.enabled){var t,i=this.options.snap,o=i?this.currentPage.pageX:this.x,s=i?this.currentPage.pageY:this.y,a=l.getTime(),r=this.keyTime||0,c=.25;switch(this.options.useTransition&&this.isInTransition&&(t=this.getComputedPosition(),this._translate(n.round(t.x),n.round(t.y)),this.isInTransition=!1),this.keyAcceleration=a-r<200?n.min(this.keyAcceleration+c,50):0,e.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?o+=i?1:this.wrapperWidth:s+=i?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?o-=i?1:this.wrapperWidth:s-=i?1:this.wrapperHeight;break;case this.options.keyBindings.end:o=i?this.pages.length-1:this.maxScrollX,s=i?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:o=0,s=0;break;case this.options.keyBindings.left:o+=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:s+=i?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:o-=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:s-=i?1:5+this.keyAcceleration>>0;break;default:return}if(i)return void this.goToPage(o,s);o>0?(o=0,this.keyAcceleration=0):o<this.maxScrollX&&(o=this.maxScrollX,this.keyAcceleration=0),s>0?(s=0,this.keyAcceleration=0):s<this.maxScrollY&&(s=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(o,s,0),this.keyTime=a}},_animate:function(e,t,i,n){function o(){var h,p,m,f=l.getTime();return f>=u?(s.isAnimating=!1,s._translate(e,t),void(s.resetPosition(s.options.bounceTime)||s._execEvent("scrollEnd"))):(f=(f-d)/i,m=n(f),h=(e-a)*m+a,p=(t-c)*m+c,s._translate(h,p),void(s.isAnimating&&r(o)))}var s=this,a=this.x,c=this.y,d=l.getTime(),u=d+i;this.isAnimating=!0,o()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":e._constructed||(e.preventDefault(),e.stopPropagation())}}},a.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(l.removeEvent(this.indicator,"touchstart",this),l.removeEvent(this.indicator,l.prefixPointerEvent("pointerdown"),this),l.removeEvent(this.indicator,"mousedown",this),l.removeEvent(t,"touchmove",this),l.removeEvent(t,l.prefixPointerEvent("pointermove"),this),l.removeEvent(t,"mousemove",this),l.removeEvent(t,"touchend",this),l.removeEvent(t,l.prefixPointerEvent("pointerup"),this),l.removeEvent(t,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(e){var i=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=i.pageX,this.lastPointY=i.pageY,this.startTime=l.getTime(),this.options.disableTouch||l.addEvent(t,"touchmove",this),this.options.disablePointer||l.addEvent(t,l.prefixPointerEvent("pointermove"),this),this.options.disableMouse||l.addEvent(t,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(e){var t,i,n,o,s=e.touches?e.touches[0]:e;l.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,t=s.pageX-this.lastPointX,this.lastPointX=s.pageX,i=s.pageY-this.lastPointY,this.lastPointY=s.pageY,n=this.x+t,o=this.y+i,this._pos(n,o),e.preventDefault(),e.stopPropagation()},_end:function(e){if(this.initiated){if(this.initiated=!1,e.preventDefault(),e.stopPropagation(),l.removeEvent(t,"touchmove",this),l.removeEvent(t,l.prefixPointerEvent("pointermove"),this),l.removeEvent(t,"mousemove",this),this.scroller.options.snap){var i=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),o=this.options.snapSpeed||n.max(n.max(n.min(n.abs(this.scroller.x-i.x),1e3),n.min(n.abs(this.scroller.y-i.y),1e3)),300);this.scroller.x==i.x&&this.scroller.y==i.y||(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=i,this.scroller.scrollTo(i.x,i.y,o,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(e){e=e||0,this.indicatorStyle[l.style.transitionDuration]=e+"ms",!e&&l.isBadAndroid&&(this.indicatorStyle[l.style.transitionDuration]="0.001s")},transitionTimingFunction:function(e){this.indicatorStyle[l.style.transitionTimingFunction]=e},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(l.addClass(this.wrapper,"iScrollBothScrollbars"),l.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(l.removeClass(this.wrapper,"iScrollBothScrollbars"),l.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=n.max(n.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=n.max(n.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var e=this.options.listenX&&n.round(this.sizeRatioX*this.scroller.x)||0,t=this.options.listenY&&n.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(e<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=n.max(this.indicatorWidth+e,8),this.indicatorStyle.width=this.width+"px"),e=this.minBoundaryX):e>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=n.max(this.indicatorWidth-(e-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",e=this.maxPosX+this.indicatorWidth-this.width):e=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),t<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=n.max(this.indicatorHeight+3*t,8),this.indicatorStyle.height=this.height+"px"),t=this.minBoundaryY):t>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=n.max(this.indicatorHeight-3*(t-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",t=this.maxPosY+this.indicatorHeight-this.height):t=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=e,this.y=t,this.scroller.options.useTransform?this.indicatorStyle[l.style.transform]="translate("+e+"px,"+t+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=e+"px",this.indicatorStyle.top=t+"px")},_pos:function(e,t){e<0?e=0:e>this.maxPosX&&(e=this.maxPosX),t<0?t=0:t>this.maxPosY&&(t=this.maxPosY),e=this.options.listenX?n.round(e/this.sizeRatioX):this.scroller.x,t=this.options.listenY?n.round(t/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(e,t)},fade:function(e,t){if(!t||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=e?250:500,n=e?0:300;e=e?"1":"0",this.wrapperStyle[l.style.transitionDuration]=i+"ms",this.fadeTimeout=setTimeout(function(e){this.wrapperStyle.opacity=e,this.visible=+e}.bind(this,e),n)}}},o.utils=l,"undefined"!=typeof e&&e.exports?e.exports=o:t.IScroll=o;
}(window,document,Math)},function(e,t,i){function n(){function e(){i&&(i.unset(),i.delClassNames("unavailable")),r="remove"}function t(){window.dofus.sendMessage("EmotePlayRequestMessage",{emoteId:n});var e=window.gui.pingSystem.getChatIcons();e.openPanel&&e.closePanels(),r="use"}s.call(this,{noHeader:!0});var i,n,o,r,l={};this.once("open",function(){l.useEmote=this._addEntry(a("ui.common.use"),t),l.remove=this._addEntry(a("ui.common.remove"),e),this._addCancel()}),this.on("open",function(e,t){e=e||{},i=e.slot,o=e.onClose,n=e.emoteId,r="",l.remove.toggleDisplay(!!e.canRemove),l.useEmote.toggleDisplay(!!e.hasOwnProperty("emoteId")),t()}),this.on("close",function(){o&&o(r)})}var o=i(172).inherits,s=i(433),a=i(29).getText;o(n,s),e.exports=n},function(e,t,i){function n(){s.call(this,{className:"ContextualMenuFightTeam"}),this.leaderId=0,this.fightId=0,this.once("open",this._setupDom),this.on("open",this._setContent)}i(441);var o=i(172).inherits,s=i(433),a=i(30),r=i(29).getText,l=i(194);o(n,s),e.exports=n,n.prototype._setupDom=function(){var e=this,t=this.entryList.createChild("div");this.teamMemberList=t.createChild("div",{className:"teamMemberList"}),this.actionsContainer=t.createChild("div"),this.buttonJoin=this._addEntry(r("ui.common.join"),function(){return e.isAlliancePrismFight?void l.open("social",{tabId:"alliance",tabParams:{tabId:"attacks"}}):e.isTaxCollectorFight?void l.open("social",{tabId:"guild",tabParams:{tabId:"perceptors"}}):void window.dofus.sendMessage("GameFightJoinRequestMessage",{fighterId:e.leaderId,fightId:e.fightId})}),this._addCancel()},n.prototype._setContent=function(e,t){var i=this;this.isAlliancePrismFight=!1,this.isTaxCollectorFight=!1,this.leaderId=e.leaderId,this.fightId=e.fightId,this.teamMemberList.clearContent();for(var n=e.teamMembers,o=[],s=0;s<n.length;s++){var l=n[s];switch(l._type){case"FightTeamMemberMonsterInformations":o.push(l.monsterId);break;case"FightTeamMemberCharacterInformations":case"FightTeamMemberWithAllianceCharacterInformations":case"FightTeamMemberTaxCollectorInformations":}}a.getDataMap("Monsters",o,function(e,o){if(e)return console.error(e);for(var s=0,a=r("ui.common.short.level")+" ",l=0;l<n.length;l++){var c=n[l],d=i.teamMemberList.createChild("div",{className:"teamMember"});switch(c._type){case"FightTeamMemberMonsterInformations":var u=c.grade,h=o[c.monsterId],p=h.grades[u-1].level;s+=p,d.setText(h.nameId+" ("+a+p+")"),3451===h.id&&(i.isAlliancePrismFight=!0);break;case"FightTeamMemberCharacterInformations":case"FightTeamMemberWithAllianceCharacterInformations":s+=c.level,d.setText(c.name+" ("+a+c.level+")");break;case"FightTeamMemberTaxCollectorInformations":i.isTaxCollectorFight=!0}}i.header.setText(r("ui.common.rank",s)),t()})}},function(e,t){},function(e,t,i){function n(){s.call(this),this.once("open",function(){this.buttonsContainer=this.entryList.createChild("div"),this._addCancel()}),this.on("open",function(e,t){this._update(e),t()})}var o=i(172).inherits,s=i(433),a=i(335);o(n,s),e.exports=n,n.prototype._update=function(e){function t(){i.close();var e=this.action;e.cb&&e.cb(e),i.emit("action",e)}var i=this;e=e||{};var n=e.actions||[];this.header.setText(e.title||""),this._displayHeader(!!e.title),this.buttonsContainer.clearContent();for(var o=0,s=n.length;o<s;o++){var r=n[o];if(!r.hidden){var l=this.buttonsContainer.appendChild(new a({className:"cmButton"},t));if(r.caption&&l.setText(r.caption),r.wuiDomChild&&l.appendChild(r.wuiDomChild),r.line)l.addClassNames("line");else{var c="";r.isTitle&&(c="title"),r.disabled?l.addClassNames(c,"disabled"):(r.ticked&&l.addClassNames(c,"ticked"),r.addClassNames&&l.addClassNames(r.addClassNames),l.addClassNames(c),l.action=r)}}}},n.sortMenuActions=function(e){e.sort(function(e,t){return e.caption.localeCompare(t.caption)})}},function(e,t,i){function n(){function e(){var e=window.isoEngine,i=e.mapRenderer.interactiveElements,n=i[this.elementId],o=this.skill;e.lastContextualMenuSkillId=o.skillId,e.actionQueue.enqueueInteractive(n.elementId,n.elementTypeId,function(){e.queueUseInteractive(n.elementId,o.skillInstanceUid)}),t.close()}a.call(this);var t=this;this.once("open",function(){this._setupDom()}),this.on("open",function(t,i){function n(t,i){var n=t._name||"skill "+t.skillId,o=s.actionsContainer.appendChild(new c({text:n,className:"cmButton"},e));return i?void o.disable():(o.elementId=a.elementId,void(o.skill=t))}var s=this,a=t||{};if(a.ageBonus?(this.starCounter.setValue(a.ageBonus),this.starCounter.show()):this.starCounter.hide(),a._houseData){u.getWindow("houseBuySell").prepareDialog(a._houseData);var r=a._houseData.houseId,d=window.gui.playerData.position.getHousePropertiesById(r);if(d){var p=d.ownerName;p="?"===p||""===p?l("ui.common.houseWithNoOwner"):p!==window.gui.playerData.identification.nickname?l("ui.house.homeOf",p):l("ui.common.myHouse"),this.banner.setContent({house:{houseOwner:p,houseName:d._name,houseId:d.houseId,forSale:d.isOnSale},guild:d.guildInfo}),this._displayHeader(!0)}else this._displayHeader(!1)}else a._name?(this.banner.setContent({name:a._name}),this._displayHeader(!0)):this._displayHeader(!1);if(this.actionsContainer.clearContent(),a.elementTypeId===o.ELEMENT_TYPE_ID.PADDOCK){var m=window.isoEngine.mapRenderer.getPaddockProperties();if(m.locked)return this.actionsContainer.createChild("div",{className:"cmButton",text:l("ui.social.paddockWithNoOwner")}),i()}var f,g;for(f=0,g=a.enabledSkills.length;f<g;f++)n(a.enabledSkills[f]);for(f=0,g=a.disabledSkills.length;f<g;f++)n(a.disabledSkills[f],!0);0===a.enabledSkills.length&&a.disabledSkills.length>0&&h(a.elementTypeId,a.disabledSkills),i()})}var o=i(167),s=i(172).inherits,a=i(433),r=i(444),l=i(29).getText,c=i(335),d=i(417),u=i(194),h=i(446).displayNotification;s(n,a),e.exports=n,n.prototype._setupDom=function(){this.banner=this.header.appendChild(new r);var e=this.entryList;this.starCounter=e.appendChild(new d),this.actionsContainer=e.createChild("div"),this._addCancel()}},function(e,t,i){function n(){o.call(this,"div",{className:"EntityBanner"}),this._guildEmblem=this.appendChild(new s({width:40,height:40}));var e=this.createChild("div",{className:"nameBox"});this._allianceEmblem=this.appendChild(new s({width:40,height:40})),this._guildName=e.createChild("div",{className:"guildName"}),this._name=e.createChild("div",{className:"name"}),this._houseName=e.createChild("div",{className:"houseName"}),this._houseOwner=e.createChild("div",{className:"houseOwner"}),this._forSale=e.createChild("div",{className:"forSale",text:a("ui.common.forSale")})}i(445);var o=i(321),s=i(422),a=i(29).getText,r=i(172).inherits;r(n,o),n.prototype.setContent=function(e){e=e||{},this._name.setText(e.name||""),this._name.toggleDisplay(!!e.name);var t,i=e.guild;i?(this._guildName.setText(i.guildName),this._guildName.show(),t=i.guildEmblem,t&&this._guildEmblem.setValue(t,!0),this._guildEmblem.show()):(this._guildName.hide(),this._guildEmblem.hide());var n=e.alliance;n?(this.addClassNames("alliance"),i?this._guildName.setText(i.guildName+" - ["+n.allianceTag+"]"):(this._guildName.setText(n.allianceName),this._guildName.show()),t=n.allianceEmblem,t&&(t.isAlliance=!0,this._allianceEmblem.setValue(t,!0),this._allianceEmblem.show())):(this.delClassNames("alliance"),this._allianceEmblem.hide());var o=e.house||{};this._houseOwner.setText(o.houseOwner||""),this._houseOwner.toggleDisplay(!!o.houseOwner),o.houseName&&(o.houseName+=window.gui.playerData.isModeratorOrMore()?" ("+o.houseId+")":"",this._houseName.setText(o.houseName)),this._houseName.toggleDisplay(!!o.houseName),this._forSale.toggleDisplay(!!o.forSale)},e.exports=n},function(e,t){},function(e,t,i){function n(e){for(var t="<ul>",i=0;i<e.length;i+=1){var n=e[i];t+="<li>"+n+"</li>"}return t+"</ul>"}function o(e){var t=window.gui.playerData.position.isInIncarnam(),i=t?m:f,o=t?g:_,s=window.gui.playerData.jobs.getJobNpcNameById(i),a=u("ui.skill.jobNotKnown",n(e.jobNameList))+"\n";return a+=u("ui.npc.learnJobs",s,o[0],o[1])}function s(e){for(var t,i=e.jobNameList,n=e.jobLevelList,o=e.levelMinList,s="<ul>",a=0;a<i.length;a+=1)t=u("ui.skill.levelLowJob",i[a],o[a],n[a]),s+="<li>"+t+"</li>";return s+="</ul>",u("ui.skill.levelLow",s)}function a(e){var t=u("ui.common.colon")+n(e.jobNameList);return u("ui.skill.toolNeeded",t)}function r(e){var t=[];for(var i in e){var n=e[i],o=v[n.type](n);t.push(o)}return t.join("\n")}function l(e,t){if(!e)return"jobNotKnown";if(e.experience.jobLevel<t._levelMin)return"levelLow";var i=window.gui.playerData.inventory.getCurrentWeapon()||{};return i.item&&e.info.toolIds.indexOf(i.item.id)!==-1?void 0:"toolNeeded"}function c(e,t){var i={type:"",jobNameList:[],jobLevelList:[],levelMinList:[]};return i.type=l(e,t),i.type&&(i.jobNameList.push(t._parentJobName),"levelLow"===i.type&&(i.jobLevelList.push(e.experience.jobLevel),i.levelMinList.push(t._levelMin))),i}function d(e){for(var t=window.gui.playerData.jobs.list,i={},n=[],o=0;o<e.length;o+=1){var s=e[o],a=s._parentJobId,r=c(t[a],s),l=r.type;if(l&&n.indexOf(a)===-1){if(i[l]){var d=i[l];d.jobNameList=d.jobNameList.concat(r.jobNameList),d.jobLevelList=d.jobLevelList.concat(r.jobLevelList),d.levelMinList=d.levelMinList.concat(r.levelMinList)}else i[l]=r;n.push(a)}}return i}var u=i(29).getText,h=i(194),p=i(321),m=849,f=601,g=[4,3],_=[1,-20],v={jobNotKnown:o,levelLow:s,toolNeeded:a};t.displayNotification=function(e,i){var n=window.gui.notificationBar,o="jobNotification"+e;if(n.isNotificationOpen(o))return n.removeNotification(o),void setTimeout(function(){t.displayNotification(e,i)},0);var s=i.filter(function(e){return e._parentJobId&&1!==e._parentJobId}),a=d(s),l=Object.keys(a).length;if(0!==l){l>1&&a.jobNotKnown&&delete a.jobNotKnown;var c=r(a),m=new p("div");m.setHtml(c);var f={type:n.notificationType.INFORMATION,title:u("ui.skill.disabled"),wuidom:m,iconId:27,iconColor:"yellow",timer:3e4};if(!a.jobNotKnown)return n.newNotification(o,f);var v=window.gui.playerData.position.isInIncarnam(),y=v?g:_,b=y[0],M=y[1];f.buttons=[{label:u("ui.npc.location"),action:function(){window.gui.GPS.addCustomFlag(b,M),h.open("worldMap",{x:b,y:M})}}],n.newNotification(o,f)}}},function(e,t,i){function n(){l.call(this);var e,t={},i={};this.once("open",function(){this._setupDom(t,i)}),this.on("open",function(n,o){this._params=n;var s=this._item=n.item;this._action=null,e=n.onClose;var a=s.objectUID?s:null,l=this._dbItem=a?a.item:s;this.header.setText(l.nameId||(l.mountLocation?c("ui.common.ride"):"")),i.backgroundImage=l.image;for(var d in t)t[d].hide();var h=window.gui.tutorialManager.inTutorial,m=!n.hasOwnProperty("enableSet")||n.enableSet,f=!n.hasOwnProperty("enableRecipe")||n.enableRecipe,g=!n.hasOwnProperty("enableInsertRecipe")||n.enableInsertRecipe,_=!n.hasOwnProperty("enableDestroy")||n.enableDestroy,v=!!n.hasOwnProperty("enableSell")&&n.enableSell,y=!n.hasOwnProperty("enableCertificate")||n.enableCertificate,b=!!l&&!h&&!l.mountLocation,M=!!a&&u.isItemInstanceWithMountInfo(a);if(t.itemSet.toggleDisplay(!!l.itemSetId&&l.itemSetId!==-1&&!h&&m),t.recipes.toggleDisplay(f&&b),t.insertItemStats.toggleDisplay(g&&b),t.insertRecipe.toggleDisplay(g&&b),t.findInBestiary.toggleDisplay(!!s.getProperty("dropMonsterIds").length),t.bidHouseSell.toggleDisplay(!!a&&v),t.dismount.toggleDisplay("equip"===l.mountLocation),t.remove.toggleDisplay(!!n.remove&&!h),t.mount.toggleDisplay(y&&M),a&&n.enableActions){var w=l.isEquippable()&&!r(s.position);t.feed.toggleDisplay(!!l.isPet&&!h),t.multiUse.toggleDisplay(!!l.usable&&s.quantity>1&&!!s.isOkForMultiUse&&!h),t.use.toggleDisplay(!!l.usable),t.target.toggleDisplay(p.isRoleplayMode&&!!l.targetable&&!l.nonUsableOnAnother&&!h),t.equip.toggleDisplay(w),t.unequip.toggleDisplay(r(s.position)),t.mount.toggleDisplay(M),t.destroy.toggleDisplay(s.quantity>0&&!h&&_),t.manage.toggleDisplay(!!s.livingObjectCategory&&!h),t.freeMimicry.toggleDisplay(a.isMimicryHost())}o()}),this.on("close",function(){e&&e(this._action)})}var o=i(448),s=i(317),a=i(172).inherits,r=i(461).isEquipped,l=i(433),c=i(29).getText,d=i(332),u=i(548),h=i(194),p=i(258),m=40;a(n,l),e.exports=n,n.prototype._setupDom=function(e,t){function i(e,t,i){n=e,l.open({min:t,max:i,x:a._position.x,y:a._position.y})}var n,a=this,r=window.gui.playerData.inventory,l=this._minMaxSelector=window.gui.windowsContainer.appendChild(new d);e.equip=this._addEntry(c("ui.common.equip"),function(){r.equipItem(a._item.objectUID)}),e.unequip=this._addEntry(c("tablet.common.unequip"),function(){r.unEquipItem(a._item.objectUID)});var u=e.target=this._addEntry(c("ui.common.target"),function(){return window.gui.openSimplePopup(c("tablet.ui.item.targetInfo"))});s.setDraggable(u,t,"itemContextMenu",null,{containerWidth:m,containerHeight:m}),u.on("dragStart",function(){this.item=a._item,h.closeAll(),a.close()}),e.feed=this._addEntry(c("ui.common.feed"),function(){var e=a._item.item,t=h.getWindow("feed");return t.possessFeedItemForPet(a._item)?void h.open("feed",{mode:"pet",item:a._item}):window.gui.openSimplePopup(c("ui.item.errorNoFoodLivingItem",e.nameId))}),e.use=this._addEntry(c("ui.common.use"),function(){var e=a._item;return e.item.type.needUseConfirm?void window.gui.openConfirmPopup({title:c("ui.common.confirm"),message:c("ui.common.confirmationUseItem",e.item.nameId),cb:function(t){t&&window.dofus.sendMessage("ObjectUseMessage",{objectUID:e.objectUID})}}):void window.dofus.sendMessage("ObjectUseMessage",{objectUID:e.objectUID})}),e.multiUse=this._addEntry(c("ui.common.multipleUse"),function(){i("use",1,a._item.quantity)}),e.insertItemStats=this._addEntry(c("ui.craft.displayChatItem"),function(){window.gui.chat.insertLink("itemStats",a._item)}),e.recipes=this._addEntry(c("ui.craft.associateReceipts"),function(){h.open("itemRecipes",{itemData:a._item||a._dbItem})}),e.insertRecipe=this._addEntry(c("ui.craft.displayChatRecipe"),function(){window.gui.chat.insertLink("recipe",a._item)}),e.findInBestiary=this._addEntry(c("ui.common.bestiary"),function(){var e=a._item.getRawName();h.open("grimoire",{tabId:"bestiary",tabParams:{search:e}})}),e.bidHouseSell=this._addEntry(c("tablet.itemSellInBidHouse"),function(){o.openBidHouse(!0,null,a._item)}),e.itemSet=this._addEntry(c("ui.common.set"),function(){h.open("itemSets",a._item)}),e.manage=this._addEntry(c("ui.item.manageItem"),function(){h.open("itemManage",{itemInstance:a._item})}),e.freeMimicry=this._addEntry(c("ui.mimicry.free"),function(){var e=a._item;window.gui.openConfirmPopup({message:c("ui.mimicry.confirmFreePopup",e.getName()),cb:function(t){t&&window.dofus.sendMessage("MimicryObjectEraseRequestMessage",{hostUID:e.objectUID,hostPos:e.position})}})}),e.mount=this._addEntry(c("ui.mount.viewMountDetails"),function(){h.getWindow("mount").showCertificateMount(a._item)}),e.dismount=this._addEntry(c("ui.shortcuts.toggleRide"),function(){window.dofus.sendMessage("MountToggleRidingRequestMessage")}),e.destroy=this._addEntry(c("ui.common.destroyThisItem"),function(){var e=a._item;return 1===e.quantity?void window.gui.playerData.inventory.confirmDestroyItem(e,1):void i("destroy",1,e.quantity)}),e.remove=this._addEntry(c("ui.common.remove"),function(){a._action="remove"}),l.on("confirm",function(e){var t=a._item;switch(n){case"use":window.dofus.sendMessage("ObjectUseMultipleMessage",{objectUID:t.objectUID,quantity:e});break;case"destroy":window.gui.playerData.inventory.confirmDestroyItem(t,e);break;default:console.warn("[ContextualMenuItem] unknow mode.")}}),this._addCancel()}},function(e,t,i){function n(){C.call(this,{className:"BidHouseShopWindow",freeContentDelay:x,positionInfo:{left:"0",bottom:"0",width:L,height:"100%"},title:v("ui.bidhouse.bigStoreItemList")}),this.openOnItem=null,this.backBtn=null,this.history=null,this.searchBox=null,this.isListening=!1,this.sortedAllowedTypes={},this.currentSearchText=null,this.currentSearchItemTypeMap=null,this.currentItemTypeElt=null,this.liveItemTypeId=null,this.liveItems=null,this._categoryToDisplay=null,this._categoryToDisplayItems=null,this._requestedCategories=[],this.on("open",this._onOpen),this.on("close",this._onClose)}function o(e,t,i){var n=A.getWindow(e);return n.openState?i&&i!==n.mode?(n.openOnItem=t,!1):(A.focusWindow(e),t&&n.navigateToItem(t),!0):(n.openOnItem=t,!1)}function s(){this.myWindow._goBackInHistory()}function a(e,t){var i=this.myWindow;i._selectItemType(e,t)}function r(e){A.getWindow("tradeItem").displayItem("buy-bidHouse",e),A.focusWindow("tradeItem")}function l(){var e=this.myWindow;e.shopViewer.refresh()}function c(e,t){return e.text.localeCompare(t.text)}function d(e){var t=this.myWindow;return t._sortAllowedTypes(e.info)}function u(e,t){var i=e.myDrilldownList.myWindow,n=i._sortAllowedTypes(e.info);return!!i.currentSearchItemTypeMap[n[t].id]}function h(e){for(var t=e.myDrilldownList.myWindow,i=t._sortAllowedTypes(e.info),n=0;n<i.length;n++)if(t.currentSearchItemTypeMap[i[n].id])return!0;return!1}function p(){this.searchBox.setValue(""),this._cancelSearch()}i(449);var m=i(335),f=i(202),g=i(450),_=i(458),v=i(29).getText,y=i(339),b=i(460),M=i(172).inherits,w=i(461),T=i(526),C=i(541),A=i(194),I=i(321),S=i(544),E=i(30),x=5e3,N=30,L=300,O=30;M(n,C),e.exports=n,n.minWidth=L,n.openBidHouse=function(e,t,i){if(e){if(o("tradeStorage",i,"modify-bidHouse"))return}else if(o("bidHouseShop",i))return;window.dofus.sendMessage("NpcGenericActionRequestMessage",{npcId:t||0,npcActionId:e?5:6,npcMapId:window.gui.playerData.position.mapId})},n.switchBuySellMode=function(e,t,i){var o=A.getWindow("tradeItem");if(!i){var s=o.getCurrentItem();s&&(i=s.getItemInstance()?s:s.getProperty("id"))}A.close("tradeItem"),window.dofus.sendMessage("LeaveDialogRequestMessage"),window.gui.once("ExchangeLeaveMessage",function(){n.openBidHouse(e,t,i)})},n.prototype._onOpen=function(e){A.arrangeOpeningWindowVertically(this.id,{below:"wallet",fullHeight:!0}),this.npcId=e.buyerDescriptor.npcContextualId,this.searchBox||(this._createContent(),this.isListening||this._setupEventListeners()),this.switchToSellModeBtn.enable(),this._showBlankUi(),this.openOnItem&&this.navigateToItem(this.openOnItem)},n.prototype._onClose=function(){A.close("tradeItem"),this.liveItemTypeId=null,this.liveItems=null},n.prototype._createContent=function(){this.history||(this.history=new b(O)),this._createBackButton(),this._createSearchBox(),this._createSwitchToSellModeButton(),this._createBidHouseCatList(),this._createViewer(),this._resetSearch()},n.prototype.freeContent=function(){this.windowBody.clearContent(),this.searchBox=this.bidHouseCatList=this.shopViewer=null,this.currentItemTypeElt=null,this._categoryToDisplayItems=null,this.sortedAllowedTypes={}},n.prototype._showBlankUi=function(){this.currentItemTypeElt=null,this._categoryToDisplayItems=null,this.bidHouseCatList.reset(),this._resetSearch()},n.prototype._sortAllowedTypes=function(e){if(this.sortedAllowedTypes[e])return this.sortedAllowedTypes[e];for(var t=window.gui.databases.BidHouseCategories[e].allowedTypes,i=window.gui.databases.ItemTypes,n=[],o=0;o<t.length;o++){var s=t[o];n.push({text:i[s].nameId,id:s})}return n.sort(c),this.sortedAllowedTypes[e]=n,n},n.prototype._selectItemType=function(e,t){this.currentItemTypeElt=e,t?this.bidHouseCatList.selectAndShowSubitem(e):this._pushHistory(),this._requestAndDisplayItemAvailability(e.data.id)},n.prototype._createBackButton=function(){if(!this.backBtn){var e=this.backBtn=new m({className:"backButton",hidden:!0},s);e.insertBefore(this.windowTitle),e.myWindow=this}},n.prototype._createSwitchToSellModeButton=function(){var e=this;this.switchToSellModeBtn=this.headerRow.appendChild(new m({addIcon:!0,className:["sellModeBtn","greenButton"],tooltip:v("ui.bidhouse.bigStoreModeSell")},function(){n.switchBuySellMode(!0,e.npcId),this.disable()}))},n.prototype._createSearchBox=function(){this.headerRow=this.windowBody.createChild("div",{className:"headerRow"});var e=this.searchBox=this.headerRow.appendChild(new S({maxLength:N}));e.on("search",this._search.bind(this))},n.prototype._createBidHouseCatList=function(){var e=this.bidHouseCatList=new g;e.myWindow=this,e.setSubitemsGetter(d),e.setFilter(h,u);var t=window.gui.databases.BidHouseCategories,i=[];for(var n in t)i.push({text:t[~~n].description,id:~~n});i.sort(c);for(var o=0;o<i.length;o++)e.addItem(i[o].text,i[o].id);e.getDom(this.windowBody).addClassNames("bidHouseCategories"),e.on("subitemSelected",a),e.on("resized",l)},n.prototype._searchAgainFromTop=function(){this.currentItemTypeElt=null,this._categoryToDisplayItems=null,this.bidHouseCatList.reset(),this._refreshDisplayedItems()},n.prototype._refreshFilter=function(){this._categoryToDisplayItems&&this._refreshDisplayedItems();var e=this.bidHouseCatList.refreshFilter();0===e.itemCount?(this.bidHouseCatList.toggleBreadcrumb(!1),this.bidHouseCatList.setPlaceholder(v("tablet.bidHouse.noCatHasMatchingItem",this.currentSearchText)),this.shopViewer.setPlaceholder(v("tablet.bidHouse.noMatchingItem",this.currentSearchText))):this.bidHouseCatList.setPlaceholder(null)},n.prototype._pushHistory=function(){0===this.history.getCurrentSize()&&this.backBtn.show();var e={bookmark:this.bidHouseCatList.getSubitemBookmark(this.currentItemTypeElt),search:this.currentSearchText};this.history.push(e)},n.prototype._goBackInHistory=function(){(this.currentItemTypeElt||this.currentSearchText)&&this.history.pop();var e=this.history.getLast();if(!e)return this.backBtn.hide(),this._showBlankUi();this.bidHouseCatList.toggleBreadcrumb(!1),this._search(e.search,!0);var t=this.bidHouseCatList.getSubitemByBookmark(e.bookmark);t?this._selectItemType(t,!0):this.bidHouseCatList.collapseAll()},n.prototype.navigateToItem=function(e,t){this.openOnItem=null;var i;i="number"==typeof e?w.items[e]:e.getItem();var n={};n[i.typeId]=!0,this.currentSearchItemTypeMap=n,this.currentSearchText=i.getNameForSearch(),this.searchBox.setValue(i.nameId),this._refreshFilter(),t||this._pushHistory()},n.prototype._search=function(e,t){if(null===e||""===e)return this._cancelSearch(t);var i=y.simplifyString(e);i!==this.currentSearchText&&(this.searchBox.searchInput.blur(),this.currentSearchText=i,this.bidHouseCatList.inBreadcrumbMode()||this._searchAgainFromTop(),t?this.searchBox.setValue(e):this._pushHistory(),this._searchItemsByName())},n.prototype._cancelSearch=function(e){this.searchBox.searchInput.blur(),this.currentSearchText&&(this.currentSearchText=null,this.bidHouseCatList.removeFilter(),this.bidHouseCatList.toggleBreadcrumb(!1),this.currentItemTypeElt&&this.bidHouseCatList.selectAndShowSubitem(this.currentItemTypeElt),this._categoryToDisplayItems&&this._refreshDisplayedItems(),e?this.searchBox.clear():this.currentItemTypeElt&&this._pushHistory())},n.prototype._resetSearch=function(){this.searchBox.clear(),this.currentSearchText=null,this._refreshDisplayedItems()},n.prototype._createViewer=function(){function e(e,t){var i=e.level-t.level;return 0!==i?i:e.nameId.localeCompare(t.nameId)}var t=[{id:"icon",format:function(e){var t=new I("div",{className:"slot"}),i=t.createChild("div",{className:"icon"});return i.setStyle("backgroundImage",e.image),t},sort:e,defaultSorter:!0},{id:"name",header:"",format:function(e){var t=new I("div",{className:"name",text:e.nameId});return e.etheral?t.addClassNames("etheral"):e.itemSetId&&t.addClassNames("itemSet"),t},getContent:function(e){return e.nameId},sort:!0}];this.shopViewer=this.windowBody.appendChild(new T(t,"id",{manualFiltering:!0,noAllCategory:!0})),this.shopViewer.on("itemSelected",r),this.shopViewer.myWindow=this;var i=new I("div",{className:"filterHeader"});this.shopViewerHeaderLabel=i.createChild("div",{className:"label",text:v("tablet.bidHouse.nowOnSale")}),this.shopViewerHeaderButton=i.appendChild(new _("",p.bind(this))),this.shopViewerHeaderButton.hide(),this.shopViewer.setHeader(i)},n.prototype._setupEventListeners=function(){this.isListening=!0;var e=this;f.on("ExchangeTypesExchangerDescriptionForUserMessage",function(t){e._requestedCategories.shift(),e._storeItemAvailability(t.typeDescription,!0)}),f.on("ExchangeBidHouseGenericItemAddedMessage",function(t){e._storeItemAvailability(t.objGenericId)}),f.on("ExchangeBidHouseGenericItemRemovedMessage",function(t){e._storeNonAvailableItem(t.objGenericId)})},n.prototype._shouldItemBeDisplayed=function(e){return e.typeId===this._categoryToDisplay&&(!this.currentSearchText||e.getNameForSearch().indexOf(this.currentSearchText)>=0)},n.prototype._refreshDisplayedItems=function(){var e=this._categoryToDisplayItems||[],t=!!e.length;if(e.length&&this.currentSearchText){for(var i=[],n=0;n<e.length;n++){var o=e[n];this._shouldItemBeDisplayed(o)&&i.push(o)}e=i}if(e.length>0&&this.bidHouseCatList.toggleBreadcrumb(!0),t&&this.currentSearchText){var s=v("tablet.common.filterHeader",this._categoryToDisplayItems.length-e.length);this.shopViewerHeaderLabel.setText(s),this.shopViewerHeaderButton.setLabel(this.currentSearchText),this.shopViewerHeaderButton.show(),this.shopViewer.table.setSortingHintVisible("name",!0)}else this.shopViewerHeaderLabel.setText(v("tablet.bidHouse.nowOnSale")),this.shopViewerHeaderButton.hide(),this.shopViewer.table.setSortingHintVisible("name",!1);if(!e.length){this.shopViewer.clearContent();var a;if(this._categoryToDisplayItems){var r=window.gui.databases.ItemTypes[this._categoryToDisplay].nameId;a=t?v("tablet.bidHouse.noMatchInCat",this.currentSearchText,r):v("tablet.bidHouse.nothingInCat",r)}else a=v("tablet.bidHouse.searchOrSelect");this.shopViewer.setPlaceholder(a)}this.shopViewer.setItemList(e)},n.prototype._requestAndDisplayItemAvailability=function(e){return e===this.liveItemTypeId?(this._categoryToDisplayItems=this.liveItems,this._refreshDisplayedItems()):(A.close("tradeItem"),this._categoryToDisplay=e,void(this._requestedCategories.indexOf(e)===-1&&(this._requestedCategories.push(e),this.liveItemTypeId=e,this.liveItems=null,this.shopViewer.setPlaceholder(" "),this.shopViewer.table.placeholder.frame.addClassNames("spinner"),window.dofus.sendMessage("ExchangeBidHouseTypeMessage",{type:e}))))},n.prototype._searchItemsByName=function(){this.searchBox.showAsSearching(!0);var e=this;E.searchDataMap("Items",{match:this.currentSearchText},function(t,i){if(t)return console.error(t),e.shopViewer.setPlaceholder(v("tablet.bidHouse.searchError"));var n={};for(var o in i){var s=i[~~o];n[s.typeId]=!0}e.currentSearchItemTypeMap=n,e._refreshFilter(),e.searchBox.showAsSearching(!1)})},n.prototype._storeItemAvailability=function(e,t){var i=e instanceof Array,n=i?e:[e],o=this;w.getItems(n,function(e,i){if(e)return console.error(e);if(o.openState&&(t||o.liveItems)){o.shopViewer.table.placeholder.frame.delClassNames("spinner");var n=o._categoryToDisplayItems===o.liveItems;o.liveItems=t?i:o.liveItems.concat(i),(n||t)&&(o._categoryToDisplayItems=o.liveItems,o._refreshDisplayedItems())}})},n.prototype._storeNonAvailableItem=function(e){if(this.openState&&this.liveItems){for(var t=this.liveItems.length-1;t>=0;t--)if(this.liveItems[t].id===e){this.liveItems.splice(t,1);break}var i=this._categoryToDisplayItems===this.liveItems;i&&this.shopViewer.removeItems([e])}}},function(e,t){},function(e,t,i){function n(){c.call(this),this._init()}function o(e){var t=this.myDrilldownList;e.isSelected=!1;var i=e===t.currentDeployedItem;t.deployItem(e,!i)}function s(){var e=this.myTopItem.myDrilldownList;return this===e.currentSubitem?e.toggleBreadcrumb(!0):void e._selectSubitem(this)}function a(){var e=this.myDrilldownList;e.toggleBreadcrumb(!1)}function r(e,t){e.toggleClassName("selected",t),e.subitemList.toggleDisplay(t)}i(451);var l=i(335),c=i(175).EventEmitter,d=i(172).inherits,u=i(452),h=i(321);d(n,c),e.exports=n,n.prototype._init=function(){this.parentElt=null,this.elt=null,this.items=[],this.infos=[],this.breadcrumb=null,this.list=null,this.currentDeployedItem=null,this.currentSubitem=null,this.isFilterOn=!1,this.itemFilterFunc=null,this.subitemFilterFunc=null,this.singleItem=null,this.singleSubitem=null},n.prototype.clearContent=function(){this.elt&&(this.elt.clearContent(),this._init())},n.prototype.reset=function(){if(this.elt){var e=this.currentDeployedItem;e&&this.deployItem(e,!1),this.refresh(!0),this._selectSubitem(null),this.removeFilter()}},n.prototype.setBreadcrumbText=function(e){this.breadcrumbText.setText(e)},n.prototype.inBreadcrumbMode=function(){return this.breadcrumb.isVisible()},n.prototype.toggleBreadcrumb=function(e){this.elt.toggleClassName("onlyBreadcrumb",e),this.breadcrumb.toggleDisplay(e),this.list.toggleDisplay(!e),this.emit("resized"),e||(this.list.refresh(),this.currentSubitem&&this.list.showElement(this.currentSubitem))},n.prototype.setSubitemsGetter=function(e){this.getSubitemsFunc=e},n.prototype.colorItems=function(){for(var e=!0,t=0;t<this.items.length;t++){var i=this.list.getItem(t);i.isVisible()&&(i.toggleClassName("odd",e),e=!e)}},n.prototype.getDom=function(e){if(this.elt)return this.elt;if(!this.items.length)return console.warn("Empty DrillDownList");this.parentElt=e;var t=this.elt=e.createChild("div",{className:"drillDownList"}),i=this.breadcrumb=t.appendChild(new l({className:"breadcrumb",hidden:!0,addIcon:"before",text:"_"},a));i.myDrilldownList=this,this.breadcrumbText=i.getChildren()[1],this.list=t.appendChild(new u({className:"tree"})),this.list.myDrilldownList=this;for(var n=0;n<this.items.length;n++){var s=new h("div",{className:"sublistHeader"});s.createChild("div",{className:"arrow"}),s.createChild("div",{className:"text",text:this.items[n]});var r=this.list.addItem({id:n,element:s},{noRefresh:!0});r.info=this.infos[n],r.myDrilldownList=this}return this.colorItems(),this.list.setStyle("max-height",e.rootElement.clientHeight+"px"),this.list.refresh(),this.list.on("selected",o),this.elt=t,t},n.prototype._createSubitemList=function(e){for(var t=this.getSubitemsFunc(e),i=e.subitemList=e.appendChild(new h("div",{className:"subitemList",hidden:!0})),n=0;n<t.length;n++){var o=t[n],a=void 0!==o.id?o.id:n,r=i.appendChild(new l({text:o.text,className:"subitem",name:a},s));r.data=o,r.myTopItem=e}},n.prototype.addItem=function(e,t){this.items.push(e),this.infos.push(void 0!==t?t:this.infos.length)},n.prototype.getItemCount=function(){return this.list.getItemCount()},n.prototype.getItem=function(e){return this.items[e]},n.prototype.getItemElt=function(e){return this.list.getItem(e)},n.prototype.getSubitemBookmark=function(e){return e?[e.myTopItem.id,e.getWuiName()]:null},n.prototype.getSubitemByBookmark=function(e){if(!e)return null;var t=this.list.getItem(e[0]);return t?(t.subitemList||this._createSubitemList(t),t.subitemList.getChild(e[1])):null},n.prototype.selectAndShowSubitem=function(e){this._selectSubitem(e,!1,!0),this.list.isVisible()&&(this.deployItem(e.myTopItem,!0),this.list.showElement(e))},n.prototype.collapseAll=function(){this.currentSubitem&&this.deselectSubitem(),this.currentDeployedItem&&this.deployItem(this.currentDeployedItem,!1)},n.prototype.deselectSubitem=function(){this._selectSubitem(null)},n.prototype._selectSubitem=function(e,t,i){var n=this.currentSubitem;return n&&n.delClassNames("selected"),this.currentSubitem=e,e?(this.setBreadcrumbText(this.items[e.myTopItem.id]+" > "+e.data.text),e.addClassNames("selected"),void(i||this.emit("subitemSelected",e,t))):this.toggleBreadcrumb(!1)},n.prototype.getSelectedSubitem=function(){return this.currentSubitem},n.prototype.setPlaceholder=function(e){this.list.setPlaceholderText(e)},n.prototype.refresh=function(e){this.colorItems(),this.list.refresh(),e&&this.list.goToTop()},n.prototype.setFilter=function(e,t){this.itemFilterFunc=e,this.subitemFilterFunc=t},n.prototype._filterOneItemSubitems=function(e){if(!this.isFilterOn)return this._resetFilterOnSubitems(e);for(var t,i=0,n=e.subitemList.getChildren(),o=0;o<n.length;o++){var s=n[o];this.subitemFilterFunc(e,o,s)?(i++,1===i&&(t=s),s.show()):s.hide()}return 1===i&&(this.singleSubitem=t),i},n.prototype.isItemDeployed=function(e){return e.subitemList&&e.subitemList.isVisible()},n.prototype.deployItem=function(e,t){if(t===this.isItemDeployed(e))return 0;t&&!e.subitemList&&this._createSubitemList(e);var i=this.currentDeployedItem;i&&e!==i&&r(i,!1),r(e,t),this.currentDeployedItem=t?e:null;
var n=0;return t&&(this.subitemFilterFunc?n=this._filterOneItemSubitems(e):(n=e.subitemList.getChildCount(),1===n&&(this.singleSubitem=e.subitemList.getChildren()[0]))),this.list.refresh(),this.list.showElement(e),n},n.prototype.refreshFilter=function(){this.isFilterOn=!0;for(var e,t=0,i=this.list.getItems(),n=i.length-1;n>=0;n--){var o=i[n];this.itemFilterFunc(o)?(t++,1===t&&(e=o),this.isItemDeployed(o)&&this.subitemFilterFunc&&this._filterOneItemSubitems(o),o.show()):o.hide()}var s=0;return 1===t&&(this.singleItem=e,s=this.deployItem(e,!0),1===s&&this._selectSubitem(this.singleSubitem,!0)),this.refresh(),{itemCount:t,subitemCount:s}},n.prototype._resetFilterOnSubitems=function(e){if(e.subitemList)for(var t=e.subitemList.getChildren(),i=0;i<t.length;i++)t[i].show()},n.prototype.removeFilter=function(){if(this.isFilterOn){this.isFilterOn=!1;for(var e=this.list.getItems(),t=e.length-1;t>=0;t--){var i=e[t];i.show(),this._resetFilterOnSubitems(i)}this.refresh(),this.currentSubitem&&(this.list.showElement(this.currentSubitem),this.emit("subitemSelected",this.currentSubitem,!0))}}},function(e,t){},function(e,t,i){i(453);var n=i(454),o=i(457);n.SingleSelectionList=o,e.exports=n},function(e,t){},function(e,t,i){function n(e,t){r.call(this,e),this.addClassNames("ListV2"),this.options=t||{},this.placeholder=null}var o=i(172).inherits,s=i(455),a=i(247).playUiSound,r=i(436),l=i(197);o(n,r),e.exports=n,n.prototype._createItem=function(e){e=e||{};var t=e.id,i=e.element;if(!t&&0!==t)return console.error("List: Invalid Id");var n=this.content.createChild("div",{name:t,className:"listItem"});return n.myList=this,n.id=t,n.data=e.data,"object"==typeof i?n.appendChild(i):n.setText(i),l(n),n.on("tap",this._tapHandler),n},n.prototype.addItem=function(e,t){t=t||{};var i=this._createItem(e);return t.noRefresh||this.refresh(),i},n.prototype.addItems=function(e,t){t=t||{};for(var i,n=0;n<e.length;n+=1)i=e[n],this._createItem(i);return t.noRefresh||this.refresh(),this.getItems()},n.prototype.removeItem=function(e){var t=this.getItem(e);t&&t.destroy()},n.prototype.selectItem=function(e,t){t=t||{};var i=this.getItem(e);i&&(i.isSelected=!0,i.addClassNames("selected"),t.noEvent||this.emit("selected",i),t.noSound||a("GEN_BUTTON"),t.scrollToElement&&this.scrollToElement(i))},n.prototype.deselectItem=function(e,t){t=t||{};var i=this.getItem(e);i&&(i.isSelected=!1,i.delClassNames("selected"),t.noEvent||this.emit("deselected",i),t.noSound||a("GEN_BUTTON"))},n.prototype.deselectAll=function(){for(var e=this.getItems(),t=0;t<e.length;t+=1){var i=e[t];i.isSelected&&this.deselectItem(i.getWuiName(),{noSound:!0})}},n.prototype.getItemCount=function(){return this.content.getChildCount()},n.prototype.getItem=function(e){return this.content.getChild(e)},n.prototype.getItems=function(){return this.content.getChildren()},n.prototype.getContentElement=function(){return this.content},n.prototype.clearContent=function(){this.content.clearContent()},n.prototype.setPlaceholderText=function(e){this.placeholder||(this.placeholder=new s(this)),this.placeholder.setText(e)},n.prototype._tapHandler=function(){var e=this.myList,t=this.getWuiName();return this.isSelected?void(e.options.disableSelectionToggle||e.deselectItem(t)):e.selectItem(t)}},function(e,t,i){function n(e,t){this.parent=e,this.options=t||{},this.frame=null,this.text=null}i(456);var o=i(436);e.exports=n,n.prototype.setText=function(e){return e?(this.frame||(this.frame=this.parent.createChild("div",{className:"placeholderFrame"}),this.options.headerElement&&this.frame.addClassNames("withHeader"),this.text=this.frame.createChild("div",{className:"placeholderText"})),this.options.noHeight||this._computeHeight(),this.text.setText(e),void this.frame.show()):this.frame&&this.frame.hide()},n.prototype._computeHeight=function(){var e=this.parent;e instanceof o&&(e=e.getParent());var t=e.rootElement.offsetHeight;this.options.headerElement&&(t-=this.options.headerElement.rootElement.offsetHeight),this.frame.setStyle("minHeight",t+"px")},n.prototype.toggleDisplay=function(e){this.frame&&this.frame.toggleDisplay(!!e)},n.prototype.refresh=function(){this.frame&&this.frame.isVisible()&&this.setText(this.text.getText())}},function(e,t){},function(e,t,i){function n(e,t){s.call(this,e,t),this.addClassNames("SingleSelectionList"),this.currentSelected=null}var o=i(172).inherits,s=i(454);o(n,s),e.exports=n,n.prototype.removeItem=function(e){var t=this.getItem(e);t&&(this.currentSelected=null),s.prototype.removeItem.call(this,e)},n.prototype.selectItem=function(e,t){this.currentSelected&&this.deselectItem(this.currentSelected.getWuiName(),{noSound:!0}),s.prototype.selectItem.call(this,e,t);var i=this.getItem(e);i&&(this.currentSelected=i)},n.prototype.deselectItem=function(e,t){var i=this.getItem(e);i&&i.isSelected&&(s.prototype.deselectItem.call(this,e,t),this.currentSelected=null)},n.prototype.deselectAll=function(){this.currentSelected&&this.deselectItem(this.currentSelected.getWuiName(),{noSound:!0})},n.prototype._tapHandler=function(){var e=this.myList;e.currentSelected&&e.currentSelected!==this&&e.deselectItem(e.currentSelected.getWuiName(),{noSound:!0}),s.prototype._tapHandler.call(this)}},function(e,t,i){function n(e,t,i){o.call(this,{className:"filterTagButton"},t),this.tapHandler=t,this.filterName=i;var n=this.createChild("div",{className:"btnBackground"});this._labelElement=n.createChild("div",{className:"btnText",text:e}),n.createChild("div",{className:"cross",text:"x"})}i(459);var o=i(335),s=i(172).inherits;s(n,o),e.exports=n,n.prototype.setLabel=function(e){this._labelElement.setText(e)}},function(e,t){},function(e,t){function i(e){this.maxSize=e,this.clear()}e.exports=i,i.prototype.clear=function(){this.buf=new Array(this.maxSize),this.first=0,this.last=0,this.empty=!0},i.prototype.isEmpty=function(){return this.empty},i.prototype.isFull=function(){return this.last===(this.first+this.maxSize-1)%this.maxSize},i.prototype.getCurrentSize=function(){return this.empty?0:(this.last-this.first+this.maxSize)%this.maxSize+1},i.prototype.push=function(e){var t;if(this.empty)this.buf[this.last]=e,this.empty=!1;else{var i=(this.last+1)%this.maxSize;i===this.first&&(t=this.buf[i],this.first=(i+1)%this.maxSize),this.buf[i]=e,this.last=i}return t},i.prototype.pop=function(){if(!this.empty){var e=this.buf[this.last];return this.buf[this.last]=void 0,this.first===this.last?this.empty=!0:this.last=(this.last+this.maxSize-1)%this.maxSize,e}},i.prototype.getFirst=function(){if(!this.empty)return this.buf[this.first]},i.prototype.getLast=function(){if(!this.empty)return this.buf[this.last]}},function(e,t,i){function n(e,t){this.price=e,this.timestamp=t}function o(e){var t=T[e];return t?t.price:-1}function s(e){var t=T[e];return!!t&&Date.now()-t.timestamp<6e4*C}function a(e,t){T[e]=new n(t,Date.now()),y[e]&&(y[e].averagePrice=t)}function r(e){a(e.genericId,e.averagePrice),e.genericId===A&&I(e.averagePrice)}function l(e,t){function i(){for(var t=[],i=0,n=e.length;i<n;i++){var o=y[e[i]];o&&t.push(o)}return t}function n(e){f.getDataMap("Items",r,function(t,i){if(t)return e(t);for(var n=0,o=r.length;n<o;n++){var s=r[n],a=i[s];if(a)c.push(new p(a)),l.push("gfx/items/"+a.iconId+".png");else{var d=M[s];delete M[s],d.emit("loaded")}}return e()})}function o(e){g.preloadImages(l,function(t){for(var i=0,n=t.length;i<n;i++){var o=c[i];y[o.id]=o,o.image=t[i];var s=M[o.id];delete M[o.id],s.loaded=!0,s.emit("loaded")}return e()})}function s(e){return u.length?void d.each(u,function(e,t){e.loaded?t():e.once("loaded",t)},e):e()}function a(e){return r.length?void d.series([n,o],function(t){return t?e(t):void p.initializeList(c,e)}):e()}for(var r=[],l=[],c=[],u=[],h=0,m=e.length;h<m;h++){var v=e[h];if(!y[v])if(M[v])u.push(M[v]);else{r.push(v);var b=M[v]=new _;b.loaded=!1}}return u.length||r.length?void d.parallel([a,s],function(e){return e?t(e):t(null,i())}):t(null,i())}function c(e,t,i){"function"==typeof t&&(i=t,t=null),Array.isArray(e)||(e=[e]);var n,o,s={},a=[];for(n=0,o=e.length;n<o;n+=1){var r=e[n];s[r.objectGID]=!0,a.push(new m(r))}return l(Object.keys(s),function(e){if(e)return console.warn(e),i(e);var s={};for(n=0,o=a.length;n<o;n+=1){var r=a[n];r.setItem(y[r.objectGID]||y[w]),s[r.objectUID]=r}m.initializeList(a,t,function(e){i(e,{map:s,array:a})})}),a}var d=i(31),u=i(462),h=i(464),p=i(465),m=i(525),f=i(30),g=i(182),_=i(188).EventEmitter,v=i(258);t.Item=p,t.ItemInstance=m;var y=t.items={},b=null,M={},w=666,T={},C=60,A=-1,I=null;t.getAveragePrice=o,t.getFreshAveragePrice=function(e,t){var i=o(e);return s(e)?t(i):(A=e,I=t,window.dofus.sendMessage("ExchangeBidHousePriceMessage",{genId:e}),void(T[e]=new n(i,Date.now())))},t.getItems=l,t.initialize=function(e){var t=window.dofus.connectionManager;b=window.gui.databases.ItemTypes;for(var i in b){var n=b[i];n.category=h.getCategory(n.superTypeId),n.possiblePositions=h.getTypePositions(n.superTypeId)}l([w],e);var o=function(){v.isFightMode||(v.removeListener("gameContextChanged",o),window.dofus.sendMessage("ObjectAveragePricesGetMessage"))};v.on("gameContextChanged",o),window.gui.on("ObjectAveragePricesMessage",function(e){for(var t=0,i=e.ids.length;t<i;t+=1)a(e.ids[t],e.avgPrices[t])}),t.on("ExchangeBidPriceMessage",r)},t.getItemTypeMap=function(){return b?b:void console.error(new Error("Fatal error: item types not loaded"))},t.createItemInstances=c,t.getCategoryName=h.getCategoryName,t.isEquippable=h.isEquippable,t.isEquipped=h.isEquipped,t.unlinkedItemsFilter=h.unlinkedItemsFilter,t.positions=u.positions,t.categories=u.categories},function(e,t,i){var n=i(463),o={amulet:0,weapon:1,ringLeft:2,belt:3,ringRight:4,boots:5,hat:6,cape:7,pets:8,dofus1:9,dofus2:10,dofus3:11,dofus4:12,dofus5:13,dofus6:14,shield:15,mount:16,mutation:20,boostFood:21,firstBonus:22,secondBonus:23,firstMalus:24,secondMalus:25,roleplayBuffer:26,follower:27,companion:28,notEquipped:63};e.exports.positions=o,t.superTypeNotEquippable=[n.RESOURCE,n.QUEST_OBJECT,n.MUTATION,n.BOOST_FOOD,n.BLESSING,n.CURSE,n.USABLE_OBJECT,n.ROLEPLAY_BUFF,n.MOUNT,n.FOLLOWER,n.CAPTURING_OBJECT,n.LIVING_OBJECT];var s=[!1,!0,!0,!0,!0,!0,!1,!0,!0,!1,!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0];e.exports.filterEquipment=s;var a=[!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];e.exports.filterConsumables=a;var r=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];e.exports.filterRessources=r;var l=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1];e.exports.filterQuest=l;var c={inventoryFull:1,cannotEquipTwice:2,notTradable:3,cannotDrop:4,cannotDropNoPlace:5,cannotDestroy:6,levelTooLow:7,livingObjectRefusedFood:8,cannotUnequip:9,cannotEquipHere:10,criterions:11,mimicryObjectError:12};e.exports.objectErrors=c;var d={equipment:0,consumables:1,resources:2,quest:3,preset:4};e.exports.categories=d;var u=[[],[o.amulet],[o.weapon],[o.ringLeft,o.ringRight],[o.belt],[o.boots],[],[o.shield],[o.weapon],[],[o.hat],[o.cape],[o.pets],[o.dofus1,o.dofus2,o.dofus3,o.dofus4,o.dofus5,o.dofus6],[],[o.mutation],[o.boostFood],[o.firstBonus,o.secondBonus],[o.firstMalus,o.secondMalus],[o.roleplayBuffer],[o.follower],[o.mount],[],[o.companion]];e.exports.itemTypePositions=u},function(e,t){e.exports={AMULET:1,WEAPON:2,RING:3,BELT:4,BOOTS:5,USABLE_OBJECT:6,SHIELD:7,CAPTURING_OBJECT:8,RESOURCE:9,HAT:10,CAPE:11,PET:12,DOFUS_OR_TROPHY:13,QUEST_OBJECT:14,MUTATION:15,BOOST_FOOD:16,BLESSING:17,CURSE:18,ROLEPLAY_BUFF:19,FOLLOWER:20,MOUNT:21,LIVING_OBJECT:22,SIDEKICK:23}},function(e,t,i){function n(e){return c.itemTypePositions[e]||[]}function o(e){var t=c.categories;switch(e){case t.equipment:return"equipment";case t.consumables:return"consumables";case t.resources:return"resources";case t.quest:return"quest";case t.preset:return"preset";default:return null}}function s(e){var t=c.categories;return c.filterEquipment[e]?t.equipment:c.filterConsumables[e]?t.consumables:c.filterRessources[e]?t.resources:c.filterQuest[e]?t.quest:t.preset}function a(e){return c.superTypeNotEquippable.indexOf(e)===-1}function r(e){return e!==c.positions.notEquipped}function l(e){return!e.isLinkedCharacter()}var c=i(462);e.exports.getTypePositions=n,e.exports.getCategoryName=o,e.exports.getCategory=s,e.exports.isEquippable=a,e.exports.isEquipped=r,e.exports.unlinkedItemsFilter=l},function(e,t,i){function n(e){for(var t in e)e[t]!==p[t]&&null!==e[t]&&(this[t]=e[t]);this.isWeapon="Weapon"===e._type,this.averagePrice=-1,this.etheral&&(this.descriptionId=l("ui.common.etherealWeaponDescription")),this.type=d.getItemTypeMap()[this.typeId],this.type||console.error("Item #"+this.id+" has invalid typeId #"+this.typeId),this.averagePrice=d.getAveragePrice(this.id)}function o(e,t){var i=[];if(!e||!e.criterions.length)return i;t=t||"";for(var n=e.criterions,o=0;o<n.length;o++){var s,r=n[o];if(r.criterions){s=[];for(var l=r.criterions,c=l.length,d=0;d<c;d++){var u=l[d],h=t+(0===d?"(":r.getOperatorText()+" ")+u.getText()+(d===c-1?")":"");s.push(h)}}else s=t+(0!==o&&r.operator===a.groupOperators.or?r.getOperatorText()+" ":"")+r.getText();""!==s&&i.push({text:s,isMalus:!r.isRespected()})}return i}var s=i(31),a=i(466),r=i(355),l=i(29).getText,c=i(339),d=i(461),u=i(30),h=i(463),p={id:null,nameId:null,typeId:null,descriptionId:null,iconId:null,level:null,realWeight:null,cursed:!1,useAnimationId:-1,usable:!1,targetable:!1,exchangeable:!1,price:null,twoHanded:!1,etheral:!1,itemSetId:-1,criteria:"null",criteriaTarget:"null",enhanceable:!1,nonUsableOnAnother:!1,appearanceId:null,secretRecipe:!1,recipeSlots:null,recipeIds:null,dropMonsterIds:null,bonusIsSecret:!1,hideEffects:!1,possibleEffects:null,favoriteSubAreas:null,favoriteSubAreasBonus:null};e.exports=n,n.initializeList=function(e,t){s.parallel([function(t){s.each(e,function(e,t){return e.criteria?(e.conditions=a.createGroupCriterion(e.criteria,e),void e.conditions.initialize(t)):t()},t)},function(t){s.each(e,function(e,t){return e.criteriaTarget?(e.targetConditions=a.createGroupCriterion(e.criteriaTarget,e),void e.targetConditions.initialize(t)):t()},t)},function(t){for(var i=[],n=0;n<e.length;n++)e[n].possibleEffects&&(i=i.concat(e[n].possibleEffects));r.createEffectInstances(i,function(i,n){if(i)return t(i);for(var o=0;o<e.length;o++){var s=e[o];if(s.possibleEffects){var a=s.possibleEffects.length,r=a>0?n.splice(0,a):[];r=r.filter(function(e){return e&&e.effect}),s.possibleEffectsMap={},s.possibleEffects=r;for(var l=0;l<r.length;l++)s.possibleEffectsMap[r[l].effectId]=r[l]}}t()})},function(t){s.each(e,function(e,t){return e.type.superTypeId!==h.PET?t():(e.isPet=!0,e.foodItems=[],e.foodTypes=[],void u.getData("Pets",e.id,function(i,n){return i||!n?t():(e.foodItems=n.foodItems,e.foodTypes=n.foodTypes,t())}))},t)},function(t){for(var i=[],n=[],o=0;o<e.length;o++){var s=e[o],a=s.itemSetId;a&&(i.push(a),n.push(s))}return i.length?void u.getDataMap("ItemSets",i,function(e,i){if(e)return t(e);for(var o=0;o<n.length;o++){var s=n[o],a=i[s.itemSetId];a?s.itemSetName=a.nameId:(console.error(new Error("ItemSet id "+s.itemSetId+" for item id "+s.id+" does not exist.")),s.itemSetName=null)}return t()}):t()}],t)},n.prototype.initialize=function(e){n.initializeList([this],e)},n.prototype.getRawName=function(){return this.nameId},n.prototype.getName=function(){var e=window.gui.playerData.isModeratorOrMore(),t=this.getRawName();return e&&(t+=" ("+this.id+")"),t},n.prototype.getNameForSearch=function(){return this._simplifiedName?this._simplifiedName:(this._simplifiedName=c.simplifyString(this.nameId),this._simplifiedName)},n.prototype._getStatsFormatted=function(){var e=[];if(!this.isWeapon)return console.error(new Error("getProperty('statsFormatted') should never be called on non-weapon Item")),e;var t=l("ui.stats.shortAP")+l("ui.common.colon")+this.apCost;this.maxCastPerTurn&&(t+=" ("+l("ui.item.usePerTurn",this.maxCastPerTurn)+")"),e.push(t);var i=l("ui.common.range")+l("ui.common.colon");if(i+=this.range===this.minRange?this.range:this.minRange+" - "+this.range,e.push(i),this.criticalFailureProbability||this.criticalHitProbability){var n="";if(this.criticalHitProbability){0!==this.criticalHitBonus&&e.push(l("ui.item.critical.bonus",this.criticalHitBonus)),n+=l("ui.common.short.CriticalHit")+l("ui.common.colon")+"1/"+this.criticalHitProbability;var o=window.gui.playerData.characters.mainCharacter.characteristics;if(o){var s=o.criticalHit,a=o.agility,r=s.alignGiftBonus+s.base+s.contextModif+s.objectsAndMountBonus,c=a.alignGiftBonus+a.base+a.contextModif+a.objectsAndMountBonus;c<0&&(c=0);var d=this.criticalHitProbability-r,u=parseInt(d*Math.E*1.1/Math.log(c+12),10),h=Math.min(d,u);h<2&&(h=2),e.push(l("ui.itemtooltip.itemCriticalReal","1/"+h))}}this.criticalFailureProbability&&(n+=(this.criticalHitProbability?" - ":"")+l("ui.common.short.CriticalFailure")+l("ui.common.colon")+"1/"+this.criticalFailureProbability),e.push(n)}return this.castInLine&&this.range>1&&e.push(l("ui.spellInfo.castInLine")),!this.castTestLos&&this.range>1&&e.push(l("ui.spellInfo.castWithoutLos")),e},n.prototype._getConditionsFormatted=function(){return o(this.conditions)},n.prototype._getTargetConditionsFormatted=function(){var e="("+l("ui.item.target")+") ";return o(this.targetConditions,e)},n.prototype.getSuperTypeId=function(){return this.type.superTypeId},n.prototype.isEquippable=function(){return d.isEquippable(this.type.superTypeId)};var m=[h.WEAPON,h.SHIELD,h.HAT,h.CAPE,h.PET,h.FOLLOWER,h.MOUNT,h.LIVING_OBJECT,h.SIDEKICK];n.prototype.isChangingCharacterLookWhenEquipped=function(){return m.indexOf(this.type.superTypeId)!==-1},n.prototype.getItem=function(){return this},n.prototype.getItemInstance=function(){return null},n.prototype.getProperty=function(e){return"nameId"===e?this.getName():"conditionsFormatted"===e?this._getConditionsFormatted():"targetConditionsFormatted"===e?this._getTargetConditionsFormatted():"statsFormatted"===e?this._getStatsFormatted():("weight"===e&&(e="realWeight"),this.hasOwnProperty(e)?this[e]:p[e])}},function(e,t,i){function n(e,t){var i=e.substring(0,2);return Q[i]?new Q[i](e,t):void console.warn("unknown criterion: "+i)}function o(e,t){return e=e.replace(/[\s+]/g,""),new s(e,this,t)}var s=i(467),a=i(468),r=i(470),l=i(471),c=i(472),d=i(473),u=i(486),h=i(487),p=i(489),m=i(490),f=i(491),g=i(492),_=i(493),v=i(494),y=i(495),b=i(496),M=i(497),w=i(498),T=i(499),C=i(500),A=i(501),I=i(502),S=i(503),E=i(504),x=i(505),N=i(506),L=i(507),O=i(508),D=i(509),R=i(510),P=i(511),B=i(512),k=i(513),z=i(514),F=i(515),H=i(516),q=i(517),W=i(518),U=i(519),G=i(520),j=i(521),Y=i(522),V=i(523),X=i(524),Q={Ca:D,CA:D,Cc:D,CC:D,Ce:D,CE:D,CD:D,CH:D,Ci:D,CI:D,CL:D,CM:D,CP:D,Cs:D,CS:D,Cv:D,CV:D,Cw:D,CW:D,Ct:D,CT:D,OA:r,PX:a,Ps:l,Pa:c,Oz:d,Ow:u,Ox:h,Po:p,PU:m,PG:f,Sy:g,Sd:_,PE:v,Pb:y,Pg:b,Pw:M,Py:w,Px:T,PJ:C,Pj:C,PK:A,PL:I,MK:S,PR:E,PQ:x,SG:N,PN:L,PO:O,Pp:R,PP:R,Qa:P,Qc:P,Qf:P,Pq:B,Pz:k,Pf:z,SI:F,PS:H,PA:q,Pr:W,PB:j,PT:U,Sc:G,PZ:Y,BI:V,PW:X};e.exports.createCriterion=n,e.exports.createGroupCriterion=o,e.exports.groupOperators=s.operators},function(e,t,i){function n(){c.or={token:"|",isRespectedFn:function(e){for(var t=0,i=e.length;t<i;t+=1)if(e[t].isRespected())return!0;return!1},text:l("ui.common.or")},c.and={token:"&",isRespectedFn:function(e){for(var t=0,i=e.length;t<i;t+=1)if(!e[t].isRespected())return!1;return!0},text:l("ui.common.and")}}function o(e,t,i){c.or||n(),this.criterions=[];for(var o="",s=!1,r=-1,l=!1,d=0,u=e.length;d<u;d+=1){var h=e[d];d===u-1?(o+=h,a(this.criterions,l,o,t,i)):s?")"===h?0===r?s=!1:(r-=1,o+=h):o+=h:"("===h?(r+=1,s=!0,l=!0):"&"===h||"|"===h?(a(this.criterions,l,o,t,i),r=-1,l=!1,this.operator="&"===h?c.and:c.or,o=""):o+=h}}function s(e,t){e.initialize(t)}var a,r=i(31),l=i(29).getText,c={};a=function(e,t,i,n,s){if(t)e.push(new o(i,n,s));else{var a=n.createCriterion(i,s);a&&e.push(a)}},o.prototype.initialize=function(e){r.each(this.criterions,s,e)},o.prototype.isRespected=function(){return!this.criterions.length||(1===this.criterions.length?this.criterions[0].isRespected():this.operator.isRespectedFn(this.criterions))},o.prototype.getOperatorText=function(){return this.operator?this.operator.text:""},o.prototype.getText=function(){for(var e=[],t=0,i=this.criterions.length;t<i;t+=1){var n=this.criterions[t];n.criterions?e.push("("+n.getText()+")"):e.push(n.getText())}return e.join(" "+this.operator.text+" ")},e.exports=o,e.exports.operators=c},function(e,t,i){function n(e){o.call(this,e),window.gui.playerData.identification.hasRights?this._text=s("ui.social.guildHouseRights")+" "+this.getOperatorText()+" "+this.getValueText():this._text=""}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return this._text},e.exports=n},function(e,t){function i(e){for(var t in n){var i=n[t].token;if(e.indexOf(i)!==-1){this.operator=n[t];var o=e.split(i);return this.key=o[0],this.rawValue=o[1],void(this.value=parseInt(this.rawValue,10))}}this.key=e.substring(0,2);var s=e.substring(2,3);this.operator={token:s,text:s,compareFn:function(){return!0}},this.rawValue=e.substring(3),this.value=parseInt(this.rawValue,10)}var n={superior:{token:">",compareFn:function(e,t){return e>t},text:" > "},inferior:{token:"<",compareFn:function(e,t){return e<t},text:" < "},equal:{token:"=",compareFn:function(e,t){return e===t},text:": "},different:{token:"!",compareFn:function(e,t){return e!==t},text:"! "}};i.prototype.initialize=function(e){e()},i.prototype.getOperatorText=function(){return this.operator?this.operator.text:""},i.prototype.getKeyText=function(){return this.key},i.prototype.getValueText=function(){return this.value},i.prototype.isRespected=function(){if(!this.operator)return!0;var e=this.operator.compareFn;return!!e&&e(this.getCriterion(),this.value)},i.prototype.getText=function(){return this.getKeyText()+" "+this.getOperatorText()+" "+this.getValueText()},i.prototype.getCriterion=function(){return 0},e.exports=i,e.exports.operators=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(30),r=i(172).inherits;r(n,o),n.prototype.initialize=function(e){var t=this;a.getData("Achievements",this.value,function(i,n){return i?e(i):(t._valueText=" '"+n.nameId+"'",t._keyText=s("ui.tooltip.unlockAchievement",[t._valueText]),void e())})},n.prototype.isRespected=function(){var e=window.gui.playerData.achievements.finishedAchievementsIds;return e.indexOf(this.value)!==-1},n.prototype.getKeyText=function(){return this._keyText},n.prototype.getOperatorText=function(){return this.operator===o.operators.different?s("ui.tooltip.dontUnlockAchievement",[this._valueText]):o.prototype.getOperatorText.call(this)},n.prototype.getValueText=function(){return this._valueText},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.common.alignment")},n.prototype.getOperatorText=function(){return this.operator===o.operators.different?" "+s("ui.common.differentFrom")+s("ui.common.colon"):o.prototype.getOperatorText.call(this)},n.prototype.getValueText=function(){return window.gui.databases.AlignmentSides[this.value].nameId},n.prototype.getCriterion=function(){return window.gui.playerData.characters.mainCharacter.characteristics.alignmentInfos.alignmentSide},e.exports=n},function(e,t,i){function n(e){o.call(this,e),this._text=s("ui.tooltip.AlignmentLevel")+" "+this.getOperatorText()+" "+this.value}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return this._text},n.prototype.getCriterion=function(){var e=window.gui.playerData;return e.characters.mainCharacter.characteristics.alignmentInfos.characterPower-e.id},e.exports=n},function(e,t,i){function n(e){a.call(this,e),this.operator===a.operators.equal?this._text=r("ui.criterion.allianceAvA"):this._text=""}var o=i(474),s=i(475),a=i(469),r=i(29).getText,l=i(485),c=i(172).inherits;c(n,a),n.prototype.getText=function(){return this._text},n.prototype.isRespected=function(){if(this.operator!==a.operators.equal)return!1;var e=window.gui.playerData,t=e.characters.mainCharacter.characteristics.alignmentInfos.aggressable;if(t!==o.AvA_ENABLED_AGGRESSABLE&&t!==o.AvA_PREQUALIFIED_AGGRESSABLE)return!1;var i=s.entities.prism[e.position.subAreaId];return!(!i||i.mapId===-1)&&i.state===l.PRISM_STATE_VULNERABLE},e.exports=n},function(e,t){e.exports={NON_AGGRESSABLE:0,PvP_ENABLED_AGGRESSABLE:10,PvP_ENABLED_NON_AGGRESSABLE:11,AvA_ENABLED_AGGRESSABLE:20,AvA_ENABLED_NON_AGGRESSABLE:21,AvA_DISQUALIFIED:22,AvA_PREQUALIFIED_AGGRESSABLE:23}},function(e,t,i){function n(e,t,i){i=i||{};var n=s[e][t]||{},a=o[e][t]={id:t,type:e,fighters:{},state:n.fightState,waitingForHelpInfo:n.waitingForHelpInfo};return a.fighters[f.allies]=i.allyCharactersInformations||[],a.fighters[f.enemies]=i.enemyCharactersInformations||[],h.emit("fightStarted",e,a),i.state===m.fighting&&h.emit("fighting",e,a),a}var o,s,a=i(188).EventEmitter,r=i(29).getText,l=i(476),c=l.TaxCollector,d=i(484),u=d.Prism,h=e.exports=new a,p=i(477),m=h.fightState=p.fightState,f=h.fightingSide=p.fightingSide,g=h.entityType=p.entityType;h._reset=function(){o=h.fights={},o[g.taxCollector]={},o[g.prism]={},s=h.entities={},s[g.taxCollector]={},s[g.prism]={}},h.isPlayerDefending=function(e,t){if(!g[e])return console.log("unknown entity type",e);var i=h.fights[e];for(var n in i){var o=i[n];if(o.state===m.waitingForHelp&&h.isPlayerFightingFor(t,e,n,f.allies))return parseInt(n,10)}return null},h.getAttackedEntity=function(e){return e.type&&e.hasOwnProperty("id")&&g[e.type]?h.entities[e.type][e.id]:console.log("wrong fight object")},h.isPlayerFightingFor=function(e,t,i,n){if(!g[t])return console.log("unknown entity type",t);var s=o[t][i];if(!s)return!1;for(var a=s.fighters[n],r=0,l=a.length;r<l;r+=1)if(a[r].id===e)return!0;return!1};var _=null;h.playerAutoKick=function(e,t){if(!g[e])return console.log("unknown entity type",e);var i=window.gui.playerData.id;e===g.taxCollector?window.dofus.sendMessage("GuildFightLeaveRequestMessage",{taxCollectorId:t,characterId:i}):window.dofus.sendMessage("PrismFightJoinLeaveRequestMessage",{subAreaId:t,join:!1}),_={type:e,fightId:t,playerId:i}},h.initialize=function(e){function t(e,t){o[e][t]&&(delete o[e][t],h.emit("fightEnded",e,t))}function i(e,t,i,n){var s=o[e][t];if(s){var a=s.fighters[i];a.push(n),h.emit("fighterJoined",e,t,i,n,a.length-1)}}function a(e,t,i,s){var a=o[e][t];a||(a=n(e,t)),a.fighters[i]=s,h.emit("fighterList",e,t,i,s)}function d(e,t,i,n){var s=o[e][t];if(s){for(var a=s.fighters[i],r=0,l=a.length;r<l;r+=1){var c=a[r].id;if(c===n)return a.splice(r,1),void h.emit("fighterLeft",e,t,i,n,r)}return console.error("unknown fighter id",n)}}h._reset(),e.on("disconnect",function(){h._reset()}),l.setupEvents(),e.on("TaxCollectorListMessage",function(e){var t,i=e.informations,o=s.taxCollector;for(t=0;t<i.length;t+=1){var a=new c(i[t]);o[a.id]=a}h.emit("taxCollectorList",g.taxCollector,i,e.nbcollectorMax);var r=e.fightersInformations;for(t=0;t<r.length;t+=1){var l=r[t];n(g.taxCollector,l.collectorId,l)}}),e.on("TaxCollectorMovementAddMessage",function(e){var i=new c(e.informations),a=s.taxCollector,r=!a.hasOwnProperty(i.id);if(a[i.id]=i,r)return void h.emit("entityAdded",g.taxCollector,i);if(h.emit("entityUpdated",g.taxCollector,i),i.fightState===m.noFight)t(g.taxCollector,i.id);else{var l=o[g.taxCollector][i.id];if(!l)return n(g.taxCollector,i.id);l.state=i.fightState,l.waitingForHelpInfo=i.waitingForHelpInfo,l.state===m.fighting&&h.emit("fighting",g.taxCollector,l)}}),e.on("TaxCollectorMovementRemoveMessage",function(e){var t=e.collectorId,i=s.taxCollector;i[t]&&(delete i[t],h.emit("entityRemoved",g.taxCollector,t))}),e.on("PrismsListMessage",function(e){for(var t=s.prism,i=e.prisms,n=0,o=i.length;n<o;n+=1){var a=new u(i[n]);t[a.id]=a}h.emit("prismList",g.prism,i)}),e.on("PrismsListUpdateMessage",function(e){for(var t=s.prism,i=e.prisms,n=0,o=i.length;n<o;n+=1){var a=i[n],r=t[a.subAreaId];r?(r.updateInfo(a),h.emit("entityUpdated",g.prism,r)):(r=new u(a),t[r.id]=r,h.emit("entityAdded",g.prism,r))}}),e.on("PrismsInfoValidMessage",function(e){for(var t=e.fights,i=s.prism,o=0,a=t.length;o<a;o+=1){var r=t[o],l=i[r.subAreaId];if(l){var c=r.allyCharactersInformations[0];c&&"3451"===c.name&&(l.look=c.entityLook,l.level=c.level,r.allyCharactersInformations.splice(0,1)),l.fightState=m.waitingForHelp,n(g.prism,r.subAreaId,r)}else console.warn("unknown prism",r.subAreaId)}}),e.on("PrismFightAddedMessage",function(e){var t=e.fight,i=s.prism[t.subAreaId];return i?void n(g.prism,t.subAreaId,t):console.warn("unknown prism",t.subAreaId)}),e.on("PrismFightRemovedMessage",function(e){t(g.prism,e.subAreaId)}),e.on("GuildFightPlayersHelpersJoinMessage",function(e){i(g.taxCollector,e.fightId,f.allies,e.playerInfo)}),e.on("PrismFightDefenderAddMessage",function(e){var t=e.defender;if("3451"===t.name){var n=s.prism[e.subAreaId];n.look=t.entityLook,n.level=t.level,h.emit("fightTarget",g.prism,e.subAreaId,n)}else i(g.prism,e.subAreaId,f.allies,t)}),e.on("PrismFightAttackerAddMessage",function(e){i(g.prism,e.subAreaId,f.enemies,e.attacker)}),e.on("GuildFightPlayersEnemiesListMessage",function(e){a(g.taxCollector,e.fightId,f.enemies,e.playerInfo)}),e.on("GuildFightPlayersEnemyRemoveMessage",function(e){d(g.taxCollector,e.fightId,f.enemies,e.playerId)}),e.on("GuildFightPlayersHelpersLeaveMessage",function(e){_&&_.type===g.taxCollector&&_.fightId===e.fightId&&_.playerId===e.playerId&&(window.gui.chat.logMsg(r("ui.social.guild.autoFightLeave")),_=null),d(g.taxCollector,e.fightId,f.allies,e.playerId)}),e.on("PrismFightDefenderLeaveMessage",function(e){_&&_.type===g.prism&&_.fightId===e.subAreaId&&_.playerId===e.fighterToRemoveId&&(window.gui.chat.logMsg(r("ui.prism.AutoDisjoin")),_=null),d(g.prism,e.subAreaId,f.allies,e.fighterToRemoveId)}),e.on("PrismFightAttackerRemoveMessage",function(e){d(g.prism,e.subAreaId,f.enemies,e.fighterToRemoveId)})}},function(e,t,i){function n(e){switch(e){case d.WAITING_FOR_HELP:return r.waitingForHelp;case d.FIGHTING:return r.fighting;default:return r.noFight}}function o(e){this.id=e.uniqueId,this.level=0,this.updateInfo(e)}var s=i(477),a=i(478),r=s.fightState,l=i(29).getText,c=i(339),d={NORMAL:0,WAITING_FOR_HELP:1,FIGHTING:2},u=i(483),h=i(366);t.TaxCollector=o,o.prototype.updateInfo=function(e){for(var t in e)this[t]=e[t];this.fightState=n(e.state);var i=c.getObjectInArrayById(e.complements,"_type","TaxCollectorWaitingForHelpInformations");i&&(this.waitingForHelpInfo=i.waitingForHelpInfo);var o=c.getObjectInArrayById(e.complements,"_type","TaxCollectorGuildInformations");o&&(this.guildId=o.guild.guildId,this.level=a.guilds[this.guildId].guildLevel)},o.prototype.getGuild=function(){return a.guilds[this.guildId]},o.prototype.getName=function(){return this.enrichData.firstName+" "+this.enrichData.lastName},o.prototype.getPosition=function(){return this.worldX+","+this.worldY},t.setupEvents=function(){var e=window.gui;e.on("TaxCollectorMovementMessage",function(e){var t=e.basicInfos,i=t.enrichData||{},n=i.firstName+" "+i.lastName,o=t.worldX+","+t.worldY,s="";s=e.hireOrFire?l("ui.social.TaxCollectorAdded",n,o,e.playerName):l("ui.social.TaxCollectorRemoved",n,o,e.playerName),window.gui.chat.logMsg(s,h.CHANNEL_GUILD)}),e.on("TaxCollectorAttackedMessage",function(e){var t=e.enrichData,i=t.firstName+" "+t.lastName,n=e.worldX+","+e.worldY;window.gui.chat.logMsg(l("ui.social.TaxCollectorAttacked",i,n),h.CHANNEL_GUILD)}),e.on("TaxCollectorErrorMessage",function(e){var t;switch(e.reason){case u.TAX_COLLECTOR_ALREADY_ONE:t=l("ui.social.alreadyTaxCollectorOnMap");break;case u.TAX_COLLECTOR_CANT_HIRE_HERE:t=l("ui.social.cantHireTaxCollecotrHere");break;case u.TAX_COLLECTOR_CANT_HIRE_YET:t=l("ui.social.cantHireTaxcollectorTooTired");break;case u.TAX_COLLECTOR_ERROR_UNKNOWN:t=l("ui.social.unknownErrorTaxCollector");break;case u.TAX_COLLECTOR_MAX_REACHED:t=l("ui.social.cantHireMaxTaxCollector");break;case u.TAX_COLLECTOR_NO_RIGHTS:t=l("ui.social.taxCollectorNoRights");break;case u.TAX_COLLECTOR_NOT_ENOUGH_KAMAS:t=l("ui.social.notEnougthRichToHireTaxCollector");break;
case u.TAX_COLLECTOR_NOT_OWNED:t=l("ui.social.notYourTaxcollector")}if(t){var i=window.gui.chat;i.logError(t)}}),e.on("TaxCollectorAttackedResultMessage",function(e){var t,i=e.basicInfos,n=i.enrichData||{},o=n.firstName+" "+n.lastName,s=i.worldX+","+i.worldY;t=e.deadOrAlive?l("ui.social.TaxCollectorDied",o,s):l("ui.social.TaxCollectorSurvived",o,s),window.gui.chat.logMsg(t,h.CHANNEL_GUILD)}),e.on("ExchangeGuildTaxCollectorGetMessage",function(e){for(var t=e.objectsInfos||[],i="",n=0;n<t.length;n+=1){i&&(i+=", ");var o=t[n],s=o.enrichData||{};i+=o.quantity+"x"+s.itemName}var a="";a=i?l("ui.social.thingsTaxCollectorGet",i,e.experience):l("ui.social.xpTaxCollectorGet",e.experience);var r=e.enrichData||{},c=l("ui.social.taxcollectorRecolted",r.firstName+" "+r.lastName,"("+e.worldX+", "+e.worldY+")",e.userName,a);window.gui.chat.logMsg(c,h.CHANNEL_GUILD)})}},function(e,t){t.fightState={noFight:0,waitingForHelp:1,fighting:2},t.fightingSide={allies:"allies",enemies:"enemies"},t.entityType={taxCollector:"taxCollector",prism:"prism"}},function(e,t,i){var n=i(29).getText,o=i(479),s=i(481),a=i(194);t.Emblem=i(480),t.GuildRightsBitEnum=i(482);var r=t.guilds={};t.createGuild=function(e){var t=new o(e);return r[t.guildId]=t,t},t.initialize=function(e){function t(e){a.getWindow("guildCard").display(e)}e.on("GuildCreationResultMessage",function(e){switch(e.result){case s.SOCIAL_GROUP_CREATE_ERROR_ALREADY_IN_GROUP:return window.gui.openSimplePopup(n("ui.guild.alreadyInGuild"));case s.SOCIAL_GROUP_CREATE_ERROR_EMBLEM_ALREADY_EXISTS:return window.gui.openSimplePopup(n("ui.guild.AlreadyUseEmblem"));case s.SOCIAL_GROUP_CREATE_ERROR_NAME_ALREADY_EXISTS:return window.gui.openSimplePopup(n("ui.guild.AlreadyUseName"));case s.SOCIAL_GROUP_CREATE_ERROR_NAME_INVALID:return window.gui.openSimplePopup(n("ui.guild.invalidName"));case s.SOCIAL_GROUP_CREATE_ERROR_REQUIREMENT_UNMET:return window.gui.openSimplePopup(n("ui.guild.requirementUnmet"));case s.SOCIAL_GROUP_CREATE_OK:return a.close("socialGroupCreation");case s.SOCIAL_GROUP_CREATE_ERROR_EMBLEM_INVALID:case s.SOCIAL_GROUP_CREATE_ERROR_UNKNOWN:return window.gui.openSimplePopup(n("ui.common.unknownFail"))}}),e.on("GuildInAllianceFactsMessage",t),e.on("GuildFactsMessage",t),window.dofus.connectionManager.on("GuildFactsErrorMessage",function(){e.chat.logMsg(n("ui.guild.doesntExistAnymore"))})},t.openGuildCard=function(e){window.dofus.sendMessage("GuildFactsRequestMessage",{guildId:e})}},function(e,t,i){function n(e){a.call(this),this.guildId=0,this.guildName="",this.guildEmblem=new s,this.guildLevel=0,this.creationDate=0,this.leaderId=0,this.leaderName="",this.nbMembers=0,this.nbConnectedMembers=0,this.nbTaxCollectors=0,this.averageMemberLevel=0,this.lastActivity=0,this.enabled=!1,this.allianceId=0,this.allianceName="",this.allianceLeader=!1,this.experiencePercentage=0,this.members=[],this.update(e)}function o(e,t,i){i.hasOwnProperty(t)&&void 0!==i[t]&&e.hasOwnProperty(t)&&(e[t]=i[t])}var s=i(480),a=i(188).EventEmitter,r=i(29).getText,l=i(172).inherits,c=i(339);l(n,a),n.prototype.update=function(e){for(var t in e)o(this,t,e);"#NONAME#"===this.guildName&&(this.guildName=r("ui.guild.noName")),"#NONAME#"===this.allianceName&&(this.allianceName=r("ui.guild.noName"))},n.prototype.getHoursSinceLastConnection=function(){if(!this.lastActivity)return 0;var e=new Date;return Math.floor((e.time-1e3*this.lastActivity)/36e5)},n.prototype.getMembersByRank=function(){var e=window.gui.databases.RankNames,t=this.members,i=[];for(var n in t){var o=t[n];o.rankOrder=e[o.rank].order,i.push(o)}return c.sortObjectInArray(i,"rankOrder"),i},e.exports=n},function(e,t){function i(e){e=e||{},this.symbolShape=e.symbolShape||0,this.symbolColor=e.symbolColor||0,this.backgroundShape=e.backgroundShape||0,this.backgroundColor=e.backgroundColor||0}e.exports=i},function(e,t){e.exports={SOCIAL_GROUP_CREATE_OK:1,SOCIAL_GROUP_CREATE_ERROR_NAME_INVALID:2,SOCIAL_GROUP_CREATE_ERROR_ALREADY_IN_GROUP:3,SOCIAL_GROUP_CREATE_ERROR_NAME_ALREADY_EXISTS:4,SOCIAL_GROUP_CREATE_ERROR_EMBLEM_ALREADY_EXISTS:5,SOCIAL_GROUP_CREATE_ERROR_LEAVE:6,SOCIAL_GROUP_CREATE_ERROR_CANCEL:7,SOCIAL_GROUP_CREATE_ERROR_REQUIREMENT_UNMET:8,SOCIAL_GROUP_CREATE_ERROR_EMBLEM_INVALID:9,SOCIAL_GROUP_CREATE_ERROR_TAG_INVALID:10,SOCIAL_GROUP_CREATE_ERROR_TAG_ALREADY_EXISTS:11,SOCIAL_GROUP_CREATE_ERROR_NEEDS_SUBGROUP:12,SOCIAL_GROUP_CREATE_ERROR_UNKNOWN:99}},function(e,t){e.exports={GUILD_RIGHT_NONE:0,GUILD_RIGHT_BOSS:4,GUILD_RIGHT_MANAGE_GUILD_BOOSTS:2,GUILD_RIGHT_MANAGE_RIGHTS:1024,GUILD_RIGHT_INVITE_NEW_MEMBERS:8,GUILD_RIGHT_BAN_MEMBERS:16,GUILD_RIGHT_MANAGE_XP_CONTRIBUTION:32,GUILD_RIGHT_MANAGE_RANKS:64,GUILD_RIGHT_HIRE_TAX_COLLECTOR:128,GUILD_RIGHT_MANAGE_MY_XP_CONTRIBUTION:256,GUILD_RIGHT_COLLECT:512,GUILD_RIGHT_USE_PADDOCKS:4096,GUILD_RIGHT_ORGANIZE_PADDOCKS:8192,GUILD_RIGHT_TAKE_OTHERS_MOUNTS_IN_PADDOCKS:16384,GUILD_RIGHT_DEFENSE_PRIORITY:32768,GUILD_RIGHT_COLLECT_MY_TAX_COLLECTOR:65536,GUILD_RIGHT_SET_ALLIANCE_PRISM:131072,GUILD_RIGHT_TALK_IN_ALLIANCE_CHAN:262144}},function(e,t){e.exports={TAX_COLLECTOR_ERROR_UNKNOWN:0,TAX_COLLECTOR_NOT_FOUND:1,TAX_COLLECTOR_NOT_OWNED:2,TAX_COLLECTOR_NO_RIGHTS:3,TAX_COLLECTOR_MAX_REACHED:4,TAX_COLLECTOR_ALREADY_ONE:5,TAX_COLLECTOR_CANT_HIRE_YET:6,TAX_COLLECTOR_CANT_HIRE_HERE:7,TAX_COLLECTOR_NOT_ENOUGH_KAMAS:8}},function(e,t,i){function n(e){switch(e){case l.PRISM_STATE_ATTACKED:return a.waitingForHelp;case l.PRISM_STATE_FIGHTING:return a.fighting;default:return a.noFight}}function o(e){for(var t in e)this[t]=e[t];this.id=e.subAreaId,this.fightState=e.prism?n(e.prism.state):a.noFight}var s=i(477),a=s.fightState,r=i(29).getText,l=i(485),c=i(366),d=i(28);t.Prism=o,o.prototype.updateInfo=function(e){for(var t in e)this[t]=e[t];if(!e.prism)return void delete this.prism;var i=n(e.prism.state);if(i===a.waitingForHelp&&this.fightState!==a.waitingForHelp){var o=e.enrichData.subAreaName+" ("+e.enrichData.areaName+")";window.gui.chat.logMsg(r("ui.prism.attacked",o,this.getPosition()),c.CHANNEL_ALLIANCE)}var s=this.getAlliance();s.allianceEmblem.isAlliance=!0,this.fightState=i},o.prototype.getPlacementDate=function(){return new d.DofusDate(this.prism.placementDate).getServerDate().toString().date},o.prototype.getName=function(){var e=window.gui.playerData.alliance.current;return r("ui.zaap.prism")+" "+e.allianceName},o.prototype.getPosition=function(){return this.worldX+","+this.worldY},o.prototype.getAlliance=function(){if(this.prism)return"AllianceInsiderPrismInformation"===this.prism._type?window.gui.playerData.alliance.current:this.prism.alliance}},function(e,t){e.exports={PRISM_STATE_INVULNERABLE:0,PRISM_STATE_NORMAL:1,PRISM_STATE_ATTACKED:2,PRISM_STATE_FIGHTING:3,PRISM_STATE_WEAKENED:4,PRISM_STATE_VULNERABLE:5,PRISM_STATE_DEFEATED:6}},function(e,t,i){function n(e){o.call(this,e),0===this.value?this._text=s("ui.criterion.noAlliance"):1===this.value?this._text=s("ui.criterion.hasAlliance"):this._text=s("ui.criterion.hasValidAlliance")}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return this._text},n.prototype.getCriterion=function(){var e=window.gui.playerData.alliance;return e.hasAlliance()?e.current.enabled?2:1:0},e.exports=n},function(e,t,i){function n(e){switch(e){case r.ALLIANCE_RIGHT_BOSS:return a("ui.guild.right.leader");case r.ALLIANCE_RIGHT_KICK_GUILDS:return a("ui.social.guildRightsBann");case r.ALLIANCE_RIGHT_MANAGE_PRISMS:return a("ui.social.guildRightsSetAlliancePrism");case r.ALLIANCE_RIGHT_MANAGE_RIGHTS:return a("ui.social.guildManageRights");case r.ALLIANCE_RIGHT_RECRUIT_GUILDS:return a("ui.social.guildRightsInvit");case r.ALLIANCE_RIGHT_TALK_IN_CHAN:return a("ui.social.guildRightsTalkInAllianceChannel");default:return""}}function o(e){s.call(this,e);var t=n(this.value);this.operator===s.operators.equal?this._text=a("ui.criterion.allianceRights",[t]):this._text=a("ui.criterion.notAllianceRights",[t])}var s=i(469),a=i(29).getText,r=i(488),l=i(172).inherits;r.ALLIANCE_RIGHT_MANAGE_PRISMS=2,r.ALLIANCE_RIGHT_TALK_IN_CHAN=4,r.ALLIANCE_RIGHT_RECRUIT_GUILDS=8,r.ALLIANCE_RIGHT_KICK_GUILDS=16,r.ALLIANCE_RIGHT_MANAGE_RIGHTS=32,l(o,s),o.prototype.getText=function(){return this._text},o.prototype.isRespected=function(){var e=window.gui.playerData.alliance;if(!e.hasAlliance())return this.operator===s.operators.equal;var t=this.value!==r.ALLIANCE_RIGHT_BOSS||e.isBoss();return this.operator===s.operators.equal?t:this.operator===s.operators.equal&&!t},e.exports=o},function(e,t){e.exports={ALLIANCE_RIGHT_NONE:0,ALLIANCE_RIGHT_BOSS:1}},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){var e=window.gui.playerData.position.area.nameId;return this.operator===o.operators.equal?s("ui.tooltip.beInArea",[e]):s("ui.tooltip.dontBeInArea",[e])},n.prototype.getCriterion=function(){return window.gui.playerData.position.area.id},e.exports=n},function(e,t,i){function n(e){o.call(this,e),0===this.value&&"B"===this.key?this._text=s("ui.criterion.initialBones"):this._text=s("ui.criterion.bones")+" "+this.getOperatorText()+" "+this.value}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return this._text},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.entityLook.bonesId},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=window.gui.databases.Breeds[this.value].shortNameId;this.operator===o.operators.equal?this._text=s("ui.tooltip.beABreed",[t]):this._text=s("ui.tooltip.dontBeABreed",[t])}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return this._text},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.breed},e.exports=n},function(e,t,i){function n(e){o.call(this,e),this._communityId=window.gui.playerData.identification.communityId}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.initialize=function(e){var t=this,i=window.gui.serversData;i.syncServerStaticData(function(n){return n?(console.error("ServerDetails setServer error",n),e(n)):(t._communityName=i.staticContent.communities[t._communityId],void e())})},n.prototype.getText=function(){return this.operator===o.operators.equal?s("ui.criterion.community",[this._communityName]):s("ui.criterion.notCommunity",[this._communityName])},n.prototype.getCriterion=function(){return this._communityId},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.time.days",1)},n.prototype.getCriterion=function(){var e=new Date;return e.getDate()},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(30),r=i(172).inherits,l={};r(n,o),n.prototype.initialize=function(e){var t=this.value,i=l[t];if(i)return this._emoticonData=i,e();if(i=window.gui.playerData.emoteData.list[t])return this._emoticonData=i,e();var n=this;a.getData("Emoticons",this.value,function(t,i){return t?e(t):(l[i.id]=i,n._emoticonData=i,void e())})},n.prototype.isRespected=function(){return window.gui.playerData.emoteData.list.hasOwnProperty(this.value)},n.prototype.getText=function(){var e=s(this.operator===o.operators.different?"ui.tooltip.dontPossessEmote":"ui.tooltip.possessEmote");return e+" '"+this._emoticonData.nameId+"'"},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172);a.inherits(n,o),n.prototype.getKeyText=function(){return s("ui.tooltip.playerInFriendlist")},n.prototype.getCriterion=function(){return Object.keys(window.gui.playerData.socialData.friendsList).length},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=this.key.split(",");t.length>1?(this._giftId=parseInt(t[0],10),this._giftLevel=parseInt(t[1],10)):(this._giftId=parseInt(this.value,10),this._giftLevel=-1)}var o=i(469),s=i(29).getText,a=i(172);a.inherits(n,o),n.prototype.getText=function(){var e=window.gui.databases.AlignmentGift,t=e[this._giftId]?e[this._giftId].nameId:"";return this.operator===o.operators.superior?s("ui.pvp.giftRequired",[t+" > "+this._giftLevel]):s("ui.pvp.giftRequired",[t])},n.prototype.isRespected=function(){var e=window.gui.playerData.alignmentRank,t=window.gui.databases.AlignmentRankJntGift[e];if(!t||!t.gifts)return!1;for(var i=0,n=t.gifts.length;i<n;i+=1)if(t.gifts[i]===this._giftId)return!this._giftLevel||t.levels[i]>this._giftLevel;return!1},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return s(0===this.value?"ui.criterion.noguild":1===this.value?"ui.criterion.hasGuild":"ui.criterion.hasValidGuild")},n.prototype.getCriterion=function(){var e=window.gui.playerData.guild;return e.hasGuild()?e.current.enabled?2:1:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.guild.guildLevel")},n.prototype.getCriterion=function(){var e=window.gui.playerData.guild;return e.hasGuild()?e.current.guildLevel:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(478).GuildRightsBitEnum,r=i(172).inherits;r(n,o),n.prototype.getText=function(){var e;switch(this.value){case a.GUILD_RIGHT_BOSS:e=s("ui.guild.right.leader");break;case a.GUILD_RIGHT_BAN_MEMBERS:e=s("ui.social.guildRightsBann");break;case a.GUILD_RIGHT_COLLECT:e=s("ui.social.guildRightsCollect");break;case a.GUILD_RIGHT_COLLECT_MY_TAX_COLLECTOR:e=s("ui.social.guildRightsCollectMy");break;case a.GUILD_RIGHT_DEFENSE_PRIORITY:e=s("ui.social.guildRightsPrioritizeMe");break;case a.GUILD_RIGHT_HIRE_TAX_COLLECTOR:e=s("ui.social.guildRightsHiretax");break;case a.GUILD_RIGHT_INVITE_NEW_MEMBERS:e=s("ui.social.guildRightsInvit");break;case a.GUILD_RIGHT_MANAGE_GUILD_BOOSTS:e=s("ui.social.guildRightsBoost");break;case a.GUILD_RIGHT_MANAGE_MY_XP_CONTRIBUTION:e=s("ui.social.guildRightManageOwnXP");break;case a.GUILD_RIGHT_MANAGE_RANKS:e=s("ui.social.guildRightsRank");break;case a.GUILD_RIGHT_MANAGE_RIGHTS:e=s("ui.social.guildManageRights");break;case a.GUILD_RIGHT_MANAGE_XP_CONTRIBUTION:e=s("ui.social.guildRightsPercentXP");break;case a.GUILD_RIGHT_ORGANIZE_PADDOCKS:e=s("ui.social.guildRightsMountParkArrange");break;case a.GUILD_RIGHT_SET_ALLIANCE_PRISM:e=s("ui.social.guildRightsSetAlliancePrism");break;case a.GUILD_RIGHT_TALK_IN_ALLIANCE_CHAN:e=s("ui.social.guildRightsTalkInAllianceChannel");break;case a.GUILD_RIGHT_TAKE_OTHERS_MOUNTS_IN_PADDOCKS:e=s("ui.social.guildRightsManageOtherMount");break;case a.GUILD_RIGHT_USE_PADDOCKS:e=s("ui.social.guildRightsMountParkUse");break;default:e=""}return this.operator===o.operators.equal?s("ui.criterion.guildRights",[e]):s("ui.criterion.notGuildRights",[e])},n.prototype.isRespected=function(){var e=window.gui.playerData.guild;if(!e.hasGuild())return this.operator===o.operators.different;var t=e.hasRight(this.value);return this.operator===o.operators.equal?t:!t},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=this.rawValue.split(",");t.length>1?(this._jobId=parseInt(t[0],10),this._jobLevel=parseInt(t[1],10)):(this._jobId=parseInt(this.value,10),this._jobLevel=-1)}var o=i(469),s=i(29).getText,a=i(30),r=i(172);r.inherits(n,o),n.prototype.initialize=function(e){var t=this;a.getData("Jobs",this._jobId,function(i,n){return i?e(i):(t._jobName=n&&n.nameId,void e())})},n.prototype.getText=function(){if(!this._jobName)return"";var e=this._jobName,t="";switch(this._jobLevel>=0&&(t=" "+s("ui.common.short.level")+" "+this._jobLevel),this.operator){case o.operators.equal:return e+t;case o.operators.different:return s("ui.common.dontBe")+e+t;case o.operators.superior:return e+" >"+t;case o.operators.inferior:return e+" <"+t;default:return""}},n.prototype.isRespected=function(){var e=window.gui.playerData.jobs.list;if(this._jobLevel===-1)return e.hasOwnProperty(this._jobId);var t=e[this._jobId];if(!t||!t.experience)return!1;var i=this.operator.compareFn;return!!i&&i(t.experience.jobLevel,this._jobLevel)},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172);a.inherits(n,o),n.prototype.getKeyText=function(){return s("ui.common.kamas")},n.prototype.getCriterion=function(){return window.gui.playerData.inventory.kamas},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172);a.inherits(n,o),n.prototype.getKeyText=function(){return s("ui.common.level")},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.level},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=this.rawValue.split(",");t.length>1?(this._mapId=parseInt(t[0],10),this.value=parseInt(t[1],10)):this._mapId=window.gui.playerData.position.mapId}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.criterion.MK",[this._mapId])},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.level},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return s(this.operator===o.operators.equal&&1===this.value||this.operator===o.operators.different&&2===this.value?"ui.tooltip.beMaried":"ui.tooltip.beSingle")},n.prototype.getCriterion=function(){return null!==window.gui.playerData.socialData.spouse?1:2},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172);a.inherits(n,o),n.prototype.getCriterion=function(){return window.gui.playerData.partyData.arenaStats.bestDailyRank},n.prototype.getText=function(){var e;return e=this.operator===o.operators.different?s("ui.common.differentFrom")+" >":">",s("ui.common.pvpMaxRank")+" "+e+" "+this.value},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172);a.inherits(n,o),n.prototype.getKeyText=function(){return s("ui.time.months")},n.prototype.getCriterion=function(){var e=new Date;return e.getMonth()},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172);a.inherits(n,o),n.prototype.getText=function(){var e;switch(this.operator.token){case"!":case"=":e=this.operator.token+" "+this.rawValue;break;case"~":e="= "+this.rawValue;break;case"S":case"s":e=s("ui.criterion.startWith",[this.rawValue]);break;case"E":case"e":e=s("ui.criterion.endWith",[this.rawValue]);break;case"v":e=s("ui.criterion.valid");break;case"i":e=s("ui.criterion.invalid");break;default:e=""}return s("ui.common.name")+" "+e},n.prototype.isRespected=function(){var e=window.gui.playerData.characterBaseInformations.name;switch(this.operator.token){case"=":return e===this.rawValue;case"!":return e!==this.rawValue;case"~":return e.toLowerCase()===this.rawValue.toLowerCase();case"S":return 0===e.toLowerCase().indexOf(this.rawValue.toLowerCase());case"s":return 0===e.indexOf(this.rawValue);case"E":return e.toLowerCase().indexOf(this.rawValue.toLowerCase())===e.length-this.rawValue.length;case"e":return e.indexOf(this.rawValue)===e.length-this.rawValue.length;default:case"v":case"i":return!1}},e.exports=n},function(e,t,i){function n(e,t){o.call(this,e),this._objectName=t.nameId}var o=i(469),s=i(29).getText,a=i(172).inherits,r=i(30);a(n,o),n.prototype.initialize=function(e){var t=this.value;if(!t&&0!==t)return e();var i=this;r.getDataMap("Items",[t],function(n,o){if(n)return e(n);var s=o[t];return s?(i._objectName=s.nameId,void e()):e("ObjectItemCriterion: unable to find item id "+t)})},n.prototype.isRespected=function(){var e=window.gui.playerData.inventory.objects,t=this.operator===o.operators.equal;for(var i in e){var n=e[i];if(n.objectGID===this.value)return t}return!t},n.prototype.getText=function(){return this.operator===o.operators.different?s("ui.common.doNotPossess",[this._objectName]):s("ui.common.doPossess",[this._objectName])},e.exports=n},function(e,t,i){function n(){c={CM:h("ui.stats.shortMP"),CP:h("ui.stats.shortAP"),CH:h("ui.pvp.honourPoints"),CD:h("ui.pvp.disgracePoints"),CT:h("ui.stats.takleBlock"),Ct:h("ui.stats.takleEvade")},d=h("ui.item.characteristics").split(",")}function o(e,t,i){for(var n=i.length,o=e,s=0,a=t.length;s<a;s+=1)o=o.split(t[s]).join(i[s%n]);return o}function s(e){return c[e]?c[e]:o(e,["CS","Cs","CV","Cv","CA","Ca","CI","Ci","CW","Cw","CC","Cc","CA","PG","PJ","Pj","PM","PA","PN","PE","<NO>","PS","PR","PL","PK","Pg","Pr","Ps","Pa","PP","PZ","CM","Qa"],d)}function a(e){u.call(this,e),c||n(),this._keyText=s(this.key)}function r(e){return function(t){return t[e].base}}function l(e){return function(t){var i=t[e];return i.base+i.alignGiftBonus+i.contextModif+i.objectsAndMountBonus}}var c,d,u=i(469),h=i(29).getText,p=i(172).inherits;p(a,u),a.prototype.getKeyText=function(){return this._keyText};var m={Ca:r("agility"),CA:l("agility"),Cc:r("chance"),CC:l("chance"),Ce:function(e){return e.energyPoints},CE:function(e){return e.maxEnergyPoints},CH:function(e){return e.alignmentInfos.honor},Ci:r("intelligence"),CI:l("intelligence"),CL:function(e){return e.lifePoints},CM:l("movementPoints"),CP:l("actionPoints"),Cs:r("strength"),CS:l("strength"),Cv:r("vitality"),CV:l("vitality"),Cw:r("wisdom"),CW:l("wisdom"),Ct:l("tackleEvade"),CT:l("tackleBlock")};a.prototype.getCriterion=function(){var e=window.gui.playerData.characters.mainCharacter.characteristics;return m[this.key]?parseInt(m[this.key](e),10):(console.error("unknown criterion key: "+this.key),0)},e.exports=a},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.pvp.rank")},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172);a.inherits(n,o),n.prototype.getText=function(){var e=window.gui.playerData.quests.all[this.value];if(!e)return"";switch(this.key){case"Qa":return s("ui.grimoire.quest.active",[e.nameId]);case"Qc":return s("ui.grimoire.quest.startable",[e.nameId]);case"Qf":return s("ui.grimoire.quest.done",[e.nameId]);default:return""}},n.prototype.isRespected=function(){var e=window.gui.playerData.quests.all[this.value];if(!e)return"";switch(this.key){case"Qa":return window.gui.playerData.quests.active.hasOwnProperty(this.value);case"Qc":return!0;case"Qf":return window.gui.playerData.quests.finished.hasOwnProperty(this.value);default:return""}},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.common.pvpRank")},n.prototype.getOperatorText=function(){return this.operator===o.operators.different?s("ui.common.differentFrom")+" >":">"},n.prototype.getCriterion=function(){return window.gui.playerData.partyData.arenaStats.rank},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.common.level")},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.level},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return this.operator===o.operators.equal&&1===this.value||this.operator===o.operators.different&&0===this.value?s("ui.tooltip.mountEquiped"):this.operator===o.operators.equal&&1===this.value||this.operator===o.operators.different&&0===this.value?s("ui.tooltip.mountNonEquiped"):""},n.prototype.getCriterion=function(){return window.gui.playerData.isRiding?1:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e),this._keyText=s("ui.header.server")}var o=i(469),s=i(29).getText,a=i(172).inherits,r=i(30);a(n,o),n.prototype.initialize=function(e){var t=this;this._serverName="",r.getData("Servers",this.value,function(i,n){return i?e(i):(t._serverName=n.nameId,void e())})},n.prototype.getKeyText=function(){return this._keyText},n.prototype.getValueText=function(){return this._serverName},n.prototype.getCriterion=function(){return window.gui.serversData.connectedServerId},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return s(1===this.value?"ui.tooltip.beFemale":"ui.tooltip.beMale")},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.sex?1:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits,r=i(30),l=[7010,10417,10418];a(n,o),n.prototype.initialize=function(e){var t,i=this.key.split(",");i.length>1?(t=parseInt(i[0],10),this._quantityMonster=parseInt(i[1],10)):(t=parseInt(this.value,10),this._quantityMonster=1),this._monsterName="";var n=this;r.getData("Monsters",t,function(t,i){return t?e(t):(n._monsterName=i.nameId,void e())})},n.prototype.isRespected=function(){for(var e=window.gui.playerData.inventory,t=0;t<l.length;t+=1)if(e.quantityList[[l]])return!0;return!1},n.prototype.getText=function(){return s("ui.tooltip.possessSoulStone",[this._quantityMonster,this._monsterName])},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(172).inherits;s(n,o),n.prototype.getCriterion=function(){return window.gui.playerData.characters.mainCharacter.characteristics.alignmentInfos.alignmentGrade},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=this.rawValue.split(",");t.length>1?console.error(new Error("SpellItemCriterion: too much parameters: "+t)):this._spellId=this.value}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){var e=window.gui.playerData.characters.mainCharacter.spellData.spells[this._spellId];if(!e)return"";switch(this.operator){case o.operators.equal:return s("ui.criterion.gotSpell",[e.nameId]);case o.operators.different:return s("ui.criterion.doesntGotSpell",[e.nameId]);default:return""}},n.prototype.isRespected=function(){var e=window.gui.playerData.characters.mainCharacter.spellData.spells.hasOwnProperty(this._spellId);return e&&this.operator===o.operators.equal||!e&&this.operator===o.operators.different},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(172).inherits;s(n,o),n.prototype.isRespected=function(){return!0},n.prototype.getText=function(){return""},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits,r=i(30);a(n,o),n.prototype.initialize=function(e){var t=this;this._name="",r.getData("SubAreas",this.value,function(i,n){return i?e(i):(t._name=n.nameId,void e())})},n.prototype.getText=function(){if(!this._name)return"";switch(this.operator){case o.operators.equal:return s("ui.tooltip.beInSubarea",[this._name]);case o.operators.different:return s("ui.tooltip.dontBeInSubarea",[this._name]);default:return""}},n.prototype.getCriterion=function(){return window.gui.playerData.position.subAreaId},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getText=function(){return s(this.operator===o.operators.equal&&1===this.value||this.operator===o.operators.different&&0===this.value?"ui.tooltip.beSubscirber":"ui.tooltip.dontBeSubscriber")},n.prototype.getCriterion=function(){var e=window.gui.playerData.identification;return e.subscriptionEndDate>0||e.hasRights?1:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e),this._text=s("ui.criterion.unusableItem")}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.isRespected=function(){return!0},n.prototype.getText=function(){return this._text},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(469),s=i(29).getText,a=i(172).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.common.weight")},n.prototype.getCriterion=function(){return window.gui.playerData.inventory.weight},e.exports=n},function(e,t,i){function n(e){c.call(this),this.isItemInstance=!0,this.exchangeAllowed=!0,this.isInitialised=!1,this.shortName=null,this.effectsMap={};for(var t in e)this[t]=e[t]}function o(e){for(var t=0;t<f.length;t+=1)if(f[t]>e)return t;return f.length}function s(e){for(var t=0;t<e.length;t++){var i=e[t],n=i.effects;if(n.length){var s=0,a=0,r=i.item;if(r&&r.isWeapon)switch(r.typeId){case 7:s="X",a=1;break;case 4:s="T",a=1;break;case 8:s="L",a=1}for(var l=0;l<n.length;l++){var c=n[l];if(c&&c.effect){switch(i.effectsMap[c.effectId]=c,s&&c.isDamageEffect()&&(c.zoneShape=s,c.zoneSize=a),c.effectId){case g:i.livingObjectFoodDate=c.description;break;case _:i.livingObjectId=c.value,c.isLivingProperty=!0;break;case v:i.livingObjectMood=c.value,c.isLivingProperty=!0;break;case y:i.livingObjectSkin=c.value,c.isLivingProperty=!0;break;case b:i.livingObjectCategory=c.value,c.isLivingProperty=!0;break;case M:var d=o(c.value),u=c.value-f[d-1],h=f[d]-f[d-1]||0;i.livingObjectLevel=d,i.livingObjectXp=u,i.livingObjectMaxXp=h,c.isLivingProperty=!0}139!==c.effectId&&110!==c.effectId||(i.isOkForMultiUse=!0),983===c.effectId&&(i.exchangeAllowed=!1),c.effectId!==A&&c.effectId!==I||(i.exchangeable=!1)}}}}}function a(e,t){var i=[];l.series([function(t){for(var n=[],o={},s=0;s<e.length;s++){var a=e[s];if(a.livingObjectCategory){var r=a.livingObjectId||a.objectGID;n.push(r),o[s]=r}}return n.length?void h.getDataMap("LivingObjectSkinJntMood",n,function(n,s){if(n)return t(n);for(var a=0;a<e.length;a++)if(void 0!==o[a]){var r=e[a],l=s[o[a]].moods;r.iconId=l[r.livingObjectMood][r.livingObjectSkin-1],i.push(r)}t()}):t()},function(t){for(var n=0;n<e.length;n++){var o=e[n];o.effectsMap[S]&&(o.iconId=o.effectsMap[S].iconId,i.push(o))}t()},function(e){if(!i.length)return e();var t=5;l.eachLimit(i,t,function(e,t){e._loadDifferentImage(t)},e)}],t)}function r(e,t,i){for(var n=t&&t.monstersCache,o={},s={},a=!1,r=0;r<e.length;r++){var l=e[r];switch(l.effectsMap&&l.effectsMap[1081]&&(l.weight+=l.effectsMap[1081].getParams()[0]),l.item.id){case w:case C:case T:l.shortName=null;break;default:l.shortName=l.item.getRawName(),l._initializationDone();continue}for(var c=[],d=0;d<l.effects.length;d++){var u=l.effects[d].getParams(),p=u[2];p&&(c.push({monsterId:p,monsterGrade:u[0]-1}),n&&n[p]||(o[p]=!0))}s[r]=c,a=!0}return a?(o=Object.keys(o),void h.getDataMap("Monsters",o,function(t,o){if(t)return i(t);for(var a,r,l,c={regularSoulstone:function(e,t){var i=e.grades[t];i&&i.level>a&&(a=i.level,r=e.nameId)},bossAndMiniBoss:function(e){(e.isBoss||e.isMiniBoss)&&(r?r+=", "+e.nameId:r=e.nameId)}},d=0;d<e.length;d++)if(s[d]){var u=e[d];switch(a=0,r=null,l=null,u.item.id){case w:l=c.regularSoulstone;break;case C:case T:l=c.bossAndMiniBoss}for(var h=0;h<s[d].length;h++){var p,m=s[d][h].monsterId,f=s[d][h].monsterGrade;n?(p=n[m],p||(p=n[m]=o[m])):p=o[m],l(p,f)}u.shortName=r,u._initializationDone()}i()})):i()}var l=i(31),c=i(188).EventEmitter,d=i(355),u=i(172).inherits,h=i(30),p=i(182),m=i(29).getText,f=[0,10,21,33,46,60,75,91,108,126,145,165,186,208,231,255,280,306,333,361],g=808,_=970,v=971,y=972,b=973,M=974,w=7010,T=10417,C=10418,A=981,I=982,S=1151;u(n,c),e.exports=n,n.prototype.setItem=function(e){this.exchangeable=e.exchangeable,this.isOkForMultiUse=!1,this.weight=e.realWeight,this.item=e},n.prototype.isLinked=function(){return!this.exchangeable||!this.exchangeAllowed},n.prototype.isLinkedCharacter=function(){return!!this.effectsMap[A]},n.prototype._loadDifferentImage=function(e){var t=this;p.preloadImage("gfx/items/"+this.iconId+".png",function(i){t.image=i,e()})},n.prototype._initializationDone=function(){this.isInitialised=!0,this.emit("initialised")},n.prototype.initialize=function(e){console.error("ItemInstance.initialized called"),n.initializeList([this],null,e)},n.initializeList=function(e,t,i){for(var n=[],o=0;o<e.length;o++)e[o].effects.length>0&&(n=n.concat(e[o].effects));d.createEffectInstances(n,function(n,o){if(n)return i(n);for(var l=0;l<e.length;l++){var c=e[l],d=c.effects.length;c.effects=d>0?o.splice(0,d):[]}s(e),a(e,function(n){return n?i(n):void r(e,t,i)})})},n.prototype.getRawName=function(){
if(!this.isInitialised)return"";var e;return e=this.objectGID===w?m("ui.item.soul")+m("ui.common.colon")+this.shortName:this.objectGID===C?m("ui.item.miniboss")+m("ui.common.colon")+this.shortName:this.objectGID===T?m("ui.item.boss")+m("ui.common.colon")+this.shortName:this.shortName},n.prototype.isMimicryHost=function(){return!!this.effectsMap[S]},n.prototype.doDefaultAction=function(){if(this.isInitialised){var e=this.getProperty("objectUID");if(this.getProperty("usable")){if(!this.getProperty("type").needUseConfirm)return void window.dofus.sendMessage("ObjectUseMessage",{objectUID:e});window.gui.openConfirmPopup({title:m("ui.common.confirm"),message:m("ui.common.confirmationUseItem",this.getProperty("nameId")),cb:function(t){t&&window.dofus.sendMessage("ObjectUseMessage",{objectUID:e})}})}else this.item.isEquippable()&&window.gui.playerData.inventory.equipItem(e)}},n.prototype.getName=function(){if(!this.isInitialised)return"";var e=this.getRawName();return window.gui.playerData.isModeratorOrMore()&&(e+=" ("+this.objectGID+")"),e},n.prototype.getItem=function(){return this.item},n.prototype.getItemInstance=function(){return this},n.prototype.getProperty=function(e){if(!this.isInitialised)return null;switch(e){case"nameId":return this.getName();default:return this.hasOwnProperty(e)?this[e]:this.item.getProperty(e)}}},function(e,t,i){function n(){return this.tooltipContent||(this.tooltipContent=new d(this.rowContent)),this.tooltipContent}function o(e,t,i){p.call(this,"div",{className:"ShopViewer"}),i=i||{},this.itemTypes={},this._createDom(e,t,i)}function s(e,t){return e.objectGID===t}i(527);var a=i(337).addTooltip,r=i(339),l=i(172).inherits,c=i(528),d=i(534),u=i(461),h=i(539),p=i(321);l(o,p),e.exports=o,o.prototype._createDom=function(e,t,i){var o=this;i.manualFiltering||(this.itemFilter=this.appendChild(new c(i))),this.table=this.appendChild(new h(e,t,i.tableOption)),this.table.on("rowSlidedLeft",function(e,t){o.emit("rowSlidedLeft",e,t)}),this.table.on("rowSlidedRight",function(e,t){o.emit("rowSlidedRight",e,t)}),this.table.on("rowAdded",function(e,t,i){i.tooltipContent=null,a(i,n)}),this.table.on("rowTap",function(e,t){o.emit("itemSelected",t)}),this.itemFilter&&this._setupFiltering()},o.prototype.setHeader=function(e){this.table.setColumnHeader("name",e)},o.prototype._setupFiltering=function(){var e,t,i,n,o,s=u.getItemTypeMap(),a=this;this.itemFilter.on("filter",function(s,l,d){e=s,t=s!==c.filters.all,i=l,n=l!==c.subFilters.all,o=d?r.simplifyString(d):null,a.table.filter()}),this.table.addFilter(function(a){var r=a.getItem(),l=s[r.typeId].category;return(!t||l===e)&&((!n||r.typeId===i)&&(!o||r.getNameForSearch().indexOf(o)!==-1))})},o.prototype.filter=function(e){this.table.filter(e)},o.prototype._unregisterItemType=function(e){var t=this.table.getRow(e);if(t){var i=t.rowContent,n=i.getItem().typeId;this.itemTypes[n]&&(this.itemTypes[n]--,0===this.itemTypes[n]&&delete this.itemTypes[n])}},o.prototype._registerItemType=function(e){var t=e.getItem().typeId;return this.itemTypes[t]?(this.itemTypes[t]++,!1):(this.itemTypes[t]=1,!0)},o.prototype._collectItemTypes=function(e){if(this.itemFilter){for(var t=!1,i=0;i<e.length;i++){var n=this.table.getIdFn(e[i]);this.table.hasRow(n)||(t|=this._registerItemType(e[i]))}t&&this.itemFilter.updateSubFilters(Object.keys(this.itemTypes))}},o.prototype.removeItems=function(e){for(var t=0;t<e.length;t++)this._unregisterItemType(e[t]);this.table.delRows(e,!0)},o.prototype.getItemCount=function(){return this.table.getRowCount()},o.prototype.selectItem=function(e){this.table.selectRow(e)},o.prototype.getItem=function(e){var t=this.table.getRow(e);return t?t.rowContent:null},o.prototype.findItemByGID=function(e){return this.table.findRow(s,e)},o.prototype.selectFilter=function(e){this.itemFilter.selectSubfilter(e)},o.prototype.clearContent=function(){this.itemTypes={},this.table.clearContent()},o.prototype.setItemList=function(e){this.clearContent(),this.itemFilter&&(this._collectItemTypes(e),e.length||this.itemFilter.updateSubFilters([]),this.itemFilter.reset()),this.table.addList(e,!0)},o.prototype.addItems=function(e){this._collectItemTypes(e),this.table.addList(e,!0,!0)},o.prototype.addItemsAndHighlightThem=function(e){this._collectItemTypes(e),this.selectFilter(e[0].getProperty("typeId")),this.table.addList(e,!0,!0),this.selectItem(e[0].objectUID)},o.prototype.setPlaceholder=function(e){this.table.setPlaceholderText(e)},o.prototype.refresh=function(){this.table.placeholder.refresh(),this.table.scroller.refresh()}},function(e,t){},function(e,t,i){function n(e){function t(e,t){_.selectedFilter!==e?(v[_.selectedFilter]&&(v[_.selectedFilter].delClassNames("selected"),y[_.selectedFilter].wdSelect.hide()),_.selectedFilter=e,v[e].addClassNames("selected"),y[e].wdSelect.show(),_.selectedSubFilter=y[e].wdSelect.selectFirst(!0)):_.selectedSubFilter=t,_.emit("filter",_.selectedFilter,_.selectedSubFilter)}function i(e){_.emit("filter",_.selectedFilter,_.selectedSubFilter,e)}function n(){T.toggleDisplay(this.filter!==h.preset),C.hide(),A.setValue(""),t(this.filter,_.selectedSubFilter)}function a(e){t(_.selectedFilter,parseInt(e,10))}function p(){var e=!C.isVisible();T.toggleDisplay(!e),C.toggleDisplay(e),A.setValue("")}d.call(this,"div",{className:"ItemFilters"}),m||(m=[s("ui.common.all"),s("ui.common.equipement"),s("ui.common.usableItems"),s("ui.common.ressources"),s("ui.common.quest.objects"),s("ui.common.presets")]),e=e||{};var _=this,v={},y={},b=[],M=this.createChild("div",{className:"filters"}),w=this.filterBtnMap={},T=this.subFiltersBox=this.createChild("div",{className:"subFiltersBox"}),C=this.createChild("div",{className:"searchBox"});o(C,s("ui.common.searchFilterTooltip"));var A;C.hide(),this.closeSearchBox=function(){T.toggleDisplay(_.selectedFilter!==h.preset),A.setValue(""),C.hide()},this.selectCategory=function(e){t(e,_.selectedSubFilter)},this.selectSubfilter=function(e){var i=_.selectedFilter,n=y[i].wdSelect;return!!n.hasValue(e)&&(n.select(e,!0),t(i,e),!0)},this.reset=function(){for(var e=0,i=b.length;e<i;e+=1){var n=b[e];n.selectFirst(!0)}var o=h.all,s=y[o].wdSelect.selectFirst(!0);t(o,s)},this.updateSubFilters=function(t){var i=l.getItemTypeMap(),n=t.sort(function(e,t){return i[e].nameId.localeCompare(i[t].nameId)});for(var o in y)y[o].wdSelect.clearContent(),e.noAllCategory||y[o].wdSelect.addOption(s("ui.common.allTypesForObject"),f.all);for(var a=y[h.all],r=0,c=n.length;r<c;r+=1){var d=i[n[r]],u=y[d.category];u.wdSelect.addOption(d.nameId,d.id),a.wdSelect.addOption(d.nameId,d.id)}},this.toggleCategoryDisplay=function(e,t){w[e].toggleDisplay(t)};for(var I=M.createChild("div",{className:"content"}),S=0,E=g.length;S<E;S++){var x=g[S],N=["filter",l.getCategoryName(x)||"all"],L=I.appendChild(new c({className:N},n));w[x]=L,o(L,m[S]),L.filter=x,L.on("tap",n),v[x]=L,L.createChild("div",{className:"icon"});var O=T.appendChild(new u({className:"subFilterSelect"}));b.push(O),O.on("change",a),O.hide(),y[x]={wdSelect:O}}var D=T.appendChild(new c({className:"searchBtn"},p));o(D,s("ui.common.sortOrSearch")),this.searchInput=A=C.appendChild(new r),A.on("change",i);var R=C.appendChild(new c({className:"closeBtn"},p));o(R,s("ui.common.sortOrSearch")),C.on("show",function(){_.emit("searchOpen")}),C.on("hide",function(){_.emit("searchClose")}),this.isSearchOpen=C.isVisible,this.selectedFilter=null,this.selectedSubFilter=null}i(529);var o=i(337).addTooltip,s=i(29).getText,a=i(172).inherits,r=i(530),l=i(461),c=i(335),d=i(321),u=i(532),h={all:-1};for(var p in l.categories)h[p]=l.categories[p];var m,f={all:-1},g=[h.all,h.equipment,h.consumables,h.resources,h.quest,h.preset];a(n,d),n.filters=h,n.subFilters=f,e.exports=n},function(e,t){},function(e,t,i){function n(e,t){e=e||{};var i={type:"text",spellcheck:"false",autocapitalize:"off",autocorrect:"off",autocomplete:"off"};for(var n in e.attr)i[n]=e.attr[n];e.attr=i,s.call(this,"input",e),this.addClassNames("InputBox",i.type),this.allowDomEvents(),this.on("dom.input",function(){this.emit("change",this.rootElement.value)}),this.on("dom.touchend",function(){r.isIOS?document.activeElement!==this.rootElement&&this.focus():this.focus()}),this.on("dom.keypress",function(e){13===e.which&&(t&&t(this),this.emit("validate"))})}i(531);var o=i(172).inherits,s=i(321),a=i(435),r=i(168);o(n,s),e.exports=n,n.prototype.setValue=function(e,t){this.rootElement.value=e,t&&this.emit("change",e)},n.prototype.setPlaceholder=function(e){this.rootElement.placeholder=e},n.prototype.getValue=function(){return this.rootElement.value},n.prototype.setReadonly=function(e){e===!1?this.rootElement.removeAttribute("readonly"):this.rootElement.setAttribute("readonly","readonly")},n.prototype.blur=function(){this.rootElement.blur(),a.hide()},n.prototype.focus=function(){this.rootElement.focus()},n.prototype.disable=function(){this.rootElement.disabled=!0},n.prototype.enable=function(){this.rootElement.disabled=!1},n.prototype.setEnable=function(e){this.rootElement.disabled=!e},n.prototype.setCaretPosition=function(e){this.rootElement.setSelectionRange(e,e)}},function(e,t){},function(e,t,i){function n(e){function t(e){i._setValue(e,!1)}e=e||{},a.call(this,"div",{className:"Selector"}),this.addClassNames(e.className);var i=this;this._valuePairs=[],this._currentValue=null,this._dropDownSelector=this.appendChild(new r({className:["selectorContent"],scaleOnPress:!1})),this._isEnabled=!0,this.buttonOpen=this.createChild("div",{className:"buttonOpen"}),this._dropDownSelector.on("tap",function(){if(null!==i._currentValue){var e=i._getValueIndex(i._currentValue);window.gui.dropDown.setupDropDown(this,i._valuePairs,e,t)}})}function o(e,t){return e.text.localeCompare(t.text)}i(533);var s=i(172).inherits,a=i(321),r=i(335);s(n,a),e.exports=n,n.prototype._getValueIndex=function(e){for(var t=this._valuePairs,i=0;i<t.length;i++)if(t[i].value===e)return i;return-1},n.prototype.addOption=function(e,t){t||0===t||(t=""),null===this._currentValue&&(this._currentValue=t,this._dropDownSelector.setText(e),this.setEnable(!0)),this._valuePairs.push({text:e,value:t})},n.prototype.insertOptionAtTop=function(e,t){t||0===t||(t=""),this._valuePairs.unshift({text:e,value:t})},n.prototype.sortValues=function(){this._valuePairs.sort(o)},n.prototype.setEnable=function(e){e=!!e&&null!==this._currentValue,e!==this._isEnabled&&(this._isEnabled=e,this._dropDownSelector.setEnable(e),this.toggleClassName("disabled",!e))},n.prototype.hasValue=function(e){return this._getValueIndex(e)!==-1},n.prototype.select=function(e,t){this._setValue(e,t)},n.prototype.selectFirst=function(e){if(this._valuePairs.length){var t=this._valuePairs[0].value;return this._setValue(t,e),t}},n.prototype._setValue=function(e,t){var i=this._getValueIndex(e);if(i===-1)return console.error("Selecting invalid value:",e);var n=this._currentValue;this._currentValue=e,window.gui.dropDown.select(i);var o=this._valuePairs[i];this._dropDownSelector.setText(o.text),t||this.emit("change",e,n,o.text)},n.prototype.setValue=function(e){this._setValue(e,!0)},n.prototype.clearContent=function(){this._valuePairs=[],this._currentValue=null,this._dropDownSelector.setText(""),window.gui.dropDown.clearContent(),this.setEnable(!1)},n.prototype.toggleOption=function(e,t){if(e||0===e){var i=this._valuePairs[e];i&&(t=void 0===t?i.disabled:t,i.disabled=!t)}},n.prototype.setOptionHidden=function(e,t){var i=this._valuePairs[e];return i?void(i.hidden=!!t):console.warn("Invalid selector option",e)}},function(e,t){},function(e,t,i){function n(e,t){return e.setText(t.getProperty("descriptionId")),!0}function o(e,t){if(!t.getProperty("exchangeable"))return!1;var i=b("ui.common.averagePrice")+b("ui.common.colon"),n=t.getProperty("averagePrice");return i+=n===-1?b("ui.item.averageprice.unavailable"):f.kamasToString(n),e.setText(i),!0}function s(e,t){return e.setEffectsFromItem(t),!0}function a(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=n.text,s=t.createChild("div",{className:"singleTab"});if("string"==typeof o)s.setHtml(w+" "+o);else for(var a=0;a<o.length;a++){var r=o[a];s.createChild("div",{text:r})}n.isMalus&&s.addClassNames("malus")}}function r(e,t){var i=t.getProperty("targetConditionsFormatted"),n=t.getProperty("conditionsFormatted");return!(!i.length&&!n.length)&&(e.clearContent(),e.createChild("div",{className:"conditionsTitle",text:b("ui.common.conditions")+b("ui.common.colon")}),a(n,e),a(i,e),!0)}function l(e,t){var i,n="",o=e.getProperty("criticalHitBonus");o>0?i="+":o<0&&(i="-"),n+=b("ui.common.short.CriticalHit")+b("ui.common.colon")+"1/";var s=e.getProperty("criticalHitProbability");if(t){var a=t.criticalHit,r=t.agility,l=a.alignGiftBonus+a.base+a.contextModif+a.objectsAndMountBonus,c=r.alignGiftBonus+r.base+r.contextModif+r.objectsAndMountBonus;c<0&&(c=0);var d=s-l,u=parseInt(d*Math.E*1.1/Math.log(c+12),10),h=Math.min(d,u);h<2&&(h=2),n+=h}else n+=s;return i&&(n+=" ("+i+o+b("ui.common.damageShort")+")"),n}function c(e,t){var i=e.getProperty("criticalFailureProbability");if(t){var n=t.criticalMiss;i+=n.alignGiftBonus-n.base-n.contextModif-n.objectsAndMountBonus}return(e.getProperty("criticalHitProbability")?" - ":"")+b("ui.common.short.CriticalFailure")+b("ui.common.colon")+"1/"+i+" "}function d(e,t){e.setText(t.getProperty("itemSetName"))}function u(e,t){var i=t.getItemInstance();if(i){var n=i.effectsMap[T];n&&e.createChild("div",{className:"extra",text:n.description})}}function h(e,t,i){if(e.name.setText(t.getProperty("nameId")),e.name.toggleClassName("etheral",!!t.getProperty("etheral")),i.showCategory===!1)e.category.hide();else{var n=t.getProperty("typeId"),o=_.getItemTypeMap();e.category.setText(b("ui.common.category")+b("ui.common.colon")+o[n].nameId),e.category.show()}i.showWeight===!1?e.weight.hide():(e.weight.setText(b("ui.common.short.weight",t.getProperty("weight"))),e.weight.show()),e.level.setText(b("ui.common.short.level")+" "+t.getProperty("level"));var s=e.extra;s.clearContent();var a=t.getProperty("itemSetId");if(t.getProperty("isWeapon")){e.points.ap.setText(b("ui.common.ap")+" : "+t.getProperty("apCost"));var r=t.getProperty("range"),h=t.getProperty("minRange");e.points.ra.setText(b("ui.common.ra")+" : "+h),e.points.range.setText(r!==h?" - "+r:""),e.points.show(),a&&a!==-1&&d(s.createChild("div",{className:"extra"}),t),t.getProperty("twoHanded")&&s.createChild("div",{className:"extra",text:b("ui.common.twoHandsWeapon")});var p=t.getProperty("maxCastPerTurn");if(p){var m=b("ui.item.maxUsePerTurn")+b("ui.common.colon")+p;s.createChild("div",{className:"extra",text:m})}t.getProperty("castInLine")&&r>1&&s.createChild("div",{className:"extra",text:b("ui.spellInfo.castInLine")}),t.getProperty("castTestLos")&&r>1&&s.createChild("div",{className:"extra",text:b("ui.spellInfo.castWithoutLos")}),u(s,t);var f=t.getProperty("criticalFailureProbability"),g=t.getProperty("criticalHitProbability");if(i.showCritical&&(f||g)){var v="",y=window.gui.playerData.characters.mainCharacter.characteristics;g&&(v+=l(t,y)),f&&(v+=c(t,y)),s.createChild("div",{className:"extra",text:v})}}else e.points.hide(),a&&a!==-1&&d(s.createChild("div",{className:"extra"}),t),u(s,t);return!0}function p(e,t){M.call(this,"div",{className:"ItemDescription"}),this._buildDomElements(t),e&&this.updateUI(e,t)}i(535);var m=i(536),f=i(339),g=i(172).inherits,_=i(461),v=_.Item,y=_.ItemInstance,b=i(29).getText,M=i(321),w="&#149;",T=812,C={description:n,averagePrice:o,effects:s,conditions:r,header:h};g(p,M),e.exports=p,p.prototype._buildDomElements=function(e){var t=this._domElements={};t.header=this.createChild("div",{className:"header"});var i=t.header.createChild("div",{className:"nameAndLevel"});t.header.name=i.createChild("div",{className:"name"}),t.header.level=i.createChild("div",{className:"right"});var n=t.header.createChild("div",{className:"categoryAndWeight"});t.header.category=n.createChild("div"),t.header.weight=n.createChild("div",{className:"right"});var o=t.header.points=t.header.createChild("div",{className:"pointsLine"});o.ap=o.createChild("span",{className:"ap"}),o.ra=o.createChild("span",{className:"ra"}),o.range=o.createChild("span"),t.header.extra=t.header.createChild("div",{className:"extra"}),t.effects=this.appendChild(new m(e)),t.conditions=this.createChild("div",{className:"topSpacing"}),t.description=this.createChild("div",{className:["topSpacing","description"]}),t.averagePrice=this.createChild("div",{className:"topSpacing"})},p.prototype.updateUI=function(e,t){if(!(e instanceof v||e instanceof y))return console.error(new Error("ItemDescription: item is not Item or ItemInstance"));if(this.currentItem=e,e.isItemInstance&&!e.isInitialised){var i=this;return e.once("initialised",function(){i.currentItem===e&&i.updateUI(e,t)})}t=t||{};for(var n in C){var o=this._domElements[n];t[n]!==!1&&C[n](o,e,t)?o.show():o.hide()}}},function(e,t){},function(e,t,i){function n(e){u.call(this,"div",e),this.addClassNames("EffectDescription")}function o(e){return e.requiresGlyphDescription()||e.requiresTrapDescription()||e.requiresBombDescription()}function s(e){if(!e.requiresInvocationDescription()||!e.subEffectDescription)return null;for(var t,i,n=new u("div"),o=Math.ceil(e.subEffectDescription.length/2),s=0;s<o;s++)t=n.createChild("div",{className:"monsterLine"}),i=t.createChild("div",{className:"column1"}),i.setHtml(h+" "+e.subEffectDescription[s]),e.subEffectDescription[o+s]&&(i=t.createChild("div",{className:"column2"}),i.setHtml(h+" "+e.subEffectDescription[o+s]));return n}function a(e){if(!o(e)||!e.subEffectDescription)return null;for(var t=new u("div"),i=0;i<e.subEffectDescription.length;i++){var n=t.createChild("div",{className:"singleTab"});n.setHtml(h+" "+e.subEffectDescription[i])}return t}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i],o=e.createChild("div",{className:"singleTab"});n.dbEffect.bonusType===-1?o.addClassNames("malus"):1===n.dbEffect.bonusType&&o.addClassNames("bonus"),"string"==typeof n.description?o.setHtml(h+" "+n.description):o.appendChild(n.description)}}i(537);var l=i(538),c=i(29).getText,d=i(172).inherits,u=i(321),h="&#149;";d(n,u),e.exports=n,n.prototype._renderDamageAndEffects=function(e,t){for(var i=[],n=[],l=0,d=e.length;l<d;l++){var u=e[l];if(u){var h=u.description;if(h&&!u.hidden){var p=u.getDurationString();p&&(h+=" ("+p+")");var m=u.monsterCount;m&&(h+=m);var f=u.isDamageEffect()?i:n;f.push({dbEffect:u.effect,description:h}),u.requiresInvocationDescription()&&u.subEffectDescription&&f.push({dbEffect:u.effect,description:s(u)}),o(u)&&u.subEffectDescription&&f.push({dbEffect:u.effect,description:a(u)})}}}var g;i.length>0&&(g=t?c("ui.common.criticalDamages",1):c("ui.stats.damagesBonus",i.length),this.createChild("div",{className:"effectTitle",text:g+c("ui.common.colon")}),r(this,i)),n.length>0&&(g=t?c("ui.common.criticalEffects",1):c("ui.common.effects",n.length),this.createChild("div",{className:"effectTitle",text:g+c("ui.common.colon")}),r(this,n))},n.prototype.setEffectsFromItem=function(e,t){var i;t=t||{},this.clearContent();var n,o=e.getItemInstance();n=t.showPossibleEffects||!o?e.getItem():o,i=l.getSortedEffectInstances(n),this._renderDamageAndEffects(i)},n.prototype.setEffectsFromSpell=function(e,t){this.clearContent();var i,n,o,s=e.getSpellLevelId();for(i=[],n=0,o=e.getEffectsIds(t).length;n<o;n++)i.push(e.effectInstances[s+"-effects-"+n]);for(this._renderDamageAndEffects(i),i=[],n=0,o=e.getCriticalEffectsIds(t).length;n<o;n++)i.push(e.effectInstances[s+"-criticalEffect-"+n]);this._renderDamageAndEffects(i,!0)},n.prototype.setEffects=function(e){this.clearContent(),this._renderDamageAndEffects(e)}},function(e,t){},function(e,t,i){function n(){this.exoticEffects={}}var o=i(355),s=i(461).ItemInstance;n.prototype._getEffectInstances=function(e,t){var i=t&&t.effects,n=e.possibleEffects,o=i&&i.length>0,s=n&&n.length>0;if(o||s){var a,r;if(t)a=i,r=!t.objectUID;else{if(!s)return;a=n,r=!0}if(a=a.filter(function(e){return e&&e.effect&&!e.isLivingProperty}),this.exoticEffects={},!r&&!e.hideEffects&&e.enhanceable)for(var l=0;l<a.length;l+=1){var c=a[l].effect;if(c&&c.showInSet&&n){for(var d=!0,u=0;u<n.length;u+=1)if(c.id===n[u].effectId){d=!1;break}this.exoticEffects[c.id]=d}}return a}},n.prototype.sortEffects=function(e){function t(e,t){var i=e.effect,n=t.effect;return a.exoticEffects[i.id]?-1:a.exoticEffects[n.id]?1:i.effectPriority-n.effectPriority}var i,n,s,a=this,r=e.sort(t),l=o.category,c=[l.damage,l.miscellaneous,l.resistance,l.special],d={};for(i=0;i<r.length;i+=1)if(s=r[i].effect,s.category!==l.undefined&&812!==s.id){var u=s.showInSet?s.category:l.special;d[u]||(d[u]=[]),d[u].push(r[i])}var h=[];for(i=0;i<c.length;i+=1){var p=d[c[i]];if(p)for(n=0;n<p.length;n+=1){var m=p[n];h.push(m)}}return h},n.prototype.getSortedEffectInstances=function(e){var t=e instanceof s?e:null,i=t&&t.item||e,n=this._getEffectInstances(i,t);return n?this.sortEffects(n):[]},e.exports=new n},function(e,t,i){function n(e,t){return e>t?1:t>e?-1:0}function o(e){return e[this.id]}function s(e){return e}function a(e,t,i){if(h.call(this,"div",{className:"TableV2"}),i=i||{},t)"function"==typeof t?this.getIdFn=t:this.getIdFn=function(e){return e[t]};else{var a=0;this.getIdFn=function(){return a++}}this.cols=e,this._selectedRow=null,this.colIndex={};for(var r=0,l=e.length;r<l;r+=1){var c=e[r];this.colIndex[c.id]=r,c.format=c.format||c.getContent||o,c.sort&&("function"==typeof c.sort?c.getContent=c.getContent||s:(c.sort=n,c.getContent=c.getContent||o),c.order=c.order||"ascending",c.defaultSorter&&(this.defaultSorter=c,this.defaultOrder=c.order,this.sortBy=c))}this._clickable=i.clickable!==!1,i.noHeader||this._addHeader(),i.sorter&&this.setSorter(i.sorter),this._onRowCreation=i.onRowCreation,this.scroller=this.appendChild(new g({className:"tableScroller"})),this.rows=this.scroller.content,this.rows.addClassNames("tableContent"),this._slidable=i.slidable,this._slidable&&this._createSlideBackElement(),this.filters=[],this.placeholder=null}function r(){this.myTable._sortByColumn(this)}function l(e){this.toggleClassName("disabled",!e)}function c(e,t){var i=e[t.id];i.clearContent();var n=t.format(e.rowContent,e);n instanceof h?(i.content=n,i.appendChild(n)):(i.content=i,i.setText(n))}i(540);var d=i(335),u=i(455),h=i(321),p=i(197),m=i(201),f=i(172).inherits,g=i(436),_=i(196),v=26,y=40,b=100;f(a,h),e.exports=a,a.prototype._createSlideBackElement=function(){var e=this._slideBack=new h("div",{className:"slideBackElement"});e.setStyle("opacity",0),e.appendChild(this._slidable),e.rowId=null,e.side="left",this.scroller.appendChild(e)},a.prototype.setColumnHeader=function(e,t){var i=this.header.row.getChild(e);return i?("string"==typeof t?i.content.setText(t):(i.content.clearContent(),i.content.appendChild(t)),void i.sorter.toggleClassName("noText",!t)):console.error("setColumnHeader: invalid colId:",e)},a.prototype.setSortingHintVisible=function(e,t){var i=this.header.row.getChild(e);return i?void i.sorter.toggleClassName("noTriangle",!!t):console.error("setSortingHintVisible: invalid colId:",e)},a.prototype._addHeader=function(){this.header=this.createChild("div",{className:"tableHeader"});for(var e=this.header.row=this.header.createChild("div",{className:"row"}),t=0,i=this.cols.length;t<i;t+=1){var n,o=this.cols[t];o.sort?(n=e.appendChild(new d({className:["col",o.id],name:o.id},r)),n.myTable=this):n=e.createChild("div",{className:["col",o.id]}),e[o.id]=n,(o.header||o.sort)&&(n.content=n.createChild("div",{className:"headerContent"}),o.header instanceof h?n.content.appendChild(o.header):n.content.setText(o.header||""),o.sort&&(n.addClassNames(o.order),n.sorter=n.createChild("div",{className:"sortBtn"}),this._toggleTriangle(n,!!o.defaultSorter),n.sortBy=o,o.header||n.sorter.addClassNames("noText")))}},a.prototype.setContentLoading=function(e){this.scroller.toggleClassName("spinner",e)},a.prototype.setPlaceholderText=function(e){if(!this.placeholder){if(!e)return;this.placeholder=new u(this,{headerElement:this.header})}this.placeholder.setText(e)},a.prototype._toggleTriangle=function(e,t){e.toggleClassName("showingTriangle",t)},a.prototype._hideCurrentTriangle=function(){var e=this.sortBy;e&&e.id&&this._toggleTriangle(this.header.row[e.id],!1)},a.prototype.setSorter=function(e,t){this._hideCurrentTriangle(),this.sortBy={order:t||"ascending",sort:e,getContent:s}},a.prototype.sortByColumnId=function(e,t){var i=this.header.row[e];this._sortByColumn(i,t)},a.prototype._sortByColumn=function(e,t){this.sortBy!==e.sortBy||t?(this._hideCurrentTriangle(),this.sortBy=e.sortBy,this._toggleTriangle(e,!0)):t="ascending"===e.sortBy.order?"descending":"ascending",t&&(e.sortBy.order=t,e.toggleClassName("descending","descending"===t)),this.scroller.removeChild(this.rows),this.sort(),this.scroller.appendChild(this.rows)},a.prototype.resetSort=function(){if(this.defaultSorter){var e=this.header.row[this.defaultSorter.id];this._sortByColumn(e,this.defaultOrder)}},a.prototype.sort=function(e,t){if(e&&this.setSorter(e,t),this.sortBy){var i=this.sortBy,n="ascending"===i.order?1:-1;e=function(e,t){return i.sort(i.getContent(e.rowContent),i.getContent(t.rowContent))*n}}var o=this.rows.getChildren();e&&o.sort(e);for(var s=!0,a=0,r=o.length;a<r;a+=1){var l=o[a];e&&this.rows.appendChild(l),l.isVisible()&&(l.toggleClassName("odd",s),s=!s)}},a.prototype._insertRowInRightPosition=function(e){var t,i,n,o=this.sortBy;o&&(t=o.sort,i="ascending"===o.order?1:-1),t&&(n=o.getContent(e.rowContent));for(var s=!1,a=!1,r=!0,l=this.rows.getChildren(),c=0,d=l.length;c<d;c+=1){var u=l[c];if(u===e){if(t)continue;s=!0}!a&&t&&t(n,o.getContent(u.rowContent))*i<0&&(e.insertBefore(u),a=!0,e.isVisible()&&(e.toggleClassName("odd",r),r=!r)),u.isVisible()&&(u.toggleClassName("odd",r),r=!r)}a||s||(this.rows.appendChild(e),e.toggleClassName("odd",r))},a.prototype.findRow=function(e,t){for(var i=this.rows.getChildren(),n=0,o=i.length;n<o;n+=1){var s=i[n];if(e.call(this,s.rowContent,t))return s.rowId}return null},a.prototype.filter=function(e){var t=this.rows.getChildren(),i=!0;e=e||this._shouldDisplayRow;for(var n=0,o=t.length;n<o;n+=1){var s=t[n],a=e.call(this,s.rowContent);s.toggleDisplay(a),a&&(_.cancelTween(s)&&s.setStyle("webkitTransform",null),s.toggleClassName("odd",i),i=!i)}this.scroller.refresh()},a.prototype.addFilter=function(e){this.filters.push(e)},a.prototype.removeFilter=function(e){var t=this.filters.indexOf(e);t!==-1&&this.filters.splice(t,1)},a.prototype._shouldDisplayRow=function(e){for(var t=0,i=this.filters.length;t<i;t+=1)if(!this.filters[t].call(this,e))return!1;return!0},a.prototype.hasRow=function(e){return!!this.rows.getChild(e)},a.prototype.unSelectRow=function(){this._selectedRow&&this._selectedRow.delClassNames("selected"),this._selectedRow=null},a.prototype.selectRow=function(e,t){var i=this.rows.getChild(e);return this._selectedRow!==i&&(this.unSelectRow(),i.addClassNames("selected"),this._selectedRow=i),t||this.emit("rowTap",i,i.rowContent),i},a.prototype.scrollToSelectedRow=function(){this._selectedRow&&this.scroller.scrollToElement(this._selectedRow)},a.prototype.selectFirstRow=function(e){var t=this.rows.getChildren()[0];t&&this.selectRow(t.rowId,e)},a.prototype.endSlide=function(e){this._slideBack.rowId===e&&(this._slideBack.setStyle("opacity",0),this._slideBack.row.slideBack())},a.prototype.setSlideEnable=function(e){this._slideLock=!e},a.prototype._addSlideBehavior=function(e){m(e,"x");var t,i,n,o=this,s=this._slideBack,a=e.rootElement;e.on("slideStart",function(i,r){o._slideLock||(null!==s.rowId&&o.endSlide(s.rowId),s.rowId=e.rowId,s.row=e,s.setStyles({height:r.height+"px",webkitTransform:"translate3d(0,"+(a.offsetTop+o.scroller.iScroll.y)+"px,0)"}),t=i.x,n=r.width/2)}),e.on("slide",function(e){o._slideLock||(i=e.x-t,i>n?i=n:i<-n&&(i=-n),s.setStyle("opacity",Math.abs(i)/n),this.setStyle("webkitTransform","translate3d("+i+"px,0,0)"))}),e.slideBack=function(t){s.rowId=null,_.tween(e,{webkitTransform:"translate3d(0,0,0)"},{time:100,easing:"ease-out"},function(){s.setStyle("opacity",0),s.delClassNames("spinner",s.side),t&&t()})},e.on("slideEnd",function(t,a,r){o._slideLock||(Math.abs(i)>=n||r?i>0?(s.side="left",s.addClassNames("spinner","left"),o.emit("rowSlidedLeft",e,e.rowContent)):(s.side="right",s.addClassNames("spinner","right"),o.emit("rowSlidedRight",e,e.rowContent)):e.slideBack())})},a.prototype._createRow=function(e,t,i){t=void 0!==t?t:this.getIdFn(e);var n=this,o=this.rows.appendChild(new h("div",{className:"row",name:t}));this._slidable&&this._addSlideBehavior(o),i&&o.setStyle("webkitTransform","translate3d(100%,0,0)"),o.rowId=t,o.rowContent=e,o.myTable=this;for(var s=0,a=this.cols.length;s<a;s+=1){var r=this.cols[s];o[r.id]=o.createChild("div",{className:["col",r.id]}),c(o,r)}return this._clickable&&(p(o),o.on("enable",l),o.on("tap",function(){n.selectRow(t)})),this._onRowCreation&&this._onRowCreation(o,e),o.toggleDisplay(this._shouldDisplayRow(e)),this.emit("rowAdded",t,e,o),o},a.prototype.addRow=function(e,t,i){var n=this._createRow(e,t,i);return this._insertRowInRightPosition(n),this.scroller.refresh(),i?(this.scroller.scrollToElement(n),_.tween(n,{webkitTransform:"translate3d(0,0,0)"},{time:b,easing:"ease-out"})):n.setStyle("webkitTransform",null),n},a.prototype._playAnimationForNewRows=function(e){for(var t,i=this.rows.getChildren(),n=0,o=v/2,s=0;s<i.length;s++){var a=i[s];if(e[a.rowId])if(n>=v||!a.isVisible())a.setStyle("webkitTransform",null);else{0===n&&(t=a);var r=(o-Math.abs(n-o))*y;n++,_.tween(a,{webkitTransform:"translate3d(0,0,0)"},{time:b,easing:"ease-out",delay:r})}}t&&this.scroller.scrollToElement(t)},a.prototype.addList=function(e,t,i){if(this.scroller.removeChild(this.rows),e.length&&this.setPlaceholderText(""),i)for(var n=0;n<e.length;n++){var o=this.getIdFn(e[n]);this.hasRow(o)&&this.delRow(o,!1)}var s,a,r,l={};for(a=0,r=e.length;a<r;a+=1)s=this._createRow(e[a],void 0,t),t&&(l[s.rowId]=s);this.sort(),this.scroller.appendChild(this.rows),this.scroller.refresh(),t&&this._playAnimationForNewRows(l)},a.prototype.addMap=function(e,t){this.scroller.removeChild(this.rows);var i={};for(var n in e){var o=this._createRow(e[n],n,t);i[o.rowId]=o}this.sort(),this.scroller.appendChild(this.rows),this.scroller.refresh(),t&&this._playAnimationForNewRows(i)},a.prototype._updateRow=function(e,t){t=void 0!==t?t:this.getIdFn(e);var i=this.rows.getChild(t);if(!i)return this.addRow(e,t);i.rowContent=e;for(var n=0,o=this.cols.length;n<o;n+=1)c(i,this.cols[n]);return i.toggleDisplay(this._shouldDisplayRow(e)),i},a.prototype.refreshRows=function(){for(var e=this.rows.getChildren(),t=0;t<e.length;t++){var i=e[t];this._updateRow(i.rowContent,i.rowId)}},a.prototype.updateRows=function(e){for(var t=0,i=e.length;t<i;t+=1)this._updateRow(e[t]);this.sort()},a.prototype.updateRow=function(e,t){var i=this._updateRow(e,t);return this._insertRowInRightPosition(i),i},a.prototype.getRow=function(e){return this.rows.getChild(e)},a.prototype.updateCell=function(e,t,i){var n=this.rows.getChild(e);if(!n)return console.error(new Error("Row id unknown: "+e));var o=n[t];if(!o)return console.error(new Error("Column id unknown: "+t));var s=this.cols[this.colIndex[t]];return n.rowContent=i,c(n,s),n.toggleDisplay(this._shouldDisplayRow(i)),this.sortBy===s&&this._insertRowInRightPosition(n),n},a.prototype.getCell=function(e,t){var i=this.rows.getChild(e);if(!i)return console.error(new Error("Row id unknown "+e));var n=i[t];return n?n.content:console.error(new Error("Column id unknown "+t))},a.prototype._delRow=function(e){var t=this.rows.getChild(e);t&&(this._selectedRow===t&&(this._selectedRow=null),this.emit("rowDeleted",e,t.rowContent,t),t.destroy())},a.prototype.delRow=function(e,t){function i(){o._delRow(e),o._updateRowColor(),o.scroller.refresh()}var n=this.rows.getChild(e);if(n){var o=this;return t?void _.tween(n,{webkitTransform:"translate3d(-100%,0,0)"},{time:b,easing:"ease-out"},i):i()}},a.prototype.delRows=function(e,t,i){function n(){for(var t=0,n=e.length;t<n;t+=1)o._delRow(e[t]);o._updateRowColor(),o.scroller.refresh(),i&&i.call(o)}var o=this;if(!e.length||!t)return n();for(var s=0,a=e.length;s<a;s+=1){
var r=this.rows.getChild(e[s]);if(r){var l=s===a-1?n:null;_.tween(r,{webkitTransform:"translate3d(-100%,0,0)"},{time:b,easing:"ease-out",delay:s*y},l)}}},a.prototype.clearContent=function(){this.rows.clearContent(),this._selectedRow=null,this.scroller.refresh()},a.prototype.getRowCount=function(){return this.rows.getChildCount()},a.prototype._updateRowColor=function(){for(var e=!0,t=this.rows.getChildren(),i=0,n=t.length;i<n;i+=1){var o=t[i];o.isVisible()&&(o.toggleClassName("odd",e),e=!e)}}},function(e,t){},function(e,t,i){function n(){h.close(this.myWindow.id)}function o(){window.clearTimeout(this.freeContentTimeout),this.openingSound&&p(this.openingSound||"WINDOW_OPEN"),this.isReadyForUserInteraction=!0}function s(){this.isReadyForUserInteraction&&this.emit("contentReady")}function a(){if("number"==typeof this.freeContentDelay||"function"==typeof this.freeContent){if("function"!=typeof this.freeContent)return console.error("missing freeContent method for",this.id);this.freeContentTimeout=window.setTimeout(this.freeContent.bind(this),this.freeContentDelay||0)}this.closingSound&&p(this.closingSound||"WINDOW_CLOSE")}function r(e){e=e||{},c.call(this,"div",{className:"window",hidden:!0}),this.addClassNames(e.className),this.positionInfo=e.positionInfo,this.freeContentDelay=e.freeContentDelay,this.freeContentTimeout=null;var t=this;this.position=null,this.openState=!1,this.isReadyForUserInteraction=!1,this.windowBorder=this.createChild("div",{className:"windowBorder"}),this.windowContent=this.createChild("div",{className:"windowContent"}),this.header=this.windowHeadWrapper=this.windowContent.createChild("div",{className:"windowHeadWrapper"}),e.noTitle||(this.windowTitle=this.windowHeadWrapper.createChild("div",{className:"windowTitle"}),this.windowTitle.setText(e.title||"")),e.plusButton&&(this.plusButton=this.windowHeadWrapper.appendChild(new d({className:"plusButton",scaleOnPress:!0})),this.plusButton.myWindow=this),e.minusButton&&(this.minusButton=this.windowHeadWrapper.appendChild(new d({className:"minusButton",scaleOnPress:!0})),this.minusButton.myWindow=this),e.noCloseButton||(this.closeButton=this.windowHeadWrapper.appendChild(new u({scaleOnPress:!0})),this.closeButton.myWindow=this,e.customClose||this.closeButton.on("tap",n)),this.openingSound=e.openingSound,this.closingSound=e.closingSound,this.windowBodyWrapper=this.windowContent.createChild("div",{className:"windowBodyWrapper"}),this.windowBody=this.windowBodyWrapper.createChild("div",{className:"windowBody"}),this.on("open",o),this.on("opened",s),this.on("close",a),this.on("resize",function(){t.position.width=t.windowWidth||0,t.position.height=t.windowHeight||0})}i(542);var l=i(172).inherits,c=i(321),d=i(335),u=i(543),h=i(194),p=i(247).playUiSound;l(r,c),e.exports=r,r.prototype.startWaitingForContent=function(){this.isReadyForUserInteraction=!1},r.prototype.finishedWaitingForContent=function(){this.isReadyForUserInteraction=!0,this.emit("contentReady")},r.prototype.setTitle=function(e){this.windowTitle.setText(e)},r.prototype.localizeEvent=function(e){var t=this;return function(){t.openState&&e.apply(this,arguments)}},r.prototype.close=function(e){h.close(this.id,e)}},function(e,t){},function(e,t,i){function n(e,t){e=e||{};var i={className:"closeButton",sound:"CANCEL_BUTTON"};for(var n in i)void 0===e[n]&&(e[n]=i[n]);s.call(this,e,t)}var o=i(172).inherits,s=i(335);o(n,s),e.exports=n},function(e,t,i){function n(e){h.call(this,"div",{className:"searchBox"}),e=e||{},this.isLiveSearch=!!e.isLiveSearch,this.maxLength=e.maxLength||50,this._createContent(e.label)}function o(){var e=this.mySearchBox;if(e.isLiveSearch){var t=e.searchInput.getValue();e.emit("search",t),e.cancelBtn.toggleDisplay(!!t)}else e.cancelBtn.show()}function s(){var e=this.mySearchBox,t=e.searchInput.getValue();return 0===t.length?a.call(e.cancelBtn):!e.isLiveSearch&&t.length<p?u.showNotification(l("ui.common.searchFilterTooltip"),e):void(t!==e.lastEmittedValue&&(e.lastEmittedValue=t,e.searchInput.blur(),e.emit("search",t)))}function a(){var e=this.mySearchBox;e.cancelBtn.hide(),e.clear(),e.searchInput.blur(),e.emit("search","")}i(545);var r=i(335),l=i(29).getText,c=i(172).inherits,d=i(530),u=i(546),h=i(321),p=3;c(n,h),e.exports=n,n.prototype.clear=function(){this.lastEmittedValue=null,this.searchInput.setValue(""),this.cancelBtn.hide()},n.prototype.setValue=function(e){this.searchInput.setValue(e),this.cancelBtn.toggleDisplay("string"==typeof e&&""!==e)},n.prototype.setPlaceholder=function(e){this.searchInput.setPlaceholder(e)},n.prototype._createContent=function(e){e&&this.createChild("div",{className:"label",text:e});var t=this.createChild("div",{className:"inputFrame"}),i=this.searchInput=t.appendChild(new d({attr:{maxLength:this.maxLength}}));i.mySearchBox=this,i.on("change",o),i.on("validate",s);var n=this.cancelBtn=t.appendChild(new r({className:"cancelBtn",addIcon:!0,hidden:!0},a));if(n.mySearchBox=this,!this.isLiveSearch){var l=this.appendChild(new r({className:"searchBtn",addIcon:!0},s));l.mySearchBox=this}},n.prototype.showAsSearching=function(e){this.toggleClassName("spinner",e),this.searchInput.setEnable(!e)}},function(e,t){},function(e,t,i){function n(){r=window.gui.wBody.appendChild(new a({className:"notification"})),r.appendChild(new s({className:"closeButton",scaleOnPress:!0},function(){t.closeNotifications()}))}function o(){t.closeNotifications()}i(547);var s=i(335),a=i(337),r=null,l=!1;t.showClosableNotification=function(e,t){return r||n(),l||(window.gui.wBody.on("dom.touchend",o),l=!0),r.updateAndAppearAt(e,t),r},t.closeNotifications=function(){l&&(window.gui.wBody.removeListener("dom.touchend",o),l=!1),r&&r.closeTooltip()},t.showNotification=function(e,t,i){a.showNotification(e,t,i)}},function(e,t){},function(e,t,i){function n(){M.call(this,"div",{className:"MountDetails"}),this.mountData={},this.boostMap={1:{property:"energy",update:this._setEnergy},2:{property:"serenity",update:this._setSerenity},3:{property:"stamina",update:this._setStamina},4:{property:"love",update:this._setLove},5:{property:"maturity",update:this._setMaturity},6:{property:"boostLimiter",update:this._setTiredness}},this._givenXP=0,this._name="",this.shouldResetTab=!0,this.hasDomAndListeners=!1,this.on("destroy",function(){this.hasDomAndListeners&&(this._setEventListeners(!1),this.hasDomAndListeners=!1)})}function o(){return this.tooltipText}i(549);var s=i(182),a=i(335),r=i(355),l=i(550),c=i(551),d=i(29).getText,u=i(172).inherits,h=i(332),p=i(554),m=i(555),f=i(557),g=i(559),_=i(561),v=i(563),y=i(337),b=i(194),M=i(321),w=33,T=0,C=1,A=2;u(n,M),e.exports=n,n.EFFECT_MOUNT=995,n.EFFECT_INVALID_CERTIF=994,n.isItemInstanceWithMountInfo=function(e){return!!e.effectsMap[n.EFFECT_MOUNT]},n.getMountInfoFromCertificate=function(e){return e.effectsMap[n.EFFECT_MOUNT]},n.prototype.getIllustrationElement=function(){return this.hasDomAndListeners||this._setupDomAndListeners(),this._mountIllus},n.prototype._createProgressBar=function(e,t,i,n){var o=d("ui.common.colon"),s=e.createChild("div",{className:t});return s.createChild("div",{className:"label",text:i+o}),s.appendChild(new f({className:["mountBar",n],tooltip:i}))},n.prototype._getActionOnMount=function(e){var t=this.mountData.mountLocation;return t?l[this.mountData.mountLocation][e]:null},n.prototype._exchangeAction=function(e){var t=this._getActionOnMount(e);if(!t)return console.error(new Error("Invalid action "+e));var i=this;window.dofus.sendMessage("ExchangeHandleMountStableMessage",{actionType:t,rideId:i.mountData.id})},n.prototype._setSex=function(e){e?this._sexIcon.replaceClassNames(["male"],["female"]):this._sexIcon.replaceClassNames(["female"],["male"])},n.prototype._setupDomAndListeners=function(){this.mustResize=!0,this._createMinMaxBox(),this._createMainInformation(),this._createPanels(),this._createButtons(),this._setEventListeners(!0),this.hasDomAndListeners=!0},n.prototype._createMainInformation=function(){var e=this,t=this.createChild("div",{className:"mainContainer"}),i=t.createChild("div",{className:"mainInfosTop"}),n=i.createChild("div",{className:"leftColumn"});this._mountIllus=n.createChild("div",{className:"mountIllus"}),this._sexIcon=this._mountIllus.createChild("div",{className:"sexIcon"}),y.addTooltip(this._mountIllus,o);var s=i.createChild("div",{className:"rightColumn"});this._mountName=s.createChild("div",{className:"mountName"}),this._renameButton=s.appendChild(new a({className:["simpleButton","tinyBtn","renameBtn"],tooltip:d("ui.mount.renameTooltip")},function(){b.open("mountRename",{name:e.mountData.name,mountId:e.mountData.id,inputBox:e._mountName})}));var r=s.createChild("div",{className:"typeAndLevel"});this._mountType=r.appendChild(new m),this._level=r.createChild("div",{className:"level"});var l=t.createChild("div",{className:"mainInfosBottom"}),c=this.abilityDiv=l.createChild("div",{className:"abilityDiv"});this.abilities=[];for(var u=0;u<A;u++){var h=this.abilities[u]=c.createChild("div",{className:"ability"});y.addTooltip(h,o)}var p=l.createChild("div",{className:"statusIcons"});this.fertileIcon=p.appendChild(new _("fertile",{tooltip:""})),this.domesticIcon=p.appendChild(new _("domestic",{tooltip:d("tablet.mount.domestic")})),this.mountableIcon=p.appendChild(new _("mountable",{tooltip:d("ui.common.mountable")})),this._rideButtonDiv=p.createChild("div",{className:"rideBtnDiv"}),this._rideButton=this._rideButtonDiv.appendChild(new a({className:["greenButton","rideButton"],addIcon:!0,tooltip:d("ui.mount.rideTooltip")},function(){window.dofus.sendMessage("MountToggleRidingRequestMessage")}))},n.prototype._createPanels=function(){var e=this._tabs=this.appendChild(new v({className:"tabs"}));e.addTab(d("tablet.mount.breeding"),this._createBreedingPanel()),e.addTab(d("ui.common.short.caracteristic"),this._createStatPanel())},n.prototype._createBreedingPanel=function(){var e=new M("div",{className:"panel"}),t=e.createChild("div",{className:"breedingPanel"}),i=d("ui.common.colon");this._tirednessValue=this._createProgressBar(t,["progressBar2col","tired"],d("ui.common.tire"),"orange");var n=t.createChild("div",{className:"iconGaugeBar"});this._staminaGauge=n.appendChild(new c("stamina",d("ui.common.stamina"))),this._maturityGauge=n.appendChild(new c("maturity",d("ui.common.maturity"))),this._loveGauge=n.appendChild(new c("love",d("ui.common.love"))),this._serenityGauge=t.appendChild(new g);var o=this._fertilityDiv=t.createChild("div",{className:["textInfo","mating"]});return o.createChild("div",{className:"label",text:d("ui.common.reproductions")+i}),this._fertilityValue=o.createChild("div",{className:"value"}),this._fecondationState=t.createChild("div",{className:"fecondationState"}),e},n.prototype._createStatPanel=function(){var e=new M("div",{className:"panel"}),t=e.createChild("div",{className:"statPanel"});return this._energyGauge=t.appendChild(new c("energy",d("ui.common.energy"),{size:w})),this._experienceValue=this._createProgressBar(t,["progressBar2col","xp"],d("ui.common.experiment"),"blue"),this._createGivenXp(t),t.createChild("div",{className:"effectLabel",text:d("ui.effects")}),this._effectsContent=t.createChild("div",{className:"effectsContent"}),e},n.prototype._createGivenXp=function(e){var t=this,i=this._givenXpDiv=e.createChild("div",{className:"givenXp"}),n=d("ui.common.giveXP")+d("ui.common.colon");i.createChild("div",{className:"label",text:n});var o=i.createChild("div",{className:"valueAndButton"});this._xpValue=o.createChild("div",{className:"value"}),o.appendChild(new a({className:["simpleButton","tinyBtn","xpButton"],tooltip:d("ui.mount.xpPercentTooltip")},function(){t.minMaxSelector.open({min:0,max:90,defaultValue:t._givenXP})}))},n.prototype._feedMount=function(){var e=b.getWindow("feed");if(!e.possessFeedItemForMount())return window.gui.openSimplePopup(d("ui.item.errorNoFoodMount"));var t="shed"===this.mountData.mountLocation?p.LOCATION_STABLED:p.LOCATION_EQUIPED;b.open("feed",{mode:"mount",mountUid:this.mountData.id,mountLocation:t})},n.prototype._neuterMount=function(){var e=this;window.gui.openConfirmPopup({title:d("ui.popup.warning"),message:d("ui.mount.doUCastrateYourMount"),cb:function(t){t&&(e.inBreeding?e._exchangeAction("sterilize"):window.dofus.sendMessage("MountSterilizeRequestMessage"))}})},n.prototype._releaseMount=function(){var e=this;window.gui.openConfirmPopup({title:d("ui.popup.warning"),message:d("ui.mount.doUKillYourMount"),cb:function(t){t&&(e.inBreeding?e._exchangeAction("free"):window.dofus.sendMessage("MountReleaseRequestMessage"))}})},n.prototype._createButtons=function(){var e=this,t=this.createChild("div",{className:"buttons"});this._feedButton=t.appendChild(new a({className:["simpleButton","mountButton","feedButton"],tooltip:d("ui.mount.feed")},this._feedMount.bind(this))),this._feedButton.disable(),this._inventoryButton=t.appendChild(new a({className:["simpleButton","mountButton","inventoryButton"],tooltip:d("ui.mount.inventoryAccess")},function(){window.dofus.sendMessage("ExchangeRequestOnMountStockMessage")})),this._genealogyButton=t.appendChild(new a({className:["simpleButton","mountButton","genealogyButton"],tooltip:d("ui.mount.ancestorTooltip")},function(){b.open("familyTree",e.mountData)})),this._cutButton=t.appendChild(new a({className:["simpleButton","mountButton","cutButton"],tooltip:d("ui.mount.castrateTooltip")},this._neuterMount.bind(this))),this._releaseButton=t.appendChild(new a({className:["simpleButton","mountButton","releaseButton"],tooltip:d("ui.mount.killTooltip")},this._releaseMount.bind(this)))},n.prototype._createMinMaxBox=function(){var e=this.minMaxSelector=this.appendChild(new h);e.setStyles({left:"-12px",top:"249px"});var t=this;e.on("confirm",function(e){e!==t._givenXP&&window.dofus.sendMessage("MountSetXpRatioRequestMessage",{xpRatio:e})})},n.prototype._processMountRenamed=function(e){e.mountId===this.mountData.id&&(this._setName(e.name),this.emit("renameMount",this._name))},n.prototype._processMountSterilized=function(e){e.mountId===this.mountData.id&&(this.mountData.reproductionCount=-1,this._setFertilityState())},n.prototype._processMountRiding=function(e){var t=window.gui.playerData;t.equippedMount.id===this.mountData.id&&this._setRideButton(e)},n.prototype._processMountReleased=function(e){e.mountId===this.mountData.id&&this.emit("freeMount",e.mountId)},n.prototype._processUpdateMountBoost=function(e){e.rideId===this.mountData.id&&this._updateBoost(e.boostToUpdateList)},n.prototype._setEventListeners=function(e){var t=window.gui.playerData,i=window.dofus.connectionManager;e?(this.mountRenamedHandler||(this.mountRenamedHandler=this._processMountRenamed.bind(this),this.mountSterilizedHandler=this._processMountSterilized.bind(this),this.mountReleasedHandler=this._processMountReleased.bind(this),this.updateMountBoostHandler=this._processUpdateMountBoost.bind(this),this.setRatioHandler=this._setXpRatio.bind(this),this.mountRidingHandler=this._processMountRiding.bind(this)),i.on("MountRenamedMessage",this.mountRenamedHandler),i.on("MountSterilizedMessage",this.mountSterilizedHandler),i.on("MountReleasedMessage",this.mountReleasedHandler),i.on("UpdateMountBoostMessage",this.updateMountBoostHandler),t.on("setMountRatio",this.setRatioHandler),t.on("mountRiding",this.mountRidingHandler)):(i.removeListener("MountRenamedMessage",this.mountRenamedHandler),i.removeListener("MountSterilizedMessage",this.mountSterilizedHandler),i.removeListener("MountReleasedMessage",this.mountReleasedHandler),i.removeListener("UpdateMountBoostMessage",this.updateMountBoostHandler),t.removeListener("setMountRatio",this.setRatioHandler),t.removeListener("mountRiding",this.mountRidingHandler))},n.prototype._updateBoost=function(e){for(var t=this.mountData,i=0;i<e.length;i+=1){var n=e[i],o=this.boostMap[n.type].property;t[o]=n.value,this.boostMap[n.type].update.call(this,n.value)}},n.prototype._setSpecificBehaviors=function(e){if(this.abilityDiv.toggleClassName("withoutAbilities",0===e.length),e.length)for(var t=window.gui.databases.MountBehaviors,i=0;i<this.abilities.length;i++){var n=this.abilities[i],o=e[i];o&&(n.setText(t[o].nameId),n.tooltipText=t[o].descriptionId),n.toggleDisplay(!!o)}},n.prototype._setName=function(e){this._name=this.mountData.name=e,this._name||(this._name=d("ui.common.noName")),this._mountName.setText(this._name);var t=d(this.mountData.sex?"ui.common.animalFemale":"ui.common.animalMale");this._mountIllus.tooltipText=this._name+" ("+t+")"},n.prototype.getName=function(){return this._name},n.prototype._setXpRatio=function(e){this._givenXP=e,this._xpValue.setText(e+"%")},n.prototype._setRideButton=function(e){this._rideButton.toggleClassName("isRiding",!!e)},n.prototype._setLove=function(e){this._loveGauge.setValue(e,this.mountData.loveMax)},n.prototype._setTiredness=function(e){this._tirednessValue.setValue(e,this.mountData.boostMax)},n.prototype._setEnergy=function(e){this._energyGauge.setValue(e,this.mountData.energyMax)},n.prototype._setStamina=function(e){this._staminaGauge.setValue(e,this.mountData.staminaMax)},n.prototype._setMaturity=function(e){this._maturityGauge.setValue(e,this.mountData.maturityForAdult)},n.prototype._setSerenity=function(e){this._serenityGauge.setValue(e)},n.getFertilityState=function(e){var t=e.reproductionCount,i=e.reproductionCountMax,n=t>=0&&t<i,o=t<0,s={canReproduce:n,isNeutered:o,isFecondationReady:e.isFecondationReady,fecondationTime:e.fecondationTime};return n&&(s.reproCount=t,s.reproMax=i),e.isNewborn&&(s.isNewborn=!0),s},n.prototype._setFertilityState=function(){var e=n.getFertilityState(this.mountData),t=!!e.canReproduce;t&&this._fertilityValue.setText(e.reproCount+"/"+e.reproMax),this._fertilityDiv.toggleDisplay(t),this._cutButton.setEnable(t&&!!this._getActionOnMount("sterilize")),this.fertileIcon.setFertileIcon(e,!0)},n.prototype._setFecondationState=function(){var e=this.mountData.isFecondationReady,t=this.mountData.fecondationTime,i=!e&&t>-1;this._fecondationState.toggleDisplay(i),i&&this._fecondationState.setText(d("ui.mount.pregnantSince",t))},n.prototype._setExperience=function(e,t,i){i===-1&&(i=e);var n=(e-t)/(i-t);this._experienceValue.setValue(e,i,n)},n.prototype._resize=function(){return this.isVisible()&&this.rootElement.clientWidth?(this.mustResize=!1,void this._serenityGauge.resize()):this.once("show",this._resize.bind(this))},n.prototype.setMount=function(e,t){var i=this,n=window.gui.playerData;e=e||{},t=t||{};var o=this.inBreeding="breeding"===t.context;this.hasDomAndListeners||this._setupDomAndListeners(),this.shouldResetTab&&(this.shouldResetTab=!1,this._tabs.openTab(o?T:C)),this.mustResize&&this._resize(),this.mountData=e;var a=e.mountLocation;a||console.error("Mount",e.id,"does not have a location."),this._givenXpDiv.toggleDisplay("equip"===a),this._setXpRatio(e.xpRatio),this.domesticIcon.setEnabled(!e.isWild);var l="equipped"===t.context;this._rideButtonDiv.toggleDisplay(l),this.mountableIcon.toggleDisplay(!l),l?(this._rideButton.setEnable(e.isRideable),this._setRideButton(n.isRiding)):this.mountableIcon.setEnabled(e.isRideable),this._setName(e.name),this._setSpecificBehaviors(e.behaviors),this._releaseButton.setEnable(!!this._getActionOnMount("free")),this._renameButton.setEnable("equip"===e.mountLocation||"shed"===e.mountLocation),this._feedButton.setEnable(e.maturity===e.maturityForAdult&&("shed"===this.mountData.mountLocation||"equip"===this.mountData.mountLocation)&&"fight"!==window.foreground.tapOptions.mode),this._inventoryButton.setEnable(e.maxPods>0&&"equip"===e.mountLocation&&!o),this._level.setText(d("ui.common.short.level")+" "+e.level),this._setExperience(e.experience,e.experienceForLevel,e.experienceForNextLevel),this._setFecondationState(),this._setFertilityState(),this._setSex(e.sex),this._setEnergy(e.energy),this._setLove(e.love),this._setTiredness(e.boostLimiter),this._setStamina(e.stamina),this._setMaturity(e.maturity),this._setSerenity(e.serenity),this._mountType.setModel(e.model),s.preloadImage("gfx/mounts/"+e.model+".png",function(e){i._mountIllus.setStyle("backgroundImage",e)}),r.createEffectInstances(e.effectList,function(e,t){var n="<ul>",o="<li>"+d("ui.common.lowerNone",0)+"</li>";if(e)return n+=o+"</ul>",i._effectsContent.setHtml(o),console.error(e);if(t.length<=0)return n+=o+"</ul>",i._effectsContent.setHtml(o);for(var s=0,a=t.length;s<a;s+=1){var r=t[s];n+="<li>"+r.description+"</li>"}n+="</ul>",i._effectsContent.setHtml(n)})}},function(e,t){},function(e,t){e.exports={shed:{equip:2,free:3,certificate:4,paddock:6,sterilize:17},paddock:{shed:7,free:8,equip:10,certificate:14,sterilize:19},equip:{shed:1,paddock:9,free:11,certificate:13,sterilize:18},certificate:{shed:5,paddock:16,equip:15}}},function(e,t,i){function n(e,t,i){r.call(this,"div",{className:["gaugeIcon",e]}),i=i||{},this.name=e,this.createChild("div",{className:"icon"});var n=i.size||l,o=i.thickness||(n<l?d:c);this.progressCircle=this.appendChild(new a({size:n,thickness:o,color:i.color||h[e],bgColor:i.bgColor||u,tooltip:t})),this.valueElement=i.withoutLabel?null:this.createChild("div",{className:"value",text:""})}i(552);var o=i(339),s=i(172).inherits,a=i(553),r=i(321),l=40,c=2.5,d=2,u="#222",h={energy:"#ffcc00",stamina:"#ebae23",maturity:"#0099ff",love:"#ff1e1e"},p={stamina:.75,maturity:1,love:.75},m=.001;s(n,r),e.exports=n,n.prototype.setValue=function(e,t,i){i=i||p[this.name]||m,this.valueElement&&this.valueElement.setText(o.intToString(e));var n=!t||!i||e>=t*i;this.toggleClassName("enabled",n),this.progressCircle.setValue(e,t)},n.prototype.setLabel=function(e){this.valueElement.setText(e)}},function(e,t){},function(e,t,i){function n(e){e=e||{},r.call(this,"div",{className:"ProgressCircle"}),this.addClassNames(e.className),this.size=e.size||l,this.thickness=e.thickness||Math.round(.15*this.size),this.bgThickness=e.bgThickness||this.thickness+2,this.color=e.color||"#EEE",this.bgColor=e.bgColor,e.tooltip&&(this.tooltipText=e.tooltip,a.addTooltip(this,this._tooltipHandler.bind(this))),this.radius=(this.size-this.bgThickness)/2,this.center=this.size/2;var t=this.createChild("canvas",{className:"canvas"}).rootElement;t.width=this.size,t.height=this.size,t.style.width=this.size+"px",t.style.height=this.size+"px",this._ctx=t.getContext("2d")}var o=i(29).getText,s=i(172).inherits,a=i(337),r=i(321),l=50;s(n,r),e.exports=n,n.prototype.setValue=function(e,t){var i;t?(this.value=e,i=e/t):(this.value=e,i=e),this.maxValue=t;var n=this._ctx;this._ctx.clearRect(0,0,n.canvas.width,n.canvas.height),this.bgColor&&this._drawArc(this.bgThickness,this.bgColor,1),this._drawArc(this.thickness,this.color,i)},n.prototype._drawArc=function(e,t,i){i<.01&&0!==i&&(i=.01),i>.99&&1!==i&&(i=.99);var n=this._ctx;n.lineWidth=e,n.strokeStyle=t,n.beginPath(),n.arc(this.center,this.center,this.radius,-.5*Math.PI,(2*i-.5)*Math.PI,!1),n.stroke()},n.prototype._tooltipHandler=function(){var e=this.tooltipText+o("ui.common.colon");return this.maxValue?e+this.value+" / "+this.maxValue:e+this.value+"%"}},function(e,t){e.exports={LOCATION_EQUIPED:1,LOCATION_INVENTORY:2,LOCATION_STABLED:3,LOCATION_MAP:4}},function(e,t,i){function n(){l.call(this,"div",{className:"mountType"}),this.color1=this.createChild("div",{className:"color"}),this.color2=this.createChild("div",{className:["color","color2"]}),r.addTooltip(this,o)}function o(){return this.tooltipText}i(556);var s=i(172).inherits,a=i(30),r=i(337),l=i(321),c=["#656d61","#d1d6d0"];s(n,l),e.exports=n,n.ARMOURED_MOUNT_ID=88,n.FEATHERY_MOUNT_ID=89,n.parseColorsFromLook=function(e,t){if(e===n.ARMOURED_MOUNT_ID)return c;var i=t.split("|")[2];if(!i)return[];for(var o=i.split(","),s=[],a=0;a<3;a++){var r=o[a].split("="),l=parseInt(r[0],10)-1,d=parseInt(r[1],10);s[l]="#"+d.toString(16)}return s},n.isSingleColor=function(e){return e[0]===e[1]||e[0]===e[2]},n.prototype.setModel=function(e){var t=this;a.getData("Mounts",e,function(i,o){if(i)return console.error("Failed loading Mounts with id=",e);var s=n.parseColorsFromLook(e,o.look);t.color1.setStyle("backgroundColor",s[0]),t.color2.setStyle("backgroundColor",s[1]),t.color2.toggleDisplay(!n.isSingleColor(s)),t.tooltipText=o.nameId})}},function(e,t){},function(e,t,i){function n(e){e=e||{},r.call(this,"div",{className:"ProgressBar",name:e.name}),this.addClassNames(e.className),this.barBg=this.createChild("div",{className:"barBg"}),this.barFill=this.createChild("div",{className:"barFill"}),this.barColor=this.barFill.createChild("div",{className:"barColor"}),this.vertical=e.vertical||!1,this.barFill.toggleClassName("vertical",this.vertical),e.tooltip&&(this.tooltipText=e.tooltip,a.addTooltip(this,this._tooltipHandler.bind(this))),this.epsilon=void 0===e.epsilon?5:e.epsilon,this.setValue(e.value||0)}i(558);var o=i(29).getText,s=i(172).inherits,a=i(337),r=i(321);s(n,r),e.exports=n,n.prototype.setValue=function(e,t,i){this.maxValue=t,t?(this.humanValue=e,void 0!==i?e=i:e/=t):this.humanValue=Math.round(100*e),e*=100;var n=this.epsilon;e<n&&e>0&&(e=n),e>100-n&&e<100&&(e=100-n),e=Math.round(e);var o=e?e+"%":"1px";this.barFill.setStyle("-webkit-mask-size",this.vertical?"100% "+o:o+" 100%"),this.barFill.setStyle("-webkit-mask-position",this.vertical?"0 100%":"0 0")},n.prototype.setRange=function(e,t){var i=t-e,n=i?Math.round(100*i)+"%":"1px",o=e?Math.round(100*e)+"%":"1px";this.barFill.setStyle("-webkit-mask-size",this.vertical?"100% "+n:n+" 100%"),this.barFill.setStyle("-webkit-mask-position",this.vertical?"100% "+o:o+" 100%")},n.prototype._tooltipHandler=function(){var e=this.tooltipText+o("ui.common.colon");return this.maxValue?e+this.humanValue+" / "+this.maxValue:e+this.humanValue+"%"}},function(e,t){},function(e,t,i){function n(e){r.call(this,"div",{className:"serenityGauge"}),e=e||{};var t=this.isMini=e.isMini;t&&this.addClassNames("mini"),t||this.createChild("div",{className:["bigIcon","bigIcon_mad"]});var i=this.createChild("div",{className:"barWrapper"}),n=this._serenityBar=i.createChild("div",{className:"serenityBar"});this.zones=[],this._createColorZone("stamina",l,c,o("ui.mount.viewerTooltipZone1")),this._createColorZone("maturity",c,d,o("ui.mount.viewerToolTipZone2")),this._createColorZone("love",d,u,o("ui.mount.viewerTooltipZone3")),this._serenityBarCursor=n.createChild("div",{className:"cursor"}),t||(this._serenityValue=this._serenityBarCursor.createChild("div",{className:"value"})),i.createChild("div",{className:"background"}),t||this.createChild("div",{className:["bigIcon","bigIcon_happy"]})}i(560);var o=i(29).getText,s=i(172).inherits,a=i(337),r=i(321),l=-1e4,c=-2e3,d=2e3,u=1e4,h=73,p=50;s(n,r),e.exports=n,n.SERENITY_MIN=l,n.SERENITY_MAX=u,n.GOOD_SERENITY_MIN=c,n.GOOD_SERENITY_MAX=d,n.prototype._createColorZone=function(e,t,i,n){var s=this._serenityBar.createChild("div",{className:["colorZone",e]});this.isMini||(s.createChild("div",{className:"icon"}),a.addTooltip(s,o("tablet.mount.serenityZoneTooltip",t,i,n))),s.name=e,s.min=t,s.max=i,this.zones.push(s),this._serenityBar[e]=s},n.prototype.resize=function(){this.isMini?(this.serenityBarWidth=h,this.serenityCursorOffset=-p/2):(this.serenityBarWidth=this._serenityBar.rootElement.clientWidth,this.serenityCursorOffset=-this._serenityBarCursor.rootElement.clientWidth/2);for(var e=u-l,t=this._serenityBar.maturity,i=(t.max-t.min)/e*this.serenityBarWidth/2,n=0,o=this.zones,s=0;s<o.length;s++){var a=o[s],r=(a.max-a.min)/e,c=r*this.serenityBarWidth;"maturity"!==a.name&&(c+=i),"stamina"!==a.name&&(n-=i),a.setStyle("left",n+"px"),a.setStyle("width",c+"px"),n+=c}this._serenityBar.maturity.setStyles({borderBottomLeftRadius:i+"px",borderTopRightRadius:i+"px"})},n.prototype.setValue=function(e){this.isMini||this._serenityValue.setText(e);var t=(e-l)/(u-l),i=t*this.serenityBarWidth+this.serenityCursorOffset;this._serenityBarCursor.setStyle("left",i+"px"),this._serenityBar.stamina.toggleClassName("disabled",e>=0),this._serenityBar.maturity.toggleClassName("disabled",e<c||e>d),this._serenityBar.love.toggleClassName("disabled",e<=0)}},function(e,t){},function(e,t,i){function n(e,t){l.call(this,"div",{className:["statusIcon",e]}),t=t||{},this.isEnabled=!1,this.tooltipText=t.tooltip,void 0!==t.tooltip&&r.addTooltip(this,o)}function o(){return this.isEnabled===!1?new l("div",{className:"disabledTooltipFeature",text:this.tooltipText}):this.tooltipText}i(562);var s=i(29).getText,a=i(172).inherits,r=i(337),l=i(321);a(n,l),e.exports=n,n.prototype.setEnabled=function(e){this.isEnabled=e,this.toggleClassName("disabled",!e)},n.prototype.setFertileIcon=function(e,t){var i=!1;if(e.isNewborn)this.replaceClassNames(["disabled","fertile","pregnant","sterile"],["newborn"]),this.tooltipText=s("ui.mount.filterBorn");else if(e.fecondationTime>=0)this.replaceClassNames(["disabled","fertile","neutered","newborn","sterile"],["pregnant"]),this.tooltipText=s("ui.mount.pregnantSince",e.fecondationTime);else if(e.canReproduce){if(!e.isFecondationReady&&!t)return void this.hide();this.replaceClassNames(["pregnant","neutered","newborn","sterile"],["fertile"]),i=!!t&&!e.isFecondationReady,this.toggleClassName("disabled",i),this.tooltipText=s("ui.mount.fecondable")}else{this.replaceClassNames(["disabled","fertile","pregnant","newborn"],["sterile"]);var n=e.isNeutered;this.toggleClassName("neutered",n),this.tooltipText=s(n?"ui.mount.castrated":"ui.mount.sterilized")}this.show(),this.isEnabled=!i}},function(e,t){},function(e,t,i){function n(e){l.call(this,"div",{className:"SwipingTabs"}),e=e||{},e.className&&this.addClassNames(e.className),this.tabClassName=e.tabClassName||"swipeTabBtn",this.tabList=[],this.tabMap={},this.index=null,this.currentTab=null,this.leftTab=null,this.rightTab=null,this.isCyclingAllowed=!e.noCycling,e.noHeader||(this.header=this.createChild("div",{className:"swipeHeader"})),this.content=this.createChild("div",{className:"swipeContent"}),this.tabContainer=this.content.createChild("div",{className:"tabContainer"}),a(this.content),this.setSwipeDirection(e.direction||"horizontal");var t,i,n,o=this,s=!1;this.tabContainer.on("tweenCancelled",function(){s=!0}),this.content.on("slideStart",function(e,t){s&&(s=!0,o._positionTabs()),i=e[o._axis],n="x"===o._axis?t.width:t.height,o.tabContainer.setStyle("webkitTransition",""),o.currentTab.content.emit("slideStart"),o.emit("slideStart")}),this.content.on("slideCancel",function(){o.currentTab.content.emit("slideEnd"),o.emit("slideEnd"),o.tabContainer.setStyles({webkitTransform:"translate"+o._axis+"(0)",webkitTransition:"-webkit-transform 200ms ease-out"})}),this.content.on("slide",function(e){this.slideOut||(t=i-e[o._axis],(t>0&&!o._canRightSlide||t<0&&!o._canLeftSlide)&&(t=0,i=e[o._axis]),o.tabContainer.setStyle("webkitTransform","translate"+o._axis+"("+-t+"px)"))}),this.content.on("slideEnd",function(e,i,s){o.currentTab.content.emit("slideEnd"),o.emit("slideEnd");var a=Math.abs(t);if(a>n/3||s){var r=o.index;t>0&&o._canRightSlide&&(r=o.rightTab.index),t<0&&o._canLeftSlide&&(r=o.leftTab.index),o._openTabWithTransition(r)}else o.tabContainer.setStyles({webkitTransform:"translate"+o._axis+"(0)",webkitTransition:"-webkit-transform 200ms ease-out"})})}i(564);var o=i(335),s=i(172).inherits,a=i(201),r=i(196),l=i(321);s(n,l),n.prototype.setSwipeDirection=function(e){this._direction=e,this.content.setSlideDirection(e),this._axis="vertical"===e?"y":"x",null!==this.index&&this._positionTabs()},n.prototype.addTab=function(e,t,i){var n=this,s=this.tabList.length;t.addClassNames("swipeTabContent");var a=this.tabMap[i]={id:i,index:this.tabList.length,content:t,position:0,enable:!0};return this.header&&(a.tabBtn=this.header.appendChild(new o({className:this.tabClassName,text:e},function(){n.openTab(s)})),a.tabBtn.addClassNames("tab"+s)),this.tabList.push(a),this.tabContainer.appendChild(t),t.hide(),s},n.prototype.getTabContent=function(e){var t=isNaN(e)?this.tabMap[e]:this.tabList[e];return t&&t.content},n.prototype.swipeNegative=function(){this.leftTab&&this._openTabWithTransition(this.leftTab.index)},n.prototype.swipePositive=function(){this.rightTab&&this._openTabWithTransition(this.rightTab.index)},n.prototype._openTabWithTransition=function(e,t){var i=this.tabList[e],n=this.tabList[this.index];
this.header&&n.tabBtn.delClassNames("on"),n.content.emit("close"),i.content.emit("open",t);var o=this;r.tween(this.tabContainer,{webkitTransform:"translate"+this._axis+"("+-i.position+"%)"},{time:200,easing:"ease-out"},function(){o._positionTabs(),i.content.emit("opened",t),o.emit("openTab",i.id)}),this.index=i.index,this.header&&i.tabBtn.addClassNames("on")},n.prototype.reopen=function(){var e=this.tabList[0];this.index=e.index,this.leftTab=null,this.rightTab=null;for(var t=this._getNextAvailableRightTab(),i=this._getNextAvailableLeftTab(),n=0;n<this.tabList.length;n++){var o=this.tabList[n],s=o===e||o===i||o===t;o.content.toggleDisplay(s)}this._positionTabs()},n.prototype.openTab=function(e,t,i){i=i||{};var n=isNaN(e)?this.tabMap[e]:this.tabList[e];if(n&&(i.forceOpen||this.index!==n.index)){if(null!==this.index){if(n===this.leftTab||n===this.rightTab)return this._openTabWithTransition(n.index,t);var o=this.tabList[this.index];this.header&&o.tabBtn.delClassNames("on"),o.content.emit("close"),o.content.hide()}n.content.emit("open",t),this.index=n.index,this.header&&n.tabBtn.addClassNames("on"),n.content.show(),this._positionTabs(),n.content.emit("opened",t),this.emit("openTab",n.id)}},n.prototype.close=function(){this.tabList[this.index].content.emit("close")},n.prototype._getNextAvailableRightTab=function(){var e,t,i;for(e=this.index+1,t=this.tabList.length;e<t;e+=1)if(i=this.tabList[e],i.enable)return i;if(!this.isCyclingAllowed)return null;for(e=0,t=this.index;e<t;e+=1)if(i=this.tabList[e],i.enable)return i;return null},n.prototype._getNextAvailableLeftTab=function(){var e,t;for(e=this.index-1;e>=0;e-=1)if(t=this.tabList[e],t.enable)return t;if(!this.isCyclingAllowed)return null;for(e=this.tabList.length-1;e>this.index;e-=1)if(t=this.tabList[e],t.enable)return t;return null},n.prototype._positionTabs=function(){var e=this.currentTab=this.tabList[this.index];e.content.setStyle("webkitTransform","translate"+this._axis+"(0)"),e.position=0,this.tabContainer.setStyles({webkitTransform:"translate"+this._axis+"(0)",webkitTransition:""}),this.leftTab&&this.leftTab!==e&&this.leftTab.content.hide(),this.rightTab&&this.rightTab!==e&&this.rightTab.content.hide(),this.leftTab=this.rightTab=null;var t=this._getNextAvailableRightTab(),i=this._getNextAvailableLeftTab();t&&t===i?this.index<i.index?(this._canRightSlide=!0,this._canLeftSlide=!1,this.rightTab=t,t.position=100,t.content.show(),t.content.setStyle("webkitTransform","translate"+this._axis+"(100%)")):(this._canRightSlide=!1,this._canLeftSlide=!0,this.leftTab=i,i.position=-100,i.content.show(),i.content.setStyle("webkitTransform","translate"+this._axis+"(-100%)")):(t?(this._canRightSlide=!0,this.rightTab=t,t.position=100,t.content.show(),t.content.setStyle("webkitTransform","translate"+this._axis+"(100%)")):this._canRightSlide=!1,i?(this._canLeftSlide=!0,this.leftTab=i,i.position=-100,i.content.show(),i.content.setStyle("webkitTransform","translate"+this._axis+"(-100%)")):this._canLeftSlide=!1)},n.prototype.toggleTabAvailability=function(e,t){var i=isNaN(e)?this.tabMap[e]:this.tabList[e];i&&(arguments.length<2&&(console.error(new Error("toggleTabAvailability missing param")),t=!i.enable),t=!!t,t!==i.enable&&(i.enable=t,this.header&&(t?i.tabBtn.enable():i.tabBtn.disable()),null!==this.index&&this._positionTabs()))},n.prototype.toggleTabNotification=function(e,t){var i=isNaN(e)?this.tabMap[e]:this.tabList[e];i&&this.header&&i.tabBtn.toggleClassName("notification",t)},e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this);var e,t,i,n,o,c,d;this.worldMapTooltip=new l,this.once("open",function(){this.header.setText(a("ui.cartography.title"));var s=r.getWindow("worldMap"),l=window.gui.GPS;this.worldMapTooltip.addClassNames("worldMapTooltip"),this.entryList.appendChild(this.worldMapTooltip),this._addSeparator(),e=this._addEntry(a("ui.common.teleport"),function(){window.dofus.sendMessage("AdminQuietCommandMessage",{content:"move * "+d.i+","+d.j}),s.isFullScreen&&r.close("worldMap")}),o=this._addEntry(a("ui.map.flag"),function(){l.addCustomFlag(d.i,d.j)}),c=this._addEntry(a("ui.common.remove"),function(){l.removeCustomFlag(d.i,d.j)}),t=this._addEntry(a("ui.common.remove")+" ["+a("ui.zaap.zaap")+"]",function(){l.removePOI(this.flagId)}),i=this._addEntry(a("ui.common.remove")+" ["+a("ui.common.quests")+"]",function(){l.removePOI(this.flagId)}),n=this._addEntry(a("ui.common.remove")+" ["+a("ui.map.flagDefaultName")+"]",function(){l.removePOI(this.flagId)}),this._addCancel()}),this.on("open",function(s,a){d=s,o.show(),c.hide(),i.hide(),t.hide(),n.hide();var r=s.icons;if(r)for(var l=0,u=r.length;l<u;l+=1){var h=r[l];"customFlag"===h.categoryId?(c.show(),o.hide()):"questObjective"===h.categoryId?(i.flagId=h.id,i.show()):"zaap"===h.categoryId?(t.flagId=h.id,t.show()):"hint"===h.categoryId&&(n.flagId=h.id,n.show())}e.toggleDisplay(window.gui.playerData.isModeratorOrMore()),a()})}i(566);var o=i(172).inherits,s=i(433),a=i(29).getText,r=i(194),l=i(567);o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(e,t){l.call(this,"div",{className:"WorldMapIcon"});var i=e.dimensions,n=Math.min(i.h,30),o=Math.floor(i.w*n/i.h),s=this.createChild("canvas",{className:"icon"});s.rootElement.width=o,s.rootElement.height=n,s.setStyle("minWidth",o+"px");var a=s.rootElement.getContext("2d");a.drawImage(t,i.sx,i.sy,i.sw,i.sh,0,0,o,n),e.infoData.nameIdOverRideFunc?this.createChild("div",{className:"description",text:e.infoData.nameIdOverRideFunc()}):this.createChild("div",{className:"description",text:e.infoData.nameId.replace("\\n ","\n")})}function o(){l.call(this,"div",{className:"WorldMapTooltip"}),this.coordinates=this.createChild("div"),this.subAreaName=this.createChild("div"),this.subArea=this.createChild("div",{className:"subArea"}),this.level=this.subArea.createChild("div"),this.alliance=this.subArea.createChild("div",{className:"alliance"}),this.allianceEmblem=this.alliance.appendChild(new s({width:28,height:28})),this.allianceName=this.alliance.createChild("div"),this.icons=this.createChild("div",{className:"icons"})}var s=i(422),a=i(29).getText,r=i(172).inherits,l=i(321);r(n,l),r(o,l),e.exports=o,o.prototype.setCoordinates=function(e,t){this.coordinates.setText(a("ui.common.coordinatesSmall")+" "+e+","+t)},o.prototype.displayIcons=function(){this.icons.show(),this.subArea.hide()},o.prototype.setIcons=function(e,t){this._icons=e,this.icons.clearContent();for(var i=0,o=e.length;i<o;i+=1)this.icons.appendChild(new n(e[i],t))},o.prototype.unsetAlliance=function(){this.alliance.hide()},o.prototype.setAlliance=function(e){this.allianceName.setText(e.allianceName+" ["+e.allianceTag+"]"),this.allianceEmblem.setValue(e.allianceEmblem,!0),this.alliance.show()},o.prototype.unsetSubArea=function(){this.subAreaName.hide()},o.prototype.displayCoordinates=function(){this.subAreaName.hide(),this.icons.hide(),this.subArea.hide()},o.prototype.setSubArea=function(e){this.subAreaName.setText(e.nameId),this.level.setText(a("ui.common.averageLevel")+" "+e.level),this.subAreaName.show()},o.prototype.displaySubArea=function(){this.icons.hide(),this.subArea.show()}},function(e,t,i){function n(){s.call(this),this.once("open",function(){this.buttonsContainer=this.entryList.createChild("div"),this._addCancel()}),this.on("open",function(e,t){this._update(e),t()})}var o=i(172).inherits,s=i(433),a=i(335),r=i(29).getText;o(n,s),e.exports=n,n.prototype._update=function(e){var t=this;e=e||{};var i=e.id,n=e.name,o=e.cellId,s=r("ui.humanVendor.playerShop",n);this.header.setText(s),this.buttonsContainer.clearContent(),this.buyButton=this.buttonsContainer.appendChild(new a({text:r("ui.common.buy"),className:"cmButton"},function(){window.dofus.sendMessage("ExchangeOnHumanVendorRequestMessage",{humanVendorId:i,humanVendorCell:o}),window.gui.closeContextualMenu(),t.emit("close")}));var l=window.gui.playerData,c=l.adminMenu.getAdminMenuId();l.isModeratorOrMore()&&null!==c&&(this.adminButton=this.buttonsContainer.appendChild(new a({text:"Admin",className:"cmButton"},function(){window.gui.closeContextualMenu(),window.gui.openContextualMenuAround("admin",this,e),t.emit("close")})))}},function(e,t,i){function n(){var e=this;s.call(this,{className:"ContextualMenuMonster"}),this.monsterId=null,this.attack=null,this.once("open",function(){this._setupDom()}),this.on("open",function(t,i){this.monsterId=t.contextualId,this.starCounter.setValue(t.ageBonus),this.monstersList.clearContent();var n,o=this.monstersList.createChild("div",{className:"willFightContainer"}),s=this.monstersList.createChild("div",{className:"willNotFightContainer"}),a=[t.staticInfos.mainCreatureLightInfos].concat(t.staticInfos.underlings),l=t.staticInfos.alternatives,c=null,d=[];if(l){for(var u=window.gui.playerData.partyData.getClassicalParty(),h=u?u.getMemberCount():1,p=0;l[p]&&l[p].playerCount<=h;)c=l[p],p+=1;for(n=0;n<c.monsters.length;n+=1)d.push(c.monsters[n].creatureGenericId)}var m=a.sort(function(e,t){return t.staticInfos.level-e.staticInfos.level}),f=0;for(n=0;n<m.length;n+=1){var g=m[n],_=g.staticInfos,v=g.creatureGenericId,y=!0;if(l){y=!1;var b=d.indexOf(v);b!==-1&&(y=!0,d.splice(b,1))}y&&(f+=_.level);var M=_.nameId+" ("+_.level+")",w=y?o:s,T=_.isMiniBoss?["monsterName","miniBoss"]:"monsterName";w.createChild("div",{className:T,text:M})}e.level.setText(r("ui.common.rank",f)),e.attack.setEnable(!window.gui.playerData.getRestrictions().cantAttackMonster),i()})}i(570);var o=i(172).inherits,s=i(433),a=i(417),r=i(29).getText;o(n,s),e.exports=n,n.prototype._setupDom=function(){var e=this,t=this.header.createChild("div",{className:"monsterInfosContainer"});this.level=t.createChild("div",{className:"level"}),this.starCounter=t.appendChild(new a),this.starCounter.on("shopOpened",function(){e.close()}),this.xp=t.createChild("div",{className:"xp"}),this.monstersList=this.entryList.createChild("div",{className:"monstersList"}),this.attack=this._addEntry(r("ui.common.attack"),function(){e.monsterId&&window.isoEngine.attackActor(e.monsterId),e.close()}),this._addCancel()}},function(e,t){},function(e,t,i){function n(e,t,i,n){switch(n){case 2:case 4:case 8:l.getWindow("tradeWithNPC").prepareExchange(e.nameId);break;case 3:window.gui.npcDialogHandler.prepareDialog(e)}if(window.foreground.lock("npcActionRequest"),window.dofus.sendMessage("NpcGenericActionRequestMessage",{npcId:t,npcActionId:n,npcMapId:i}),9===n||10===n){var o=window.foreground,s=window.gui,a=9===n?"HouseToSellListMessage":"PaddockToSellListMessage",r=setTimeout(function(){console.error(new Error(a+" not received: timeout triggered to unlock the character")),o.unlock("npcActionRequest"),s.removeListener(a,c)},5e3),c=function(){o.unlock("npcActionRequest"),clearTimeout(r)};window.gui.once(a,c)}}function o(){a.call(this);var e=this;this.once("open",function(){this._setupDom()}),this.on("open",function(t,i){function o(){n(s,a,l,this.npcActionId),e.close()}var s=t.npcData,a=t.actorId,l=t.mapId;this.header.setText(s.nameId),this.actionsContainer.clearContent();for(var c=window.gui.playerData.isAlive(),d=0,u=s.actions.length;d<u;d++){var h=this.actionsContainer.appendChild(new r({text:s.actionsName[d],className:"cmButton",disable:!c},o));h.npcActionId=s.actions[d]}i()})}var s=i(172).inherits,a=i(433),r=i(335),l=i(194);s(o,a),e.exports=o,o.npcActionRequest=n,o.prototype._setupDom=function(){var e=this.entryList.createChild("div");this.actionsContainer=e.createChild("div"),this._addCancel()}},function(e,t,i){function n(){o.call(this);var e;this.once("open",function(){e=this.header.appendChild(new s);var t=this._addEntry(a("ui.common.ankaboxMessage"),function(){});t.disable(),this._addCancel()}),this.on("open",function(t,i){if(void 0===t.hoursSinceLastConnection)e.setContent({name:t.playerName});else{var n=Math.floor(t.hoursSinceLastConnection),o=Math.floor(n/720),s=Math.floor((n-720*o)/24),r="";r=o>0?s>0?a("ui.social.monthsAndDaysSinceLastConnection",o,s):a("ui.social.monthsSinceLastConnection",o):s>0?a("ui.social.daysSinceLastConnection",s):n>0?a("tablet.ui.social.hoursSinceLastConnection",n):a("tablet.ui.social.lessThanOneHour"),e.setContent({name:t.playerName+"\n"+a("ui.social.lastConnection",r)})}i()})}var o=i(433),s=i(444),a=i(29).getText,r=i(172).inherits;r(n,o),e.exports=n},function(e,t,i){function n(){s.call(this);var e=this;this.data=null,this.on("open",function(e,t){this.data=e,this.header.setText(e.paddockObjectName),t()}),this.once("open",function(){this._addEntry(a("ui.common.remove"),function(){window.dofus.sendMessage("PaddockRemoveItemRequestMessage",{cellId:e.data.cellId})}),this._addCancel()})}var o=i(172).inherits,s=i(433),a=i(29).getText;o(n,s),e.exports=n},function(e,t,i){function n(){s.call(this),this.partyId=!1,this.isLoyal=!1,this.once("open",function(){this._setupDom()}),this.on("open",function(e,t){this.partyId=e.partyId,this.isLoyal=e.isLoyal,this.loyalMsg.toggleClassName("ticked",e.isLoyal),e.partyType===r.PARTY_TYPE_ARENA?this.restrictedMsg.hide():(this.restrictedMsg.show(),this.restrictedMsg.setEnable(e.isLeader),this.restrictedMsg.toggleClassName("ticked",e.isRestricted)),t()})}var o=i(172).inherits,s=i(433),a=i(29).getText,r=i(575),l=i(349);o(n,s),e.exports=n,n.prototype._setupDom=function(){var e=this;this.header.setText(a("ui.common.options")),this.restrictedMsg=this._addEntry(a("ui.party.lockFight"),function(){window.dofus.sendMessage("GameFightOptionToggleMessage",{option:l.FIGHT_OPTION_SET_TO_PARTY_ONLY})}),this.loyalMsg=this._addEntry(a("ui.party.refuseOtherInvitations"),function(){window.dofus.sendMessage("PartyPledgeLoyaltyRequestMessage",{partyId:e.partyId,loyal:!e.isLoyal})}),this._addCancel()}},function(e,t){e.exports={PARTY_TYPE_UNDEFINED:0,PARTY_TYPE_CLASSICAL:1,PARTY_TYPE_DUNGEON:2,PARTY_TYPE_ARENA:3}},function(e,t,i){function n(){a.call(this);var e,t;this.once("open",function(){var i=this,n=this.header.appendChild(new o);e=this.entryList.appendChild(new r(n)),e.on("close",function(){i.close()}),t=this.entryList.appendChild(new l(n)),t.on("close",function(){i.close()}),this._addCancel()}),this.on("open",function(i,n){var o=i.playerId===window.gui.playerData.id;o?t.updateContent(i):e.updateContent(i),t.toggleDisplay(o),e.toggleDisplay(!o),n()})}var o=i(444),s=i(172).inherits,a=i(433),r=i(577),l=i(579);s(n,a),e.exports=n},function(e,t,i){function n(e){C.call(this,"div",{className:"ContextualMenuPlayerContent"});var t=this.createChild("div");this.banner=e,this._setupGroup1(t),this._setupGroup2(t),this._setupGroup3(t),this._setupGroup4(t),this._setupGroup5(t),this._setupGroup6(t),this._setupAdmin(t)}function o(e){return e===T.AvA_ENABLED_AGGRESSABLE||e===T.AvA_PREQUALIFIED_AGGRESSABLE}function s(e){return e?0!==(e.capabilities&R):(console.warn("isAggressionAllowedOnMap called before we know mapPosition"),!1)}function a(e,t,i){var n=window.gui.playerData;if(!s(n.position.mapPosition))return L;if(n.isMutant())return n.getRestrictions().cantAttack||i?O:D;if(i)return D;var a=1===window.gui.serversData.settings.serverGameType,r=n.alliance.current,l=S.entities.prism[n.position.subAreaId],c=l&&l.prism,d=c&&c.mapId!==-1,u=n.characters.mainCharacter.characteristics.alignmentInfos,p=o(u.aggressable),m=!1;if(d){var f=c.state===w.PRISM_STATE_VULNERABLE;if(a){if(r&&!p&&(c.alliance.allianceId!==r.allianceId||u.aggressable!==T.AvA_ENABLED_NON_AGGRESSABLE))return L}else if(f){if(r&&(!p||!t))return L}else m=!0;if(!m){if(!r)return L;if(t&&(a||f)){if(t.aggressable===T.AvA_DISQUALIFIED)return O;if(!o(t.aggressable)||r.allianceId===t.allianceInformations.allianceId||a&&c.alliance.allianceId===t.allianceInformations.allianceId&&!f)return L}}g=!0}if(a){if(!d){if(r&&t){if(r.allianceId===t.allianceInformations.allianceId||!p||!o(t.aggressable))return L}else if(!r||p)return L;g=!0}}else if(!d||m){if(!u||!e||u.aggressable!==T.PvP_ENABLED_AGGRESSABLE||e.alignmentSide<=I.ALIGNMENT_NEUTRAL||0===e.alignmentGrade||u.alignmentSide!==I.ALIGNMENT_MERCENARY&&u.alignmentSide===e.alignmentSide||u.alignmentSide===I.ALIGNMENT_NEUTRAL)return L;g=!1}var _=n.characterBaseInformations.level;if(a&&_<50)return O;var v=g?100:50;return _+v<e.characterPower-h?L:D}var r,l,c,d,u,h,p,m,f,g,_=i(172).inherits,v=i(29).getText,y=i(335),b=i(478).GuildRightsBitEnum,M=i(578),w=i(485),T=i(474),C=i(321),A=i(194),I=i(425),S=i(475),E=i(258),x=i(347).FIGHT_STATES,N=!1,L=-1,O=0,D=1,R=2;_(n,C),e.exports=n,n.prototype.updateContent=function(e){function t(e){switch(e._type){case"HumanOptionAlliance":s=e;break;case"HumanOptionGuild":o=e.guildInformations}}f=e.interactiveElements,u=e.accountId,h=e.playerId,p=e.playerName,m=e.cellId;var i=e.humanoidInfoOptions,n=e.alignmentInfos;this.admin.hide();var o=null,s=null;if(this.targetPlayer={id:h,name:p},i)for(var a=0,g=i.length;a<g;a+=1)t(i[a]);var _={name:p,guild:o};null!==s&&(_.alliance=s.allianceInformations),this.banner.setContent(_);var v=window.gui.playerData.partyData;r=v.getClassicalParty(),l=v.getArenaParty(),c=r?r.getPartyId():null,d=l?l.getPartyId():null,this.toggleButtonsAvailability(e,n,o,s);var y=window.gui.playerData.adminMenu.getAdminMenuId();window.gui.playerData.isModeratorOrMore()&&null!==y&&this.admin.show()},n.prototype.hideButtons=function(){this.kickFighter.hide(),this.challenge.hide(),this.assault.hide(),this.exchangeProp.hide(),this.inviteParty.hide(),this.inviteArena.hide(),this.inviteGuild.hide(),this.inviteAlliance.hide(),this.addFriend.hide(),this.addEnemy.hide(),this.ignoreSession.hide(),this.stopIgnoreSession.hide(),this.partyTitle.hide(),this.follow.hide(),this.stopFollowing.hide(),this.kickPlayer.hide(),this.appointLeader.hide(),this.kickArenaPlayer.hide(),this.appointArenaLeader.hide(),this.allFollow.hide(),this.allStopFollow.hide(),this.cancelPartyInvitation.hide(),this.leaveParty.hide(),this.arenaTitle.hide(),this.cancelArenaInvitation.hide(),this.leaveArena.hide(),this.kickOutFromHome.hide(),this.guildInformations.hide(),this.allianceInformations.hide()},n.prototype.toggleButtonsAvailability=function(e,t,i,n){e=e||{};var o=window.gui.playerData,s=o.partyData,c=o.jobs,d=o.socialData,p=!o.isAlive(),m=e.isMutant;if(this.hideButtons(),window.gui.fightManager.fightState===x.PREPARATION&&o.isFightLeader&&o.id!==h&&this.kickFighter.show(),r&&r.getGuest(h)?(this.partyTitle.show(),this.cancelPartyInvitation.show()):r&&r.getMember(h)||this.inviteParty.show(),l&&l.getGuest(h)?(this.arenaTitle.show(),this.cancelArenaInvitation.show()):l&&l.getMember(h)||this.inviteArena.show(),u&&(d.friendsList[u]||d.enemiesList[u])||(this.addFriend.show(),this.addEnemy.show()),d.isIgnored(u)?this.stopIgnoreSession.show():this.ignoreSession.show(),r&&r.getMember(h)&&(this.partyTitle.show(),s.getFollowedCharacterId()===h?this.stopFollowing.show():this.follow.show(),r.getLeaderId()===o.id&&(this.kickPlayer.show(),this.appointLeader.show(),N?this.allStopFollow.show():this.allFollow.show())),this.kickOutFromHome.toggleDisplay(!!window.gui.playerData.position.isInMyHouse),l&&l.getMember(h)&&l.getLeaderId()===o.id&&(this.arenaTitle.show(),this.kickArenaPlayer.show(),this.appointArenaLeader.show()),this.join.toggleDisplay(E.isRoleplayMode&&o.position.isInIncarnam()),E.isRoleplayMode){var f=o.getRestrictions();if(f.cantExchange||(p?this.exchangeProp.disable():this.exchangeProp.enable(),this.exchangeProp.show()),t){f.cantChallenge||(p?this.challenge.disable():this.challenge.enable(),this.challenge.show());var g=a(t,n,m,h);g!==O&&g!==D||(g===O||p?this.assault.disable():this.assault.enable(),this.assault.show())}}var _=o.guild;!e.hasGuild&&!i&&_.current&&_.hasRight(b.GUILD_RIGHT_INVITE_NEW_MEMBERS)&&this.inviteGuild.show();var v=o.alliance;!e.hasGuild&&h&&i&&!n&&v.current&&v.isBoss()&&this.inviteAlliance.show(),i&&(this.guildId=i.guildId,this.guildInformations.show()),n&&(this.allianceId=n.allianceInformations.allianceId,this.allianceInformations.show()),this._updateMultiCraftMenu(o,c)},n.prototype._setupGroup1=function(e){var t=this,i=e.createChild("div",{className:"group"});this.kickFighter=i.appendChild(new y({text:v("ui.fight.kick"),className:"cmButton"},function(){window.dofus.sendMessage("GameContextKickMessage",{targetId:h}),t.emit("close")}))},n.prototype._setupGroup2=function(e){var t=this,i=e.createChild("div",{className:"group"});this.privateMessage=i.appendChild(new y({text:v("ui.common.wisperMessage"),className:"cmButton"},function(){window.gui.chat.startPrivateMessage(p),t.emit("close")})),i.appendChild(new y({text:v("ui.common.ankaboxMessage"),className:["cmButton","disabled"]},function(){})),this.challenge=i.appendChild(new y({text:v("ui.common.challenge"),className:"cmButton"},function(){window.gui.playerData.fightRequests.requestChallenge({targetId:h,targetName:p,targetCellId:m}),t.emit("close")})),this.assault=i.appendChild(new y({text:v("ui.pvp.assault"),className:"cmButton"},function(){window.gui.playerData.fightRequests.requestAssault({targetId:h,targetName:p,targetCellId:m},g),t.emit("close")})),this.join=i.appendChild(new y({text:v("ui.common.join"),className:"cmButton"},function(){window.dofus.sendMessage("FriendJoinRequestMessage",{name:p}),t.emit("close")})),this.kickOutFromHome=i.appendChild(new y({text:v("ui.common.kickOff"),className:"cmButton"},function(){window.dofus.sendMessage("HouseKickRequestMessage",{id:h}),t.emit("close")})),i.appendChild(new y({text:v("ui.common.informations"),className:["cmButton"]},function(){window.dofus.sendMessage("BasicWhoIsRequestMessage",{search:p,verbose:!0}),t.emit("close")})),this.guildInformations=i.appendChild(new y({text:v("ui.guild.guildInformations"),className:"cmButton"},function(){window.dofus.sendMessage("GuildFactsRequestMessage",{guildId:t.guildId}),t.emit("close")})),this.allianceInformations=i.appendChild(new y({text:v("ui.alliance.allianceInformations"),className:"cmButton"},function(){window.dofus.sendMessage("AllianceFactsRequestMessage",{allianceId:t.allianceId}),t.emit("close")}))},n.prototype._setupGroup3=function(e){var t=this,i=e.createChild("div",{className:"group"});this.exchangeProp=i.appendChild(new y({text:v("ui.common.exchangeProp"),className:"cmButton"},function(){t.emit("close"),A.getWindow("tradeWithPlayer").prepareMakeExchange({targetId:h,targetName:p}),window.dofus.sendMessage("ExchangePlayerRequestMessage",{exchangeType:1,target:h})})),this.inviteParty=i.appendChild(new y({text:v("ui.party.addToParty"),className:"cmButton"},function(){window.dofus.sendMessage("PartyInvitationRequestMessage",{name:p}),t.emit("close")})),this.inviteArena=i.appendChild(new y({text:v("ui.party.addToArena"),className:"cmButton"},function(){window.dofus.sendMessage("PartyInvitationArenaRequestMessage",{name:p}),t.emit("close")})),this.inviteGuild=i.appendChild(new y({text:v("ui.social.inviteInGuild"),className:"cmButton"},function(){h?window.dofus.sendMessage("GuildInvitationMessage",{targetId:h}):window.dofus.sendMessage("GuildInvitationByNameMessage",{name:p}),t.emit("close")})),this.inviteAlliance=i.appendChild(new y({text:v("ui.social.inviteInAlliance"),className:"cmButton"},function(){window.dofus.sendMessage("AllianceInvitationMessage",{targetId:h}),t.emit("close")})),this._multiCraftMenu=i.createChild("div",{className:"multiCraftMenu"})},n.prototype._setupGroup4=function(e){var t=this,i=e.createChild("div");this.addFriend=i.appendChild(new y({text:v("ui.social.addToFriends"),className:"cmButton"},function(){t.emit("close"),window.gui.openConfirmPopup({title:v("ui.popup.warning"),message:v("ui.social.confirmAddFriend",p),cb:function(e){e&&window.dofus.sendMessage("FriendAddRequestMessage",{name:p})}})})),this.addEnemy=i.appendChild(new y({text:v("ui.social.addToEnemy"),className:"cmButton"},function(){t.emit("close"),window.gui.openConfirmPopup({title:v("ui.popup.warning"),message:v("ui.social.confirmAddEnemy",p),cb:function(e){e&&window.dofus.sendMessage("IgnoredAddRequestMessage",{name:p,session:!1})}})})),this.ignoreSession=i.appendChild(new y({text:v("ui.social.blackListTemporarly"),className:"cmButton"},function(){window.dofus.sendMessage("IgnoredAddRequestMessage",{name:p,session:!0}),t.emit("close")})),this.stopIgnoreSession=i.appendChild(new y({text:v("ui.social.blackListRemove"),className:"cmButton"},function(){window.dofus.sendMessage("IgnoredDeleteRequestMessage",{accountId:u,session:!0}),t.emit("close")}))},n.prototype._setupGroup5=function(e){var t=this,i=e.createChild("div");this.partyTitle=i.createChild("div",{text:v("ui.common.party"),className:"title"}),this.follow=i.appendChild(new y({text:v("ui.common.follow"),className:"cmButton"},function(){window.dofus.sendMessage("PartyFollowMemberRequestMessage",{partyId:c,playerId:h}),t.emit("close")})),this.stopFollowing=i.appendChild(new y({text:v("ui.party.stopFollowing"),className:"cmButton"},function(){window.dofus.sendMessage("PartyStopFollowRequestMessage",{partyId:c}),t.emit("close")})),this.kickPlayer=i.appendChild(new y({text:v("ui.party.kickPlayer"),className:"cmButton"},function(){window.dofus.sendMessage("PartyKickRequestMessage",{partyId:c,playerId:h}),t.emit("close")})),this.appointLeader=i.appendChild(new y({text:v("ui.party.promotePartyLeader"),className:"cmButton"},function(){window.dofus.sendMessage("PartyAbdicateThroneMessage",{partyId:c,playerId:h}),t.emit("close")})),this.allFollow=i.appendChild(new y({text:v("ui.party.followHimAll"),className:"cmButton"},function(){window.dofus.sendMessage("PartyFollowThisMemberRequestMessage",{partyId:c,playerId:h,enabled:!0}),N=!0,t.emit("close")})),this.allStopFollow=i.appendChild(new y({text:v("ui.party.stopAllFollowingHim"),className:"cmButton"},function(){window.dofus.sendMessage("PartyFollowThisMemberRequestMessage",{partyId:c,playerId:h,enabled:!1}),N=!1,t.emit("close")})),this.cancelPartyInvitation=i.appendChild(new y({text:v("ui.party.cancelInvitation"),className:"cmButton"},function(){window.dofus.sendMessage("PartyCancelInvitationMessage",{partyId:c,guestId:h}),t.emit("close")})),this.leaveParty=i.appendChild(new y({text:v("ui.party.leaveParty"),className:"cmButton"},function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:c}),t.emit("close")}))},n.prototype._setupGroup6=function(e){var t=this,i=e.createChild("div",{className:"group"});this.arenaTitle=i.createChild("div",{text:v("ui.common.koliseum"),className:"title"}),this.cancelArenaInvitation=i.appendChild(new y({text:v("ui.party.cancelInvitation"),className:"cmButton"},function(){window.dofus.sendMessage("PartyCancelInvitationMessage",{partyId:d,guestId:h}),t.emit("close")})),this.kickArenaPlayer=i.appendChild(new y({text:v("ui.party.kickPlayer"),className:"cmButton"},function(){window.dofus.sendMessage("PartyKickRequestMessage",{partyId:d,playerId:h}),t.emit("close")})),this.appointArenaLeader=i.appendChild(new y({text:v("ui.party.promotePartyLeader"),className:"cmButton"},function(){window.dofus.sendMessage("PartyAbdicateThroneMessage",{partyId:d,playerId:h}),t.emit("close")})),this.leaveArena=i.appendChild(new y({text:v("ui.party.arenaQuit"),className:"cmButton"},function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:d}),t.emit("close")}))},n.prototype._updateMultiCraftMenu=function(e,t){function i(e,t,i){var o=n.appendChild(new y({text:e,className:"cmButton"},function(){window.dofus.sendMessage("ExchangePlayerMultiCraftRequestMessage",{exchangeType:t,target:h,skillId:i}),s.emit("close")}));r?o.disable():o.enable()}var n=this._multiCraftMenu;if(n.clearContent(),!E.isFightMode){var o,s=this,a=e.id,r=!e.isAlive(),l=t.getUsableSkillsInMap(a,f),c=v("ui.common.inviteTo");for(var d in l){var u=l[d];o=c+" "+u.nameId,i(o,M.MULTICRAFT_CRAFTER,u.id)}var p=t.getUsableSkillsInMap(h,f),m=v("ui.common.askTo");for(var g in p){var _=p[g];o=m+" "+_.nameId,i(o,M.MULTICRAFT_CUSTOMER,_.id)}}},n.prototype._setupAdmin=function(e){var t=this;t.admin=e.appendChild(new y({text:"Admin",className:"cmButton"},function(){window.gui.closeContextualMenu(),window.gui.openContextualMenuAround("admin",t.admin,t.targetPlayer),t.emit("close")}))}},function(e,t){e.exports={NPC_SHOP:0,PLAYER_TRADE:1,NPC_TRADE:2,CRAFT:3,DISCONNECTED_VENDOR:4,STORAGE:5,SHOP_STOCK:6,TAXCOLLECTOR:8,NPC_MODIFY_TRADE:9,BIDHOUSE_SELL:10,BIDHOUSE_BUY:11,MULTICRAFT_CRAFTER:12,MULTICRAFT_CUSTOMER:13,JOB_INDEX:14,MOUNT:15,MOUNT_STABLE:16,NPC_RESURECT_PET:17,NPC_TRADE_MOUNT:18,REALESTATE_HOUSE:19,REALESTATE_FARM:20}},function(e,t,i){function n(e){d.call(this,"div",{className:"ContextualMenuUserContent"}),this.banner=e,this._createDom()}var o,s,a,r=i(172).inherits,l=i(29).getText,c=i(335),d=i(321),u=i(580),h=i(258);r(n,d),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.createChild("div"),i=window.gui.playerData;this.freeSoul=t.appendChild(new c({text:l("ui.common.freeSoul"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("GameRolePlayFreeSoulRequestMessage"),e.emit("close")})),this.slapHimself=t.appendChild(new c({text:l("ui.dialog.slapHimself"),className:"cmButton"},function(){window.dofus.sendMessage("ChatClientMultiMessage",{content:l("ui.dialog.slapSentence"),channel:0}),e.emit("close")})),this.organizeShop=t.appendChild(new c({text:l("ui.humanVendor.organizeShop"),className:"cmButton"},function(){window.dofus.sendMessage("ExchangeRequestOnShopStockMessage"),e.emit("close")})),this.switchToMerchantMode=t.appendChild(new c({text:l("ui.humanVendor.switchToMerchantMode"),className:"cmButton"},function(){window.dofus.sendMessage("ExchangeShowVendorTaxMessage"),e.emit("close")})),this.orientCharacter=t.appendChild(new c({text:l("ui.orientCharacter"),className:["cmButton","disabled"]},function(){})),this.partyTitle=t.createChild("div",{text:l("ui.common.party"),className:"title",hidden:!0}),this.leaveParty=t.appendChild(new c({text:l("ui.party.leaveParty"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:o}),e.emit("close")})),this.followMe=t.appendChild(new c({text:l("ui.party.followMeAll"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("PartyFollowThisMemberRequestMessage",{partyId:o,playerId:i.id,enabled:!0}),a=!0,e.emit("close")})),this.stopFollowMe=t.appendChild(new c({text:l("ui.party.stopAllFollowingMe"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("PartyFollowThisMemberRequestMessage",{partyId:o,playerId:i.id,enabled:!1}),a=!1,e.emit("close")}));var n=t.createChild("div",{className:"group"});this.arenaTitle=n.createChild("div",{text:l("ui.common.koliseum"),className:"title",hidden:!0}),this.leaveArena=n.appendChild(new c({text:l("ui.party.arenaQuit"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:s}),e.emit("close")})),this.fightReady=t.appendChild(new c({text:l("ui.banner.ready"),className:"cmButton"},function(){window.gui.timeline.fightControlButtons.toggleReadyForFight(),e.emit("close")})),this.admin=t.appendChild(new c({text:"Admin",className:"cmButton"},function(){var t={id:i.id,name:i.characterBaseInformations.name};window.gui.closeContextualMenu(),window.gui.openContextualMenuAround("admin",e.admin,t),e.emit("close")}))},n.prototype.updateContent=function(){var e=window.gui.playerData,t=e.partyData.getClassicalParty(),i=e.partyData.getArenaParty();if(this.banner.setContent({name:e.characterBaseInformations.name}),o=t?t.getPartyId():null,s=i?i.getPartyId():null,this.freeSoul.hide(),this.slapHimself.hide(),this.organizeShop.hide(),this.switchToMerchantMode.hide(),this.orientCharacter.hide(),this.partyTitle.hide(),this.leaveParty.hide(),this.arenaTitle.hide(),this.leaveArena.hide(),this.followMe.hide(),this.stopFollowMe.hide(),this.fightReady.hide(),this.admin.hide(),e.state===u.STATUS_TOMBSTONE?this.freeSoul.show():h.isRoleplayMode&&(this.slapHimself.show(),window.gui.uiLocker.isFeatureAvailable("myShop")&&(this.organizeShop.show(),this.switchToMerchantMode.show()),this.orientCharacter.show()),o&&(this.partyTitle.show(),this.leaveParty.show(),t.getLeaderId()===e.id)){if(a)return this.followMe.hide(),void this.stopFollowMe.show();this.followMe.show(),this.stopFollowMe.hide()}s&&(this.arenaTitle.show(),this.leaveArena.show()),
window.gui.timeline.fightControlButtons.isReadyForFightButtonVisible()&&this.fightReady.show();var n=e.adminMenu.getAdminMenuId();e.isModeratorOrMore()&&null!==n&&this.admin.show()}},function(e,t){e.exports={STATUS_ALIVE_AND_KICKING:0,STATUS_TOMBSTONE:1,STATUS_PHANTOM:2}},function(e,t,i){function n(){function e(){i&&(i.unset(),i.delClassNames("unavailable")),r="remove"}function t(){window.dofus.sendMessage("InventoryPresetUseMessage",{presetId:n}),r="equip"}s.call(this,{noHeader:!0});var i,n,o,r,l={};this.once("open",function(){l.equipSet=this._addEntry(a("ui.common.equip"),t),l.remove=this._addEntry(a("ui.common.remove"),e),this._addCancel()}),this.on("open",function(e,t){e=e||{},i=e.slot,o=e.onClose,n=e.presetId,r="",l.remove.toggleDisplay(!!e.canRemove),l.equipSet.toggleDisplay(!!e.hasOwnProperty("presetId")),t()}),this.on("close",function(){o&&o(r)})}var o=i(172).inherits,s=i(433),a=i(29).getText;o(n,s),e.exports=n},function(e,t,i){function n(){s.call(this);var e,t,i,n,c,p,m,f;this.once("open",function(){e=this.header.appendChild(new a),this._addEntry(r("ui.common.talk"),function(){m.prepareDialog(c.npcData),window.dofus.sendMessage("NpcGenericActionRequestMessage",{npcId:c.contextualId,npcActionId:3,npcMapId:window.gui.playerData.position.mapId})}),p=this._addEntry(r("ui.common.teleport"),function(){window.dofus.sendMessage("PrismUseRequestMessage")}),i=this._addEntry(r("ui.common.attack"),function(){window.dofus.sendMessage("PrismAttackRequestMessage")}),n=this._addEntry(r("ui.common.modify"),function(){h.open("social",{tabId:"alliance",tabParams:{tabId:"conquests"}})}),this._addCancel(),window.gui.on("AlliancePrismDialogQuestionMessage",function(){var e=new u(t.nextVulnerabilityDate).getServerDate().toString(),i=[f,o.prismState[t.state],e.date+" "+e.time,0];m.nextQuestionAsync(15428,[],i)})}),this.on("open",function(o,s){c=o,m=window.gui.npcDialogHandler;var a,r=window.gui.playerData;t=o.prism,"AlliancePrismInformation"===t._type?(a=o.prism.alliance,f=a.allianceName,e.setContent({alliance:a}),r.alliance.hasAlliance()&&r.alliance.current.allianceId===a.allianceId?(i.hide(),n.toggleDisplay(r.guild.hasRight(l.GUILD_RIGHT_SET_ALLIANCE_PRISM))):(i.show(),r.isAlive()&&t.state===d.PRISM_STATE_NORMAL?i.enable():i.disable(),n.hide()),p.hide()):(a=window.gui.playerData.alliance.current,f=a.allianceName,e.setContent({alliance:a}),i.hide(),p.toggleDisplay(t.hasTeleporterModule),r.guild.hasRight(l.GUILD_RIGHT_SET_ALLIANCE_PRISM)?n.show():n.hide()),s()})}var o=i(583),s=i(433),a=i(444),r=i(29).getText,l=i(478).GuildRightsBitEnum,c=i(172).inherits,d=i(485),u=i(28).DofusDate,h=i(194);c(n,s),e.exports=n},function(e,t,i){var n=i(584),o=i(29).getText,s=i(481),a=i(194);t.alliances={},t.createAlliance=function(e){var i=new n(e);return t.alliances[i.allianceId]=i,i},t.initialize=function(e){e.on("disconnect",function(){t.alliances={}}),e.on("PrismSettingsErrorMessage",function(){e.chat.logMsg(o("ui.error.cantModifiedPrismVulnerabiltyHour"))}),e.on("AllianceCreationResultMessage",function(e){switch(e.result){case s.SOCIAL_GROUP_CREATE_ERROR_ALREADY_IN_GROUP:return window.gui.openSimplePopup(o("ui.alliance.alreadyInAlliance"));case s.SOCIAL_GROUP_CREATE_OK:return a.close("socialGroupCreation");case s.SOCIAL_GROUP_CREATE_ERROR_NAME_ALREADY_EXISTS:return window.gui.openSimplePopup(o("ui.alliance.alreadyUseName"));case s.SOCIAL_GROUP_CREATE_ERROR_NAME_INVALID:return window.gui.openSimplePopup(o("ui.alliance.invalidName"));case s.SOCIAL_GROUP_CREATE_ERROR_TAG_ALREADY_EXISTS:return window.gui.openSimplePopup(o("ui.alliance.alreadyUseTag"));case s.SOCIAL_GROUP_CREATE_ERROR_TAG_INVALID:return window.gui.openSimplePopup(o("ui.alliance.invalidTag"));case s.SOCIAL_GROUP_CREATE_ERROR_EMBLEM_ALREADY_EXISTS:return window.gui.openSimplePopup(o("ui.guild.AlreadyUseEmblem"));case s.SOCIAL_GROUP_CREATE_ERROR_REQUIREMENT_UNMET:return window.gui.openSimplePopup(o("ui.guild.requirementUnmet"));case s.SOCIAL_GROUP_CREATE_ERROR_EMBLEM_INVALID:case s.SOCIAL_GROUP_CREATE_ERROR_UNKNOWN:return window.gui.openSimplePopup(o("ui.common.unknownFail"))}}),e.on("AllianceFactsMessage",function(e){a.getWindow("allianceCard").display(e)}),e.on("AllianceFactsErrorMessage",function(){e.chat.logMsg(o("ui.alliance.doesntExistAnymore"))}),t.prismState={0:o("ui.prism.state0"),1:o("ui.prism.state1"),2:o("ui.prism.state2"),3:o("ui.prism.state3"),4:o("ui.prism.state4"),5:o("ui.prism.state5"),6:o("ui.prism.state6")},t.getPrismStateInfo=function(e,t){switch(e){case 0:return o("ui.prism.stateInfos0");case 1:return o("ui.prism.stateInfos1");case 2:return o("ui.prism.stateInfos2");case 3:return o("ui.prism.stateInfos3");case 4:return o("ui.prism.stateInfos4",t);case 5:return o("ui.prism.stateInfos5");case 6:return o("ui.prism.stateInfos6")}}},t.openAllianceCard=function(e){window.dofus.sendMessage("AllianceFactsRequestMessage",{allianceId:e})}},function(e,t,i){function n(e){c.call(this),this.enabled=!1,this.allianceId=0,this.allianceTag="",this.allianceName="",this.creationDate=0,this.allianceEmblem=new l,this.nbMembers=0,this.prisms=[],this.guilds=[],this.guildCount=0,this.setInfo(e)}function o(e,t){t.hasOwnProperty(e)&&void 0!==t[e]&&this.hasOwnProperty(e)&&(this[e]=t[e])}function s(e){var t=0,i=e.guilds.map(function(i){var n=a.createGuild(i);return n.allianceId=e.allianceId,n.allianceName=e.allianceName,t+=n.nbMembers,n});return i[0].allianceLeader=!0,{memberCount:t,guilds:i}}var a=i(478),r=i(29).getText,l=a.Emblem,c=i(188).EventEmitter,d=i(172).inherits;d(n,c),n.prototype.setInfo=function(e){for(var t in e)o.call(this,t,e);if(e.guilds){var i=s(e);this.nbMembers=i.memberCount,this.guilds=i.guilds,this.guildCount=this.guilds.length}var n=e.prisms;if(n){this.prisms={};for(var a=0,l=n.length;a<l;a+=1){var c=n[a];this.prisms[c.subAreaId]=c}}"#NONAME#"===this.allianceName&&(this.allianceName=r("ui.guild.noName")),"#TAG#"===this.allianceTag&&(this.allianceTag=r("ui.alliance.noTag")),this.allianceEmblem.isAlliance=!0},e.exports=n},function(e,t,i){function n(){function e(){i&&(i.unset(),i.delClassNames("unavailable")),r="remove"}function t(){window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:n});var e=window.gui.pingSystem.getChatIcons();e.openPanel&&e.closePanels(),r="use"}s.call(this,{noHeader:!0});var i,n,o,r,l={};this.once("open",function(){l.useSmiley=this._addEntry(a("ui.common.use"),t),l.remove=this._addEntry(a("ui.common.remove"),e),this._addCancel()}),this.on("open",function(e,t){e=e||{},i=e.slot,o=e.onClose,n=e.smileyId,r="",l.remove.toggleDisplay(!!e.canRemove),l.useSmiley.toggleDisplay(!!e.hasOwnProperty("smileyId")),t()}),this.on("close",function(){o&&o(r)})}var o=i(172).inherits,s=i(433),a=i(29).getText;o(n,s),e.exports=n},function(e,t,i){function n(){function e(){t&&t.unset(),n="remove"}s.call(this);var t,i,n,o={};this.once("open",function(){o.remove=this._addEntry(a("ui.common.remove"),e),this._addCancel()}),this.on("open",function(e,s){e=e||{},t=e.slot,i=e.onClose,this.header.setText(e.spell.getName()),n="",o.remove.toggleDisplay(!!e.canRemove),s()}),this.on("close",function(){i&&i(n)})}var o=i(172).inherits,s=i(433),a=i(29).getText;o(n,s),e.exports=n},function(e,t,i){function n(){function e(){var e=this;this.menu.close(),window.gui.openConfirmPopup({title:s("ui.grimoire.spellLevel.increase"),message:s("ui.grimoire.popup.confirmation",this.upgradeCost,a,this.spellLevel),cb:function(t){t&&window.dofus.sendMessage("SpellUpgradeRequestMessage",{spellId:n,spellLevel:e.spellLevel})}})}function t(t){var i=new r("li");return i.menu=t,l(i),i.on("tap",e),i}o.call(this,{className:"ContextualMenuSpellUpgrade"});var i,n,a,c=[];this.once("open",function(){this.header.setText(s("ui.grimoire.spellLevel.increase")),i=this.entryList.createChild("ul"),this._addCancel()}),this.on("open",function(e,o){var r=e.spell;n=r.id,a=r.getName();for(var l=r.getProperty("spellLevels"),d=0,u=Math.max(l.length,c.length);d<u;d+=1){var h=d+1,p=c[d];if(p){if(!l[d]){p.hide();break}}else p=c[d]=i.appendChild(t(this));p.show();var m=!1,f=!1,g=r.getUpgradeCost(h),_=r.getProperty("minPlayerLevel",h),v=s("ui.common.level")+" "+h;h<=r.level?f=!0:window.gui.playerData.characterBaseInformations.level<_?v+=" ("+s("ui.spell.requiredLevelShort",_)+")":e.remainingPoints<g?v+=" ("+s("ui.spell.requiredPoints",g)+")":(m=!0,v+=" ("+g+" "+s("ui.common.points")+")"),p.setText(v),p.toggleClassName("disabled",!m),p.toggleClassName("checked",f),p.setEnable(m),p.spellLevel=h,p.upgradeCost=g}o()})}i(588);var o=i(433),s=i(29).getText,a=i(172).inherits,r=i(321),l=i(197);a(n,o),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(){n?l("ExchangeObjectTransfertAllToInvMessage",{}):l("ExchangeObjectTransfertAllFromInvMessage",{})}function t(){var e=o.getDisplayedItemsUIDs();!e||e.length<r.MIN_OBJ_COUNT_BY_XFERT||(e.length>r.MAX_OBJ_COUNT_BY_XFERT&&(e=e.splice(0,r.MAX_OBJ_COUNT_BY_XFERT),window.gui.chat.logMsg(a("ui.exchange.partialTransfert"))),n?l("ExchangeObjectTransfertListToInvMessage",{ids:e}):l("ExchangeObjectTransfertListFromInvMessage",{ids:e}))}function i(){n?l("ExchangeObjectTransfertExistingToInvMessage",{}):l("ExchangeObjectTransfertExistingFromInvMessage",{})}s.call(this,{noHeader:!0});var n,o,l=window.dofus.sendMessage;this.once("open",function(){this._addEntry(a("ui.storage.getAll"),e),this._addEntry(a("ui.storage.getVisible"),t),this._addEntry(a("ui.storage.getExisting"),i),this._addCancel()}),this.on("open",function(e,t){n=e.toInventory,o=e.viewer,t()})}var o=i(172).inherits,s=i(433),a=i(29).getText,r=i(342);o(n,s),e.exports=n},function(e,t,i){function n(e,t,i){var n=h[e],o=n.cached[t];return o?i(o):void c.getData(n.dbName,t,function(e,s){return e?(console.warn("ContextualMenuTaxCollector",e),i("")):(o=n.cached[t]=s[n.attribute],void i(o))})}function o(){function e(){3===this.actionId&&h.prepareDialog(s.npcData),window.dofus.sendMessage("NpcGenericActionRequestMessage",{npcId:s.contextualId,npcActionId:this.actionId,npcMapId:s.mapId})}a.call(this);var t,i,o,s,c,h,m=window.gui.playerData.guild;this.once("open",function(n){function a(e){var t=[e.guildInfo.guildName];e.maxPods&&(t.push(e.maxPods),t.push(e.prospecting),t.push(e.wisdom),t.push(e.taxCollectorsCount),t.push(l(e.kamas)),t.push(l(e.experience)),t.push(l(e.pods)),t.push(l(e.itemsValue)));var i=e.alliance;return i&&(t.push("#NONAME#"!==i.allianceName?i.allianceName:r("ui.guild.noName")),t.push("["+("#TAG#"!==i.allianceTag?i.allianceTag:r("ui.alliance.noTag"))+"]")),t}h=window.gui.npcDialogHandler,o=this.header.appendChild(new d);for(var c=n.npcData,u=0,m=c.actions.length;u<m;u+=1){var f=this._addEntry(c.actionsName[u],e);f.actionId=c.actions[u]}i=this._addEntry(r("ui.social.CollectTaxCollector"),function(){window.dofus.sendMessage("ExchangeRequestOnTaxCollectorMessage",{taxCollectorId:s.contextualId})}),t=this._addEntry(r("ui.common.attack"),function(){window.dofus.sendMessage("GameRolePlayTaxCollectorFightRequestMessage",{taxCollectorId:s.contextualId})}),this._addCancel(),window.gui.on("TaxCollectorDialogQuestionExtendedMessage",function(e){h.nextQuestionAsync(p.guild,[],a(e))}),window.gui.on("TaxCollectorDialogQuestionBasicMessage",function(e){h.nextQuestionAsync(p.basic,[],a(e))}),window.gui.on("AllianceTaxCollectorDialogQuestionExtendedMessage",function(e){h.nextQuestionAsync(p.alliance,[],a(e))})}),this.on("open",function(e,a){if(s=e,m.hasGuild()&&e.guild.guildId===m.current.guildId){i.show();var r=m.hasRight(u.GUILD_RIGHT_COLLECT),l=m.hasRight(u.GUILD_RIGHT_COLLECT_MY_TAX_COLLECTOR);r||l?i.enable():i.disable(),t.hide()}else i.hide(),t.show(),0!==e.taxCollectorAttack?t.disable():t.enable();n("firstName",e.taxCollector.firstNameId,function(t){n("lastName",e.taxCollector.lastNameId,function(i){c=t+" "+i,s.npcData.nameId=c,o.setContent({name:c,guild:e.guild}),a()})})})}var s=i(172).inherits,a=i(433),r=i(29).getText,l=i(339).intToString,c=i(30),d=i(444),u=i(478).GuildRightsBitEnum,h={firstName:{dbName:"TaxCollectorFirstnames",attribute:"firstnameId",cached:{}},lastName:{dbName:"TaxCollectorNames",attribute:"nameId",cached:{}}},p={guild:1,basic:2,alliance:15427};s(o,a),e.exports=o},function(e,t,i){function n(e,t,i,n){var o=new l("li",{className:t,text:e});return d(o),o.on("tap",function(){window.dofus.sendMessage("PlayerStatusUpdateRequestMessage",{status:{statusId:i}}),n.close()}),o}function o(){s.call(this,{className:"ContextualMenuUserStatus"}),this.once("open",function(){this.header.setText(a("ui.chat.status.title"));for(var e=[{label:a("ui.chat.status.availiable"),className:"available",id:c.PLAYER_STATUS_AVAILABLE},{label:a("ui.chat.status.away"),className:"away",id:c.PLAYER_STATUS_AFK},{label:a("ui.chat.status.private"),className:"private",id:c.PLAYER_STATUS_PRIVATE},{label:a("ui.chat.status.solo"),className:"solo",id:c.PLAYER_STATUS_SOLO}],t=this.entryList.createChild("ul"),i=0,o=e.length;i<o;i+=1){var s=e[i];t.appendChild(n(s.label,s.className,s.id,this))}this._addCancel()}),this.on("open",function(e,t){t()})}i(592);var s=i(433),a=i(29).getText,r=i(172).inherits,l=i(321),c=i(593),d=i(197);r(o,s),e.exports=o},function(e,t){},function(e,t){e.exports={PLAYER_STATUS_OFFLINE:0,PLAYER_STATUS_UNKNOWN:1,PLAYER_STATUS_AVAILABLE:10,PLAYER_STATUS_IDLE:20,PLAYER_STATUS_AFK:21,PLAYER_STATUS_PRIVATE:30,PLAYER_STATUS_SOLO:40}},function(e,t){},function(e,t){function i(){this._setDimensions(0,0,0,0),this.clear(),this.lastUpdateTime=0}function n(e,t,i,n,o,s){this.x=e,this.y=t,this.width=i,this.height=n,this.boxType=o,this.actorId=s,this.priority=h[o],this.angle=null}function o(e){var t=e.bbox;if(t[0]<=t[1])return t;var i=window.isoEngine.mapRenderer.getCellSceneCoordinate(e.cellId);return[i.x-20,i.x+20,i.y-90,i.y+10]}var s=5,a=5,r=0,l=1,c=2,d=3,u=4,h={};h[r]=1,h[l]=10,h[c]=20,h[d]=30;var p={};p[c]=50,p[d]=200,p[l]=400,e.exports=i,i.prototype.initialize=function(e,t,i,n){this._setDimensions(e,t,i,n),this.clear();var o=this;window.gui.on("resize",function(e){o._setDimensions(e.mapLeft,e.mapTop,e.mapWidth,e.mapHeight)}),window.isoEngine.on("mapLoaded",function(e){e&&e.isReload||o.clear()})},i.prototype.clear=function(){this.boxes=[]},i.prototype._setDimensions=function(e,t,i,n){this.originX=e,this.originY=t,this.width=i,this.height=n},n.prototype.intersectingSurface=function(e){if(e.x+e.width<=this.x||e.x>=this.x+this.width)return 0;if(e.y+e.height<=this.y||e.y>=this.y+this.height)return 0;var t=Math.min(this.x+this.width,e.x+e.width)-Math.max(this.x,e.x),i=Math.min(this.y+this.height,e.y+e.height)-Math.max(this.y,e.y);return t*i},n.prototype.setAsSubboxOf=function(e){this.priority=p[e.boxType];var t=this.x+this.width/2,i=this.y+this.height/2,n=e.x+e.width/2,o=e.y+e.height/2;this.angle=Math.atan2(o-i,n-t)},n.prototype.getCenter=function(){return[this.x+this.width/2,this.y+this.height/2]};var m=4,f=10;i.prototype._moveBoxAround=function(e,t,i){var n,o;switch(i){case 0:n=t.x+t.width-f,o=t.y-e.height;break;case 1:n=t.x-e.width+f,o=t.y-e.height;break;case 2:n=t.x-e.width+f,o=t.y+t.height;break;case 3:n=t.x+t.width-f,o=t.y+t.height;break;default:return console.error(new Error("invalid _moveBoxAround index"+i))}e.x=Math.round(n),e.y=Math.round(o)},i.prototype._computeWeight=function(e,t,i){if(e.x<this.originX+s||e.y<this.originY+s)return 1/0;if(e.x+e.width>this.originX+this.width-s||e.y+e.height>this.originY+this.height-s)return 1/0;for(var n=0,o=this.boxes.length-1;o>=0;o--){var a=this.boxes[o];if(a!==t){var r=e.intersectingSurface(a);if(r){if(!a.priority)return 1/0;if(n+=r/a.priority,n>=i)return n}}}return n},i.prototype._addBoxNextToTarget=function(e,t,i){for(var o=new n(0,0,t,i,u),s=1/0,r=0,l=0;l<m;l++){this._moveBoxAround(o,e,l);var c=this._computeWeight(o,e,s);if(c<s&&(s=c,r=l,0===c))break}return 0!==s&&this._moveBoxAround(o,e,r),o.x+=2*a*(Math.random()-.5),o.y+=2*a*(Math.random()-.5),o.setAsSubboxOf(e),this.boxes.push(o),o},i.prototype._newActorBox=function(e,t){var i=window.foreground,s=o(e),a=i.convertSceneToScreenCoordinate(s[0],s[2]),r=i.convertSceneToScreenCoordinate(s[1],s[3]),l=r.x-a.x,c=r.y-a.y,d=new n(a.x,a.y,l,c,t,e.actorId);return this.boxes.push(d),d},i.prototype.addBoxNextToActor=function(e,t){this._updateActors();var i=this._getActorBox(e);i||(i=this._newActorBox(e,d));var n=t.rootElement;return this._addBoxNextToTarget(i,n.clientWidth,n.clientHeight)},i.prototype.addObstacle=function(e,t,i,o){var s=new n(e,t,i,o,r);return this.boxes.push(s),s},i.prototype.removeBox=function(e){var t=this.boxes.indexOf(e);t<0||this.boxes.splice(t,1)},i.prototype._removeActors=function(){for(var e=[],t=this.boxes.length-1;t>=0;t--){var i=this.boxes[t];i.actorId||e.push(i)}this.boxes=e},i.prototype._updateActors=function(){this.lastUpdateTime=Date.now(),this._removeActors(),this._newActorBox(window.actorManager.userActor,l);var e=window.actorManager.actors;for(var t in e){var i=e[t],n=i.data;n&&!n.staticInfos&&this._newActorBox(i,i.isNPC()?c:d)}},i.prototype._getActorBox=function(e){for(var t=e.actorId,i=this.boxes.length-1;i>=0;i--){var n=this.boxes[i];if(n.actorId===t)return n}return null}},function(e,t,i){function n(){a.call(this,"div",{className:"ChallengeIndicator",hidden:!0}),r(this),this.firstTimeDisplayed=!0,this.challengeSlot=this.createChild("div",{className:"challengeSlot"}),this.iconDetailsListByChallengeId={},this.challengesResult={},this._hookupEvents(window.gui)}i(597);var o=i(166).dimensions,s=i(172).inherits,a=i(321),r=i(598),l=i(29).getText,c=i(337).addTooltip,d=i(182),u=i(600).highlightCells,h=i(202);s(n,a),e.exports=n,n.prototype._hookupEvents=function(e){var t=this;e.on("ChallengeInfoMessage",function(e){t.setChallenge(e)}),e.on("ChallengeResultMessage",function(e){return t.iconDetailsListByChallengeId[e.challengeId]?void t.setChallengeResult(e):void(t.challengesResult[e.challengeId]=e)}),h.on("ChallengeTargetsListMessage",function(e){u(e)}),e.on("GameFightEndMessage",function(){t.hide(),t.reset()}),e.on("GameFightJoinMessage",function(){}),e.on("disconnect",function(){t.hide(),t.reset()})},n.prototype.updateDescriptionWithFighter=function(e,t){var i=e.name+" ("+l("ui.common.level")+" "+e.level+")",n=t._description.replace("%1",i);return n},n.prototype.setChallenge=function(e){var t,i=this,n=window.gui.fightManager.getFighter(e.targetId);t=n?this.updateDescriptionWithFighter(n,e):e._description;var o="none",s=e.challengeId;d.preloadImage("gfx/challenges/"+s+".png",function(a){o=a;var r=i.setupIconGUI(e._name,t||e._description,e.dropBonus,e.xpBonus,s,o);i.iconDetailsListByChallengeId[s]={icon:r.icon,details:r.details,iconUrl:o,success:e.success,name:e._name,description:t,dropBonus:e.dropBonus,xpBonus:e.xpBonus,targetFighter:n};var l=i.challengesResult[s];l&&i.setChallengeResult(l)})},n.prototype.setupIconGUI=function(e,t,i,n,s,r){var d=this.challengeSlot.createChild("div",{className:"challengeIcon"});d.challengeState=d.createChild("div",{className:"challengeState"});var u=new a("div",{className:"challengeDetails",name:"challengeDetails"});return u.challengeName=u.createChild("div",{className:"challengeName",text:e}),u.challengeDesc=u.createChild("div",{className:"challengeDesc",text:t}),u.challengeLoot=u.createChild("div",{className:"challengeLoot",text:l("ui.common.loot")+" +"+i+"%"}),u.challengeXp=u.createChild("div",{className:"challengeXp",text:l("ui.common.xp")+" +"+n+"%"}),u.challengeStatus=u.createChild("div",{className:"challengeStatus",text:l("ui.fight.challenge.inProgress")}),c(d,u),d.on("tap",function(){window.dofus.sendMessage("ChallengeTargetsListRequestMessage",{challengeId:s})}),d.setStyle("backgroundImage",r),this.show(),this.firstTimeDisplayed&&(this.firstTimeDisplayed=!1,this.setStyle("left",o.mapLeft+"px")),{icon:d,details:u}},n.prototype.setChallengeResult=function(e){var t=this.iconDetailsListByChallengeId[e.challengeId];e.success?(t.icon.challengeState.addClassNames("success"),t.details.challengeStatus.addClassNames("success"),t.details.challengeStatus.setText(l("ui.fight.challenge.complete"))):(t.icon.challengeState.addClassNames("fail"),t.details.challengeStatus.addClassNames("fail"),t.details.challengeStatus.setText(l("ui.fight.challenge.failed"))),t.success=e.success},n.prototype.reset=function(){for(var e in this.iconDetailsListByChallengeId)this.iconDetailsListByChallengeId[e].icon.destroy(),this.iconDetailsListByChallengeId[e].details.destroy(),delete this.iconDetailsListByChallengeId[e];this.challengesResult={}}},function(e,t){},function(e,t,i){function n(e,t){function i(){t.isFullScreen?(h=0,m=0,p=o.screenWidth,f=o.screenHeight):(h=o.mapLeft,m=o.mapTop,p=o.mapRight,f=o.mapBottom),u()}function n(){M>T?M=T:M<A&&(M=A),w>C?w=C:w<I&&(w=I),r()}function r(){S=M===A,E=w===I,x=M===T,N=w===C,e.toggleClassName("magnetLeft",S),e.toggleClassName("magnetTop",E),e.toggleClassName("magnetRight",x),e.toggleClassName("magnetBottom",N),e.toggleClassName("magnetFloating",!(S||E||x||N))}function l(){S&&(M=A),E&&(w=I),x&&(M=T),N&&(w=C)}function c(){e.setStyles({webkitTransform:"",left:M+"px",top:w+"px",right:"initial",bottom:"initial"}),r()}function d(){var t=e.rootElement.clientWidth,i=e.rootElement.clientHeight;return!(!t||!i)&&(M=e.rootElement.offsetLeft,w=e.rootElement.offsetTop,t<=o.mapWidth?(A=h,T=p-t):(A=0,T=o.screenWidth-t),i<=o.mapHeight?(I=m,C=f-i):(I=0,C=o.screenHeight-i),!0)}function u(){L=!1,d()&&(n(),l(),c())}t=t||{};var h,p,m,f,g=t.grip||e.createChild("div",{className:"gripHandler"});s(g);var _,v,y,b,M,w,T,C,A,I,S,E,x,N;g.on("slideStart",function(t){_=t.x,v=t.y,d(),y=M,b=w,e.addClassNames("dragging"),e.emit("dragStart")}),g.on("slide",function(t){M=y+t.x-_,w=b+t.y-v,n();var i=M-y,o=w-b;e.setStyle("webkitTransform","translate3d("+i+"px, "+o+"px, 0)")}),g.on("slideEnd",function(){c(),e.delClassNames("dragging"),e.emit("dragEnd")});var L=!1;i(),window.gui.on("resize",i),t.isCollapsable&&(g.createChild("div",{className:"collapseBtn"}),a(g),g.on("tap",function(){e.collapse(!e.isCollapsed)}),e.isCollapsed=!1,e.collapse=function(t,i){e.isCollapsed=t,e.toggleClassName("collapsed",t),L=!0,i||e.emit("collapse",t),L&&u()}),e.on("resized",u)}i(599);var o=i(166).dimensions,s=i(201),a=i(197);e.exports=n},function(e,t){},function(e,t){t.highlightCells=function(e){for(var t in window.gui.challengeIndicator.iconDetailsListByChallengeId)switch(t){case"3":case"4":case"32":case"34":case"35":var i=e.targetCells[0];window.gui.pingSystem.addPingPicto(i,"attack")}}},function(e,t,i){function n(e){for(var t=0,i=0;i<e.length;i++)t+=e.charCodeAt(i)%16;return(t%16).toString(16).toUpperCase()}function o(){var e=Math.ceil(100*Math.random());return e<=40?String.fromCharCode(Math.floor(26*Math.random())+65):e<=80?String.fromCharCode(Math.floor(26*Math.random())+97):String.fromCharCode(Math.floor(10*Math.random())+48)}function s(){for(var e="",t=0;t<20;t++)e+=o();return e+n(e)}function a(){M=!0,window.gui.openSimplePopup(_("ui.common.cantSelectThisCharacter"),_("ui.popup.impossible_action")),window.dofus.sendMessage("CharactersListRequestMessage")}function r(e){return m=e,w=e.characters,0===w.length?(y.closeAll(),y.open("characterCreation")):b?(b=!1,window.gui.playerData.accountCapabilities.tutorialAvailable?void window.dofus.sendMessage("CharacterFirstSelectionMessage",{id:w[0].id,doTutorial:window.gui.tutorialManager.isTutorialRequired()}):t.selectCharacter(w[0].id)):M?y.open("characterSelection",w):"characterId"===v.connectMethod?v.characterId?t.selectCharacter(v.characterId):(console.error(new Error("characterId is missing!")),void y.open("characterSelection",w)):"lastCharacter"===v.connectMethod?t.selectCharacter(w[0].id):void y.open("characterSelection",w)}function l(){b=!1,M=!1,w=[]}function c(e){for(var t=0;t<w.length;t++)if(w[t].id===e)return t;return-1}function d(e,t){for(var i=0;i<e.length;i++)if(e[i].id===t)return e[i];return null}function u(e){if(f=null,"CharactersListWithModificationsMessage"!==m._messageType)return!1;var t={};if(m.charactersToRename.indexOf(e)>=0)t.canRename=!0;else if(d(m.charactersToRecolor,e))t.canRecolor=!0;else{if(!d(m.charactersToRelook,e))return!1;t.canReface=!0}return t.characterToRelook=w[c(e)],y.getWindow("characterSelection").hide(),y.open("characterCreation",{relookingParams:t}),f=t,!0}function h(e){f.canRename?e.infos.name=g.name:f.canRecolor?e.infos.entityLook.indexedColors=g.colors:f.canReface&&(e.infos.entityLook.skins[1]=g.headSkin)}function p(e){M=!1,y.close("characterSelection"),f&&(y.close("characterCreation"),h(e)),window.gui.onConnect(e.infos),window.actorManager.setUserCharacterData(e.infos),window.dofus.sendMessage("ClientKeyMessage",{key:T}),window.dofus.sendMessage("GameContextCreateRequestMessage")}var m,f,g,_=i(29).getText,v=i(204),y=i(194),b=!1,M=!1,w=[],T=s();t.confirmNewCharacterCreation=function(){b=!0},t.confirmCharacterRelooking=function(e){var t=f.characterToRelook.id;g=e,f.canRename?window.dofus.sendMessage("CharacterSelectionWithRenameMessage",{id:t,name:e.name}):f.canRecolor?window.dofus.sendMessage("CharacterSelectionWithRecolorMessage",{id:t,indexedColor:e.colors}):f.canReface&&window.dofus.sendMessage("CharacterSelectionWithRelookMessage",{id:t,cosmeticId:e.cosmeticId})},t.selectCharacter=function(e){u(e)||window.dofus.sendMessage("CharacterSelectionMessage",{id:e})},t.backToSelection=function(){return y.closeAll(),0===w.length?y.open("serverSelection"):void y.open("characterSelection",w)},t.initialize=function(e){var t=window.dofus.connectionManager;t.on("CharacterSelectedForceMessage",function(){window.dofus.sendMessage("CharacterSelectedForceReadyMessage")}),t.on("CharactersListMessage",r),t.on("CharactersListWithModificationsMessage",r),t.on("CharacterSelectedSuccessMessage",p),t.on("CharacterSelectedErrorMessage",a),e.on("disconnect",l)},t.getCharacterList=function(){return w}},function(e,t,i){function n(){x.call(this,"div",{className:"chat"}),this.displayMode=G.ROLEPLAY,this.keyboardHeight=.6*h.screenHeight,this.linkHelper=new M,this.p2p=new w,this.censor=new D,this.presets=null,this.channelMap=window.gui.databases.ChatChannels,this.numPresetsListeningToChannel=null,this.historyBuffers={},this.historyBuffers[z]=new _(Y);for(var e in this.channelMap)this.historyBuffers[~~e]=new _(Y);this._initializeElements(),this._setMessageHandlers()}function o(e){var t=this.chat;t._toggleChannel(t.activePreset,~~this.id,e)}function s(){var e=this.chat,t=this.presetId;t===e.activePreset?e._togglePresetChannels(t):e._setActivePreset(t)}i(603);var a=i(335),r=i(604),l=i(366),c=i(605),d=i(612),u=i(168),h=i(166).dimensions,p=a.DofusButton,m=i(348),f=i(334).getElementPositionAround,g=i(29).getText,_=i(460),v=i(614),y=i(172).inherits,b=i(435),M=i(617),w=i(618),T=i(436),C=i(197),A=i(196),I=i(176),S=i(543),E=i(194),x=i(321),N=i(620),L=i(622),O=i(171),D=i(624),R=450,P=275,B=l.CHANNEL_GLOBAL,k=l.PSEUDO_CHANNEL_PRIVATE,z=r.RED_CHANNEL,F=0,H=1,q=2,W=3,U={};U[l.PSEUDO_CHANNEL_FIGHT_LOG]=!0;var G={ROLEPLAY:"roleplay",FIGHT:"fight"},j="chatIncomingPreset_",Y=50;y(n,x),e.exports=n,n.prototype._initializeAtConnection=function(){this.setDisplayMode(G.ROLEPLAY),this.chatInput.initializeAtConnection(),this._clearChatHistory()},n.prototype._initializeEnabledChannels=function(e,t){this.chatInput.initializeEnabledChannels(e,t),this._loadPresetConfig(),this._setActivePreset(F)},n.prototype._clearChatHistory=function(){this._logChat.clearContent();for(var e in this.historyBuffers)this.historyBuffers[~~e].clear();this.chatInput.clearSentMessageHistory()},n.prototype._initializeElements=function(){var e=this;this._savedWidthForRP=null,this._savedHeightForRP=null,this.logWrapper=this.createChild("div",{className:"logWrapper"}),this.fightControls=this.logWrapper.createChild("div",{className:"fightControls"}),this.timelineBox=this.fightControls.createChild("div",{className:"timelineBox"});var t=this.fightControls.createChild("div",{className:"fightButtons"}),i=new p("",{className:"yourTurnButton",hidden:!0},function(){e.deactivate()}),n=this.createChild("div",{className:"yourTurnText"});n.setText(g("tablet.chat.yourTurnButton")),i.appendChild(n),this.yourTurnButton=t.appendChild(i),this.logScroller=this.logWrapper.appendChild(new T({className:"log"},{showHintArrows:!0})),this._logChat=this.logScroller.content,this._logChat.addClassNames("showChannel666"),this.chatInput=new c(this.logWrapper,this.linkHelper),this.chatInput.on("sentChatMsg",function(){e.logScroller.goToBottom()}),this.logWrapper.appendChild(new S({className:["simpleButton","chatCloseButton"]},function(){e.deactivate()})),L(this.logWrapper,{minWidth:R,minHeight:P}),this.logWrapper.on("resize",function(){e.displayMode===G.FIGHT?I.setValue("ChatHeightForFight",e.logWrapper.windowHeight):(e._savedWidthForRP=e.logWrapper.windowWidth,e._savedHeightForRP=e.logWrapper.windowHeight),e._refreshScroller()})},n.prototype._updateChannelListenerCount=function(e,t){var i=this.numPresetsListeningToChannel[e],n=Math.max(i+t,0);this.numPresetsListeningToChannel[e]=n,U[e]||(0===i&&n>0?window.dofus.sendMessage("ChannelEnablingMessage",{channel:e,enable:!0}):i>0&&0===n&&window.dofus.sendMessage("ChannelEnablingMessage",{channel:e,enable:!1}))},n.prototype._toggleChannel=function(e,t,i){this._setChannelInPreset(e,t,i),this._updateChannelListenerCount(t,i?1:-1)},n.prototype._addPreset=function(e){var t=this.presetButtons.createChild("div",{className:"presetButton"});t.createChild("div",{className:["presetIcon",e.className]}),t.chat=this,t.presetId=this.presets.length,C(t),t.on("tap",s);for(var i,n=[],a=0;a<e.channels.length;a++)i=e.channels[a],n.push(i);var r={element:t,channels:n,channelsList:this.channelsLists.createChild("div",{className:"channelsList"})};this.presets.push(r);for(var l in this.channelMap){i=~~l;var c=r.channelsList.appendChild(new d(this.channelMap[i].nameId));c.id=i,c.chat=this,c.addClassNames("channel"+c.id),c.on("change",o)}},n.prototype._createPresets=function(e){this.presets=[],this.activePreset=null,this.presetButtons=this.logWrapper.createChild("div",{className:"presetButtons"}),this.channelsLists=this.logWrapper.createChild("div",{className:"channelsLists"});for(var t=0;t<e.length;t++)this._addPreset(e[t])},n.prototype._setChannelInPreset=function(e,t,i){var n=this.presets[e].channels,o=!1,s=n.indexOf(t);s===-1||i?s===-1&&i&&(n.push(t),o=!0):(n.splice(s,1),o=!0),o&&(e===this.activePreset&&this._updateLogFilter(),I.setValue(j+e,n))},n.prototype._updatePresets=function(e){var t=this.numPresetsListeningToChannel={};for(var i in this.channelMap)t[~~i]=0;for(var n,o,s=e.length-1;s>=0;s--){var a=this.presets[s];o=a.channelsList.getChildren();var r=0;for(i in this.channelMap){n=~~i;var l=this.chatInput.isChannelEnabledForSending(n),c=a.channels.indexOf(n)>=0,d=o[r];r++,this.chatInput.isChannelAllowedForSending(n)?(U[n]||(!l||c||0!==s||t[n]||(this._setChannelInPreset(s,n,!0),c=!0),!l&&c&&(this._setChannelInPreset(s,n,!1),c=!1)),c?(d.activate(!0),t[n]++):d.deactivate(!0)):d.hide()}}},n.prototype._loadPresetConfig=function(){var e=[];e.push({className:"preset1",channels:I.getValue(j+F,[l.CHANNEL_GLOBAL,l.CHANNEL_TEAM,l.CHANNEL_GUILD,l.CHANNEL_ALLIANCE,l.CHANNEL_PARTY,l.CHANNEL_NOOB,l.PSEUDO_CHANNEL_PRIVATE,l.PSEUDO_CHANNEL_INFO,l.PSEUDO_CHANNEL_FIGHT_LOG,l.CHANNEL_ADS,l.CHANNEL_ARENA])}),e.push({className:"preset2",channels:I.getValue(j+H,[l.PSEUDO_CHANNEL_FIGHT_LOG])}),e.push({className:"preset3",channels:I.getValue(j+q,[l.PSEUDO_CHANNEL_PRIVATE])}),e.push({className:"preset4",channels:I.getValue(j+W,[l.CHANNEL_GUILD,l.CHANNEL_SALES,l.CHANNEL_SEEK])}),this.presets||this._createPresets(e),this._updatePresets(e)},n.prototype._showMsgAsBubble=function(e,t){if(e.channel===k)return!1;if(!window.gui.playerData.isFighting||O.showSpeechBubbleInFight){var i=window.actorManager.getActor(e.senderId);if(!i)return!1;window.gui.newSpeechBubble({actor:i,msg:e.content,objectItems:e.objects,channel:e.channel,decodeAllPages:t});var n=E.getOpenWindows();return!(n.length>=2)&&(1!==n.length||"worldMap"===n[0]&&!E.getWindow("worldMap").isMaximized())}},n.prototype._createMessageContent=function(e,t,i){var n=new x("div",{className:"message"}),o="ChatAdminServerMessage"===e._messageType;if(n.addClassNames("channel"+(o?l.CHANNEL_ADMIN:e.channel)),
e.channel!==B&&e.channel!==k&&n.createChild("span",{text:"("+this.channelMap[e.channel].nameId+") "}),e.channel===k){var s=g(t?"ui.chat.to":"ui.chat.from");n.createChild("span",{text:s+" "})}var a=v.process("{player,"+(t?e.receiverName:e.senderName)+","+(t?e.receiverId:e.senderId)+"}: ");return n.appendChild(a),n.appendChild(v.process(e.content,{objectItems:e.objects,channel:e.channel,decodeAllPages:i})),n},n.prototype._createMessageContentFromText=function(e,t){var i=new x("div",{className:"message"});return i.addClassNames("channel"+t),i.appendChild(v.process(e,{channel:t})),i},n.prototype._addMsgToChat=function(e,t){var i=this._logChat.appendChild(e),n=this.historyBuffers[t].push(i);n&&this._logChat.removeChild(n),this._refreshScroller(!0)},n.prototype._logNewMessage=function(e,t){if(!this.p2p.processMsg(e,t)){var i=t||r.isChannelSelective(e.channel,e.senderId);e.content=this.censor.filterCensoredWords(e.content);var n=this._createMessageContent(e,t,i);if(this._addMsgToChat(n,e.channel),this.isChannelEnabledInPreset(e.channel)&&!this._showMsgAsBubble(e,i)){var o=this._createMessageContent(e,t,i);window.gui.textNotification.add(o,{channel:e.channel})}}},n.prototype._logServerMsgWithObject=function(e,t){e.content=this.linkHelper.replaceLinksReceived(e.content,e.objects),this._logNewMessage(e,t)},n.prototype._logServerText=function(e,t){t=t||{};var i=void 0!==t.channel?t.channel:l.PSEUDO_CHANNEL_INFO,n=this._createMessageContentFromText(e,i),o=this._createMessageContentFromText(e,i);this._addMsgToChat(n,i),window.gui.textNotification.add(o,{channel:i})},n.prototype.logMsg=function(e,t){if(void 0===t&&(t=l.PSEUDO_CHANNEL_INFO),!this.isChannelEnabledInPreset(t)){var i=this._createMessageContentFromText(e,t);return this._addMsgToChat(i,t)}this._logServerText(e,{channel:t})},n.prototype.logError=function(e){this._logServerText(e,{channel:z})},n.prototype.insertLink=function(e,t){this.chatInput.insertLink(e,t)},n.prototype._refreshScroller=function(e){var t=!this.logScroller.canScrollDown();return this.logScroller.refresh(),e&&!t?this.logScroller.notify():void this.logScroller.goToBottom()},n.prototype._togglePresetChannels=function(e){if(this.channelsLists.toggleDisplay(),!this.channelsLists.isVisible())return this._refreshScroller();var t=this.presets[e],i=f(t.channelsList,t.element);t.channelsList.setStyles({left:i.x+"px",top:i.y+"px"})},n.prototype._setActivePreset=function(e){this.activePreset=e,this.channelsLists.hide();for(var t=0;t<this.presets.length;t++){var i=this.presets[t];i.element.toggleClassName("on",t===e),i.channelsList.toggleDisplay(t===e)}this._updateLogFilter(),this._refreshScroller()},n.prototype.isChannelEnabledInPreset=function(e){if(!this.presets)return!0;var t=this.presets[this.activePreset].channels;return t.indexOf(e)!==-1},n.prototype._updateLogFilter=function(){for(var e=this.presets[this.activePreset].channels,t=Object.keys(l).length,i=0;i<=t;i++)this._logChat.toggleClassName("showChannel"+i,e.indexOf(i)!==-1)},n.prototype._setMessageHandlers=function(){function e(e){var t=n.playerData.characters.canControlCharacterId(e.id);i.yourTurnButton.toggleDisplay(t)}function t(){i.yourTurnButton.hide()}var i=this,n=window.gui,o=window.dofus.connectionManager;n.on("connected",function(){i._initializeAtConnection()}),o.on("EnabledChannelsMessage",function(e){i._initializeEnabledChannels(e.channels,e.disallowed)}),o.on("ChatServerWithObjectMessage",function(e){i._logServerMsgWithObject(e,!1)}),o.on("ChatServerCopyWithObjectMessage",function(e){i._logServerMsgWithObject(e,!0)}),o.on("ChatServerMessage",function(e){i._logNewMessage(e,!1)}),o.on("EntityTalkMessage",function(e){var t=window.actorManager.getActorFromNpcId(e.entityId);window.gui.newSpeechBubble({actor:t,msg:e.text})}),o.on("ChatAdminServerMessage",function(e){i._logNewMessage(e,!1)}),o.on("ChatServerCopyMessage",function(e){i._logNewMessage(e,!0)}),o.on("BasicWhoIsMessage",function(e){e.verbose&&i._logServerText(N(e))}),o.on("BasicWhoIsNoMatchMessage",function(e){i._logServerText(g("ui.common.playerNotFound",e.search))}),o.on("CharacterExperienceGainMessage",function(e){e.experienceCharacter&&i.logMsg(g("ui.stats.xpgain.mine",e.experienceCharacter)),e.experienceGuild&&i.logMsg(g("ui.stats.xpgain.guild",e.experienceGuild)),e.experienceIncarnation&&i.logMsg(g("ui.stats.xpgain.incarnation",e.experienceIncarnation)),e.experienceMount&&i.logMsg(g("ui.stats.xpgain.mount",e.experienceMount))}),n.fightManager.on("fightEnterPreparation",function(){i.deactivate()}),n.fightManager.on("fightStart",function(){i.yourTurnButton.hide(),i.setDisplayMode(G.FIGHT)}),n.fightManager.on(m.FIGHT_END,function(){t(),i.setDisplayMode(G.ROLEPLAY)}),n.on("GameFightTurnStartMessage",e),n.on("GameFightTurnResumeMessage",e),n.on("GameFightTurnStartSlaveMessage",e),n.on("GameFightTurnEndMessage",t),n.on("resize",function(){i._resize()}),n.on("disconnect",function(){i.deactivate()}),b.on("show",function(e){e&&!isNaN(e)||(console.error("Chat: the keyboardHeight is wrong:",e),e=.6*h.screenHeight),i.keyboardHeight=e,i.setDimensions()})},n.prototype.setDisplayMode=function(e){if(this.displayMode!==e){if(!this.active)return void(this.displayMode=e);this.removeDisplayMode(),this.displayMode=e,this.addDisplayMode(),this.setDimensions()}},n.prototype.removeDisplayMode=function(){switch(this.displayMode){case G.FIGHT:window.gui.timeline.restoreFighterList(),this.delClassNames("fightMode")}},n.prototype.addDisplayMode=function(){this.displayMode===G.FIGHT&&(this.addClassNames("fightMode"),window.gui.timeline.appendFighterListTo(this.timelineBox))},n.prototype.setDimensions=function(){switch(this.displayMode){case G.FIGHT:this.logWrapper.windowWidth=h.screenWidth;var e=h.physicalScreenHeight-this.keyboardHeight,t=e*h.physicalToViewportRatio;this.logWrapper.windowHeight=I.getValue("ChatHeightForFight",t),this.logWrapper.setWidthLock(!0);break;default:var i=Math.max(R,Math.round(.45*h.mapWidth)),n=Math.max(P,Math.round(.45*h.mapHeight));this.logWrapper.windowWidth=this._savedWidthForRP||i,this.logWrapper.windowHeight=this._savedHeightForRP||n,this.logWrapper.setWidthLock(!1)}this.logWrapper.setStyles({width:this.logWrapper.windowWidth+"px",height:this.logWrapper.windowHeight+"px"}),this._refreshScroller()},n.prototype.startPrivateMessage=function(e,t){this.chatInput.startPrivateMessage(e,t),this.activate()},n.prototype.activate=function(){var e=this;b.disableScroll(!0),this.addClassNames("open"),this.active=!0,u.isPhoneGap||this.setDimensions(),this.addDisplayMode(),this._refreshScroller(),window.gui.textNotification&&window.gui.textNotification.hide(),A.tween(this,{webkitTransform:"translate3d(0, 0, 0)"},{time:200,delay:0,easing:"ease-out"},function(){e.chatInput.focus()}),b.setAutomaticHide(!1)},n.prototype.deactivate=function(){if(this.active){this.active=!1,this.chatInput.blur(),b.disableScroll(!1);var e=this;A.tween(this,{webkitTransform:"translate3d(0, -"+this.logWrapper.windowHeight+"px, 0)"},{time:200,delay:0,easing:"ease-out"},function(){e.removeDisplayMode(),e.delClassNames("open")}),window.gui.textNotification&&window.gui.textNotification.show(),this.channelsLists&&this.channelsLists.hide(),b.setAutomaticHide(!0)}},n.prototype._resize=function(){var e=!this.logWrapper.windowHeight;this.setDimensions(),e&&this.deactivate()}},function(e,t){},function(e,t,i){var n=i(366),o=666;t.RED_CHANNEL=o,t.isChannelSelective=function(e,t){switch(e){case n.CHANNEL_ALLIANCE:case n.CHANNEL_GUILD:case n.CHANNEL_PARTY:return!0;case n.PSEUDO_CHANNEL_PRIVATE:var i,o=window.gui.playerData.socialData;return i="string"==typeof t?o.searchOnlineFriendByName(t):o.searchOnlineFriendById(t),!!i&&o.isMutualFriend(i);default:return!1}},t.isChannelSafe=function(e){switch(e){case o:case n.CHANNEL_ADMIN:case n.CHANNEL_ADS:case n.PSEUDO_CHANNEL_INFO:case n.PSEUDO_CHANNEL_FIGHT_LOG:return!0;default:return!1}},t.isHumanChannel=function(e){switch(e){case o:case n.PSEUDO_CHANNEL_INFO:case n.PSEUDO_CHANNEL_FIGHT_LOG:return!1;default:return!0}}},function(e,t,i){function n(e,t){d.call(this),this.linkHelper=t,this.channelMap=window.gui.databases.ChatChannels,this.outgoingChannel=T,this.outgoingChannelMenu=null,this.sendingEnabledChannels=null,this.sendingDisallowedChannels=null,this.previousInput="",this.previousPrivateReceiver="",this.sentMessageHistory=new v,this._createElements(e),this._setMessageHandlers()}function o(e,t){var i=e.getValue(),n=i.substr(0,t.length);n===t&&e.setValue(i.substr(t.length))}function s(e,t){var i=e.getValue();i.substr(0,t.length)!==t&&e.setValue(t+i)}var a=i(335),r=i(366),l=i(606),c=i(607),d=i(175).EventEmitter,u=i(29).getText,h=i(199),p=i(172).inherits,m=i(530),f=i(604),g=i(608),_=i(342),v=i(609),y=i(610),b=i(611),M=i(337),w=[r.CHANNEL_GLOBAL,r.CHANNEL_TEAM,r.CHANNEL_GUILD,r.CHANNEL_ALLIANCE,r.CHANNEL_PARTY,r.CHANNEL_NOOB,r.CHANNEL_ADMIN,r.PSEUDO_CHANNEL_PRIVATE,r.CHANNEL_ARENA,r.CHANNEL_SALES,r.CHANNEL_SEEK],T=r.CHANNEL_GLOBAL,C=r.PSEUDO_CHANNEL_PRIVATE,A=/^\/([A-Za-z]+)/,I={s:T,w:C,t:r.CHANNEL_TEAM,g:r.CHANNEL_GUILD,a:r.CHANNEL_ALLIANCE,p:r.CHANNEL_PARTY,i:r.CHANNEL_NOOB,q:r.CHANNEL_ADMIN,k:r.CHANNEL_ARENA,b:r.CHANNEL_SALES,r:r.CHANNEL_SEEK};p(n,d),e.exports=n,n.prototype.initializeAtConnection=function(){this.statusIndicator.initialize(),this.previousInput="",this.previousPrivateReceiver="",this._selectOutgoingChannel(T,!0),this.sendingEnabledChannels=w.concat(),this.sendingDisallowedChannels=[]},n.prototype.initializeEnabledChannels=function(e,t){this.sendingEnabledChannels=e,this.sendingDisallowedChannels=t,this._initOutgoingChannelMenu()},n.prototype.clearSentMessageHistory=function(){this.sentMessageHistory.reset()},n.prototype._createElements=function(e){function t(){var e=n.sentMessageHistory.getCurrentEntry();n._setInput(e.message),n.linkHelper.linksToReplace=e.links}var i=e.createChild("div",{className:"formChat"});this.statusIndicator=new b(i),this._createChannelSelector(i),this.inputChat=i.appendChild(new m({className:"inputChat",attr:{maxlength:_.USER_MAX_CHAT_LEN}}));var n=this;this.inputChat.on("validate",function(){n._submit()});var o=i.appendChild(new a({className:"historyUp",scaleOnPress:!0,hidden:!0},function(){n.sentMessageHistory.goBack(),t()})),s=i.appendChild(new a({className:"historyDown",scaleOnPress:!0,hidden:!0},function(){n.sentMessageHistory.goForward(),t()}));i.appendChild(new a({className:"historyButton",scaleOnPress:!0},function(){o.toggleDisplay(),s.toggleDisplay()})),i.appendChild(new a({className:["sendButton","greenButton"],addIcon:!0},function(){n._submit()}))},n.prototype._createChannelSelector=function(e){function t(){i._selectOutgoingChannel(this.id),i.inputChat.focus()}for(var i=this,n=this.outgoingChannelMenu=[],o=0;o<w.length;o++){var s=this.channelMap[w[o]];n.push({id:s.id,caption:s.nameId+" ("+s.shortcut+")",cb:t,ticked:s.id===this.outgoingChannel})}this.outgoingChannelButtonBg=e.createChild("div",{className:"buttonBackground"}),e.createChild("div",{className:"outgoingChannelButton"});var a=e.createChild("div",{className:"buttonTouchZone"});M.addTooltip(a,u("ui.option.chat")),a.on("tap",function(){var e=this.rootElement.getBoundingClientRect();window.gui.openContextualMenu("generic",{title:u("ui.option.currentChannel"),actions:i.outgoingChannelMenu},{x:e.left+e.width,y:e.top})})},n.prototype._showNotification=function(e){M.showNotification(e,this.inputChat)},n.prototype.showNotification=n.prototype._showNotification,n.prototype._initOutgoingChannelMenu=function(){for(var e=this.outgoingChannelMenu,t=0;t<e.length;t++){var i=e[t];i.hidden=this.sendingEnabledChannels.indexOf(i.id)<0,i.ticked=i.id===this.outgoingChannel}},n.prototype._getOutgoingChannelMenuOption=function(e){for(var t=this.outgoingChannelMenu,i=0;i<t.length;i++)if(t[i].id===e)return t[i]},n.prototype._setChannelEnabled=function(e,t){var i=this._getOutgoingChannelMenuOption(e);i&&(i.hidden=!t);var n=this.channelMap[e].nameId,o=this.sendingEnabledChannels,s=o.indexOf(e);if(s!==-1){if(this._showNotification(u("tablet.chat.disablingChannel",n)),t)return console.warn("Chat channel already enabled");o.splice(s,1)}else{if(this._showNotification(u("tablet.chat.enablingChannel",n)),!t)return console.warn("Chat channel already disabled");o.push(e)}},n.prototype.isChannelEnabledForSending=function(e){return this.sendingEnabledChannels.indexOf(e)!==-1},n.prototype.isChannelAllowedForSending=function(e){return this.sendingDisallowedChannels.indexOf(e)===-1},n.prototype._selectOutgoingChannel=function(e,t){var i=this.outgoingChannel;(e!==i||t)&&(t&&e!==C&&this.inputChat.setValue(""),i===C&&o(this.inputChat,this.previousPrivateReceiver+" "),e===C&&this.previousPrivateReceiver&&s(this.inputChat,this.previousPrivateReceiver+" "),this.inputChat.setClassNames(["inputChat","inputBox","channel"+e]),this.outgoingChannelButtonBg.setClassNames(["buttonBackground","outgoingChannel"+e]),e===C&&(this.previousPrivateReceiver?this._showNotification(u("tablet.chat.enteringPrivateChannel",this.previousPrivateReceiver)):this._showNotification(u("tablet.chat.privateReceiverHelp"))),this._getOutgoingChannelMenuOption(i).ticked=!1,this._getOutgoingChannelMenuOption(e).ticked=!0,this.outgoingChannel=e)},n.prototype._setMessageHandlers=function(){var e=this,t=window.dofus.connectionManager;t.on("ChannelEnablingChangeMessage",function(t){e._setChannelEnabled(t.channel,t.enable)}),t.on("ChatErrorMessage",function(t){e._showNotification(t.reason),e._setInput(e.previousInput,!0),e.sentMessageHistory.removeMessage()})},n.prototype.insertLink=function(e,t){var i=this.linkHelper.newLinkForSending(e,t);this.inputChat.setValue(this.inputChat.getValue()+" "+i+" ")},n.prototype.focus=function(){this.inputChat.focus()},n.prototype.blur=function(){this.inputChat.blur()},n.prototype._submit=function(){h.recordActivity();var e=this.inputChat.getValue().trim(),t=this.outgoingChannel,i=null,n=A.exec(e);if(n){n=n[1].toLowerCase();var o=e.split(" ").slice(1),s=y(n,o);if(s)return void this._setInput("");if(t=I[n],void 0===t)return this._showNotification(u("ui.console.notfound",e.substr(1).split(" ")[0]));e=e.substr(n.length+2)}if(t===C){var a=e.indexOf(" ");if(i=e.substr(0,a),e=e.substr(a),!i||!e||i.length<_.MIN_NICK_LEN||i.length>_.MAX_NICK_LEN)return this._showNotification(u("tablet.chat.privateReceiverHelp"));this.previousPrivateReceiver=i}if(e=e.trim()){this.previousInput=e;var r={allPagesAllowed:f.isChannelSelective(t,i)},d=l.getUnsendableCharacters(e,r);if(d.length){var p=d[0]+" ("+d[0].codePointAt().toString(16)+")";return this._showNotification(u("tablet.chat.unsendableChars",p))}e=l.encode(e,r),e=g(e);var m=[];e=this.linkHelper.prepareForSending(e,m);var v=c.sendMessage(e,t,i,m);if(v)return this._showNotification(v);this.sentMessageHistory.addMessage(this.previousInput,this.linkHelper.previousLinks),this._setInput(""),this.emit("sentChatMsg")}},n.prototype._setInput=function(e,t){this.outgoingChannel===C&&this.previousPrivateReceiver?(this.inputChat.setValue(this.previousPrivateReceiver+" "+e),t&&this.inputChat.setCaretPosition(this.previousPrivateReceiver.length)):this.inputChat.setValue(e),t&&this.linkHelper.undoPrepareForSending()},n.prototype.startPrivateMessage=function(e,t){t&&(e="*"+e),this.outgoingChannel===C&&e!==this.previousPrivateReceiver&&o(this.inputChat,this.previousPrivateReceiver+" "),this.previousPrivateReceiver=e,this._selectOutgoingChannel(C,!0)}},function(e,t){function i(e,t,i){for(var n=t;n<=i;n++)e[n]=!0}function n(e,t){var i=e.indexOf(l,t+1);return i<0?e.substring(t):e.substring(t,i+1)}function o(e){if(h&&e>255)return!0;var t=f[e>>16];if(void 0===t)return!1;var i=t[e>>8&255];if(i===!0)return!0;if(void 0===i)return!1;for(var n=0;n<i.length;n++){var o=i[n];if(e<o[0])break;if(e<=o[1])return!0}return!1}function s(e){return e>d||!o(e)}function a(e){return c.indexOf(e)!==-1}function r(e){var t=e.length;if(t<3||e[0]!==l||e[t-1]!==l)return e;var i=parseInt(e.substr(1,u),16);if(i.toString(16)!==e.substr(1,t-2))return e;var n=String.fromCodePoint(i);return(i<=255?a(n):o(i))?n:e}var l="~",c=l+"{}$",d=65535,u=6,h=!1,p=[],m=[],f=[p,m],g=65532;p[0]=[[10,10],[32,126],[160,255]],p[1]=!0,p[2]=[[512,591]],p[255]=[[g,g]],p[4]=!0,p[5]=[[1280,1327]];var _=240,v=246,y=249,b=249;i(m,_,v),i(m,y,b),t.getUnsendableCharacters=function(e,t){h=t&&t.allPagesAllowed;for(var i=[],n=0;n<e.length;n++){var s=e.codePointAt(n);s>65535&&n++,o(s)||i.push(String.fromCodePoint(s))}return i},t.encode=function(e,t){h=t&&t.allPagesAllowed;for(var i="",n=0;n<e.length;n++){var o=e[n];if(o.charCodeAt()>255){var r=e.substr(n,2),c=r.codePointAt();c>65535&&n++,i+=s(c)?l+c.toString(16)+l:o}else i+=a(o)?l+o.charCodeAt().toString(16)+l:o}return i},t.decode=function(e,t){h=t&&t.allPagesAllowed;for(var i="",s=0;s<e.length;s++){var a=e[s];if(a!==l){var c=a.charCodeAt();i+=o(c)?a:"�"}else{var d=n(e,s);s+=d.length-1,i+=r(d)}}return i}},function(e,t,i){var n=i(29).getText,o=i(342);t.sendMessage=function(e,t,i,s){var a=e.length-o.USER_MAX_CHAT_LEN;if(a>0)return n("tablet.chat.messageTooLong",a);var r,l={content:e};return s&&s.length>0?(r=i?"ChatClientPrivateWithObjectMessage":"ChatClientMultiWithObjectMessage",l.objects=s):r=i?"ChatClientPrivateMessage":"ChatClientMultiMessage",i?l.receiver=i:l.channel=t,window.dofus.sendMessage(r,l),""}},function(e,t,i){function n(e){return new RegExp(a("ui.chat.variable."+e).replace(/,/g,"|").replace(/ /g,""),"g")}function o(){r={},r.experience=n("experience"),r.level=n("level"),r.life=n("life"),r.maxlife=n("maxlife"),r.lifepercent=n("lifepercent"),r.myself=n("myself"),r.stats=n("stats"),r.area=n("area"),r.subarea=n("subarea"),r.position=n("position"),r.guild=n("guild"),r.achievement=n("achievement")}function s(e){var t=window.gui.playerData.characters.mainCharacter.characteristics,i=t[e];if(!i)return"?";var n=i.alignGiftBonus+i.contextModif+i.objectsAndMountBonus,o=n>0?"+":"";return i.base+" ("+o+n+")"}var a=i(29).getText,r=null;e.exports=function(e){r||o();var t=window.gui.playerData,i=t.characters.mainCharacter,n=i.characteristics;if(!n)return e;var l=n.experience-n.experienceLevelFloor,c=(n.experienceNextLevelFloor-n.experienceLevelFloor)/100,d=Math.round(l/c)+"%";e=e.replace(r.experience,d);var u=t.characterBaseInformations.level||0;e=e.replace(r.level,u);var h=n.lifePoints||0;e=e.replace(r.life,h);var p=n.maxLifePoints||0;e=e.replace(r.maxlife,p);var m=Math.min(100,Math.max(0,Math.round(h/p*100)))+"%";e=e.replace(r.lifepercent,m);var f=t.characterBaseInformations.name||"";e=e.replace(r.myself,f);var g=a("ui.chat.variable.statsresult",s("vitality"),s("wisdom"),s("strength"),s("intelligence"),s("chance"),s("agility"),s("initiative"),s("actionPoints"),s("movementPoints"));e=e.replace(r.stats,g);var _=t.position.area.nameId;e=e.replace(r.area,_);var v=t.position.subArea.nameId;e=e.replace(r.subarea,v);var y="{mapWithFlag,"+t.position.mapPosition.posX+","+t.position.mapPosition.posY+","+window.gui.playerData.position.worldmapId+"}";e=e.replace(r.position,y);var b=t.guild.current&&t.guild.current.guildName,M=b||a("ui.chat.variable.guilderror");e=e.replace(r.guild,M);var w=a("ui.chat.variable.achievementResult",t.achievements.points,t.achievements.getAchievementPercent());return e=e.replace(r.achievement,w)}},function(e,t){function i(){this.reset()}var n=50,o={message:"",links:[]};i.prototype.reset=function(){this._buffer=[],this._currentIndex=0},i.prototype.addMessage=function(e,t){this._buffer.unshift({message:e,links:t}),this._buffer.length>n&&this._buffer.pop(),this._currentIndex=0},i.prototype.removeMessage=function(){this._buffer.shift()},i.prototype.goBack=function(){this._currentIndex++},i.prototype.goForward=function(){this._currentIndex=Math.max(this._currentIndex-1,0)},i.prototype._getIndexInRange=function(){return this._currentIndex%(this._buffer.length+1)},i.prototype.getCurrentEntry=function(){var e=this._getIndexInRange();return 0===e?o:this._buffer[e-1]},e.exports=i},function(e,t,i){var n=i(342),o=i(29).getText,s=i(28),a=s.DofusDate;e.exports=function(e,t){function i(){return t=t||[],!(0===t.length||t[0].length>n.MAX_PLAYER_OR_ACCOUNT_NAME_LEN)&&(window.dofus.sendMessage("BasicWhoIsRequestMessage",{search:t[0],verbose:!0}),!0)}if(e=e.toLowerCase(),"whois"===e)return i();if("whoami"===e)return window.dofus.sendMessage("BasicWhoAmIRequestMessage",{verbose:!0}),!0;if("mapid"===e){var r=window.isoEngine.mapRenderer.mapId,l=o("ui.chat.console.currentMap",null,r);return window.gui.chat.logMsg(l),!0}if("time"===e){var c=new a(s.now()/1e3).getServerDate().toString(!0),d=o("ui.time.dateLetters",c.day,c.monthName,c.year)+" - "+c.time;return window.gui.chat.logMsg(d),!0}return!1}},function(e,t,i){function n(e){this.currentStatus=l.PLAYER_STATUS_AVAILABLE,this._createContent(e),this._setListeners()}function o(e){switch(e){case l.PLAYER_STATUS_AVAILABLE:return"available";case l.PLAYER_STATUS_IDLE:return"away";case l.PLAYER_STATUS_AFK:return"away";case l.PLAYER_STATUS_PRIVATE:return"private";case l.PLAYER_STATUS_SOLO:return"solo";default:return console.error("getClassNameFromStatus got invalid state",e),"available"}}var s=i(202),a=i(29).getText,r=i(199),l=i(593),c=i(337),d={};d[l.PLAYER_STATUS_AFK]="ui.chat.status.away",d[l.PLAYER_STATUS_IDLE]="ui.chat.status.idle",d[l.PLAYER_STATUS_PRIVATE]="ui.chat.status.private",d[l.PLAYER_STATUS_SOLO]="ui.chat.status.solo",d[l.PLAYER_STATUS_AVAILABLE]="ui.chat.status.availiable",e.exports=n,n.prototype.initialize=function(){this.currentStatus=l.PLAYER_STATUS_AVAILABLE},n.prototype._createContent=function(e){this.statusButton=e.createChild("div",{className:["statusButton","available"]});var t=this;c.addTooltip(this.statusButton,function(){return a(d[t.currentStatus])}),this.statusButton.on("tap",function(){var e=this.rootElement.getBoundingClientRect();window.gui.openContextualMenu("userStatus",null,{x:e.left+e.width,y:e.top})})},n.prototype._setCurrentStatus=function(e){e!==l.PLAYER_STATUS_IDLE&&(this.currentStatus=e),this.statusButton.replaceClassNames(["available","away","private","solo"],[o(e)])},n.prototype._setListeners=function(){var e=this;s.on("PlayerStatusUpdateMessage",function(t){t.playerId===window.gui.playerData.characterBaseInformations.id&&e._setCurrentStatus(t.status.statusId)}),r.on("inactive",function(t){var i=t?l.PLAYER_STATUS_IDLE:e.currentStatus;window.dofus.sendMessage("PlayerStatusUpdateRequestMessage",{status:{statusId:i}})})}},function(e,t,i){function n(e,t){var i=this;s.call(this,"div",{className:"CheckboxLabel",text:e}),t?(this._active=!0,this.addClassNames("on")):this._active=!1,a(this),this.on("tap",function(){this._active?(this.deactivate(),r("CHECKBOX_UNCHECKED")):(this.activate(),r("CHECKBOX_CHECKED"))}),this.on("enable",function(e){i.toggleClassName("disabled",!e)})}i(613);var o=i(172).inherits,s=i(321),a=i(197),r=i(247).playUiSound;o(n,s),e.exports=n,n.prototype.activate=function(e){this._active=!0,this.addClassNames("on"),e||(this.emit("activate"),this.emit("change",!0))},n.prototype.deactivate=function(e){this._active=!1,this.delClassNames("on"),e||(this.emit("deactivate"),this.emit("change",!1))},n.prototype.toggleActivation=function(e,t){void 0===e&&(e=!this._active),e?this.activate(t):this.deactivate(t)},n.prototype.isActivate=function(){return this._active}},function(e,t){},function(e,t,i){function n(e,t,i){i=i||{};var n=t||"",o=new w("span",{className:"externalLink",text:n});return o.addClassNames(i.className||"link"),i.html&&o.setHtml(i.html),T(o),o.on("tap",function(){A.openUrlInAppBrowser(e)}),o}function o(e,t,i,n){O.indexOf(e)===-1&&O.push(e),R.push(i),D.push(new RegExp(t)),P.push(!!n)}function s(e,t,i){o(e,t,i,!0)}function a(e,t,i,n){var o=n&&n.className||"link";if(!i)return t=t||e,void 0===i&&console.warn("Skipped not handled hyperlink: "+e),new w("span",{text:t,className:"deadLink"});var s=new w("span",{text:t,className:o});return T(s),s.on("tap",i),s}function r(e,t,i,n){var o=n&&n.className||"link",s=new w("span",{className:o});return b.getData(e,t,function(n,a){if(s.rootElement){if(n||!a)return s.replaceClassNames([o],["deadLink"]),s.setText("["+e+" "+t+"?]"),console.error("Failed getting link data: "+e+" #"+t,n);var r=i(a);if(s.setText(r[0]),!r[1])return void s.replaceClassNames([o],["deadLink"]);T(s),s.on("tap",r[1])}}),s}function l(e,t,i){return function(){M.open(e,{tabId:t,tabParams:i})}}function c(e){return r("Items",e.objectGID,function(t){var i=e.objectItem?"["+t.nameId+"]":t.nameId;return[i,function(){M.open("itemBox",e)}]},e.objectItem?{className:"insertedLink"}:null)}function d(e){e.startsWith("http://")&&(e=e.substr(7)),e.startsWith("https://")&&(e=e.substr(8));for(var t=0;t<E.length;t++)if(e.startsWith(E[t]))return!0;return!1}function u(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.objectUID===t)return n}}function h(e){var t=k.exec(e),i=t?t[2]:e;return a(e,i)}var p=i(604),m=i(366),f=i(606),g=i(615),_=i(29).getText,v=i(616),y=i(461),b=i(30),M=i(194),w=i(321),T=i(197),C=i(448),A=i(339),I=m.CHANNEL_TEAM,S=5e3,E=["www.dofus-touch.com/","support.ankama.com/"],x="\\$[a-zA-Z]+[0-9]+",N="\\{[a-zA-Z]+[^\\}]*\\}",L="<a href=[^>]+>.+</a>",O=[],D=[],R=[],P=[];t.newExternalLink=n,o(N,"\\{player,([^,]+),([0-9]+)\\}",function(e){var t=e[1];return a(e[0],t,function(){window.gui.openContextualMenu("player",{playerId:e[2],playerName:t})})}),o(N,"\\{item,([0-9]+),([0-9]+)\\}",function(e){return c({objectGID:parseInt(e[1],10),objectUID:parseInt(e[2],10)})}),s(N,"\\{itemStats,([0-9]+),([0-9]+)\\}",function(e,t){var i=parseInt(e[2],10);return c({objectGID:parseInt(e[1],10),objectUID:i,objectItem:t.objectItems?u(t.objectItems,i):null})}),s(N,"\\{recipe,([0-9]+)\\}",function(e){return r("Items",parseInt(e[1],10),function(e){var t="["+_("ui.common.recipes",1)+_("ui.common.colon")+e.nameId+"]";return[t,function(){y.getItems([e.id],function(t,i){return t?console.error("Broken link item:",e):void M.open("itemRecipes",{itemData:i[0]})})}]},{className:"insertedLink"})}),o(N,"\\{npc,([-0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[2],function(){window.isoEngine.addArrowOnNpc(parseInt(e[1],10),S)})}),o(N,"\\{monster,([-0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[2],function(){window.isoEngine.addArrowOnMonster(parseInt(e[1],10),S)})}),o(N,"\\{chattitle,([-0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[2],l("grimoire","ornaments",{titleId:e[1]}))}),o(N,"\\{chatachievement,([-0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[2],l("grimoire","achievements",{achievementId:e[1]}))}),o(N,"\\{guild,([-0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[2],function(){window.dofus.sendMessage("GuildFactsRequestMessage",{guildId:e[1]})})}),o(N,"\\{alliance,([0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[2],function(){window.dofus.sendMessage("AllianceFactsRequestMessage",{allianceId:e[1]})})}),s(N,"\\{pingsystem,([0-9]+),([a-zA-Z]+)::([^\\}]*)\\}",function(e,t){if(t.channel!==I)return null;var i=window.gui.pingSystem,n=e[0],o=e[1],s=e[2]||"",r=e[3]||"";return r=_("tablet.pingsystem.pingsystem")+_("ui.common.colon")+r,i.addPingPicto(o,s),a(n,r,function(){i.addPingPicto(o,s)})});var B={"banner,btn_items,1":function(){v.pointToMenuIcon("Bag")},"storage,slot_2,2":function(){v.pointToCharacterItem(2)},"storage,grid":function(){v.pointToStorageFirstSlotBox()}};o(N,"\\{ui,([a-zA-Z_,0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[2],B[e[1]])}),o(N,"\\{openSocial,([0-9]+),([0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[3],l("social",parseInt(e[1],10),{tabId:parseInt(e[2],10)}))}),o(x,"\\$item([0-9]+)",function(e){return c({objectGID:parseInt(e[1],10)})}),o(x,"\\$job([0-9]+)",function(e){return r("Jobs",e[1],function(e){return[e.nameId,l("grimoire","jobs",{jobId:e.id})]})}),o(x,"\\$quest([0-9]+)",function(e){return r("Quests",e[1],function(e){return[e.nameId,l("grimoire","quests",{questId:e.id,categoryId:e.categoryId})]})}),o(x,"\\$area([0-9]+)",function(e){return r("Areas",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$subarea([0-9]+)",function(e){return r("SubAreas",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$map([0-9]+)",function(e){return r("MapPositions",e[1],function(e){return[e.nameId||"["+e.posX+","+e.posY+"]",function(){window.gui.emit("CompassUpdateMessage",{type:g.COMPASS_TYPE_SIMPLE,worldX:e.posX,worldY:e.posY})}]})}),o(N,"\\{map,(-?[0-9]+),(-?[0-9]+)::([^\\}]*)\\}",function(e){var t=parseInt(e[1],10),i=parseInt(e[2],10),n=e[3]||"["+t+","+i+"]";return a(e[0],n,function(){M.open("worldMap",{x:t,y:i})})}),s(N,"\\{mapWithFlag,(-?[0-9]+),(-?[0-9]+),(-?[0-9]+)\\}",function(e,t){var i=parseInt(e[1],10),n=parseInt(e[2],10),o=parseInt(e[3],10),s="["+i+","+n+"]";return a(e[0],s,function(){o===window.gui.playerData.position.worldmapId&&(M.open("worldMap",{x:i,y:n}),window.gui.GPS.addPOI({id:"flag_srv"+g.COMPASS_TYPE_SIMPLE,x:i,y:n,categoryId:"hint",nameId:"("+i+","+n+")",color:{r:255,g:134,b:0,a:1},isDestination:!1}))},t.cameViaChat?{className:"insertedLink"}:null)}),o(x,"\\$itemType([0-9]+)",function(e){return r("ItemTypes",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$achievement([0-9]+)",function(e){return r("Achievements",e[1],function(t){return[t.nameId,l("grimoire","achievements",{achievementId:e[1]})]})}),o(x,"\\$title([0-9]+)",function(e){return r("Titles",e[1],function(t){var i=window.gui.playerData.characterBaseInformations.sex?t.nameFemaleId:t.nameMaleId;return[i,l("grimoire","ornaments",{titleId:e[1]})]})}),o(x,"\\$ornament([0-9]+)",function(e){return r("Ornaments",e[1],function(t){return[t.nameId,l("grimoire","ornaments",{ornamentId:e[1]})]})}),o(x,"\\$spell([0-9]+)",function(e){return r("Spells",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$spellState([0-9]+)",function(e){return r("SpellStates",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$breed([0-9]+)",function(e){return r("Breeds",e[1],function(e){return[e.shortNameId,null]})}),o(x,"\\$emote([0-9]+)",function(e){return r("Emoticons",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$monster([0-9]+)",function(e){return r("Monsters",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$monsterRace([0-9]+)",function(e){return r("MonsterRaces",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$monsterSuperRace([0-9]+)",function(e){return r("MonsterSuperRaces",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$alignment([0-9]+)",function(e){return r("AlignmentSides",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$stat([0-9]+)",function(e){var t=_("ui.item.characteristics").split(",");return a(e[0],t[e[1]],null)}),o(x,"\\$dungeon([0-9]+)",function(e){return r("Dungeons",e[1],function(e){return[e.nameId,null]})}),o(x,"\\$challenge([0-9]+)",function(e){return r("Challenge",e[1],function(e){return[e.nameId,null]})}),s(L,"<a href=([^>]+)>(.+)</a>",function(e,t){var i=e[1],o=e[2];return'"'!==i[0]&&"'"!==i[0]||(i=i.slice(1,-1)),t.isChannelSafe||d(i)?n(i,null,{html:o}):null}),o(N,"\\{style:([a-zA-Z]+),([^\\}]*)\\}",function(e){return new w("span",{text:e[2],className:e[1]})}),o(N,"\\{myShop::([^\\}]*)\\}",function(e){return a(e[0],e[1],function(){window.dofus.sendMessage("ExchangeRequestOnShopStockMessage")})}),o(N,"\\{windowTab,([a-zA-Z_,0-9]+),([a-zA-Z_,0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[3],function(){M.open(e[1],{tabId:e[2]})})}),o(N,"\\{window,([a-zA-Z_,0-9]+)::([^\\}]*)\\}",function(e){return a(e[0],e[2],function(){return"bidHouseShop"===e[1]?C.openBidHouse(!1):void M.open(e[1])})});var k=/\{([a-zA-Z_,0-9\-]+)::([^}]*)\}/,z=new RegExp(O.join("|"));t.process=function(e,t){t=t||{};for(var i=t.channel,n=void 0!==i&&p.isHumanChannel(i),o=!n||p.isChannelSafe(i),s={allPagesAllowed:t.decodeAllPages},a={cameViaChat:n,channel:i,isChannelSafe:o,objectItems:t.objectItems},r=new w("span");;){var l=z.exec(e);if(!l)break;for(var c,d=l[0],u=e.indexOf(d),m=e.substr(0,u),g=e.substr(u+d.length),_=null,v=0;v<R.length;v++)if((o||P[v])&&(c=D[v].exec(d))){_=R[v](c,a);break}_||(_=h(d)),m&&(n&&(m=f.decode(m,s)),r.createChild("span").setHtml(m)),r.appendChild(_),e=g}return e&&(n&&(e=f.decode(e,s)),r.createChild("span").setHtml(e)),r}},function(e,t){e.exports={COMPASS_TYPE_SIMPLE:0,COMPASS_TYPE_SPOUSE:1,COMPASS_TYPE_PARTY:2,COMPASS_TYPE_PVP_SEEK:3,
COMPASS_TYPE_QUEST:4}},function(e,t,i){var n=i(194);t.pointToWindowCloseButton=function(e){var t=n.getWindow(e);if(t.openState){var i,o,s=t.closeButton.rootElement,a=s.getBoundingClientRect();i=a.left+a.width/2,o=a.top+a.height/2,window.gui.hintArrow.showArrow(i,o,"upRight")}},t.pointToMenuIcon=function(e){var t=window.gui.menuBar.getIcon(e),i=t.rootElement,n=i.getBoundingClientRect(),o=n.left+10,s=n.top+10;window.gui.hintArrow.showArrow(o,s,"downRight")},t.pointToNpcAnswer=function(e){var t=window.gui.npcDialogUi;if(t.isVisible()){var i=t.replyElts[e];if(i){var n=i.rootElement,o=n.getBoundingClientRect(),s=o.left+Math.round(.3*o.width),a=o.top+Math.round(.3*o.height);window.gui.hintArrow.showArrow(s,a,"downRight")}}},t.pointToTimelineButton=function(e){var t=window.gui.timeline.fightControlButtons,i=t.getButtonRectForTuto(e);if(i){var n=i.left+Math.round(.5*i.width),o=i.top+Math.round(.3*i.height);window.gui.hintArrow.showArrow(n,o,"upLeft")}},t.pointToFirstSkillShortcut=function(){var e=window.gui.shortcutBar;e.openPanel("spell");var t=e.getSlot("spell",0),i=t.rootElement,n=i.getBoundingClientRect(),o=n.left+25,s=n.top+25;window.gui.hintArrow.showArrow(o,s,"downRight")};var o=0;t.pointToEquipFilterIcon=function(){var e=n.getWindow("equipment");if(e.openState){var t=e.storageView,i=t.filter,s=i.filterBtnMap,a=s[o],r=a.rootElement,l=r.getBoundingClientRect(),c=l.left+Math.round(.5*l.width),d=l.top+Math.round(.5*l.height);window.gui.hintArrow.showArrow(c,d,"upLeft")}},t.pointToCharacterItem=function(e){var t=n.getWindow("equipment");if(t.openState){var i=t.getEquipmentSlots(),o=i[e],s=o.rootElement,a=s.getBoundingClientRect(),r=a.left+a.width/2,l=a.top+a.height/2;window.gui.hintArrow.showArrow(r,l,"upLeft")}},t.pointToStorageFirstSlotBox=function(){var e=n.getWindow("equipment");if(e.openState){var t=e.storageView,i=t.slotsContainer.rootElement,o=i.getBoundingClientRect(),s=o.left+10,a=o.top+10;window.gui.hintArrow.showArrow(s,a,"downRight")}}},function(e,t,i){function n(){this.linksToReplace=[],this.previousLinks=[]}function o(e){var t=[],i=e.isItemInstance;if(i)for(var n=0;n<e.effects.length;n++){var o=e.effects[n];o&&t.push(o.serialize())}return{_type:"ObjectItem",position:i?e.position:0,objectGID:i?e.objectGID:e.id,objectUID:i?e.objectUID:0,effects:t,quantity:i?e.quantity:1}}var s=i(29).getText,a=i(342),r="￼";e.exports=n,n.OBJ_REPL_CHAR=r,n.prototype.newLinkForSending=function(e,t){var i,n,o;switch(e){case"recipe":i="["+s("ui.common.recipes",1)+s("ui.common.colon")+t.getName()+"]",n="{recipe,"+t.getProperty("id")+"}";break;case"itemStats":if(this.linksToReplace.length>=a.MAX_CHAT_OBJECT_REF)return;i="["+t.getName()+"]",n=r,o=t;break;default:return console.error(new Error("Invalid link type: "+e))}return this.linksToReplace.push([i,n,o]),i},n.prototype.prepareForSending=function(e,t){for(var i=0;i<this.linksToReplace.length;i++){var n=this.linksToReplace[i],s=e.replace(n[0],n[1]);n[2]&&s!==e&&t.push(o(n[2])),e=s}return this.previousLinks=this.linksToReplace,this.linksToReplace=[],e},n.prototype.undoPrepareForSending=function(){this.linksToReplace=this.previousLinks},n.prototype.replaceLinksReceived=function(e,t){for(var i=0;i<t.length;i++){var n=t[i],o="{itemStats,"+n.objectGID+","+n.objectUID+"}";e=e.replace(r,o)}return e}},function(e,t,i){function n(){this._whoIsMap={},this._setEventListeners()}var o=i(366),s=i(607),a=i(619),r=i(183),l="#{",c="}",d=",",u=2e3;e.exports=n,n.prototype.processMsg=function(e,t){if(e.channel!==o.PSEUDO_CHANNEL_PRIVATE)return!1;var i=e.content;if(i.substr(0,l.length)!==l)return!1;if(i.substr(i.length-c.length)!==c)return!1;if(t)return!0;var n=i.substring(l.length,i.length-c.length),s=n.split(d);switch(s[0]){case"rejoinRequest":var a=parseInt(s[1],10);window.gui.playerData.partyData.handleRejoinRequest(a,e.senderId);break;default:window.dofus.sendMessage("IgnoredAddRequestMessage",{name:e.senderName,session:!0}),console.error("Ignoring player "+e.senderName+" who sent invalid p2p command: "+e.content)}return!0},n.prototype.sendMsg=function(e,t){for(var i=l+t,n=2;n<arguments.length;n++)i+=d+arguments[n].toString();i+=c,s.sendMessage(i,o.PSEUDO_CHANNEL_PRIVATE,e)},n.prototype.checkPlayerOnline=function(e,t){var i=this._whoIsMap[e];i?i.cbs.push(t):(window.dofus.sendMessage("BasicWhoIsRequestMessage",{search:e,verbose:!1}),this._whoIsMap[e]={cbs:[t],timeout:r.setTimeout(this._playerOnlineHandler.bind(this,e,!1),u)})},n.prototype._playerOnlineHandler=function(e,t){var i=this._whoIsMap[e];delete this._whoIsMap[e],r.clearTimeout(i.timeout);for(var n=i.cbs,o=0;o<n.length;o++)n[o](e,t)},n.prototype._setEventListeners=function(){var e=this;window.gui.on("disconnect",function(){e._whoIsMap={}}),window.dofus.connectionManager.on("BasicWhoIsMessage",function(t){t.verbose||e._whoIsMap[t.playerName]&&e._playerOnlineHandler(t.playerName,t.playerState!==a.NOT_CONNECTED)})}},function(e,t){e.exports={NOT_CONNECTED:0,GAME_TYPE_ROLEPLAY:1,GAME_TYPE_FIGHT:2,UNKNOWN_STATE:99}},function(e,t,i){var n=i(29).getText,o=i(621),s=i(619);e.exports=function(e){var t;t=e.areaId!==-1?e._areaName:n("ui.common.unknowArea");var i="{player,"+e.playerName+","+e.playerId+"}";e.position===o.MODERATOR?i+="("+n("ui.common.moderator")+")":e.position===o.GAMEMASTER_PADAWAN?i+="("+n("ui.common.gameMasterAssistant")+")":e.position===o.GAMEMASTER?i+="("+n("ui.common.gameMaster")+")":e.position===o.ADMIN&&(i+="("+n("ui.common.administrator")+")");var a=n("ui.common.whois",e.accountNickname,i,t);if(e.socialGroups&&e.socialGroups.length>0)for(var r=0,l=e.socialGroups.length;r<l;r+=1){var c=e.socialGroups[r];"GuildInformations"===c._type&&(a+=" "+n("ui.common.guild")+" {guild,"+c.guildId+"::"+c.guildName+"}"),"AllianceInformations"===c._type&&(a+=" "+n("ui.common.alliance")+" {alliance,"+c.allianceId+"::["+c.allianceTag+"]}")}return e.playerState===s.NOT_CONNECTED&&(a+=" ("+n("tablet.common.disconnected")+")"),a}},function(e,t){e.exports={UNAVAILABLE:-1,PLAYER:0,MODERATOR:10,GAMEMASTER_PADAWAN:20,GAMEMASTER:30,ADMIN:40}},function(e,t,i){function n(e,t){function i(t){if(!h&&r(e)){h=!0,p.w=f.w=e.rootElement.clientWidth,p.h=f.h=e.rootElement.clientHeight;var i=a(t);m.x=i.x,m.y=i.y,e.emit("resizeStart"),window.gui.wBody.once("dom.touchend",s),window.gui.wBody.on("dom.touchmove",n),n(t)}}function n(t){var i=a(t),n=i.x-m.x,s=i.y-m.y;g&&(n=0),f.w=p.w+n,f.h=p.h+s,f.w=Math.min(Math.max(f.w,d),o.windowFullScreenWidth),f.h=Math.min(Math.max(f.h,u),o.windowFullScreenHeight),e.setStyles({width:f.w+"px",height:f.h+"px"})}function s(){window.gui.wBody.removeListener("dom.touchmove",n),h=!1,e.windowWidth=f.w,e.windowHeight=f.h,e.emit("resize")}t=t||{};var d=t.minWidth||l,u=t.minHeight||c;e.resizeHandle=e.createChild("div",{className:"resizeHandle"}),e.resizeHandle.allowDomEvents();var h=!1,p={w:null,h:null},m={x:null,y:null},f={w:null,h:null},g=!1;e.setWidthLock=function(e){g=!!e},e.resizeHandle.on("dom.touchstart",i)}i(623);var o=i(166).dimensions,s=i(198),a=s.getPosition,r=i(200).requestInteractionHandle,l=300,c=300;e.exports=n},function(e,t){},function(e,t,i){function n(e){for(var t=["&","%","?","#","§","!"],i=t.length,n="",o=0;o<e;o++){var s=Math.floor(Math.random()*i);n+=t[s]}return n}function o(){var e=this;this.censoredMap={},s.getAllDataMap("CensoredWords",function(t,i){t&&console.error("Censor getAllDataMap:",t);var n=window.Config.language;for(var o in i)i[o].language===n&&(e.censoredMap[i[o].word]=!0)})}var s=i(30),a=i(176);e.exports=o,o.prototype.filterCensoredWords=function(e){if(!a.getValue("option-censorship",!0))return e;for(var t=e.split(" "),i=0;i<t.length;i++)this.censoredMap[t[i].toLowerCase()]&&(t[i]=n(t[i].length));return t.join(" ")}},function(e,t,i){function n(){r.call(this,"div",{className:"ChatButton"});var e=this.createChild("div",{className:"buttonChatPicto"});e.appendChild(new l({className:"buttonChatTouchZone"},function(){window.gui.chat.active?window.gui.chat.deactivate():window.gui.chat.activate()}));var t=this;window.gui.on("resize",function(){if(this.ipadRatio)t.setStyles({left:s.posChatBtn+"px",right:"auto",top:"auto",bottom:0,width:o.CHAT_BTN_MIN_WIDTH+"px",height:s.bottomBarHeight+"px"});else{var e,i;e=s.sideBarWidth-o.PING_EMOTE_BTN_WIDE_MIN_WIDTH,i=o.PING_EMOTE_BTN_WIDE_MIN_WIDTH,t.setStyles({left:"auto",right:i+"px",top:s.posChatBtn+"px",bottom:"auto",width:e+"px",height:o.CHAT_BTN_MIN_HEIGHT+"px"})}})}i(626);var o=i(167),s=i(166).dimensions,a=i(172).inherits,r=i(321),l=i(335);a(n,r),e.exports=n},function(e,t){},function(e,t,i){function n(e){var t=e.role,i=c.setupNames(e.otherId,e.initiatorId);return i?(u=i.sourceName,h=i.targetName,c.setupCancelPopupTexts({title:l("ui.common.exchange"),message:l("ui.craft.waitForCraftClient",h)}),t===r.MULTICRAFT_CUSTOMER?c.setupConfirmPopupTexts({title:l("ui.common.exchange"),message:l("ui.craft.CrafterAskCustomer",u)}):t===r.MULTICRAFT_CRAFTER&&c.setupConfirmPopupTexts({title:l("ui.common.exchange"),message:l("ui.craft.CustomerAskCrafter",u)}),void c.askingExchangePopup()):console.error("MultiCraft: setupNames")}function o(e){var t=e.skillId,i=window.gui.playerData.jobs;i.prepareSkillRecipes(t,function(n){if(n)return console.error("Craft: prepareSkillRecipes",t,n);var o=i.getCraftType(t),s="craftMagus"===o?"craftMagus":"crafting";d.openDialog([s,"craftInventory"],{type:o,msg:e})})}function s(e,t){var i=e.skillId,n=window.gui.playerData.jobs;n.prepareSkillRecipes(i,function(o){if(o)return console.error("MultiCraft: prepareSkillRecipes",i,o);var s=n.getCraftType(i),a="craftMagus"===s?"craftMagusMulti":"craftingMulti";d.continueDialog([a,"craftInventory"],{type:s,isCrafter:t.isCrafter,sourceName:u,targetName:h,msg:e})})}var a=i(628),r=i(578),l=i(29).getText,c=i(629),d=i(194);t.SMITHMAGIC_RUNE_ID=78,t.SMITHMAGIC_POTION_ID=26,t.SIGNATURE_RUNE_ID=7508,t.SIGNATURE_AVAILABLE_LEVEL=100;var u="",h="";t.initialize=function(e){e.on("ExchangeOkMultiCraftMessage",n),e.on("ExchangeStartOkCraftWithInformationMessage",o),e.on("ExchangeStartOkMulticraftCrafterMessage",function(e){s(e,{isCrafter:!0})}),e.on("ExchangeStartOkMulticraftCustomerMessage",function(e){s(e,{isCrafter:!1})})},t.displayAutoCraftStopReasonMessage=function(e){var t="",i=!0;switch(e){case a.STOPPED_REASON_OK:t=l("ui.craft.autoCraftStopedOk");break;case a.STOPPED_REASON_USER:t=l("ui.craft.autoCraftStoped"),i=!1;break;case a.STOPPED_REASON_MISSING_RESSOURCE:t=l("ui.craft.autoCraftStopedNoRessource");break;case a.STOPPED_REASON_IMPOSSIBLE_CRAFT:t=l("ui.craft.autoCraftStopedInvalidRecipe")}var n=window.gui;i&&n.openSimplePopup(t,l("ui.popup.information")),t&&n.chat.logMsg(t)}},function(e,t){e.exports={STOPPED_REASON_OK:1,STOPPED_REASON_USER:2,STOPPED_REASON_MISSING_RESSOURCE:3,STOPPED_REASON_IMPOSSIBLE_CRAFT:4}},function(e,t,i){function n(e){function t(){var t={title:s.title,message:s.message,cb:function(){r&&r()}};h.getWindow("cancel").update(t,{keepDialog:e}),h.openDialog(["cancel"])}function i(){var t={title:o.title,message:o.message,cb:function(e){e===n.NO?a.refuse&&a.refuse():e===n.IGNORE?a.ignore&&a.ignore():a.confirm&&a.confirm()}};h.getWindow("confirm").update(t,{ignoreEnable:!0,keepDialog:e}),h.openDialog(["confirm"])}var n=h.getWindow("confirm").actionsEnum;u?t():i()}var o,s,a,r,l,c,d,u,h=i(194);t.askingExchangePopup=function(){a={confirm:function(){window.dofus.sendMessage("ExchangeAcceptMessage")},refuse:void 0,ignore:function(){window.dofus.sendMessage("IgnoredAddRequestMessage",{name:l,session:!0})}},r=void 0,n(!0)},t.askingChallengePopup=function(e){function t(){window.dofus.sendMessage("GameRolePlayPlayerFightFriendlyAnswerMessage",{fightId:e,accept:!0})}function i(){window.dofus.sendMessage("GameRolePlayPlayerFightFriendlyAnswerMessage",{fightId:e,accept:!1})}function o(){i(),window.dofus.sendMessage("IgnoredAddRequestMessage",{name:l,session:!0})}a={confirm:t,refuse:i,ignore:o},r=i,n(!1)},t.closingChallengePopup=function(e){var t=e?"cancel":"confirm",i=h.getWindow(t);h.close(i.id)},t.setupCancelPopupTexts=function(e){s=e},t.setupConfirmPopupTexts=function(e){o=e},t.setupNames=function(e,t){var i=window.gui.playerData;c=i.id,d=i.characterBaseInformations.name,u=t===c;var n=window.actorManager.getActor(u?e:t);if(!n)return null;var o=n.data.name;l=u?d:o;var s=u?o:d;return{sourceName:l,targetName:s}}},function(e,t,i){function n(){a.call(this,"div",{className:"TextNotification"});var e=this;window.gui.on("resize",function(){e.setStyles({left:o.mapLeft+l+"px",bottom:o.screenHeight-o.mapBottom+l+"px"})}),this.mutedChannelsId={};for(var t in c)this.mutedChannelsId[r[t]]=!0}i(631);var o=i(166).dimensions,s=i(172).inherits,a=i(321),r=i(366),l=10,c={PSEUDO_CHANNEL_FIGHT_LOG:!0};s(n,a),e.exports=n,n.prototype.add=function(e,t){function i(e){e.delClassNames("on"),setTimeout(function(){e.destroy()},300)}t=t||{};var n=this.createChild("div",{className:"bubble"}),o=n.createChild("div",{className:"bubbleText"});n.addClassNames(t.className);var s=t.channel;void 0===s&&(s=r.PSEUDO_CHANNEL_INFO),n.addClassNames("channel"+s),"object"==typeof e?o.appendChild(e):o.setHtml(e.toString()),setTimeout(function(){n.addClassNames("on")},50),setTimeout(function(){n.rootElement&&i(n)},7e3)}},function(e,t){},function(e,t,i){function n(e){o.getAllDataMap(s,function(t,i){return t?e(t):(window.gui.databases=i,void e())})}var o=i(30),s=["AlignmentGift","AlignmentRankJntGift","AlignmentSides","AlmanaxCalendars","Areas","BidHouseCategories","Breeds","ChatChannels","Incarnation","IncarnationLevels","ItemTypes","Months","MountBehaviors","OptionalFeatures","QuestObjectiveTypes","RankNames","Smileys","SpellStates","SpellTypes","SuperAreas","TypeActions","WorldMaps"];e.exports.load=n},function(e,t,i){function n(){u.call(this,"div",{className:"shopFloatingToolbar"}),r(this,{grip:this}),this.appendChild(new s({className:"shopBtn"},o));var e=this,t=window.gui;t.once("resize",function(){t.ipadRatio?e.setStyles({left:a.mapRight+"px",top:"30px"}):e.setStyles({left:a.mapRight-80+"px",top:"0px"})}),t.on("connected",function(){e.show()}),t.on("disconnect",function(){e.hide()}),t.fightManager.on("fightStart",function(){e.hide()}),t.fightManager.on("fightEnd",function(){e.show()})}function o(){c.open("market",{tabId:"shop"});var e=this.rootElement.getBoundingClientRect();d.log("HUD.Click_on_button",{interface_id:"ShopFloatingToolbar",button_id:"BTN_IG_SHOP",clic_parameter_key:"position",clic_parameter_value:~~e.left+","+~~e.top,clic_type:"Simple_court"})}i(634);var s=i(335),a=i(166).dimensions,r=i(598),l=i(172).inherits,c=i(194),d=i(7),u=i(321);l(n,u),e.exports=n},function(e,t){},function(e,t,i){function n(){var e=this,t=window.gui;s.call(this),this._POIMap={},this._lastPhoenixes=[],a.init(this),c.init(),t.on("disconnect",this._sweep.bind(this)),t.playerData.position.on("worldMapUpdate",function(){e.changeMap(this.worldmapId)})}function o(e,t){d.getData("MapPositions",e,function(i,n){return i?console.error("GPS getObjectiveCoords: cannot load MapPositions from mapId "+e,i):n.subAreaId?void d.getData("SubAreas",n.subAreaId,function(i,o){if(i)return console.error("GPS getObjectiveCoords: cannot load SubAreas "+n.subAreaId,i);var s,a=o.entranceMapIds||[],r=o.exitMapIds||[],l=window.gui.databases,c=l.Areas[o.areaId],u=l.SuperAreas[c.superAreaId],h=o.customWorldMap[0]||u.worldmapId,p=window.gui.playerData.position.worldmapId;return p!==h&&(s=p===m?a[0]:r[0]),void 0===s?t({x:n.posX,y:n.posY,mapId:e}):void d.getData("MapPositions",s,function(e,i){return e?console.error("GPS getObjectiveCoords: cannot load MapPositions from mapId "+s,e):void t({x:i.posX,y:i.posY,mapId:s})})}):t({x:n.posX,y:n.posY,mapId:e})})}var s=i(188).EventEmitter,a=i(636),r=i(172).inherits,l=i(638),c=i(639),d=i(30),u=i(171),h=i(29).getText,p=i(640),m=1,f=2,g=12,_="fixed";r(n,s),n.prototype._requestUpdatePOI=function(e,t,i,n,o){e.x===i&&e.y===n||(e.x=i,e.y=n,o&&(e.nameId=o),this.emit("updatePOI",e,t))},n.prototype._updatePOI=function(e){e=e||{};var t=this,i=e.id,n=e.x,o=e.y,s=e.nameId,a=window.gui.playerData.position.worldmapId,r=this.getPOI(i,a);r?this._requestUpdatePOI(r,a,n,o,s):void 0===n&&void 0===o?t.removePOI(i,a):(delete e.mapId,this.addPOI(e))},n.prototype._validateWorldMapId=function(e){var t=window.gui.databases.WorldMaps[e];return t||e===_?(this._POIMap[e]||(this._POIMap[e]={}),t?t.id:e):void console.warn("World map",e,"does not exist.")},n.prototype._redrawCompass=function(){window.gui.compass.updateMarkersPositions()},n.prototype._enableTracking=function(e,t,i){i=void 0===i||i;var n=this.getPOI(e,t),o=window.gui.compass;i?o.addMarker({type:e,x:n.x,y:n.y,arrowType:n.categoryId,tooltip:n.nameId}):o.removeMarker(e)},n.prototype._getMapPosition=function(e,t){return void 0===e?t():void d.getData("MapPositions",e,function(e,i){return e?t(e):void t(null,i)})},n.prototype._requestGuildInfo=function(){if(window.gui.playerData.guild.hasGuild())for(var e in p){var t=p[e];window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:t})}},n.prototype._sweep=function(){for(var e in this._POIMap){var t=this._POIMap[e];for(var i in t)this.removePOI(i,e)}},n.prototype._isDungeonMap=function(e){return e!==f&&e!==m&&e!==g},n.prototype.addPOI=function(e){function t(t){if(t||void 0!==e.x&&void 0!==e.y){t=t||{};var n=void 0!==t.posX?t.posX:e.x,o=void 0!==t.posY?t.posY:e.y,s=new l(e);s.x=n,s.y=o;var a=window.gui.playerData.position.worldmapId,r=t.worldMap!==-1?t.worldMap||a:a;i._validateWorldMapId(r);var c=i._POIMap[r][s.id];if(c)return i._requestUpdatePOI(c,r,n,o);i._POIMap[r][s.id]=s,s.isDestination&&i.addDestination(s.id,r),i.emit("addPOI",s,r)}}var i=this;if(e=e||{},0===window.gui.playerData.position.worldmapId)return window.gui.playerData.position.once("mapUpdate",function(){i.addPOI(e)});var n=e.mapId;if(n)this._getMapPosition(n,function(e,i){return e?console.error(e):void t(i)});else if("questObjective"===e.categoryId)t({worldMap:m});else{var o=window.gui.playerData.position.worldmapId;t({worldMap:o})}},n.prototype.removePOI=function(e,t){if(void 0!==t){if(t=this._validateWorldMapId(t),void 0===t||!this.getPOI(e,t))return;this.removeDestination(e,t),delete this._POIMap[t][e],this.emit("removePOI",e,t)}else for(var i in this._POIMap)this.removePOI(e,i);this._POIMap[_]&&this._POIMap[_][e]&&delete this._POIMap[_][e]},n.prototype.changeMap=function(e){function t(e){var t=s._POIMap[e];if(t)for(var i in t)o=t[i],o.isDestination&&s._enableTracking(i,s._lastWorldMapId,!1)}function i(e){for(var t in s._POIMap[e])o=s._POIMap[e][t],o.isDestination&&(s._enableTracking(t,e),a.push(o.id))}if(void 0!==e){var n,o,s=this;this._isDungeonMap(e)||this._requestGuildInfo();for(n in this._POIMap[_])o=this._POIMap[_][n],this.removePOI(n,this._lastWorldMapId),o.mapId=0,this.addPOI(o);t(this._lastWorldMapId);var a=[];i(e);var r=window.gui.compass;for(n in r.markers)a.indexOf(n)===-1&&r.removeMarker(n);this._redrawCompass(),this.emit("changedMap",e),this._lastWorldMapId=e}},n.prototype.getPOI=function(e,t){if(void 0!==t&&this._validateWorldMapId(t))return this._POIMap[t][e];var i,n,o;for(n in this._POIMap){var s=this._POIMap[n];for(i in s)i===e&&(o=o||{},o[n]=o[n]||{},o[n][i]=s[i])}return o},n.prototype.getPOIs=function(e){var t={};e=e||window.gui.playerData.position.worldmapId,t=this._POIMap[this._validateWorldMapId(e)];for(var i in this._fixedPOIMap)t[i]=this._fixedPOIMap[i];return t},n.prototype.addDestination=function(e,t){if(t=this._validateWorldMapId(t),void 0!==t){var i=this.getPOI(e,t);i.isDestination=!0,t===window.gui.playerData.position.worldmapId&&(this._enableTracking(e,t),this._redrawCompass()),this.emit("addDestination",i,t)}},n.prototype.removeDestination=function(e,t){if(t=this._validateWorldMapId(t),void 0!==t){var i=this.getPOI(e,t);i.isDestination=!1,t===window.gui.playerData.position.worldmapId&&(this._enableTracking(e,t,!1),this._redrawCompass()),this.emit("removeDestination",e,t)}},n.prototype.getQuestObjectivePoiId=function(e){return"quest_"+e},n.prototype.addQuestObjectiveFromObjective=function(e){e=e||{};var t=e.objectiveDb,i=e.objectiveId,n=e.questId,s=e.coords||null,a=this,r=this.getQuestObjectivePoiId(i);if(!this.getPOI(r)){var l=t.mapId;if(!s){if(l)return o(l,function(e){e=e||t.coords,a.addQuestObjectiveFromObjective({objectiveDb:t,objectiveId:i,coords:e,questId:n})});s=t.coords}if(s&&void 0!==s.x&&void 0!==s.y){for(var c=window.gui.playerData.quests.all[n],d=c.dbQuest.nameId,u="",h=0;h<c.objectives.length;h++){var p=c.objectives[h];if(p.objectiveId===i){u=p.text;break}}var m={id:r,x:s.x,y:s.y,mapId:l,nameId:d+"\n\n"+u+"\n\n("+s.x+","+s.y+")",categoryId:"questObjective",color:{r:102,g:204,b:0,a:1},isDestination:!0};this.addPOI(m)}}},n.prototype.addQuestObjective=function(e,t){if(!window.gui.playerData.isFighting){var i=window.gui.playerData.quests;if(!i[e])return console.warn("GPS.addQuestObjective: quest id"+e+" is not active.");var n=i[e].dbObjectives[t];this.addQuestObjectiveFromObjective({objectiveDb:n,objectiveId:t,questId:e})}},n.prototype.addQuestNextObjective=function(e){if(!window.gui.playerData.isFighting){var t=window.gui.playerData.quests;if(!t.active[e])return console.warn("GPS.addQuestNextObjective: quest id"+e+" is not active.");for(var i=t.active[e],n=0;n<i.objectives.length;n++){var o=i.objectives[n];if(o.objectiveStatus){var s=o.objectiveId,a=i.dbObjectives[s];this.addQuestObjectiveFromObjective({objectiveDb:a,objectiveId:s,questId:e})}}}},n.prototype.removeQuestObjectives=function(e){var t=window.gui.playerData.quests.all[e];if(!t)return console.warn("GPS.removeQuestObjectives: quest id"+e+" not found.");for(var i=0;i<t.objectives.length;i++){var n=t.objectives[i];if(n.objectiveStatus){var o=n.objectiveId,s=this.getQuestObjectivePoiId(o);this.removePOI(s)}}},n.prototype.addAllQuestsObjectives=function(){var e=window.gui.playerData.quests;for(var t in e.active)this.addQuestNextObjective(t)},n.prototype.addAllFollowedQuestsObjectives=function(){var e=window.gui.playerData.quests;for(var t in e.active)this.questFollower.isQuestFollowed(t)&&this.addQuestNextObjective(t)},n.prototype.isAtLeastOneQuestObjectiveFollowed=function(e){var t=window.gui.playerData.quests.active[e];if(!t)return console.warn("GPS.isAtLeastOneQuestObjectiveFollowed: quest id"+e+" not active."),!1;for(var i=0;i<t.objectives.length;i++){var n=t.objectives[i];if(n.objectiveStatus){var o=n.objectiveId,s=this.getQuestObjectivePoiId(o);if(this.getPOI(s))return!0}}return!1},n.prototype.addCustomFlag=function(e,t){this.addPOI({id:"customFlag_"+e+"_"+t,x:e,y:t,categoryId:"customFlag",nameId:h("ui.cartography.customFlag")+"\n\n("+e+","+t+")",color:{r:255,g:221,b:0,a:1},isDestination:!0})},n.prototype.removeCustomFlag=function(e,t){this.removePOI("customFlag_"+e+"_"+t)},n.prototype.autoGpsFlagOptionUpdate=function(){u.autoGpsFlags?this.addAllFollowedQuestsObjectives():this._sweep()},n.prototype.questFollower=c,e.exports=n},function(e,t,i){function n(e){function t(t){var i={id:"house_"+t.houseId,mapId:t.mapId,categoryId:_,nameId:l("ui.common.myHouse"),iconId:p};e.addPOI(i)}function i(t){c.getData("Houses",t.modelId,function(i,n){if(i)return console.error(i);var o={id:"guild_house_"+t.houseId,mapId:t.mapId,categoryId:_,nameId:l("ui.common.guildHouse")+l("ui.common.colon")+n.nameId,iconId:m};e.addPOI(o)})}function n(t){var i={id:"guild_paddock_"+t.paddockId,mapId:t.mapId,categoryId:_,nameId:l("ui.guild.paddock",t.maxOutdoorMount),iconId:f};e.addPOI(i)}var o=window.gui;o.on("AccountHouseMessage",function(e){e.houses.forEach(function(e){t(e)})}),o.on("GuildHousesInformationMessage",function(e){e.housesInformations.forEach(function(e){i(e)})}),o.on("GuildHouseUpdateInformationMessage",function(e){i(e.housesInformations)}),o.on("GuildHouseRemoveMessage",function(t){e.removePOI("guild_house_"+t.houseId)}),o.on("GuildInformationsPaddocksMessage",function(e){e.paddocksInformations.forEach(function(e){n(e)})}),o.on("GuildPaddockBoughtMessage",function(e){n(e.paddockInfo)}),o.on("GuildPaddockRemovedMessage",function(t){e.removePOI("guild_paddock_"+t.paddockId)})}function o(e){var t=window.gui;t.on("AtlasPointInformationsMessage",function(i){if(i.type.type===u.ATLAS_INFOS_PHOENIX){var n;if(this.playerData.isAlive())for(n=0;n<e._lastPhoenixes.length;n+=1)e.removePOI("phoenix_"+e._lastPhoenixes[n].mapId);else{var o=i.type.coords;for(n=0;n<o.length;n+=1){var s=o[n],a={id:"phoenix_"+s.mapId,mapId:s.mapId,categoryId:"phoenix",x:s.worldX,y:s.worldY,nameId:l("ui.common.phoenix"),iconId:g,isDestination:!0};e.addPOI(a)}e._lastPhoenixes=o}t.compass.updateMarkersPositions()}})}function s(e){var t=window.gui,i=t.playerData.quests;i.on("objectiveValidated",function(t,i){e.removePOI(e.getQuestObjectivePoiId(i))}),i.on("stepValidated",function(t,i){for(var n=t.dbSteps[i],o=0;o<n.objectiveIds.length;o+=1)e.removePOI(e.getQuestObjectivePoiId(n.objectiveIds[o]))}),i.on("questFinished",function(t){for(var i=t.dbSteps[t.stepId],n=0;n<i.objectiveIds.length;n+=1)e.removePOI(e.getQuestObjectivePoiId(i.objectiveIds[n]))}),i.on("questUpdate",function(t){e.questFollower.isQuestFollowed(t)&&e.addQuestNextObjective(t)}),i.on("questStarted",function(t){d.autoGpsFlags&&e.questFollower.followQuest(t,!0)}),i.on("listUpdated",function(){e.addAllFollowedQuestsObjectives()})}function a(e){function t(t){var i={id:"spouse_"+t.spouseId,mapId:t.mapId,categoryId:v,nameId:l("ui.cartography.positionof",t.spouseName),color:{r:255,g:0,b:137,a:1},isDestination:!0};e.addPOI(i),e._lastSpouseId=t.spouseId}var i=window.gui;i.on("SpouseStatusMessage",function(n){function o(e){e.followingSpouse&&t(e)}if(n.hasSpouse){var s=i.playerData.socialData.spouse;s?o(s):i.once("SpouseInformationsMessage",function(e){o(e.spouse)})}else{if(!e._lastSpouseId)return;e.removePOI("spouse_"+e._lastSpouseId),delete e._lastSpouseId}})}function r(e){function t(t){var n;switch(t.type){case h.COMPASS_TYPE_SPOUSE:var o=i.playerData.socialData.spouse;if(!o)return void console.warn("Spouse does not exist");n={id:"spouse_"+o.spouseId,x:t.worldX,y:t.worldY,categoryId:v,nameId:l("ui.cartography.positionof",o.spouseName),color:{r:255,g:0,b:137,a:1},mapId:o.mapId,isDestination:!0};break;case h.COMPASS_TYPE_PARTY:var s=i.party.getMemberById(i.party.currentParty.partyId,t.memberId);if(!s)return void console.warn("Party member",t.memberId,"does not exist.");n={id:"party_"+s.id,x:t.worldX,y:t.worldY,categoryId:v,nameId:l("ui.cartography.positionof",s.name)+"\n\n("+t.worldX+", "+t.worldY+")",color:[1,1.1,2,1],mapId:s.mapId,isDestination:!0},e._lastPartyMemberId=s.id;break;case h.COMPASS_TYPE_QUEST:n={id:"flag_srv"+t.type,x:t.worldX,y:t.worldY,categoryId:v,nameId:t.worldX+","+t.worldY,color:{r:85,g:136,b:0,a:1},mapId:window.gui.playerData.position.worldmapId,isDestination:!0},window.gui.chat.logMsg(l("tablet.cartography.flagUpdated",t.worldX,t.worldY));break;case"zaap":n={id:"zaap",x:t.worldX,y:t.worldY,categoryId:"zaap",nameId:t.worldX+","+t.worldY,color:{r:150,g:199,b:221,a:1},mapId:window.gui.playerData.position.worldmapId,isDestination:!0};break;case"estate":n={id:"estate",x:t.worldX,y:t.worldY,categoryId:"estate",nameId:t.name+" ("+t.worldX+","+t.worldY+")",color:{r:184,g:143,b:35,a:1},mapId:window.gui.playerData.position.worldmapId,isDestination:!0};break;default:console.error("Unhandled CompassTypeEnum value:",t.type);case h.COMPASS_TYPE_SIMPLE:var a=i.compass.addMarker({type:t.type,x:t.worldX,y:t.worldY});window.gui.chat.logMsg(l("tablet.cartography.compassUpdated",a))}n&&e._updatePOI(n),i.compass.updateMarkersPositions()}var i=window.gui;i.on("CompassUpdateMessage",t),i.on("CompassUpdatePartyMemberMessage",t),i.on("CompassResetMessage",function(t){switch(t.type){case h.COMPASS_TYPE_SPOUSE:var n=i.playerData.socialData.spouse;e.removePOI("spouse_"+n.spouseId);break;case h.COMPASS_TYPE_PARTY:e.removePOI("party_"+e._lastPartyMemberId);break;case h.COMPASS_TYPE_QUEST:e.removePOI("flag_srv"+t.type);break;default:i.compass.removeMarker({type:t.type})}i.compass.updateMarkersPositions()}),i.playerData.position.on("mapUpdate",function(){i.playerData.isFighting||i.tutorialManager.inTutorial?i.compass.clearContent():i.compass.updateMarkersPositions()}),e.on("updatePOI",function(e){if(e.isDestination){var t=i.compass.markers[e.id];t.x=e.x,t.y=e.y,e.nameId&&(t.tooltip=e.nameId),i.compass.updateMarkersPositions()}}),i.fightManager.on("fightStart",function(){i.compass.clearContent()})}var l=i(29).getText,c=i(30),d=i(171),u=i(637),h=i(615),p="icon_1000",m="icon_1001",f="icon_1002",g="flag1",_=7,v="hint";e.exports.init=function(e){o(e),n(e),s(e),a(e),r(e)}},function(e,t){e.exports={ATLAS_INFOS_RESET:0,ATLAS_INFOS_UNKNOWN:1,ATLAS_INFOS_FLAG:2,ATLAS_INFOS_PHOENIX:3}},function(e,t){function i(e){e=e||{},this.id=e.id,this.categoryId=e.categoryId||"custom",this.x=e.x,this.y=e.y,this.nameId=e.nameId||"",this.color=e.color,this.color&&!Array.isArray(this.color)&&(this.color=[this.color.r/124,this.color.g/124,this.color.b/124,this.color.a]),this.data=e.data,this.isDestination=e.isDestination,this.iconId=e.iconId||n}var n="flag0";e.exports=i},function(e,t,i){var n=i(188).EventEmitter,o=i(172).inherits,s=i(176),a=function(){this.userPrefKey=null,this.followedQuests={}};o(a,n),a.prototype.init=function(){var e=this,t=window.gui;t.playerData.on("characterSelectedSuccess",function(){e.userPrefKey=t.playerData.id+"-followedQuests",e.followedQuests=s.getValue(e.userPrefKey,{})}),t.on("disconnect",this._clear)},a.prototype._clear=function(){this.userPrefKey=null,this.followedQuests={}},a.prototype._save=function(){s.setValue(this.userPrefKey,this.followedQuests)},a.prototype.followQuest=function(e,t){var i=window.gui,n=i.playerData.quests.active[e];return n?(this.followedQuests[e]=!0,this._save(),n.objectives?void(t&&i.GPS.addQuestNextObjective(e)):console.warn("followQuest: quest id "+e+" has no objectives")):console.warn("followQuest: quest id "+e+" is not active")},a.prototype.unfollowQuest=function(e,t){delete this.followedQuests[e],this._save(),t&&window.gui.GPS.removeQuestObjectives(e)},a.prototype.unfollowAllQuests=function(){var e=window.gui,t=e.playerData.quests.active;for(var i in t)e.GPS.removeQuestObjectives(i);this.followedQuests={},this._save()},a.prototype.isQuestFollowed=function(e){return!!this.followedQuests[e]},e.exports=new a},function(e,t){e.exports={INFO_GENERAL:1,INFO_MEMBERS:2,INFO_BOOSTS:3,INFO_PADDOCKS:4,INFO_HOUSES:5,INFO_TAX_COLLECTOR_GUILD_ONLY:6,INFO_TAX_COLLECTOR_ALLIANCE:7,INFO_TAX_COLLECTOR_LEAVE:8}},function(e,t,i){function n(){r.call(this,"",{className:"HouseMenuButton",hidden:!0});var e=this;this._reset(),this._icon=this.createChild("div",{className:"icon"}),this.on("tap",function(){e._updateToolTip(),window.gui.openContextualMenu("generic",e._tooltipParams)}),this._registerListeners()}function o(){c.open("guildHouseSetting"),window.dofus.sendMessage("HouseGuildRightsViewMessage")}function s(){c.open("padlock",{fromInside:!0})}i(642);var a=i(172).inherits,r=i(335).DofusButton,l=i(29).getText,c=i(194);a(n,r),e.exports=n,n.prototype._reset=function(){this._locked=!1,this._myHouse=null,this._onSale=!1,this._tooltipParams=null},n.prototype._registerListeners=function(){var e=this,t=window.gui,i=t.playerData,n=i.position;t.on("disconnect",function(){e._reset()}),n.on("myHouseNotification",function(t){t=t||{};var i=t.isInMyHouse,n=t.msg;return i?(e._myHouse=n.currentHouse,e._onSale=!!n.currentHouse.price,e._locked=n.currentHouse.isLocked,e._updateIcon(),void e.show()):(e.hide(),void e._reset())}),t.on("HousePropertiesMessage",function(t){var i=t.properties;e._tooltipParams&&e._myHouse&&e._myHouse.houseId===i.houseId&&(e._onSale=i.isOnSale,e._updateIcon())}),t.on("LockableStateUpdateHouseDoorMessage",function(t){e._tooltipParams&&e._myHouse&&e._myHouse.houseId===t.houseId&&(e._locked=t.locked,e._updateIcon())}),t.on("HouseSoldMessage",function(t){var n=t.buyerName;e._tooltipParams&&e._myHouse&&n===i.identification.nickname&&(e._myHouse.price=t.realPrice)})},n.prototype._updateIcon=function(){var e=this._locked?"locked":"";e=this._onSale?"onSale":e,this._icon.replaceClassNames(["onSale","locked"],e?[e]:[])},n.prototype._updateToolTip=function(){var e=this;this._tooltipParams={title:l("ui.house.homeOf",this._myHouse.ownerName),
actions:[]};var t=l(this._onSale?"ui.common.changeHousePrice":"ui.common.sell");this._tooltipParams.actions.push({caption:t,cb:function(){var t=c.getWindow("houseBuySell");t.prepareDialog(e._myHouse),c.open("houseBuySell",{fromInside:!0,myHouse:e._myHouse})}});var i=l(this._locked?"ui.common.unlock":"ui.common.lock");this._tooltipParams.actions.push({caption:i,cb:s});var n=window.gui.playerData.guild;n.hasGuild()&&this._tooltipParams.actions.push({caption:l("ui.common.guildHouseConfiguration"),cb:o})}},function(e,t){},function(e,t,i){function n(){v.call(this,"div",{className:"KohBox",hidden:!0}),m(this),this.on("tap",function(){window.gui.windowsContainer.appendChild(this)}),this.once("show",function(){this._createDom()});var e=this;window.gui.on("KohUpdateMessage",function(t){e.show(),e._setCurrentState(t)}),this.isInProbation=!1,window.gui.on("UpdateSelfAgressableStatusMessage",function(t){switch(t.status){case r.AvA_ENABLED_AGGRESSABLE:e.isInProbation=!1;break;case r.AvA_PREQUALIFIED_AGGRESSABLE:e.isInProbation=!0}})}function o(e,t,i,n,o,s){var a=new v("div",{className:["side",t]});l(a,i);var r=new u({width:25,height:25});r.setValue(e.allianceEmblem,!0),l(r,e.allianceName+" ["+e.allianceTag+"]");var d=new v("div",{text:e.allianceTag});return m(d),d.on("tap",function(){c.openAllianceCard(e.allianceId)}),{side:a,emblem:r,tag:d,characters:s,maps:o,time:n}}i(644);var s,a,r=i(474),l=i(337).addTooltip,c=i(583),d=i(166).dimensions,u=i(422),h=i(29).getText,p=i(172).inherits,m=i(197),f=i(645).serverConstants,g=i(475),_=i(649),v=i(321),y=i(651);p(n,v),n.prototype._createDom=function(){function e(){M.replaceClassNames(["full"],["open"]),b="open"}var t=window.gui.serversData;s=t.sessionConstants[f.SERVER_CONST_KOH_WINNING_SCORE],a=Math.floor(t.sessionConstants[f.SERVER_CONST_KOH_DURATION]),this.setStyle("left",d.mapLeft+Math.floor(d.mapWidth/2)+"px");var i=this.createChild("div",{className:"displaySwitch"});i.createChild("div",{className:"arrow"});var n=this.createChild("div",{className:"mainBox"}),o=n.createChild("div",{className:"topBox"}),r=n.createChild("div",{className:"secondaryBox"});this.gauge=o.appendChild(new y(["green","blue","red"],380));var c=Math.floor(a/1e3/60),u=Math.floor(c/60)+":"+c%60,p=o.createChild("div",{className:"kohInfo"});l(p,h("ui.koh.tooltip.rules",s,u),{openOnTap:!0});var g=r.createChild("div",{className:"allianceBox"});this.table=g.appendChild(new _({colIds:["side","emblem","tag","characters","maps","time"],headerContent:["","",h("ui.common.alliance"),h("ui.short.characters"),h("ui.common.maps"),h("ui.common.time")]})),l(this.table.getHeaderCol("characters"),h("ui.koh.tooltip.members")),l(this.table.getHeaderCol("maps"),h("ui.koh.tooltip.maps")),l(this.table.getHeaderCol("time"),h("ui.koh.tooltip.time")),this.winnerInfo=g.createChild("div",{className:"info"});var v=r.createChild("div",{className:"statsBox"});this.winnerStats=v.createChild("div",{className:"winnerStats"}),l(this.winnerStats,h("ui.koh.tooltip.mapConquest")),this.myStats=v.createChild("div",{className:"myStats"}),l(this.myStats,h("ui.koh.tooltip.mapConquestForMyAlliance"));var b;m(i);var M=this;i.on("tap",function(){switch(b){case"open":M.replaceClassNames(["open"],["full"]),b="full";break;case"full":M.delClassNames("open","full"),b="close";break;case"close":e()}}),this.on("hide",e),e()},n.prototype._setCurrentState=function(e){var t=this;this.table.clearContent();for(var i=window.gui.playerData,n=i.alliance.current,a=i.position,r=g.entities.prism[a.subAreaId],l=r&&r.prism&&r.prism.alliance||n,d=0,u=0,p={mine:{weight:0,type:h("ui.alliance.myAlliance"),tooltip:""},defense:{weight:0,type:h("ui.alliance.allianceInDefense"),tooltip:""},attack:{weight:0,type:h("ui.alliance.allianceInAttack"),tooltip:""}},f=0,_=e.alliances.length;f<_;f+=1){var y=e.alliances[f],b=e.allianceNbMembers[f],M=e.allianceMatchScore[f],w=e.allianceRoundWeigth[f];d+=w;var T;T=y.allianceId===n.allianceId?"mine":y.allianceId===l.allianceId?"defense":"attack";var C=M+"/"+s,A=p[T];A.weight+=w,A.tooltip+=y.allianceName+" ["+y.allianceTag+"] ("+w+") : "+C+"\n",this.table.addRow(o(y,T,A.type,C,w,b),{weight:w}),e.allianceMatchScore[u]<M&&(u=f)}this.table.sort(function(e,t){return t.weight-e.weight}),d=d||1,p.mine.weight/=d,p.mine.tooltip+=p.mine.type,p.defense.weight/=d,p.defense.tooltip+=p.defense.type,p.attack.weight/=d,p.attack.tooltip+=p.attack.type,this.gauge.setValues([p.mine,p.defense,p.attack]);var I=e.alliances[u],S=e.allianceMatchScore[u];if(I&&S>=s)return this.winnerInfo.setText(h("ui.koh.win",I.allianceName)),this.winnerInfo.show(),void setTimeout(function(){t.winnerInfo.setText(""),t.hide()},6e4);var E=e.allianceMapWinner,x=e.allianceMapWinnerScore;this.winnerStats.clearContent();var N=a.coordinates;if(this.winnerStats.createChild("span",{text:h("ui.option.worldOption")+" ["+N.posX+", "+N.posY+"]"+h("ui.common.colon")}),0===x||this.isInProbation)this.winnerStats.createChild("span",{text:h("ui.common.neutral")});else if(""===E.allianceTag)this.winnerStats.createChild("span",{text:h("ui.koh.draw",x)});else{var L=this.winnerStats.createChild("span",{text:E.allianceTag,className:"link"});m(L),L.on("tap",function(){c.openAllianceCard(E.allianceId)}),this.winnerStats.appendChild(new v("span",{text:" "+x+" "+h("ui.short.points")}))}if(E.allianceId!==n.allianceId&&x>0&&!this.isInProbation){this.myStats.clearContent(),this.myStats.createChild("span",{text:"("});var O=this.myStats.createChild("span",{text:n.allianceTag,className:"link"});m(O),O.on("tap",function(){c.openAllianceCard(n.allianceId)}),this.myStats.appendChild(new v("span",{text:" "+e.allianceMapMyAllianceScore+" "+h("ui.short.points")+")"})),this.myStats.show()}else this.myStats.hide()},e.exports=n},function(e,t){},function(e,t,i){function n(e){return!!b[e]}function o(){this.serversRawData=[],this.serversWithMyCharacter=[],this.optionalFeatures={},this.connectedServerId=null,this.connectedServerData=null,this.sessionConstants={},this.settings={}}function s(){var e=_.tz.guess().split("/"),t=e[0],i=e[1];switch(t){case"US":t="America"}switch(i){case"Honolulu":case"Guam":t="America"}return t}function a(e,t){return"America"===e&&t.area===e||"America"!==e&&"America"!==t.area}function r(e,t,i){if(M.indexOf(e)===-1&&!i)return t;for(var n,o,r=s(),l=[],c=0;c<t.length;c+=1)n=t[c],o=n.staticData.server,a(r,o)&&l.push(n);return l}var l=i(202),c=i(30),d=i(194),u=i(29).getText,h=i(204),p=i(646),m=i(647),f=i(648),g=i(182),_=i(44),v=6e4,y=!1,b={401:!0,402:!0,407:!0,403:!0,404:!0,405:!0,406:!0,408:!0,409:!0,410:!0},M=[1,2];e.exports=o,o.serverConstants={SERVER_CONST_TIME_BEFORE_DISCONNECTION:1,SERVER_CONST_KOH_DURATION:2,SERVER_CONST_KOH_WINNING_SCORE:3,SERVER_CONST_MINIMAL_TIME_BEFORE_KOH:4,SERVER_CONST_TIME_BEFORE_WEIGH_IN_KOH:5},o.prototype.selectServer=function(e){if(!e)return console.error(new Error("ServersData.selectServer: serverId is null")),void this._onSelectedServerRefused({});h.selectServer(e),this.connectedServerId=e,this.connectedServerData=this._findServerById(e),window.dofus.accessGameServer(e,function(e){if(e)return console.error("accessGameServer",e)}),this.failTimeout&&(console.warn("Clearing previous connection timeout from ServersData.selectServer"),window.clearTimeout(this.failTimeout));var t=this;this.failTimeout=window.setTimeout(function(){t._onSelectedServerRefused({serverId:e,serverStatus:p.STATUS_UNKNOWN,error:f.SERVER_CONNECTION_ERROR_NO_REASON})},v),window.gui.once("AuthenticationTicketAcceptedMessage",function(){window.clearTimeout(t.failTimeout),t.failTimeout=null})},o.prototype.showServerSelectionUi=function(){this.serversWithMyCharacter.length>0?d.open("serverSelection",this.serversWithMyCharacter):d.open("serverSimpleSelection",this.serversRawData)},o.prototype._filterMyServersList=function(){this.serversWithMyCharacter=this.serversRawData.filter(function(e){return e&&e.charactersCount>0})},o.prototype.initialize=function(e){var t=this;e.on("disconnect",function(e){t.serversRawData=[],t.serversWithMyCharacter=[],t.optionalFeatures={},t.connectedServerId="disconnect"+e,t.connectedServerData=null,t.sessionConstants={},t.settings={}}),e.on("ServerStatusUpdateMessage",function(i){if(!i.server)return console.warn("WARN: ServerStatusUpdateMessage message have no server information");for(var n=i.server,o=!0,s=0,a=t.serversRawData.length;s<a;s+=1)if(n.id===t.serversRawData[s].id){t.serversRawData[s]=n,o=!1;break}o&&t.serversRawData.push(n),t._filterMyServersList(),e.emit("serversUpdate",n)}),e.on("SelectedServerRefusedMessage",function(e){t._onSelectedServerRefused(e)}),e.on("ServerOptionalFeaturesMessage",function(e){t.optionalFeatures={};for(var i=window.gui.databases.OptionalFeatures,n=0,o=e.features.length;n<o;n+=1){var s=e.features[n];t.optionalFeatures[i[s].keyword]=s}}),e.on("ServerSessionConstantsMessage",function(e){t.sessionConstants={};for(var i=e.variables,n=0,o=e.variables.length;n<o;n+=1)t.sessionConstants[i[n].id]=i[n].value}),e.on("ServerSettingsMessage",function(e){t.settings.serverCommunityId=e.community,t.settings.serverLang=e.lang,t.settings.serverGameType=e.gameType}),l.on("CharacterSelectedSuccessMessage",function(){delete t.staticContent})},o.prototype.onServerList=function(e){this.serversRawData=e.servers,this._filterMyServersList();var t=this.serversWithMyCharacter,i=h.connectMethod,n=h.lastServerId,o="lastServer"===i||"lastCharacter"===i||"characterId"===i;if(n&&o)for(var s=0,a=t.length;s<a;s+=1){var r=t[s];if(n===r.id&&r.status===p.ONLINE)return this.selectServer(n)}this.showServerSelectionUi()},o.prototype.isFeatureActive=function(e){return this.optionalFeatures.hasOwnProperty(e)},o.prototype.syncServerStaticData=function(e){var t=this;if(this.staticContent)return e();this.staticContent={};var i=["Servers","ServerGameTypes","ServerPopulations","ServerCommunities"];c.getAllDataMap(i,function(i,n){return i?e(i):(t.staticContent.data=n.Servers,t.staticContent.gameTypes=n.ServerGameTypes,t.staticContent.populations=n.ServerPopulations,t.staticContent.communities=n.ServerCommunities,e())})},o.prototype.getAutoChosenServers=function(e){function t(e){for(var t=-1,i=[],n=0,o=e.length;n<o;n+=1){var s=e[n],a=s.staticData.server;s.status===p.ONLINE&&t===-1&&(t=s.completion),a.nameId=a.nameId||"n/a",t!==-1&&a.populationId===t&&s.status===p.ONLINE&&a.nameId.indexOf("Test")===-1&&i.push(s)}return i}var i,n,o=this,s=this.serversRawData,a=window.gui.playerData.identification,l=a.communityId,c=[],d=[],u=[];return this.syncServerStaticData(function(a){if(a)return e(a);var h;for(i=0,n=s.length;i<n;i+=1){var p=s[i];if(p){var f=o.staticContent.data[p.id];if(f){switch(p.staticData||(p.staticData={}),p.staticData.server=f,p.id){case 401:case 402:f.area="America";case 406:case 407:p.completion=m.COMPLETION_AVERAGE,f.populationId=m.COMPLETION_AVERAGE;break;case 403:p.completion=m.COMPLETION_HIGH,f.populationId=m.COMPLETION_HIGH;break;case 404:p.completion=m.COMPLETION_AVERAGE,f.populationId=m.COMPLETION_AVERAGE;break;case 405:p.completion=m.COMPLETION_AVERAGE,f.populationId=m.COMPLETION_AVERAGE;break;case 409:p.completion=m.COMPLETION_AVERAGE,f.populationId=m.COMPLETION_AVERAGE}var g=f.communityId;900===p.id?h=p:l===g?c.push(p):(1!==l&&2!==l||1!==g&&2!==g||c.push(p),4!==l&&6!==l||4!==g&&6!==g||c.push(p),2===g&&d.push(p))}else console.warn("WARN: server",p.id,"has no staticContent")}}var _=!1;return 0===c.length&&(_=!0,c=c.concat(d)),c=r(l,c,_),c.sort(function(e,t){return e.completion-t.completion}),0===c.length&&h&&c.push(h),0===c.length?e("My community servers is empty, for userCommunity "+l):(u=t(c),0===u.length?e("Available servers is empty, for userCommunity "+l):e(null,u))})},o.prototype.pickUpOneServerForMe=function(){this.getAutoChosenServers(function(e,t){if(e)return window.gui.openSimplePopup(u("tablet.server.noServersForYourCommunity")),void(y||(console.error("pickUpOneServerForMe:",e),y=!0));var i=t[Math.floor(Math.random()*t.length)];i&&d.open("serverDetails",i)})},o.prototype._findServerById=function(e){for(var t=0;t<this.serversRawData.length;t++)if(e===this.serversRawData[t].id)return this.serversRawData[t];return null},o.prototype.getSelectableServerList=function(){for(var e=[],t=0;t<this.serversRawData.length;t++){var i=this.serversRawData[t];i.status===p.ONLINE&&i.isSelectable&&e.push(i)}return e},o.prototype.getSelectableServerNames=function(){var e=this.getSelectableServerList();if(0===e.length)return u("ui.common.none").toLowerCase();for(var t=e[0]._name,i=1;i<e.length;i++)t+=", "+e[i]._name;return t},o.prototype._onSelectedServerRefused=function(e){this.failTimeout&&window.clearTimeout(this.failTimeout);var t=this._findServerById(e.serverId);t&&(t.status=e.serverStatus);var i;switch(e.error){case f.SERVER_CONNECTION_ERROR_DUE_TO_STATUS:switch(i="Status",e.serverStatus){case p.OFFLINE:i+="Offline";break;case p.STARTING:i+="Starting";break;case p.NOJOIN:i+="Nojoin";break;case p.SAVING:i+="Saving";break;case p.STOPING:i+="Stoping";break;case p.FULL:i+="Full";break;default:i+="Unknown"}break;case f.SERVER_CONNECTION_ERROR_ACCOUNT_RESTRICTED:i="AccountRestricted";break;case f.SERVER_CONNECTION_ERROR_COMMUNITY_RESTRICTED:i="CommunityRestricted";break;case f.SERVER_CONNECTION_ERROR_LOCATION_RESTRICTED:i="LocationRestricted";break;case f.SERVER_CONNECTION_ERROR_SUBSCRIBERS_ONLY:i="SubscribersOnly";break;case f.SERVER_CONNECTION_ERROR_REGULAR_PLAYERS_ONLY:i="RegularPlayersOnly";break;default:i="NoReason"}var n;switch(i){case"AccountRestricted":n=u("ui.server.cantChoose.serverForbidden");break;case"CommunityRestricted":n=u("ui.server.cantChoose.communityRestricted");break;case"LocationRestricted":n=u("ui.server.cantChoose.locationRestricted");break;case"SubscribersOnly":n=u("ui.server.cantChoose.communityNonSubscriberRestricted");break;case"RegularPlayersOnly":n=u("ui.server.cantChoose.regularPlayerRestricted");break;case"StatusOffline":n=u("ui.server.cantChoose.serverDown");break;case"StatusStarting":n=u("ui.server.cantChoose.serverDown");break;case"StatusNojoin":n=u("ui.server.cantChoose.serverForbidden");break;case"StatusSaving":n=u("ui.server.cantChoose.serverSaving");break;case"StatusStoping":n=u("ui.server.cantChoose.serverDown");break;case"StatusFull":n=u("ui.server.cantChoose.serverFull")+"\n\n"+u("ui.server.serversAccessibles",this.getSelectableServerNames());break;case"NoReason":case"StatusUnknown":n=u("ui.popup.connectionFailed.text")}this.showServerSelectionUi(),window.gui.openSimplePopup(n)},o.getServerImage=function(e,t){var i=["gfx/illus/illu_0.png"];n(e)&&i.push("gfx/illus/illu_"+e+".png"),g.preloadImages(i,function(e){var i=e[0],n=e[1];return n&&"none"!==n?t(null,n):t(null,i)})},o.prototype.getMyServerName=function(){return this.connectedServerData&&this.connectedServerData._name}},function(e,t){e.exports={STATUS_UNKNOWN:0,OFFLINE:1,STARTING:2,ONLINE:3,NOJOIN:4,SAVING:5,STOPING:6,FULL:7}},function(e,t){e.exports={COMPLETION_RECOMANDATED:0,COMPLETION_AVERAGE:1,COMPLETION_HIGH:2,COMPLETION_COMING_SOON:3,COMPLETION_FULL:4}},function(e,t){e.exports={SERVER_CONNECTION_ERROR_DUE_TO_STATUS:0,SERVER_CONNECTION_ERROR_NO_REASON:1,SERVER_CONNECTION_ERROR_ACCOUNT_RESTRICTED:2,SERVER_CONNECTION_ERROR_COMMUNITY_RESTRICTED:3,SERVER_CONNECTION_ERROR_LOCATION_RESTRICTED:4,SERVER_CONNECTION_ERROR_SUBSCRIBERS_ONLY:5,SERVER_CONNECTION_ERROR_REGULAR_PLAYERS_ONLY:6}},function(e,t,i){function n(e){return e?(o.call(this,"div",e),this.addClassNames(["Table",e.className]),this._rows=[],this._rowCount=0,this._hiddenRowIds=[],this._clickable=!1,this._colIds=e.colIds,this._minRows=e.minRows||0,this._colCount=this._colIds?this._colIds.length:e.colCount||1,this._defaultRowContent=e.defaultRowContent||[],this._highlightable=e.highlightable,this._disableAutoSelect=e.disableAutoSelect,this._autoUpdateRowColor=!e.disableRowColor,e.headerContent&&(this.header=this.createChild("div",{className:["container","header"]}),this._addHeader(e.headerContent)),this.content=this.createChild("div",{className:["container","content"]}),e.footerContent&&(this.footer=this.createChild("div",{className:["container","footer"]}),this._addFooter(e.footerContent)),e.onRowTap&&(this._clickable=!0,this.on("selected",e.onRowTap)),void(e.minRows&&this._setupDefaultRows())):void console.error("Undefined Table 'options' parameter")}i(650);var o=i(321),s=i(197),a=i(172).inherits;a(n,o),e.exports=n,n.prototype.addRow=function(e,t){var i;return this._rowCount<this._rows.length?(this._rows[this._rowCount]._isEmpty=!1,i=this.updateRow(this._rowCount,e,t)):i=this._addRow(e,null,t),this._rowCount++,this._updateRowColor(),i},n.prototype.insertRow=function(e,t,i){if(e<0||e>this._rows.length)return console.warn("[Table.insertRow] the specified index ("+e+") is out of range."),null;var n=this._rows[e];if(n&&n._isEmpty)n._isEmpty=!1,n=this.updateRow(e,t,i);else{n=this._createRow(t,"content");for(var o in i)n[o]=i[o];e===this._rows.length?this.content.appendChild(n):n.insertBefore(this._rows[e]),this._rows.splice(e,0,n)}return this._rowCount++,this._updateRowColor(),n},n.prototype.sort=function(e){var t=this._rows;t.sort(e);for(var i=0,n=t.length;i<n;i+=1)this.content.appendChild(t[i]);this._updateRowColor()},n.prototype.delRow=function(e){if(e>this._rowCount)return console.error("[Table.delRow] Row index "+e+" does not exist.");if(!this._isRowEmpty(e)){var t=this._rows[e];this._lastSelected===t&&(this._lastSelected=null),t.destroy(),this._rowCount--,this._rows.splice(e,1),this._rows.length<this._minRows&&this._addRow(),this._highlightable&&!this._disableAutoSelect&&this.highlight(0),this._updateRowColor()}},n.prototype.updateRowContent=function(e,t,i){if(!e._isEmpty){for(var n in i)e[n]=i[n];if(this._highlightable&&e.enable(),Array.isArray(t)){for(var s={},a=this._colIds,r=0;r<a.length;r++)s[a[r]]=t[r];t=s}for(var l in t){var c=e.getChild(l),d=t[l];c.clearContent(),d instanceof o?c.appendChild(d):(void 0!==d&&null!==d||(d=""),c.setHtml(d.toString()))}return!this._highlightable||this._lastSelected||this._disableAutoSelect||this.highlight(0),e}},n.prototype.updateRow=function(e,t,i){if(!this._isRowEmpty(e)){var n=this._rows[e];return this.updateRowContent(n,t,i)}},n.prototype.getRows=function(){return this._rows},n.prototype.clearContent=function(){for(var e=0;e<this._rows.length;e++)this._rows[e].destroy();this._rows=[],this._rowCount=0,this._lastSelected=null,this._hiddenRowIds=[],this._setupDefaultRows()},n.prototype.removeHightlight=function(){this._lastSelected&&(this._lastSelected.delClassNames("highlight"),this._lastSelected=null)},n.prototype.highlightFirstRow=function(){for(var e=0;e<this._rows.length;e++){var t=this._rows[e];if(t.isVisible())return void this.highlightRow(t)}},n.prototype.highlightRow=function(e){if(this._highlightable){if(!e||e._isEmpty)return void console.warn("Invalid index, row does not exist or empty!");e!==this._lastSelected&&(this._lastSelected&&this._lastSelected.delClassNames("highlight"),this._lastSelected=e,this._lastSelected.addClassNames("highlight")),this.emit("selected",e)}},n.prototype.highlight=function(e){this.highlightRow(this._rows[e])},n.prototype.getRowCount=function(){return this._rowCount},n.prototype.getRow=function(e){return this._rows[e]&&this._isRowEmpty(e)?void console.warn("[Table.getRow] Row index "+e+" is empty."):this._rows[e]},n.prototype.getCol=function(e,t){var i=this.getRow(e);if(i)return i.getChild(t)},n.prototype.getHeaderCol=function(e){return this.header.getChildren()[0].getChild(e)},n.prototype.hideRows=function(e){if(e.length){for(var t=0,i=0;i<e.length;i++){var n=e[i],o=this.getRow(n);o&&(o.hide(),this._hiddenRowIds.push(n),t++)}var s=this.getRowCount()-t;return this._disableAutoSelect||this.highlightFirstRow(),s<this._minRows?(s=this._minRows-s,void this._addEmptyRows(s)):void this._updateRowColor()}},n.prototype.showRows=function(){var e=this._hiddenRowIds;if(e.length){for(var t=0;t<e.length;t++){var i=this.getRow(e[t]);i&&i.show()}return this._disableAutoSelect||this.highlightFirstRow(),this._hiddenRowIds=[],this._rows.length>this._minRows?void this._delEmptyRows(this._rows.length-this._minRows):void this._updateRowColor()}},n.prototype._updateRowColor=function(){if(this._autoUpdateRowColor)for(var e=!0,t=0;t<this._rows.length;t++){var i=this._rows[t];i.isVisible()&&(e?(i.addClassNames("odd"),e=!1):(i.delClassNames("odd","even"),e=!0))}},n.prototype._isRowEmpty=function(e){return this._rows[e]._isEmpty},n.prototype._createRow=function(e,t){var i=this._colIds||[],n=new o("div",{className:"row"});e||(n._isEmpty=!0,e=this._defaultRowContent);for(var a,r=Array.isArray(e),l=0;l<this._colCount;l++){var c=i[l],d=n.createChild("div",{className:"col",name:c||""});r?a=e[l]:(a=e[c],n[c]=a),(a||0===a)&&(a instanceof o?d.appendChild(a):d.setHtml(a.toString()))}if("content"!==t)return n;if(this._highlightable||this._clickable){s(n),n.on("disabled",function(){n.addClassNames("disabled")}),n.on("enabled",function(){n.delClassNames("disabled")}),n._isEmpty&&n.disable();var u=this;n.on("tap",function(){u.highlightRow(this)})}return n},n.prototype._addRow=function(e,t,i){t=t||"content";var n=this._createRow(e,t);this[t].appendChild(n);for(var o in i)n[o]=i[o];return"content"!==t?n:(this._rows.push(n),e?(!this._highlightable||this._lastSelected||this._disableAutoSelect||this.highlight(0),n):void 0)},n.prototype._addEmptyRows=function(e){for(var t=0;t<e;t++)this._addRow();this._updateRowColor()},n.prototype._addHeader=function(e){this._addRow(e,"header")},n.prototype._addFooter=function(e){this._addRow(e,"footer")},n.prototype._setupDefaultRows=function(){for(;this._rows.length<this._minRows;)this._addRow();this._updateRowColor()},n.prototype._delEmptyRows=function(e){for(var t=this._rows.length-1;t>=0&&!(0===e||this._rows.length<=this._minRows);t--)this._isRowEmpty(t)&&(this._rows[t].destroy(),this._rows.splice(t,1),e--);this._updateRowColor()}},function(e,t){},function(e,t,i){function n(e,t){a.call(this,"div",{className:"Gauge"}),this.createChild("div",{className:"barBg"});var i=this.createChild("div",{className:"barBox"});this.bars=[];for(var n=0,s=e.length;n<s;n+=1){var r=i.createChild("div",{className:"barContainer"});r.createChild("div",{className:["bar",e[n]]}),r.tooltip=i.createChild("div",{className:"tooltip"}),r.tooltipContent=new a("div"),o(r.tooltip,r.tooltipContent,{openOnTap:!0}),this.bars.push(r)}this.width=t}var o=i(337).addTooltip,s=i(172).inherits,a=i(321);s(n,a),e.exports=n,n.prototype.setValues=function(e){for(var t=0,i=0,n=this.bars.length;i<n;i+=1){var o=e[i],s=this.bars[i],a=Math.floor(this.width*o.weight);s.setStyles({"-webkit-mask-position":t+"px 0","-webkit-mask-size":a+"px 100%"}),s.tooltip.setStyles({left:t+"px",width:a+"px"}),t+=a,s.tooltipContent.setText(o.tooltip)}}},function(e,t,i){function n(){a.call(this,"div",{className:"mapCoordinateDisplay",hidden:!0}),this.setupListeners(),this.createContent()}i(653);var o=i(166).dimensions,s=i(172).inherits,a=i(321),r=i(583),l=i(422),c=i(197),d=i(29).getText,u=i(475),h=i(196),p=12;s(n,a),e.exports=n,n.prototype.createContent=function(){this.descriptionElement=this.createChild("div"),this.coordinatesElement=this.createChild("div"),this.allianceInfo=this.createChild("div",{className:"allianceInfo"}),c(this.allianceInfo),this.allianceInfo.on("tap",function(){r.openAllianceCard(this.allianceId)}),this.allianceTag=this.allianceInfo.createChild("div",{className:"tag"}),this.allianceEmblem=this.allianceInfo.appendChild(new l({width:35,height:35}))},n.prototype._updateMapInfo=function(){var e=window.gui.playerData.position;if(e.mapPosition){var t=u.entities.prism,i=e.coordinates.posX+","+e.coordinates.posY,n=e.mapPosition.nameId;n||(n=e.area.nameId+" ("+e.subArea.nameId+")",i+=", "+d("ui.common.averageLevel")+" "+e.subArea.level),this.descriptionElement.setText(n),this.coordinatesElement.setText(i);var o=t[e.subArea.id];if(o&&o.prism){var s=o.getAlliance();this.allianceInfo.allianceId=s.allianceId,this.allianceTag.setText("["+s.allianceTag+"]"),this.allianceEmblem.setValue(s.allianceEmblem,!0),this.allianceInfo.show()}else this.allianceInfo.hide()}},n.prototype.showMethod=function(){var e=this;a.prototype.showMethod.call(this),this._updateMapInfo(),window.setTimeout(function(){h.tween(e,{opacity:1},{time:100,easing:"linear"})},100)},n.prototype.hideMethod=function(){var e=this;h.tween(this,{opacity:0},{time:100,easing:"linear"},function(){a.prototype.hideMethod.call(e)})},n.prototype.setupListeners=function(){var e=this,t=window.gui;t.on("disconnect",function(){e.hide()}),t.playerData.position.on("mapUpdate",function(){e.isVisible()&&e._updateMapInfo()}),t.on("resize",function(){e.setStyles({left:o.mapLeft+p+"px",top:o.mapTop+p+"px"})})}},function(e,t){},function(e,t,i){function n(e,t){if(!t)return _["switch"](e);var i=_.getWindow(e),n=i.getOpenedTabId();i.openState&&t===n?_.close(e):_.open(e,{tabId:t})}function o(){_.getWindow("tradeInventory").isMyShopOpen()?_.close("tradeInventory"):(window.dofus.sendMessage("LeaveDialogRequestMessage",null),window.dofus.sendMessage("ExchangeRequestOnShopStockMessage"))}function s(){_.getWindow("bidHouseShop").openState?_.close("bidHouseShop"):r.openBidHouse(!1)}function a(){g.call(this,{autoClose:!0}),this.addClassNames("MenuBar"),this._sizeInIcons=-1,this._iconOrder=[],this._plusIconList=[],this._manualMode=!1,this._createDom(),this._listenToServerEvents(),this._listenToInternalEvents()}i(655);var r=i(448),l=i(167),c=i(166).dimensions,d=i(317),u=i(29).getText,h=i(172).inherits,p=i(335),m=i(176),f=i(196),g=i(656),_=i(194),v=i(7),y=l.MENU_ICON_SIZE,b={narrow:8,wide:4},M={narrow:35,wide:45},w={Carac:{tooltip:"ui.banner.character",windowId:"characteristics"},Spell:{tooltip:"ui.grimoire.mySpell",windowId:"grimoire",tabId:"spells"},Bag:{tooltip:"ui.banner.inventory",windowId:"equipment"},Book:{tooltip:"ui.common.quests",windowId:"grimoire",tabId:"quests"},Map:{tooltip:"ui.banner.map",windowId:"worldMap"},Friend:{tooltip:"ui.banner.friends",windowId:"social",tabId:"friends"},Guild:{tooltip:"ui.common.guild",windowId:"social",tabId:"guild"},BidHouse:{tooltip:"ui.bidhouse.bigStore",action:s},Conquest:{tooltip:"ui.common.koliseum",windowId:"arena"},Goultine:{tooltip:"tablet.window.shop.title",windowId:"market",tabId:"shop"},Job:{tooltip:"ui.common.myJobs",windowId:"grimoire",tabId:"jobs"},Alliance:{tooltip:"ui.common.alliance",windowId:"social",tabId:"alliance"},Mount:{tooltip:"ui.banner.mount",windowId:"mount"},Directory:{tooltip:"ui.common.directory",windowId:"social",tabId:"directory"},Alignment:{tooltip:"ui.common.alignment",windowId:"grimoire",tabId:"alignment"},Bestiary:{tooltip:"ui.common.bestiary",windowId:"grimoire",tabId:"bestiary"},Title:{tooltip:"ui.common.titles",windowId:"grimoire",tabId:"ornaments"},Achievement:{tooltip:"ui.achievement.achievement",windowId:"grimoire",tabId:"achievements"},Almanax:{tooltip:"ui.almanax.almanax",windowId:"grimoire",tabId:"almanax"},Spouse:{tooltip:"ui.common.spouse",windowId:"social",tabId:"spouse"},Shop:{tooltip:"ui.common.shop",action:o}},T=["Carac","Spell","Bag","BidHouse","Map","Friend","Book","Guild","Conquest","Goultine","Job","Alliance","Mount","Directory","Alignment","Bestiary","Title","Achievement","Almanax","Spouse","Shop"],C="menuBarOrder";h(a,g),e.exports=a,a.prototype._createDom=function(){this._iconsBox=this.content.createChild("div",{className:"iconsBoxContainer"}),this._icons=this.content.createChild("div",{className:"iconsContainer"});var e=this;this._unlock=!1,this._lockBtn=this.content.appendChild(new p({className:"lockBtn",scaleOnPress:!0},function(){e._toggleIconsDrag(!e._unlock)}));for(var t=0;t<T.length;t++)this._createIcon(t,T[t])},a.prototype.setIconAvailability=function(e,t){void 0===t&&(console.error(new Error("setIconAvailability: enabled param should not be undefined")),t=!1);var i=this._icons.getChild(e);i.toggleClassName("disabled",!t),i.isDisabled=!t},a.prototype.enableDragButton=function(e){this._lockBtn.setEnable(e)},a.prototype._toggleIconsDrag=function(e){for(var t=this._icons.getChildren(),i=0,n=t.length;i<n;i+=1)d.setDragEnable(t[i],e);this._lockBtn.toggleClassName("on",!e),this.toggleClassName("draggable",e),this._unlock=e},a.prototype._listenToServerEvents=function(){function e(){return i.tutorialManager.inTutorial||i.playerData.isFighting}var t=this,i=window.gui;i.uiLocker.on("updated",function(e){if(e.menuButtonId){if(!w[e.menuButtonId])return console.error(new Error("Unknown button id `"+e.menuButtonId+"` in MenuBar."));if(t.setIconAvailability(e.menuButtonId,!e.locked),!e.locked){var i=t.getIcon(e.menuButtonId);if(i){var n=t._plusIconList;n.indexOf(e.menuButtonId)===-1||i.hasClassName("plusIcon")||i.addClassNames("plusIcon")}}}}),i.tutorialManager.on("inTutorialStateChanged",function(e){return e?(t._manualMode=!0,t._setButtonsOrder(T),t.enableDragButton(!1),i.uiLocker.lockAllFeatures("tutorial"),void t._clearPlusIconsStyle()):(t._manualMode&&t._setButtonsOrder(t._iconOrder),t._manualMode=!1,t.enableDragButton(!0),t._showPlusIcons(),void i.uiLocker.unlockAllFeatures("tutorial"))}),i.fightManager.on("fightStart",function(){t._clearPlusIconsStyle()}),i.fightManager.on("fightEnd",function(){t._showPlusIcons()}),i.playerData.characters.mainCharacter.on("newSpellLearned",function(){t._addPlusIcon("Spell",{doNotShow:e()})}),i.playerData.on("characterLevelUp",function(){t._addPlusIcon("Carac",{doNotShow:e()})});var n=_.getWindow("grimoire");n.tabs.on("openTab",function(i){"spells"!==i||e()||t._removePlusIcon("Spell")});var o=_.getWindow("characteristics");o.on("open",function(){e()||t._removePlusIcon("Carac",!1)})},a.prototype._listenToInternalEvents=function(){var e=this,t=window.gui;t.on("connected",function(){e._loadButtonOrderFromAccountPref(),e._setButtonsOrder(e._iconOrder)}),t.on("disconnect",function(){e._manualMode=!1,e._clearPlusIconsStyle(),e._plusIconList=[]}),this.on("close",function(){this._toggleIconsDrag(!1)})},a.prototype._onDrop=function(e,t){if(e.id!==t.id){e.delClassNames("vibrate");var i=e.index,n=t.index,o=this;f.tween(e,{webkitTransform:"translate3d("+(t.x-e.x)+"px,"+(t.y-e.y)+"px,0)"},{time:100,easing:"ease-out"},function(){o._positionIcon(e,n),o._iconOrder[e.index]=e.id,o._iconOrder[t.index]=t.id,m.setValue(C,o._iconOrder),e.addClassNames("vibrate")}),this._positionIcon(t,i)}},a.prototype._createIcon=function(e,t){var i=this;this._iconsBox.createChild("div",{className:"iconBox"});var o=w[t],s=this._icons.appendChild(new p({className:["vibrate","anim"+Math.floor(9*Math.random()),"menuIcon"+t,"menuBarIcon"],tooltip:u(o.tooltip),name:t,scaleOnPress:!0},function(){i.close(),"Goultine"===t&&v.log("HUD.Click_on_button",{interface_id:"MenuBar",button_id:"BTN_MENUBAR_SHOP",clic_parameter_key:"position",clic_parameter_value:s.index+1,clic_type:"Simple_court"}),this.isDisabled||(o.action?o.action():n(o.windowId,o.tabId))}));s.id=t,s.index=e,d.setDraggable(s,null,"menuBar",null,{dragElement:!0,dragOnTouchstart:!0}),d.setDroppable(s,["menuBar"],{matchPositionOnDrop:!0}),d.disableDrag(s),s.on("drop",function(e){i._onDrop(this,e)}),s.on("tooltipOn",function(){this.setStyle("webkitTransform","scale(1.1)")}),s.on("tooltipOut",function(){this.setStyle("webkitTransform","scale(1)")})},a.prototype.getIcon=function(e){return this._icons.getChild(e)},a.prototype._reorderButtons=function(){for(var e=this._icons.getChildren(),t=this._iconsBox.getChildren(),i=0,n=e.length;i<n;i+=1){var o=e[i];this._positionIcon(o,o.index),this._positionIcon(t[i],o.index)}},a.prototype._setButtonsOrder=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=this._icons.getChild(i);n.index=t,this._positionIcon(n,t)}},a.prototype._loadButtonOrderFromAccountPref=function(){if(this._iconOrder=m.getValue(C,null),this._iconOrder)for(var e=0;e<T.length;e++)this._iconOrder.indexOf(T[e])===-1&&this._iconOrder.splice(e,0,T[e]);else this._iconOrder=T.concat();for(var t=0;t<this._iconOrder.length;t++){var i=this._iconOrder[t],n=this._icons.getChild(i);if(n){var o=window.gui.uiLocker.isMenuButtonAvailable(i);this.setIconAvailability(i,o)}else this._iconOrder.splice(t,1),t--}},a.prototype._positionIcon=function(e,t){
window.gui.ipadRatio?(e.x=(y+1)*(t%this._iconsPerLine),e.y=(y+2)*Math.floor(t/this._iconsPerLine)):(e.x=(y+4)*Math.floor(t/this._iconsPerColumn),e.y=y*(t%this._iconsPerColumn)),e.index=t,e.setStyles({left:e.x+"px",top:e.y+"px",webkitTransform:""})},a.prototype.computeMinimumSize=function(e,t){return this._sizeInIcons=e,e*y+b[t]},a.prototype._resize=function(){var e,t=window.gui.ipadRatio?"narrow":"wide";window.gui.ipadRatio?(this._iconsPerLine=this._sizeInIcons,this._iconsPerColumn=Math.ceil(T.length/this._iconsPerLine),this.setStyles({top:"",right:"",bottom:0,left:c.posMenuBar+"px",width:c.menuBarSize+"px",height:c.bottomBarHeight+"px"}),this._icons.setStyle("height",y*this._iconsPerColumn+M[t]+"px"),this._icons.setStyle("width",y*this._iconsPerLine+"px"),e="top"):(this._iconsPerColumn=this._sizeInIcons,this._iconsPerLine=Math.ceil(T.length/this._iconsPerColumn),this.setStyles({bottom:"",left:"",top:c.posMenuBar+"px",right:0,width:c.sideBarWidth+"px",height:c.menuBarSize+"px"}),this._icons.setStyle("width",y*this._iconsPerLine+M[t]+"px"),e="left"),this._reorderButtons(),this.setOpeningSide(e)},a.prototype._addPlusIcon=function(e,t){t=t||{};var i=this.getIcon(e);if(i){!t.doNotShow&&window.gui.uiLocker.isMenuButtonAvailable(e)&&i.addClassNames("plusIcon");var n=this._plusIconList;n.indexOf(e)===-1&&n.push(e)}},a.prototype._removePlusIcon=function(e){var t=this.getIcon(e);if(t){var i=this._plusIconList,n=i.indexOf(e);n>=0&&(t.delClassNames("plusIcon"),i.splice(n,1))}},a.prototype._clearPlusIconsStyle=function(){for(var e=this._icons.getChildren(),t=0;t<e.length;t+=1){var i=e[t];i.delClassNames("plusIcon")}},a.prototype._showPlusIcons=function(){for(var e=this._plusIconList,t=0;t<e.length;t+=1){var i=e[t],n=this.getIcon(i);n.addClassNames("plusIcon")}}},function(e,t){},function(e,t,i){function n(e){function t(){var e=n.isOpen;n._resize(),window.setTimeout(function(){n.getCurrentDrawerSize()>=n.getCurrentContentSize()?(n.setAsAlwaysOpen(!0),i.hide()):(n.setAsAlwaysOpen(!1),i.show()),n.refresh(),e&&n.shouldKeepOpen&&n.open()},0)}e=e||{},s.call(this,{className:"MenuDrawer",background:!0,autoClose:e.autoClose,backDrawerSize:e.backDrawerSize}),this.shouldKeepOpen=!1;var i,n=this;window.gui.once("connected",function(){this.on("resize",function(){t()}),t()}),window.gui.on("disconnect",function(){n.close()}),this.content.createChild("div",{className:"topBorder"}),i=this.content.createChild("div",{className:"arrowBtnBg"}),i.appendChild(new a({className:"arrowBtn"},function(){n.isOpen?n.close():n.open()}));var o=l.getValue("tablet.tutorial.canSwipeDrawer");o||i.once("tap",function(){var e=window.gui.notificationBar,t={type:e.notificationType.PRIORITY_INVITATION,title:r("tablet.tutorial.tip"),text:r("tablet.tutorial.canSwipeDrawer")};e.newNotification("tip canSwipeDrawer",t),l.setValue("tablet.tutorial.canSwipeDrawer",!0)}),this.createChild("div",{className:"borderBox"})}i(657);var o=i(172).inherits,s=i(658),a=i(335),r=i(29).getText,l=i(176);o(n,s),e.exports=n,n.prototype._resize=function(){}},function(e,t){},function(e,t,i){function n(e){function t(e){var t=e[this._axis]-l;t*this._direction<=0?t=0:t*this._direction>this._contentSize-this._visibleSize&&(t=(this._contentSize-this._visibleSize)*this._direction);var i="translate"+this._axis+"("+(this._currentPosition+t)+"px)";this.content.setStyle("webkitTransform",i),this.background&&this.background.setStyle("webkitTransform",i)}function i(e){var t=e[this._axis]-l;t*this._direction>=0?t=0:t*this._direction<this._visibleSize-this._contentSize&&(t=(this._visibleSize-this._contentSize)*this._direction);var i="translate"+this._axis+"("+(this._currentPosition+t)+"px)";this.content.setStyle("webkitTransform",i),this.background&&this.background.setStyle("webkitTransform",i)}function n(){c=!0}function o(){c||d.close(),c=!1}r.call(this,"div",{className:"SwipingDrawer"}),e=e||{},this.addClassNames(e.className),e.background&&(this.backgroundArea=this.createChild("div",{className:"drawerBackgroundArea"}),this.background=this.backgroundArea.createChild("div",{className:"drawerBackground"})),this.visibleArea=this.createChild("div",{className:"visibleArea"}),this.content=this.visibleArea.createChild("div",{className:"drawerContent"}),this._contentSize=0,this._extraContentSize=e.backDrawerSize||0,this.isOpen=!1,this._isAlwaysOpen=!1,s(this);var a,l;this.on("slideStart",function(e){this.addClassNames("open"),this._tween1&&(this._tween1.cancel(),this._tween1=null),this._tween2&&(this._tween2.cancel(),this._tween2=null),l=e[this._axis],this.isOpen?(a=(this._contentSize-this._visibleSize)/3,this.on("slide",t)):(a=(this._visibleSize-this._contentSize)/3,this.on("slide",i))}),this.on("slideEnd",function(e,n,o){var s=e[this._axis]-l;this._currentPosition+=s,this.isOpen?(s*this._direction>a||o&&s*this._direction>0?this._close(!0):this._open(!0),this.removeListener("slide",t)):(s*this._direction<a||o&&s*this._direction>0?this._open(!0):this._close(!0),this.removeListener("slide",i))});var c=!1,d=this;e.autoClose&&(this.on("open",function(){this.on("dom.touchstart",n),window.gui.wBody.on("dom.touchstart",o)}),this.on("close",function(){this.removeListener("dom.touchstart",n),window.gui.wBody.removeListener("dom.touchstart",o)})),e.openingSide&&this.setOpeningSide(e.openingSide)}i(659);var o=i(172).inherits,s=i(201),a=i(196),r=i(321),l=1;o(n,r),e.exports=n,n.prototype.getCurrentDrawerSize=function(){return parseInt(this.getStyle(this._dimension),10)},n.prototype.getCurrentContentSize=function(){return this.content.rootElement[this._clientProperty]},n.prototype.setAsAlwaysOpen=function(e){this._isAlwaysOpen=e,this.lockDrawer(e)},n.prototype.lockDrawer=function(e){e!==this.drawerLocked&&(this.close(),this.drawerLocked=e,this.lockSlide(e))},n.prototype.setOpeningSide=function(e){switch(this.side=e,this.replaceClassNames(["top","bottom","left","right"],[e]),e){case"top":this._axis="y",this._dimension="height",this._clientProperty="clientHeight",this._direction=1,this.setSlideDirection("vertical");break;case"bottom":this._axis="y",this._dimension="height",this._clientProperty="clientHeight",this._direction=-1,this.setSlideDirection("vertical");break;case"left":this._axis="x",this._dimension="width",this._clientProperty="clientWidth",this._direction=1,this.setSlideDirection("horizontal");break;case"right":this._axis="x",this._dimension="width",this._clientProperty="clientWidth",this._direction=-1,this.setSlideDirection("horizontal")}},n.prototype.refresh=function(){if(this._visibleSize=this.rootElement[this._clientProperty],this._contentSize=this.getCurrentContentSize(),this._contentSize){this._isAlwaysOpen&&(this._contentSize+=this._extraContentSize);var e,t,i,n,o,s;switch(e=t=i=n=o=s="",this.side){case"top":t=this._visibleSize+"px";break;case"bottom":e=this._visibleSize+"px";break;case"left":n=this._visibleSize+"px";break;case"right":i=this._visibleSize+"px"}if(this.content.setStyles({top:e,bottom:t,left:i,right:n,width:o,height:s,webkitTransform:"translate"+this._axis+"("+100*this._direction+"%)"}),this.setStyle(this._dimension,this._contentSize+"px"),this.background){var a={top:e,bottom:t,left:i,right:n,width:"",height:"",webkitTransform:"translate"+this._axis+"("+100*this._direction+"%)"};a[this._dimension]=this._contentSize+"px",this.background.setStyles(a)}this._currentPosition=this._contentSize*this._direction,this.isOpen=!1,this.delClassNames("open")}},n.prototype._open=function(e){if(e||!(this._opening||this.isOpen||this.drawerLocked)){this._opening=!0,this.addClassNames("open"),this._tween1&&this._tween1.cancel(),this._tween2&&this._tween2.cancel(),e||this.emit("opening");var t=Math.floor(Math.abs(this._visibleSize*this._direction-this._currentPosition)/l),i=this;this._tween1=a.tween(this.content,{webkitTransform:"translate"+this._axis+"("+this._visibleSize*this._direction+"px)"},{time:t,easing:"ease-out"},function(){i._currentPosition=i._visibleSize*i._direction,i._tween1=null,i._opening=!1,i.isOpen||i.emit("open"),i.isOpen=!0}),this.background&&(this._tween2=a.tween(this.background,{webkitTransform:"translate"+this._axis+"("+this._visibleSize*this._direction+"px)"},{time:t,easing:"ease-out"},function(){i._tween2=null}))}},n.prototype.open=function(){this._open(!1)},n.prototype._close=function(e){if(e||!this._closing&&this.isOpen&&!this.drawerLocked){this._closing=!0,this._tween1&&this._tween1.cancel(),this._tween2&&this._tween2.cancel();var t=Math.floor(Math.abs(this._contentSize*this._direction-this._currentPosition)/l);e||this.emit("closing");var i=this;this._tween1=a.tween(this.content,{webkitTransform:"translate"+this._axis+"("+100*this._direction+"%)"},{time:t,easing:"ease-out"},function(){i._currentPosition=i._contentSize*i._direction,i._tween1=null,i._closing=!1,i.emit("close"),i.isOpen=!1,i.delClassNames("open")}),this.background&&(this._tween2=a.tween(this.background,{webkitTransform:"translate"+this._axis+"("+100*this._direction+"%)"},{time:t,easing:"ease-out"},function(){i._tween2=null}))}},n.prototype.close=function(){this._close(!1)}},function(e,t){},function(e,t,i){function n(){d.call(this,{autoClose:!0}),this.addClassNames("MainControls"),this._createDom();var e=this;this._fightCount=0,this.fightLocked=!1,this.fightHelpOn=!1;var t=window.gui;t.on("connected",function(){e._setPreferences(),e._setLayout("roleplay",!0)}),t.on("disconnect",function(){e._fightCount=0,e.fightLocked=!1});var i=t.fightManager;i.on("fightEnterPreparation",function(){e._setLayout("battlePreparation")}),i.on("fightEnterBattle",function(){e._setLayout("battle")}),i.on("fightEnd",function(){e._setLayout("roleplay"),e._creatureModeButton.delClassNames("on")})}i(661);var o=i(337).addTooltip,s=i(335),a=i(166).dimensions,r=i(29).getText,l=i(29).findText,c=i(172).inherits,d=i(656),u=i(662),h=i(176),p=i(194),m=i(666),f=i(349),g=i(667);c(n,d),e.exports=n,n.prototype._resize=function(){var e;window.gui.ipadRatio?(this.setStyles({bottom:0,top:"",right:"",left:a.posMainControlBar+"px",width:a.mainControlBarSize+"px",height:a.bottomBarHeight+"px"}),e="top"):(this.setStyles({bottom:"",top:a.posMainControlBar+"px",right:0,left:"",width:a.sideBarWidth+"px",height:a.mainControlBarSize+"px"}),e="left"),this.setOpeningSide(e)},n.prototype._createDom=function(){function e(e,t){"function"==typeof e&&(t=e),e=e||{};var n=e.className||[];return n.push("controlsButton"),i.appendChild(new s({disable:!!e.disable,tooltip:e.tooltip,className:n,scaleOnPress:!0},t))}var t=this,i=this.buttonBox=this.content.createChild("div",{className:"buttonBox"});this.playerPoints=i.appendChild(new u),this._fightListBtn=e({className:["showFightsButton","roleplayButton"],disable:!0},function(){p.open("fightList")}),o(this._fightListBtn,function(){return r("ui.fightsOnMap",t._fightCount)}),window.gui.playerData.position.on("mapChanged",function(e){var i=e.fights||[];t._fightCount=i.length,t._updateFightListButton()}),window.gui.on("MapFightCountMessage",function(e){t._fightCount=e.fightCount||0,t._updateFightListButton()}),this._tacticalModeBtn=e({className:["tacticalModeButton","battleButton","battlePreparationButton"],tooltip:r("ui.fight.option.tacticMod")},function(){var e=h.getValue("tacticModeEngaged",!1);e?(g.turnOff(),t._tacticalModeBtn.delClassNames("on"),h.setValue("tacticModeEngaged",!1)):(g.turnOn(),t._tacticalModeBtn.addClassNames("on"),h.setValue("tacticModeEngaged",!0))}),this._consoleButton=e({className:["consoleButton","alwaysShowButton"]},function(){p["switch"]("adminConsole")}),this._mapInfoButton=e({className:["mapInfoButton","roleplayButton"],tooltip:r("ui.option.mapInfo")},function(){var e=window.gui.mapCoordinates.toggleDisplay();t._mapInfoButton.toggleClassName("on",e),h.setValue("showMapCoordinates",e)}),this._nicknamesButton=e({className:["nicknamesButton","roleplayButton"],tooltip:r("ui.shortcuts.displayNames")},function(){var e=window.actorManager.areNicknamesOn();t._nicknamesButton.toggleClassName("on",!e),e?window.actorManager.turnNicknamesOff():window.actorManager.turnNicknamesOn()}),this._fightLockButton=e({className:["fightLockButton","battlePreparationButton"],tooltip:r("ui.fight.option.blockJoiner")},function(){t.fightLocked=!t.fightLocked,t._fightLockButton.toggleClassName("on",t.fightLocked),window.dofus.sendMessage("GameFightOptionToggleMessage",{option:f.FIGHT_OPTION_SET_CLOSED})}),this._helpButton=e({className:["helpButton","battlePreparationButton"],tooltip:r("ui.fight.option.help")},function(){t.fightHelpOn=!t.fightHelpOn,t._helpButton.toggleClassName("on",t.fightHelpOn),window.dofus.sendMessage("GameFightOptionToggleMessage",{option:f.FIGHT_OPTION_ASK_FOR_HELP})}),this._leaveButton=e({className:["leaveButton","battleButton","battlePreparationButton"],tooltip:r("ui.common.quit")},function(){var e=window.gui,t=window.dofus.connectionManager;if(e.playerData.isSpectator)return t.sendMessage("GameContextQuitMessage");var i,n=1===e.serversData.settings.serverGameType;i=r(n&&e.fightManager.fightType!==m.FIGHT_TYPE_CHALLENGE?"ui.popup.hardcoreGiveup":"ui.popup.giveup"),e.fightManager.fightType===m.FIGHT_TYPE_PVP_ARENA&&(i+="\n"+r("ui.party.arenaLeaveWarning")),e.openConfirmPopup({title:r("ui.popup.warning"),message:i,cb:function(e){e&&t.sendMessage("GameContextQuitMessage")}})}),this._creatureModeButton=e({className:["creatureModeButton","alwaysShowButton"],tooltip:r("ui.fight.option.invisible")},function(){var e=window.isoEngine.actorManager,i=!h.getValue("creatureMode",!1);t._creatureModeButton.toggleClassName("on",i),h.setValue("creatureMode",i),e.setCreatureMode(i)}),this._transparentModeButton=e({className:["transparentModeButton","alwaysShowButton"],tooltip:r("ui.option.transparentOverlayMode")},function(){var e=window.isoEngine.actorManager,i=!e.isTransparentModeOn;t._transparentModeButton.toggleClassName("on",i),h.setValue("transparentMode",i),e.setTransparentMode(i)}),this._interactiveBlink=e({className:["interactiveBlinkBtn","roleplayButton"],tooltip:l("Toggle interactive halo")},function(){var e=!window.isoEngine.interactiveBlink;window.isoEngine.setInteractiveBlink(e),e&&window.isoEngine.highlightInteractivesWithDifferentType(),t._interactiveBlink.toggleClassName("on",e),h.setValue("interactiveBlink",e)}),this._progressBarPref=e({className:["progressBarPrefBtn","roleplayButton"],tooltip:r("ui.banner.customGauge")},function(){window.gui.progressGauge.openPrefMenu()}),e({className:["globalMenu","alwaysShowButton"],tooltip:r("ui.common.mainMenu")},function(){p["switch"]("global")})},n.prototype._setLayout=function(e,t){switch(e){case"roleplay":this.replaceClassNames(["battlePreparation","battle"],["roleplay"]),this.playerPoints.actionAndMovement.hide();break;case"battlePreparation":this.replaceClassNames(["roleplay","battle"],["battlePreparation"]),this.fightHelpOn=!1,this._helpButton.delClassNames("on"),this.buttonBox.getChildren()[2]!==this._leaveButton&&this._leaveButton.insertBefore(this._tacticalModeBtn);break;case"battle":this.replaceClassNames(["roleplay","battlePreparation"],["battle"]),this.buttonBox.getChildren()[3]!==this._leaveButton&&this._leaveButton.insertBefore(this._consoleButton),window.gui.playerData.isSpectator||this.playerPoints.actionAndMovement.show()}var i=window.gui.playerData;this._consoleButton.toggleDisplay(i.isModeratorOrMore()||i.isForcedAccount),this._nicknamesButton.toggleClassName("on",window.actorManager.areNicknamesOn()),t||(this._resize(),this.refresh())},n.prototype._setPreferences=function(){var e=h.getValue("showMapCoordinates",!1);this._mapInfoButton.toggleClassName("on",e),window.gui.mapCoordinates.toggleDisplay(e);var t=h.getValue("tacticModeEngaged",!1);this._tacticalModeBtn.toggleClassName("on",t);var i=h.getValue("interactiveBlink",!0);this._interactiveBlink.toggleClassName("on",i),window.isoEngine.setInteractiveBlink(i);var n=h.getValue("creatureMode",!1);this._creatureModeButton.toggleClassName("on",n),window.isoEngine.actorManager.setCreatureMode(n);var o=h.getValue("transparentMode",!1);this._transparentModeButton.toggleClassName("on",o),window.isoEngine.actorManager.setTransparentMode(o)},n.prototype._updateFightListButton=function(){var e=this._fightCount>0;this._fightListBtn.setEnable(e),this._fightListBtn.toggleClassName("on",e)}},function(e,t){},function(e,t,i){function n(){function e(e){s._lifePoints=e,s.displayLifePoints()}function t(e){s._maxLifePoints=e,s.displayLifePoints()}function i(e){s.actionPointsNumber.setText(e)}function n(e){s.movementPointsNumber.setText(e)}l.call(this,"div",{className:"playerPoints"});var s=this;this._lifePoints=1,this._maxLifePoints=1,this._shieldPoints=0,window.gui.on("connected",function(){s.lifeDisplay=c.getValue("lifeDisplayMode","simple")}),window.gui.on("disconnect",function(){s.lifeGauge.setStyle("height","0%"),s.lifePointsNumber.clearContent(),s._shieldPoints=0,s.updateShieldUI()});var d=this.actionAndMovement=this.createChild("div",{className:"actionAndMovement"});this.actionPointsNumber=d.createChild("div",{className:["number","actionPoints"]}),this.movementPointsNumber=d.createChild("div",{className:["number","movementPoints"]}),o(this.actionPointsNumber,a("ui.common.ap")),o(this.movementPointsNumber,a("ui.common.mp"));var u=this.createChild("div",{className:"lifePointsWrapper"}),h=u.createChild("div",{className:"lifeHeart"});this.lifeGauge=h.createChild("div",{className:"lifeGauge"}),u.createChild("div",{className:"highlights"}),this.lifePointsNumberWrapper=u.createChild("div",{className:"numberWrapper"}),this.lifePointsNumber=this.lifePointsNumberWrapper.createChild("div",{className:"number"}),u.appendChild(new r),o(h,a("ui.common.lifePoints")),h.on("tap",function(){s.switchLifeDisplay()}),window.gui.playerData.on("lifePointsUpdated",function(t){e(t)}),window.gui.playerData.on("maxLifePointsUpdated",function(e){t(e)}),window.gui.playerData.on("actionPointsCurrentUpdated",function(e){i(e)}),window.gui.playerData.on("movementPointsCurrentUpdated",function(e){n(e)}),window.gui.fightManager.on("shieldPointsUpdated",function(e,t){e===window.gui.playerData.characters.controlledCharacterId&&(s._shieldPoints=t,s.updateShieldUI())})}i(663);var o=i(337).addTooltip,s=i(172).inherits,a=i(29).getText,r=i(664),l=i(321),c=i(176);s(n,l),n.prototype.updateShieldUI=function(){this._shieldPoints>0?this._addShieldColor():this._removeShieldColor(),this.displayLifePoints()},n.prototype._addShieldColor=function(){this.lifeGauge.addClassNames("shield")},n.prototype._removeShieldColor=function(){this.lifeGauge.delClassNames("shield")},n.prototype.switchLifeDisplay=function(){switch(this.lifeDisplay){case"simple":this.lifeDisplay="total";break;case"total":this.lifeDisplay="percentage";break;case"percentage":this.lifeDisplay="simple"}c.setValue("lifeDisplayMode",this.lifeDisplay),this.displayLifePoints()},n.prototype.displayLifePoints=function(){var e=this._lifePoints/this._maxLifePoints*100;switch(this.lifeGauge.setStyle("height",e+"%"),this.lifeDisplay){case"simple":this._shieldPoints>0?this.lifePointsNumber.setHtml(this._lifePoints+"<br>"+this._shieldPoints):this.lifePointsNumber.setHtml(this._lifePoints);break;case"total":this.lifePointsNumber.setHtml(this._lifePoints+"<br>"+this._maxLifePoints);break;case"percentage":this.lifePointsNumber.setHtml(Math.round(e)+"%")}},e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,"div"),this._currentServerLag(0);var e=this;window.gui.on("checkServerLag",function(t,i){e.checkServerLag(t,i)})}i(665);var o=i(172).inherits,s=i(321),a=1500,r=800;o(n,s),e.exports=n,n.prototype._currentServerLag=function(e){e>a?(this.setClassNames(["networkIndicator","bad"]),console.debug("Current server lag is bad:",e)):e>r?this.setClassNames(["networkIndicator","slow"]):this.setClassNames(["networkIndicator","good"])},n.prototype.checkServerLag=function(e,t){if("start"===t)this.serverLagEventName=e,this.serverLagStart=Date.now();else if("stop"===t){if(this.serverLagEventName!==e)return;this._currentServerLag(Date.now()-this.serverLagStart),this.serverLagEventName=null}else console.warn("Invalid action emitted to checkServerLag",e,":",t)}},function(e,t){},function(e,t){e.exports={FIGHT_TYPE_CHALLENGE:0,FIGHT_TYPE_AGRESSION:1,FIGHT_TYPE_PvMA:2,FIGHT_TYPE_MXvM:3,FIGHT_TYPE_PvM:4,FIGHT_TYPE_PvT:5,FIGHT_TYPE_PvMU:6,FIGHT_TYPE_PVP_ARENA:7,FIGHT_TYPE_Koh:8}},function(e,t,i){function n(){var e=c.getValue("tacticModeEngaged",!1);e&&m.isFightMode?o():r()}function o(){var e=window.isoEngine.mapRenderer;e.isReady?(e.hideGraphics(),e.hideStatedElements(),window.background.hide(),s(),a(),_.show(),g.show()):e.once("ready",o)}function s(){if(g&&g.remove(),_&&_.remove(),f)for(var e=0;e<f.length;e++)f[e].remove()}function a(){f=p(),g=h(),_=u(m.isRoleplayMode)}function r(){l();var e=window.isoEngine.mapRenderer;window.background.show(),e.showGraphics(),e.showStatedElements(),g=null,_=null,f=null}function l(){if(_&&_.hide(),g&&g.hide(),f)for(var e in f)f[e].hide()}var c=i(176),d=i(668),u=d.makeTacticalBoxes,h=d.makeTacticalBackground,p=d.makeTacticGraphics,m=i(258),f=null,g=null,_=null;m.on("gameContextChanged",n),t.turnOn=o,t.turnOff=r},function(e,t,i){function n(e){for(var t=window.isoEngine.mapRenderer,i=[],n=t.map.cells,o=0;o<a.NB_CELLS;o++){var s=t.isWalkable(o);if(s){var r=n[o],u=l.cellCoord[o],h=(e&&r.f||0)+g,_=u.x,y=_-m,b=_+m,M=u.y-h,w=M+f,T=M+p,C=new c(_,M,b,w,_,T,y,w);C.cellId=o,i.push(C)}}var A=new d({scene:window.isoEngine.mapScene,x:0,y:0,position:-3,boxes:i,hue:v,layer:S,id:"tacticalBoxes"});return A}function o(){return new d({scene:window.isoEngine.mapScene,x:0,y:0,position:-4,boxes:[new c((-h),(-p),(-h),I,A,I,A,(-p))],hue:_,layer:S,id:"tacticalBackground"})}function s(){for(var e=window.isoEngine.mapRenderer,t=e.map.cells,i=[],n=0;n<y;n++)if(!(7&t[n].l)){var o=l.cellCoord[n],s=e.mapScene.createTexture(r(),"roleplayTacticBlock","linear","permanent");i.push(new u({id:"tacticGraphic"+n,position:n,hue:[1,1,1,1],x:o.x-T/2,y:o.y-p,g:1,w:T,h:C,scene:e.mapScene},s))}return i}var a=i(167),r=i(669).createTacticBlockImage,l=i(670),c=i(671),d=i(672),u=i(673),h=a.CELL_WIDTH,p=a.CELL_HEIGHT,m=h/2,f=p/2,g=a.GRID_ALTITUDE_OFFSET,_=[0,0,0,1],v=[.569,.522,.38,1],y=a.NB_CELLS,b=2,M=a.CELL_WIDTH,w=Math.round(1.5*p),T=M+b,C=w+b,A=a.MAP_SCENE_WIDTH,I=a.MAP_SCENE_HEIGHT,S=a.MAP_LAYER_BACKGROUND;t.makeTacticalBoxes=n,t.makeTacticalBackground=o,t.makeTacticGraphics=s},function(e,t,i){var n=i(167),o=n.CELL_HEIGHT,s=n.CELL_WIDTH,a=Math.round(1.5*o);e.exports.createTacticBlockImage=function(){var e=document.createElement("canvas");e.width=s,e.height=a;var t=e.getContext("2d");t.clearRect(0,0,s,a),t.fillStyle="#5A523C",t.strokeStyle="#CCCCCC";var i=[s/2,s,s,s/2,0,0],n=[0,o/2,o,a,o,o/2];t.beginPath(),t.moveTo(0,o/2);for(var r=0;r<i.length;r++)t.lineTo(i[r],n[r]);return t.closePath(),t.fill(),t.stroke(),t.lineTo(s/2,o),t.lineTo(s,o/2),t.moveTo(s/2,o),t.lineTo(s/2,a),t.stroke(),e}},function(e,t,i){function n(e){var t=e%14,i=Math.floor(e/14);return t+=i%2*.5,{x:t*a,y:.5*i*r}}function o(){for(var e=0;e<560;e+=1)l.push(n(e));return Object.freeze(l),l}var s=i(167),a=s.CELL_WIDTH,r=s.CELL_HEIGHT;e.exports.getCellCoord=n;var l=[];e.exports.cellCoord=o()},function(e,t){function i(e,t,i,n,o,s,a,r){this.x0=e,this.y0=t,this.x1=i,this.y1=n,this.x2=o,this.y2=s,this.x3=a,this.y3=r,this.cellId=null}e.exports=i},function(e,t,i){function n(e){s.call(this,e),this._boxes=e.boxes,this._boxByteSize=this.renderer.getNbBytesPerBox(),this._bbox=[1/0,-(1/0),1/0,-(1/0)],this._createVertexBuffer()}var o=i(172).inherits,s=i(375);o(n,s),e.exports=n,n.prototype._createVertexBuffer=function(){var e=this._boxes.length;this._vertexBuffer=new ArrayBuffer(e*this._boxByteSize),this._positions=new Float32Array(this._vertexBuffer),this._colorView=new Uint32Array(this._vertexBuffer);for(var t=1077952576,i=0;i<e;i+=1){var n=this._boxes[i];this._expandToFitBox(n);var o=i*this._boxByteSize/4;this._positions[o+0]=n.x0,this._positions[o+1]=n.y0,this._colorView[o+3]=t,this._positions[o+5]=n.x2,this._positions[o+6]=n.y2,this._colorView[o+8]=t,this._positions[o+10]=n.x3,this._positions[o+11]=n.y3,this._colorView[o+13]=t,this._positions[o+15]=n.x0,this._positions[o+16]=n.y0,this._colorView[o+18]=t,this._positions[o+20]=n.x1,this._positions[o+21]=n.y1,this._colorView[o+23]=t,this._positions[o+25]=n.x2,this._positions[o+26]=n.y2,this._colorView[o+28]=t}this._bbox[0]+=this._x,this._bbox[1]+=this._x,this._bbox[2]+=this._y,this._bbox[3]+=this._y,this.renderer.releaseBuffer(this.id),this.forceRefresh()},n.prototype.draw=function(){this.renderer.drawBoxBatch(this.id)},n.prototype._expandToFitPoint=function(e,t){this._bbox[0]>e&&(this._bbox[0]=e),this._bbox[2]>t&&(this._bbox[2]=t),this._bbox[1]<e&&(this._bbox[1]=e),this._bbox[3]<t&&(this._bbox[3]=t)},n.prototype._expandToFitBox=function(e){this._expandToFitPoint(e.x0,e.y0),this._expandToFitPoint(e.x1,e.y1),this._expandToFitPoint(e.x2,e.y2),this._expandToFitPoint(e.x3,e.y3)},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=this._positions,n=!1;this.renderer.loadSpriteBuffer(t,i,null,this._bbox,n),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t,i){function n(e,t){s.call(this,e),this.w=e.w||0,this.h=e.h||0,this.texture=t}var o=i(172).inherits,s=i(375);o(n,s),e.exports=n,n.prototype.render=function(){this.renderer.save(),this.renderer.multiplyColor(this.tint[0],this.tint[1],this.tint[2],this.tint[3]),this.renderer.drawImage(this.texture,this._x,this._y,this.w*this._scaleX,this.h),this.renderer.restore()},n.prototype.generateCurrentFrameData=function(){return[0,this.w,0,this.h]},n.prototype.clear=function(){this.texture&&this.texture.release()}},function(e,t,i){function n(){d.call(this,"div",{className:"NotificationBar",hidden:!0}),this.notificationType=h.notificationType,a(this),this.currentOpenedId=null,this.dialogs={},this.container=this.createChild("div",{className:"container"}),this.counter=this.createChild("div",{className:"counter"});var e=this;this.on("dragStart",function(){e.hideDialog(e.currentOpenedId)}),window.gui.on("disconnect",function(){e.clearNotifications()})}i(675);var o=i(182),s=i(172).inherits,a=i(598),r=i(334),l=i(196),c=i(335),d=i(321),u=i(247).playUiSound,h=i(676),p=h.notificationImageInfo,m=12,f="blue";s(n,d),e.exports=n,n.prototype._updateCounter=function(){var e=this.container.getChildren().length;this.counter.setText(e),this.toggleDisplay(e)},n.prototype._repositionDialog=function(e){var t=this.dialogs[e],i=this.container.getChild(e);r.positionNextTo(t,i)},n.prototype._destroyNotification=function(e,t){if(this.dialogs[e]){this.dialogs[e].destroy(),delete this.dialogs[e];var i=this.container.getChild(e),n=i.getChild("icon");if("function"==typeof n.cancelTween&&n.cancelTween(),i.destroy(),this._updateCounter(),!t&&this.currentOpenedId)if(e===this.currentOpenedId){this.currentOpenedId=null;var o=this.container.getChildren();if(o.length){var s=o[o.length-1].getWuiName();this.showDialog(s,!0)}}else this._repositionDialog(this.currentOpenedId)}},n.prototype.clearNotifications=function(){for(var e in this.dialogs)this._destroyNotification(e,!0);this.currentOpenedId=null},n.prototype._notificationButtonAction=function(e){return this.currentOpenedId===e?this.hideDialog(e):void this.showDialog(e)},n.prototype._createDialog=function(e,t){function i(){o.removeNotification(e),t.onClose&&t.onClose(-1)}function n(){var i=this.index,n=t.buttons[i].action(i);switch(n){case"HIDE_DIALOG":o.hideDialog(e);break;default:o.removeNotification(e)}}var o=this,s=new d("div");s.createChild("div",{className:"dialogTitle",text:t.title}),s.appendChild(new c({className:"closeBtn"},i)),t.wuidom?(s.createChild("div",{className:"dialogText"}),s.appendChild(t.wuidom)):s.createChild("div",{className:"dialogText",text:t.text});var a=s.createChild("div",{className:"buttons"});if(t.buttons){t.buttons.length>1&&!t.onClose&&console.warn("Notification needs an onClose function");for(var r=0;r<t.buttons.length;r++){var l=a.appendChild(new c({className:"button",text:t.buttons[r].label},n));l.index=r}}var u=window.gui.gameGuiContainer.createChild("div",{className:"NotificationDialog"});u.appendChild(s),this.dialogs[e]=u},n.prototype._createNotification=function(e,t){var i=this,n=this.container.createChild("div",{className:"notificationButton",name:e}),s=n.appendChild(new c({className:["icon","spinner"],name:"icon"},function(){i._notificationButtonAction(this.notifId)}));s.notifId=e;var a="",r="";if(!isNaN(t.type)){var d=p[t.type]||{};a=d.icon||a,r=d.color||r}a=t.iconId||a,r=t.iconColor||r;var u=["gfx/notifications/"+(a||m)+".png","gfx/notifications/"+(r||f)+".png"];o.preloadImages(u,function(o){if(s&&s.rootElement&&(s.setStyle("backgroundImage",o[0]+", "+o[1]),s.delClassNames("spinner"),t.timer)){var a=parseInt(t.timer,10),r=n.createChild("div",{className:"timer"}),c=l.tween(r,{height:"100%"},{time:a,easing:"linear"},function(){i.removeNotification(e)});s.cancelTween=c.cancel}})},n.prototype.showDialog=function(e,t){this.hideDialog(this.currentOpenedId),this.currentOpenedId=e;var i=this.container.getChild(e);i.addClassNames("opened"),t&&i.rootElement.scrollIntoView(!1),this._repositionDialog(e),u("NEW_TIPS")},n.prototype.hideDialog=function(e){if(e&&e===this.currentOpenedId){var t=this.container.getChild(e);t.delClassNames("opened"),this.currentOpenedId=null,this.dialogs[e].hide()}},n.prototype.removeNotification=function(e){var t=this.dialogs[e];if(t){var i=this;window.setTimeout(function(){i._destroyNotification(e)},0)}},n.prototype.newNotification=function(e,t){this._createNotification(e,t),this._updateCounter(),this._createDialog(e,t),this.showDialog(e,!0)},n.prototype.isNotificationOpen=function(e){return!!this.dialogs[e]}},function(e,t){},function(e,t){var i={TUTORIAL:0,ERROR:1,INVITATION:2,PRIORITY_INVITATION:3,INFORMATION:4};t.notificationType=i,t.notificationPriority=[i.ERROR,i.PRIORITY_INVITATION,i.INVITATION,i.INFORMATION,i.TUTORIAL];var n={};n[i.TUTORIAL]={icon:11,color:"green"},n[i.ERROR]={icon:11,color:"red"},n[i.INVITATION]={icon:12,color:"blue"},n[i.PRIORITY_INVITATION]={icon:10,color:"blue"},n[i.INFORMATION]={icon:27,color:"yellow"},t.notificationImageInfo=n},function(e,t,i){function n(){this.inDialog=!1,this.npcData=null,this.npcActorId=null,this.uiReplyHandler=this._uiReplyHandler.bind(this),this._setListeners()}function o(e,t){for(var i=0;i<t.length;i++)e=e.replace("#"+(i+1),t[i]);return e}var s=i(30);e.exports=n,n.prototype._setListeners=function(){var e=window.dofus.connectionManager,t=this;e.on("NpcGenericActionFailureMessage",function(){window.foreground.unlock("npcActionRequest")}),e.on("NpcDialogCreationMessage",function(e){t.npcActorId=e.npcId,window.foreground.lock("npcActionRequest")}),e.on("GameContextCreateMessage",function(){window.foreground.unlock("npcActionRequest")}),window.isoEngine.on("mapLoaded",function(){window.foreground.unlock("npcActionRequest")}),e.on("NpcDialogQuestionMessage",function(e){if(!t.npcData){var i=window.actorManager.getActor(t.npcActorId).data.npcData;t.prepareDialog(i)}t.nextQuestionAsync(e.messageId,e.visibleReplies,e.dialogParams)}),e.on("LeaveDialogMessage",function(){window.foreground.unlock("npcActionRequest"),t.inDialog&&(window.gui.npcDialogUi.leaveDialog(),t.inDialog=!1)}),e.on("ExchangeLeaveMessage",function(){window.foreground.unlock("npcActionRequest")})},n.prototype.prepareDialog=function(e){this.npcData=e;var t,i,n=this.msgTextIds={};for(i=0;i<e.dialogMessages.length;i++)t=e.dialogMessages[i],n[t[0]]=t[1];for(n=this.replyTextIds={},i=0;i<e.dialogReplies.length;i++)t=e.dialogReplies[i],n[t[0]]=t[1]},n.prototype.nextQuestionAsync=function(e,t,i){this.inDialog=!0,this.replyIds=t,window.gui.npcDialogUi.prepareForNextQuestion(this.npcData,t.length);for(var n=this.msgTextIds[e],a=[n],r=0;r<t.length;r++)a.push(this.replyTextIds[t[r]]);var l=this;s.getText(a,function(e,s){if(e)return console.error("Failed to get texts for NPC. textIds:",a,"error:",e),l._closeDialog();var c=o(s[n],i),d=[];for(r=0;r<t.length;r++)d.push(s[l.replyTextIds[t[r]]]);
l._showUi(c,d)})},n.prototype._uiReplyHandler=function(e){null!==e?window.dofus.sendMessage("NpcDialogReplyMessage",{replyId:this.replyIds[e]}):this._closeDialog()},n.prototype._closeDialog=function(){window.dofus.sendMessage("LeaveDialogRequestMessage",null),this.npcData=null},n.prototype._showUi=function(e,t){var i={npcData:this.npcData};window.gui.npcDialogUi.showNpcQuestion(e,t,this.uiReplyHandler,i)}},function(e,t,i){function n(){f.call(this,"div",{className:"npcDialogUi",hidden:!0}),this.inDialog=!1,this.replyHandler=null,this.npcName=null,this.currentMsg=null,this.msgBubble=null,this.singleMsgBubbles={},this.isZoomed=!1,this.isChangingZoom=!1,this.uiBox=null,window.gui.on("disconnect",this._closeDialog.bind(this)),this.highlightRepliesFunc=this._highlightReplies.bind(this)}function o(){this.myUi._sendReply(null)}function s(){this.myUi._sendReply(this.replyId)}function a(){var e=this.myUi.replyTabs;e.swipeNegative()}function r(){var e=this.myUi.replyTabs;e.swipePositive()}function l(){var e=this.myUi;e.leftBtn.setEnable(!!this.leftTab),e.rightBtn.setEnable(!!this.rightTab)}function c(e,t,i,n,o){e.replyId=t,e.setText(i),e.enable(),e.setStyles({width:n,lineHeight:M+"px",minHeight:o+"px"}),e.show()}i(679);var d=i(335),u=i(166).dimensions,h=i(339),p=i(172).inherits,m=i(563),f=i(321),g=150,_=10,v=4,y=10,b=4,M=22,w=50,T=70,C={1:"100%",2:"50%",3:"33.3%",4:"25%"},A="25%",I={1:"40%",2:"60%"},S="100%";p(n,f),e.exports=n,n.prototype._closeDialog=function(){this.inDialog&&(this.inDialog=!1,window.foreground.removeListener("dom.touchend",this.highlightRepliesFunc),this.replyHandler&&this.replyHandler(null),this.msgBubble&&(this.msgBubble.close(),this.msgBubble=null),this.hide(),this._restoreZoom(),window.gui.boxArranger.removeBox(this.uiBox),this.uiBox=null,this.emit("closed"))},n.prototype._newButton=function(e,t,i){var n=e.appendChild(new d({className:t,addIcon:!0},i));return n.myUi=this,n},n.prototype._createContent=function(){this.setStyles({left:u.mapLeft+y+"px",width:u.mapWidth-2*y+"px",bottom:u.screenHeight-u.screenExceptToolbar.height+v+"px"});var e=this.frame=this.createChild("div",{className:"frame"});this.leftBtn=this._newButton(e,"leftBtn",a);var t=this.replyTabs=e.appendChild(new m({noHeader:!0,noCycling:!0}));t.myUi=this,t.on("openTab",l),this.replyElts=[],this.replyBoxes=[],this.numReplyTabs=0,this.numUsedReplyTabs=0,this.rightBtn=this._newButton(e,"rightBtn",r),this.closeBtn=this._newButton(e,"closeBtn",o)},n.prototype._prepareReplyButtons=function(){for(var e=this.replies,t=e.length,i=Math.ceil(t/b),n=this.numReplyTabs;n<i;n++){var o=this.replyBoxes[n]=new f("div",{className:"replyBox"});this.replyTabs.addTab("",o,n),this.numReplyTabs++;for(var a=0;a<b;a++){var r=o.appendChild(new d({className:"reply"},s));r.myUi=this,this.replyElts.push(r)}}for(n=t;n<this.replyElts.length;n++)this.replyElts[n].hide();for(this.leftBtn.toggleDisplay(i>1),this.rightBtn.toggleDisplay(i>1),this.replyBoxes[0].setStyle("textAlign",i>1?"left":"center"),n=this.numUsedReplyTabs;n<this.numReplyTabs;n++)this.replyTabs.toggleTabAvailability(n,n<i);this.numUsedReplyTabs=i;var l=C[t]||A;for(n=0;n<t;n++)c(this.replyElts[n],n,e[n],l,w)},n.prototype._setAllReplyBoxesVisibility=function(e){for(var t=0;t<this.numUsedReplyTabs;t++)this.replyBoxes[t].toggleDisplay(e)},n.prototype._resizeAndAppear=function(e){this.replyTabs.setStyle("opacity",0),this._setAllReplyBoxesVisibility(!1),this._prepareReplyButtons(),this._setAllReplyBoxesVisibility(!0),e&&(this.setStyle("opacity",0),this.show());var t=I[this.replies.length]||S;this.frame.setStyles({width:t});for(var i,n=T,o=this.replies,s=0;s<o.length;s++)i=this.replyElts[s].rootElement.offsetHeight,n=Math.max(n,i);for(this.replyTabs.setStyle("min-height",n+"px"),s=0;s<o.length;s++){var a=this.replyElts[s];if(i=a.rootElement.offsetHeight,i!==n){var r=1+(i-w)/M,l=Math.round(M+(n-i)/r);a.setStyles({"line-height":l+"px",minHeight:n+"px"})}}if(this.replyTabs.reopen(),this.leftBtn.setEnable(!!this.replyTabs.leftTab),this.rightBtn.setEnable(!!this.replyTabs.rightTab),this.closeBtn.toggleDisplay(!window.gui.tutorialManager.inTutorial),this.replyTabs.setStyle("opacity",1),e){var c=this.rootElement;this.uiBox=window.gui.boxArranger.addObstacle(0,c.offsetTop-_,u.screenWidth,c.offsetHeight),this._waitZoomChange(this._appear)}},n.prototype._appear=function(){h.showProgressively(this,g)},n.prototype._waitZoomChange=function(e){if(!this.isChangingZoom)return e&&e.call(this);var t=this,i=window.isoEngine.mapScene.camera;i.once("atDestination",function(){return t.isChangingZoom&&(t.isChangingZoom=!1,t.isZoomed&&i.freeze()),e&&e.call(t)})},n.prototype._zoomOnActor=function(e){if(this.isZoomed)return this._waitZoomChange(e);this.isZoomed=!0,this.isChangingZoom=!0;var t=this.actor.bbox,i=window.isoEngine.mapScene.camera;this.previousZoom=i.zoom,this.previousCameraX=i.x,this.previousCameraY=i.y,i.zoom!==i.maxZoom&&i.zoomTo(i.maxZoom),i.moveTo(t[1],t[2],!0),this._waitZoomChange(e)},n.prototype._restoreZoom=function(e){if(!this.isZoomed)return this._waitZoomChange(e);this.isZoomed=!1,this.isChangingZoom=!0;var t=window.isoEngine.mapScene.camera;t.unfreeze(),t.zoom!==this.previousZoom&&t.zoomTo(this.previousZoom),t.moveTo(this.previousCameraX,this.previousCameraY,!0),this._waitZoomChange(e)},n.prototype._sendReply=function(e){var t=this.replyHandler;t&&(this.replyHandler=null,null!==e&&this.replyElts[e].disable(),this.msgBubble&&(this.msgBubble.close(),this.msgBubble=null),t(e))},n.prototype._bubbleTapHandler=function(){return 1===this.replies.length?this._sendReply(0):void this._highlightReplies()},n.prototype._showLockedBubble=function(){this.replyHandler&&(this.bubbleTapHandler||(this.bubbleTapHandler=this._bubbleTapHandler.bind(this)),this.msgBubble=window.gui.newSpeechBubble({msg:this.currentMsg,title:this.npcName,actor:this.actor,isLocked:!0,action:this.bubbleTapHandler}))},n.prototype._showSingleMsgBubble=function(){var e=this,t=this.npcName;this.singleMsgBubbles[t]=window.gui.newSpeechBubble({msg:this.currentMsg,title:t,actor:this.actor,onClose:function(){delete e.singleMsgBubbles[t]}}),this.replyHandler(null)},n.prototype._closeSingleMsgBubbles=function(){for(var e in this.singleMsgBubbles)this.singleMsgBubbles[e].close()},n.prototype._highlightReplies=function(){var e=this.frame.createChild("div",{className:"highlight"});window.setTimeout(function(){e.destroy()},250)},n.prototype._showQuestion=function(){this.frame||this._createContent();var e=!this.inDialog;this.inDialog=!0,this._closeSingleMsgBubbles(),e?this._zoomOnActor(this._showLockedBubble):this._showLockedBubble(),this._resizeAndAppear(e),e&&window.foreground.on("dom.touchend",this.highlightRepliesFunc),this.emit("opened")},n.prototype.prepareForNextQuestion=function(e,t){t?this.inDialog||(this.actor=window.actorManager.getActorFromNpcId(e.id),this._zoomOnActor()):this._restoreZoom()},n.prototype.showNpcQuestion=function(e,t,i,n){if(n=n||{},this.replies=t,this.replyHandler=i,this.actor=n.actor||window.actorManager.getActorFromNpcId(n.npcData.id),this.npcName=n.npcData&&n.npcData.nameId,this.currentMsg=e,0===t.length){if(this.singleMsgBubbles[this.npcName])return i(null);this._restoreZoom(this._showSingleMsgBubble)}else this._showQuestion()},n.prototype.leaveDialog=function(){this._closeDialog()}},function(e,t){},function(e,t,i){function n(){_.call(this,"div",{className:"numberInputPad",hidden:!0}),this.digits=[],this.overlay=window.gui.gameGuiContainer.createChild("div",{className:"numberPadOverlay",hidden:!0})}function o(){this.numberInput._tapOnKey(this.id)}function s(){this.numberInput._tapOnDisplay(this.id)}i(681);var a,r=i(335),l=i(335).DofusButton,c=i(166).dimensions,d=i(29).getText,u=i(598),h=i(339),p=i(172).inherits,m=i(342),f=i(197),g=i(337),_=i(321),v=m.MAX_NUMBER,y=v.toString().length,b={DISPLAY:0,INSERT:1,EDIT:2},M=["7","8","9","4","5","6","1","2","3","BS","0","000","CLR","ENTER"],w={BS:"@",ENTER:"@ENTER",CLR:"CLR"},T=10;p(n,_),e.exports=n,n.prototype.open=function(e,t,i,n){this.keyboard||this._createContent(),this.inputBox=e,t&&this.title.setText(t),this.minValue=void 0!==i?i:0,this.maxValue=void 0!==n?n:v,this.setValue(e.getValue()),this._switchMode(b.DISPLAY),this._show()},n.prototype._show=function(){if(this.overlay.show(),this.setStyle("opacity",0),this.show(),!a){var e=this.digitBoxes[0].rootElement;a=e.offsetTop+e.offsetHeight/2}var t=this.inputBox.rootElement.getBoundingClientRect(),i=this.rootElement.getBoundingClientRect(),n=t.right-i.width,o=t.top+t.height/2-a;n=Math.min(Math.max(n,T),c.screenWidth-T-i.width),o=Math.min(Math.max(o,T),c.screenHeight-T-i.height),this.setStyles({left:n+"px",top:o+"px"}),this.setStyle("opacity",1),this.rootElement.focus()},n.prototype._createContent=function(){var e=this;window.gui.on("disconnect",function(){e.hide()}),this.on("hide",function(){e.overlay.hide()});var t=this.createChild("div",{className:"titleBar"});u(this,{grip:t,isFullScreen:!0}),this.title=t.createChild("div",{className:"title"});var i=t.appendChild(new r({className:"closeButton",scaleOnPress:!0}));i.on("tap",function(){e.hide()}),this.digitBoxes=[],this.digitElements=[],this.separators=[];for(var n=this.createChild("div",{className:"displayContainer"}),a=d("ui.common.numberSeparator")||".",c=0;c<y;c++){var h=y-1-c,p=h%3===2;p&&(this.separators[h+1]=n.createChild("div",{className:"separator",text:a}));var m=this.digitBoxes[h]=n.createChild("div",{className:"digitBox"});p&&m.addClassNames("groupStart"),m.id=h,m.numberInput=this,f(m),m.on("tap",s),this.digitElements[h]=m.createChild("div",{className:"digit"})}this.keyMap={};var g=this.createChild("div",{className:"keyboardContainer"}),_=this.keyboard=g.createChild("div",{className:"keyboard"});for(c=0;c<M.length;c++){var v=M[c],b=w[v]||v,T=this.keyMap[v]=new l(b,{className:["keyboardKey","key"+v]});"@"===b[0]&&(b.length>1&&T.createChild("div",{text:b.substr(1)}),T.createChild("div",{className:"keyIcon"})),_.appendChild(T),T.id=v,T.numberInput=this,T.on("tap",o)}};var C=/[^0-9]/g;n.prototype.setValue=function(e){"string"==typeof e?(e=e.replace(C,"").toString(),e||(e="0")):e=e.toFixed(),e.length>=y&&(e=e.substr(0,y));for(var t=y-1;t>=e.length;t--)this._setDigit(t,"");for(var i=0;i<e.length;i++)this._setDigit(t,e[i]),t--;"0"===e&&this._switchMode(b.DISPLAY)},n.prototype._getValue=function(){for(var e="",t=y-1;t>=0;t--)e+=this.digits[t];return parseInt(e,10)},n.prototype._enableKey=function(e,t){t?this.keyMap[e].enable():this.keyMap[e].disable()},n.prototype._switchMode=function(e){e!==this.mode&&(this.mode===b.EDIT&&e!==b.EDIT&&this._setCursor(-1),this.mode=e,this._enableKey("BS",this.mode===b.INSERT),this._enableKey("0",this.mode!==b.DISPLAY),this._enableKey("000",this.mode!==b.DISPLAY))},n.prototype._setCursor=function(e){this.cursor>=0&&this.digitBoxes[this.cursor].delClassNames("highlight"),this.cursor=e,this.cursor>=0&&this.digitBoxes[e].addClassNames("highlight")},n.prototype._tapOnDisplay=function(e){this.mode!==b.EDIT&&this._switchMode(b.EDIT),this._setCursor(e)},n.prototype._tapOnKey=function(e){switch(e){case"ENTER":return this._doEnter();case"CLR":return this._doClear();case"000":return this._do000();case"BS":return this._doBackspace();default:return this._doDigit(e)}},n.prototype._doEnter=function(){this._switchMode(b.DISPLAY);var e=this._getValue();return e>this.maxValue?g.showNotification(d("tablet.common.maxValue",h.intToString(this.maxValue)),this.keyMap.ENTER):e<this.minValue?g.showNotification(d("tablet.common.minValue",h.intToString(this.minValue)),this.keyMap.ENTER):(this.inputBox.setValue(e,!0),void this.hide())},n.prototype._doClear=function(){this.setValue("0")},n.prototype._doBackspace=function(){if(this.mode===b.INSERT){var e=Math.floor(this._getValue()/10);this.setValue(e)}},n.prototype._do000=function(){for(var e=0;e<3;e++)this._doDigit("0")},n.prototype._doDigit=function(e){switch(this.mode){case b.DISPLAY:if("0"===e&&0===this._getValue())return;return this.setValue(e),this._switchMode(b.INSERT);case b.INSERT:if(""!==this.digits[y-1])return;return this.setValue(10*this._getValue()+~~e);case b.EDIT:return this._setDigit(this.cursor,e),this._fixZeroes(this.cursor,e),0===this.cursor?this._switchMode(b.INSERT):this._setCursor(this.cursor-1)}},n.prototype._setDigit=function(e,t){this.digitElements[e].setText(t),this.digits[e]=t,this.separators[e]&&this.separators[e].toggleDisplay(""!==t)},n.prototype._fixZeroes=function(e,t){if(0!==e){for(var i=y-1;i>=e;i--){var n=this.digits[i];if("0"!==n&&""!==n)break;"0"===n&&this._setDigit(i,"")}if("0"!==t)for(i=e-1;i>=0&&""===this.digits[i];i--)this._setDigit(i,"0")}}},function(e,t){},function(e,t,i){function n(){c.call(this,"div",{className:"Party",hidden:!0}),u(this,{isCollapsable:!0}),this.numParties=0,this.hasParty={},this.currentPartyType=null,this.currentParty=null,this.invitedFrom={},this.partyTypesById={},this.setupEvents()}function o(e){return e===f.PARTY_TYPE_ARENA?f.PARTY_TYPE_CLASSICAL:f.PARTY_TYPE_ARENA}i(683);var s=i(337).addTooltip,a=i(166).dimensions,r=i(614),l=i(172).inherits,c=i(321),d=i(335),u=i(598),h=i(29),p=h.getText,m=h.processTextWithModifier,f=i(575),g=i(369),_=i(410),v=i(366),y=i(194);l(n,c),e.exports=n,n.prototype._reset=function(){this.hide(),this._cleanData(f.PARTY_TYPE_CLASSICAL,!0),this._cleanData(f.PARTY_TYPE_ARENA,!0)},n.prototype._selectPartyType=function(e){var t=e===f.PARTY_TYPE_ARENA;this.toggleClassName("arena",t),this.currentPartyType=e,this.currentParty=t?this.arenaParty:this.classicParty,this.classicParty.toggleDisplay(!t),this.arenaParty.toggleDisplay(t)},n.prototype._createContent=function(){var e=this;this.createChild("div",{className:"gripIcon"});var t=this.switchPartyButton=this.appendChild(new d({className:"switchPartyButton",hidden:!0}));t.createChild("div",{className:"iconGroup"}),t.createChild("div",{className:"separator"}),t.createChild("div",{className:"iconArena"}),t.on("tap",function(){e._selectPartyType(o(e.currentPartyType))});var i=this.appendChild(new d({className:["optionsButton","greenButton"]}));i.createChild("div",{className:"icon"}),i.on("tap",function(){var t=e.currentParty;window.gui.openContextualMenuAround("partyOptions",i,{partyType:e.currentPartyType,partyId:e.currentParty.partyId,isLoyal:t.isLoyal,isRestricted:t.isRestricted,isLeader:t.partyLeaderId===window.gui.playerData.id})}),this.partyBoxes=this.createChild("div",{className:"partyBoxes"}),this.classicParty=this.partyBoxes.createChild("div",{className:["partyBox","classic"],name:f.PARTY_TYPE_CLASSICAL}),this.arenaParty=this.partyBoxes.createChild("div",{className:["partyBox","arena"],name:f.PARTY_TYPE_ARENA,hidden:!0}),this.setStyles({left:a.mapRight-90+"px",top:"100px"})},n.prototype.addMember=function(e,t){var i=this.partyBoxes.getChild(e),n=t.id||t.guestId,o=i.createChild("div",{className:"member",name:n}),s=new g({scale:"fitin"}),a=t.entityLook||t.guestLook;s.setLook(a,{riderOnly:!0,direction:_.DIRECTION_SOUTH_WEST,animation:"AnimArtwork",boneType:"timeline/",skinType:"timeline/"}),o.appendChild(s),o.on("tap",function(){window.gui.openContextualMenuAround("player",o,{playerId:t.id||t.guestId,playerName:t.name})});var r=o.createChild("div",{className:"hpBar",name:"hpBar"});o.hp=r.createChild("div",{className:"hp",name:"hp"}),o.createChild("div",{className:"pendingIcon",name:"pendingIcon",text:"?"}),o.createChild("div",{className:"leaderIcon",name:"leaderIcon"});var l=o.createChild("div",{className:"followingBadge"});l.createChild("div",{className:"icon"}),this.updateMember(e,t),this.emit("resized")},n.prototype.updateMember=function(e,t){var i=this.partyBoxes.getChild(e),n=t.id||t.guestId,o=i.partyLeaderId===n,s=i.getChild(n);if(s){s.memberData=t,this._updateMemberTooltip(s,o);var a=i.getChildren();o&&a.length>1&&a[0]!==s&&i.insertAsFirstChild(s),s.hp.setStyle("height",t.lifePoints/t.maxLifePoints*100+"%"),s.toggleClassName("guest",!!t.guestId),s.toggleClassName("leader",o)}},n.prototype.addOrUpdateMember=function(e,t){var i=this._getPartyById(e);if(i){var n=i.getChild(t.id);n?(n.memberData=t,this.updateMember(i.type,t)):this.addMember(i.type,t)}},n.prototype.getMemberById=function(e,t){var i=this._getPartyById(e);if(i){var n=i.getChild(t);if(n)return n.memberData}},n.prototype._getPartyById=function(e){var t=this.partyTypesById[e];return t?this.partyBoxes.getChild(t):null},n.prototype._joinParty=function(e,t,i,n,o){this.partyBoxes||this._createContent(),this.hasParty[e]=!0,this.numParties++,this.partyTypesById[t]=e;var s=this.partyBoxes.getChild(e);s.type=e,s.partyLeaderId=i,s.partyId=t,s.isLoyal=!1,s.isRestricted=!0;for(var a=0;a<n.length;a+=1)s.getChild(n[a].id)?this.updateMember(e,n[a]):this.addMember(e,n[a]);for(a=0;a<o.length;a+=1)s.getChild(o[a].id)?this.updateMember(e,o[a]):this.addMember(e,o[a]);var r=s.getChild(i);s.getChildren()[0]!==r&&s.insertAsFirstChild(r),this._selectPartyType(e),this.numParties>=2&&this.switchPartyButton.show(),1===this.numParties&&this.show(),this.emit("resized")},n.prototype._cleanData=function(e,t){if(e&&this.hasParty[e]){this.hasParty[e]=!1,this.numParties--;var i=this.partyBoxes.getChild(e);i.hide(),i.clearContent(),delete i.partyLeaderId;for(var n in this.partyTypesById)parseInt(this.partyTypesById[n],10)===e&&delete this.partyTypesById[n];this.switchPartyButton.hide(),this.numParties>0?this._selectPartyType(o(e)):this.hide(),e===f.PARTY_TYPE_ARENA&&this.removeArenaFightQuestion(),t||this.emit("resized")}},n.prototype._removeMember=function(e,t){var i=this._getPartyById(e);i&&(i.getChild(t).destroy(),this.removeTeleportQuestion(t),this.emit("resized"))},n.prototype.setupEvents=function(){var e=this,t=window.gui,i=t.playerData.partyData,n=window.dofus.connectionManager;t.on("disconnect",function(){e._reset()}),t.on("PartyJoinMessage",function(t){e._joinParty(t.partyType,t.partyId,t.partyLeaderId,t.members,t.guests)}),i.on("partyLeaderUpdate",function(t,i){var n=e._getPartyById(t);if(n){var o=n.getChild(n.partyLeaderId),s=n.getChild(i);n.partyLeaderId=i,e.updateMember(n.type,o.memberData),e.updateMember(n.type,s.memberData)}}),t.on("PartyNewGuestMessage",function(t){var i=e._getPartyById(t.partyId);if(i){var n=t.guest;n.hostName=i.getChild(n.hostId).memberData.name,e.addMember(i.type,n),i.partyId=t.partyId}}),i.on("partyMemberLeaving",function(t,i){e._removeMember(t,i)}),i.on("partyNewMember",function(t,i){e.addOrUpdateMember(t,i)}),i.on("partyUpdateMember",function(t,i){e.addOrUpdateMember(t,i)}),i.on("playerLeavingParty",function(t){e._cleanData(e.partyTypesById[t])}),t.on("GameRolePlayArenaFightPropositionMessage",function(t){e.showArenaFightQuestion(t.fightId)}),t.on("GameRolePlayArenaFighterStatusMessage",function(t){t.accepted||e.removeArenaFightQuestion(t.fightId)}),i.on("partyInvitationCancelled",function(i,n){if(t.playerData.id!==n){var o=e.invitedFrom[i],s=p("ui.party.invitationCancelledForGuest",o);t.chat.logMsg(s),t.notificationBar.removeNotification("party"+i)}}),i.on("partyGuestLeaving",function(n,o,s){var a=i.getGuestName(n,o);if(s){if(s!==t.playerData.characterBaseInformations.id){var r=i.getMemberName(s);t.chat.logMsg(p("ui.party.invitationCancelled",r,a))}}else t.chat.logMsg(p("ui.party.invitationRefused",a));e._removeMember(n,o)}),t.on("PartyFollowStatusUpdateMessage",function(t){if(t.success){var i=e._getPartyById(t.partyId);i&&(e.followedId&&i.getChild(e.followedId).delClassNames("following"),e.followedId=t.followedId,e.followedId&&i.getChild(e.followedId).addClassNames("following"))}}),t.on("PartyUpdateLightMessage",function(t){var i=e._getPartyById(t.partyId);if(i){var n=i.getChild(t.id).getChild("hpBar").getChild("hp");n.setStyle("height",t.lifePoints/t.maxLifePoints*100+"%")}}),n.on("TeleportBuddiesMessage",function(){t.openConfirmPopup({title:p("ui.common.confirm"),message:p("ui.party.teleportMembersProposition"),cb:function(e){n.sendMessage("TeleportBuddiesAnswerMessage",{accept:e})}})}),n.on("TeleportBuddiesRequestedMessage",function(e){for(var n=i.getMemberName(e.inviterId),o=[],s=0;s<e.invalidBuddiesIds.length;s++)o.push(i.getMemberName(e.invalidBuddiesIds[s]));var a=p("ui.party.teleportWish",n,e._dungeonName);o.length&&(a+=" "+m(p("ui.party.teleportCriterionFallenAngels"),o.length,o.join(", "))),t.chat.logMsg(a,v.CHANNEL_PARTY)}),n.on("TeleportToBuddyOfferMessage",function(t){e.showTeleportQuestion(t.buddyId,t.dungeonId,t._dungeonName,1e3*t.timeLeft)}),n.on("TeleportToBuddyCloseMessage",function(t){e.removeTeleportQuestion(t.buddyId)}),n.on("PartyRestrictedMessage",function(t){var i=e._getPartyById(t.partyId);i&&(i.isRestricted=t.restricted)}),n.on("PartyLoyaltyStatusMessage",function(t){var i=e._getPartyById(t.partyId);i&&(i.isLoyal=t.loyal)})},n.prototype.showTeleportQuestion=function(e,t,i,n){function o(i){var n=1===i;n&&y.isDialogActive()&&y.closeAll(),window.isoEngine.cancelMoveAndDo(function(){window.dofus.connectionManager.sendMessage("TeleportToBuddyAnswerMessage",{dungeonId:t,buddyId:e,accept:n})})}var s=window.gui.playerData.partyData.getMemberName(e),a=window.gui.notificationBar,r={type:a.notificationType.PRIORITY_INVITATION,title:p("ui.common.invitation"),text:p("ui.party.teleportProposition",s,i),timer:n,buttons:[{label:p("ui.common.refuse"),action:o},{label:p("ui.common.accept"),action:o}],onClose:o};a.newNotification("teleport"+e,r)},n.prototype.removeTeleportQuestion=function(e){window.gui.notificationBar.removeNotification("teleport"+e)},n.prototype.showArenaFightQuestion=function(e){function t(t){var i=1===t;window.dofus.connectionManager.sendMessage("GameRolePlayArenaFightAnswerMessage",{fightId:e,accept:i})}this.arenaFightId=e;var i="arena"+e,n=window.gui.notificationBar,o={type:n.notificationType.PRIORITY_INVITATION,title:p("ui.common.koliseum"),text:p("ui.party.fightFound"),buttons:[{label:p("ui.common.refuse"),action:t},{label:p("ui.common.accept"),action:t}],onClose:t};n.newNotification(i,o)},n.prototype.removeArenaFightQuestion=function(e){e&&e!==this.arenaFightId&&console.error("removeArenaFightQuestion: bad fightId?"),this.arenaFightId&&(window.gui.notificationBar.removeNotification("arena"+this.arenaFightId),this.arenaFightId=null)},n.prototype.showPartyInvitationQuestion=function(e,t,i){function n(){return y.getWindow("partyInviteDetails").showPartyDetails(t),"HIDE_DIALOG"}function o(e){var i=e===-1?"PartyRefuseInvitationMessage":"PartyAcceptInvitationMessage";window.dofus.connectionManager.sendMessage(i,{partyId:t})}this.invitedFrom[t]=i;var s,a="party"+t;if(e===f.PARTY_TYPE_CLASSICAL)s=p("ui.party.playerInvitation",i);else{if(e!==f.PARTY_TYPE_ARENA)return console.error("Unknown party type "+e);s=p("ui.party.playerInvitationArena",i)}var r=window.gui.notificationBar,l={type:r.notificationType.INVITATION,title:p("ui.common.invitation"),text:s,buttons:[{label:p("ui.common.details"),action:n},{label:p("ui.common.accept"),action:o}],onClose:o};r.newNotification(a,l)},n.prototype.showPartyFightQuestion=function(e,t,i,n,o){function s(){window.dofus.connectionManager.sendMessage("GameFightJoinRequestMessage",{fightId:e,fighterId:t})}var a=window.gui.notificationBar,l={type:a.notificationType.PRIORITY_INVITATION,title:p("ui.party.teamFightTitle"),wuidom:r.process(p("ui.party.joinTeamFightQuestion",n,i)),timer:o,buttons:[{label:p("ui.common.join"),action:s}]};a.newNotification("partyFight"+e,l)},n.prototype.removePartyFightQuestion=function(e){window.gui.notificationBar.removeNotification("partyFight"+e)},n.prototype._updateMemberTooltip=function(e,t){s(e,function(){var i,n,o=e.memberData,s=e.getChild("tooltip");s||(s=new c("div",{className:"memberTooltip",name:"tooltip"}),s.createChild("div",{className:"stat",name:"leaderTitle",text:p("ui.party.leader")}),s.createChild("div",{className:"stat",name:"memberName"}),i=s.createChild("div",{className:"memberTips",name:"memberTips"}),n=s.createChild("div",{className:"guestTips",name:"guestTips"}),i.createChild("div",{className:"stat",name:"level"}),i.createChild("div",{className:"stat",name:"hp"}),i.createChild("div",{className:"stat",name:"prospecting"}),i.createChild("div",{className:"stat",name:"initiative"}),n.createChild("div",{className:"stat",name:"invitedBy"})),s.getChild("memberName").setText(o.name);var a=Boolean(o.guestId);i=s.getChild("memberTips"),n=s.getChild("guestTips"),i.toggleDisplay(!a),n.toggleDisplay(a);var r=p("ui.common.colon");if(a)s.getChild("leaderTitle").hide(),n.getChild("invitedBy").setText(p("ui.party.invitedBy")+r+"\n"+o.hostName);else{var l=o.lifePoints+" / "+o.maxLifePoints;s.getChild("leaderTitle").toggleDisplay(t),i.getChild("level").setText(p("ui.common.level")+r+o.level),i.getChild("hp").setText(p("ui.short.lifePoints")+r+l),i.getChild("prospecting").setText(p("ui.stats.prospecting")+r+o.prospecting),i.getChild("initiative").setText(p("ui.stats.initiative")+r+o.initiative)}return s})}},function(e,t){},function(e,t,i){function n(){function e(e){t.identification={accountCreation:e.accountCreation,accountId:e.accountId,communityId:e.communityId,hasRights:e.hasRights,accountSessionUid:e.login,login:t.loginName,nickname:e.nickname,secretQuestion:e.secretQuestion,subscriptionEndDate:e.subscriptionEndDate,wasAlreadyConnected:e.wasAlreadyConnected}}o.call(this);var t=this;this.loginName=null,this.identification={},this.characterBaseInformations={},this.accountCapabilities={},this.achievements={},this.lifePoints=0,this.maxLifePoints=0,this.movementPoints=0,this.actionPoints=0,this.isFightLeader=!1,this.isFighting=!1,this.isSpectator=!1,this.state=r.STATUS_ALIVE_AND_KICKING,this.experienceFactor=0,this.isForcedAccount=!1,this.alliance=new p,this.characters=new m,this.emoteData=new f,this.fightRequests=new g,this.guild=new _,this.inventory=new v,this.jobs=new y,this.achievements=new b,this.position=new M,this.partyData=new w,this.quests=new T,this.socialData=new C,this.myShop=new A,this.alignment=new I,this.adminMenu=new S,window.dofus.connectionManager.on("IdentificationSuccessMessage",e),window.dofus.connectionManager.on("IdentificationSuccessWithLoginTokenMessage",e)}var o=i(188).EventEmitter,s=i(339),a=i(172).inherits,r=i(580),l=i(621),c=i(194),d=i(29).getText,u=i(474),h=i(28),p=i(685),m=i(687),f=i(688),g=i(689),_=i(691),v=i(693),y=i(699),b=i(700),M=i(701),w=i(702),T=i(706),C=i(709),A=i(710),I=i(711),S=i(712),E={};a(n,o),e.exports=n,n.prototype.initialize=function(e){this.alliance.initialize(e),this.characters.initialize(e),this.emoteData.initialize(e),this.fightRequests.initialize(e),this.guild.initialize(e),this.inventory.initialize(e),this.jobs.initialize(e),this.achievements.initialize(e),this.position.initialize(e),this.partyData.initialize(e),this.quests.initialize(e),this.socialData.initialize(e),this.myShop.initialize(e),this.alignment.initialize(e),this.adminMenu.initialize(),this._setupListeners(e)},n.prototype.connectModules=function(e,t){this._selectCharacter(e),this.alliance.connect(),this.characters.connect(e),this.inventory.connect(),this.partyData.connect(),this.quests.connect(t),this.socialData.connect(),this.adminMenu.connect(this.isModerator(),this.isModeratorOrMore())},n.prototype.disconnectModules=function(){this.characters.disconnect(),this.emoteData.disconnect(),this.fightRequests.disconnect(),this.guild.disconnect(),this.inventory.disconnect(),this.jobs.disconnect(),this.achievements.disconnect(),this.position.disconnect(),this.partyData.disconnect(),this.quests.disconnect(),this.socialData.disconnect(),this.myShop.disconnect(),this.adminMenu.disconnect(),this.experienceFactor=0,this.accountCapabilities={},this.loginName=null,this.characterBaseInformations={},this.isForcedAccount=!1,this._removeMount()},n.prototype._selectCharacter=function(e){this.id=e.id,s.storeMapAndEmit(this,this.characterBaseInformations,e,"characterInfosUpdated"),this.emit("characterSelectedSuccess"),this.emit("lookUpdate",e.entityLook)},n.prototype._removeMount=function(){delete this.equippedMount,this.isRiding=!1},n.prototype._setupListeners=function(e){var t=this,i=window.dofus.connectionManager;e.on("AccountCapabilitiesMessage",function(e){t.accountCapabilities=e}),e.on("ServerExperienceModificatorMessage",function(e){t.experienceFactor=e.experiencePercent-100}),e.on("GameContextRefreshEntityLookMessage",function(e){e.id===t.id&&(t.characterBaseInformations.entityLook=e.look,t.emit("lookUpdate",e.look))}),e.on("MapComplementaryInformationsDataMessage",function(i){for(var n=e.playerData.characters.controlledCharacterId,o=0;o<i.actors.length;o++){var s=i.actors[o];if(s.contextualId===n){var a=t.characterBaseInformations.entityLook.skins,r=s.look.skins,l=!1;if(a.length!==r.length)l=!0;else for(var c=0;c<a.length;c++)if(a[c]!==r[c]){l=!0;break}return void(l&&(t.characterBaseInformations.entityLook=s.look,t.emit("lookUpdate",s.look)))}}}),e.on("CharacterLevelUpMessage",function(e){var i=t.characterBaseInformations.level;t.characterBaseInformations.level=e.newLevel,t.emit("characterLevelUp",{newLevel:e.newLevel,previousLevel:i}),t.emit("characterInfosUpdated")}),i.on("MountUnSetMessage",function(){if(t.equippedMount){var e=t.equippedMount.id;t._removeMount(),t.emit("unsetMount",e)}}),i.on("MountRidingMessage",function(e){t.isRiding=e.isRiding,t.emit("mountRiding",e.isRiding)}),i.on("MountSetMessage",function(e){t.equippedMount=e.mountData,t.equippedMount.mountLocation="equip",t.equippedMount.xpRatio=t.mountXpRatio,t.emit("setMount",e)}),i.on("MountXpRatioMessage",function(e){t.equippedMount&&(t.equippedMount.xpRatio=t.mountXpRatio=e.ratio,t.emit("setMountRatio",e.ratio))}),e.on("GameRolePlayPlayerLifeStatusMessage",function(e){var i=e.state;if(t.state=i,i===r.STATUS_TOMBSTONE){var n={title:d("ui.login.news"),message:d("ui.gameuicore.playerDied")+"\n\n"+d("ui.gameuicore.freeSoul"),cb:function(e){e&&window.dofus.sendMessage("GameRolePlayFreeSoulRequestMessage")}};c.getWindow("confirm").update(n),c.openDialog(["confirm"])}else i===r.STATUS_PHANTOM&&window.gui.openSimplePopup(d("ui.gameuicore.soulsWorld"),d("ui.login.news"))}),e.on("GameRolePlayGameOverMessage",function(){c.openDialog(["hardcoreDeath"])})},n.prototype.setForcedAccount=function(e){this.isForcedAccount=e},n.prototype.setLoginName=function(e){return e?void(this.loginName=e):console.error(new Error("PlayerData.setLoginName: login is emtpy"))},n.prototype.isAlive=function(){return this.state===r.STATUS_ALIVE_AND_KICKING},n.prototype.isAdmin=function(){return this.accountCapabilities.status>=l.ADMIN},n.prototype.isModeratorOrMore=function(){return this.accountCapabilities.status>=l.MODERATOR},n.prototype.isModerator=function(){return this.accountCapabilities.status>=l.MODERATOR&&this.accountCapabilities.status<=l.GAMEMASTER},n.prototype.isSubscriber=function(){return this.identification.subscriptionEndDate>h.now()},n.prototype.getSubscriptionDays=function(){if(!this.isSubscriber())return 0;var e=this.identification.subscriptionEndDate-h.now(),t=Math.ceil(e/1e3/60/60/24);return Math.ceil(t)},n.prototype.isMutant=function(){return"GameRolePlayMutantInformations"===window.isoEngine.actorManager.userActor.data.type},n.prototype.getRestrictions=function(){return window.isoEngine.actorManager.userActor.data.humanoidInfo.restrictions},n.prototype.isPvpAggressable=function(){return this.alignment.alignmentInfos.aggressable===u.PvP_ENABLED_AGGRESSABLE||this.alignment.alignmentInfos.aggressable===u.PvP_ENABLED_NON_AGGRESSABLE},n.prototype.getLevelDiff=function(e){var t,i,n=this.characterBaseInformations.level;return e<n?(t=-1,i=n/e):(t=1,i=e/n),Math.abs(e-n)>20||i>=1.2?t:0},n.prototype.isIncarnation=function(){var e=window.gui.playerData.characterBaseInformations.entityLook.bonesId;if(void 0!==E[e])return E[e];var t=window.gui.databases.Incarnation;for(var i in t){var n=t[i],o=n.lookMale.slice(1,n.lookMale.indexOf("|")),s=n.lookFemale.slice(1,n.lookFemale.indexOf("|"));if(e===~~o||e===~~s)return E[e]=!0,!0}return E[e]=!1,!1}},function(e,t,i){function n(){s.call(this),this.current=null}var o=i(583),s=i(188).EventEmitter,a=i(29).getText,r=i(172).inherits,l=i(686),c=i(194);r(n,s),e.exports=n,n.prototype.connect=function(){this.current=null},n.prototype.hasAlliance=function(){
return null!==this.current},n.prototype.isBoss=function(){if(!this.current||!this.current.guilds.length)return!1;var e=this.current.guilds[0],t=window.gui.playerData.guild;return e.guildId===t.current.guildId&&t.isBoss()},n.prototype.initialize=function(e){var t=this;e.on("AllianceMembershipMessage",function(e){t.current?t.current.setInfo(e.allianceInfo):t.current=o.createAlliance(e.allianceInfo),t.current.enabled=e.enabled}),e.on("AllianceJoinedMessage",function(i){t.current=o.createAlliance(i.allianceInfo),t.current.enabled=i.enabled,e.chat.logMsg(a("ui.alliance.joinAllianceMessage",[i.allianceInfo.allianceName])),t.emit("allianceJoined")}),e.on("AllianceGuildLeavingMessage",function(e){for(var i=t.current.guilds,n=0,o=i.length;n<o;n+=1)if(i[n].guildId===e.guildId)return i.splice(n,1),void t.emit("guildLeft",e.guildId)}),e.on("AllianceLeftMessage",function(){t.current=null,t.emit("allianceLeft")}),e.on("AllianceInsiderInfoMessage",function(e){var i=e.allianceInfos;i.guilds=e.guilds,i.prisms=e.prisms,t.current?t.current.setInfo(i):t.current=o.createAlliance(i),t.emit("allianceUpdated",t.current)}),e.on("AllianceInvitationStateRecruterMessage",function(t){return t.invitationState!==l.SOCIAL_GROUP_INVITATION_SENT?c.close("cancel"):void e.openCancelPopup({title:a("ui.common.invitation"),message:a("ui.craft.waitForCraftClient",t.recrutedName),cb:function(){window.dofus.sendMessage("AllianceInvitationAnswerMessage",{accept:!1})}})}),e.on("AllianceInvitationStateRecrutedMessage",function(e){if(e.invitationState===l.SOCIAL_GROUP_INVITATION_CANCELED)return c.close("confirm")}),e.on("AllianceInvitedMessage",function(e){window.gui.openConfirmPopup({title:a("ui.common.invitation"),message:a("ui.alliance.youAreInvited",e.recruterName,e.allianceInfo.allianceName),cb:function(e){window.dofus.sendMessage("GuildInvitationAnswerMessage",{accept:e})}})}),e.on("PrismsListUpdateMessage",function(e){if(t.current){for(var i=e.prisms,n=[],o=[],s=t.current.prisms,a=0,r=i.length;a<r;a+=1){var l=i[a];"PrismGeolocalizedInformation"===l._type&&"AllianceInsiderPrismInformation"===l.prism._type?(l.prism.alliance=t.current,s[l.subAreaId]=l,n.push(l)):s[l.subAreaId]&&(delete s[l.subAreaId],o.push(l.subAreaId))}n.length&&t.emit("prismUpdatedList",n),o.length&&t.emit("prismDeletedList",o)}})}},function(e,t){e.exports={SOCIAL_GROUP_INVITATION_FAILED:0,SOCIAL_GROUP_INVITATION_SENT:1,SOCIAL_GROUP_INVITATION_CANCELED:2,SOCIAL_GROUP_INVITATION_OK:3}},function(e,t,i){function n(){s.call(this),this.slaves={},this.mainCharacter=new r,this.controlledCharacterId=0,this.mainCharacterId=0}function o(e,t,i){if(!e)return null;var n=window.gui.playerData.characters.getCharacterById(e);if(!n)return null;var o=n.characteristics.spellModifications;if(!o)return null;for(var s=0;s<o.length;s++){var a=o[s];if(a.spellId===t&&a.modificationType===i)return a}return null}var s=i(188).EventEmitter,a=i(172).inherits,r=i(415),l=i(415).SpellData.SPELL_STATUS,c=i(194),d=3;a(n,s),e.exports=n,n.prototype.connect=function(e){this._assignMainCharacterInfos(e.id,e.breed),this.controlledCharacterId=e.id},n.prototype.disconnect=function(){this.clearSlaves(),this.mainCharacter.disconnect(),this.controlledCharacterId=0,this.mainCharacterId=0,this.stopRegen()},n.prototype.clearSlaves=function(){for(var e in this.slaves)this.slaves[e].disconnect();this.slaves={}},n.prototype._assignMainCharacterInfos=function(e,t){var i=window.gui.databases.Breeds[t];window.gui.playerData.characterBreed=i,this.emit("setCharacterBreed"),this.mainCharacterId=e,this.mainCharacter.setCharacterId(e)},n.prototype.switchControlledCharacter=function(e){if(e!==this.controlledCharacterId){this.controlledCharacterId=e,window.actorManager.switchUserActor(e),this.emit("switchControlledCharacter");var t=this.getControlledCharacter();t.characteristics&&t.emitCharacteristicsUpdate()}},n.prototype.canControlCharacterId=function(e){return!(e!==this.mainCharacterId&&!this.slaves[e])},n.prototype.getControlledCharacter=function(){return this.controlledCharacterId===this.mainCharacterId?this.mainCharacter:this.slaves[this.controlledCharacterId]},n.prototype.isMainCharacterControlled=function(){return this.controlledCharacterId===this.mainCharacterId},n.prototype.getCharacterById=function(e){return e===this.mainCharacterId?this.mainCharacter:this.slaves[e]},n.prototype.setCharacteristic=function(e,t){var i=this.getControlledCharacter();i.setCharacteristic(e,t)},n.prototype.addSummonedCreature=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();t.currentSummonedCreature+=1},n.prototype.removeSummonedCreature=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();t.currentSummonedCreature>0&&(t.currentSummonedCreature-=1)},n.prototype.canSummonCreature=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();return t.getMaxSummonedCreature()>t.currentSummonedCreature},n.prototype.addSummonedBomb=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();t.currentSummonedBomb+=1},n.prototype.removeSummonedBomb=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();t.currentSummonedBomb>0&&(t.currentSummonedBomb-=1)},n.prototype.canSummonBomb=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();return d>t.currentSummonedBomb},n.prototype.getSpellModifications=o,n.prototype.stopRegen=function(){window.clearInterval(this.regenTimer)},n.prototype.startRegen=function(){this.regenTimer=window.setInterval(this._autoRegenerateLife.bind(this),this.regenRate)},n.prototype._autoRegenerateLife=function(){return this.mainCharacter&&this.mainCharacter.characteristics?void(this.mainCharacter.characteristics.lifePoints>=this.mainCharacter.characteristics.maxLifePoints?this.stopRegen():this.mainCharacter.setCharacteristic("lifePoints",this.mainCharacter.characteristics.lifePoints+1)):void this.stopRegen()},n.prototype.initialize=function(e){function t(e){for(var t=n.mainCharacter.spellData,i={},o=window.gui.playerData.characterBreed,s=e.spellPrevisualization?l.VISIBLE:l.UNAVAILABLE,a=0;a<o.breedSpellsId.length;a++)i[o.breedSpellsId[a]]={spellStatus:s};for(a=0;a<e.spells.length;a++)i[e.spells[a].spellId]={spellStatus:l.USABLE,spellLevel:e.spells[a].spellLevel,position:e.spells[a].position};t.resetSpellsStatus(),t.addSpells(i,function(){n.emit("spellList")})}function i(e){var t=n.mainCharacter.characteristics.alignmentInfos;t.aggressable=e,n.mainCharacter.setCharacteristic("alignmentInfos",t)}var n=this;e.on("CharacterStatsListMessage",function(t){if(n.mainCharacter.characteristics){var i=n.mainCharacter.characteristics.energyPoints,o=t.stats.energyPoints;i>o&&e.playerData.emit("playerIsDead")}n.mainCharacter.setCharacteristics(t.stats)}),e.on("SlaveSwitchContextMessage",function(e){var t=e.summonerId;if(t===n.mainCharacterId){var i=e.slaveId,o=n.slaves[i];o||(o=n.slaves[i]=new r,o.setCharacterId(i));for(var s={},a=0;a<e.slaveSpells.length;a++)s[e.slaveSpells[a].spellId]={spellStatus:l.USABLE,spellLevel:e.slaveSpells[a].spellLevel,position:e.slaveSpells[a].position};o.spellData.addSpells(s,function(){n.emit("spellList")}),n.switchControlledCharacter(i),o.setCharacteristics(e.slaveStats)}}),e.on("FighterStatsListMessage",function(e){var t=n.getControlledCharacter();t.setCharacteristics(e.stats),c.getWindow("characteristics").updateStats(e.stats)}),e.on("LifePointsRegenBeginMessage",function(e){n.regenRate=100*e.regenRate,n.stopRegen(),n.startRegen()}),e.on("LifePointsRegenEndMessage",function(e){n.stopRegen(),n.mainCharacter.setCharacteristic("lifePoints",e.lifePoints),n.mainCharacter.setCharacteristic("maxLifePoints",e.maxLifePoints)}),e.on("SpellListMessage",function(e){return window.gui.playerData.characterBreed?void t(e):n.once("setCharacterBreed",function(){t(e)})}),e.on("SpellUpgradeSuccessMessage",function(e){n.mainCharacter.spellData.upgradeSpell(e.spellId,e.spellLevel,l.USABLE,function(){1===e.spellLevel&&n.mainCharacter.emit("newSpellLearned",e.spellId,e.spellLevel),n.mainCharacter.emit("spellUpgrade",e.spellId,e.spellLevel)})}),e.playerData.inventory.on("weaponChanged",function(){n.mainCharacter.spellData.weaponChanged(function(){n.mainCharacter.emit("weaponChanged")})}),e.on("UpdateSelfAgressableStatusMessage",function(e){var t=e.status;i(t),window.actorManager.updateActorsAggressableStatus([n.mainCharacterId],[t])}),e.on("UpdateMapPlayersAgressableStatusMessage",function(e){var t=e.playerIds,o=t.indexOf(n.mainCharacterId);o!==-1&&i(e.enable[o])})}},function(e,t,i){function n(){o.call(this),this.list={}}var o=i(188).EventEmitter,s=i(29).getText,a=i(172).inherits,r=i(30);a(n,o),e.exports=n,n.prototype.disconnect=function(){this.list={}},n.prototype.initialize=function(e){var t=this;e.on("EmoteListMessage",function(e){r.getDataMap("Emoticons",e.emoteIds,function(e,i){if(e)return console.error("could not retrieve emotes data",e);for(var n in i)i[n]&&(t.list[n]=i[n]);t.emit("emoteListUpdated",t.list)})}),e.on("EmoteAddMessage",function(e){r.getData("Emoticons",e.emoteId,function(e,i){if(e)return console.error("could not retrieve emotes data",e);var n=i.id;t.list[n]||(t.list[n]=i,window.gui.chat.logMsg(s("ui.common.emoteAdded",[i.nameId])),t.emit("emoteAdded",i))})}),e.on("EmoteRemoveMessage",function(e){var i=t.list[e.emoteId];i&&(window.gui.chat.logMsg(s("ui.common.emoteRemoved",[i.nameId])),delete t.list[e.emoteId],t.emit("emoteRemoved",e.emoteId))})}},function(e,t,i){function n(){o.call(this),this._targetInfo={}}var o=i(188).EventEmitter,s=i(29).getText,a=i(172).inherits,r=i(629),l=i(690),c=i(425);a(n,o),e.exports=n,n.prototype.disconnect=function(){this._targetInfo={}},n.prototype.initialize=function(e){function t(e){var t=r.setupNames(i._targetInfo.targetId,e.sourceId);return t?(r.setupCancelPopupTexts({title:s("ui.fight.challenge"),message:s("ui.fight.youChallenge",t.targetName)}),r.setupConfirmPopupTexts({title:s("ui.fight.challenge"),message:s("ui.fight.aChallengeYou",t.sourceName)}),void r.askingChallengePopup(e.fightId)):console.error("FightRequestsData: setupNames")}var i=this;e.on("GameRolePlayPlayerFightFriendlyRequestedMessage",t),e.on("GameRolePlayPlayerFightFriendlyAnsweredMessage",function(e){r.closingChallengePopup(e.sourceId===window.gui.playerData.id)}),e.on("ChallengeFightJoinRefusedMessage",function(e){i.alertChallengeRefused(e.reason)}),e.on("GameRolePlayAggressionMessage",function(e){i.alertAggression(e)})},n.prototype.requestChallenge=function(e){this._targetInfo=e,this.sendRequest(e,!1,!0,!1)},n.prototype.requestAssault=function(e,t){this._targetInfo=e,this.sendRequest(e,t,!1,!0)},n.prototype.sendRequest=function(e,t,i,n){var o=e.targetId,s=e.targetCellId;if(n){var a=window.isoEngine.actorManager,r=a.getActor(o).data;if("GameRolePlayCharacterInformations"===r.type){if(t)return this.confirmAttackTarget(e,!0,null);var l="GameRolePlayMutantInformations"===a.userActor.data.type;if(r.alignmentInfos.alignmentSide===c.ALIGNMENT_NEUTRAL&&!l)return this.confirmAttackTarget(e,!1,2);var d=r.alignmentInfos.characterPower-o,u=window.gui.playerData.getLevelDiff(d);if(u)return this.confirmAttackTarget(e,!1,u)}}window.dofus.sendMessage("GameRolePlayPlayerFightRequestMessage",{targetId:o,targetCellId:s,friendly:i})},n.prototype.confirmAttackTarget=function(e,t,i){var n,o=e.targetName;t||0===i?n=s("ui.pvp.doUAttack",o):2===i?n=s("ui.pvp.doUAttackNeutral"):i===-1?n=s("ui.pvp.doUAttackNoGain",o):1===i&&(n=s("ui.pvp.doUAttackBonusGain",o));var a=this;window.gui.openConfirmPopup({title:s("ui.popup.warning"),message:n,cb:function(i){1===i&&a.sendRequest(e,t,!1,!1)}})},n.prototype.alertAggression=function(e){var t=window.isoEngine.actorManager,i=t.getActor(e.attackerId),n=t.getActor(e.defenderId);if(!i||!n)return console.error("Could not find aggressed actors.");var o=s("ui.pvp.aAttackB",i.data.name,n.data.name);window.gui.chat.logMsg(o)},n.prototype.alertChallengeRefused=function(e){var t;switch(e){case l.CHALLENGE_FULL:t=s("ui.fight.challengeFull");break;case l.TEAM_FULL:t=s("ui.fight.teamFull");break;case l.WRONG_ALIGNMENT:t=s("ui.wrongAlignment");break;case l.WRONG_GUILD:t=s("ui.fight.wrongGuild");break;case l.TOO_LATE:t=s("ui.fight.tooLate");break;case l.MUTANT_REFUSED:t=s("ui.fight.mutantRefused");break;case l.WRONG_MAP:t=s("ui.fight.wrongMap");break;case l.JUST_RESPAWNED:t=s("ui.fight.justRespawned");break;case l.IM_OCCUPIED:t=s("ui.fight.imOccupied");break;case l.OPPONENT_OCCUPIED:t=s("ui.fight.opponentOccupied");break;case l.MULTIACCOUNT_NOT_ALLOWED:t=s("ui.fight.onlyOneAllowedAccount");break;case l.INSUFFICIENT_RIGHTS:t=s("ui.fight.insufficientRights");break;case l.MEMBER_ACCOUNT_NEEDED:t=s("ui.fight.MemberAccountNeeded");break;case l.OPPONENT_NOT_MEMBER:t=s("ui.fight.opponentNotMember");break;case l.TEAM_LIMITED_BY_MAINCHARACTER:t=s("ui.fight.teamLimitedByMainCharacter");break;case l.GHOST_REFUSED:t=s("ui.fight.ghostRefused");break;case l.AVA_ZONE:t=s("ui.fight.cantAttackAvAZone");break;default:return}window.gui.chat.logMsg(t)}},function(e,t){e.exports={FIGHTER_REFUSED:-1,FIGHTER_ACCEPTED:0,CHALLENGE_FULL:1,TEAM_FULL:2,WRONG_ALIGNMENT:3,WRONG_GUILD:4,TOO_LATE:5,MUTANT_REFUSED:6,WRONG_MAP:7,JUST_RESPAWNED:8,IM_OCCUPIED:9,OPPONENT_OCCUPIED:10,FIGHT_MYSELF:11,INSUFFICIENT_RIGHTS:12,MEMBER_ACCOUNT_NEEDED:13,OPPONENT_NOT_MEMBER:14,TEAM_LIMITED_BY_MAINCHARACTER:15,MULTIACCOUNT_NOT_ALLOWED:16,GHOST_REFUSED:17,RESTRICTED_ACCOUNT:19,WRONG_ALLIANCE:20,AVA_ZONE:21}},function(e,t,i){function n(){l.call(this),this.current=null}var o=i(202),s=i(478),a=s.GuildRightsBitEnum,r=i(640),l=i(188).EventEmitter,c=i(29).getText,d=i(339),u=i(172).inherits,h=i(686),p=i(194),m=i(593),f=i(692),g=1;u(n,l),e.exports=n,n.prototype._reset=function(){this.current=null},n.prototype.disconnect=function(){this._reset()},n.prototype.hasGuild=function(){return null!==this.current},n.prototype.checkRight=function(e,t){return(e&t)>0},n.prototype.hasRight=function(e){return!!this.isBoss()||this.checkRight(e,this.current.memberRights)},n.prototype.isBoss=function(){return this.current.leaderId===window.gui.playerData.id||this.checkRight(a.GUILD_RIGHT_BOSS,this.current.memberRights)},n.prototype.isAMember=function(e){return this.current.members.hasOwnProperty(e)},n.prototype._initPerceptors=function(){return this.current.perceptors={nbcollectorMax:0,informationsOrderList:[],perceptorsMap:{}},this.current.perceptors},n.prototype.getPerceptors=function(){var e=this.current.perceptors;return e||(e=this._initPerceptors()),e},n.prototype.getPerceptor=function(e){var t=this.getPerceptors();return t.perceptorsMap[e]},n.prototype.initialize=function(e){var t=this;e.on("GuildMembershipMessage",function(e){t.current&&t.current.guildId===e.guildInfo.guildId||(t.current=s.createGuild(e.guildInfo)),t.current.enabled=e.enabled,t.current.memberRights=e.memberRights}),e.on("GuildJoinedMessage",function(i){t.current=s.createGuild(i.guildInfo),t.current.enabled=i.enabled,t.current.memberRights=i.memberRights,e.chat.logMsg(c("ui.guild.JoinGuildMessage",[i.guildInfo.guildName]))}),e.on("GuildInformationsGeneralMessage",function(e){var i=t.current;i.level=e.level,i.creationDate=e.creationDate,i.abandonnedPaddock=e.abandonnedPaddock,i.experience=e.experience,i.expNextLevelFloor=e.expNextLevelFloor,i.experiencePercentage=(e.experience-e.expLevelFloor)/(e.expNextLevelFloor-e.expLevelFloor),t.emit("GuildGeneralInformationUpdate")}),e.on("GuildInformationsMembersMessage",function(e){for(var i=t.current,n=0,o={},s=e.members.length,a=0,r=0;r<s;r++){var l=e.members[r];a+=l.level,l.rank===g&&(i.leaderId=l.id),l.connected&&(n+=1),o[l.id]=l}i.members=o,i.averageMemberLevel=Math.floor(a/s),i.nbMembers=s,i.nbConnectedMembers=n,t.emit("guildMemberCountUpdate"),t.emit("guildMember",i.getMembersByRank())}),e.on("GuildInformationsMemberUpdateMessage",function(e){var i=t.current,n=e.member;i.members[n.id]=n,n.rank===g&&(i.leaderId=n.id),t.emit("guildMember",i.getMembersByRank())}),e.on("GuildMemberLeavingMessage",function(e){var i=t.current,n=i.members;delete n[e.memberId];var o=0,s=0;for(var a in n){var r=n[a];r.connected&&(o+=1),s+=1}i.nbMembers=s,i.nbConnectedMembers=o,t.emit("guildMemberCountUpdate"),t.emit("guildMember",t.current.getMembersByRank())}),e.on("GuildMemberOnlineStatusMessage",function(e){var i=t.current,n=i.members[e.memberId];n&&(e.online?(n.connected=1,n.status.statusId=m.PLAYER_STATUS_AVAILABLE,i.nbConnectedMembers++):(n.connected=0,n.status.statusId=m.PLAYER_STATUS_OFFLINE,i.nbConnectedMembers--),t.emit("guildMemberCountUpdate"),t.emit("guildMember",i.getMembersByRank()))}),o.on("PlayerStatusUpdateMessage",function(e){if(t.current){var i=t.current.members[e.playerId];i&&(i.status=e.status,t.emit("guildMemberStatusUpdate",i))}}),e.on("GuildMemberWarnOnConnectionStateMessage",function(e){t.current&&(t.current.warnMemberOnConnectionState=e.enable)}),e.on("GuildLeftMessage",function(){t.current=null,t.emit("guildLeft")}),e.on("GuildInvitationStateRecruterMessage",function(t){return t.invitationState===h.SOCIAL_GROUP_INVITATION_OK&&window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:r.INFO_MEMBERS}),t.invitationState!==h.SOCIAL_GROUP_INVITATION_SENT?p.close("cancel"):void e.openCancelPopup({title:c("ui.common.invitation"),message:c("ui.craft.waitForCraftClient",t.recrutedName),cb:function(){window.dofus.sendMessage("GuildInvitationAnswerMessage",{accept:!1})}})}),e.on("GuildInvitationStateRecrutedMessage",function(e){if(e.invitationState===h.SOCIAL_GROUP_INVITATION_CANCELED)return p.close("confirm")}),e.on("GuildInvitedMessage",function(e){window.gui.openConfirmPopup({title:c("ui.common.invitation"),message:c("ui.social.aInvitYouInGuild",e.recruterName,e.guildInfo.guildName),cb:function(e){window.dofus.sendMessage("GuildInvitationAnswerMessage",{accept:e})}})}),e.on("GuildInformationsPaddocksMessage",function(e){t.current&&(t.current.paddocks=e.paddocksInformations||[],t.emit("guildPaddockUpdate"))}),e.on("GuildPaddockBoughtMessage",function(e){t.current&&(t.current.paddocks||(t.current.paddocks=[]),t.current.paddocks.push(e.paddockInfo),t.emit("guildPaddockBought",e.paddockInfo))}),e.on("GuildPaddockRemovedMessage",function(e){if(t.current&&t.current.paddocks){var i=e.paddockId;d.removeObjectInArrayById(t.current.paddocks,"paddockId",i)&&t.emit("guildPaddockRemoved",i)}}),e.on("GuildHousesInformationMessage",function(e){t.current&&(t.current.houses=e.housesInformations||[],t.emit("guildHouseUpdateAll"))}),e.on("GuildHouseUpdateInformationMessage",function(e){t.current&&(t.current.houses||(t.current.houses=[]),t.current.houses.push(e.housesInformations),t.emit("guildHouseUpdateInfo",e.housesInformations))}),e.on("GuildHouseRemoveMessage",function(e){if(t.current&&t.current.houses){var i=e.houseId;d.removeObjectInArrayById(t.current.houses,"houseId",i)&&t.emit("guildHouseRemoved",i)}}),e.on("MoodSmileyUpdateMessage",function(e){var i=t.current&&t.current.members[e.playerId];i&&(i.moodSmileyId=e.smileyId,t.emit("guildMember",t.current.getMembersByRank()))}),e.on("MoodSmileyResultMessage",function(e){if(e.resultCode===f.MOOD_OK){var i=t.current&&t.current.members[window.gui.playerData.id];i&&(i.moodSmileyId=e.smileyId,t.emit("guildMember",t.current.getMembersByRank()))}})}},function(e,t){e.exports={MOOD_OK:0,MOOD_ERROR_UNKNOWN:1,MOOD_ERROR_FLOOD:2}},function(e,t,i){function n(){o.call(this),this.objects={},this.isLoaded=!1,this.presets={},this.kamas=0,this.goultines=0,this.weight=0,this.maxWeight=0,this.quantityList={},this.equippedItems={},this._lastUpdatedPosition={},this.itemSets={}}var o=i(188).EventEmitter,s=i(339),a=i(29).getText,r=i(172).inherits,l=i(694),c=i(461),d=i(247).playUiSound,u=c.positions,h=i(7),p=i(695),m=i(696),f=i(697),g=i(698),_=113;r(n,o),e.exports=n,n.prototype.connect=function(){window.dofus.send("moneyGoultinesAmountRequest")},n.prototype.isOverloaded=function(){return this.weight>this.maxWeight},n.prototype.disconnect=function(){this.objects={},this.isLoaded=!1,this.presets={},this.weight=0,this.maxWeight=0,this.quantityList={},this.equippedItems={},this._lastUpdatedPosition={},this.itemSets={},this.kamas=null,this.goultines=null,this.emit("unloaded")},n.prototype.initialize=function(e){function t(){var e=d.quantityList={},t=d.objects;for(var i in t){var n=t[i],o=n.objectGID;e[o]=(e[o]||0)+n.quantity}}function i(e){for(var i=0,n=e.length;i<n;i+=1){var o=e[i];d.objects[o.objectUID]=o,o.position!==u.notEquipped&&(d.equippedItems[o.position]=o,o.position===u.weapon&&d.emit("weaponChanged"))}t()}function n(){d.isLoaded=!0,d.emit("loaded"),d.emit("listUpdate",d.objects)}function o(e){d.kamas=e.kamas,d.emit("kamasUpdated",e.kamas);var t=c.createItemInstances(e.objects,function(t){if(t)return console.error(t);if(!e.presets)return n();e.presets=e.presets||[],d.presets={};for(var i=[],o=0;o<e.presets.length;o+=1){var s=e.presets[o];d.presets[s.presetId]=s;for(var a=0;a<s.objects.length;a+=1){var r=s.objects[a].objGid;c.items[r]||i.push(r)}}c.getItems(i,function(e){return e?console.error(e):void n()})});i(t)}function r(e){var i=d.objects[e];return i?(i.position!==u.notEquipped&&(delete d.equippedItems[i.position],i.position===u.weapon&&d.emit("weaponChanged")),i.emit("deleted"),delete d.objects[e],t(),i):console.error("[ObjectDeletedMessage] unknown object UID")}var d=this,_=window.dofus.connectionManager;e.on("ObjectAddedMessage",function(e){var t=c.createItemInstances(e.object,function(e,t){return e?console.error(e):void d.emit("itemAdded",t.array[0])});i(t)}),e.on("ObjectsAddedMessage",function(e){var t=c.createItemInstances(e.object,function(e,t){return e?console.error(e):void d.emit("itemsAdded",t.map)});i(t)}),e.on("ObjectModifiedMessage",function(e){var t=c.createItemInstances(e.object,function(t,i){if(t)return console.error(t);var n=i.array[0];return d.objects[e.object.objectUID]||n.livingObjectCategory?void(n.isInitialised&&(n.emit("modified"),d.emit("itemModified",n))):console.error("[ObjectModifiedMessage] unknown object UID")});i(t)}),e.on("ObjectMovementMessage",function(e){var t=d.objects[e.objectUID],i=!1;if(t){t.position!==u.weapon&&e.position!==u.weapon||(i=!0);var n=t.position;t.position=e.position,d.equippedItems[n]&&delete d.equippedItems[n],e.position!==u.notEquipped&&(d.equippedItems[e.position]=t),t.isInitialised&&(i&&d.emit("weaponChanged"),t.emit("moved"),d.emit("itemMoved",t,n,e.position))}}),e.on("InventoryContentMessage",o),e.on("InventoryContentAndPresetMessage",o),e.on("InventoryPresetDeleteResultMessage",function(e){switch(e.code){case p.PRESET_DEL_OK:delete d.presets[e.presetId],d.emit("presetDeleted",e.presetId);break;case p.PRESET_DEL_ERR_TOO_MANY:d.emit("presetDeleted",e.presetId,"tooMany");break;case p.PRESET_DEL_ERR_UNKNOWN:d.emit("presetDeleted",e.presetId,"unknown");break;case p.PRESET_DEL_ERR_BAD_PRESET_ID:d.emit("presetDeleted",e.presetId,"badId")}}),e.on("InventoryPresetSaveResultMessage",function(e){switch(e.code){case m.PRESET_SAVE_OK:d.emit("presetSaved",e.presetId);break;case m.PRESET_SAVE_ERR_TOO_MANY:d.emit("presetSaved",e.presetId,"tooMany");break;case m.PRESET_SAVE_ERR_UNKNOWN:d.emit("presetSaved",e.presetId,"unknown")}}),e.on("InventoryPresetUseResultMessage",function(e){switch(e.code){case g.PRESET_USE_OK:d.emit("presetUsed",e.presetId);break;case g.PRESET_USE_OK_PARTIAL:d.emit("presetUsed",e.presetId,"usePartial");break;case g.PRESET_USE_ERR_UNKNOWN:d.emit("presetUsed",e.presetId,"unknown");break;case g.PRESET_USE_ERR_CRITERION:d.emit("presetUsed",e.presetId,"criterion");break;case g.PRESET_USE_ERR_BAD_PRESET_ID:d.emit("presetUsed",e.presetId,"badId")}}),e.on("InventoryPresetUpdateMessage",function(e){d.presets[e.preset.presetId]=e.preset,d.emit("presetUpdated",e.preset.presetId)}),e.on("InventoryPresetItemUpdateMessage",function(e){for(var t=d.presets[e.presetId],i=0;i<t.objects.length;i+=1)if(t.objects[i].position===e.presetItem.position){t.objects[i]=e.presetItem;break}d.emit("presetItemUpdated",e.presetId)}),e.on("InventoryPresetItemUpdateErrorMessage",function(e){switch(e.code){case f.PRESET_UPDATE_ERR_UNKNOWN:d.emit("presetItemUpdateError","unknown");break;case f.PRESET_UPDATE_ERR_BAD_PRESET_ID:d.emit("presetItemUpdateError","badId");break;case f.PRESET_UPDATE_ERR_BAD_POSITION:d.emit("presetItemUpdateError","badPosition");break;case f.PRESET_UPDATE_ERR_BAD_OBJECT_ID:d.emit("presetItemUpdateError","badObjectId")}}),_.on("InventoryWeightMessage",function(e){d.weight=e.weight,d.maxWeight=e.weightMax,d.emit("weightUpdated",e.weight,e.weightMax)}),e.on("SetUpdateMessage",function(e){var t=e.setId;d.itemSets[t]={setEffects:e.setEffects,setObjects:e.setObjects}}),_.on("ObjectsQuantityMessage",function(e){for(var i={},n=0,o=e.objectsUIDAndQty.length;n<o;n+=1){var s=e.objectsUIDAndQty[n],a=d.objects[s.objectUID];a.quantity=s.quantity,a.isInitialised&&(i[s.objectUID]=s.quantity,a.emit("quantityUpdated"))}t(),d.emit("itemsQuantity",i)}),_.on("ObjectQuantityMessage",function(e){var i=d.objects[e.objectUID];i.quantity=e.quantity,t(),i.isInitialised&&(i.emit("quantityUpdated"),d.emit("itemQuantity",e.objectUID,e.quantity))}),_.on("ObjectsDeletedMessage",function(e){for(var t={},i=0,n=e.objectUID.length;i<n;i+=1){var o=e.objectUID[i];t[o]=r(o)}d.emit("itemsDeleted",e.objectUID,t)}),_.on("ObjectDeletedMessage",function(e){var t=r(e.objectUID);d.emit("itemDeleted",e.objectUID,t)}),_.on("ObjectErrorMessage",function(t){var i;switch(t.reason){case l.INVENTORY_FULL:i=a("ui.objectError.InventoryFull");break;case l.CANNOT_EQUIP_TWICE:i=a("ui.objectError.CannotEquipTwice");break;case l.CANNOT_DROP:i=a("ui.objectError.CannotDrop");break;case l.CANNOT_DROP_NO_PLACE:i=a("ui.objectError.CannotDropNoPlace");break;case l.CANNOT_DESTROY:i=a("ui.objectError.CannotDelete");break;case l.LEVEL_TOO_LOW:i=a("ui.objectError.levelTooLow");break;case l.LIVING_OBJECT_REFUSED_FOOD:i=a("ui.objectError.LivingObjectRefusedFood")}i&&e.chat.logError(i)}),e.on("KamasUpdateMessage",function(e){s.storeValueAndEmit(d,d,"kamas",e.kamasTotal,"kamasUpdated")}),e.on("CharacterStatsListMessage",function(e){s.storeValueAndEmit(d,d,"kamas",e.stats.kamas,"kamasUpdated")}),_.on("moneyGoultinesAmountSuccess",function(e){s.storeValueAndEmit(d,d,"goultines",e.goultinesAmount,"goultinesUpdated"),h.wKpi.hardCurrencyAmount(e.goultinesAmount)})},n.prototype.getCurrentWeapon=function(){return this.equippedItems[u.weapon]};var v={0:"EQUIP_NECKLACE",1:"EQUIP_WEAPON",2:"EQUIP_WRISTBAND",3:"EQUIP_ACCESORIES",4:"EQUIP_WRISTBAND",5:"EQUIP_BOOTS",6:"EQUIP_CLOTH_2",7:"EQUIP_CLOTH_1",8:"EQUIP_PET",9:"EQUIP_DOFUS",10:"EQUIP_DOFUS",11:"EQUIP_DOFUS",12:"EQUIP_DOFUS",13:"EQUIP_DOFUS",14:"EQUIP_DOFUS",15:"EQUIP_HAND",16:"EQUIP_PET"};n.prototype._equip=function(e,t,i){this._lastUpdatedPosition[i.superTypeId]=e,window.dofus.sendMessage("ObjectSetPositionMessage",{objectUID:t.objectUID,position:e,quantity:1});var n=v[e];n&&d(n)},n.prototype.equipItem=function(e,t){var i=this.objects[e];if(i&&i.position===u.notEquipped){var n=i.item,o=n.type;if(o.category===c.categories.equipment){if(n.typeId===_)return this._equip(t,i,o);var s=o.possiblePositions;if(s.length){if(t&&s.indexOf(t)!==-1)return this._equip(t,i,o);var a,r,l,d,h=this.equippedItems;if(9!==o.id||i.belongsToSet)for(a=0,r=s.length;a<r;a+=1)if(l=s[a],d=h[l],d&&d.objectGID===i.objectGID)return this._equip(l,i,o);for(a=0,r=s.length;a<r;a+=1)if(l=s[a],!h[l])return this._equip(l,i,o);var p=this._lastUpdatedPosition[o.superTypeId]||0,m=p<s.length-1?p+1:0;this._equip(s[m],i,o)}}}},n.prototype.unEquipItem=function(e){var t=this.objects[e];t&&t.position!==u.notEquipped&&(window.isoEngine.actionQueue.isActive()||window.dofus.sendMessage("ObjectSetPositionMessage",{objectUID:e,position:u.notEquipped,quantity:1}))},n.prototype.confirmDestroyItem=function(e,t){window.gui.openConfirmPopup({title:a("ui.common.delete.item"),message:a("ui.common.doYouDestroy",t,e.item.nameId),cb:function(i){i&&window.dofus.sendMessage("ObjectDeleteMessage",{objectUID:e.objectUID,quantity:t})}})},n.prototype.getGenericItem=function(e){var t,i=this.objects;for(var n in i)if(t=i[n],t.objectGID===e)return t;return null},n.prototype.getGenericItemCount=function(e){var t=this.objects,i=0;for(var n in t){var o=t[n];o.objectGID===e&&(i+=o.quantity)}return i},n.prototype.isGenericItemEquipped=function(e){var t=this.objects;for(var i in t){var n=t[i];if(n.objectGID===e&&n.position!==u.notEquipped)return!0}return!1},n.prototype.isPetFood=function(e,t){var i=e.item.foodItems,n=e.item.foodTypes;return!(!i||!n)&&(i.indexOf(t.getProperty("objectGID"))!==-1||n.indexOf(t.getProperty("typeId"))!==-1)}},function(e,t){e.exports={INVENTORY_FULL:1,CANNOT_EQUIP_TWICE:2,NOT_TRADABLE:3,CANNOT_DROP:4,CANNOT_DROP_NO_PLACE:5,CANNOT_DESTROY:6,LEVEL_TOO_LOW:7,LIVING_OBJECT_REFUSED_FOOD:8,CANNOT_UNEQUIP:9,CANNOT_EQUIP_HERE:10,CRITERIONS:11,MIMICRY_OBJECT_ERROR:12}},function(e,t){e.exports={PRESET_DEL_OK:1,PRESET_DEL_ERR_UNKNOWN:2,PRESET_DEL_ERR_BAD_PRESET_ID:3}},function(e,t){e.exports={PRESET_SAVE_OK:1,PRESET_SAVE_ERR_UNKNOWN:2,PRESET_SAVE_ERR_TOO_MANY:3}},function(e,t){e.exports={PRESET_UPDATE_ERR_UNKNOWN:1,PRESET_UPDATE_ERR_BAD_PRESET_ID:2,PRESET_UPDATE_ERR_BAD_POSITION:3,PRESET_UPDATE_ERR_BAD_OBJECT_ID:4}},function(e,t){e.exports={PRESET_USE_OK:1,PRESET_USE_OK_PARTIAL:2,PRESET_USE_ERR_UNKNOWN:3,PRESET_USE_ERR_CRITERION:4,PRESET_USE_ERR_BAD_PRESET_ID:5}},function(e,t,i){function n(){u={},h={},p={},m={Jobs:u,Skills:h,Recipes:p}}function o(e,t,i){return t.length?void v.getDataMap(e,t,function(t,n){if(t)return i(t);var o=m[e];for(var s in n)o[s]=n[s];i()}):i()}function s(e,t){o("Skills",e,function(i){if(i)return t(i);for(var n={},s=0,a=e.length;s<a;s+=1){var r=h[e[s]];if(r&&r.craftableItemIds)for(var l=0,c=r.craftableItemIds.length;l<c;l+=1){var d=r.craftableItemIds[l];p[d]||(n[d]=!0)}}o("Recipes",Object.keys(n),function(i){if(i)return t(i);for(var n=0,o=e.length;n<o;n+=1){var s=h[e[n]];if(s&&s.craftableItemIds){s.recipes=[];for(var a=0,r=s.craftableItemIds.length;a<r;a+=1){var l=s.craftableItemIds[a];p[l]&&s.recipes.push(p[l])}}}t()})})}function a(){v.getDataMap("Npcs",E,function(e,t){if(e)return console.error("Failed to get the name of the job npcs",e);for(var i in t)x[i]=t[i].nameId})}function r(e,t,i){for(var n={},a={},r=0,l=e.length;r<l;r+=1){var c=e[r],d=c.jobId,p=t[d];p||(p=t[d]={id:d}),p.description=c,u[d]||(n[d]=!0);for(var m=0,f=c.skills.length;m<f;m+=1){var g=c.skills[m].skillId;h[g]||(a[g]=!0)}}o("Jobs",Object.keys(n),function(e){return e?i(e):void s(Object.keys(a),function(e){if(e)return i(e);for(var n in t){var o=t[n];o.info=u[o.id];for(var s=0,a=o.description.skills.length;s<a;s+=1){var r=o.description.skills[s];r.info=h[r.skillId]}}i()})})}function l(){f.call(this),this.SKILLID_WRAP_GIFT=209,this.SKILLID_DECRAFT=181,this.ITEMID_MAGIC_FRAGMENT=8378,this.RUNE_SIGNATURE_GID=w,this.SMITHMAGIC_RUNE_ID=C,this.SMITHMAGIC_POTION_ID=A,this.MAX_CRAFT_SLOTS=8,this.list={},this._publicMode=!1,this._playersMultiCraftSkillById={},this._existingSlotCount=0,this._onCraftTable={},this._stackCount=0,this._stackCountPerGid={}}function c(e){return!!window.gui.playerData.inventory.objects[e.objectUID]}function d(e,t,i){var n=e+("SOLO"!==t?"-"+t:"")+"-"+i;return I[n]||S}var u,h,p,m,f=i(188).EventEmitter,g=i(29).getText,_=i(172).inherits,v=i(30),y=i(461),b=i(339),M=i(247).playUiSound,w=7508,T=100,C=78,A=26,I={"decrafting-craftInventory":{move:"max"},"decrafting-crafting":{move:"max"},"craftMagus-craftInventory":{move:"max"},"craftMagus-crafting":{move:"max"},"craftMagus-CLIENT-ingredientsBag":{move:"max"},"craftMagus-CLIENT-craftInventory":{move:"max"},"craftMagus-CRAFTER-ingredientsBag":{move:"max"},"craftMagus-CRAFTER-crafting":{move:"max"},"craftMagus-CRAFTER-craftInventory":{move:"max"}},S={move:1},E=[601,849],x={};_(l,f),e.exports=l,l.prototype.disconnect=function(){n(),this.list={},this._publicMode=!1,this._playersMultiCraftSkillById={},this.clearAfterCraft()},l.prototype.startCraftingSession=function(e,t,i){this.craftSide=e,this.craftType=this.getCraftType(t),this._setupSkillData(t),this.setExistingSlotCount(i),this.isMagicCraft="craftMagus"===this.craftType,
this._stackCount=0,this.canUseCrafterIngredient=!1,this.isCrafterWorking=!1,this.isCombining=!1,this._startListeningForCraft()},l.prototype.setCrafterIngredientsAllowed=function(e){this.canUseCrafterIngredient=e},l.prototype.switchToCrafter=function(e){this.isCrafterWorking=e},l.prototype.startCombining=function(){this.isCombining=!0},l.prototype.stopCombining=function(){this.isCombining=!1},l.prototype.clearAfterCraft=function(){this._onCraftTable={},this._stackCountPerGid={},this._stopListeningForCraft(),this.removeAllListeners("objectAdded"),this.removeAllListeners("objectModified"),this.removeAllListeners("objectRemoved")},l.prototype._startListeningForCraft=function(){if(!this.isListeningForCraft){this.isListeningForCraft=!0,this._objectAddedHandler||(this._objectAddedHandler=this._onCraftObjectAddedMessage.bind(this),this._objectModifiedHandler=this._onCraftObjectModifiedMessage.bind(this),this._objectRemovedHandler=this._onCraftObjectRemovedMessage.bind(this));var e=window.dofus.connectionManager;e.on("ExchangeObjectAddedMessage",this._objectAddedHandler),e.on("ExchangeObjectModifiedMessage",this._objectModifiedHandler),e.on("ExchangeObjectRemovedMessage",this._objectRemovedHandler)}},l.prototype._stopListeningForCraft=function(){if(this.isListeningForCraft){this.isListeningForCraft=!1;var e=window.dofus.connectionManager;e.removeListener("ExchangeObjectAddedMessage",this._objectAddedHandler),e.removeListener("ExchangeObjectModifiedMessage",this._objectModifiedHandler),e.removeListener("ExchangeObjectRemovedMessage",this._objectRemovedHandler)}},l.prototype._onCraftObjectAddedMessage=function(e){var t=e.remote,i=e.object,n=i.objectUID,o=i.objectGID,s=i.quantity,a=this._onCraftTable[n];return a?console.warn("ExchangeObjectAddedMessage received for existing object "+n):(this._onCraftTable[n]={GID:o,quantity:s},this._stackCount++,this._stackCountPerGid[o]=(this._stackCountPerGid[o]||0)+1,void this.emit("objectAdded",i,t))},l.prototype._onCraftObjectModifiedMessage=function(e){var t=e.object,i=e.remote,n=t.objectUID,o=this._onCraftTable[n];return o?(o.quantity=t.quantity,void this.emit("objectModified",t,i)):console.error("craftObjectModified of unknown object "+n)},l.prototype._onCraftObjectRemovedMessage=function(e){var t=e.remote,i=e.objectUID,n=this._onCraftTable[i];if(!n)return console.error("craftObjectRemoved of unknown object "+i);var o=n.GID;delete this._onCraftTable[i],this._stackCount--,0===--this._stackCountPerGid[o]&&delete this._stackCountPerGid[o],this.emit("objectRemoved",i,t)},l.prototype._setupSkillData=function(e){this.currentSkillId=e,this.skillData=h[e];var t=this.list[this.skillData.parentJobId]||{},i=t.experience||{};this.crafterSkillLevel=i.jobLevel,this.canCrafterSign=this.crafterSkillLevel>=T},l.prototype.getCraftType=function(e){var t=h[e];return t?t.isForgemagus||t.modifiableItemType!==-1?"craftMagus":e===this.SKILLID_DECRAFT?"decrafting":e===this.SKILLID_WRAP_GIFT?"wrapping":"crafting":console.error("Invalid skillId: "+e)},l.prototype.isCraftableItem=function(e){return this.skillData.modifiableItemType===e.getProperty("typeId")&&e.getProperty("enhanceable")},l.prototype._getReplacedItemOnMagicTable=function(e){return this._onCraftTable[e.objectUID]?null:e.objectGID===w?this._getSignatureRuneOnTable():this._isMagicRuneOrPotion(e)?this._getRuneOrPotionOnMagicTable():this._getItemOnMagicTable()},l.prototype._getSignatureRuneOnTable=function(){for(var e in this._onCraftTable){var t=this._onCraftTable[e];if(t.GID===w)return e}return null},l.prototype._getRuneOrPotionOnMagicTable=function(){for(var e in this._onCraftTable){var t=this._onCraftTable[e],i=y.items[t.GID].typeId;if(i===C||i===A)return e}return null},l.prototype._getItemOnMagicTable=function(){for(var e in this._onCraftTable){var t=this._onCraftTable[e];if(t.GID!==w){var i=y.items[t.GID].typeId;if(i!==C&&i!==A)return e}}return null},l.prototype._isMagicRuneOrPotion=function(e){var t=e.item.typeId;return t===C||t===A},l.prototype._getItemMoveTargets=function(e,t){if(this.isMagicCraft)switch(this.craftSide){case"SOLO":switch(e){case"craftInventory":return["crafting"];case"crafting":return["craftInventory"];default:return[]}case"CLIENT":if(this.isCrafterWorking)return[];switch(e){case"craftInventory":return["ingredientsBag","craftPayment"];case"ingredientsBag":return["craftInventory"];case"craftPayment":return["craftInventory"];default:return[]}case"CRAFTER":if(!this.isCrafterWorking)return[];switch(e){case"craftInventory":return this.canUseCrafterIngredient||t.objectGID===w?["crafting"]:[];case"crafting":return c(t)?["craftInventory"]:["ingredientsBag"];case"ingredientsBag":return["crafting"];default:return[]}default:return[]}else switch(this.craftSide){case"SOLO":switch(e){case"craftInventory":return["crafting"];case"crafting":return["craftInventory"];default:return[]}case"CRAFTER":switch(e){case"craftInventory":return["crafting"];case"crafting":return["craftInventory"];default:return[]}case"CLIENT":switch(e){case"craftInventory":return["crafting","craftPayment"];case"crafting":return["craftInventory"];case"craftPayment":return["craftInventory"];default:return[]}default:return[]}},l.prototype.canItemMove=function(e,t,i){var n=this._getItemMoveTargets(e,i);return n.indexOf(t)!==-1},l.prototype.getQuickTransferPreference=function(e){var t=null;return t||d(this.craftType,this.craftSide,e)},l.prototype.getQuickTransferInfo=function(e,t,i){if(this.isCombining)return{targets:[],movedQty:0,proposedQty:0};var n=this._getItemMoveTargets(e,t);if(0===n.length)return{targets:[],movedQty:0,proposedQty:0};var o,s=this.isMagicCraft&&"CLIENT"===this.craftSide?"ingredientsBag":"crafting";if(o=n.indexOf(s)!==-1?this.howManyCanBeAddedToCraft(e,t,i):t.quantity,0===o)return{targets:[],movedQty:0,proposedQty:0};var a=this.getQuickTransferPreference(e);return a.move?{targets:n,movedQty:"max"===a.move?o:1}:{targets:n,proposedQty:"max"===a.propose?o:1,maxQty:o}},l.prototype.howManyCanBeAddedToCraft=function(e,t,i){if(this.isCombining)return 0;if(i<1)return 0;if(t.objectGID===w)return!this._getSignatureRuneOnTable()&&"CLIENT"!==this.craftSide&&this.canCrafterSign?1:0;if(this.isMagicCraft){if("CLIENT"===this.craftSide&&this.isCrafterWorking)return 0;if("CRAFTER"===this.craftSide&&!this.isCrafterWorking)return 0;var n="CRAFTER"===this.craftSide&&"craftInventory"===e;return this._isMagicRuneOrPotion(t)?n&&!this.canUseCrafterIngredient?0:i:this.isCraftableItem(t)?n?0:this._onCraftTable[t.objectUID]?0:1:0}return"SOLO"===this.craftSide?this.getFreeSlotCount()||this._onCraftTable[t.objectUID]?i:0:this.getFreeSlotCount()||this._stackCountPerGid[t.objectGID]?i:0},l.prototype.moveItemToCraft=function(e,t,i){if(!(i>=1))return console.error("moveItemToCraft quantity: "+i);if(this.isMagicCraft){var n=this._getReplacedItemOnMagicTable(t);n&&this.removeItemFromCraft(n,this._onCraftTable[n].quantity)}var o=t.objectUID;"CRAFTER"===this.craftSide&&"craftInventory"!==e?window.dofus.sendMessage("ExchangeObjectUseInWorkshopMessage",{objectUID:o,quantity:i}):window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:o,quantity:i})},l.prototype.removeItemFromCraft=function(e,t){return t>=1?void("CRAFTER"===this.craftSide&&this.isMagicCraft?window.dofus.sendMessage("ExchangeObjectUseInWorkshopMessage",{objectUID:e,quantity:-t}):window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e,quantity:-t})):console.error("removeItemFromCraft quantity: "+t)},l.prototype.initialize=function(e){function t(e,t){var i;i=t?g("ui.craft.referenceAdd",e.nameId):g("ui.craft.referenceRemove",e.nameId),window.gui.chat.logMsg(i)}function i(e){var t=o.list[e.jobId];t||(t={},o.list[e.jobId]=t),t.experience=e}var o=this;n(),a();var s=b.createFifo();e.on("JobDescriptionMessage",function(e){s.push(function(t){r(e.jobsDescription,o.list,function(i){if(i)return t(i);o.jobOriginalOrder=[];for(var n=0;n<e.jobsDescription.length;n++)o.jobOriginalOrder.push(e.jobsDescription[n].jobId);o.emit("jobListUpdated"),t()})})}),e.on("JobCrafterDirectorySettingsMessage",function(e){s.push(function(t){o.craftersSettings=e.craftersSettings,t()})}),e.on("JobListedUpdateMessage",function(e){s.push(function(i){var n=o.list[e.jobId];return n?(t(n.info,e.addedOrDeleted),i()):void v.getData("Jobs",e.jobId,function(n,o){return n?i(n):(t(o,e.addedOrDeleted),void i())})})}),e.on("JobExperienceUpdateMessage",function(e){s.push(function(t){i(e.experiencesUpdate);var n=e.experiencesUpdate.jobId;o.emit("jobExperienceUpdate",o.getJobExperience(n)),t()})}),e.on("JobExperienceMultiUpdateMessage",function(e){s.push(function(t){for(var n=0,s=e.experiencesUpdate.length;n<s;n+=1){i(e.experiencesUpdate[n]);var a=e.experiencesUpdate[n].jobId;o.emit("jobExperienceUpdate",o.getJobExperience(a))}t()})}),e.on("JobLevelUpMessage",function(e){s.push(function(t){r([e.jobsDescription],o.list,function(i){if(i)return t(i);var n=e.newLevel,s=o.list[e.jobsDescription.jobId];s.experience.jobLevel=n;var a=g("ui.craft.newJobLevel",s.info.nameId,n);window.gui.chat.logMsg(a),window.gui.openSimplePopup(a,g("ui.common.informations")),M("LEVEL_UP"),o.emit("jobLevelUp",s,n),t()})})}),e.on("JobUnlearntMessage",function(e){s.push(function(t){delete o.list[e.jobId],o.jobOriginalOrder.splice(o.jobOriginalOrder.indexOf(e.jobId),1),o.emit("jobListUpdated"),t()})}),e.on("JobAllowMultiCraftRequestMessage",function(e){s.push(function(t){o._publicMode=e.enabled,delete o._playersMultiCraftSkillById[window.gui.playerData.id],o.emit("jobPublicMode",o._publicMode),t()})}),e.on("JobMultiCraftAvailableSkillsMessage",function(e){s.push(function(t){o._updateMultiCraftAvailableSkills(e),t()})}),e.on("CurrentMapMessage",function(){s.push(function(e){o._playersMultiCraftSkillById={},e()})})},l.prototype.getCraftTable=function(){return this._onCraftTable},l.prototype.setExistingSlotCount=function(e){this._existingSlotCount=Math.min(Math.max(e,0),this.MAX_CRAFT_SLOTS)},l.prototype.getExistingSlotCount=function(){return this._existingSlotCount},l.prototype.getFreeSlotCount=function(){var e=this._stackCountPerGid[w]?1:0;return"SOLO"===this.craftSide?this._existingSlotCount-this._stackCount+e:this._existingSlotCount-Object.keys(this._stackCountPerGid).length+e},l.prototype.prepareSkillRecipes=function(e,t){s([e],t)},l.prototype.getRecipesBySkill=function(e){return h[e].recipes},l.prototype.getSkill=function(e){return h[e]},l.prototype.getStorageCraftFilterMap=function(e,t){for(var i=this._getRecipeByNbIngredient(e,1,t),n={},o=0,s=i.length;o<s;o+=1)for(var a=i[o].ingredientIds,r=0,l=a.length;r<l;r+=1){var c=a[r];n[c]=!0}return this.canCrafterSign&&"CLIENT"!==this.craftSide&&(n[w]=!0),n},l.prototype._getRecipeByNbIngredient=function(e,t,i){i=i||t;for(var n=this.getRecipesBySkill(e),o=[],s=0,a=n.length;s<a;s+=1){var r=n[s],l=r.ingredientIds.length;l>=t&&l<=i&&o.push(r)}return o},l.prototype._getRecipesWithItemsOnCraftTable=function(e){function t(){var e={};for(var t in i._onCraftTable){var n=i._onCraftTable[t],o=n.GID,s=n.quantity;o!==w&&(e[o]||(e[o]=0),e[o]+=s)}return e}for(var i=this,n=[],o=t(),s=Object.keys(o).length,a=this._getRecipeByNbIngredient(e,s),r=0,l=a.length;r<l;r+=1){var c=a[r],d=!0;for(var u in o){for(var h=parseInt(u,10),p=o[h],m=!1,f=0,g=c.ingredientIds.length;f<g;f+=1){var _=c.ingredientIds[f],v=c.quantities[f];if(h===_&&p===v){m=!0;break}}if(!m){d=!1;break}}d&&n.push(c)}return n},l.prototype.checkRecipe=function(e){var t,i=!1,n=this._getRecipesWithItemsOnCraftTable(e);return 1===n.length?(t=n[0],i=!0):e===this.SKILLID_DECRAFT&&(i=!0,t={resultId:this.ITEMID_MAGIC_FRAGMENT,resultLevel:1,ingredientIds:[],quantities:[]}),{isRecipeKnown:i,itemToCraft:t}},l.prototype._updateMultiCraftAvailableSkills=function(e){var t=this,i=e.playerId,n=e.skills,s={};if(!e.enabled)return void delete this._playersMultiCraftSkillById[i];for(var a=[],r=0,l=n.length;r<l;r+=1){var c=n[r];h[c]||a.push(c)}o("Skills",a,function(e){if(e)return console.error("JobData: Cannot get missing skills for ids",a,e);for(var o=0,r=n.length;o<r;o+=1){var l=n[o],c=h[l];c?s[l]=c:console.warn("JobsData: No data for skillId",l)}t._playersMultiCraftSkillById[i]=s})},l.prototype.playersMultiCraftSkillById=function(e){return this._playersMultiCraftSkillById[e]},l.prototype.getToolFromJob=function(e,t){var i=u[e];if(!i)return t(new Error("noJobForThatId "+e));var n=i.toolIds;if(!n||n.length<=0)return t();var o=null;y.getItems(n,function(e){if(e)return t(e);for(var i=0,s=n.length;i<s;i+=1){var a=n[i],r=y.items[a];if(r){var l=r.nameId;l.indexOf("WIP")===-1&&0!==r.iconId&&(!o||o.level>r.level||o.level===r.level&&o.objectGID>a)&&(o=r,o.objectGID=a)}}return t(null,o)})},l.prototype.getMaxSlotsByJobId=function(e){var t=this.list[e],i=0;if(!t)return 0;for(var n=t.description.skills,o=0,s=n.length;o<s;o+=1){var a=n[o].maxSlots;a&&a>i&&(i=a)}return i},l.prototype.getUsableSkillsInMap=function(e,t){var i=[];if(!t)return i;var n=this.playersMultiCraftSkillById(e);if(!n)return i;var o={};for(var s in t)for(var a=t[s],r=a.enabledSkills,l=a.disabledSkills,c=r.concat(l),d=0,u=c.length;d<u;d+=1){var h=c[d].skillId;n[h]&&!o[h]&&(i.push(n[h]),o[h]=!0)}return i},l.prototype.getJobNpcNameById=function(e){return x[e]},l.prototype.getJobExperience=function(e){var t=this.list[e];if(!t)return null;var i=t.experience||{},n={jobId:e};return n.currentLevel=i.jobLevel,n.currentExperience=i.jobXP,n.levelExperienceFloor=i.jobXpLevelFloor,n.levelExperienceCeil=i.jobXpNextLevelFloor,n.percentage=100,n.levelExperienceCeil&&(n.percentage=Math.floor((n.currentExperience-n.levelExperienceFloor)/(n.levelExperienceCeil-n.levelExperienceFloor)*100)),n}},function(e,t,i){function n(){o.call(this),this.finishedAchievementsIds=[],this.rewardableAchievements={},this.maximumNumberOfAchievements=0,this.points=0}var o=i(175).EventEmitter,s=i(172).inherits,a=i(29).getText,r=1.5,l=.7;s(n,o),e.exports=n,n.prototype.disconnect=function(){this.finishedAchievementsIds=[],this.rewardableAchievements={},this.points=0},n.prototype.initialize=function(e){var t=this;e.on("AchievementListMessage",function(e){var i=e.enrichData.points;e.enrichData.achievementsTotal&&(t.maximumNumberOfAchievements=e.enrichData.achievementsTotal),t.finishedAchievementsIds=e.finishedAchievementsIds;for(var n=0;n<e.rewardableAchievements.length;n++)t.finishedAchievementsIds.push(e.rewardableAchievements[n].id),t.rewardableAchievements[e.rewardableAchievements[n].id]=e.rewardableAchievements[n];t.points=i,t.emit("achievementListUpdated",e)}),e.on("AchievementFinishedMessage",function(e){window.gui.chat.logMsg(a("ui.achievement.achievementUnlockWithLink",e.id));var i=e.enrichData.points;t.finishedAchievementsIds.push(e.id),t.rewardableAchievements[e.id]=e,t.points+=i,t.emit("achievementFinished",e)}),e.on("AchievementRewardSuccessMessage",function(e){delete t.rewardableAchievements[e.achievementId],t.emit("achievementRewardSuccess",e.achievementId)})},n.prototype.getAchievementKamasReward=function(e,t){return t||(t=window.gui.playerData.characterBaseInformations.level),this._getKamasReward(e,t)},n.prototype.getAchievementExperienceReward=function(e,t){return t||(t=t||window.gui.playerData.characterBaseInformations.level),this._getExperienceReward(e,t)},n.prototype._getKamasReward=function(e,t){if(!e)return 0;var i=e.kamasScaleWithPlayerLevel?t:e.level;return Math.floor((Math.pow(i,2)+20*i-20)*e.kamasRatio)},n.prototype._getExperienceReward=function(e,t){function i(e,t){return Math.floor(e*Math.pow(100+2*e,2)/20*t)}var n=window.gui.playerData.experienceFactor;if(!e)return 0;var o=1+n/100,s=e.level,a=e.experienceRatio;if(t>s){var c=Math.floor(Math.min(t,s*r)),d=i(s,a),u=i(c,a),h=(1-l)*d,p=l*u;return Math.floor((h+p)*o)}var m=i(t,a);return Math.floor(m*o)},n.prototype.completedData=function(e){var t=this.finishedAchievementsIds.indexOf(e)!==-1,i=this.rewardableAchievements[e],n={isCompleted:t&&!i,finishedlevel:null};if(n.isCompleted)return n;var o=this.rewardableAchievements;for(var s in o){var a=o[s];if(a.id===e){n.isCompleted=!0,n.finishedlevel=a.finishedlevel;break}}return n},n.prototype.getAchievementPercent=function(){return 0===this.maximumNumberOfAchievements?0:Math.max(0,Math.min(100,Math.round(100/this.maximumNumberOfAchievements*this.points)))}},function(e,t,i){function n(){o.call(this),this._reset()}var o=i(188).EventEmitter,s=i(172).inherits,a=i(30),r=i(247),l=45;s(n,o),e.exports=n,n.prototype.disconnect=function(){this._reset()},n.prototype._reset=function(){this.mapId=0,this.subAreaId=0,this.worldmapId=0,this.mapPosition=null,this.subArea=null,this.area=null,this.superArea=null,this.coordinates={posX:0,posY:0},this.isInMyHouse=!1,this.currentMapHouses={}},n.prototype.initialize=function(e){function t(e){o.currentMapHouses={},o.emit("mapChanged",e)}function i(t,i){o.mapId=t.mapId,a.getData("MapPositions",t.mapId,function(n,s){if(n)return console.warn("MapPositions error",n);o.mapPosition=s;var l=i?i.worldX:s.posX,c=i?i.worldY:s.posY;return o.coordinates.posX=l,o.coordinates.posY=c,o.subArea&&o.subArea.id===t.subAreaId&&o.subAreaId===t.subAreaId?(o.emit("mapUpdate"),void r.mapChange(o.subArea.ambientSounds,s.sounds)):(o.subAreaId=t.subAreaId,void a.getData("SubAreas",o.subAreaId,function(t,i){if(t)return console.warn("SubAreas error",t);r.mapChange(i.ambientSounds,s.sounds),o.subArea=i,o.area=e.databases.Areas[i.areaId],o.superArea=e.databases.SuperAreas[o.area.superAreaId];var n=s.worldMap>=0?s.worldMap:o.superArea.worldmapId;o.worldmapId!==n&&(o.worldmapId=n,o.emit("worldMapUpdate")),o.emit("mapUpdate")}))})}function n(e){var t=e.currentHouse;if(t){var i=window.gui.playerData;o.isInMyHouse=t.ownerId===i.identification.accountId,o.emit("myHouseNotification",{isInMyHouse:o.isInMyHouse,msg:e})}else!t&&o.isInMyHouse&&(o.isInMyHouse=!1,o.emit("myHouseNotification",{isInMyHouse:o.isInMyHouse}))}var o=this;e.on("MapComplementaryInformationsDataMessage",function(e){t(e),i(e),n(e)}),e.on("MapComplementaryInformationsWithCoordsMessage",function(e){t(e),i(e,{worldX:e.worldX,worldY:e.worldY}),n(e)}),e.on("MapComplementaryInformationsDataInHouseMessage",function(e){t(e),i(e,e.currentHouse),n(e)}),e.on("HousePropertiesMessage",function(e){var t=e.properties;if(t){var i=t.houseId;o.currentMapHouses[i]=t}})},n.prototype.getHousePropertiesById=function(e){return this.currentMapHouses[e]},n.prototype.isInIncarnam=function(){return this.area?this.area.id===l:(console.warn("isInIncarnam called before we know our area"),!1)}},function(e,t,i){function n(){s.call(this),this._pastParties=null,this._reset()}function o(e,t,i,n){this._partyId=t,this._partyType=e,this._leaderId=i,this._myCharacterId=n,this._timeWhenDisconnected=0,this._inviterName=null,this._members={},this._guests={},this._pastMembers={}}var s=i(188).EventEmitter,a=i(172).inherits,r=i(29).getText,l=i(703),c=i(575),d=i(666),u=i(342),h=i(704),p=i(705),m=i(176),f=c.PARTY_TYPE_CLASSICAL,g=c.PARTY_TYPE_ARENA,_=3e5,v=1;a(n,s),e.exports=n,n.NUM_SLOTS_ARENA=3,n.NUM_SLOTS_CLASSIC=u.MAX_MEMBERS_PER_PARTY,n.prototype._reset=function(){this._partyFromId={},this.arenaStats={},this.arenaRegistered=!1,this.arenaStep=h.ARENA_STEP_UNREGISTER,this._followedCharacterId=0,this._partyFights={}},n.prototype.connect=function(){null===this._pastParties&&this._reloadRecentParties(),this._tryToRejoin(window.gui.playerData.id)},n.prototype.disconnect=function(){for(var e in this._partyFromId)this._archiveParty(this._partyFromId[e]);this._reset()},o.unserializeFrom=function(e){var t=new o(e._partyType,e._partyId,e._leaderId,e._myCharacterId);return t._timeWhenDisconnected=e._timeWhenDisconnected,t._members=e._members,t._guests=e._guests,t._pastMembers=e._pastMembers,t},o.prototype._purgeExpiredPastMembers=function(){for(var e in this._pastMembers){var t=this._pastMembers[e];Date.now()-t._timeWhenLeft>_&&delete this._pastMembers[e]}},o.prototype.getPartyId=function(){return this._partyId},o.prototype.getLeaderId=function(){return this._leaderId},o.prototype.getMember=function(e){return this._members[e]},o.prototype.getMembers=function(){return this._members},o.prototype.getGuest=function(e){return this._guests[e]},o.prototype.getSlotCount=function(){return this._partyType===g?n.NUM_SLOTS_ARENA:n.NUM_SLOTS_CLASSIC},o.prototype.getFreeSlotCount=function(){return this.getSlotCount()-this.getMemberCount()-this.getGuestCount()},o.prototype.getGuestCount=function(){return Object.keys(this._guests).length},o.prototype.getMemberCount=function(){return Object.keys(this._members).length+1},o.prototype._addMember=function(e,t){e!==this._myCharacterId&&(this._members[e]={name:t},this._pastMembers[e]&&delete this._pastMembers[e])},o.prototype._removeMember=function(e,t){this._purgeExpiredPastMembers();var i=this._members[e];i&&(t||(this._pastMembers[e]=i,i._timeWhenLeft=Date.now()),delete this._members[e])},o.prototype._addGuest=function(e){this._guests[e.guestId]={hostId:e.hostId,guestName:e.name,guestId:e.guestId}},o.prototype._removeGuest=function(e){delete this._guests[e]},n.prototype._joinParty=function(e,t,i,n,s){var a=new o(e,t,s,window.gui.playerData.id);this._partyFromId[t]=a;for(var r=0;r<i.length;r+=1){var l=i[r];a._addMember(l.id,l.name)}for(r=0;r<n.length;r++)a._addGuest(n[r]);e===g&&this.emit("arenaJoined"),this._rememberRecentParties(v)},n.prototype._leaveParty=function(e,t,i){var n=this._partyFromId[e];n&&(this.emit("playerLeavingParty",e,t),i&&this._archiveParty(n),delete this._partyFromId[e],this.emit("playerLeftParty",e,t),this._rememberRecentParties())},n.prototype._updatePartyLeader=function(e,t){var i=this._partyFromId[e];i&&(this.emit("partyLeaderUpdate",e,t),i._partyType===g&&this.emit("arenaLeaderUpdate",t),i._leaderId=t)},n.prototype._getPartyFromType=function(e){for(var t in this._partyFromId){var i=this._partyFromId[t];if(i._partyType===e)return i}return null},n.prototype.getClassicalParty=function(){return this._getPartyFromType(f)},n.prototype.getArenaParty=function(){return this._getPartyFromType(g)},n.prototype.getMemberName=function(e){var t=window.gui.playerData;if(e===t.id)return t.characterBaseInformations.name;for(var i in this._partyFromId){var n=this._partyFromId[i],o=n._members[e];if(o)return o.name}return"?"},n.prototype._addPartyGuest=function(e,t){var i=this._partyFromId[e];i&&(i._addGuest(t),this.emit("partyNewGuest",e,t))},n.prototype._removePartyGuest=function(e,t,i){var n=this._partyFromId[e];n&&(this.emit("partyGuestLeaving",e,t,i),n._removeGuest(t))},n.prototype._addPartyMember=function(e,t){var i=this._partyFromId[e];i&&(i._removeGuest(t.id),i._addMember(t.id,t.name),i._partyType===g&&this.emit("arenaNewMember",t),this.emit("partyNewMember",e,t),this._rememberRecentParties())},n.prototype._removePartyMember=function(e,t,i){var n=this._partyFromId[e];n&&(this.emit("partyMemberLeaving",e,t,i),n._partyType===g&&this.emit("arenaMemberLeaving",t),n._removeMember(t,!!i),this._rememberRecentParties())},n.prototype.getGuestName=function(e,t){var i=this._partyFromId[e];if(!i)return"?";var n=i._guests[t];return n?n.guestName:"?"},n.prototype._enrichGuestInfo=function(e){e.isGuest=!0,e.level="?",e.id=e.guestId,e.entityLook=e.guestLook},n.prototype.getFollowedCharacterId=function(){return this._followedCharacterId},n.prototype.initialize=function(e){var t=this,i=window.dofus.connectionManager;i.on("PartyInvitationMessage",function(i){t._handleRequestedInvitation(i.partyType,i.partyId,i.fromName)||e.party.showPartyInvitationQuestion(i.partyType,i.partyId,i.fromName)}),e.on("PartyInvitationDetailsMessage",function(e){for(var i=0;i<e.guests.length;i++)t._enrichGuestInfo(e.guests[i]);t.emit("partyInvitationDetails",e)}),e.on("PartyNewGuestMessage",function(e){t._enrichGuestInfo(e.guest),t._addPartyGuest(e.partyId,e.guest)}),e.on("PartyNewMemberMessage",function(e){t._addPartyMember(e.partyId,e.memberInformations)}),e.on("PartyUpdateMessage",function(e){t.emit("partyUpdateMember",e.partyId,e.memberInformations)}),i.on("PartyDeletedMessage",function(e){t._leaveParty(e.partyId,0,!0)}),i.on("PartyLeaveMessage",function(e){t._leaveParty(e.partyId,0)}),i.on("PartyKickedByMessage",function(e){t._leaveParty(e.partyId,e.kickerId)}),i.on("PartyCancelInvitationNotificationMessage",function(e){t._removePartyGuest(e.partyId,e.guestId,e.cancelerId)}),i.on("PartyInvitationCancelledForGuestMessage",function(e){t.emit("partyInvitationCancelled",e.partyId,e.cancelerId)}),e.on("PartyJoinMessage",function(e){t._joinParty(e.partyType,e.partyId,e.members,e.guests,e.partyLeaderId)}),i.on("PartyMemberRemoveMessage",function(e){t._removePartyMember(e.partyId,e.leavingPlayerId)}),i.on("PartyMemberEjectedMessage",function(e){t._removePartyMember(e.partyId,e.leavingPlayerId,e.kickerId)}),i.on("PartyLeaderUpdateMessage",function(e){t._updatePartyLeader(e.partyId,e.partyLeaderId)}),i.on("PartyRefuseInvitationNotificationMessage",function(e){t._removePartyGuest(e.partyId,e.guestId)}),e.on("PartyFollowStatusUpdateMessage",function(e){e.success&&(t._followedCharacterId=e.followedId)}),e.on("GameRolePlayArenaRegistrationStatusMessage",function(e){t.arenaStep=e.step,t.arenaRegistered=e.registered,1!==e.step||e.registered||(t.nbArenaFigthersReady=0),t.emit("arenaRegistrationStatus")}),e.on("GameFightJoinMessage",function(e){e.fightType!==d.FIGHT_TYPE_PVP_ARENA||e.isSpectator||(t.arenaStep=h.ARENA_STEP_STARTING_FIGHT,t.arenaRegistered=!1,t.emit("arenaRegistrationStatus")),t._cleanPartyFightNotifications()}),e.on("GameFightEndMessage",function(){t.arenaStep===h.ARENA_STEP_STARTING_FIGHT&&(t.arenaStep=h.ARENA_STEP_UNREGISTER,t.emit("arenaRegistrationStatus"),t.emit("arenaFightEnd"))}),e.on("GameRolePlayArenaUpdatePlayerInfosMessage",function(e){t.arenaStats={rank:e.rank,bestDailyRank:e.bestDailyRank,bestRank:e.bestRank,victoryCount:e.victoryCount,arenaFightCount:e.arenaFightcount},t.emit("arenaStatsUpdated")}),e.on("GameRolePlayArenaFighterStatusMessage",function(e){e.accepted?(t.nbArenaFigthersReady++,t.emit("arenaFighterReady",t.nbArenaFigthersReady)):t.emit("arenaFightDeclined",e.fightId,e.playerId)}),e.on("PartyCannotJoinErrorMessage",function(e){var t;switch(e.reason){case l.PARTY_JOIN_ERROR_UNKNOWN:t=r("ui.party.cantInvit");break;case l.PARTY_JOIN_ERROR_PLAYER_NOT_FOUND:break;case l.PARTY_JOIN_ERROR_PARTY_NOT_FOUND:t=r("ui.party.cantFindParty");break;case l.PARTY_JOIN_ERROR_PARTY_FULL:t=r("ui.party.partyFull");break;case l.PARTY_JOIN_ERROR_PLAYER_BUSY:t=r("ui.party.cantInvitPlayerBusy");break;case l.PARTY_JOIN_ERROR_PLAYER_ALREADY_INVITED:t=r("ui.party.playerAlreayBeingInvited");break;case l.PARTY_JOIN_ERROR_PLAYER_TOO_SOLLICITED:t=r("ui.party.playerTooSollicited");break;case l.PARTY_JOIN_ERROR_UNMODIFIABLE:t=r("ui.party.partyUnmodifiable");break;case l.PARTY_JOIN_ERROR_UNMET_CRITERION:case l.PARTY_JOIN_ERROR_PLAYER_LOYAL:}t&&this.openSimplePopup(t)}),e.on("PartyMemberInFightMessage",function(i){var n=e.playerData.isFighting&&!e.playerData.isSpectator;if(!n){var o,s=i.fightMap.mapId;switch(i.reason){case p.FIGHT_REASON_MONSTER_ATTACK:o=r("ui.party.memberStartFight.monsterAttack",i.memberName,i.memberId,s);break;case p.FIGHT_REASON_PLAYER_ATTACK:o=r("ui.party.memberStartFight.playerAttack",i.memberName,i.memberId,s);break;case p.FIGHT_REASON_MEMBER_ATTACKED_PLAYERS:o=r("ui.party.memberStartFight.attackPlayer",i.memberName,i.memberId,s);break;default:o=r("ui.party.memberStartFight.unknownReason",i.memberName,i.memberId,s)}e.chat.logMsg(o);var a=i.secondsBeforeFightStart;if(t._addFightInfo(s,i.fightId,i.memberId,i.memberName,a),e.playerData.position.mapId===s){var l=i.memberId;e.party.showPartyFightQuestion(i.fightId,l,i.memberId,i.memberName,a)}}}),e.on("GameRolePlayRemoveChallengeMessage",function(i){e.party.removePartyFightQuestion(i.fightId),t._deleteFightInfo(e.playerData.position.mapId,i.fightId)}),e.on("MapComplementaryInformationsDataMessage",function(i){t._cleanPartyFightNotifications();var n=t._partyFights[i.mapId];if(n)for(var o=i.fights,s=0;s<o.length;s++){var a=n[o[s].fightId];if(a){var r=a.memberId;e.party.showPartyFightQuestion(a.fightId,r,a.memberId,a.memberName,a.startTime-Date.now())}}})},n.prototype._addFightInfo=function(e,t,i,n,o){var s=this._partyFights[e];s||(s=this._partyFights[e]={}),s[t]={fightId:t,memberId:i,memberName:n,startTime:Date.now()+o};var a=this;window.setTimeout(function(){a._deleteFightInfo(e,t)},o)},n.prototype._deleteFightInfo=function(e,t){var i=this._partyFights[e];i&&(delete i[t],0===Object.keys(i).length&&delete this._partyFights[e])},n.prototype._cleanPartyFightNotifications=function(){for(var e in this._partyFights){var t=this._partyFights[e];for(var i in t)window.gui.party.removePartyFightQuestion(i)}},n.prototype._archiveParty=function(e){e._timeWhenDisconnected=Date.now(),this._pastParties[e._partyId]=e},n.prototype._purgeExpiredPastParties=function(){var e,t={};for(var i in this._pastParties)e=this._pastParties[i],t[e._partyType]=Math.max(t[e._partyType]||0,e._timeWhenDisconnected),Date.now()-e._timeWhenDisconnected>_&&delete this._pastParties[i];for(i in this._pastParties)e=this._pastParties[i],e._timeWhenDisconnected<t[e._partyType]&&delete this._pastParties[i]},n.prototype._rememberRecentParties=function(e){var t={};for(var i in this._partyFromId)t[i]=this._partyFromId[i];this._purgeExpiredPastParties();for(i in this._pastParties)t[i]=this._pastParties[i];m.setValue("recentParties",t,e)},n.prototype._reloadRecentParties=function(){var e=m.getValue("recentParties",{});this._pastParties={};for(var t in e){var i=o.unserializeFrom(e[t]);this._pastParties[t]=i,i._timeWhenDisconnected||(i._timeWhenDisconnected=Date.now())}},n.prototype._tryToRejoin=function(e){this._purgeExpiredPastParties();for(var t in this._pastParties){var i=this._pastParties[t];if(!i._inviterName&&e===i._myCharacterId){var n=[];for(var o in i._members)n.push(i._members[o].name);i._purgeExpiredPastMembers();for(o in i._pastMembers)n.push(i._pastMembers[o].name);if(n.length){var s=i._members[i._leaderId]||i._pastMembers[i._leaderId];s&&(n.splice(n.indexOf(s.name),1),n.unshift(s.name)),this._findOnlineInviter(i,n)}}}},n.prototype._findOnlineInviter=function(e,t){var i=this;window.gui.chat.p2p.checkPlayerOnline(t[0],function(n,o){return o?(e._inviterName=n,window.gui.chat.p2p.sendMsg(n,"rejoinRequest",e._partyId)):(t.shift(),t.length?i._findOnlineInviter(e,t):void 0)})},n.prototype.handleRejoinRequest=function(e,t){var i,n;this._purgeExpiredPastParties();var o=this._partyFromId[e];if(o){if(n=o._partyType,o._purgeExpiredPastMembers(),i=o._pastMembers[t],!i)return;if(0===o.getFreeSlotCount())return}else{var s=this._pastParties[e];if(!s)return;if(s._purgeExpiredPastMembers(),i=s._members[t]||s._pastMembers[t],!i)return;if(n=s._partyType,this._getPartyFromType(n))return}var a=n===g?"PartyInvitationArenaRequestMessage":"PartyInvitationRequestMessage";window.dofus.sendMessage(a,{name:i.name})},n.prototype._handleRequestedInvitation=function(e,t,i){this._purgeExpiredPastParties();var n=this._pastParties[t];if(!n){var o=!1;for(var s in this._pastParties){var a=this._pastParties[s];if(a._partyType===e&&a._inviterName===i){o=!0;break}}if(!o)return!1}return window.dofus.sendMessage("PartyAcceptInvitationMessage",{partyId:t}),!0}},function(e,t){e.exports={PARTY_JOIN_ERROR_UNKNOWN:0,PARTY_JOIN_ERROR_PLAYER_NOT_FOUND:1,PARTY_JOIN_ERROR_PARTY_NOT_FOUND:2,PARTY_JOIN_ERROR_PARTY_FULL:3,PARTY_JOIN_ERROR_PLAYER_BUSY:4,PARTY_JOIN_ERROR_PLAYER_ALREADY_INVITED:6,PARTY_JOIN_ERROR_PLAYER_TOO_SOLLICITED:7,PARTY_JOIN_ERROR_PLAYER_LOYAL:8,PARTY_JOIN_ERROR_UNMODIFIABLE:9,PARTY_JOIN_ERROR_UNMET_CRITERION:10}},function(e,t){e.exports={ARENA_STEP_REGISTRED:0,ARENA_STEP_WAITING_FIGHT:1,ARENA_STEP_STARTING_FIGHT:2,ARENA_STEP_UNREGISTER:3}},function(e,t){e.exports={FIGHT_REASON_UNKNOWN:0,FIGHT_REASON_MONSTER_ATTACK:1,FIGHT_REASON_PLAYER_ATTACK:2,FIGHT_REASON_MEMBER_ATTACKED_PLAYERS:3}},function(e,t,i){function n(){s.call(this),this._reset()}var o=i(31),s=i(188).EventEmitter,a=i(707),r=i(172).inherits,l=i(339).createFifo();r(n,s),e.exports=n,n.prototype._reset=function(){this.finished={},this.active={},this.all={},this.initialized=!1},n.prototype.connect=function(e){return e?window.gui.once("GameFightStartingMessage",function(){
window.dofus.sendMessage("QuestListRequestMessage")}):void window.dofus.sendMessage("QuestListRequestMessage")},n.prototype.disconnect=function(){this._reset()},n.prototype.initialize=function(e){var t=this;e.on("QuestListMessage",function(e){o.parallel([function(i){a.createFinishedQuestsMap(e.finishedQuestsIds,e.finishedQuestsCounts,function(e,n){if(e)return i(e);for(var o in n)t.finished[o]=t.all[o]=n[o];i()})},function(i){a.initializeActiveQuests(e.activeQuests,function(e,n){if(e)return i(e);for(var o in n)t.active[o]=t.all[o]=n[o];i()})}],function(e){return e?console.error(e):(t.initialized=!0,void t.emit("listUpdated"))})}),e.on("QuestStartedMessage",function(e){delete t.finished[e.questId],window.dofus.sendMessage("QuestStepInfoRequestMessage",{questId:e.questId})}),e.on("QuestObjectiveValidatedMessage",function(e){var i=t.active[e.questId];window.dofus.sendMessage("QuestStepInfoRequestMessage",{questId:i.questId});for(var n=0,o=i.objectives.length;n<o;n+=1){var s=i.objectives[n];if(s.objectiveId===e.objectiveId)return s.objectiveStatus=!1,t.emit("objectiveValidated",i,e.objectiveId),t.emit("questUpdate",e.questId)}}),e.on("QuestStepInfoMessage",function(e){l.push(function(i){if(!e.infos.objectives)return i();var n=e.infos;if(!n)return i();var o=n.questId,s=t.active[o]||n;s.stepId=n.stepId,s.objectives=n.objectives,s.dbQuest?a.updateQuestObjectives(s,function(e){return e?i(e):(t.emit("questUpdate",s.questId),void i())}):a.initializeActiveQuests([s],function(e,n){return e?i(e):(t.active[o]=t.all[o]=n[o],t.emit("questStarted",o),void i())})})}),e.on("QuestStepStartedMessage",function(e){var i=t.active[e.questId];i&&(i.stepId=e.stepId,window.dofus.sendMessage("QuestStepInfoRequestMessage",{questId:i.questId}))}),e.on("QuestStepValidatedMessage",function(e){var i=t.active[e.questId];if(i){var n=i.dbQuest.stepIds,o=n.indexOf(e.stepId);i.stepId=n[o+1],t.emit("stepValidated",i,e.stepId),window.dofus.sendMessage("QuestStepInfoRequestMessage",{questId:i.questId})}}),e.on("QuestValidatedMessage",function(e){var i=t.active[e.questId];delete t.active[e.questId],i.finishedCount=1,t.finished[e.questId]=t.all[e.questId]=i,t.emit("questFinished",i)})}},function(e,t,i){function n(e,t,i,n,o){e[n.id]||(e[n.id]=[],o[n.id]=n.type),e[n.id].push(t[i])}function o(e,t){for(var i=window.gui.databases.QuestObjectiveTypes,o={},r={},l=0,h=e.length;l<h;l+=1)for(var p=e[l],m=p.objectives,f=0,g=m.length;f<g;f+=1)for(var _=p.dbObjectives[m[f].objectiveId],v=c[_._type],y=0,b=v.length;y<b;y+=1){var M=v[y];n(o,_.parameters,y,M,r)}s.each(Object.keys(o),function(e,t){return o[e].length?void d[r[e]](o,e,t):t()},function(n){if(n)return t(n);for(var s=0,r=e.length;s<r;s+=1)for(var l=e[s],d=l.objectives,h=0,p=d.length;h<p;h+=1){for(var m=d[h],f=l.dbObjectives[m.objectiveId],g=f.parameters.slice(0),_=c[f._type],v=0,y=_.length;v<y;v+=1){var b=_[v];u[b.type](g,o,v,b)}var M=i[f.typeId].nameId;g.unshift(M),m.text=a.apply(null,g)}t()})}var s=i(31),a=i(29).processText,r=i(30),l=i(708),c={QuestObjectiveBringItemToNpc:[{type:"table",id:"Npcs"},{type:"table",id:"Items"}],QuestObjectiveBringSoulToNpc:[{type:"table",id:"Npcs"},{type:"table",id:"Monsters"}],QuestObjectiveDiscoverMap:[{type:"getText",id:"GetText"}],QuestObjectiveDiscoverSubArea:[{type:"table",id:"SubAreas"}],QuestObjectiveDuelSpecificPlayer:[{type:"getText",id:"GetText"}],QuestObjectiveFightMonster:[{type:"table",id:"Monsters"}],QuestObjectiveFightMonstersOnMap:[{type:"table",id:"Monsters"}],QuestObjectiveFreeForm:[{type:"getText",id:"GetText"}],QuestObjectiveGoToNpc:[{type:"table",id:"Npcs"}],QuestObjectiveMultiFightMonster:[{type:"table",id:"Monsters"}]},d={table:function(e,t,i){r.getDataMap(t,e[t],function(n,o){e[t]=o,i(n)})},getText:function(e,t,i){r.getText(e[t],function(n,o){e[t]=o,i(n)})}},u={table:function(e,t,i,n){e[i]=t[n.id][e[i]].nameId},getText:function(e,t,i){e[i]=t.GetText[e[i]]}};e.exports.updateQuestObjectives=function(e,t){o([e],t)},e.exports.createFinishedQuestsMap=function(e,t,i){var n={};r.getDataMap("Quests",e,function(o,s){if(o)return i(o);for(var a=0,r=e.length;a<r;a+=1){var l=e[a];n[l]={questId:l,dbQuest:s[l],finishedCount:t[a]}}i(null,n)})},e.exports.initializeActiveQuests=function(e,t){for(var i=[],n={},a=0,c=e.length;a<c;a+=1){var d=e[a];n[d.questId]=d,i.push(d.questId)}r.getDataMap("Quests",i,function(i,a){if(i)return t(i);var c=[];for(var d in a){var u=n[d].dbQuest=a[d];c=c.concat(u.stepIds)}r.getDataMap("QuestSteps",c,function(i,c){if(i)return t(i);var d=[],u=[];for(var h in a){var p=n[h],m=p.dbQuest.stepIds;p.dbSteps={};var f,g;for(f=0,g=m.length;f<g;f+=1){var _=m[f],v=p.dbSteps[_]=c[_];d=d.concat(v.rewardsIds),u=u.concat(v.objectiveIds)}}var y=[{ids:u,table:"QuestObjectives"},{ids:d,table:"QuestStepRewards"}];s.each(y,function(e,t){r.getDataMap(e.table,e.ids,function(i,n){e.data=n,t(i)})},function(i){if(i)return t(i);for(var s in a){var r=n[s];r.dbObjectives={},r.dbRewards={};for(var c in r.dbSteps){var d,u,h,p=r.dbSteps[c];for(d=0,u=p.objectiveIds.length;d<u;d+=1)h=p.objectiveIds[d],r.dbObjectives[h]=y[0].data[h],0===r.dbObjectives[h].mapId&&(r.dbObjectives[h].mapId=l[h]||0);for(d=0,u=p.rewardsIds.length;d<u;d+=1)h=p.rewardsIds[d],r.dbRewards[h]=y[1].data[h]}}o(e,function(e){t(e,n)})})})})}},function(e,t){var i={713:"80216068",4944:"80216068",4945:"80216068",5048:"80216068",5068:"80216068",5071:"80216068",5134:"80216068",720:"80216579",5051:"80216579",745:"80216580",5132:"80216580",5133:"80216580",4982:"80216833",757:"80217090",785:"80217090",4983:"80217098",748:"80217602",793:"80217605",794:"80217605",820:"80218116",5139:"80218116",5157:"80218116",5158:"80218116",5162:"80218116",5163:"80218116",5164:"80218116",5165:"80218116",5166:"80218116",5184:"80218116",787:"80218120",788:"80218120",789:"80218120",790:"80218120",791:"80218120",5073:"80218120",5074:"80218120",786:"80218624",5069:"80218624",5070:"80218624",751:"80218626",771:"80218626",4990:"80218627",5047:"80218631",810:"80219136",783:"80219143",784:"80219144",796:"80219144",4963:"80219144",4995:"80219653",808:"80219654",809:"80219654",749:"80219655",4991:"80220160",4993:"80220163",746:"80220164",753:"80220164",4992:"80220673",747:"80220676",4907:"80220676",4981:"80347648",4980:"80347651",4985:"80347653",5189:"80347656",4984:"80348167",5072:"80740865",4943:"81003522",4655:"81268739",4656:"81268739",4941:"81269763",4942:"81269763",758:"81270787",759:"81270787",4947:"81270787",4964:"81270787",4986:"81270787",4996:"81270787",5024:"81270787",5043:"81270787",4657:"81396739",729:"81527297",782:"81527297",822:"81527297",823:"81527297",724:"81527299",750:"81527299",755:"81527299",800:"81527299",806:"81527299",5067:"81527299",744:"81527301",752:"81527301",754:"81528321",824:"81528321",825:"81528321",4946:"81528321",5136:"81528321",5140:"81528321",5141:"81528321",5142:"81528321",5159:"81528321",5161:"81528321",804:"81528323",5058:"81528323",5135:"81528323",761:"81529345",795:"81529345",821:"81529345",5160:"81529345",4912:"84672515",4916:"84673538",4911:"84674048",4910:"84675586",5717:"84676097",4919:"84676101",4921:"84676103",4909:"84804101"};e.exports=i},function(e,t,i){function n(){r.call(this),this.friendsList={},this.enemiesList={},this.ignoredList={},this.spouse=null,this.onConnectNotification=!1}var o=i(202),s=i(29).getText,a=i(339),r=i(188).EventEmitter,l=i(172).inherits;l(n,r),e.exports=n,n.prototype.connect=function(){window.dofus.sendMessage("FriendsGetListMessage"),window.dofus.sendMessage("IgnoredGetListMessage"),window.dofus.sendMessage("SpouseGetInformationsMessage")},n.prototype.disconnect=function(){this.friendsList={},this.enemiesList={},this.ignoredList={},this.spouse=null,this.onConnectNotification=!1},n.prototype.initialize=function(e){var t=this,i={0:s("ui.common.unknownFail"),1:s("ui.social.friend.addFailureListFull"),2:s("ui.social.friend.addFailureNotFound"),3:s("ui.social.friend.addFailureEgocentric"),4:s("ui.social.friend.addFailureAlreadyInList")};o.on("PlayerStatusUpdateMessage",function(e){t.friendsList[e.accountId]&&(t.friendsList[e.accountId].status=e.status,t.emit("friendUpdate",t.friendsList[e.accountId])),t.enemiesList[e.accountId]&&(t.enemiesList[e.accountId].status=e.status,t.emit("enemyUpdate",t.enemiesList[e.accountId])),t.ignoredList[e.accountId]&&(t.ignoredList[e.accountId].status=e.status,t.emit("ignoredUpdate",t.ignoredList[e.accountId]))}),e.on("FriendUpdateMessage",function(e){var i=e.friendUpdated;t.friendsList[i.accountId]=i,t.emit("friendUpdate",i),t.emit("enemyUpdate",i),t.emit("ignoredUpdate",i)}),e.on("FriendsListMessage",function(e){for(var i={},n=0;n<e.friendsList.length;n++)i[e.friendsList[n].accountId]=e.friendsList[n];t.friendsList=i,t.emit("newFriendList")}),e.on("IgnoredListMessage",function(e){for(var i={},n=0;n<e.ignoredList.length;n++)i[e.ignoredList[n].accountId]=e.ignoredList[n];t.enemiesList=i,t.emit("newEnemyList")}),e.on("FriendAddedMessage",function(e){t.friendsList[e.friendAdded.accountId]=e.friendAdded,t.emit("friendAdded",e.friendAdded)}),e.on("IgnoredAddedMessage",function(e){var i=e.session?t.ignoredList:t.enemiesList;i[e.ignoreAdded.accountId]=e.ignoreAdded,t.emit(e.session?"ignoredAdded":"enemyAdded",e.ignoreAdded)}),o.on("FriendDeleteResultMessage",function(i){if(i.success){e.chat.logError(s("ui.social.friend.delete"));for(var n in t.friendsList)if(t.friendsList[n].accountName===i.name)return delete t.friendsList[n],t.emit("friendDeleted",n)}}),e.on("IgnoredDeleteResultMessage",function(e){if(e.success){var i=e.session?t.ignoredList:t.enemiesList;for(var n in i)if(i[n].accountName===e.name)return delete i[n],t.emit(e.session?"ignoredDeleted":"enemyDeleted",n)}}),o.on("FriendAddFailureMessage",function(t){e.chat.logError(i[t.reason])}),o.on("IgnoredAddFailureMessage",function(t){e.chat.logError(i[t.reason])}),e.on("FriendWarnOnConnectionStateMessage",function(e){t.onConnectNotification=e.enable}),e.on("SpouseInformationsMessage",function(e){var i=e.spouse;t.spouse={spouseAccountId:i.spouseAccountId,spouseId:i.spouseId,spouseName:i.spouseName,spouseLevel:i.spouseLevel,breed:i.breed,sex:i.sex,spouseEntityLook:i.spouseEntityLook,guildInfo:i.guildInfo,alignmentSide:i.alignmentSide,mapId:i.mapId,subAreaId:i.subAreaId,inFight:i.inFight,followSpouse:i.followSpouse},t.emit("spouseUpdate",t.spouse)}),e.on("SpouseStatusMessage",function(e){t.spouse&&e.hasSpouse===!1&&(t.spouse=null,t.emit("spouseLeft"))}),e.on("MoodSmileyUpdateMessage",function(e){var i=t.friendsList[e.accountId];i&&(i.moodSmileyId=e.smileyId,t.emit("friendUpdate",i),t.emit("enemyUpdate",i),t.emit("ignoredUpdate",i))})},n.prototype.isIgnored=function(e){return!!this.ignoredList[e]},n.prototype.searchOnlineFriendById=function(e){for(var t in this.friendsList){var i=this.friendsList[t];if(i.playerId===e)return i}return null},n.prototype.searchOnlineFriendByName=function(e){var t=a.simplifyString(e);for(var i in this.friendsList){var n=this.friendsList[i];if(n.playerName&&a.simplifyString(n.playerName)===t)return n}return null},n.prototype.isMutualFriend=function(e){return e.level>0}},function(e,t,i){function n(){o.call(this),this._itemList={}}var o=i(175).EventEmitter,s=i(172).inherits;s(n,o),e.exports=n,n.prototype.initialize=function(){function e(e,t){i._itemList[e]=t}var t=window.dofus.connectionManager,i=this;t.on("ExchangeShopStockMovementUpdatedMessage",function(t){t.objectInfo&&e(t.objectInfo.objectGID,t.objectInfo.quantity)}),t.on("ExchangeShopStockStartedMessage",function(t){if(t.objectsInfos)for(var i=0;i<t.objectsInfos.length;i++)e(t.objectsInfos[i].objectGID,t.objectsInfos[i].quantity)})},n.prototype.getItemSellableAmount=function(e){var t=this._itemList[e]||0,i=window.gui.playerData.inventory.quantityList[e]||0;return t+i},n.prototype.disconnect=function(){this._itemList={}}},function(e,t,i){function n(){this.alignmentInfos=null,this.playerRank=null,this.alignmentRank=null,this.alignmentTitles=null,this.alignmentRanks=null,this._imagePaths=["gfx/alignments/Alignement_tx_IllusNeutre.png","gfx/alignments/Alignement_tx_IllusBontarien.png","gfx/alignments/Alignement_tx_IllusBrakmarien.png","gfx/alignments/Alignement_tx_IllusMercenaire.png"],this._orderImagePaths=["gfx/alignments/order_0.png","gfx/alignments/order_1.png","gfx/alignments/order_2.png","gfx/alignments/order_3.png","gfx/alignments/order_4.png","gfx/alignments/order_5.png","gfx/alignments/order_6.png","gfx/alignments/order_7.png","gfx/alignments/order_8.png","gfx/alignments/order_9.png"],this._sideImagePaths={1:"gfx/alignments/wings/tx_alignment1_frame0.png",2:"gfx/alignments/wings/tx_alignment2_frame0.png"}}var o=i(175).EventEmitter,s=i(172).inherits,a=i(30),r=i(182),l=45,c=63;s(n,o),e.exports=n,n.prototype.initialize=function(e){var t=this;e.on("AlignmentRankUpdateMessage",function(e){t.playerRank=e.alignmentRank,t.emit("alignmentChanged")}),e.on("initialized",function(){var i=["AlignmentTitles","AlignmentRank"];a.getAllDataTable(i,function(e,i){return e?console.error("Unable to load data for alignment window",e):(t.alignmentTitles=i.AlignmentTitles,void(t.alignmentRanks=i.AlignmentRank))}),e.playerData.on("alignmentInfosUpdated",function(){t.alignmentInfos=this.characters.mainCharacter.characteristics.alignmentInfos,t.alignmentSide=e.databases.AlignmentSides[t.alignmentInfos.alignmentSide],t.emit("alignmentChanged")})});var i="gfx/alignments/wings.json";r.loadJson(i,function(e){e.meta&&e.symbols&&(e=e.symbols),t._wingsData=e})},n.prototype.getRank=function(e){a.getData("AlignmentRank",this.playerRank,e)},n.prototype.getOrder=function(e,t){a.getData("AlignmentOrder",e.orderId,t)},n.prototype.getAlignmentImageUrl=function(e){this.alignmentInfos?r.preloadImage(this._imagePaths[this.alignmentInfos.alignmentSide],e):r.preloadImage(this._imagePaths[0],e)},n.prototype.getTopWings=function(e,t){var i=this,n=e.alignmentSide,o=e.alignmentGrade,s=10*(n-1)+o,a="gfx/alignments/wings/demonAngel_frame"+s+".png",r=i._wingsData[l].frames[s].position,c={imagePath:a,left:r.x,top:r.y,width:r.w,height:r.h};t(c)},n.prototype.getBottomWings=function(e,t){var i=this,n=e.alignmentSide,o=e.alignmentGrade,s=10*(n-1)+o;if(i._wingsData[c].frames[s]){var a="gfx/alignments/wings/demonAngel2_frame"+s+".png",r=i._wingsData[c].frames[s].position,l={imagePath:a,left:r.x,top:r.h+r.y,width:r.w,height:r.h};t(l)}else t(null)},n.prototype.getSmallWingsUrl=function(e,t){var i=this._sideImagePaths[e];r.preloadImage(i,t)},n.prototype.getOrderImageUrl=function(e,t){var i=this._orderImagePaths[e];r.preloadImage(i,t)},n.prototype.getAlignmentGradeString=function(){var e=this.alignmentInfos,t=e.alignmentGrade,i=e.alignmentSide,n=this.alignmentTitles;return t+" ("+n[i].namesId[t]+")"},n.prototype.getHonor=function(){var e=this.alignmentInfos,t=(e.honor-e.honorGradeFloor)/(e.honorNextGradeFloor-e.honorGradeFloor);return t},n.prototype.getNameId=function(){return this.alignmentSide.nameId}},function(e,t,i){function n(){this._adminMenuId=null,this._myRank=null,this._url=null,this._isModeratorOrMore=null}var o=i(202),s=i(194);e.exports=n,n.prototype.initialize=function(){var e=this;o.on("AccountCapabilitiesMessage",function(t){t._url&&(e._url=t._url),t._myModeratorRank&&Array.isArray(t._myModeratorRank)&&(e._myRank=t._myModeratorRank,e.setAdminMenuId(e._myRank[e._myRank.length-1]))})},n.prototype.connect=function(e,t){this._isModeratorOrMore=t,e&&s.getWindow("adminConsole").adminStartup()},n.prototype.disconnect=function(){this._adminMenuId=null,this._myRank=null,this._url=null,this._isModeratorOrMore=null},n.prototype.getAdminMenuId=function(){var e=null,t=this._adminMenuId;return this._isModeratorOrMore&&t&&this._url&&(e=t),e},n.prototype.getURL=function(){return this._url},n.prototype.setAdminMenuId=function(e){return!!this._canUse(e)&&(this._adminMenuId=e,s.getWindow("adminConsole").logMessage('adminMenu "'+e+'" loaded.',"Debug"),!0)},n.prototype._canUse=function(e){return!(null===this._myRank||!this._url)&&this._myRank.indexOf(e)!==-1},n.prototype.helpToString=function(){var e=[];if(!Array.isArray(this._myRank))return e.join("\n");for(var t=0;t<this._myRank.length;t+=1){var i=this._myRank[t];this._canUse(i)&&e.push(i)}return e.join("\n")}},function(e,t,i){function n(){window.dofus.connectionManager.send("bakSoftToHardCurrentRateRequest"),window.dofus.connectionManager.send("bakHardToSoftCurrentRateRequest")}function o(){var e=window.dofus.connectionManager,i=window.gui;i.on("connected",function(){window.Config.disabledFeatures.shop||(n(),a.setInterval(n,c))}),e.on("bakSoftToHardCurrentRateSuccess",function(e){null!==r&&r===e.rate||(r=e.rate,t.emit("computedSoftPricesChange"))}),e.on("bakHardToSoftCurrentRateSuccess",function(e){null!==l&&l===e.rate||(l=e.rate,t.emit("computedHardPricesChange"))}),e.on("bakSoftToHardCurrentRateError",function(){r=null,t.emit("canNotComputeSoftPrices")}),e.on("bakHardToSoftCurrentRateError",function(){l=null,t.emit("canNotComputeHardPrices")})}var s=i(188).EventEmitter,a=i(183),r=null,l=null,t=e.exports=new s,c=29e4;t.initialize=function(){o()},t.isRateAvailable=function(){return null!==r&&null!==l},t.computeHardPrice=function(e){return l||0===l?Math.ceil(e/l):null},t.computeSoftPrice=function(e){return r||0===r?Math.ceil(e*r):null}},function(e,t,i){function n(){s.call(this,"div",{className:"progressGauge"}),this.gaugeBg=this.createChild("div",{className:"gaugeBg"}),this.gaugeMask=this.createChild("div",{className:"gaugeMask"}),this.gaugeFill=this.gaugeMask.createChild("div",{className:"gaugeFill"}),this._resetAnimInfo(),this._initEvents()}i(715);var o=i(172).inherits,s=i(321),a=i(166).dimensions,r=i(339),l=i(29).getText,c=i(176),d={PLAYER_EXPERIENCE:"playerExperience",GUILD_EXPERIENCE:"guildExperience",MOUNT_EXPERIENCE:"mountExperience",INVENTORY_PODS:"inventoryPods",FIGHT_TIMER:"fightTimer"},u="-progressBarPref";o(n,s),e.exports=n,n.prototype._initEvents=function(){var e=this,t=window.dofus.connectionManager,i=window.gui,n=i.playerData;i.on("resize",function(){e._resize()}),n.on("characterSelectedSuccess",function(){var t=c.getValue(n.id+u,d.PLAYER_EXPERIENCE);t&&(e.defaultMode=t,e._setMode(e.defaultMode),e._setPercentage(0))}),i.on("CharacterStatsListMessage",function(t){var i=t.stats;e.playerPercentage=e._convertXpToPercentage(i.experience,i.experienceLevelFloor,i.experienceNextLevelFloor),e.gaugeMode===d.PLAYER_EXPERIENCE&&e._setPercentage(e.playerPercentage)}),t.on("GuildInformationsGeneralMessage",function(t){e.guildPercentage=e._convertXpToPercentage(t.experience,t.expLevelFloor,t.expNextLevelFloor),e.gaugeMode===d.GUILD_EXPERIENCE&&e._setPercentage(e.guildPercentage)}),t.on("MountSetMessage",function(t){var i=t.mountData;e.mountPercentage=e._convertXpToPercentage(i.experience,i.experienceForLevel,i.experienceForNextLevel),e.gaugeMode===d.MOUNT_EXPERIENCE&&e._setPercentage(e.mountPercentage)}),n.jobs.on("jobExperienceUpdate",function(t){e["job"+t.jobId+"Percentage"]=t.percentage,e.gaugeMode==="job"+t.jobId&&e._setPercentage(e["job"+t.jobId+"Percentage"])}),n.inventory.on("weightUpdated",function(){e.gaugeMode===d.INVENTORY_PODS&&e._updateGaugeWithInventoryPods()}),i.fightManager.on("fightEnterPreparation",function(t){t.isSpectator||e._setMode(d.FIGHT_TIMER,{duration:t.timeMaxBeforeFightStart})}),i.fightManager.on("fightEnterBattle",function(){n.isSpectator||(e.gaugeMode!==d.FIGHT_TIMER&&e._setMode(d.FIGHT_TIMER),e._pauseAnimation())}),i.timeline.on("setTurnOf",function(t,i){if(e.gaugeMode===d.FIGHT_TIMER){var o=n.characters.controlledCharacterId;t.id===o?e._animate(i):(e._setStatic(),e._setPercentage(0))}}),i.fightManager.on("fightEnd",function(){e._setMode(e.defaultMode)})},n.prototype._updateGaugeWithInventoryPods=function(){var e=window.gui.playerData.inventory;this._setPercentage(Math.round(e.weight/e.maxWeight*100))},n.prototype._setMode=function(e,t){var i=t&&"number"==typeof t.duration?t.duration:null,n=t&&"number"==typeof t.percentage?t.percentage:0;this.gaugeMode=e;var o=null;e.indexOf("job")!==-1&&(o=parseInt(e.split("job")[1],10),e="job");var s;switch(e){case d.FIGHT_TIMER:s="fightTimer",null!==i?this._animate(i,n):(this._setStatic(),this._setPercentage(n));break;case d.GUILD_EXPERIENCE:s="guildXp",this._setStatic(),this._setPercentage(this.guildPercentage);break;case d.MOUNT_EXPERIENCE:s="mountXp",this._setStatic(),this._setPercentage(this.mountPercentage);break;case d.INVENTORY_PODS:s="inventoryPods",this._setStatic(),this._updateGaugeWithInventoryPods();break;case"job":s="jobXp",this._setStatic(),this._setPercentage(this["job"+o+"Percentage"]);break;case d.PLAYER_EXPERIENCE:default:s="playerXp",this._setStatic(),this._setPercentage(this.playerPercentage)}this.setClassNames(["progressGauge",s])},n.prototype._resetAnimInfo=function(){this.animationInfo={startTime:0,duration:0,startFrom:0}},n.prototype._setStatic=function(){this.gaugeFill.setStyles({webkitAnimation:"initial",webkitAnimationPlayState:"initial"}),this._resetAnimInfo()},n.prototype._setPercentage=function(e){e||(e=0),e=Math.max(0,Math.min(100,e)),this.gaugeFill.setStyle("webkitTransform","translate3d(-"+(100-e)/2+"%,0,0) scaleX("+e/100+")")},n.prototype._convertXpToPercentage=function(e,t,i){return(e-t)/(i-t)*100},n.prototype._animate=function(e,t){if(this.gaugeMode!==d.FIGHT_TIMER)return console.error(new Error("ProgressGauge._animate: ProgressGauge is not in timer mode"));t=t||0,t=Math.max(0,Math.min(100,t));var i=e/100*t;this._setStatic(),this._setPercentage(100),r.forceReflow(this.gaugeFill),this.animationInfo={startTime:Date.now(),duration:e,startFrom:t},this.gaugeFill.setStyles({webkitAnimation:"progressGaugeAnimation "+e+"ms linear -"+i+"ms",webkitAnimationPlayState:"running"})},n.prototype._pauseAnimation=function(){return this.gaugeMode!==d.FIGHT_TIMER?console.error(new Error("ProgressGauge._pauseAnimation: ProgressGauge is not in timer mode")):void this.gaugeFill.setStyle("webkitAnimationPlayState","paused")},n.prototype._resize=function(){window.gui.ipadRatio?this.setStyle("width","100%"):this.setStyle("width",a.shortcutBarSize-9+"px");var e=this.animationInfo;if(this.gaugeMode===d.FIGHT_TIMER&&0!==e.startTime){var t=Date.now()-e.startTime;if(t<e.duration){var i=t/e.duration*(100-e.startFrom),n=e.startFrom+i;this._animate(e.duration-t,n)}}},n.prototype.openPrefMenu=function(){function e(){i.defaultMode=this.value,i._setMode(i.defaultMode),c.setValue(window.gui.playerData.id+u,i.defaultMode)}function t(t,o){n.push({caption:t,value:o,cb:e,ticked:i.defaultMode===o})}var i=this,n=[];t(l("ui.banner.xpCharacter"),"playerExperience"),t(l("ui.common.weight"),"inventoryPods"),window.gui.playerData.guild.current&&t(l("ui.banner.xpGuild"),"guildExperience"),window.gui.playerData.equippedMount&&t(l("ui.banner.xpMount"),"mountExperience");for(var o in window.gui.playerData.jobs.list){var s=window.gui.playerData.jobs.list[o];t(l("ui.common.xp")+" "+s.info.nameId,"job"+s.id)}window.gui.openContextualMenu("generic",{title:l("ui.banner.customGauge"),actions:n})}},function(e,t){},function(e,t,i){function n(){a.call(this,{scaleOnPress:!0,className:"RewardsIndicator",hidden:!0},function(){r["switch"]("rewardsPending")});var e=this;window.gui.on("disconnect",function(){e.hide()}),window.gui.on("resize",function(){e._initPosition()}),this.on("show",function(){c("NEW_REWARD")})}i(717);var o=i(172).inherits,s=i(321),a=i(335),r=i(194),l=i(166).dimensions,c=i(247).playUiSound;o(n,s),e.exports=n,n.prototype._initPosition=function(){this.setStyle("left",l.mapLeft+l.mapWidth/2-32+"px"),this.setStyle("top",l.mapBottom-64+"px")}},function(e,t){},function(e,t,i){function n(){s.call(this);var e=this,t=window.gui;this._isActive=!1,this._activePictoMap={},t.once("initialized",function(){var i=window.gui.gameGuiContainer;e._pingBtn=i.appendChild(new r),e._pingBox=i.appendChild(new l),e._emoteBox=i.appendChild(new c),e._setupEvents(t),e._emoteBox.refreshPosition(),e._emoteBox.hide()}),t.on("disconnect",function(){e._reset(),e._resetPicto()}),t.fightManager.on("fightStart",function(){e._pingBtn.enterFightState()}),t.fightManager.on("fightEnd",function(){e._pingBtn.enterRolePlayState()})}var o=i(172).inherits,s=i(188).EventEmitter,a=i(198).position,r=i(719),l=i(722),c=i(725),d=4e3;o(n,s),e.exports=n,n.prototype.PING_CELL_COLOR={r:240,g:160,b:65,a:.75},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=this._pingBtn,n=this._pingBox;t.on("GameFightEndMessage",function(){e._reset(),e._resetPicto()}),i.on("selected",function(){t.playerData.isFighting&&(e._isActive=!0)}),i.on("unselected",function(){t.playerData.isFighting&&(e._isActive=!1,e._pingBox.close())}),i.on("emoteBtnTap",function(){if(e._emoteBox.isOpen)e._emoteBox.hide();else{if(t.playerData.isFighting)return;e._emoteBox.show(),e._emoteBox.refreshPosition()}}),n.on("actionSent",function(){e._reset()})},n.prototype.cancelPingBox=function(){this._pingBox.close()},n.prototype.openPingBox=function(e,t){this._pingBox.open(a.x,a.y,e,t)},n.prototype.isPingBoxOpen=function(){return this._pingBox.isOpen()},n.prototype.addPingPicto=function(e,t){function i(e){return window.setTimeout(function(){window.isoEngine.mapRenderer.removePingPicto(e),delete n._activePictoMap[e]},d)}if(window.gui.playerData.isFighting&&e!==-1){var n=this,o=t+"-cellId"+e;if(this._activePictoMap[o])return window.clearTimeout(this._activePictoMap[o]),void(this._activePictoMap[o]=i(o));window.isoEngine.mapRenderer.addPingPictoOnCell(o,e,t),this._activePictoMap[o]=i(o)}},n.prototype._removePingPicto=function(){for(var e in this._activePictoMap)this._activePictoMap.hasOwnProperty(e)&&(window.clearTimeout(this._activePictoMap[e]),window.isoEngine.mapRenderer.removePingPicto(e),delete this._activePictoMap[e])},n.prototype._reset=function(){this._isActive=!1,this._pingBtn&&(this._pingBtn.unselect(),this._pingBox.close())},n.prototype._resetPicto=function(){this._removePingPicto(),this._activePictoMap={}},n.prototype.isActive=function(){return this._isActive},n.prototype.getChatIcons=function(){return this._emoteBox.getChatIcons()}},function(e,t,i){function n(){s.call(this,"div",{className:"PingBtn"});var e=this;this._isActivated=!1;var t=this.createChild("div",{className:"borderBox"});this._pingBtn=t.appendChild(new o({className:"pingBtn",scaleOnPress:!0,tooltip:a("tablet.pingsystem.pingsystem"),hidden:!0},function(){window.gui.playerData.isFighting&&(e._isActivated?e.unselect():e.select())})),this._emoteBtn=t.appendChild(new o({className:"emoteBtn",tooltip:a("tablet.common.emotesAndSmilies")},function(){window.gui.playerData.isFighting||(e.unselect(),e.emit("emoteBtnTap"))})),this._setupEvents(),this._resize(),this.exclusiveSelector=d("shortcutSlots"),this.exclusiveSelector.register(this)}i(720);var o=i(335),s=i(321),a=i(29).getText,r=i(172).inherits,l=i(166).dimensions,c=i(167),d=i(721).getExclusiveSelectorByGroup;r(n,s),e.exports=n,n.prototype._setupEvents=function(){var e=this,t=window.gui;t.on("resize",function(){e._resize()})},n.prototype._resize=function(){var e=l.pingEmoteBtnSize;window.gui.ipadRatio?this.setStyles({top:"",right:"",left:l.posPingEmoteBtn+"px",bottom:"0",width:e+"px",height:l.bottomBarHeight+"px"}):this.setStyles({bottom:"",left:"",right:"0",top:l.posPingEmoteBtn+"px",width:c.PING_EMOTE_BTN_WIDE_MIN_WIDTH+"px",height:e+"px"})},n.prototype.select=function(){this._pingBtn.addClassNames("on"),this._isActivated=!0,this.emit("selected")},n.prototype.unselect=function(){this._pingBtn.delClassNames("on"),this._isActivated=!1,this.emit("unselected")},n.prototype.enterFightState=function(){this._pingBtn.show(),this._emoteBtn.hide(),this._resize()},n.prototype.enterRolePlayState=function(){this._emoteBtn.show(),this._pingBtn.hide(),this._resize()}},function(e,t){},function(e,t,i){function n(){s.call(this),this._currentSelection=null;var e=this;this._onSelected=function(){e._selectionChanged(this,!0)},this._onUnselected=function(){e._selectionChanged(this,!1)}}var o=i(172),s=i(175),a={};o.inherits(n,s),t.ExclusiveSelector=n,n.prototype.register=function(e){return"function"!=typeof e.unselect?console.error(new Error("ExclusiveSelector.register: target does not have an unselect method")):(e.on("selected",this._onSelected),void e.on("unselected",this._onUnselected))},n.prototype.unregister=function(e){e.removeListener("selected",this._onSelected),e.removeListener("unselected",this._onUnselected)},n.prototype._selectionChanged=function(e,t){if(t){if(this._currentSelection){if(e===this._currentSelection)return;this._currentSelection.unselect()}this._currentSelection=e}else e===this._currentSelection&&(this._currentSelection=null);this.emit("selectionChanged",this._currentSelection)},t.getExclusiveSelectorByGroup=function(e){if(e||(e="default"),e in a)return a[e];var t=new n;return a[e]=t,t}},function(e,t,i){function n(){function e(e){e.toggleDisplay(!0)}function t(e,t){e.toggleDisplay(t.isEmptyCell)}function i(e,t){e.toggleDisplay(!t.isEmptyCell)}a.call(this,"div",{className:"PingBox",hidden:!0});var n=this,s=window.gui,l="pingBoxShowBoxId",d=s.pingSystem.PING_CELL_COLOR;this._MESSAGE_CHANNEL=c.CHANNEL_TEAM,this._position={x:0,y:0},this._isOpen=!1,this._cellId=-1,this._talks=[],this._actions=[];var u=this.createChild("div",{className:"tabPanel"}),h=this.createChild("div",{className:"containers"});u.appendChild(new o({className:["pingTalk","tab"],scaleOnPress:!0},function(){g.hide(),f.hide(),h.getChildren()[0]!==m&&h.insertAsFirstChild(m),m.show(),n.reposition()})),u.appendChild(new o({className:["pingSentence","tab"],scaleOnPress:!0},function(){m.hide(),g.hide(),h.getChildren()[0]!==f&&h.insertAsFirstChild(f),f.show(),n.reposition()})),u.appendChild(new o({className:["pingAction","tab"],scaleOnPress:!0},function(){m.hide(),f.hide(),h.getChildren()[0]!==g&&h.insertAsFirstChild(g),g.show(),n.reposition()}));var m=this._talkContainer=h.createChild("div",{className:["container","talkContainer"]}),f=this._sentenceContainer=h.createChild("div",{className:["container","sentenceContainer"]}),g=this._actionContainer=h.createChild("div",{className:["container","actionContainer"]});m.hide(),g.hide(),f.hide(),this._addSmileys(),this._addSentence(r("tablet.pingsystem.hello"),p.hello,e),this._addSentence(r("tablet.pingsystem.thx"),p.thx,e),this._addSentence(r("tablet.pingsystem.great"),p.great,e),this._addSentence(r("tablet.pingsystem.goodJob"),p.goodJob,e),this._addSentence(r("tablet.pingsystem.yes"),p.yes,e),this._addSentence(r("tablet.pingsystem.no"),p.no,e),this._addSentence(r("tablet.pingsystem.ready"),p.ready,e),this._addSentence(r("tablet.pingsystem.tooFar"),p.tooFar,e),this._addSentence(r("tablet.pingsystem.outSight"),p.outSight,e),this._addSentence(r("tablet.pingsystem.comeCloser"),p.comeCloser,e),this._addSentence(r("tablet.pingsystem.retreat"),p.retreat,e),this._addSentence(r("tablet.pingsystem.challenge"),p.lightBulb,e),this._addAction(r("tablet.pingsystem.mp"),"mp",t),this._addAction(r("tablet.pingsystem.warning"),"warning",t),this._addAction(r("tablet.pingsystem.stop"),"stop",t),this._addAction(r("tablet.pingsystem.attack"),"attack",i),this._addAction(r("tablet.pingsystem.move"),"move",i),this._addAction(r("tablet.pingsystem.heal"),"heal",i),this._addAction(r("tablet.pingsystem.boost"),"boost",i),this._addAction(r("tablet.pingsystem.tackle"),"tackle",i),this._addAction(r("tablet.pingsystem.valid"),"valid",i),this.on("show",function(){window.isoEngine.mapRenderer.addCellHighlight(l,[this._cellId],d)}),this.on("hide",function(){window.isoEngine.mapRenderer.deleteCellHighlight(l)}),s.on("disconnect",function(){n.close()})}i(723);var o=i(335),s=i(607),a=i(321),r=i(29).getText,l=i(172).inherits,c=i(366),d=i(196),u=i(334).getElementPositionCenteredAt,h=i(166).dimensions,p=i(724),m=i(182),f=i(197);l(n,a),e.exports=n,n.prototype._addSmileys=function(){function e(e,i){function n(){window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:o.id}),t.emit("actionSent"),t._talkContainer.hide()}var o=new a("div",{name:e.id,className:["chatIcon","smileyIcon"]});o.id=e.id,o.setStyle("backgroundImage",i),f(o),o.on("tap",n),t._talkContainer.appendChild(o)}var t=this;t._talkContainer.addClassNames("spinner");for(var i=window.gui.databases.Smileys,n=Object.keys(i),o=[],s=0;s<n.length;s++)o.push("gfx/smilies/"+i[n[s]].gfxId+".png");
m.preloadImages(o,function(o){for(var s=0;s<o.length;s++)e(i[n[s]],o[s]);t._talkContainer.delClassNames("spinner")})},n.prototype._addSentence=function(e,t,i,n){n=n||e;var o=this,a=window.gui.databases.Smileys[t];a||(a={},console.warn("PingBox: Smiley "+t+" details are not available, it could not be displayed"));var r=this._sentenceContainer.createChild("div",{className:"pingRow"});f(r,null),r.on("tap",function(){window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:t}),s.sendMessage(e,o._MESSAGE_CHANNEL),o.emit("actionSent")});var l=r.createChild("div",{className:"smiley"});m.preloadImage("gfx/smilies/"+a.gfxId+".png",function(e){l.setStyle("backgroundImage",e)}),r.createChild("div",{text:e,className:"label"}),r.displayFn=i,this._talks.push(r)},n.prototype._addAction=function(e,t,i,n){var o=this;n=n||e;var a=this._actionContainer.createChild("div",{className:"pingRow"});f(a,null),a.on("tap",function(){var i="{pingsystem,"+o._cellId+","+t+"::["+e+"]}";s.sendMessage(i,o._MESSAGE_CHANNEL),o.emit("actionSent")});var r=a.createChild("div",{className:"iconBox"});r.createChild("div",{className:["icon",t]}),a.createChild("div",{text:e,className:"label"}),a.displayFn=i,this._actions.push(a)},n.prototype._filterActionsMenu=function(e){e=e||{};var t,i,n=this._talks,o=this._actions;for(t=0,i=n.length;t<i;t+=1){var s=n[t];s.displayFn(s,e)}for(t=0,i=o.length;t<i;t+=1){var a=o[t];a.displayFn(a,e)}},n.prototype.isOpen=function(){return this._isOpen},n.prototype.reposition=function(){var e=10,t=this.rootElement.getBoundingClientRect(),i=t.left,n=t.left+t.width,o=t.top,s=t.top+t.height;i<e&&(i=e),n>h.screenWidth-e&&(i=h.screenWidth-e-t.width),o<e&&(o=e),s>h.screenHeight-e&&(o=h.screenHeight-e-t.height),i===t.left&&o===t.top||d.tween(this,{webkitTransform:"scale(1) translate3d("+Math.round(i)+"px, "+Math.round(o)+"px, 0)"},{time:100,easing:"linear"})},n.prototype.open=function(e,t,i,n){var o=window.foreground;this._cellId=i,o.confirmBox.close(),o.deselectSpell(),window.gui.shortcutBar.deselectCurrentSlot(),this._filterActionsMenu({isEmptyCell:n}),this.show();var s=this._position=u(this,e,t);this._isOpen?this.setStyles({webkitTransformOrigin:e+"px "+t+"px"}):this.setStyles({webkitTransform:"scale(0) translate3d("+s.x+"px, "+s.y+"px, 0)",webkitTransformOrigin:e+"px "+t+"px"}),d.tween(this,{webkitTransform:"scale(1) translate3d("+s.x+"px, "+s.y+"px, 0)"},{time:100,easing:"linear"}),this._isOpen=!0},n.prototype.close=function(){var e=this,t=this._position;this._isOpen&&(this._isOpen=!1,this._cellId=-1,d.tween(this,{webkitTransform:"scale(0) translate3d("+t.x+"px,"+t.y+"px,0)"},{time:100,easing:"linear"},function(){e.hide(),e._sentenceContainer.hide(),e._actionContainer.hide(),e._talkContainer.hide()}))}},function(e,t){},function(e,t){e.exports={hello:1,ready:4,great:7,thx:8,goodJob:10,outSight:26,comeCloser:43,tooFar:44,retreat:63,lightBulb:80,yes:88,no:89}},function(e,t,i){function n(){s.call(this,"div",{className:"EmoteBox"}),this._chatIcons=new o,this.appendChild(this._chatIcons);var e=this;this._chatIcons.on("closing",function(){e.hide()}),this.isOpen=!1,this._emoteBoxSize=85,this._time=200,this._delay=0,this._easing="ease-out"}i(726);var o=i(727),s=i(321),a=i(172).inherits,r=i(166).dimensions,l=i(167),c=i(196);a(n,s),e.exports=n,n.prototype.refreshPosition=function(){window.gui.ipadRatio?(this._chatIcons.setPanelsStyle("right","auto"),this._chatIcons.setPanelsStyle("left",r.pingEmoteBtnSize+"px"),this._chatIcons.setPanelsStyle("bottom",this._emoteBoxSize+"px"),this.setStyle("left",l.CHAT_BTN_MIN_WIDTH+"px"),this.setStyle("width",r.pingEmoteBtnSize+"px"),this.setStyle("height",this._emoteBoxSize+"px"),this.setStyle("bottom",r.bottomBarHeight+"px"),this.setStyle("line-height","inherit")):(this._chatIcons.setPanelsStyle("left","auto"),this._chatIcons.setPanelsStyle("right",this._emoteBoxSize+"px"),this._chatIcons.setPanelsStyle("bottom",r.pingEmoteBtnSize+"px"),this.setStyle("left",r.mapRight-this._emoteBoxSize+"px"),this.setStyle("width",this._emoteBoxSize+"px"),this.setStyle("height",r.pingEmoteBtnSize+"px"),this.setStyle("bottom","0px"),this.setStyle("line-height",r.pingEmoteBtnSize+"px"))},n.prototype.getChatIcons=function(){return this._chatIcons},n.prototype.show=function(){var e=this;e.setStyle("visibility","visible"),c.tween(this,{webkitTransform:"translate3d(0, 0, 0)"},{time:this._time,delay:this._delay,easing:this._easing},function(){e.isOpen=!0})},n.prototype.hide=function(){var e=this;window.gui.ipadRatio?c.tween(this,{webkitTransform:"translate3d(0, "+this._emoteBoxSize+"px, 0)"},{time:this._time,delay:this._delay,easing:this._easing},function(){e.setStyle("visibility","collapse"),e.isOpen=!1}):c.tween(this,{webkitTransform:"translate3d("+this._emoteBoxSize+"px, 0, 0)"},{time:this._time,delay:this._delay,easing:this._easing},function(){e.setStyle("visibility","collapse"),e.isOpen=!1})}},function(e,t){},function(e,t,i){function n(){var e=this;r.call(this,"div",{className:"ChatIcons"}),this.openPanel=null;var t=this.createChild("div",{className:"buttons"});this.smileysButton=t.createChild("div",{className:"smileysButton",tooltip:s("ui.chat.smilies")}),this.attitudesButton=t.createChild("div",{className:"attitudesButton",tooltip:s("ui.common.emotes")}),o(this.smileysButton,s("ui.chat.smilies")),o(this.attitudesButton,s("ui.common.emotes"));var i=this.createChild("div");this.smileysPanel=i.createChild("div",{className:"smileysPanel"}),this.attitudesPanel=i.createChild("div",{className:"attitudesPanel"}),this.smileysPanel.hide(),this.attitudesPanel.hide(),this.smileysButton.on("tap",function(){u.hide(),"smileys"===e.openPanel?e.closePanels():(e.openSmileys(),e.emit("activated"))}),this.attitudesButton.on("tap",function(){u.hide(),"attitudes"===e.openPanel?e.closePanels():(e.openAttitudes(),e.emit("activated"))}),u.on("show",function(){"smileys"!==e.openPanel&&"attitudes"!==e.openPanel||e.closePanels()}),this.once("open",this.loadIcons),this.attitudeList={},this.currentMood=null,this.previousMood=-1,this.setMessageHandlers()}i(728);var o=i(337).addTooltip,s=i(29).getText,a=i(172).inherits,r=i(321),l=i(197),c=i(182),d=i(334).getElementPositionAround,u=i(435),h=i(317),p=i(692);a(n,r),e.exports=n,n.prototype.setMessageHandlers=function(){var e=this,t=window.gui;t.on("MoodSmileyResultMessage",function(i){var n=i.resultCode;return n===p.MOOD_ERROR_UNKNOWN?(e.setCurrentMood(e.previousMood),t.openSimplePopup(s("ui.smiley.errorMood"))):n===p.MOOD_ERROR_FLOOD?(e.setCurrentMood(e.previousMood),t.openSimplePopup(s("ui.smiley.errorFloodMood"))):(e.setCurrentMood(i.smileyId),void(e.previousMood=i.smileyId))}),t.on("disconnect",function(){e.setCurrentMood(-1),e.previousMood=-1})},n.prototype.bindToPlayerEmoteData=function(){var e=this,t=window.gui.playerData.emoteData;t.on("emoteAdded",function(t){c.preloadImage("gfx/emotes/"+t.id+".png",function(i){e.addAttitudeIcon(t,i)})}),t.on("emoteRemoved",function(t){e.removeAttitudeIcon(t)}),t.on("emoteListUpdated",function(t){e.loadEmotes(t)})},n.prototype.loadIcons=function(){var e=this;this.loadEmotes(window.gui.playerData.emoteData.list),this.smileysPanel.addClassNames("spinner");for(var t=window.gui.databases.Smileys,i=Object.keys(t),n=[],o=0;o<i.length;o++)n.push("gfx/smilies/"+t[i[o]].gfxId+".png");c.preloadImages(n,function(n){for(var o=0;o<n.length;o++)e.addSmileyIcon(t[i[o]],n[o]);e.smileysPanel.delClassNames("spinner")}),this.bindToPlayerEmoteData()},n.prototype.loadEmotes=function(e){var t=this;this.attitudesPanel.clearContent(),this.attitudeList={},this.attitudesPanel.addClassNames("spinner");var i=Object.keys(e);i=i.map(function(e){return parseInt(e,10)}),i=i.sort(function(e,t){return e-t});for(var n=[],o=0;o<i.length;o++)n.push("gfx/emotes/"+i[o]+".png");c.preloadImages(n,function(n){for(var o=0;o<n.length;o++)t.addAttitudeIcon(e[i[o]],n[o]);t.attitudesPanel.delClassNames("spinner")})},n.prototype._addDraggableBehaviourTo=function(e,t,i){var n={prepareForDrag:function(t,i){return i.setStyle("backgroundImage",e.getStyle("backgroundImage")),e.once("dragEnd",function(){i.setStyle("backgroundImage",null)}),!0}},o={id:i},s={dragOnTouchstart:!1,dragElement:!1,noHover:!1};h.setDraggable(e,n,t,o,s)},n.prototype.addAttitudeIcon=function(e,t){function i(){window.dofus.sendMessage("EmotePlayRequestMessage",{emoteId:this.id}),n.closePanels()}var n=this,o=this.attitudesPanel.createChild("div",{className:["chatIcon","attitudeIcon"]});o.id=e.id,o.setStyle("backgroundImage",t),this.attitudeList[e.id]=o,this._addDraggableBehaviourTo(o,"attitude",o.id),l(o),o.on("tap",i)},n.prototype.removeAttitudeIcon=function(e){var t=this.attitudeList[e];t&&(t.destroy(),delete this.attitudeList[e])},n.prototype.setCurrentMood=function(e){var t=this.smileysPanel.getChild(e);this.currentMood!==t&&(this.currentMood&&this.currentMood.delClassNames("mood"),t&&t.addClassNames("mood"),this.currentMood=t)},n.prototype.addSmileyIcon=function(e,t){function i(){window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:this.id}),o.closePanels()}function n(){var e=o.currentMood===this?-1:this.id;o.setCurrentMood(e),window.dofus.sendMessage("MoodSmileyRequestMessage",{smileyId:e})}if(e.forPlayers){var o=this,s=new r("div",{name:e.id,className:["chatIcon","smileyIcon"]});s.id=e.id,s.setStyle("backgroundImage",t),l(s),s.on("tap",i),s.on("longtap",n),this.smileysPanel.appendChild(s),this._addDraggableBehaviourTo(s,"smiley",s.id)}},n.prototype.openSmileys=function(){this.emit("open"),this.attitudesPanel.hide(),this.smileysPanel.show(),this.openPanel="smileys"},n.prototype.openAttitudes=function(){this.emit("open"),this.smileysPanel.hide(),this.attitudesPanel.show(),this.openPanel="attitudes"},n.prototype.closePanels=function(){this.emit("closing"),this.smileysPanel.hide(),this.attitudesPanel.hide(),this.openPanel=null},n.prototype.setPanelsStyle=function(e,t){this.smileysPanel.setStyle(e,t),this.attitudesPanel.setStyle(e,t)},n.prototype.positionPanel=function(){function e(e,t){var i=d(e,t);e.setStyles({left:i.x+"px",top:i.y+"px"})}e(this.smileysPanel,this.smileysButton),e(this.attitudesPanel,this.attitudesButton)}},function(e,t){},function(e,t,i){function n(){s.call(this);var e=this,t=window.gui;this._characterList=[],this._charaListMinusDeadPeople=[],this._giftList=[],this._assigningGifts={},t.once("initialized",function(){e._setupEvents()}),t.on("disconnect",function(){e._reset()})}var o=i(172).inherits,s=i(188).EventEmitter,a=i(461),r=i(194),l=i(601),c=i(29).getText;o(n,s),e.exports=n,n.prototype._setupEvents=function(){function e(e){e.length&&(r.getWindow("giftSelection").openState||i||t._reset(),i=!0,t.setCharacterList(l.getCharacterList()),t._createGiftList(e,function(e){return e?console.error(new Error("Gifts module: "+e)):t._giftList.length?void(t.getCharaListMinusDeadPeople().length&&(r.open("giftSelection",t._giftList),i=!1)):console.error(new Error("Gifts module: _giftList is empty"))}))}var t=this,i=!1;window.dofus.connectionManager.on("StartupActionsListMessage",function(t){e(t.actions)}),window.dofus.connectionManager.on("StartupActionAddMessage",function(t){e([t.newAction])}),window.dofus.connectionManager.on("StartupActionFinishedMessage",function(e){e.success||window.gui.openSimplePopup(c("tablet.gift.unableToAssign"),c("tablet.gift.unableToAssignTitle")),t._assigningGifts[e.actionId]?t._assigningGifts[e.actionId]=!1:(t._assigningGifts[e.actionId]=e.success,t.emit("giftAssignRequestResult",e))})},n.prototype._createGiftList=function(e,t){for(var i=this,n=[],o=0,s=e.length;o<s;o+=1)for(var r=e[o],l=r.items,c=0,d=l.length;c<d;c+=1){var u=l[c];u&&n.push(u)}a.createItemInstances(n,function(n,o){if(n)return t(n);for(var s=0,a=0,r=e.length;a<r;a+=1){for(var l=e[a],c=[],d=l.items,u=0,h=d.length;u<h;u+=1){var p=o.array[s]||null;s+=1,p&&c.push(p)}c.length&&i._giftList.push({uid:l.uid,title:l.title,text:l.text,items:c})}t()})},n.prototype._reset=function(){this._characterList=[],this._charaListMinusDeadPeople=[],this._giftList=[],this._assigningGifts={}},n.prototype.getCharacterList=function(){return this._characterList},n.prototype.getCharaListMinusDeadPeople=function(){return this._charaListMinusDeadPeople},n.prototype.setCharacterList=function(e){this._characterList=e,this._charaListMinusDeadPeople=[];for(var t=0,i=e.length;t<i;t+=1){var n=e[t];n.deathState&&0!==n.deathState||this._charaListMinusDeadPeople.push(n)}},n.prototype.assignGift=function(e,t){window.dofus.sendMessage("StartupActionsObjetAttributionMessage",{actionId:e,characterId:t})}},function(e,t,i){function n(){this._panels=null,this._currentPanelType=null,this._selectedSlot=null,this._panelLoadingCb={},this._currentCharacterId=null,this.isOrganizing=!1,g.call(this,{backDrawerSize:c.SHORTCUT_GAUGE_SIZE}),this._createDom(),this._setupEvents(),this.openPanel("spell")}function o(e,t){for(var i=0;i<e.length;i++){var n=e[i];n.enableContextMenu(t)}}function s(e,t){var i=e.getShortcutHash(),n=t[i];if(n){if(n.indexOf(e)!==-1)return}else n=t[i]=[];e.exclusiveSelector=A("shortcutSlots"),e.exclusiveSelector.register(e),n.push(e)}function a(e,t){var i=e.getShortcutHash(),n=t[i];if(n){var o=n.indexOf(e);o!==-1&&n.splice(o,1)}e.exclusiveSelector&&(e.exclusiveSelector.unregister(e),delete e.exclusiveSelector)}i(731);var r=i(732),l=i(335),c=i(167),d=i(166).dimensions,u=i(339),h=i(317),p=i(171),m=i(29).getText,f=i(172).inherits,g=i(656),_=i(733),v=i(563),y=i(412),b=i(337),M=i(196),w=i(321),T=i(202),C=i(247).playUiSound,A=i(721).getExclusiveSelectorByGroup,I=i(735),S=i(736),E=i(742),x=i(258),N={};N[r.GENERAL_SHORTCUT_BAR]="item",N[r.SPELL_SHORTCUT_BAR]="spell";var L={item:r.GENERAL_SHORTCUT_BAR,spell:r.SPELL_SHORTCUT_BAR},O=c.SHORTCUT_ICON_SIZE,D=30,R=3;f(n,g),e.exports=n,n.prototype._createDom=function(){function e(e){t._pagination.setCurrent(e)}var t=this;this.addClassNames("ShortcutBar"),this._panelBox=this.content.createChild("div",{className:"panelBox"}),this._panels={spell:this._panelBox.appendChild(this._createPanel("spell")),item:this._panelBox.appendChild(this._createPanel("item"))},this._buttonBox=this.content.createChild("div",{className:"buttonBox"}),this.spellBtn=this._buttonBox.appendChild(new l({className:"spellBtn",tooltip:m("ui.charcrea.spells"),sound:"BANNER_SPELL_TAB"},function(){t.openPanel("spell")})),this.itemBtn=this._buttonBox.appendChild(new l({className:"itemBtn",tooltip:m("ui.common.objects"),sound:"BANNER_SPELL_TAB"},function(){t.openPanel("item")})),this._pagination=this._buttonBox.appendChild(new _({disableInput:!0,soundPrev:"SCROLL_DOWN",soundNext:"SCROLL_UP"})),this._pagination.setPageCount(R),this._pagination.setCurrent(0),this._pagination.on("next",function(){t._panels[t._currentPanelType].openTab(this.current+1)}),this._pagination.on("previous",function(){t._panels[t._currentPanelType].openTab(this.current-1)}),this._panels.spell.on("openTab",e),this._panels.item.on("openTab",e),this._organizeBtn=this._buttonBox.appendChild(new l({className:"lockBtn",scaleOnPress:!0},function(){t._setOrganizeMode(!t.isOrganizing)})),this._trashZone=this.createChild("div",{className:"trashZone"}),this._trashZone.createChild("div",{className:"trashBin",text:m("ui.common.remove")}),h.setDroppable(this._trashZone,["shortcutBar"],{isDropAllowed:function(){return t.isOrganizing}}),this._trashZone.on("drop",function(e){t._removeShortcutFromSlotRequestWith1Animation(e)}),this.on("open",function(){C("WINDOW_OPEN")}),this.on("close",function(){C("WINDOW_CLOSE"),this.isOrganizing&&this._setOrganizeMode(!1)})},n.prototype._createPanel=function(e){var t=new v({noHeader:!0});t.slotList=new Array(D*R),t.slotMap={};for(var i="spell"===e?E:S,n=0;n<R;n++){var o=new w("div",{className:"page"});t.addTab("",o,n);for(var s=0;s<D;s++){var a=n*D+s,r=new i(this,a);t.slotList[a]=r,o.appendChild(r),this._positionSlot(r)}}return t.openTab(0),t},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=t.playerData.characters,n=i.mainCharacter,o=t.playerData.inventory;t.on("disconnect",function(){e.close(),e.delClassNames("dragging"),e._selectedSlot=null,e._emptyPanel("spell"),e._emptyPanel("item"),e._currentCharacterId=null,T.removeAllListeners("ShortcutBarAddErrorMessage"),T.removeAllListeners("ShortcutBarRemoveErrorMessage"),T.removeAllListeners("ShortcutBarSwapErrorMessage")}),T.on("ShortcutBarContentMessage",function(t){for(var n=N[t.barType],o=[],s=0;s<t.shortcuts.length;s++)o.push(new I(t.shortcuts[s]));"spell"===n&&i.getControlledCharacter().setSpellShortcuts(o),e._setPanelContentRequest(n,o)}),T.on("ShortcutBarRefreshMessage",function(t){var n=N[t.barType],o=new I(t.shortcut);e._isSlotIndexValid(o.slotIndex)&&("spell"===n&&i.getControlledCharacter().updateSpellShortcut(o),e._setShortcutClient(o))}),T.on("ShortcutBarRemovedMessage",function(t){var i=N[t.barType];e._removeShortcutClient(i,t.slot)}),i.on("switchControlledCharacter",function(){var t=i.getControlledCharacter();t.spellShortcuts?e._setPanelContentRequest("spell",t.spellShortcuts):e._emptyPanel("spell")}),n.on("weaponChanged",function(){e._currentCharacterId===this.spellData.characterId&&e._updateWeaponSpell()}),o.on("itemsDeleted",this._disableItems.bind(this)),o.on("itemDeleted",this._disableItem.bind(this)),o.on("itemsQuantity",this._updateItemsQuantity.bind(this)),o.on("itemQuantity",this._updateItemQuantity.bind(this)),o.on("itemModified",this._updateModifiedItem.bind(this)),t.fightManager.on("fightEnterPreparation",this._fightPreparation.bind(this)),t.fightManager.on("fightEnterBattle",this._fightEntered.bind(this)),t.fightManager.on("fightEnd",this._fightExited.bind(this)),t.playerData.on("actionPointsCurrentUpdated",this.updateSpellsAvailability.bind(this)),t.fightManager.on("UpdatePreFightersList",this.updateSpellsAvailability.bind(this)),t.fightManager.on("TurnCountUpdated",this.updateSpellsAvailability.bind(this)),t.fightManager.on("updateSpellsAvailability",this.updateSpellsAvailability.bind(this));var s=A("shortcutSlots");s.on("selectionChanged",function(t){t instanceof E||t instanceof S?e._selectedSlot=t:null===t&&(e._selectedSlot=null)})},n.prototype._isSlotIndexValid=function(e){return e<D*R},n.prototype._isShortcutValid=function(e){return e instanceof I&&this._isSlotIndexValid(e.slotIndex)},n.prototype.getSlot=function(e,t){var i=this._panels[e];if(i)return i.slotList[t]},n.prototype._updateItemQuantity=function(e,t){var i=this._panels.item.slotMap["item"+e];if(i)for(var n=0;n<i.length;n++)i[n].setQuantity(t)},n.prototype._updateItemsQuantity=function(e){for(var t in e)this._updateItemQuantity(t,e[t])},n.prototype._disableItem=function(e){var t=this._panels.item.slotMap["item"+e];if(t)for(var i=0;i<t.length;i++){var n=t[i];n.icon.addClassNames("disabled"),n.isDisabled=!0}},n.prototype._disableItems=function(e){for(var t=0;t<e.length;t++)this._disableItem(e[t])},n.prototype._updateModifiedItem=function(e){var t=this._panels.item.slotMap["item"+e.objectUID];if(t)for(var i=0;i<t.length;i++)t[i].refreshShortcut()},n.prototype._updateSpellSlotAvailability=function(e){if("spell"===e.type){var t;if(x.isFightMode&&!e.isEmpty()){var i=e.shortcut.spellId;e.isDisabled=!window.gui.fightManager.canCastThisSpell(i),t=window.gui.fightManager.getSpellCooldown(i)}else e.isDisabled=!1,t=0;e.isDisabled&&this._unSelectSlot(e),e.icon.toggleClassName("disabled",e.isDisabled),e.setCooldown(t)}},n.prototype.updateSpellAvailability=function(e){if(this._currentCharacterId===window.gui.playerData.characters.controlledCharacterId){var t=this._panels.spell.slotMap["spell"+e];if(t)for(var i=0;i<t.length;i++)this._updateSpellSlotAvailability(t[i])}},n.prototype.updateSpellsAvailability=function(){if(this._currentCharacterId===window.gui.playerData.characters.controlledCharacterId)for(var e=this._panels.spell.slotList,t=0;t<e.length;t++){var i=e[t];i.isEmpty()||this._updateSpellSlotAvailability(i)}},n.prototype.setAvailability=function(e){this.overlay?this.overlay.toggleDisplay(!e):this.overlay=this.content.createChild("div",{className:"overlay",hidden:!e}),this.lockDrawer(!e)},n.prototype.computeBestSize=function(e,t){var i;return"narrow"===t?(i=c.ICONBAR_TAB_WIDTH+c.ICONBAR_CORNER_WIDTH,this._iconsVisiblePerLine=~~((e-i)/O),this._iconsVisiblePerLine*O+i):(i=c.ICONBAR_TAB_HEIGHT,this._iconsVisiblePerColumn=~~((e-i)/O),this._iconsVisiblePerColumn*O+i)},n.prototype._setPlaceHolder=function(e,t){for(var i=this._panels[e],n=i.slotList,o=0,s=t.length;o<s;o+=1){var a=t[o];this._isSlotIndexValid(a.slotIndex)&&(n[a.slotIndex].isEmpty()?n[a.slotIndex].setImage(y.placeHolder):console.error(new Error("ShortcutBar._setPlaceHolder: cannot change image of non empty slot")))}},n.prototype._resize=function(){var e,t,i=this._panels.spell,n=this._panels.item;window.gui.ipadRatio?(this.setStyles({top:"",right:"",left:d.posShortcutBar+"px",bottom:"0px",width:d.shortcutBarSize+"px",height:d.bottomBarHeight+"px"}),e=d.shortcutBarSize-75,this._columns=Math.floor(e/O),this._lines=Math.ceil(D/this._columns),t=this._lines*O+8,this.setOpeningSide("top"),i.setSwipeDirection("horizontal"),n.setSwipeDirection("horizontal"),this._trashZone.setStyle("width",e+"px"),this._buttonBox.appendChild(this._organizeBtn),this._buttonBox.appendChild(this._pagination),this._pagination.setDirection("horizontal")):(this.setStyles({bottom:"",left:"",right:"0px",top:d.posShortcutBar+"px",width:d.sideBarWidth+"px",height:d.shortcutBarSize+"px"}),t=d.shortcutBarSize-29,this._lines=Math.floor(t/O),this._columns=Math.ceil(D/this._lines),e=this._columns*O+13+30,this.setOpeningSide("left"),i.setSwipeDirection("vertical"),n.setSwipeDirection("vertical"),this._trashZone.setStyle("height",t+"px"),this._panelBox.appendChild(this._organizeBtn),this._panelBox.appendChild(this._pagination),this._pagination.setDirection("vertical")),this._panelBox.setStyles({width:e+"px",height:t+"px"});for(var o=i.slotList,s=n.slotList,a=0;a<o.length;a++)this._positionSlot(o[a]),this._positionSlot(s[a])},n.prototype._positionSlot=function(e){var t,i,n,o,s=e.slotIndex,a=s%D;window.gui.ipadRatio?(t=a%this._columns,i=Math.floor(a/this._columns),n=t*O,o=i*O):(t=a%this._lines,i=Math.floor(a/this._lines),n=i*O,o=t*O),e.x=n,e.y=o,e.setStyles({left:n+"px",top:o+"px",webkitTransform:""})},n.prototype._enableSlotContextMenus=function(e){o(this._panels.item.slotList,e),o(this._panels.spell.slotList,e)},n.prototype.showTrash=function(){this.addClassNames("dragging")},n.prototype.hideTrash=function(){this.delClassNames("dragging")},n.prototype._setShortcutRequest=function(e){if(!this._isShortcutValid(e))return console.error(new Error("ShortcutBar._setShortcutRequest: invalid shortcut"));var t=this,i=e.getShortcutBarPanelType(),n=this._panels[i],o=e.slotIndex,s=n.slotList[o],a=s.shorcut;this._setShortcutClient(e),T.removeAllListeners("ShortcutBarAddErrorMessage"),T.once("ShortcutBarAddErrorMessage",function(){s.isEmpty()?t._removeShortcutClient(i,o):t._setShortcutClient(a)}),window.dofus.sendMessage("ShortcutBarAddRequestMessage",{barType:L[s.type],shortcut:e.serialize()})},n.prototype._setShortcutClient=function(e){if(!this._isShortcutValid(e))return console.error(new Error("ShortcutBar._setShortcutClient: invalid shortcut"));var t=e.getShortcutBarPanelType(),i=this._panels[t],n=i.slotList[e.slotIndex];n.setStyles({webkitTransform:"scale(1)",opacity:1}),n.getShortcutHash()!==e.getHash()&&(this._selectedSlot===n&&this._unSelectSlot(n),a(n,i.slotMap),n.setShortcut(e),s(n,i.slotMap),b.enableTooltip(n,!n.isEmpty()&&!this.isOrganizing),this.isOrganizing?n.enableDrag():n.disableDrag())},n.prototype._removeShortcutFromSlotRequestWith1Animation=function(e){this._removeShortcutRequest(e.type,e.slotIndex),e.setStyles({webkitTransform:"scale(0)",opacity:1}),u.forceReflow(e),M.tween(e,{webkitTransform:"scale(1)"},{time:100,easing:"ease-out"})},n.prototype._removeShortcutFromSlotRequestWith2Animations=function(e){var t=this;u.forceReflow(e),M.tween(e,{opacity:0},{time:100,easing:"ease-out"},function(){t._removeShortcutFromSlotRequestWith1Animation(e)})},n.prototype._removeShortcutRequest=function(e,t){var i=this,n=this._panels[e],o=n.slotList[t],s=o.shortcut,a=L[o.type];this._removeShortcutClient(e,t),T.removeAllListeners("ShortcutBarRemoveErrorMessage"),T.once("ShortcutBarRemoveErrorMessage",function(){i._setShortcutClient(s)}),window.dofus.sendMessage("ShortcutBarRemoveRequestMessage",{barType:a,slot:t})},n.prototype._removeShortcutClient=function(e,t){if(this._isSlotIndexValid(t)){var i=this._panels[e],n=i.slotList[t];n.isEmpty()||(a(n,i.slotMap),this._selectedSlot===n&&this._unSelectSlot(n),n.unset(),n.disableDrag())}},n.prototype._fightPreparation=function(){this.openPanel("item")},n.prototype._fightEntered=function(){this.openPanel("spell"),this._enableSlotContextMenus(!1),this._setSpellsSlotsDraggability(!0)},n.prototype._fightExited=function(){this.openPanel("item"),this._enableSlotContextMenus(!0),this._setSpellsSlotsDraggability(this.isOrganizing),this._unSelectSlot(this._selectedSlot)},n.prototype.openPanel=function(e){var t="spell"===e?"item":"spell";this._currentPanelType=e;var i=this._panels[e];i.show(),this._panels[t].hide(),this.replaceClassNames([t],[e]),this._pagination.setCurrent(i.currentTab.id)},n.prototype._emptyPanel=function(e){var t=this._panels[e],i=t.slotList;t.slotMap={};for(var n=0;n<i.length;n++){var o=i[n];o.isEmpty()?o.image&&o.setImage():o.unset()}this._cancelPanelLoadingCb(e)},n.prototype._setPanelContent=function(e,t){var i=this,n=window.gui.playerData.characters.getControlledCharacter();this._cancelPanelLoadingCb(e);var o,r,l=i._panels[e],c=l.slotList,d=l.slotMap={},u=new Array(c.length);for(o=0;o<t.length;o++)r=t[o],this._isSlotIndexValid(r.slotIndex)&&(u[r.slotIndex]=r);for(o=0;o<c.length;o++){r=u[o];var h=c[o];r?(h.isEmpty()||h.getShortcutHash()!==r.getHash())&&(h.setShortcut(r),s(h,d)):h.isEmpty()||(h.unset(),a(h,d))}"spell"===e&&(this._currentCharacterId=n.spellData.characterId,this.updateSpellsAvailability())},n.prototype._setPanelContentRequest=function(e,t){var i,n=window.gui.playerData.characters.getControlledCharacter();if(this._emptyPanel(e),"spell"===e?(this._currentCharacterId=null,i=n.spellData):i=window.gui.playerData.inventory,i.isLoaded)this._setPanelContent(e,t);else{this._setPlaceHolder(e,t);var o=this._setPanelContent.bind(this,e,t);this._panelLoadingCb[e]=o,i.once("loaded",o)}},n.prototype._cancelPanelLoadingCb=function(e){if(this._panelLoadingCb[e]){var t=window.gui.playerData.characters.getControlledCharacter(),i="spell"===e?t.spellData:window.gui.playerData.inventory;i.removeListener("loaded",this._panelLoadingCb[e]),delete this._panelLoadingCb[e]}},n.prototype._setItemsSlotsDraggability=function(e){for(var t=this._panels.item.slotList,i=0;i<t.length;i++)t[i].setDraggability(e&&!t[i].isEmpty())},n.prototype._setSpellsSlotsDraggability=function(e){for(var t=this._panels.spell.slotList,i=0;i<t.length;i++)t[i].setDraggability(e&&!t[i].isEmpty())},n.prototype._selectSlot=function(e,t){if(!this.isOrganizing){if(t&&window.isoEngine.clearSpellDisplay(),this._selectedSlot===e)return this._unSelectSlot(e);if(this._selectedSlot&&this._selectedSlot.unselect(),e.isEmpty())return void(this._selectedSlot=null);this._selectedSlot=e,e.select(),window.gui.fightManager.isInBattle()&&this._close(!0)}},n.prototype._unSelectSlot=function(e){e&&this._selectedSlot===e&&(this._selectedSlot.unselect(),this._selectedSlot=null)},n.prototype.deselectCurrentSlot=function(){this._unSelectSlot(this._selectedSlot)},n.prototype.getIdOfSelectedSpellIfAny=function(){var e=this._selectedSlot;return!e||"spell"!==e.type||e.isEmpty()?null:e.shortcut.spellId},n.prototype._updateWeaponSpell=function(){var e=window.gui.playerData.characters.mainCharacter.spellData.spells[y.WEAPON_SPELL_ID];if(!e)return console.warn("the player weapon spell has not been created yet");var t=this._panels.spell.slotMap["spell"+y.WEAPON_SPELL_ID];if(t)for(var i=0;i<t.length;i++)t[i].setSpell(e)},n.prototype._swapSlots=function(e,t){var i=this;if(e.type!==t.type)return console.error(new Error("Impossible to swap a slot from panel "+e.type+" and panel "+t.type));var n=this._panels[e.type];if((!window.gui.fightManager.isInBattle()||this.isOrganizing)&&this._dragStartPage===this._pagination.current){if(e.slotIndex===t.slotIndex)return t.setStyle("webkitTransform","translate3d(0,0,0)");T.removeAllListeners("ShortcutBarSwapErrorMessage");var o=t.slotIndex,s=t.getParent(),a=t.x-e.x,r=t.y-e.y;t.slotIndex=e.slotIndex,n.slotList[t.slotIndex]=e.getParent().appendChild(t),this._positionSlot(t),e.slotIndex=o,n.slotList[e.slotIndex]=s.appendChild(e),M.tween(e,{webkitTransform:"translate3d("+a+"px,"+r+"px,0)"},{time:100,easing:"ease-out"},function(){i._positionSlot(e),window.dofus.sendMessage("ShortcutBarSwapRequestMessage",{barType:L[t.type],firstSlot:t.slotIndex,secondSlot:e.slotIndex})}),T.once("ShortcutBarSwapErrorMessage",function(){var n=t.slotIndex;t.slotIndex=e.slotIndex,e.slotIndex=n,i._positionSlot(t),i._positionSlot(e)})}},n.prototype._onDropOnSlot=function(e,t,i,n){switch(i){case"shortcutBar":this._swapSlots(e,t);break;case"characterBox":case"equipment":var o=t.itemInstance;this._setShortcutRequest(new I({_type:"ShortcutObjectItem",slot:e.slotIndex,itemUID:o.objectUID,itemGID:o.objectGID}));break;case"presets":this._setShortcutRequest(new I({_type:"ShortcutObjectPreset",slot:e.slotIndex,presetId:t.preset.presetId}));break;case"spellsWindow":this._setShortcutRequest(new I({_type:"ShortcutSpell",slot:e.slotIndex,spellId:n.spellId}));break;case"attitude":this._setShortcutRequest(new I({_type:"ShortcutEmote",slot:e.slotIndex,emoteId:n.id}));break;case"smiley":this._setShortcutRequest(new I({_type:"ShortcutSmiley",slot:e.slotIndex,smileyId:n.id}))}},n.prototype._setOrganizeMode=function(e){var t=window.gui.playerData.characters.isMainCharacterControlled();if(!e||"spell"!==this._currentPanelType||t)if(this._tempToolbarResize||(this._tempToolbarResize={active:!1,previousPanel:null}),this.isOrganizing=e,this.toggleClassName("draggable",this.isOrganizing),this._setItemsSlotsDraggability(this.isOrganizing),this._setSpellsSlotsDraggability(this.isOrganizing),this.isOrganizing){this.spellBtn.disable(),this.itemBtn.disable();var i="spell"===this._currentPanelType,n=p.menubarSizeInFight!==p.menubarSize,o=i!==window.gui.playerData.isFighting;if(n&&o){this._tempToolbarResize.active=!0,this._tempToolbarResize.previousPanel=i?"spell":"item",this.shouldKeepOpen=!0;var s=i?"tablet.nowShowingFightToolbar":"tablet.nowShowingRpToolbar";b.showNotification(m(s),this),window.gui.showFightingToolbar(i)}}else this.spellBtn.enable(),this.itemBtn.enable(),this._tempToolbarResize.active?(this.shouldKeepOpen=!1,"spell"===this._tempToolbarResize.previousPanel?window.gui.resizeToolbarForRoleplay():window.gui.resizeToolbarForFight(),this._tempToolbarResize.active=!1,this._tempToolbarResize.previousPanel=null):this.close()}},function(e,t){},function(e,t){e.exports={GENERAL_SHORTCUT_BAR:0,SPELL_SHORTCUT_BAR:1}},function(e,t,i){function n(e,t,i){var n=new l({className:["arrow",e],repeatDelay:c,sound:i},function(){t.emit(e)});return t.appendChild(n)}function o(e){r.call(this,"div",{className:"PaginationUI"}),e=e||{},this._leftArrow=n("previous",this,e.soundPrev),this._centeringContainer=this.createChild("div",{className:"centeringContainer"});var t=this._numberInputBox=this._centeringContainer.appendChild(new a);this.isInputDisabled=!!e.disableInput,t.setReadonly(this.isInputDisabled);var i=this;t.on("change",function(e){i.emit("page",e-1)}),this._pageCountLabel=this._centeringContainer.createChild("div",{className:"pageCount"}),this._rightArrow=n("next",this,e.soundNext)}i(734);var s=i(172).inherits,a=i(340),r=i(321),l=i(335),c=200;s(o,r),o.prototype.setDirection=function(e){this.toggleClassName("vertical","vertical"===e)},o.prototype._checkPosition=function(){this._leftArrow.setEnable(0!==this.current),this._rightArrow.setEnable(this.current<this._pageCount-1);var e=this._pageCount<=1||this.isInputDisabled;this._numberInputBox.setReadonly(e),this._centeringContainer.toggleClassName("readOnly",e)},o.prototype.setCurrent=function(e){
this.current=e,this._numberInputBox.setValue(e+1),this._checkPosition()},o.prototype.setPageCount=function(e){this._numberInputBox.maxValue=e,this._pageCount=e,this._pageCountLabel.setText("/ "+e),this._checkPosition()},e.exports=o},function(e,t){},function(e,t){function i(e){if(!e)return console.error(new Error("Shortcut: cannot create a new shortcut without data"));if(!e._type||!n[e._type])return console.error(new Error("Shortcut: type "+e._type+" is invalid"));if(void 0===e.slot||null===e.slot)return console.error(new Error("Shortcut: invalid slot "+e.slot));this._type=e._type,this.slotIndex=e.slot;for(var t=n[e._type],i=0;i<t.length;i++){if(void 0===e[t[i]]||null===e[t[i]])return console.error(new Error("Shortcut ("+e._type+"): invalid "+t[i]+" :"+e[t[i]]));this[t[i]]=e[t[i]]}}var n={ShortcutSpell:["spellId"],ShortcutObjectItem:["itemGID","itemUID"],ShortcutObjectPreset:["presetId"],ShortcutEmote:["emoteId"],ShortcutSmiley:["smileyId"]};e.exports=i,i.prototype.serialize=function(){var e={};e._type=this._type,e.slot=this.slotIndex;for(var t=n[this._type],i=0;i<t.length;i++)e[t[i]]=this[t[i]];return e},i.prototype.getHash=function(){switch(this._type){case"ShortcutSpell":return"spell"+this.spellId;case"ShortcutObjectItem":return"item"+this.itemUID;case"ShortcutObjectPreset":return"preset"+this.presetId;case"ShortcutEmote":return"emote"+this.emoteId;case"ShortcutSmiley":return"smiley"+this.smileyId;default:return null}},i.prototype.isHandled=function(){return null!==this.getHash()},i.prototype.getShortcutBarPanelType=function(){switch(this._type){case"ShortcutSpell":return"spell";case"ShortcutObjectItem":case"ShortcutObjectPreset":case"ShortcutEmote":case"ShortcutSmiley":return"item";default:return null}}},function(e,t,i){function n(e,t){r.call(this,{scaleOnPress:!0}),this.type="item",l.constructor.call(this,e,t),this.on("doubletap",this._doubleTapHandler)}var o=i(182),s=i(172).inherits,a=i(461),r=i(737),l=i(741);s(n,r),e.exports=n,n.prototype.setShortcut=function(e){var t=this;if(!this._isShortcutValid(e))return!this.isEmpty()&&this.unset();var i=window.gui.playerData.inventory;if(this.shortcut=e,e.hasOwnProperty("presetId")){this.icon.delClassNames("disabled"),this.isDisabled=!1,this.setQuantity(1);var n=i.presets[e.presetId];o.preloadImage("gfx/presets/icon_"+n.symbolId+".png",function(e){t.setImage(e)}),this.setData(n),this.setContextMenu("preset",{presetId:e.presetId,canRemove:!0,onClose:this._onContextualMenuClosed.bind(this)})}else if(e.hasOwnProperty("emoteId"))this.icon.delClassNames("disabled"),this.isDisabled=!1,this.setQuantity(1),this.setData({emoteId:e.emoteId}),this.setContextMenu("emote",{emoteId:e.emoteId,canRemove:!0,onClose:this._onContextualMenuClosed.bind(this)}),o.preloadImage("gfx/emotes/"+e.emoteId+".png",function(e){t.setImage(e)});else if(e.hasOwnProperty("smileyId")){this.icon.delClassNames("disabled"),this.isDisabled=!1,this.setQuantity(1),this.setData({smileyId:e.smileyId}),this.setContextMenu("smiley",{smileyId:e.smileyId,canRemove:!0,onClose:this._onContextualMenuClosed.bind(this)});var s=window.gui.databases.Smileys;o.preloadImage("gfx/smilies/"+s[e.smileyId].gfxId+".png",function(e){t.setImage(e)})}else{var r=i.objects[e.itemUID];if(r){if(!r.isInitialised)return r.once("initialised",function(){t.setShortcut(e)});this.isDisabled=!1,this.icon.delClassNames("disabled"),this.setContextMenu("item",{item:r,onClose:this._onContextualMenuClosed.bind(this),remove:!0,enableActions:!0}),this.setItem(r)}else this.isDisabled=!0,this.icon.addClassNames("disabled"),a.getItems([e.itemGID],function(e,i){if(e)return console.error(e);var n=i[0];t.setContextMenu("item",{item:n,onClose:t._onContextualMenuClosed.bind(t),remove:!0,enableActions:!0}),t.setItem(n)})}},n.prototype._doubleTapHandler=function(){if(this.shortcut)switch(this.shortcut._type){case"ShortcutObjectItem":var e=this.getItem();e.isItemInstance&&e.doDefaultAction();break;case"ShortcutEmote":window.dofus.sendMessage("EmotePlayRequestMessage",{emoteId:this.shortcut.emoteId});break;case"ShortcutSmiley":window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:this.shortcut.smileyId});break;case"ShortcutObjectPreset":window.dofus.sendMessage("InventoryPresetUseMessage",{presetId:this.shortcut.presetId})}},l.appendPrototypeTo(n)},function(e,t,i){function n(e){e=e||{},o.call(this,e),this.addClassNames("ItemSlot"),this.itemTypeStyle="",this.descriptionOptions=e.descriptionOptions,this.setItem(e.itemData,e.quantity)}i(738);var o=i(739),s=i(534),a=i(337),r=i(172).inherits,l=i(182),c=0,d=[1,9,10,11,16,17,81,26,78];r(n,o),e.exports=n,n.prototype._getContextualMenuProperties=function(){return this._contextMenuParams.item=this.data,o.prototype._getContextualMenuProperties.call(this)},n.prototype.setItem=function(e,t){if(!e)return this.unset();this._itemData=e,this.itemInstance=e.getItemInstance(),this.dbItem=e.getItem();var i=e.getProperty("image");if(!i&&e.isItemInstance&&!e.isInitialised){var n=this;e.once("initialised",function(){n._itemData===e&&n.setImage(e.getProperty("image"))})}t=t||e.getProperty("quantity")||1,this.setImage(i),this.setQuantity(t),this.setDescriptionTooltip(this.descriptionOptions),this.setData(e)},n.prototype.getItem=function(){return this._itemData},n.prototype.unset=function(){o.prototype.unset.call(this),this._itemData=null,this.itemInstance=null,this.dbItem=null},n.prototype.lock=function(){var e=this;this.unset(),l.preloadImage("ui/slots/tx_slotLockedimg.png",function(t){e.setImage(t)})},n.prototype.setDescriptionTooltip=function(e,t){return this.descriptionOptions=e||this.descriptionOptions,this.hasTooltip?void a.enableTooltip(this,!0):void this.setTooltip(this._getTooltipContent,t)},n.prototype._getTooltipContent=function(){return new s(this._itemData,this.descriptionOptions)},n.prototype.setBackgroundImageByItemType=function(e){d.indexOf(e)===-1&&(e=c);var t="itemType"+e;this.replaceClassNames([this.itemTypeStyle],[t]),this.itemTypeStyle=t},n.prototype.containsPet=function(){return this.data&&this.data.item&&18===this.data.item.typeId}},function(e,t){},function(e,t,i){function n(e){e=e||{},r.call(this,"div",{className:"Slot",name:e.name||""}),a(this,e.noDoubleTap?{doubletapTimeout:1}:null),this._quantity=0,e.errorIcon&&(this.errorIcon=this.createChild("div",{className:"errorIcon"})),this.icon=this.createChild("div",{className:"slotIcon"}),this.quantityBox=this.createChild("div",{className:"quantity"}),this.forceQuantity=e.forceQuantity,e.quantity&&this.setQuantity(e.quantity),e.image&&this.setImage(e.image),this.tooltipOptions=e.tooltipOptions,e.tooltip&&this.setTooltip(e.tooltip,this.tooltipOptions),this.on("destroy",this._onDestroy),this.on("tap",this._openContextMenu),this.on("tooltipOn",this._removeHoverStyle),this.on("tooltipOut",this._applyHoverStyle),e.scaleOnPress&&(this.on("tapstart",this._showAsPressed),this.on("tapend",this._showAsReleased)),this.enableContextMenu(!e.hasOwnProperty("enableContextMenu")||e.enableContextMenu)}i(740);var o=i(337),s=i(172).inherits,a=i(197),r=i(321),l=i(182);s(n,r),e.exports=n,n.prototype._onDestroy=function(){this.destroyed=!0},n.prototype._openContextMenu=function(){this._contextMenuId&&this.isContextEnabled&&window.gui.openContextualMenuAround(this._contextMenuId,this,this._getContextualMenuProperties())},n.prototype._showAsPressed=function(){this.data&&this.icon.setStyle("webkitTransform","scale(0.9)")},n.prototype._showAsReleased=function(){this.icon.setStyle("webkitTransform","scale(1)")},n.prototype._removeHoverStyle=function(){this.icon.setStyle("webkitTransform","scale(1.1)")},n.prototype._applyHoverStyle=function(){this.icon.setStyle("webkitTransform","scale(1)")},n.prototype._getContextualMenuProperties=function(){return this._contextMenuParams},n.prototype.unset=function(){o.enableTooltip(this,!1),this.quantityBox.hide(),this.setContextMenu(),this.setImage(),this.setData(),this.emit("unset")},n.prototype.setQuantity=function(e){this._quantity=e,this.quantityBox.setText(e),this.quantityBox.toggleDisplay(!!this.forceQuantity||e&&e>1)},n.prototype.getQuantity=function(){return this._quantity},n.prototype.select=function(e){var t=e&&e.extraStyle?e.extraStyle:null;t!==this.extraStyle&&(this.extraStyle&&this.delClassNames(this.extraStyle),t&&this.addClassNames(t),this.extraStyle=t),this.selected||(this.selected=!0,this.addClassNames("selected"),this.emit("selected"))},n.prototype.unselect=function(){this.extraStyle&&this.delClassNames(this.extraStyle),this.delClassNames("selected"),this.selected=!1,this.emit("unselected")},n.prototype.setImage=function(e){return this.rootElement?(this.image=e,e=e||"none",this.icon.setStyle("backgroundImage",e),this.loadingImage=!1,this.requestedImages=null,void this.emit("setImage",this.image)):console.warn("trying to set an image on a destroyed object")},n.prototype.getImage=function(){return this.image},n.prototype.setTooltip=function(e,t){return this.hasTooltip?void o.enableTooltip(this,!0):(o.addTooltip(this,e,t||this.tooltipOptions),void(this.hasTooltip=!0))},n.prototype.setContextMenu=function(e,t){this._contextMenuId=e,this._contextMenuParams=t},n.prototype.setData=function(e){this.data=e,e&&this.emit("setData",this.data)},n.prototype.preloadAndSetImages=function(e){e=e||[],this.requestedImages=e;var t=this;this.loadingImage=!0,l.preloadImages(e,function(i){if(t.requestedImages===e&&!this.destroyed){for(var n="none",o=0;o<i.length&&(n=i[o],"none"===n);o+=1);t.loadingImage&&t.setImage(n)}})},n.prototype.enableContextMenu=function(e){this.isContextEnabled=!arguments.length||e}},function(e,t){},function(e,t,i){var n=i(317),o=i(735),s={prototype:{}};s.appendPrototypeTo=function(e){for(var t in s.prototype){if(e.prototype[t])return console.error("ShortcutBarSlot: class "+e.name+' already has a method called "'+t+'"');e.prototype[t]=s.prototype[t]}};var a={item:["shortcutBar","equipment","presets","characterBox","attitude","smiley"],spell:["shortcutBar","spellsWindow"]};e.exports=s,s.constructor=function(e,t){var i=this;this.slotIndex=t,this.shortcutBar=e,this.shortcut=null,this.isDisabled=!1,this._addDraggableBehaviour(),this._addDroppableBehaviour(),this.addClassNames("empty","ShortcutSlot","vibrate","anim"+Math.round(9*Math.random())),this.on("unset",function(){i.shortcut=null,i.isDisabled=!1,n.disableDrag(i),i.icon.delClassNames("disabled"),i.addClassNames("empty"),e._selectedSlot===i&&e._unSelectSlot(i)}),this.on("setData",function(){i.delClassNames("empty"),e._selectedSlot===i&&e._unSelectSlot(i)}),this.on("dragStart",function(){e._dragStartPage=e._pagination.current,e.isOrganizing&&e.showTrash(),"spell"===i.type&&window.gui.fightManager.isInBattle()&&!e.isOrganizing&&(i.selected||e._selectSlot(i,!1),i.customScale=1,i.customXOffset=0,i.customYOffset=-24,i.customRotation=45)}),this.on("dragEnd",function(t,n){e.hideTrash(),"spell"===i.type&&window.gui.fightManager.isInBattle()&&!e.isOrganizing&&(window.background.dragCellRelease(t,n,i),window.foreground.confirmBox.isOpen||e._unSelectSlot(i),i.customScale=null,i.customXOffset=null,i.customYOffset=null,i.customRotation=null)}),this.on("drop",function(t,n,o){e._onDropOnSlot(i,t,n,o)}),this.on("tap",function(){if(!("spell"===i.type&&i.isDisabled||"item"===i.type&&window.gui.fightManager.isInBattle())){var t=!0;e._selectSlot(i,t)}})},s.prototype._addDraggableBehaviour=function(){var e=null,t="shortcutBar",i=null,o={dragOnTouchstart:!1,dragElement:!0,noHover:!0};n.setDraggable(this,e,t,i,o),n.setDragEnable(this,!1)},s.prototype._addDroppableBehaviour=function(){var e=a[this.type],t={matchPositionOnDrop:!0,isDropAllowed:this._isDropAllowed.bind(this)};n.setDroppable(this,e,t)},s.prototype._isDropAllowed=function(e,t,i){return!window.gui.fightManager.isInBattle()||(!!this.shortcutBar.isOrganizing||("shortcutBar"!==i||!t||"spell"!==t.type))},s.prototype._onContextualMenuClosed=function(e){this.shortcutBar._unSelectSlot(this),"remove"===e&&this.shortcutBar._removeShortcutFromSlotRequestWith2Animations(this)},s.prototype.enableDrag=function(){this.setDraggability(!0)},s.prototype.disableDrag=function(){this.setDraggability(!1)},s.prototype.setDraggability=function(e){this.isEmpty()?e=!1:!e&&"spell"===this.type&&window.gui.fightManager.isInBattle()&&(e=!0),n.setDragEnable(this,e)},s.prototype._isShortcutValid=function(e){return e&&e instanceof o&&e.isHandled()},s.prototype.isEmpty=function(){return!this.shortcut},s.prototype.getShortcutHash=function(){return this.shortcut?this.shortcut.getHash():null},s.prototype.refreshShortcut=function(){this.setShortcut(this.shortcut)}},function(e,t,i){function n(e,t){s.call(this,{scaleOnPress:!0}),this.type="spell",this.delayedSetShortcutData=null,a.constructor.call(this,e,t);var i=this;this.on("dragMove",function(t,n){window.gui.fightManager.isInBattle()&&!e.isOrganizing&&window.background.colorCurrentDragCell(t,n,i)}),this.on("selected",function(){i.isEmpty()||window.gui.emit("spellSlotSelected",i.shortcut.spellId)}),this.on("unselected",function(){window.gui.emit("spellSlotDeselected")}),window.gui.on("disconnect",function(){i._resetDelayedSetShortcut()})}var o=i(172).inherits,s=i(743),a=i(741);o(n,s),e.exports=n,n.prototype._resetDelayedSetShortcut=function(){if(this.delayedSetShortcutData){var e=this.delayedSetShortcutData.character;e&&e.spellData&&(e.spellData.removeListener("loaded",this.delayedSetShortcutData.cb),this.delayedSetShortcutData=null)}},n.prototype.setShortcut=function(e){if(this._resetDelayedSetShortcut(),!this._isShortcutValid(e))return!this.isEmpty()&&this.unset();var t=window.gui.playerData.characters.getControlledCharacter(),i=t.spellData.spells[e.spellId];return this.shortcut=e,i?(this.setSpell(i),void this.setContextMenu("spell",{spell:i,canRemove:!0,onClose:this._onContextualMenuClosed.bind(this)})):(this.delayedSetShortcutData={shortcut:e,character:t,cb:this.setShortcut.bind(this,e)},t.spellData.once("loaded",this.delayedSetShortcutData.cb))},a.appendPrototypeTo(n)},function(e,t,i){function n(e){e=e||{},o.call(this,e),this.addClassNames("SpellSlot"),this.setSpell(e.spellData,e.descriptionOptions),this.customScale=null,this.customXOffset=null,this.customYOffset=null,this.customRotation=null,this._setSpellCount=0}i(744);var o=i(739),s=i(412),a=i(745),r=i(172).inherits,l=i(182);r(n,o),e.exports=n,n.prototype.setSpell=function(e,t){if(this.descriptionOptions=t||this.descriptionOptions,!e)return this.unset();var i=++this._setSpellCount,n=this.spellInstance=e._uid?e:null,o=this.dbSpell=n?n.spell:e,a=this;if(n&&n.isItem){var r=n._item;if(!r.isInitialised)return r.once("initialised",function(){a._setSpellCount===i&&a.setSpell(e)});this.setImage(r.getProperty("image"))}else o.image?this.setImage(o.image):(this.setImage(s.placeHolder),l.preloadImage("gfx/spells/sort_"+o.iconId+".png",function(e){a._setSpellCount===i&&(o.image=e,a.setImage(o.image))}));this.setTooltip(this._getTooltipContent),this.setData(e)},n.prototype._getTooltipContent=function(){return new a({spell:this.spellInstance||this.dbSpell},this.descriptionOptions)},n.prototype.setCooldown=function(e){this.quantityBox.setText(e),this.quantityBox.toggleDisplay(e>0)}},function(e,t){},function(e,t,i){function n(e,t){if(t=t||{},A.call(this,"div",t),this.addClassNames("SpellDescription"),this._buildDomElements(t),this.visibilityBoundToOptions=!t.visibilityOptions&&!t.spellTooltipAll,this.visibilityOptions=t.visibilityOptions||{},t.spellTooltipAll)for(var i in S)this.visibilityOptions[i]=!0;this.updateVisibleBlocks(!0),this.updateUI(e)}function o(e){this._domElements.spellName.setText(e.getName())}function s(e,t){var i=e.getProperty("apCost",t),n=e.getProperty("minRange",t),o=e.getProperty("range",t);this._domElements.points.ap.setText(T("ui.common.ap")+" : "+i),this._domElements.points.ra.setText(T("ui.common.ra")+" : "+n),o!==n?this._domElements.points.range.setText(" - "+o):this._domElements.points.range.clearContent()}function a(e,t){var i=e.getProperty("criticalHitProbability",t);i>0?this._domElements.criticalHit.setText(T("ui.common.short.CriticalHit")+": 1/"+i):this._domElements.criticalHit.clearContent()}function r(e){var t=e.getHumanReadableZoneInfo();t.length?this._domElements.areaOfEffect.setText(T("ui.common.spellArea")+": "+t):this._domElements.areaOfEffect.setText(t)}function l(e,t){this._domElements.level.setText(T("ui.common.level")+" "+e.getProperty("grade",t))}function c(e,t){0!==e.getProperty("typeId",t)?this._domElements.breed.setText(T("ui.common.breedSpell")+": "+e.getHumanReadableSpellType()):this._domElements.breed.clearContent()}function d(e,t){e.getProperty("rangeCanBeBoosted",t)?this._domElements.rangeBoost.setText(T("ui.spell.rangeBoost")):this._domElements.rangeBoost.clearContent()}function u(e,t){!e.getProperty("castTestLos",t)&&e.getProperty("range",t)?this._domElements.castWithoutLos.setText(T("ui.spellInfo.castWithoutLos")):this._domElements.castWithoutLos.clearContent()}function h(e,t){e.getProperty("castInLine",t)?this._domElements.castInLine.setText(T("ui.spellInfo.castInLine")):this._domElements.castInLine.clearContent()}function p(e,t){var i=e.getProperty("maxCastPerTurn",t);i>0?this._domElements.maxCastPerTurn.setText(T("ui.spellInfo.maxCastPerTurn")+": "+i):this._domElements.maxCastPerTurn.clearContent()}function m(e,t){var i=e.getProperty("maxCastPerTarget",t);i>0?this._domElements.maxCastPerTarget.setText(T("ui.spellInfo.maxCastPerTarget")+": "+i):this._domElements.maxCastPerTarget.clearContent()}function f(e,t){e.getProperty("maxStack",t)>0?this._domElements.maxStack.setText(T("ui.spellInfo.maxStack")+": "+e.getProperty("maxStack",t)):this._domElements.maxStack.clearContent()}function g(e,t){var i=e.getProperty("minCastInterval",t);i>0?this._domElements.minCastInterval.setText(T("ui.spellInfo.minCastInterval")+": "+i):this._domElements.minCastInterval.clearContent()}function _(e,t){e.getProperty("globalCooldown",t)===-1?this._domElements.globalCooldown.setText(T("ui.spellInfo.globalCastInterval")):this._domElements.globalCooldown.clearContent()}function v(e,t){var i=e.getProperty("statesForbidden",t);if(i&&i.length>0){this._domElements.forbiddenStates.createChild("span",{text:T("ui.spellInfo.stateForbidden")+":"});for(var n=0;n<i.length;n++)this._domElements.forbiddenStates.createChild("span",{text:" "+e._tables.spellStates[i[n]].nameId})}else this._domElements.forbiddenStates.clearContent()}function y(e,t){var i=e.getProperty("statesRequired",t);if(i&&i.length>0){this._domElements.requiredStates.createChild("span",{text:T("ui.spellInfo.stateRequired")+":"});for(var n=0;n<i.length;n++)this._domElements.requiredStates.createChild("span",{text:" "+e._tables.spellStates[i[n]].nameId})}else this._domElements.requiredStates.clearContent()}function b(e,t){this._domElements.effectsAndDamage.setEffectsFromSpell(e,t)}function M(e,t){this._domElements.description.setText(e.getProperty("descriptionId",t))}i(746);var w=i(536),T=i(29).getText,C=i(172).inherits,A=i(321),I=i(171),S={spellTooltipName:["spellName"],spellTooltipApRange:["pointsLine"],spellTooltipCritical:["criticalHit"],spellTooltipEffect:["areaOfEffect","level","breed","rangeBoost","castWithoutLos","castInLine","maxStack","maxCastPerTarget","maxCastPerTurn","minCastInterval","globalCooldown","forbiddenStates","requiredStates","effectsAndDamage"],spellTooltipDescription:["description"]};C(n,A),e.exports=n,n.prototype.updateVisibleBlocks=function(e){var t=this._domElements;for(var i in S){var n=this.visibilityOptions[i],o=this.visibilityBoundToOptions?I[i]:!!this.visibilityOptions[i];if(e||o!==n){this.visibilityOptions[i]=o;for(var s=S[i],a=0;a<s.length;a++)t[s[a]].toggleDisplay(o)}}},n.prototype._buildDomElements=function(e,t){var i=this._domElements={};i.spellName=this.createChild("div",{className:"spellName"}),i.pointsLine=this.createChild("div",{className:"pointsLine"}),i.points={ap:i.pointsLine.createChild("span",{className:"ap"}),ra:i.pointsLine.createChild("span",{className:"ra"}),range:i.pointsLine.createChild("span")},i.criticalHit=this.createChild("div"),i.areaOfEffect=this.createChild("div"),i.level=this.createChild("div"),i.breed=this.createChild("div"),i.rangeBoost=this.createChild("div"),i.castWithoutLos=this.createChild("div"),i.castInLine=this.createChild("div"),i.maxStack=this.createChild("div"),i.maxCastPerTarget=this.createChild("div"),i.maxCastPerTurn=this.createChild("div"),i.minCastInterval=this.createChild("div"),i.globalCooldown=this.createChild("div"),i.forbiddenStates=this.createChild("div"),i.requiredStates=this.createChild("div"),i.effectsAndDamage=this.appendChild(new w(t)),i.description=this.createChild("div",{className:"description"})},n.prototype.updateUI=function(e){if(e&&e.spell&&e.spell.isLoaded){this.updateVisibleBlocks();var t=e.spell,i=void 0!==e.level?e.level:t.level;o.call(this,t),s.call(this,t,i),a.call(this,t,i),r.call(this,t),l.call(this,t,i),c.call(this,t,i),d.call(this,t,i),u.call(this,t,i),h.call(this,t,i),p.call(this,t,i),m.call(this,t,i),f.call(this,t,i),g.call(this,t,i),_.call(this,t,i),y.call(this,t,i),v.call(this,t,i),b.call(this,t,i),M.call(this,t,i)}}},function(e,t){},function(e,t,i){function n(e){return e?(h.call(this,"div",e),this.isAlive=!0,this.tweener=null,this.timeout=null,this.isLocked=e.isLocked,this.channel=e.channel,this.decodeAllPages=e.decodeAllPages,this.msgPages=null,this.currentPage=0,this._createContent(e),this.closeFunc=this.close.bind(this),this.actionHandler=e.action,this.closeHandler=e.onClose,e.title&&this.setTitle(e.title),this._setContent(e.msg,e.objectItems),this.actor=e.actor,void(e.actor&&this.contentLength&&this._openNextToActor())):console.error(new Error("SpeechBubble: params is missing"))}function o(e,t){for(var i=0,n=null,o=0;o<t.length;o++){var s=e.lastIndexOf(t[o]);s>i&&(n=t[o],i=s)}return null===n?null:e.substr(0,i+n.length)}function s(e){for(var t,i=[],n=0,s="",a="";;){t=e.substr(n,M);var r=e.length-n;if(r<M)return i.push(a+t),i;var l=o(t,A);if(l&&r-l.length<M*w){var c=o(t.substr(0,r*T),A);c&&r-c.length<=M&&(l=c)}if(!l||l.length<M*w){var d=o(t,I);d&&d.length>=M*T&&(l=d,s=S),l||(l=t,s=S)}n+=l.length,i.push(a+l+s),a=s===S?S:"",s=""}}i(748);var a=i(339),r=i(614),l=i(172).inherits,c=i(197),d=i(337),u=i(196),h=i(321),p=250,m=150,f=150,g=150,_=.85,v=2e3,y=.6,b=150,M=450,w=.3,T=.6,C="   ",A=["\n",". ","... ","? ","! "],I=[" ",", ",": ","; "],S="...";l(n,h),e.exports=n,n.prototype._createContent=function(e){this.addClassNames("speechBubble"),this.isLocked&&this.addClassNames("frozen"),c(this,{doubletapTimeout:1}),this.on("tap",this._tapHandler),e.title&&(this.title=this.createChild("div",{className:"title"})),this.content=this.createChild("div",{className:"content"}),this.arrow=this.createChild("div"),e.channel&&this.addClassNames("channel"+e.channel)},n.prototype._resize=function(){var e=this.content,t=e.rootElement.clientWidth;if(t>m){var i=this.contentLength<f?m:p;e.setStyle("width",i+"px")}},n.prototype._setArrow=function(e){this.arrow.setClassNames("arrow");var t=e.angle;t>0?t>Math.PI/2?this.arrow.addClassNames("bottomLeft"):this.arrow.addClassNames("bottomRight"):t<-Math.PI/2?this.arrow.addClassNames("topLeft"):this.arrow.addClassNames("topRight")},n.prototype.setTitle=function(e){this.title.setText(e)},n.prototype._setPage=function(e){this.content.appendChild(r.process(e,{objectItems:this.objectItems,channel:this.channel,decodeAllPages:this.decodeAllPages})),this.contentLength=e.length},n.prototype._setContent=function(e,t){if(this.objectItems=t,"string"==typeof e)e.length>M&&(this.nextBtn=this.createChild("div",{className:"nextBtn"}),this.msgPages=s(e),this.currentPage=0,e=this.msgPages[0]+C),this._setPage(e);else{if(!(e instanceof h))return console.error(new Error("SpeechBubble: unknown msg type ("+typeof e+")"));this.content.appendChild(e),this.contentLength=e.rootElement.innerText.length}},n.prototype._displayNextPage=function(){return!!this.msgPages&&(!(this.currentPage>=this.msgPages.length-1)&&(u.tween(this,{opacity:0},{time:b},function(){if(this.isAlive){this.currentPage++,this.currentPage===this.msgPages.length-1&&this.nextBtn.hide();var e=this.msgPages[this.currentPage]+C;this.content.setStyle("width",null),this.content.clearContent(),this._setPage(e),this._resize(),this._findPosition(),a.forceReflow(this),u.tween(this,{opacity:1},{time:g})}}),!0))},n.prototype._openNextToActor=function(){this.setStyle("opacity",0),window.gui.gameGuiContainer.appendChild(this),this._resize();var e=window.isoEngine.mapScene.camera;e.emitAtDestination?e.once("atDestination",this._findPositionAppearAndListen.bind(this)):this._findPositionAppearAndListen()},n.prototype._findPositionAppearAndListen=function(){this.isAlive&&(this._findPosition(),this._appearAndListen())},n.prototype._findPosition=function(){var e=window.gui.boxArranger;this.box&&e.removeBox(this.box);var t=this.box=window.gui.boxArranger.addBoxNextToActor(this.actor,this);this.setStyles({left:t.x+"px",top:t.y+"px"}),this._setArrow(t)},n.prototype._appearAndListen=function(){window.gui.on("disconnect",this.closeFunc),this.isLocked||window.isoEngine.on("mapLoaded",this.closeFunc);var e=this.isLocked||this.msgPages,t=e?1:_;this.tweener=u.tween(this,{opacity:t},{time:g},function(){if(!e){var t=d.computeNotificationDisplayTime(this.contentLength);this.timeout=window.setTimeout(function(e){e._dimBeforeDisappearing()},t,this)}})},n.prototype._dimBeforeDisappearing=function(){this.tweener=u.tween(this,{opacity:y},{time:400},this._disappearLater)},n.prototype._disappearLater=function(){this.timeout=window.setTimeout(this.closeFunc,v)},n.prototype._tapHandler=function(){if(!this._displayNextPage()){if(this.isLocked){if(!this.actionHandler)return;return this.actionHandler()}return this.msgPages?this.close():this.tweener||this.timeout?void this._freeze():this.close()}},n.prototype._freeze=function(){this.addClassNames("frozen"),this.setStyle("opacity",1),this.tweener.cancel(),this.tweener=null,this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null),window.foreground.on("dom.touchend",this.closeFunc)},n.prototype.close=function(e){e&&e.isReload||this.isAlive&&(this.isAlive=!1,this.setEnable(!1),this.tweener&&this.tweener.cancel(),window.clearTimeout(this.timeout),window.isoEngine.removeListener("mapLoaded",this.closeFunc),window.foreground.removeListener("dom.touchend",this.closeFunc),window.gui.removeListener("disconnect",this.closeFunc),this.closeHandler&&this.closeHandler(),window.gui.boxArranger.removeBox(this.box),u.tween(this,{opacity:0},{time:b},this.destroy))}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"Timeline",hidden:!0}),this._createContent(),this.statsDetails=null,this.currentFighter=null,this.selectedFighter=null,this.isCollapsed=!1,this._registerListeners(window.gui),this.timerTimestamp=null,this.timerDuration=null,this.timerTween=null,this._previousFighter=null}i(750);var o=i(172).inherits,s=i(171),a=i(321),r=i(598),l=i(751),c=i(753),d=i(337).addTooltip,u=i(29).getText,h=i(348),p=i(436),m=i(196),f=i(317),g=i(364),_=55,v=45,y=0;o(n,a),e.exports=n,n.prototype._registerListeners=function(e){function t(e,t,i){t||(t=[],e.length>0&&t.push(e[0]));for(var n=a.getAvailableFighters(),o=0,s=t.length;o<s;o++){var r=t[o],l=n[r];l&&i(l)}}function i(e,i){t(e,i,function(e){o.unsetTurnOf(e),o.onOrderFightersSwitched(),s.hideDeadFighters&&o.refreshTimeline()})}function n(e){e.refreshHP(),e.refreshShield()}var o=this,a=e.fightManager;a.on("GameFightTurnEnd",function(e){var t=this.getFighter(e);t&&t.data.alive&&o.unsetTurnOf(t)}),a.on("FightersListUpdated",function(){o.refreshTimeline()}),a.on("UpdatePreFightersList",function(){o.refreshTimeline()}),a.on("GameFightTurnStart",function(e,t){var i=this.getFighter(e);i&&i.data.alive&&o.setTurnOf(i,t)}),a.on(h.FIGHTER_DEATH,i),a.on(h.FIGHTER_LEAVE,i),a.on("FoldAll",function(){}),a.on("BuffAdd",function(e,t){n(t),o._refreshAfterResize()}),a.on("BuffDispell",function(e){n(e)}),a.on("BuffRemove",function(e,t){n(t),o._refreshAfterResize()}),a.on("BuffUpdate",function(e,t){n(t)}),a.on("TurnCountUpdated",function(e){o.turnCountLabel.setText(u("ui.fight.turnNumber",e+1))}),a.on("OrderFightersSwitched",function(){o.onOrderFightersSwitched()}),s.on("hideDeadFighters",function(){o.refreshTimeline()}),s.on("orderFighters",function(e){var t=a.getAvailableFighters();for(var i in t)t[i].picto.fighterNumber.toggleDisplay(e);o.refreshTimeline(),e||window.actorManager.allTurnNumbersOff()}),a.on("HideSummonedFighters",function(){}),e.on("resize",function(e){y=Math.floor(.7*e.mapWidth)}),this.on("collapse",function(e){this.isCollapsed=e,this._refreshAfterResize()}),this.on("dragEnd",function(){this.fighterListScroller.refresh()})},n.prototype._createContent=function(){r(this,{isCollapsable:!0});var e=this.infoAndFighters=this.createChild("div",{className:"infoAndFighters"});this.fighterListContainer=e.createChild("div",{name:"fighterListContainer",className:"fighterListContainer"}),this.fighterListScroller=this.fighterListContainer.appendChild(new p({name:"fighterListScroller",className:"fighterList"},{isHorizontal:!0})),this.fighterList=this.fighterListScroller.content,this.infoContainer=e.createChild("div",{className:"infoContainer"}),this.turnCountLabel=this.infoContainer.createChild("div",{className:"turnCountLabel"}),this.fightControlButtons=this.infoContainer.appendChild(new l),this.fightControlButtons.on("TurnReadyPressed",function(){window.gui.fightManager.finishTurn()}),this.buffList=this.appendChild(new c)},n.prototype.close=function(){this.currentFighter&&this.unsetTurnOf(this.currentFighter),this.selectedFighter=null,this.buffList.close(),this.hide(),this.fighterList.clearContent(),this.turnCountLabel.clearContent()},n.prototype.restoreFighterList=function(){this.infoAndFighters.insertAsFirstChild(this.fighterListContainer),this.restartTimerAnimation(),this.refreshTimeline()},n.prototype.appendFighterListTo=function(e){e.appendChild(this.fighterListContainer),this.restartTimerAnimation(),this.refreshTimeline()},n.prototype.refreshTimeline=function(){var e,t,i,n="fightPlacement"===window.foreground.tapOptions.mode,o=window.gui.fightManager,a=o.getFighters(),r=o.getDeadFighters(),l=o.getAvailableFighters(),c={},d=1;if(n){var u=this.fighterList.getChildren();for(i=0;i<u.length;i++)this.fighterList.removeChild(u[i])}var h,p=a.length,m=0;for(i=0;i<p;i++)if(e=a[i],c[e]=!0,t=l[e]){var f=r.indexOf(e)<0;if(t.setAlive(f,!0),(f||!s.hideDeadFighters)&&(t.updateNumber(f&&d++),m+=t.isSummon()?v:_,!this.fighterList.getChild(e))){h=null;for(var g=i+1;g<p&&!(h=this.fighterList.getChild(a[g]));g++);this.fighterList.insertChildBefore(t.picto,h),t.resizeFighterIllustration()}}else console.error(new Error("Fighter "+e+" not found when refreshing timeline during fight state "+o.fightState));if(!n)for(e in l)if(!c[e]){var b=this.fighterList.getChild(e);b&&this.fighterList.removeChild(b)}m=Math.min(m,y),this.fighterListContainer.setStyle("width",m+"px"),this._refreshAfterResize()},n.prototype._refreshAfterResize=function(){this.emit("resized"),this.fighterListScroller.refresh(),this.isCollapsed&&this.currentFighter&&this.fighterListScroller.showElement(this.currentFighter.picto)},n.prototype.onOrderFightersSwitched=function(){for(var e=this.fighterList.getChildren(),t=window.gui.fightManager,i=1,n=0,o=e.length;n<o;n++){var s=e[n].getWuiName(),a=t.getFighter(s);if(!a)return console.error("Fighters' order switch failed, fighter does not exist.");a.data.alive?(a.updateNumber(i),i++):a.updateNumber()}},n.prototype.linkToTimeline=function(e){var t=this;d(e.picto,function(){return t.statsDetails?e.refreshStatsTooltipContent(t.statsDetails):t.statsDetails=e.createStatsTooltipContent(),t.statsDetails}),e.picto.on("tap",function(){t.onFighterSelected(e)}),e.picto.on("tooltipOn",function(){t.onPressEntity(e,!1),window.isoEngine.displayEnemyMovementZone(e)}),e.picto.on("tooltipOut",function(){t.onReleaseEntity(),window.isoEngine.removeEnemyMovementZone()}),f.setDroppable(e.picto,["shortcutBar"]),e.picto.on("beforeDragEnd",function(){t.onFighterSelected(e)})},n.prototype.onFighterSelected=function(e){
var t=window.gui.shortcutBar.getIdOfSelectedSpellIfAny();if(t||0===t){var i=window.gui,n=i.playerData.characters.controlledCharacterId;return void(e.data.alive&&i.fightManager.currentFighterId===n&&(window.dofus.sendMessage("GameActionFightCastOnTargetRequestMessage",{spellId:t,targetId:e.id}),i.fightManager.spellCastSucceeded(t,n),window.isoEngine.clearSpellDisplay(),i.shortcutBar.deselectCurrentSlot()))}this.selectedFighter&&(window.actorManager.selectionIndicatorOff(this.selectedFighter),this.selectedFighter.picto.delClassNames("selected")),this.selectedFighter===e?(this.selectedFighter=null,this.buffList.hide()):(window.actorManager.selectionIndicatorOn(e),e.picto.addClassNames("selected"),this.selectedFighter=e,this.buffList.open(e)),this._refreshAfterResize()},n.prototype.onPressEntity=function(e){e&&e.data.stats.invisibilityState!==g.INVISIBLE&&window.isoEngine.highlightActorOnAction(e.id,1e3)},n.prototype.onReleaseEntity=function(){window.isoEngine.clearHighlights()},n.prototype.restartTimerAnimation=function(){if(this.currentFighter&&this.timerTween){this.timerTween.cancel();var e=Date.now()-this.timerTimestamp;if(!(e<0||e>=this.timerDuration)){var t=this.timerDuration-e,i=Math.ceil(100*e/this.timerDuration);this.playTimerAnimation(t,i)}}},n.prototype.startTimerAnimation=function(e){this.timerTimestamp=Date.now(),this.timerDuration=e,this.playTimerAnimation(e,0)},n.prototype.stopTimerAnimation=function(){this.timerTimestamp=null,this.timerDuration=null,this.timerTween.cancel(),this.timerTween=null;var e=this.currentFighter.picto;e.delClassNames("current"),e.fighterTimeValue.setStyles({webkitTransition:"",webkitTransform:"translate3d(0,100%,0)"})},n.prototype.playTimerAnimation=function(e,t){var i=this.currentFighter.picto;i.fighterTimeValue.setStyle("webkitTransform","translate3d(0, "+(100-t)+"%, 0)"),this.timerTween=m.tween(i.fighterTimeValue,{webkitTransform:"translate3d(0, 0, 0)"},{time:e,easing:"linear"}),i.addClassNames("current"),this.isCollapsed&&this.fighterListScroller.showElement(i)},n.prototype.unsetTurnOf=function(e){this.currentFighter&&this.currentFighter===e&&(window.actorManager.turnIndicatorOff(e),this.stopTimerAnimation(),this.currentFighter=null)},n.prototype.setTurnOf=function(e,t){this.currentFighter&&this.unsetTurnOf(this.currentFighter),this.currentFighter=e,this.startTimerAnimation(t),this.emit("setTurnOf",e,t),this._previousFighter&&window.actorManager.turnIndicatorOff(this._previousFighter),window.actorManager.turnIndicatorOn(e),this._previousFighter=e}},function(e,t){},function(e,t,i){function n(){function e(e){c.show(),l._isReadyForFight=e,e?c.addClassNames("readyForFight"):c.delClassNames("readyForFight")}function t(){c.hide(),l.setTurnReadyButtonAvailability(!1),d.show()}function i(e){e&&!window.gui.playerData.characters.canControlCharacterId(e.id)||l.setTurnReadyButtonAvailability(!0)}function n(){l.setTurnReadyButtonAvailability(!1)}function o(){d.hide()}a.call(this,"div",{className:"fightControlButtons"});var l=this;this._isReadyForFight=!1;var c=this._fightReadyBtn=new r({text:s("ui.banner.ready"),className:"fightBtn",hidden:!0,scaleOnPress:!0},function(){l.toggleReadyForFight()});this.appendChild(c);var d=this._turnReadyBtn=new r({text:s("tablet.fight.option.nextTurn"),className:"fightBtn",hidden:!0,scaleOnPress:!0},function(){l.emit("TurnReadyPressed"),n()});this.appendChild(d),window.gui.on("GameFightJoinMessage",function(t){e(!1),t.canSayReady?c.enable():c.disable()}),window.gui.fightManager.on("playerReady",e),window.gui.on("GameFightStartMessage",t),window.gui.on("GameFightResumeMessage",t),window.gui.on("GameFightResumeWithSlavesMessage",t),window.gui.on("GameFightTurnStartPlayingMessage",function(){i(null)}),window.gui.on("GameFightTurnStartMessage",i),window.gui.on("GameFightTurnStartSlaveMessage",i),window.gui.on("GameFightTurnResumeMessage",i),window.gui.on("GameFightTurnEndMessage",n),window.gui.on("GameFightEndMessage",o),window.gui.on("disconnect",o)}i(752);var o=i(172).inherits,s=i(29).getText,a=i(321),r=i(335);o(n,a),e.exports=n,n.prototype.toggleReadyForFight=function(){window.dofus.sendMessage("GameFightReadyMessage",{isReady:!this._isReadyForFight})},n.prototype.isReadyForFightButtonVisible=function(){return this._fightReadyBtn.isVisible()},n.prototype.setTurnReadyButtonAvailability=function(e){var t=this._turnReadyBtn;e?t.enable():t.disable()},n.prototype.getButtonRectForTuto=function(e){var t;switch(e){case"fightReadyBtn":t=this._fightReadyBtn;break;case"turnReadyBtn":t=this._turnReadyBtn;break;default:return null}return t.isVisible()?t.rootElement.getBoundingClientRect():null}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"FightBuffs"}),this.buffList=this.createChild("div",{className:"buffList"}),this.buffItems={},this._registerListeners(window.gui.fightManager),this.fighter=null,this.lastWasPlayer=!1,this.buffDescription=new l,this.hide()}i(754);var o=i(172).inherits,s=i(321),a=i(755),r=i(337).addTooltip,l=i(756);o(n,s),e.exports=n,n.prototype._registerListeners=function(e){var t=this;e.on("GameFightTurnStart",function(e){if(e===window.gui.playerData.id)t.lastWasPlayer=!0;else if(t.lastWasPlayer){for(var i=t.buffList.getChildren(),n=0;n<i.length;n++)i[n].updateCooldown();t.lastWasPlayer=!1}}),e.on("BuffUpdate",function(e,i){t.fighter===i&&t.updateBuff(e)}),e.on("BuffRemove",function(e,i){t.fighter===i&&t.removeBuff(e)}),e.on("BuffAdd",function(e,i){t.fighter===i&&(t._addBuff(e),t.updateUi())})},n.prototype.open=function(e){this.fighter!==e&&(this.clean(),this.fighter=e,this.makeItemBuffs(e),this.updateUi()),this.show()},n.prototype.close=function(){this.clean(),this.hide()},n.prototype.clean=function(){this.fighter=null,this.buffList.clearContent(),this.buffItems={}},n.prototype.makeItemBuffs=function(e){for(var t=e.buffs,i=0,n=t.length;i<n;i++)this._addBuff(t[i])};var c=function(e,t){return e.maxCooldown()-t.maxCooldown()};n.prototype.updateUi=function(){for(var e=[],t=[],i=this.buffList.getChildren(),n=0;n<i.length;n++){var o=i[n];0!==o.parentBoostUid?t.push(o):e.push(o)}for(e.sort(c),n=0;n<t.length;n++){for(var s=t[n],a=!1,r=0,l=0;l<e.length;l++)if(e[l].maxCooldown()<s.cooldown&&(r=l),e[l].hasUid(s.parentBoostUid)){e.splice(l+1,0,s),a=!0;break}a||e.splice(r,0,s)}for(n=0;n<e.length;n++){var d=e[n];this.buffList.appendChild(d)}},n.prototype._addBuff=function(e){function t(){for(var e=[],t=-1,i=0;i<n.buffs.length;i++){var s=n.buffs[i];e.push(s.effect),t=s.source}var a=window.gui.fightManager,r=a.getFighter(t);if(!r)return null;var c={};return c.spellName=n.spell.getName(),c.casterName=r.name,c.effects=e,o?o.updateUI(c):o=new l(c),o}var i=a.getKey(e),n=this.buffItems[i];if(n)return void n.addBuff(e);n=new a(e);var o;r(n,t),this.buffItems[i]=n,this.buffList.appendChild(n),n.addBuff(e)},n.prototype.updateBuff=function(e){var t=a.getKey(e),i=this.buffItems[t];if(i)i.updateCooldown(e),this.updateUi();else{var n=a.getDelayKey(e);if(i=this.buffItems[n],!i)return void console.warn("Trying to update a non-existing buff.");this.buffItems[t]=i,delete this.buffItems[n]}},n.prototype.removeBuff=function(e){this.removeBuffItem(e,a.getKey(e)),this.removeBuffItem(e,a.getDelayKey(e)),this.updateUi()},n.prototype.removeBuffItem=function(e,t){var i=this.buffItems[t];i&&(i.removeBuff(e),0===i.buffs.length&&(this.buffList.removeChild(i),i.destroy(),delete this.buffItems[t]))}},function(e,t){},function(e,t,i){function n(e){var t=window.gui.fightManager.getTurnCount();return e.effect.hasOwnProperty("delay")?t+e.effect.delay:t}function o(e){l.call(this,"div",{className:"BuffItem"});var t=e.castingSpell.spell.id,i=e.castingSpell.casterId,o=e.parentBoostUid,s=e.effect.hasOwnProperty("delay")&&e.effect.delay>0?n(e):-1;s>0?this.key=t+"#"+i+"#"+o+"#"+s:this.key=t+"#"+i+"#"+o,this.parentBoostUid=0,this.spell=e.castingSpell.spell;var a=this;this.spell.getIconUri&&c.preloadImage(this.spell.getIconUri(),function(e){a&&a.rootElement&&a.setStyle("backgroundImage",e)}),this.buffs=[],this.cooldownLabel=this.createChild("div",{className:"cooldown"}),this.setCooldown(0)}function s(e){return e.castingSpell.spell.id+"#"+e.castingSpell.casterId+"#"+e.parentBoostUid+"#"+n(e)}function a(e){return e.effect.hasOwnProperty("delay")&&e.effect.delay>0?s(e):e.castingSpell.spell.id+"#"+e.castingSpell.casterId+"#"+e.parentBoostUid}var r=i(172).inherits,l=i(321),c=i(182);r(o,l),e.exports=o,e.exports.getDelayKey=s,e.exports.getKey=a,o.prototype.hasUid=function(e){for(var t=0;t<this.buffs.length;t++)if(this.buffs[t].uid===e)return!0;return!1},o.prototype.addBuff=function(e){this.buffs.push(e),0!==e.parentBoostUid&&(this.parentBoostUid=e.parentBoostUid),this.updateCooldown()},o.prototype.isUnusableNextTurn=function(){for(var e=0;e<this.buffs.length;e++)if(!this.buffs[e].isUnusableNextTurn())return!1;return!0},o.prototype.updateCooldown=function(){for(var e=0,t=!1,i=0,n=0,o=this.buffs.length;n<o;n++){var s=this.buffs[n];t&&e!==s.duration&&this.setCooldown(this.cooldown-1),(0===i||s.effect.delay<i)&&(i=s.effect.delay),e=s.duration,t=!0}i>0?this.setCooldown(i):this.setCooldown(e),this.isUnusableNextTurn()&&this.addClassNames("disabled")},o.prototype.setCooldown=function(e){this.cooldown=e,e===-1?(this.cooldownLabel.setText("+"),this.cooldownLabel.show()):0===e||e===Number.MAX_VALUE?(this.cooldownLabel.setText(""),this.cooldownLabel.hide()):e<-1?(this.cooldownLabel.setText("∞"),this.cooldownLabel.show()):(this.cooldownLabel.setText(e),this.cooldownLabel.show())},o.prototype.maxCooldown=function(){if(this.cooldown!==-1)return this.cooldown;for(var e=0,t=0,i=this.buffs.length;t<i;t++){var n=this.buffs[t];(n.duration>e||n.duration<-1)&&(e=n.duration)}return e},o.prototype.removeBuff=function(e){for(var t=0;t<this.buffs.length;t++)if(this.buffs[t]===e){this.buffs.splice(t,1),this.updateCooldown();break}}},function(e,t,i){function n(e,t){d.call(this,"div",t),this.addClassNames("BuffDescription"),this._buildDomElements(t),this.updateUI(e)}function o(e){this._domElements.spellName.setText(e)}function s(e){this._domElements.casterName.setText(l("ui.fight.caster")+l("ui.common.colon")+e)}function a(e){this._domElements.effectsAndDamage.setEffects(e)}i(757);var r=i(536),l=i(29).getText,c=i(172).inherits,d=i(321);c(n,d),e.exports=n,n.prototype._buildDomElements=function(e,t){var i=this._domElements={};i.spellName=this.createChild("div",{className:"spellName"}),i.casterName=this.createChild("div",{className:"casterName"}),i.effectsAndDamage=this.appendChild(new r(t))},n.prototype.updateUI=function(e){if(e){var t=e.spellName,i=e.casterName,n=e.effects;o.call(this,t),s.call(this,i),a.call(this,n)}}},function(e,t){},function(e,t,i){function n(){d.call(this,"div",{className:"dropDown",hidden:!0});var e=this,t=this.createChild("div",{className:"dropDrownOverlay"});c(t),t.on("tap",function(){e.close()}),this.entryContainer=this.createChild("div",{className:"entryContainer"}),this.scroller=this.entryContainer.appendChild(new l({className:"entryList"},{showHintArrows:!0})),this.entryList=this.scroller.content,this._isOpen=!1,this.clearContent(),window.gui.on("disconnect",function(){e.clearContent(),e.close()})}function o(){var e=this.dropDown,t=this.action;e.close(),e._selectionFn(t.value,t.index)}i(759);var s=i(335),a=i(166).dimensions,r=i(172).inherits,l=i(436),c=i(197),d=i(321),u=30,h=15;r(n,d),e.exports=n,n.prototype.setupDropDown=function(e,t,i,n){var o=e.rootElement.getBoundingClientRect();return e===this._parentElt&&o.left===this._parentRect.left&&o.top===this._parentRect.top?this.open(i):(this._updateContent(t,n,e,o),void this._firstOpen(i))},n.prototype.clearContent=function(){this.entryList.clearContent(),this._parentElt=null,this._parentRect=null,this._selectionFn=null,this._entries=[],this._selectedIndex=-1},n.prototype._updateContent=function(e,t,i,n){this.clearContent();for(var o=0,s=e.length;o<s;o++){var a=e[o];if(!a.hidden){var r={index:o,value:a.value};a.disabled&&(r.disabled=!0),this._addEntry(a.text,r)}}this._entries=this.entryList.getChildren(),this._parentElt=i,this._parentRect=n,this._selectionFn=t},n.prototype.select=function(e){e>=this._entries.length||(this._selectedIndex!==-1&&this._entries[this._selectedIndex].delClassNames("ticked"),this._selectedIndex=e,this._entries[e].addClassNames("ticked"))},n.prototype.close=function(){this._isOpen&&(this.hide(),this._isOpen=!1)},n.prototype._firstOpen=function(e){this.setStyle("opacity",0),this.show(),this._refreshPositionAndSize(),this.open(e)},n.prototype.open=function(e){this.show(),void 0!==e&&(this.select(e),this._scrollToEntryIndex(e)),this._isOpen=!0,this.setStyle("opacity",1)},n.prototype._scrollToEntryIndex=function(e){return e<0||e>=this._entries.length?console.warn("Invalid dropdown index",e):void this.scroller.scrollToElement(this._entries[e],0)},n.prototype._refreshPositionAndSize=function(){var e=this._parentRect,t=e.left,i=e.width-u,n=e.bottom+1,o=a.screenHeight-h-n,s=this.entryList.rootElement.getBoundingClientRect();if(o<s.height&&e.top>.6*a.screenHeight){var r=e.top-5;o=Math.min(s.height,r-h),n=r-o}this.entryContainer.setStyles({left:t+"px",top:n+"px",minWidth:i+"px"}),this.scroller.setStyle("max-height",o+"px"),this.scroller.refresh()},n.prototype._addEntry=function(e,t){var i=this.entryList.appendChild(new s({text:e,className:"dropDownEntry"}));return t.disabled?void i.addClassNames("disabled"):(i.on("tap",o),i.dropDown=this,void(i.action=t))}},function(e,t){},function(e,t,i){function n(){r.call(this,"div",{className:"Compass"}),this.markers={}}i(761);var o=i(166).dimensions,s=i(172).inherits,a=i(337).addTooltip,r=i(321),l=i(762),c=i(171),d=50,u=2,h={"-5,-1":-5,"-4,0":-4,"-3,1":-3,"-2,2":-2},p={X:0,Y:3};s(n,r),e.exports=n,n.arrowType={QUEST:4,PARTY:2},n.prototype.addMarker=function(e){return this.markers[e.type]={type:e.type,arrowType:e.arrowType,x:e.x,y:e.y,tooltip:e.tooltip},this.getDistance(e.x,e.y)},n.prototype.removeMarker=function(e){delete this.markers[e]},n.prototype._displayMarkers=function(){for(var e=0;e<this.markersDom.length;e++){var t,i,n=this.markersDom[e],s=n.angleCorrected||n.angle,a=180*s/Math.PI,r=o.mapWidth-d,l=o.mapHeight-d;a<=-34&&a>=-146?(t=(r-Math.tan(Math.PI/2-s)*l)/2,i=0):a>=34&&a<=146?(t=(r+Math.tan(Math.PI/2-s)*l)/2,i=l):a<34&&a>-34?(t=r,i=(l+Math.tan(s)*r)/2):(t=0,i=(l-Math.tan(s)*r)/2),n.setStyles({left:o.mapLeft+t+"px",top:o.mapTop+i+"px"}),n.markerArrow.setStyle("webkitTransform","rotate("+a+"deg)")}},n.prototype._addMarkerDom=function(e){var t=window.gui.playerData.position.coordinates;if(t.posX!==e.x||t.posY!==e.y){var i=e.x-t.posX,n=e.y-t.posY,o=this.getDistance(e.x,e.y);if(0!==o){var s=this.createChild("div",{className:"marker"});s.markerArrow=s.createChild("div",{className:"markerArrow"}),s.markerArrow.addClassNames("arrow_"+(e.arrowType||e.type));var r=s.createChild("div",{className:"markerNumber"});r.setText(o),a(s,e.tooltip),s.angle=Math.atan2(n,i),s.on("dom.touchstart",function(e){window.foreground.emit("dom.touchstart",e)}),s.on("dom.touchend",function(e){window.foreground.emit("dom.touchend",e)}),this.markersDom.push(s)}}},n.prototype.updateMarkersPositions=function(){var e,t;this.clearContent(),this.markersDom=[];for(e in this.markers)t=this.markers[e],"phoenix"!==t.arrowType&&this._addMarkerDom(t);if(c.autoGpsPhoenixes){var i=[],n=1/0;for(e in this.markers)if(t=this.markers[e],"phoenix"===t.arrowType){var o=this.getDistance(t.x,t.y);o<n&&(n=o,i=[]),o===n&&i.push(e)}if(n>0)for(var s=0;s<i.length;s++)t=this.markers[i[s]],this._addMarkerDom(t)}l(this.markersDom),this._displayMarkers()},n.prototype.getDistance=function(e,t){var i=window.gui.playerData.position.coordinates,n=e-i.posX,o=t-i.posY,s=Math.abs(n)+Math.abs(o),a=this.isInTutorialCorridor(e,t),r=this.isInTutorialCorridor(i.posX,i.posY);return a||r?a&&r?Math.abs(e-i.posX):a?i.posX>=p.X&&i.posY>=p.Y?Math.max(1,s+h[e+","+t]):Math.max(1,s-1):e>i.posX&&t>i.posY?Math.max(1,s+h[i.posX+","+i.posY]):Math.max(1,s-1):s},n.prototype.isInTutorialCorridor=function(e,t){return window.gui.playerData.position.worldmapId===u&&void 0!==h[e+","+t]}},function(e,t){},function(e,t){function i(e,t){this.value=e,this.originalValue=e,this.forceLeft=0,this.forceRight=0,this.left=t,this.right=null,t&&(t.right=this)}function n(e,t){return e.angle-t.angle}function o(e,t){if(!(e.length<2)){t=t||s,e.sort(n);var o,l=[],c=null,d=!0,u=null;for(o=0;o<e.length;o++)u=new i(e[o].angle,u),l.push(u),c=c||u,d=d&&u.distance(c)<t;if(d){if(e[e.length-1].angle-e[0].angle>t){for(o=1;o<e.length;o++)if(e[o].angle-e[0].angle>t){l[o-1].right=null,l[o].left=null;break}l[0].left=u,u.right=l[0]}}else l[0].left=u,u.right=l[0];for(var h=1/0,p=a*e.length,m=0;h>p&&!(++m>=r);){for(h=0,o=0;o<l.length;o++)l[o].updateForces(t);for(o=0;o<l.length;o++)h+=l[o].updateValue()}for(o=0;o<e.length;o++)e[o].angleCorrected=l[o].value}}var s=.08,a=.001,r=1e3,l=1e-4,c=2*Math.PI;i.prototype.updateValue=function(){var e=this.forceLeft-this.forceRight;return this.value+=e,Math.abs(e)},i.prototype.distance=function(e){if(!e)return 1/0;var t=Math.abs(e.value-this.value);return Math.min(t,c-t)},i.prototype.updateForces=function(e){var t=this.distance(this.left),i=this.distance(this.right);this.forceLeft=t<e+l?(e-t)/2:0,this.forceRight=i<e+l?(e-i)/2:0},e.exports=o},function(e,t,i){function n(){s.call(this,"div",{className:"HintArrow",hidden:!0}),this.arrow=this.createChild("div",{className:"arrow"})}i(764);var o=i(172).inherits,s=i(321);o(n,s),e.exports=n,n.prototype.showArrow=function(e,t,i){i=i||"downRight",this.arrow.setClassNames(["arrow",i]),this.setStyles({left:e+"px",top:t+"px"}),this.show()},n.prototype.hideArrow=function(){this.hide()}},function(e,t){},function(e,t,i){function n(){s.call(this),this.inTutorial=void 0,this.isChangingMap=!1,this.inFight=!1}function o(e){window.gui.transmitMessage({_messageType:"_tutorialGameMapMovementMessage",actorId:e.actorId,isInFight:!0})}var s=i(188).EventEmitter,a=i(172).inherits,r=i(766),l=i(767),c=i(601),d=i(176);a(n,s),e.exports=n,n.prototype.initialize=function(e){var t=this;this.tutorialStep=new l,e.on("disconnect",function(){t.inTutorial=void 0,t.isChangingMap=!1,t.inFight=!1,t._removeListeners()}),e.fightManager.on("fightStart",function(){t.inFight=!0}),e.fightManager.on("fightEnd",function(){t.inFight=!1}),e.playerData.position.on("mapUpdate",function(){var i=e.playerData.position.subArea,n=i&&i.id===r.QUEST_TUTORIAL_FIRST_SUB_AREA_ID;t.inTutorial!==n&&(t.inTutorial=n,t.inTutorial?window.isoEngine.mapRenderer.map?t._openTutorialStepWindow():window.isoEngine.once("mapLoaded",function(){t._openTutorialStepWindow()}):t._closeTutorialWindows()),t.inTutorial?window.gui.textNotification.hide():window.gui.textNotification.show(),t.isChangingMap=!1})},n.prototype._openTutorialStepWindow=function(){this._registerListeners(),this.tutorialStep.start(),this.emit("inTutorialStateChanged",this.inTutorial)},n.prototype._closeTutorialWindows=function(){this._removeListeners(),this.tutorialStep.stop(),this.emit("inTutorialStateChanged",this.inTutorial)},n.prototype._registerListeners=function(){window.dofus.toggleTutorialListeners(!0),window.gui.on("GameMapMovementMessage",o)},n.prototype._removeListeners=function(){window.dofus.toggleTutorialListeners(!1),window.gui.removeListener("GameMapMovementMessage",o)},n.prototype._hasTutorial=function(){var e=window.gui.playerData.quests.finished;for(var t in e){var i=e[t];if(i.questId===r.QUEST_TUTORIAL_ID)return!1}return!0},n.prototype._hasValidLevel=function(){return window.gui.playerData.characterBaseInformations.level<=r.MAX_CHARACTER_LEVEL_FOR_TUTORIAL},n.prototype.isTutorialRequired=function(){var e=d.getValue("tutorialDone");if(e)return!1;for(var t=c.getCharacterList(),i=0;i<t.length;i++)if(t[i].level>r.MAX_CHARACTER_LEVEL_FOR_TUTORIAL)return d.setValue("tutorialDone",!0),!1;return!0},n.prototype.adminCommand=function(e){return e&&1===e.length&&"start"===e[0]?window.gui.tutorialManager.inTutorial?"You are already in the tutorial":(window.dofus.sendMessage("GuidedModeReturnRequestMessage"),"Done"):"Wrong parameter, allowed parameters: start"}},function(e,t){t.QUEST_TUTORIAL_ID=489,t.QUEST_TUTORIAL_FIRST_SUB_AREA_ID=536,t.TUTORIAL_MAP_ID_FIRST=81002496,t.TUTORIAL_MAP_ID_SECOND_BEFORE_FIGHT=81003520,t.TUTORIAL_MAP_ID_SECOND_AFTER_FIGHT=81003522,t.TUTORIAL_MAP_ID_THIRD_BEFORE_FIGHT=81004544,t.TUTORIAL_MAP_ID_THIRD_AFTER_FIGHT=81004546,t.MAX_CHARACTER_LEVEL_FOR_TUTORIAL=49,t.QUEST_TUTORIAL_REWARDS=[[10785,1],[10794,1],[10797,1],[10798,1],[10799,1],[10784,1],[10800,1],[10801,1],[10792,1],[10793,2],[10795,1],[10796,1]],t.FIRST_EQUIP_ITEMS=[10785],t.SECOND_EQUIP_ITEMS=[10784,10794,10797,10798,10799,10800],t.TUTORIAL_STEP_TALK_NPC_ID=1222,t.TUTORIAL_FIRST_MONSTER_ID=2785,t.TUTORIAL_BOSS_MONSTER_ID=2781,t.TUTORIAL_STEP_ROLEPLAY_MOVE_CELL_ID=272,t.TUTORIAL_STEP_CHANGE_MAP_ARROW_CELL_ID=503,t.FIGHT_LOCATION_TARGET_CELLS=[232,216,229,270,313,328,316,274],t.FIGHT_MOVE_TARGET_CELLS={232:259,216:259,229:258,270:286,313:286,328:287,316:287,274:287},t.TUTORIAL_STEP_ROLEPLAY_MOVE=1,t.TUTORIAL_STEP_TALK=2,t.TUTORIAL_SUB_STEP_TALK_SHOW_NPC=1,t.TUTORIAL_SUB_STEP_TALK_SHOW_RESPONSE=2,t.TUTORIAL_STEP_EQUIP_ITEM=3,t.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_ITEM_MENU_ICON=1,t.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_TAB=2,t.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_EQUIPMENT=3,t.TUTORIAL_STEP_CHANGE_MAP=4,t.TUTORIAL_STEP_STARTING_A_FIGHT=5,t.TUTORIAL_STEP_FIGHT_LOCATION=6,t.TUTORIAL_STEP_FIGHT_MOVE=7,t.TUTORIAL_SUB_STEP_FIGHT_MOVE_START_FIGHT=1,t.TUTORIAL_STEP_FIGHT_CAST_SPELL=8,t.TUTORIAL_STEP_FIGHT_SKIP_TURN=9,t.TUTORIAL_STEP_FIGHT_WIN=10,t.TUTORIAL_STEP_START_QUEST=11,t.TUTORIAL_STEP_EQUIP_ALL_ITEMS=12,t.TUTORIAL_STEP_FIND_BOSS=13,t.TUTORIAL_STEP_KILL_BOSS=14,t.TUTORIAL_STEP_SUCCESS_QUEST=15},function(e,t,i){function n(e,t){var i={};for(var n in t){var o=t[n].objectGID;e.indexOf(o)!==-1&&(i[o]=!0)}return Object.keys(i).length===e.length}function o(){this.initialized=!1,this.quest=null,this.currentStepId=null,this.currentStep=null,this.currentStepCount=null,this.currentSubStepCount=null,this.tutorialPopup=null}function s(){window.gui.tutorialManager.isChangingMap=!0,window.isoEngine.addArrowOnCell(u.TUTORIAL_STEP_CHANGE_MAP_ARROW_CELL_ID,0,0,"upLeft")}var a=i(172).inherits,r=i(188).EventEmitter,l=i(317),c=i(616),d=i(614),u=i(766),h=i(194),p=i(768),m=i(7),f=i(312),g=i(176),_=0;a(o,r),e.exports=o,o.prototype.start=function(){this.initialized||(this._setupHandlerFunctions(),this._setupListeners(),this.initialized=!0),window.gui.playerData.quests.initialized?this._requestQuestStatus():window.gui.playerData.quests.once("listUpdated",this._requestQuestStatus),this.tutorialPopup=new p,this.tutorialPopup.open()},o.prototype._requestQuestStatus=function(){window.dofus.sendMessage("QuestStepInfoRequestMessage",{questId:u.QUEST_TUTORIAL_ID})},o.prototype.stop=function(){this.tutorialPopup&&this.tutorialPopup.close()},o.prototype._updateSubStep=function(e){this.currentSubStepCount=e,m.logTutorialSubStep(this.currentStepCount,e-1)},o.prototype._setupHandlerFunctions=function(){function e(e){return e===u.TUTORIAL_STEP_EQUIP_ITEM||e===u.TUTORIAL_STEP_EQUIP_ALL_ITEMS}var t=this;this.movementHandler=function(e){e.actorId===window.gui.playerData.id&&(t.currentStepCount===u.TUTORIAL_STEP_ROLEPLAY_MOVE||e.isInFight&&t.currentStepCount===u.TUTORIAL_STEP_FIGHT_MOVE)&&t._validateCurrentStep()},this.itemEquippedHandler=function(e){if(t.currentStepCount===u.TUTORIAL_STEP_EQUIP_ITEM||t.currentStepCount===u.TUTORIAL_STEP_EQUIP_ALL_ITEMS){var i=t.currentStepCount===u.TUTORIAL_STEP_EQUIP_ITEM?u.FIRST_EQUIP_ITEMS:u.SECOND_EQUIP_ITEMS;e&&i.indexOf(e.objectGID)!==-1&&(m.logTutorialSubStep(t.currentStepCount,"item"+e.position),this.currentSubStepCount++),n(i,window.gui.playerData.inventory.equippedItems)&&t._validateCurrentStep()}},this.fightStartingHandler=function(){t.currentStepCount===u.TUTORIAL_STEP_STARTING_A_FIGHT||t.currentStepCount===u.TUTORIAL_STEP_FIND_BOSS?t._validateCurrentStep():t._updateHintArrow()},this.fightStartHandler=function(){t.currentStepCount===u.TUTORIAL_STEP_FIGHT_LOCATION?t._validateCurrentStep():t._updateHintArrow()},this.fightLocationHandler=function(){t.currentStepCount===u.TUTORIAL_STEP_FIGHT_LOCATION&&t._validateCurrentStep()},this.figtTurnEndHandler=function(e){t.currentStepCount===u.TUTORIAL_STEP_FIGHT_SKIP_TURN&&e.id===window.gui.playerData.id&&t._validateCurrentStep()},this.useSpellHandler=function(e){t.currentStepCount===u.TUTORIAL_STEP_FIGHT_CAST_SPELL&&e.sourceId===window.gui.playerData.id&&t._validateCurrentStep()},this.npcDialogOpenedHandler=function(){t._updateSubStep(u.TUTORIAL_SUB_STEP_TALK_SHOW_RESPONSE),t._updateHintArrow()},this.windowOpenedHandler=function(i){var n=i.id,o=t.currentStepCount;"equipment"===n&&e(o)?(t._updateSubStep(u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_TAB),t._updateHintArrow()):t._hideArrows()},this.windowClosedHandler=function(){t._updateHintArrow()},this.equipmentFilterHandler=function(i){e(t.currentStepCount)&&t.currentSubStepCount>u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_ITEM_MENU_ICON&&(i!==_?t._updateSubStep(u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_TAB):t._updateSubStep(u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_EQUIPMENT),t._updateHintArrow())},this.equippableHighlightedHandler=function(i){e(t.currentStepCount)&&t.currentSubStepCount&&c.pointToCharacterItem(i[0])},this.itemDragEndHandler=function(i,n,o){o&&"equipment"===o.source&&e(t.currentStepCount)&&t.currentSubStepCount&&t._updateHintArrow()},this.updateHintArrowHandler=this._updateHintArrow.bind(this)},o.prototype._setupListeners=function(){var e=this,t=window.gui;t.on("disconnect",function(){e.reset()}),t.playerData.quests.on("questUpdate",function(t){t===u.QUEST_TUTORIAL_ID&&e._updateDisplay()}),t.playerData.quests.on("questFinished",function(t){var i=t.questId;i===u.QUEST_TUTORIAL_ID&&(g.setValue("tutorialDone",!0,3),m.logTutorialStepEnd(15),f.trackTutorialCompleted(),e._hideArrows())}),t.tutorialManager.on("inTutorialStateChanged",function(t){t?e._registerInTutorialListeners():e._removeInTutorialListeners()})},o.prototype._registerInTutorialListeners=function(){var e=window.gui;e.on("_tutorialGameMapMovementMessage",this.movementHandler),e.playerData.inventory.on("itemMoved",this.itemEquippedHandler),e.playerData.inventory.on("itemAdded",this.itemEquippedHandler),e.on("GameFightStartingMessage",this.fightStartingHandler),e.on("_tutorialGameEntitiesDispositionMessage",this.fightLocationHandler),e.on("GameFightStartMessage",this.fightStartHandler),e.fightManager.on("GameFightTurnStart",this.fightStartHandler),e.on("GameFightTurnEndMessage",this.figtTurnEndHandler),e.on("GameActionFightSpellCastMessage",this.useSpellHandler),e.on("GameActionFightCloseCombatMessage",this.useSpellHandler),e.npcDialogUi.on("opened",this.npcDialogOpenedHandler),h.on("opened",this.windowOpenedHandler),h.on("closed",this.windowClosedHandler);var t=h.getWindow("equipment");t.on("equippableHighlighted",this.equippableHighlightedHandler),t.storageView.on("filter",this.equipmentFilterHandler),l.on("dragEnd",this.itemDragEndHandler),window.isoEngine.on("mapLoaded",this.updateHintArrowHandler),window.gui.menuBar.on("open",this.updateHintArrowHandler),window.gui.menuBar.on("close",this.updateHintArrowHandler)},o.prototype._removeInTutorialListeners=function(){var e=window.gui;e.removeListener("_tutorialGameMapMovementMessage",this.movementHandler),e.playerData.inventory.removeListener("itemMoved",this.itemEquippedHandler),e.playerData.inventory.removeListener("itemAdded",this.itemEquippedHandler),e.removeListener("GameFightStartingMessage",this.fightStartingHandler),e.removeListener("_tutorialGameEntitiesDispositionMessage",this.fightLocationHandler),e.removeListener("GameFightStartMessage",this.fightStartHandler),e.fightManager.removeListener("GameFightTurnStart",this.fightStartHandler),e.removeListener("GameFightTurnEndMessage",this.figtTurnEndHandler),e.removeListener("GameActionFightSpellCastMessage",this.useSpellHandler),e.removeListener("GameActionFightCloseCombatMessage",this.useSpellHandler),e.npcDialogUi.removeListener("opened",this.npcDialogOpenedHandler),h.removeListener("opened",this.windowOpenedHandler),h.removeListener("closed",this.windowClosedHandler);var t=h.getWindow("equipment");t.removeListener("equippableHighlighted",this.equippableHighlightedHandler),t.storageView.removeListener("filter",this.equipmentFilterHandler),l.removeListener("dragEnd",this.itemDragEndHandler),window.isoEngine.removeListener("mapLoaded",this.updateHintArrowHandler),window.gui.menuBar.removeListener("open",this.updateHintArrowHandler),window.gui.menuBar.removeListener("close",this.updateHintArrowHandler)},o.prototype._validateCurrentStep=function(){if(this.currentStep){for(var e=this.currentStep.questId,t=this.currentStep.objectiveIds,i=0;i<t.length;i+=1)window.dofus.sendMessage("QuestObjectiveValidationMessage",{questId:e,objectiveId:t[i]});this._hideArrows(),m.logTutorialSubStep(this.currentStepCount,this.currentSubStepCount),this.currentSubStepCount=null}},o.prototype._hideArrows=function(){window.gui.hintArrow.hideArrow(),window.isoEngine.removeArrows()},o.prototype.reset=function(){this.quest=null,this.currentStepId=null,this.currentStep=null,this.currentStepCount=null,this.currentSubStepCount=null,this.tutorialPopup.setContent(""),this.tutorialPopup.hide(),this._hideArrows(),window.gui.shortcutBar.setAvailability(!0),window.gui.timeline.fightControlButtons.setTurnReadyButtonAvailability(!0),window.gui.tutorialManager.inTutorial&&this._removeInTutorialListeners()},o.prototype._shouldSkipFightLocationStep=function(){var e=window.gui.fightManager,t=e.FIGHT_STATES;return e.fightState===t.BATTLE&&this.currentStepCount===u.TUTORIAL_STEP_FIGHT_LOCATION},o.prototype._shouldSkipEquipItemsStep=function(){if(this.currentStepCount===u.TUTORIAL_STEP_EQUIP_ITEM||this.currentStepCount===u.TUTORIAL_STEP_EQUIP_ALL_ITEMS){var e=this.currentStepCount===u.TUTORIAL_STEP_EQUIP_ITEM?u.FIRST_EQUIP_ITEMS:u.SECOND_EQUIP_ITEMS;return!n(e,window.gui.playerData.inventory.objects)}},o.prototype._updateDisplay=function(){var e=!1;this.currentStepCount&&(m.logTutorialSubStep(this.currentStepCount,this.currentSubStepCount),m.logTutorialStepEnd(this.currentStepCount),e=!0);var t=u.QUEST_TUTORIAL_ID,i=window.gui.playerData.quests||{},n=i.active||{},o=n[t];return o?(this.quest=o,this.currentStepId=o.stepId,this.currentStep=o.dbSteps[this.currentStepId],this.currentStepCount=o.dbQuest.stepIds.indexOf(this.currentStepId)+1,e||m.log("F_T_U_E.Step0300_Enter_Tuto"),m.logTutorialStepStart(this.currentStepCount),this._updateSubStep(1),this._shouldSkipFightLocationStep()||this._shouldSkipEquipItemsStep()?this._validateCurrentStep():(this._handleMenuBarDisplay(),this._updateStepDescription(),void this._updateHintArrow())):void console.error("TutorialStep: Cannot find quest data with questId: "+t)},o.prototype._handleMenuBarDisplay=function(){var e=this.currentStepCount;e>=u.TUTORIAL_STEP_EQUIP_ITEM&&window.gui.uiLocker.unlockFeature("inventory","tutorial")},o.prototype._updateStepDescription=function(){this.tutorialPopup.setContent(d.process(this.currentStep.descriptionId))},o.prototype._pointToMonsterCheck=function(){window.gui.playerData.isFighting||window.isoEngine.addArrowOnMonster(this.currentStepCount>=u.TUTORIAL_STEP_FIND_BOSS?u.TUTORIAL_BOSS_MONSTER_ID:u.TUTORIAL_FIRST_MONSTER_ID)},o.prototype._handleHintArrow=function(){if(this._hideArrows(),window.gui.shortcutBar.setAvailability(!0),window.gui.timeline.fightControlButtons.setTurnReadyButtonAvailability(!0),this.currentStepCount)switch(this.currentStepCount){case u.TUTORIAL_STEP_ROLEPLAY_MOVE:window.isoEngine.addArrowOnCell(u.TUTORIAL_STEP_ROLEPLAY_MOVE_CELL_ID,0,0,"upLeft");break;case u.TUTORIAL_STEP_TALK:case u.TUTORIAL_STEP_START_QUEST:case u.TUTORIAL_STEP_SUCCESS_QUEST:this.currentSubStepCount===u.TUTORIAL_SUB_STEP_TALK_SHOW_NPC?window.isoEngine.addArrowOnNpc(u.TUTORIAL_STEP_TALK_NPC_ID):this.currentSubStepCount===u.TUTORIAL_SUB_STEP_TALK_SHOW_RESPONSE&&c.pointToNpcAnswer(0);break;case u.TUTORIAL_STEP_EQUIP_ITEM:case u.TUTORIAL_STEP_EQUIP_ALL_ITEMS:switch(this.currentSubStepCount){
case u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_ITEM_MENU_ICON:c.pointToMenuIcon("Bag");break;case u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_TAB:c.pointToEquipFilterIcon();break;case u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_EQUIPMENT:c.pointToStorageFirstSlotBox()}break;case u.TUTORIAL_STEP_CHANGE_MAP:c.pointToWindowCloseButton("equipment"),h.getWindow("equipment").openState||s();break;case u.TUTORIAL_STEP_STARTING_A_FIGHT:this._pointToMonsterCheck();break;case u.TUTORIAL_STEP_FIGHT_LOCATION:this._pointToMonsterCheck(),window.foreground.tapOptions&&"fightPlacement"===window.foreground.tapOptions.mode&&window.isoEngine.addArrowsSequence(u.FIGHT_LOCATION_TARGET_CELLS);break;case u.TUTORIAL_STEP_FIGHT_MOVE:if(this._pointToMonsterCheck(),window.foreground.tapOptions)if("fightPlacement"===window.foreground.tapOptions.mode)c.pointToTimelineButton("fightReadyBtn");else if("fight"===window.foreground.tapOptions.mode){var e=window.gui.playerData.id,t=window.gui.fightManager,i=t.currentFighterId,n=t.getFighter(e);if(!n)return console.error("Tutorial step fight move failed, fighter does not exist");if(i===e){var o=u.FIGHT_MOVE_TARGET_CELLS[n.data.disposition.cellId];window.isoEngine.addArrowOnCell(o)}window.gui.shortcutBar.setAvailability(!1),window.gui.timeline.fightControlButtons.setTurnReadyButtonAvailability(!1)}break;case u.TUTORIAL_STEP_FIGHT_CAST_SPELL:this._pointToMonsterCheck(),window.gui.playerData.isFighting&&c.pointToFirstSkillShortcut();break;case u.TUTORIAL_STEP_FIGHT_SKIP_TURN:this._pointToMonsterCheck(),c.pointToTimelineButton("turnReadyBtn");break;case u.TUTORIAL_STEP_FIND_BOSS:this._pointToMonsterCheck(),c.pointToWindowCloseButton("equipment"),h.getWindow("equipment").openState||window.gui.playerData.position.mapId!==u.TUTORIAL_MAP_ID_SECOND_AFTER_FIGHT||s()}},o.prototype._updateHintArrow=function(){var e=this;setTimeout(function(){e._handleHintArrow()},0)}},function(e,t,i){function n(e){r.call(this,"div",e),this.addClassNames("tutorialPopup"),this.appendChild(new r("div",{className:"tutorialPopupTitle",text:s("tablet.joris")})),this.content=this.appendChild(new r("div",{className:"tutorialPopupContent"})),this.appendChild(new r("div",{className:"joris"}))}var o=i(166).dimensions,s=i(29).getText,a=i(172).inherits,r=i(321);i(769),a(n,r),e.exports=n,n.prototype.setContent=function(e){this.content.clearContent(),e instanceof r?this.content.appendChild(e):this.content.setText(e),this.show()},n.prototype.open=function(){this.setStyle("bottom",o.screenHeight-o.mapHeight+7+"px"),this.hide(),window.gui.windowsContainer.appendChild(this)},n.prototype.close=function(){this.hide()}},function(e,t){},function(e,t,i){function n(e){return e=e||"",e.split(",")[0]}function o(e){var t=S[e];if(t){for(var i=C[e],o=n(i.trigger),s=I[o],a=s.eventsList||[],r=0;r<a.length;r+=1){var l=a[r];l.listener.removeListener(l.eventId,t)}delete S[e]}}function s(){for(var e=Object.keys(S),t=0;t<e.length;t+=1){var i=e[t];o(i)}}function a(){s();for(var e=0;e<E.length;e+=1)window.gui.notificationBar.removeNotification(E[e]);E=[]}function r(e){var t=E.indexOf(e);t>=0&&E.splice(t,1)}function l(e){var t=e.id,i="tip"+t,n=window.gui.notificationBar;if(!n.isNotificationOpen(i)&&!A[t]){var s={type:n.notificationType.TUTORIAL,title:e.titleId,wuidom:b.process(e.messageId),onClose:function(){window.dofus.sendMessage("NotificationUpdateFlagMessage",{index:t}),A[t]=!0,r(i)}};n.newNotification(i,s),E.push(i),o(t)}}function c(){for(var e in C){var t=C[e],i=n(t.trigger),o=I[i];if(i&&o&&!A[e])if("GameStart"!==i)for(var s=o.eventsList||[],a=0;a<s.length;a+=1){var r=s[a],c=r.listener,d=r.eventId;if(!S[e]){var u=o.customFunc||l;S[e]=u.bind(null,t)}var h=S[e];c.on(d,h)}else l(t)}}function d(){setTimeout(function(){c()},0)}function u(e,t){for(var i=t.results||[],n=0;n<i.length;n+=1){var o=i[n];if(o.id===window.gui.playerData.id&&o.outcome===v.RESULT_VICTORY)return l(e)}}function h(e,t){for(var i=t.actors||[],n=0;n<i.length;n+=1)if("GameRolePlayGroupMonsterInformations"===i[n]._type)return l(e)}function p(e,t){t.actorId===window.gui.playerData.id&&l(e)}function m(){var e=window.gui,t=e.playerData,i=T.getWindow("grimoire");I={CharacterLevelUp:{eventsList:[{listener:t,eventId:"characterLevelUp"}]},FightResultVictory:{customFunc:u,eventsList:[{listener:e,eventId:"GameFightEndMessage"}]},FightSpellCast:{eventsList:[{listener:e,eventId:"GameActionFightSpellCastMessage"},{listener:e,eventId:"GameActionFightCloseCombatMessage"}]},GameFightStart:{eventsList:[{listener:e,eventId:"GameFightStartMessage"}]},GameFightStarting:{eventsList:[{listener:e,eventId:"GameFightStartingMessage"}]},GameRolePlayPlayerLifeStatus:{eventsList:[{listener:e,eventId:"GameRolePlayPlayerLifeStatusMessage"}]},GameStart:{},LifePointsRegenBegin:{eventsList:[{listener:e,eventId:"LifePointsRegenBeginMessage"}]},MapWithMonsters:{customFunc:h,eventsList:[{listener:e,eventId:"MapComplementaryInformationsDataMessage"}]},NpcDialogCreation:{eventsList:[{listener:e,eventId:"NpcDialogCreationMessage"}]},OpenBook:{eventsList:[{listener:i,eventId:"open"}]},OpenGrimoireAlignmentTab:{eventsList:[{listener:i.tabs.getTabTarget("alignment"),eventId:"open"}]},OpenGrimoireJobTab:{eventsList:[{listener:i.tabs.getTabTarget("jobs"),eventId:"open"}]},OpenGrimoireQuestTab:{eventsList:[{listener:i.tabs.getTabTarget("quests"),eventId:"open"}]},OpenGrimoireSpellTab:{eventsList:[{listener:i.tabs.getTabTarget("spells"),eventId:"open"}]},OpenInventory:{eventsList:[{listener:T.getWindow("equipment"),eventId:"open"}]},OpenStats:{eventsList:[{listener:T.getWindow("characteristics"),eventId:"open"}]},PlayerFightMove:{customFunc:p,eventsList:[{listener:e,eventId:"GameMapMovementMessage"}]},PlayerIsDead:{eventsList:[{listener:t,eventId:"playerIsDead"}]},PlayerMove:{customFunc:p,eventsList:[{listener:window.dofus,eventId:"GameMapMovementMessage"}]},PlayerNewSpell:{eventsList:[{listener:t.characters.mainCharacter,eventId:"newSpellLearned"}]}}}function f(e){M.getAllDataMap("Notifications",function(t,i){return t?e(t):(C=i,void e())})}function g(e){f(function(t){return t?e(t):(m(),void e())})}function _(e){A={};for(var t=0;t<e.length;t+=1)for(var i=e[t],n=0;n<32;n+=1)A[n+32*t]=!!(1&i),i>>=1}var v=i(771),y=i(171),b=i(614),M=i(30),w=i(176),T=i(194),C={},A={},I={},S={},E=[],x=!0,N=!1;t.initialize=function(e){e.once("initialized",function(){x=w.getValue("option-tutorialTips",!0),y.on("tutorialTips",function(e){t.enableTips(e)}),g(function(e){if(e)return console.error(e)})}),e.tutorialManager.on("inTutorialStateChanged",function(e){N=e,N?(a(),window.gui.notificationBar.clearNotifications()):x&&!N&&d()}),e.on("disconnect",function(){a(),N=!1}),e.on("NotificationListMessage",function(e){_(e.flags)})},t.enableTips=function(e){x=e,N||(x?d():a())},t.resetTips=function(){window.dofus.sendMessage("NotificationResetMessage"),_([0]),x&&!N&&(a(),d())}},function(e,t){e.exports={RESULT_LOST:0,RESULT_DRAW:1,RESULT_VICTORY:2,RESULT_TAX:5,RESULT_DEFENDER_GROUP:6}},function(e,t,i){function n(e){a.call(this,"div",{className:"RoleplayBuffs"}),l(this),this.slotList={},this._createDom(),this._setupListeners(e),this.hide()}function o(e){return e.position===u.INVENTORY_POSITION_MUTATION||e.position===u.INVENTORY_POSITION_BOOST_FOOD||e.position===u.INVENTORY_POSITION_FIRST_BONUS||e.position===u.INVENTORY_POSITION_SECOND_BONUS||e.position===u.INVENTORY_POSITION_FIRST_MALUS||e.position===u.INVENTORY_POSITION_SECOND_MALUS||e.position===u.INVENTORY_POSITION_ROLEPLAY_BUFFER||e.position===u.INVENTORY_POSITION_FOLLOWER}i(773);var s=i(172).inherits,a=i(321),r=i(737),l=i(598),c=i(352).isEmptyObject,d=i(166).dimensions,u=i(774);s(n,a),e.exports=n,n.prototype._setupListeners=function(e){var t=this;window.gui.on("connected",function(){t.setStyle("left",~~(d.mapWidth/2)+d.mapLeft+"px"),t.setStyle("top",d.mapTop+"px")}),e.on("listUpdate",function(e){t._unloadContent();for(var i in e)t._addItem(e[i])}),e.on("unloaded",function(){t._unloadContent()}),e.on("itemAdded",function(e){t._addItem(e)}),e.on("itemsAdded",function(e){for(var i in e)t._addItem(e[i])}),e.on("itemDeleted",function(e){t._removeItem(e)}),e.on("itemsDeleted",function(e){for(var i in e)t._removeItem(e[i])}),e.on("itemModified",function(e){t._modifyItem(e)})},n.prototype._createDom=function(){this.slotBox=this.createChild("div",{className:"slotBox"})},n.prototype._addItem=function(e){if(o(e)){var t=e.objectUID,i=this.slotList[t];i||(i=this.slotList[t]=new r({itemData:e,enableContextMenu:!1,descriptionOptions:{averagePrice:!1,showCategory:!1,showWeight:!1}}),this.slotBox.appendChild(i),this.show(),this.emit("resized"))}},n.prototype._removeItem=function(e){var t=this.slotList[e];t&&(t.destroy(),delete this.slotList[e],c(this.slotList)&&this.hide(),this.emit("resized"))},n.prototype._modifyItem=function(e){this._removeItem(e.objectUID),this._addItem(e)},n.prototype._unloadContent=function(){this.slotList={},this.slotBox.clearContent(),this.hide()}},function(e,t){},function(e,t){e.exports={ACCESSORY_POSITION_HAT:6,ACCESSORY_POSITION_CAPE:7,ACCESSORY_POSITION_BELT:3,ACCESSORY_POSITION_BOOTS:5,ACCESSORY_POSITION_AMULET:0,ACCESSORY_POSITION_SHIELD:15,ACCESSORY_POSITION_WEAPON:1,ACCESSORY_POSITION_PETS:8,INVENTORY_POSITION_RING_LEFT:2,INVENTORY_POSITION_RING_RIGHT:4,INVENTORY_POSITION_DOFUS_1:9,INVENTORY_POSITION_DOFUS_2:10,INVENTORY_POSITION_DOFUS_3:11,INVENTORY_POSITION_DOFUS_4:12,INVENTORY_POSITION_DOFUS_5:13,INVENTORY_POSITION_DOFUS_6:14,INVENTORY_POSITION_MOUNT:16,INVENTORY_POSITION_MUTATION:20,INVENTORY_POSITION_BOOST_FOOD:21,INVENTORY_POSITION_FIRST_BONUS:22,INVENTORY_POSITION_SECOND_BONUS:23,INVENTORY_POSITION_FIRST_MALUS:24,INVENTORY_POSITION_SECOND_MALUS:25,INVENTORY_POSITION_ROLEPLAY_BUFFER:26,INVENTORY_POSITION_FOLLOWER:27,INVENTORY_POSITION_NOT_EQUIPED:63}},function(e,t,i){function n(){h=window.gui,p=window.isoEngine,h.playerData.on("characterSelectedSuccess",o)}function o(){y&&r()&&(p.on("mapLoaded",s),h.once("disconnect",a))}function s(){return h.playerData.position.removeListener("worldMapUpdate",s),h.tutorialManager.removeListener("inTutorialStateChanged",s),0===h.playerData.position.worldmapId?void h.playerData.position.once("worldMapUpdate",s):void 0===h.tutorialManager.inTutorial?void h.tutorialManager.once("inTutorialStateChanged",s):void(l()&&(p.removeListener("mapLoaded",s),f.initialize(),g.initialize(),_.initialize()))}function a(){p.removeListener("mapLoaded",s),h.playerData.position.removeListener("worldMapUpdate",s),h.tutorialManager.removeListener("inTutorialStateChanged",s),b=!1}function r(){return h.playerData.characterBaseInformations.level<=v.characterLevelLimit}function l(e){return!h.tutorialManager.inTutorial&&(!!(!m.isFightMode||e&&e.fightContextAllowed)&&(h.playerData.position.worldmapId!==v.INCARNAM_WORLD_MAP?b:h.playerData.characterBaseInformations.level>v.characterLevelLimit?b:(b=!0,!0)))}function c(e){b=e}function d(){a(),f.removeAndClean(),g.removeAndClean(),_.removeAndClean()}function u(e){var t="Wrong parameter, allowed parameters are: on, ui reset, ui unlock, trigger reset";if(!e)return t;if(1===e.length&&"on"===e[0])return y?"Already activated":(y=!0,o(),"Activated");if(2===e.length)if("ui"===e[0]){if("reset"===e[1])return _.reset(),"Done";if("unlock"===e[1])return _.unlockAll(),"Done"}else if("trigger"===e[0]&&"reset"===e[1])return g.reset(),"Done";return t}i(776);var h,p,m=i(258),f=i(777),g=i(796),_=i(797),v=i(795),y=!0,b=!1;t.initialize=n,t.isBeginnerAssistantRequired=l,t.adminCommand=u,t.openDialog=g.openDialog,t.setRequired=c,t.removeAndClean=d},function(e,t){},function(e,t,i){function n(e){return Math.floor(Math.random()*e.length)}function o(e){return e[n(e)]}function s(e){return!(!e&&0!==e)&&(e>=0&&e<=559)}function a(e){var t=e+28;return s(t)?t:null}function r(e){var t=e-28;return s(t)?t:null}function l(e){for(var t,i,n=e.length;0!==n;)i=Math.floor(Math.random()*n),n-=1,t=e[n],e[n]=e[i],e[i]=t;return e}function c(){return me===Le.NOT_CREATED?null:ce}function d(){ce&&ce.refreshAnimation()}function u(){ae=window.isoEngine,re=window.actorManager,le=window.gui,me=Le.NOT_CREATED,be={transitionning:!1,mapSide:null},ae.on("mapLoaded",h),ae.on("launchMapTransition",ie),ae.on("cancelMapTransition",ne),le.once("disconnect",p),h()}function h(e){Te.isBeginnerAssistantRequired()&&(e&&e.isReload&&ce&&me!==Le.NOT_CREATED||(be.transitionning=!1,be.mapSide=null,ve={},ye={},_e=!1,P()))}function p(){ae.removeListener("mapLoaded",h),ae.removeListener("launchMapTransition",ie),ae.removeListener("cancelMapTransition",ne)}function m(){p()}function f(e,t){return t=t||1,e<28*t}function g(e,t){return t=t||1,e>559-28*t}function _(e,t){t=t||1;var i=e%14;return i<t}function v(e,t){t=t||1;var i=e%14;return i>13-t}function y(e,t){return _(e,t)||v(e,t)||f(e,t)||g(e,t)}function b(e){var t=a(e);return!!re.occupiedCells[t]}function M(e){var t=r(e);return!!re.occupiedCells[t]}function w(e){var t=r(e),i=Se.exits[le.playerData.position.mapId];if(!i||!i.length)return!1;for(var n=0;n<i.length;n++){var o=i[n],s=null;if("tile"===o.target)s=o.targetId;else if("interactive"===o.type){var a=ae.mapRenderer.identifiedElements[o.targetId];a&&void 0!==a._position&&null!==a._position&&(s=a._position)}if(null!==s&&(e===s||t===s))return!0}return!1}function T(e,t){var i;t||(i={front:!1,behind:!1});var n=a(e),o=r(e),s=ae.mapRenderer.interactiveElements,l=ae.mapRenderer.identifiedElements;for(var c in s)if(l[c]&&void 0!==l[c]._position){if(l[c]._position===n){if(t)return!0;i.front=!0}if(l[c]._position===o){if(t)return!0;i.behind=!0}}return i}function C(e){if(!ae.mapRenderer.isVisibleCell(e))return!1;var t=r(e);return!!s(t)&&ae.mapRenderer.isVisibleCell(t)}function A(e,t,i){t=t||(i?0:1);for(var n=[],o=Ie.getMapPointFromCellId(e),s=o.x-t,a=o.x+t,r=o.y-t,l=o.y+t,c=r;c<=l;c++)for(var d=s;d<=a;d++)if(d!==o.x||c!==o.y||i){var u=Ie.getCellIdFromMapPoint(d,c);u&&n.push(u)}return n}function I(e){if(!s(e)||0===ve[e]||re.occupiedCells[e])return 0;var t=Be;if(void 0!==ve[e])t=ve[e];else{if(!ae.mapRenderer.isWalkable(e))return ve[e]=0,0;C(e)||(t-=25),y(e,1)&&(t-=3),y(e,2)&&(t-=2),y(e,3)&&(t-=1),w(e)&&(t-=30);var i=T(e);i.front&&(t-=15),i.behind&&(t-=10),ve[e]=t}return b(e)&&(t-=15),M(e)&&(t-=15),t}function S(e,t){if(!s(e)||ye[e]===!1)return!1;if(re.occupiedCells[e]){if(re.occupiedCells[e].length>1)return!1;if(!ce||ce.cellId!==e)return!1}var i=!0;return!(void 0===ye[e]&&((!ae.mapRenderer.isWalkable(e)||!C(e)||t&&y(e,2)||w(e)||T(e,!0))&&(i=!1),ye[e]=i,!i))&&((b(e)||M(e))&&(i=!1),i)}function E(e,t){for(var i,n=1,s=[],a=0;a<e.length;a++)i=I(e[a]),i>n&&(n=i,s=[]),i===n&&s.push(e[a]);return 0===s.length?null:t?s:o(s)}function x(e,t,i){var n=A(e,t,i);if(0===n.length)return null;var s=E(n,!0);return s&&0!==s.length||(s=n),o(s)}function N(e,t,i){for(var n=0;n<=t;n++)if(0!==n||i){var o=A(e,n,i);if(0!==o.length){var a=E(o);if(s(a))return a}}return null}function L(){ce=null,me=Le.NOT_CREATED,ge=null}function O(){ke.emit("removed"),L()}function D(){O(),Ce.prototype.remove.call(this)}function R(e,t,i){var n={contextualId:"beginnerAssistant",look:{bonesId:Ee,scales:[100],skins:[]},disposition:{cellId:e,direction:t},name:"Joris",_type:"BeginnerAssistant"};re.addActor(n,function(t){return t?(ce=t,ce.remove=D,ce.setCellPosition(e),re.addAnimBehaviourToActor(ce.actorId,G),me=Le.CREATED,void i()):i(new Error("Unable to create the beginner assistant actor"))})}function P(){if(ce||me!==Le.NOT_CREATED){if(Me===le.playerData.position.mapId)return console.error(new Error("Beginner assistant deploy: actor is already loaded"));console.error(new Error("Beginner assistant deploy: actor is already loaded but map has changed. Will re-create it for seemless user experience but this should not happen.")),O()}var e=de=re.userActor.position,t=Ie.getMapPointFromCellId(e),i=y(e,2),n=re.userActor.direction,o=null;if(i){var a=[];if(_(e,2))a.push({x:-1,y:1}),a.push({x:1,y:-1}),n=1;else if(v(e,2))a.push({x:-1,y:1}),a.push({x:1,y:-1}),n=3;else if(f(e,2))a.push({x:-1,y:-1}),a.push({x:1,y:1}),n=Math.random()>.5?3:1;else{if(!g(e,2))return console.error(new Error("player seems to be on map border but unable to determine which one"));a.push({x:-1,y:-1}),a.push({x:1,y:1}),n=Math.random()>.5?5:7}for(var r=0;r<a.length;r++){var l=Ie.getCellIdFromMapPoint(t.x+a[r].x,t.y+a[r].y);if(S(l,!1)){o=l;break}}s(o)||(o=N(e,7))}else o=N(e,7);return s(o)?void R(o,n,function(e){return e?console.error(e):i?(me=Le.MAP_TRANSITION_ENTER,void ae.makeActorWalkIn(ce,300,function(){fe=Date.now()+3e3,me=Le.WAITING_PLAYER,d(),ke.emit("actorStopped"),ke.emit("actorReady")})):(fe=Date.now()+k(),me=Le.IDLE,d(),ke.emit("actorStopped"),void ke.emit("actorReady"))}):console.error(new Error("Unable to deploy beginner assistant near the player"))}function B(){ce.setCellPosition(ce.position)}function k(){return De+Math.floor(Math.random()*Re)}function z(e){return(he!==e||!ue||void 0===pe||pe>=ue.length)&&(he=e,ue=Ne[e],pe=0,l(ue)),ue[pe++]}function F(){return re.userActor.moving&&y(re.userActor.cellId,1)}function H(){return y(re.userActor.cellId)}function q(){return ce?Ie.getDistance(ce.position,re.userActor.position):console.error(new Error("Beginner assistant visualDistanceFromUser: no actor available"))}function W(){return re.occupiedCells[ce.cellId].length>1}function U(){return me===Le.IDLE||me===Le.WAITING_PLAYER||me===Le.WAITING_FOR_PLAYER_EXIT}function G(){if(me!==Le.CREATED&&!_e){var e=Date.now()>fe,t=F();if(me===Le.WAITING_PLAYER){var i=de!==re.userActor.position;i?t?X():V():W()?J():e&&Y()}else if(me===Le.IDLE&&t)X();else if(me===Le.IDLE&&e){var n=Math.random()<Pe?"pose":"move";"pose"===n&&($()&&!W()&&S(ce.cellId)||(n="move")),"pose"===n?K():J()}else me!==Le.MOVING_TO_EXIT||t?W()&&U()?J():me!==Le.WAITING_FOR_PLAYER_EXIT||t||H()?e&&(fe=Date.now()+k()):(me=Le.IDLE,fe=Date.now()+k()):Q()}}function j(){return be.transitionning&&me!==Le.MAP_TRANSITION_EXIT?oe():(fe=Date.now()+k(),me=Le.IDLE,void ke.emit("actorStopped"))}function Y(){me=Le.WAITING_PLAYER_POSE,fe=1/0;var e=Z(),t=z("ENTERED_MAP_ANIMS");ce.setDisposition(ce.position,e),se(t,e,function(){ce&&(fe=Date.now()+k(),me=Le.WAITING_PLAYER,ke.emit("actorStopped"))})}function V(e){me=Le.FIRST_MOVEMENT;var t=x(re.userActor.cellId,3,!1,!0);if(null===t)return j();var i=Ae.getPath(ce.cellId,t,re.occupiedCells,!0);return 0===i.length?j():(t=i[i.length-1],ce.setCellPosition(t),ge=i,ce.speedAdjust=Oe,void ce.setPath(i,{cb:function(){if(ce)return ce.speedAdjust=0,ge=null,ce.position===t||(B(),e)?be.transitionning&&me!==Le.MAP_TRANSITION_EXIT?oe():void j():V(!0)}}))}function X(e){me=Le.MOVING_TO_EXIT,fe=1/0;var t=N(re.userActor.cellId,3,!1);if(!s(t))return void(me=Le.WAITING_FOR_PLAYER_EXIT);var i=Ae.getPath(ce.cellId,t,re.occupiedCells,!0);return 0===i.length?void(me=Le.WAITING_FOR_PLAYER_EXIT):(t=i[i.length-1],ce.setCellPosition(t),ge=i,ce.speedAdjust=Oe,void ce.setPath(i,{cb:function(){if(ce&&(ce.speedAdjust=0,me===Le.MOVING_TO_EXIT)){if(ge=null,ce.position!==t)return B(),void(e||X(!0));if(be.transitionning&&me!==Le.MAP_TRANSITION_EXIT)return oe();me=Le.WAITING_FOR_PLAYER_EXIT,fe=Date.now()+k()}}}))}function Q(e){if(ge){ce.speedAdjust=0;var t=ge.indexOf(ce.position);if(t!==-1){var i=ge[t+1];s(i)&&(B(),me=Le.MOVING_CANCEL,ce.cancelMovement(function(){ce&&(ge=null,j(),e&&e())}))}}}function K(){me=Le.IDLE_POSE,fe=1/0;var e=Z(),t=z("IDLE_ANIMS");ce.setDisposition(ce.position,e),se(t,e,function(){ce&&j()})}function J(){me=Le.IDLE_MOVE,fe=1/0;var e=x(ce.cellId,3,!1,!0);if(!s(e))return j();var t=Ae.getPath(ce.cellId,e,re.occupiedCells,!0);return 0===t.length?j():(e=t[t.length-1],ce.setCellPosition(e),ge=t,ce.speedAdjust=0,void ce.setPath(t,{forceWalk:!0,cb:function(){if(ce)return ge=null,ce.position!==e&&B(),be.transitionning&&me!==Le.MAP_TRANSITION_EXIT?oe():void j()}}))}function Z(){var e=ce.direction;return 5===e||4===e?e=3:7===e||0===e?e=1:6!==e&&2!==e||(e=Math.random()>.5?3:1),e}function $(){return 3===ce.direction||1===ce.direction||2===ce.direction}function ee(){_e=!0}function te(e){fe=Date.now()+(e||0),_e=!1}function ie(e){Me=le.playerData.position.mapId,ce&&!_e&&(be.mapSide=e,be.transitionning=!0,U()&&oe())}function ne(e){ce&&!_e&&(be.transitionning=!1,be.mapSide=null,me=Le.MAP_TRANSITION_EXIT,ae.makeActorWalkInDirection(ce,e,!0,function(){ce&&j()}))}function oe(){if(ce&&!_e&&be.transitionning&&me!==Le.MAP_TRANSITION_EXIT){if(q()>3)return void X();me=Le.MAP_TRANSITION_EXIT,ae.makeActorWalkInDirection(ce,be.mapSide,!1)}}function se(e,t,i){var n={base:xe[e],direction:t},o=ce;ce.animManager.addAnimation(n,function(){ce&&ce===o&&ce.animManager.assignSymbol(n,!1,function(){ce&&ce===o&&(ce.staticAnim(),ce.animManager.cleanupAnimations(),i&&i())})})}var ae,re,le,ce,de,ue,he,pe,me,fe,ge,_e,ve,ye,be,Me,we=i(188).EventEmitter,Te=i(775),Ce=i(778),Ae=i(793),Ie=i(794),Se=i(795),Ee=3192,xe={HandWave:"AnimAttaque1",LookOnFloor:"AnimAttaque2",LookAround:"AnimAttaque3",AirPunchs:"AnimAttaque4",Jump:"AnimAttaque5",LetsGo:"AnimAttaque6",CrossedArms:"AnimAttaque7",GoRight:"AnimAttaque8",GoLeft:"AnimAttaque9",HeadAttack:"AnimAttaque10",JumpAndFlash:"AnimHit",JumpAndSmoke:"AnimMort"},Ne={IDLE_ANIMS:["LookOnFloor","LookAround","LookAround","AirPunchs","CrossedArms","GoRight","GoLeft","HandWave","Jump"],ENTERED_MAP_ANIMS:["LetsGo","LetsGo","LetsGo","LetsGo","AirPunchs","AirPunchs","CrossedArms","LookAround"]},Le={NOT_CREATED:0,CREATED:1,WAITING_PLAYER:2,WAITING_PLAYER_POSE:3,FIRST_MOVEMENT:4,IDLE:5,IDLE_POSE:6,IDLE_MOVE:7,MOVING_TO_EXIT:8,WAITING_FOR_PLAYER_EXIT:9,MOVING_CANCEL:10,MAP_TRANSITION_EXIT:11,MAP_TRANSITION_ENTER:12},Oe=8,De=3e3,Re=4e3,Pe=.75,Be=1e3,ke=new we;t.initialize=u,t.stopMoving=Q,t.freeze=ee,t.unfreeze=te,t.getActor=c,t.setAnimation=se,t.removeAndClean=m,t.on=ke.on.bind(ke),t.once=ke.once.bind(ke),t.removeListener=ke.removeListener.bind(ke)},function(e,t,i){i(779),i(781),i(782),i(783),i(784),i(785),i(786),i(787),e.exports=i(780)},function(e,t,i){var n=i(780),o=i(167),s=o.ANIM_SYMBOLS;n.prototype.getAnimSymbol=function(e,t){return t||0===t||(t=this.direction),{id:e+"_"+s[t],base:e,direction:t}},n.prototype.finalizeAnimationSymbol=function(e){e.direction||0===e.direction||(e.direction=this.direction)},n.prototype.loadAndPlayAnimation=function(e,t,i){function n(){t?o.loopAnim(e,i):o.oneShootAnim(e,!1,i)}var o=this;this.finalizeAnimationSymbol(e),this.animManager.addAnimation(e,n)},n.prototype.staticAnim=function(){this.animSymbol=this.getAnimSymbol("AnimStatique"),this.animManager.assignSymbol(this.animSymbol,!1),this.animated=!1},n.prototype.loopAnim=function(e,t){this.animSymbol=e,this.animated=!0,this.animManager.assignSymbol(e,!0,t)},n.prototype.oneShootAnim=function(e,t,i){var n=this;this.finalizeAnimationSymbol(e),this.animSymbol=e,this.animated=!0,this.animManager.assignSymbol(e,!1,function(){return t&&n.staticAnim(),n.animated=!1,i&&i()})},n.prototype.cleanupAnimations=function(){this.animManager.cleanupAnimations()},n.prototype.death=function(e){var t=this;this.moving&&(console.warn("kill a moving actor"),this.pathTween.stop()),this.animated&&console.warn("kill an animated actor");var i=this.getAnimSymbol("AnimMort");this.animSymbol=i,this.animated=!0,t.actorManager.userActor===this&&this.animManager.cleanupAnimationsAndRemoveSubentities(),this.isDead=!0,this.animManager.assignSymbol(i,!1,function(){return t.animated=!1,t.fighterIndicator&&t.fighterIndicator.remove(),t.removeTeamCircle(),t.actorManager.removeActor(t.actorId),e&&e()})},n.prototype.testAnimation=function(e,t){var i=e.animationString,n=e.direction,o=this.getAnimSymbol(i,n);this.animSymbol=o;var s=this;this.animManager.addAnimation(o,function(){s.animated=!0,s.animManager.addAnimation(o,function(){s.animManager.assignSymbol(o,!0),t(s.animManager.template.hasAnimation(o.id)?"playing: "+o.id:"animation not found: "+o.id)})})}},function(e,t,i){function n(e){e=e||{},e.data=e.data||{},r.call(this,e),this.actorId=void 0!==e.actorId?e.actorId:null,this.cellId=null,this._step=0,this.path=[],this.moving=!1,this.animated=!1,this.speedAdjust=0,this.tints=null,this.data={},this.groupBoss=null,this.isInvisible=!1,this.followers=null,this.isFollower=!1,this.isLocked=!1,this.isRiding=!1,this.isDead=!1,this.canMoveDiagonally=!0,this.isolationCoefficient=0,this.pathTween=new s(this,["step"]),this.riderEntity=null,this.carriedActor=null,this.carriedEntity=null,this.parentActor=null,this.circleGraphic=null,this.icons={},this.realLook=null,this.actorManager=e.actorManager,this.fighterIndicator=null,this._turnNumberLabel=null,this._nicknameLabel=null,this._questIconLoadingStartTime=null,this.updateData(e.data)}var o=i(172).inherits,s=i(392).Tween,a=i(411),r=i(373),l=i(258);o(n,r),e.exports=n,Object.defineProperty(n.prototype,"step",{get:function(){return this._step},set:function(e){this._step=e,this.forceRefresh()}}),n.prototype.setLook=function(e,t,i,n){return this.realLook=e,this.isRiding=!!r.getLookOfRider(e),this.actorManager.isCreatureModeOn&&!n?this.setCreatureLook(t,i):void r.prototype.setLook.call(this,e,t,i)},n.prototype.applyLook=function(e){return this.actorManager.isCreatureModeOn?void(this.realLook=e.look):(e.animationManager&&e.animationManager!==this.animationManager&&(this.animManager.clear(),this.setAnimManager(e.animationManager)),this.staticAnim(),void(this.look=e.look))},n.prototype.useRealLook=function(){this.actorManager.setActorLook(this.actorId,this.realLook,null,!0)},n.prototype.updateData=function(e){var t=window.isoEngine,i=e.disposition;if(i){var n=!0;window.actorManager.paused&&window.actorManager.userActor!==this&&(this.position=i.cellId,this.cellId=i.cellId,n=!1),this.moving&&this.actorManager.userActor===this&&l.isRoleplayMode&&(n=!t.isMovementWaitingForConfirmation),n&&this.setDisposition(i.cellId,i.direction)}switch(void 0!==e.alive&&(this.isDead=!e.alive),e.npcId&&(this.data.npcId=e.npcId,this.data.npcData=e._npcData),e.name&&(this.data.name=e.name),e.contextualId&&(this.data.actorId=e.contextualId),e._type){case"GameRolePlayCharacterInformations":this.data.accountId=e.accountId,this.data.playerId=e.contextualId,this.data.humanoidInfo=e.humanoidInfo,this.data.alignmentInfos=e.alignmentInfos,this.speedAdjust=5,this.processHumanoidOptions();break;case"GameRolePlayMutantInformations":this.data.accountId=e.accountId,this.data.playerId=e.contextualId,this.data.humanoidInfo=e.humanoidInfo,this.data.monsterId=e.monsterId,this.data.powerLevel=e.powerLevel,this.processHumanoidOptions();break;case"GameRolePlayNpcWithQuestInformations":this.addQuestIcon(e.questFlag);break;case"GameFightMonsterInformations":case"GameFightMonsterWithAlignmentInformations":this.data.contextualId=e.contextualId,this.data.isBoss=e._isBoss,this.data.isSummon=e.stats&&e.stats.summoned,this.data.creatureGenericId=e.creatureGenericId;break;case"GameRolePlayGroupMonsterInformations":this.data.ageBonus=e.ageBonus,this.data.alignmentSide=e.alignmentSide,this.data.contextualId=e.contextualId,this.data.hasHardcoreDrop=e.hasHardcoreDrop,this.data.keyRingBonus=e.keyRingBonus,this.data.lootShare=e.lootShare,this.data.staticInfos=e.staticInfos,e.hasHardcoreDrop&&this.addIcon("hardcoreDrop");var o=e.staticInfos.mainCreatureLightInfos.staticInfos;o&&o.isMiniBoss&&this.addIcon("miniBoss");break;case"GameRolePlayPrismInformations":this.data.prism=e.prism,this.data.contextualId=e.contextualId;break;case"GameRolePlayTaxCollectorInformations":this.data.contextualId=e.contextualId,this.data.taxCollectorAttack=e.taxCollectorAttack;var s=e.identification.guildIdentity;this.data.guild={guildLevel:e.guildLevel,guildEmblem:s.guildEmblem,guildId:s.guildId,guildName:s.guildName},this.data.taxCollector={lastNameId:e.identification.lastNameId,firstNameId:e.identification.firstNameId};break;case"FightTeamInformations":case"FightAllianceTeamInformations":case"FightTeamLightInformations":this.data.fightId=e.fightId,this.data.teamId=e.teamId,this.data.leaderId=e.leaderId,this.data.teamSide=e.teamSide,this.data.teamTypeId=e.teamTypeId,this.data.teamMembers=e.teamMembers;break;case"GameFightCharacterInformations":this.data.playerId=e.contextualId;break;case"PaddockObject":this.data.durability=e.durability;break;case"GameRolePlayMountInformations":this.data.level=e.level,this.data.ownerName=e.ownerName}this.data.type=e._type},n.prototype.updateRestrictions=function(e){if(this.data.humanoidInfo&&(this.data.humanoidInfo.restrictions=e),this.canMoveDiagonally=!e.cantWalk8Directions,this.canMoveDiagonally===!1&&0===(1&this.direction)){var t=this.direction+1;t>7&&(t=1),this.setDisposition(this.position,t)}},n.prototype.processHumanoidOptions=function(){if(this.actorManager.removeActorFollowers(this),this.data.humanoidInfo&&this.data.humanoidInfo.options)for(var e=this.data.humanoidInfo.options,t=0;t<e.length;t++){var i=e[t];"HumanOptionAlliance"===i._type?this.addConquestIcon(i):"HumanOptionFollowers"===i._type&&this.actorManager.addActorFollowers(this,i.followingCharactersLook,!0)}},n.prototype.remove=function(){this.removeIcons(),(this.pathTween.playing||this.pathTween.starting)&&this.pathTween.stop(),this.actorManager._removeActor(this),r.prototype.remove.call(this)},n.prototype.getFighter=function(){return window.gui.fightManager.getFighter(this.actorId)},n.prototype.getFighterData=function(){var e=this.getFighter();return e?e.data:(console.warn("Fighter "+this.actorId+" could not be found."),new a)},n.prototype.isNPC=function(){return!(!this.data||!this.data.npcId)},n.prototype.getTeamId=function(){return this.getFighterData().teamId}},function(e,t,i){function n(e,t,i,n,o,s){this.c=e,this.x=t,this.y=i,this.d=n,this.a=o,this.m=s}var o=i(780),s=i(167),a=i(670),r=i(258),l=s.TIME_UNITS_PER_SECOND,c={mounted:{linear:135,horizontal:200,vertical:120,symbolId:"AnimCourse"},parable:{linear:400,horizontal:500,vertical:450,symbolId:"FX"},running:{linear:170,horizontal:255,vertical:150,symbolId:"AnimCourse"},walking:{linear:480,horizontal:510,vertical:425,symbolId:"AnimMarche"},slide:{linear:57,horizontal:85,vertical:50,symbolId:"AnimStatique"}};o.prototype.setCellPosition=function(e){this.actorManager.removeActorOccupation(this),this.cellId=e,this.actorManager.addActorOccupation(this),this.carriedActor&&this.carriedActor.setCellPosition(e)},o.prototype.setOnScreenPosition=function(e){var t=this.actorManager.isoEngine,i=t.mapRenderer.map,n=a.cellCoord[e],o=0;i&&(r.isRoleplayMode?o=i.cells[e].f||0:this._positionCircle()),this.position=e,this.x=n.x,this.y=n.y-o,this._positionIcons()},o.prototype.setDisposition=function(e,t){this.moving&&(this.pathTween.removeOnFinish(),this.pathTween.stop(),this.isLocked&&(this.isLocked=!1)),!e&&0!==e||e===-1||(this.setOnScreenPosition(e),this.setCellPosition(e)),(t||0===t)&&(this.direction=t),this.animated||this.staticAnim(),this.step=0,this.path=[],this.moving=!1},o.prototype.noMovement=function(){this.moving&&(this.pathTween.removeOnFinish(),this.pathTween.stop(),this.moving=!1,this.isLocked&&(this.isLocked=!1),this.step=0,this.path=[])},o.prototype.cancelMovement=function(e){var t=this;this.pathTween.removeOnFinish(),this.pathTween.stop();var i=~~this.step,n=i+1,o=this.path[i].m*(1-this.step+i),s=this.path[n].c;this.pathTween.reset().from({step:this.step}).to({step:n},o),this.pathTween.start(!1),this.pathTween.onceFinish(function(){t.moving=!1,t.step=0,t.path=[],t.setCellPosition(s),t.actorId===window.gui.playerData.id&&window.dofus.sendMessage("GameMapMovementCancelMessage",{cellId:s}),e&&e(),t.moving||t.setDisposition(s)})},o.prototype.switchPath=function(e,t){var i=this;this.pathTween.removeOnFinish(),this.pathTween.stop();var n=~~this.step,o=n+1,s=this.path[n].m*(1-(this.step-n));this.pathTween.reset().from({step:this.step}).to({step:o},s),this.pathTween.start(!1),this.pathTween.onceFinish(function(){return i.moving=!1,i.step=0,i.path=[],1===e.length?(i.setDisposition(e[0]),t()):(i.setPath(e,{cb:t}),void i.setCellPosition(e[e.length-1]))})},o.prototype.isPathMatchingServerPath=function(e,t){var i=e[e.length-1],n=this.path;if(n[n.length-1].c===i)return!0;var o;for(o=n.length-2;o>=0&&n[o].c!==i;o--);var s=~~this.step;if(s>=o)return!1;for(var a=n[s+1].c,r=e.length-1;r>=0&&(t.unshift(e[r]),e[r]!==a);r--);return!1},o.prototype.refreshAnimation=function(e){
if(this.moving===!0){var t=~~this._step,i=this._step-t,n=this.path[t];if(n){var o=this.path[t+1]||this.path[t];this._x=n.x+(o.x-n.x)*i,this._y=n.y+(o.y-n.y)*i,i>.5&&this._position!==o.c&&(this.position=o.c),this.animSymbol.id===n.a.id&&this.direction===n.d||(this.animSymbol=n.a,this.direction=n.d,this.animManager.assignSymbol(this.animSymbol,!0))}}this._refreshAnimation(e),this._positionIcons(),this._positionCircle()},o.prototype._startPath=function(e){var t=this,i=this.path,n=i[0].m;this.step=0,this.pathTween.reset().from({step:0}).to({step:1},n);for(var o=1,s=this.path.length-1;o<s;o++)n=i[o].m,this.pathTween.to({step:o+1},n);this.animManager.isTemporary||(this.animSymbol=i[0].a,this.animManager.assignSymbol(this.animSymbol,!0)),this.moving?console.warn('[Actor._startPath] error: actor "'+this.actorId+'" is already moving.'):(this.pathTween.start(!1),this.pathTween.onceFinish(function(){t.moving=!1;var i=t.path[t.path.length-1];return t.animSymbol=i.a,t._x=i.x,t._y=i.y,t.animManager.assignSymbol(t.animSymbol,!1),e&&e()})),this.moving=!0},o.prototype.walkToSceneCoordinate=function(e,t,i,o,s){var a=this.getAnimSymbol("AnimMarche",i),r=this.getAnimSymbol("AnimStatique",i);this.path=[new n(this.cellId,this._x,this._y,i,a,o),new n(this.cellId,e,t,i,r,0)],this._startPath(s)},o.prototype.setPath=function(e,t){var i=t&&t.cb,o=this.actorManager.isoEngine;if(!o.mapRenderer.isReady)return console.warn("setPath: renderer was not ready"),i();if(e.length<=1)return i&&i();var s=t&&t.slide,d=t&&t.forceWalk;this.path=[],this.step=0;var u,h,p,m,f=o.mapRenderer.map.cells;m=s?c.slide:this.isRiding?c.mounted:e.length>3&&!d?c.running:c.walking;for(var g,_=(1+this.speedAdjust/10||.001)*l,v=0;v<e.length;v++){var y,b=e[v],M=r.isFightMode?0:f[b].f||0,w=a.cellCoord[b];0===v?g=1:w.y===p?(y=m.horizontal,g=w.x>h?0:4):w.x===h?(y=m.vertical,g=w.y>p?2:6):(y=m.linear,g=w.x>h?w.y>p?1:7:w.y>p?3:5),y/=_,s&&(g=this.direction);var T=this.getAnimSymbol(m.symbolId,g);v>0&&(u.d=g,u.a=T,u.m=y),this.path.push(new n(b,w.x,w.y-M,g,T,y)),u=this.path[this.path.length-1],h=w.x,p=w.y}var C,A,I=this.animManager,S=I.isTemporary?{}:I.template.exposedSymbols,E=this.getAnimSymbol("AnimStatique",g),x=this.getAnimSymbol("AnimStatique_to_"+this.path[0].a.base,this.path[0].a.direction),N=this.getAnimSymbol(m.symbolId+"_to_"+E.base,g);S[x.id]&&(C=this.path[0],A=I.getSymbolDuration(x.id),this.path.unshift(new n(C.c,C.x,C.y,C.d,x,A))),S[N.id]&&(C=this.path[this.path.length-1],A=I.getSymbolDuration(N.id),C.a=N,C.m=A,this.path.push(new n(C.c,C.x,C.y,C.d,E,C.m))),this.path[this.path.length-1].a=E,this._startPath(i)}},function(e,t,i){var n=i(780),o=i(29).getText,s=i(571).npcActionRequest,a=i(775),r=i(194);n.prototype.tap=function(e,t){var i=this.actorId,n=this.cellId,l=this.data,c=this.scene.convertSceneToCanvasCoordinate(e,t),d={x:c.x,y:c.y,isCanvasCoordinate:!0};switch(l.type){case"GameRolePlayGroupMonsterInformations":window.gui.openContextualMenu("monster",l,d);break;case"GameRolePlayPrismInformations":window.gui.openContextualMenu("prism",l,d);break;case"GameRolePlayTaxCollectorInformations":l.mapId=window.isoEngine.mapRenderer.map.id,window.gui.openContextualMenu("taxCollector",l,d);break;case"GameRolePlayNpcInformations":case"GameRolePlayNpcWithQuestInformations":var u=window.isoEngine,h=u.mapRenderer.map.id,p=l.npcId;if(!p)return;var m=l.npcData;if(!m)return console.debug("NPC missing in database:",p);if(1===m.actions.length&&window.gui.playerData.isAlive())return u.highlightActorOnAction(i),s(m,i,h,m.actions[0]);window.gui.openContextualMenu("npc",{actorId:i,npcId:p,npcData:m,mapId:h},d);break;case"GameRolePlayCharacterInformations":case"GameRolePlayMutantInformations":var f;this!==this.actorManager.userActor&&(f=window.isoEngine.mapRenderer.interactiveElements),window.gui.openContextualMenu("player",{accountId:l.accountId,playerId:l.playerId,playerName:l.name,cellId:n,isMutant:"GameRolePlayMutantInformations"===l.type,humanoidInfoOptions:l.humanoidInfo&&l.humanoidInfo.options,alignmentInfos:l.alignmentInfos,interactiveElements:f},d);break;case"GameRolePlayMerchantInformations":window.gui.openContextualMenu("merchant",{id:i,name:l.name,cellId:this.cellId},d);break;case"FightTeamInformations":case"FightAllianceTeamInformations":case"FightTeamLightInformations":window.gui.openContextualMenu("fightTeam",l,d);break;case"GameFightCharacterInformations":window.gui.openContextualMenu("player",{playerId:l.playerId,playerName:l.name,isMutant:!1},d);break;case"GameRolePlayMountInformations":var g=[{caption:o("ui.mount.viewMountDetails"),cb:function(){r.getWindow("mount").showPaddockMount(i)}}];window.gui.openContextualMenu("generic",{title:(l.name||o("ui.common.noName"))+"\n"+o("ui.mount.mountOf",l.ownerName)+"\n"+o("ui.common.rank",l.level),actions:g},d);break;case"GameFightMutantInformations":case"GameFightMonsterInformations":case"GameFightMonsterWithAlignmentInformations":case"GameFightTaxCollectorInformations":return;case"PaddockObject":window.gui.openContextualMenu("paddockObject",{cellId:n,paddockObjectName:this.data.name},d);break;case"BeginnerAssistant":a.openDialog();break;default:return}}},function(e,t,i){var n=i(780),o=i(392).Tween,s={red:0,green:0,blue:0,alpha:0},a={red:1,green:1,blue:1,alpha:.6};n.prototype.setInvisibility=function(e,t){if(this.showTeamCircle(1!==e),3===e)this.removeHighlight(),this.isInvisible=!1,this.actorManager.addActorOccupation(this);else{var i=this.actorManager.userActor.getTeamId();t===i?this.setHighlight(a):(this.setHighlight(s),this.isInvisible=!0,this.actorManager.removeActorOccupation(this),this.actorManager.turnIndicatorOff())}},n.prototype.invisibleDetectedAnimation=function(){var e={red:0,green:0,blue:0,alpha:1};this.setHighlight(e),o(this.highlight,["alpha"]).from({alpha:1}).to({alpha:0},30).start(!1)}},function(e,t,i){var n=i(780),o=i(373),s=i(394),a=i(397),r=a.HOOK_POINT_CATEGORY_MOUNT_DRIVER,l=a.HOOK_POINT_CATEGORY_LIFTED_ENTITY;n.prototype.addSubentity=function(e,t,i){var n=this;o.prototype.addSubentity.call(this,e,t,function(t){return e.bindingPointCategory===r&&(n.riderEntity=t),i&&i(t)})},n.prototype.carryCharacter=function(e){var t=this;if(this.animManager.isTemporary)return console.warn("Actor animManager is not ready."),void window.setTimeout(function(){t.carryCharacter(e)},2e3);var i={animManager:e.animManager,bindingPoint:"carried_3_0",symbolModifier:s[l],bindingPointCategory:l};e.getFighterData().isCarryied=!0,e.parentActor=t,t.carriedEntity=i,t.carriedActor=e;var n=this.riderEntity||this.animManager;n.addAnimation({base:"carrying",direction:-1},function(){n.addAnimationModifier("AnimStatique","AnimStatiqueCarrying"),n.addAnimationModifier("AnimMarche","AnimMarcheCarrying"),n.addAnimationModifier("AnimCourse","AnimCourseCarrying"),n.addAnimationModifier("AnimHit","AnimHitCarrying"),n.addAnimationModifier("AnimTacle","AnimTacleCarrying"),n.addSubentity(i),e.setDisposition(t.cellId),e.y=-1e3,t.staticAnim()})}},function(e,t,i){function n(e,t,i){return e===t?"ally":e===i?"defender":"attacker"}function o(e){var t=0,i=window.gui.playerData.characterBaseInformations.level;return i>=e.levelMin&&i<=e.levelMax&&(t+=2),e.repeatType!==I&&(t+=1),t}function s(e,t){var i=e.questsToValidId.concat(e.questsToStartId);_.getDataMap("Quests",i,function(e,i){if(e)return t(e);var n,s;for(var a in i){var r=i[a];if(r){var l=o(r);(!n||s<l)&&(s=l,n=r)}}return t(null,n)})}function a(e,t){s(e,function(i,n){if(i)return t(i);if(!n)return t();var o;return o=e.questsToStartId.indexOf(n.id)!==-1?n.repeatType===I?"questClip":"questRepeatableClip":n.repeatType===I?"questObjectiveClip":"questRepeatableObjectiveClip",t(null,o)})}var r=i(780),l=i(167),c=i(379),d=i(673),u=i(384),h=i(380),p=i(475),m=i(392).Delay,f=i(485),g=i(474),_=i(30),v=l.CELL_HEIGHT,y=v/2,b=24,M={QUEST:1,DEFAULT:2,AVA:3,SMILEY:4,UI:5},w={miniBoss:"archmonsters",hardcoreDrop:"treasure",defender:"defender",attacker:"forward",ally:"ownTeam",disqualified:"neutral",prequalified:"clock"},T=5,C=5,A=72,I=0,S=new m;r.prototype._getIcon=function(e,t){return this.icons.hasOwnProperty(t)?this.icons[t][e]:null},r.prototype._setIcon=function(e,t,i){this.icons.hasOwnProperty(i)||(this.icons[i]={}),this.icons[i][t]=e},r.prototype.addConquestIcon=function(e){var t,i=window.gui.playerData,o=i.characters.mainCharacter.characteristics.alignmentInfos.aggressable,s=o!==g.NON_AGGRESSABLE,a=e.aggressable!==g.NON_AGGRESSABLE,r=e.aggressable===g.PvP_ENABLED_AGGRESSABLE||e.aggressable===g.PvP_ENABLED_NON_AGGRESSABLE;if(s&&i.alliance.hasAlliance()&&a&&!r){var l=p.entities.prism[i.position.subAreaId];if(l&&l.prism&&l.prism.state===f.PRISM_STATE_VULNERABLE){var c=e.allianceInformations.allianceId,d=i.alliance.current.allianceId,u=l.getAlliance().allianceId,h=this.actorId===i.id;switch(e.aggressable){case g.AvA_DISQUALIFIED:h&&(t="disqualified");break;case g.AvA_PREQUALIFIED_AGGRESSABLE:t=h?"prequalified":n(c,d,u);break;case g.AvA_ENABLED_AGGRESSABLE:t=h?"ally":n(c,d,u)}}}this._getIcon(t,M.AVA)||(this.removeIconCategory(M.AVA),t&&this.addIcon(t,M.AVA))},r.prototype.addSmileyIcon=function(e){var t=this,i=window.gui.databases.Smileys[e];if(!i)return console.error("Smiley "+e+" details are not available, it could not be displayed");var n=M.SMILEY;this.removeIconCategory(n),this.addIcon(i.gfxId,n),(S.playing||S.starting)&&S.stop(),S.reset(A,function(){t.removeIconCategory(n)}),S.start()},r.prototype.addReadyIconOnActor=function(){this.addIcon("Social_tx_fightState",M.UI)},r.prototype.removeReadyIconOnActor=function(){this.removeIconCategory(M.UI)},r.prototype.addQuestIcon=function(e,t){t=t||function(e){if(e)return console.error("addQuestIcon:",e)};var i=this,n=this._questIconLoadingStartTime=Date.now();a(e,function(e,o){if(e)return t(e);if(!o)return t();if(i._getIcon(o,M.QUEST))return t();if(n!==i._questIconLoadingStartTime)return t();var s=new c({layer:l.MAP_LAYER_ICONS,x:i.x,y:i.y,offsetY:0,scene:i.scene});h.loadAnimationManager(s,"embedded","quest",function(e){var a=i._questIconLoadingStartTime;return i._questIconLoadingStartTime=null,n!==a?(s.remove(),t()):(e.assignSymbol({base:o,direction:-1},!0),i.removeQuestIcon(),i._setIcon(s,o,M.QUEST),i._positionIcons(),t())})})},r.prototype.addIcon=function(e,t){function i(e){return r._cleared?void e.release():(r.w=e.element.width,r.h=e.element.height,r.texture=e,s._positionIcons(),void r.forceRefresh())}t=t||M.DEFAULT;var n=this._getIcon(e,t);if(!n){var o;switch(t){case M.SMILEY:o="gfx/smilies/";break;case M.UI:o="ui/";break;default:e=w[e],o="gfx/icons/conquestIcon/"}if(!e)return console.warn("Icon type '"+e+"' is unknown and could not be displayed.");var s=this,a=o+e+".png",r=new d({layer:l.MAP_LAYER_ICONS,x:this.x,y:this.y,w:0,h:0,scene:this.scene});this._setIcon(r,e,t),u.loadTexture(a,i,this.scene.renderer)}},r.prototype._positionIcons=function(){var e=0;for(var t in M){var i,n=M[t],o=0,s=0;for(i in this.icons[n]){var a=this.icons[n][i].w;o+=a?a:0,s++}if(0!==s){o+=T*(s-1);var r=~~(.5*-o),l=0;for(i in this.icons[n]){var c=this.icons[n][i],d=c.h?c.h:0;l=Math.max(l,c.h?c.h:50);var u=this.bbox?this.bbox[2]-this.y-d-10:-100;u-=e,this.y+u<0&&(u=this.bbox?this.bbox[3]-this.y+10:100,u+=e),c.x=this.x+r,c.y=this.y+u,c.position=this.position,r+=c.w+T}e+=l+C}}if(1===window.gui.fightManager.fightState&&this.updateTurnIndicatorPosition(),this.fighterIndicator&&(this.fighterIndicator.x=this.x,this.fighterIndicator.y=this.bbox[2]-10),this._turnNumberLabel&&this._turnNumberLabel.updatePosition(this.x,this.y),this._nicknameLabel){var h=this._calculateNicknameYOffset();this._nicknameLabel.updatePosition(this.x,h)}},r.prototype._calculateNicknameYOffset=function(){var e;return e=this.bbox[2]-b+y>0?this.bbox[2]-b:this.y+y},r.prototype.removeQuestIcon=function(){this._questIconLoadingStartTime=null,this.removeIconCategory(M.QUEST)},r.prototype.removeIcon=function(e,t){var i=this._getIcon(e,t);i&&(i.remove(),delete this.icons[t][e])},r.prototype.removeIconCategory=function(e){for(var t in this.icons[e])this.removeIcon(t,e)},r.prototype.removeIcons=function(){for(var e in M){var t=M[e];this.removeIconCategory(t)}}},function(e,t,i){function n(){if(u)return u;u={};var e=/^\{[\d]*\|([\d]*)/i,t=window.gui.databases.Breeds;for(var i in t){var n=t[i],o=e.exec(n.maleLook)[1],s=e.exec(n.femaleLook)[1];u[o]=n.creatureBonesId,u[s]=n.creatureBonesId}return u[453]=t[12].creatureBonesId,u}function o(e){return{base:e.base,type:0,param:null,direction:e.direction}}function s(e){return{base:"AnimAttaque",type:0,param:null,direction:e.direction}}var a=i(780),r=i(373),l=i(258),c={1:!0,113:!0,44:!0,1575:!0,1576:!0},d=[1097,1111,1112,3451],u=null;a.prototype.getCreatureBones=function(){switch(this.data.type){case"FightTeamInformations":case"FightAllianceTeamInformations":case"FightTeamLightInformations":case"GameRolePlayNpcInformations":case"GameRolePlayNpcWithQuestInformations":return null;case"GameFightCharacterInformations":case"GameRolePlayCharacterInformations":case"GameRolePlayHumanoidInformations":var e=r.getLookWithoutMount(this.realLook),t=e.bonesId;if(!c[t])return 1749;var i=e.skins[0];return n()[i]||666;case"GameRolePlayPrismInformations":return 2247;case"GameRolePlayMerchantInformations":return 1965;case"GameRolePlayTaxCollectorInformations":case"GameFightTaxCollectorInformations":return 1813;case"GameRolePlayGroupMonsterInformations":case"GameFightMonsterInformations":case"GameFightMonsterWithAlignmentInformations":return this.data.isBoss?1748:d.indexOf(this.data.creatureGenericId)>=0?2247:this.data.isSummon?1765:1747;case"GameRolePlayMountInformations":return 1749;case"GameFightMutantInformations":case"GameRolePlayMutantInformations":return 1747;default:return 666}},a.prototype.setCreatureLook=function(e,t){var i="GameRolePlayPrismInformations"===this.data.type,n="GameRolePlayTaxCollectorInformations"===this.data.type,a=this.data.humanoidInfo||i||n;if(l.isRoleplayMode&&!a)return this.realLook?this.actorManager.setActorLook(this.actorId,this.realLook,t,!0):t&&t();var c=this.getCreatureBones();if(c){var d={bonesId:c,skins:[],indexedColors:[],scales:[90],subentities:[]},u=this;r.prototype.setLook.call(this,d,e,function(){return u.animManager.addAnimationModifier("AnimArme",o),u.animManager.addAnimationModifier("AnimAttaque",o),u.animManager.addAnimationModifier("AnimTacle","AnimHit"),u.animManager.addAnimationModifier("AnimEmote",s),u.animManager.addAnimationModifier("AnimConsulter","AnimAttaque0"),u.animManager.addAnimationModifier("AnimCueillir0","AnimAttaque0"),u.animManager.addAnimationModifier("AnimCueillirSol0","AnimAttaque0"),u.animManager.addAnimationModifier("AnimDrop","AnimAttaque0"),u.animManager.addAnimationModifier("AnimFaucher","AnimAttaque0"),u.animManager.addAnimationModifier("AnimHache","AnimAttaque0"),u.animManager.addAnimationModifier("AnimPeche","AnimAttaque0"),u.animManager.addAnimationModifier("AnimPickup","AnimAttaque0"),u.animManager.addAnimationModifier("AnimPioche","AnimAttaque0"),u.animManager.addAnimationModifier("AnimPuiser","AnimAttaque0"),u.animManager.addAnimationModifier("AnimThrow","AnimAttaque0"),u.staticAnim(),t&&t()})}}},function(e,t,i){var n=i(780),o=i(384),s=i(167),a=i(673),r=i(788),l=i(343),c=i(789),d=i(792),u="ui/embedded/teamCircleRed.png",h="ui/embedded/teamCircleBlue.png";n.prototype.addTeamCircle=function(){function e(e){n.circleGraphic?(n.circleGraphic.w=e.element.width,n.circleGraphic.h=e.element.height,n.circleGraphic.texture=e,n._positionCircle(),n.circleGraphic.forceRefresh()):e.release()}if(!this.circleGraphic){var t=this.getFighter();if(t){var i=t.data.teamId,n=this;this.circleGraphic=new a({layer:s.MAP_LAYER_BACKGROUND,x:this.x,y:this.y,w:0,h:0,scene:this.scene});var r;0===i?r=u:1===i?r=h:console.error("invalid team number"),o.loadTexture(r,e,this.scene.renderer)}}},n.prototype.removeTeamCircle=function(){this.circleGraphic&&(this.circleGraphic.remove(),this.circleGraphic=null)},n.prototype._positionCircle=function(){this.circleGraphic&&(this.circleGraphic.x=this.x-s.CELL_WIDTH/2,this.circleGraphic.y=this.y-s.CELL_HEIGHT/2,this.circleGraphic.position=this.position,this.circleGraphic.forceRefresh())},n.prototype.showTeamCircle=function(e){this.circleGraphic&&(e?this.circleGraphic.show():this.circleGraphic.hide())},n.prototype.updateTurnIndicatorPosition=function(){var e=window.gui.fightManager.getFighter(this.actorId);e&&e.data.alive&&window.gui.fightManager.currentFighterId===e.id&&(e.data.teamId===l.TEAM_CHALLENGER?r.moveRedFeedback(this.x,this.y):r.moveBlueFeedback(this.x,this.y))},n.prototype.addTurnNumber=function(e){this.removeTurnNumber(),this._turnNumberLabel=new c(this.x,this.y,e)},n.prototype.removeTurnNumber=function(){this._turnNumberLabel&&(this._turnNumberLabel.remove(),this._turnNumberLabel=null)},n.prototype.addNicknameLabel=function(e){this.removeNicknameLabel();var t="rgb(255, 255, 255)";this===this.actorManager.userActor&&(t="rgb(255, 20, 50)");var i=this._calculateNicknameYOffset();this._nicknameLabel=new d(this.x,i,e,t)},n.prototype.removeNicknameLabel=function(){this._nicknameLabel&&(this._nicknameLabel.remove(),this._nicknameLabel=null)}},function(e,t,i){function n(e,t){e===g.TAP_MARKER&&(t.layer=p.MAP_LAYER_TAP_FEEDBACK),h.call(this,t),this.setWhiteListedness(!0),this.infos=e}function o(){var e=1.5,t=[1,0,0,1],i=[0,0,1,1];for(var o in g){var s=g[o];if(3===s.id||4===s.id)var a=new n(s,{scene:window.isoEngine.mapRenderer.mapScene,layer:p.MAP_LAYER_BACKGROUND,hue:3===s.id?t:i,sx:e,sy:e});else a=new n(s,{scene:window.isoEngine.mapRenderer.mapScene});_[s.id]=a,m.loadAnimationManager(a,"embedded","tapFeedback")}}function s(e,t){var i=_[e.id];return i?void i.play(t):console.warn("Tap feedback",e.id,"does not exist.")}function a(e){var t=_[e.id];t&&t.remove()}function r(e){s(g.MOVEMENT_MARKER,e)}function l(){a(g.MOVEMENT_MARKER),a(g.TURN_MARKER_RED),a(g.TURN_MARKER_BLUE)}function c(e){s(g.TAP_MARKER,e)}function d(){a(g.TAP_MARKER)}var u=i(172).inherits,h=i(379),p=i(167),m=i(380),f=i(343),g={TAP_MARKER:{id:1,animationName:"touch_anim_ok",isLoop:!1},MOVEMENT_MARKER:{id:2,animationName:"marqueur_anim_ok",isLoop:!0},TURN_MARKER_RED:{id:3,animationName:"marqueur_anim_ok",isLoop:!0},TURN_MARKER_BLUE:{id:4,animationName:"marqueur_anim_ok",isLoop:!0}},_={};u(n,h),n.prototype.play=function(e){var t=this.infos,i=this,n=t.isLoop,o=n?void 0:function(){i.remove(!1)};this.animManager.assignSymbol({base:t.animationName,direction:-1},n,o),(e.position||0===e.position)&&(this.position=e.position),this.x=e.x,this.y=e.y,this.show()},t.initialize=function(){o()},t.addMovementFeedback=r,t.removeMovementFeedback=l,t.addTapFeedback=c,t.removeTapFeedback=d,t.addTurnFeedback=function(e,t){var i=t===f.TEAM_CHALLENGER?g.TURN_MARKER_RED:g.TURN_MARKER_BLUE;s(i,e)},t.moveRedFeedback=function(e,t){var i=_[3];i.x=e,i.y=t},t.moveBlueFeedback=function(e,t){var i=_[4];i.x=e,i.y=t}},function(e,t,i){function n(e,t,i){o.call(this,e-c,t-d,i)}var o=i(790),s=i(167),a=i(172).inherits,r=s.CELL_WIDTH,l=s.CELL_HEIGHT,c=r/2,d=l/4;a(n,o),e.exports=n,n.prototype.updatePosition=function(e,t){this._textImage.x=e-c,this._textImage.y=t-d}},function(e,t,i){function n(e,t,i){this._text=i,this._textImage=new o(i),this._textImage.x=e,this._textImage.y=t}var o=i(791);e.exports=n,n.prototype.updatePosition=function(e,t){this._textImage.x=e,this._textImage.y=t},n.prototype.updateText=function(e){e!==this._text&&(this._textImage.clear(),this._textImage=new o(e),this._text=e)},n.prototype.remove=function(){this._textImage.clear(),this._textImage=null},n.prototype._centerText=function(){this._textImage.x=this._textImage.x-this._textImage.canvas.width/2},n.prototype.setForegroundColor=function(e){this._textImage.setForegroundColor(e)},n.prototype.setBackgroundColor=function(e){this._textImage.setBackgroundColor(e)}},function(e,t,i){function n(e){var t={id:l++,scene:window.isoEngine.mapScene,layer:a.MAP_LAYER_FOREGROUND,position:0};this._text=e,this.canvas=document.createElement("canvas"),this.canvas.height=t.h=r+c+2,this.canvasContext=this.canvas.getContext("2d"),this.canvasContext.font=r+"px "+d,this.canvas.width=t.w=Math.ceil(this.canvasContext.measureText(e.toString()).width)+c,this.canvasContext.font=r+"px "+d,this.canvasContext.shadowBlur=2,this.canvasContext.shadowColor="rgba(0, 0, 0, 1)",this.canvasContext.shadowOffsetX=1,this.canvasContext.shadowOffsetY=1,s.call(this,t),this.setForegroundColor("rgb(255, 255, 255)"),this.show()}var o=i(172).inherits,s=i(673),a=i(167),r=20,l=0,c=2,d="Verdana";o(n,s),e.exports=n,n.prototype.setForegroundColor=function(e){this._foregroundColor=e,this.canvasContext.fillStyle=e,this.canvasContext.textAlign="left",this.canvasContext.fillText(this._text,1,r-c),this._setTexture()},n.prototype.setBackgroundColor=function(e){this.canvasContext.fillStyle=e,this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.setForegroundColor(this._foregroundColor)},n.prototype.clear=function(){this.texture?(this.texture.release(),this.texture=null):console.warn("[CanvasText.clear] Clearing CanvasText, but it was already clear"),this.hide()},n.prototype._setTexture=function(){this.texture&&this.texture.release(),this.texture=window.isoEngine.mapScene.createTexture(this.canvas)}},function(e,t,i){function n(e,t,i,n){o.call(this,e,t,i),this.setForegroundColor(n),this.setBackgroundColor("rgba(0, 0, 0, 0.3)"),this._centerText()}var o=i(790),s=i(172).inherits;s(n,o),e.exports=n,n.prototype.updatePosition=function(e,t){this._textImage.x=e,this._textImage.y=t,this._centerText()}},function(e,t,i){function n(e,t){this.i=e,this.j=t,this.floor=-1,this.zone=-1,this.speed=1,this.weight=0,this.candidateRef=null}function o(e,t){void 0!==e&&1&e.l?(t.floor=e.f||0,t.zone=e.z||0,t.speed=1+(e.s||0)/10,t.zone!==C&&(T=!1)):(t.floor=-1,t.zone=-1)}function s(e,t,i,n,o){this.i=e,this.j=t,this.w=i,this.d=n,this.path=o}function a(e,t){return e.floor===t.floor||e.zone===t.zone&&(T||0!==e.zone||Math.abs(e.floor-t.floor)<=g)}function r(e,t,i,n){return a(e,t)&&(a(e,i)||a(e,n))}function l(e,t,i,n,o,a){var r=e.i,l=e.j,c=Math.sqrt((i-r)*(i-r)+(n-l)*(n-l));if(t=t/e.speed+e.weight,null===e.candidateRef){var d=new s(r,l,a.w+t,c,a);o.push(d),e.candidateRef=d}else{var u=e.candidateRef.w,h=a.w+t;h<u&&(e.candidateRef.w=h,e.candidateRef.path=a)}}function c(e,t,i,n,o){var s=e.i,c=e.j,d=y[s][c],u=y[s-1][c],h=y[s][c-1],p=y[s][c+1],m=y[s+1][c],f=1;a(d,u)&&l(u,f,t,i,n,e),a(d,m)&&l(m,f,t,i,n,e),a(d,h)&&l(h,f,t,i,n,e),a(d,p)&&l(p,f,t,i,n,e);var g=y[s-1][c-1],_=y[s-1][c+1],v=y[s+1][c-1],b=y[s+1][c+1],M=Math.sqrt(2);o&&(r(d,g,u,h)&&l(g,M,t,i,n,e),r(d,v,m,h)&&l(v,M,t,i,n,e),r(d,_,u,p)&&l(_,M,t,i,n,e),r(d,b,m,p)&&l(b,M,t,i,n,e))}function d(e){if(!Array.isArray(e)||e.length<2)return!1;for(var t=p(e[0]),i=1,n=e.length;i<n;i+=1){var o=e[i],s=p(o);if(Math.abs(t.x-s.x)>1)return!1;if(Math.abs(t.y-s.y)>1)return!1;t=s}return!0}function u(e){if(!Array.isArray(e))return[];if(e.length<2)return e;var t=[];t.push(e[0]);for(var i=p(e[0]),n=1,o=e.length;n<o;n+=1){var s,a,r=e[n],l=p(r),c=Math.abs(l.x-i.x),d=Math.abs(l.y-i.y);if(0===c||0===d){if(c>1)for(s=l.x>i.x?1:-1,i.x+=s;i.x!==l.x;)t.push(m(i.x,i.y)),i.x+=s;if(d>1)for(a=l.y>i.y?1:-1,i.y+=a;i.y!==l.y;)t.push(m(i.x,i.y)),i.y+=a}else if(c===d)for(s=l.x>i.x?1:-1,a=l.y>i.y?1:-1,i.x+=s,i.y+=a;i.y!==l.y;)t.push(m(i.x,i.y)),i.x+=s,i.y+=a;i=l,t.push(r)}return t}for(var h=i(794),p=h.getMapPointFromCellId,m=h.getCellIdFromMapPoint,f=10,g=11.825,_=35,v=36,y=[],b=0;b<_;b+=1){for(var M=[],w=0;w<v;w+=1)M[w]=new n(b,w);y[b]=M}var T,C;t.fillPathGrid=function(e){C=e.cells[0].z||0,T=!0;for(var t=0;t<_;t+=1)for(var i=y[t],n=0;n<v;n+=1){var s=m(t-1,n-1),a=i[n],r=e.cells[s];o(r,a)}},t.updateCellPath=function(e,t){var i=h.getMapPointFromCellId(e),n=y[i.x+1][i.y+1];o(t,n)},t.getPath=function(e,t,i,n,o){var a,r;n=void 0===n||!!n;var l=p(e),d=p(t),u=l.x+1,h=l.y+1,g=y[u][h];if(g.zone===-1){for(var _=null,v=1/0,b=1/0,M=-1;M<=1;M+=1)for(var w=-1;w<=1;w+=1)if(0!==M||0!==w){var T=y[u+M][h+w];if(T.zone!==-1){var C=Math.abs(T.f-g.f),A=Math.abs(M)+Math.abs(w);(null===_||C<b||C<=b&&A<v)&&(_=T,v=A,b=C)}}return null!==_?[e,m(_.i-1,_.j-1)]:(console.error(new Error("[pathFinder.getPath] Player is stuck in "+u+"/"+h)),[e])}var I,S,E=d.x+1,x=d.y+1;for(S in i)I=p(S),y[I.x+1][I.y+1].weight+=f;for(var N=[],L=[],O=Math.sqrt((u-E)*(u-E)+(h-x)*(h-x)),D=new s(u,h,0,O,null),R=null,P=D;D.i!==E||D.j!==x;){c(D,E,x,N,n);var B=N.length;if(0===B){D=P;break}var k=1/0,z=0;for(a=0;a<B;a+=1)r=N[a],r.w+r.d<k&&(D=r,k=r.w+r.d,z=a);if(L.push(D),N.splice(z,1),0===D.d||o&&D.d<1.5){if(null===R||D.w<R.w){R=D,P=D;var F=[];for(a=0;a<N.length;a+=1)r=N[a],r.w+r.d<R.w?F.push(r):y[r.i][r.j].candidateRef=null;N=F}}else D.d<P.d&&(P=D)}for(a=0;a<N.length;a+=1)r=N[a],y[r.i][r.j].candidateRef=null;for(var H=0;H<L.length;H+=1)D=L[H],y[D.i][D.j].candidateRef=null;for(S in i)I=p(S),y[I.x+1][I.y+1].weight-=f;for(var q=[];null!==P;)q.unshift(m(P.i-1,P.j-1)),P=P.path;return q},t.getAccessibleCells=function(e,t){e+=1,t+=1;var i=y[e][t],n=y[e-1][t],o=y[e][t-1],s=y[e][t+1],r=y[e+1][t],l=[];return a(i,n)&&l.push({i:n.i-1,j:n.j-1}),a(i,r)&&l.push({i:r.i-1,j:r.j-1}),a(i,o)&&l.push({i:o.i-1,j:o.j-1}),a(i,s)&&l.push({i:s.i-1,j:s.j-1}),l},t.compressPath=function(e){for(var t,i,n=[],o=e[0],s=-1,a=0;a<e.length;a++){var r,l=e[a],c=p(l);r=0===a?-1:c.y===i?c.x>t?7:3:c.x===t?c.y>i?1:5:c.x>t?c.y>i?0:6:c.y>i?2:4,r!==s&&(n.push(o+(r<<12)),s=r),o=l,t=c.x,i=c.y}return n.push(o+(s<<12)),n},t.normalizePath=function(e){return d(e)?e:u(e)},t.logPath=function(e){e=e||[];var t,i,n=[];for(t=0;t<33;t+=1)for(n.push([]),i=0;i<34;i+=1)void 0===m(t,i)?n[t][i]="    ":n[t][i]="[  ]";for(var o=0,s=e.length;o<s;o+=1){var a=e[o],r=p(a),l=o<10?"0":"";n[r.x][r.y]="["+l+o+"]"}var c="";for(i=0;i<34;i+=1){for(t=0;t<33;t+=1)c+=n[t][i];c+="\n"}return c}},function(e,t,i){function n(e){var t=e.x-_,i=e.y;return{x:(y*t+y*i)/b+h/2+m,y:(y*i-y*t)/M+f}}function o(e){var t=e%14-~~(e/28),i=t+19,n=t+~~(e/14);return{x:i,y:n}}function s(){for(var e=0;e<560;e++){var t=o(e);w[t.x+"_"+t.y]=e}}function a(e,t){var i=w[e+"_"+t];return i}function r(e,t){t=t||!1;var i=o(e),n=i.x,s=i.y,r=[];return t&&r.push(a(n+1,s+1)),r.push(a(n,s+1)),t&&r.push(a(n-1,s+1)),r.push(a(n-1,s)),t&&r.push(a(n-1,s-1)),r.push(a(n,s-1)),t&&r.push(a(n+1,s-1)),r.push(a(n+1,s)),r}function l(e,t,i){return r(e,i).indexOf(t)!==-1}function c(e,t,i){var n,s=o(e),a=o(t),r=Math.atan2(s.y-a.y,a.x-s.x);return i?(r=~~(Math.floor(8*r/Math.PI)+8),n=[3,2,2,1,1,0,0,7,7,6,6,5,5,4,4,3,3][r]):(r=~~(Math.floor(4*r/Math.PI)+4),n=[3,1,1,7,7,5,5,3,3][r]),n}function d(e,t){return e=o(e),t=o(t),Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}var u=i(167),h=u.CELL_WIDTH,p=u.CELL_HEIGHT,m=u.HORIZONTAL_OFFSET-h,f=u.VERTICAL_OFFSET-p/2,g=19,_=g+.225,v=Math.sqrt(2),y=v/2,b=v/h,M=v/p;t.getCoordinateSceneFromGrid=n,t.getMapPointFromCellId=o;var w={};s(),Object.freeze(w),t.getCellIdFromMapPoint=a,t.getNeighbourCells=r,t.areCellsNeighbours=l,t.getOrientation=c,t.getDistance=d},function(e,t){t.characterLevelLimit=29,t.exits={81527299:[{type:"sun",target:"tile",targetId:424,delta:{x:0,y:0}},{type:"sun",target:"tile",targetId:438,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463588,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463589,delta:{x:0,y:0}}],80219654:[{type:"sun",target:"tile",targetId:148,delta:{x:0,y:0}}],81529347:[{type:"sun",target:"tile",targetId:341,delta:{x:0,y:0}}],81527301:[{type:"sun",target:"tile",targetId:316,delta:{x:0,y:0}}],81529349:[{type:"sun",target:"tile",targetId:344,delta:{x:0,y:0}}],81528323:[{type:"sun",target:"tile",targetId:311,delta:{x:0,y:0}},{type:"sun",target:"tile",targetId:324,delta:{x:0,y:0}}],81528325:[{type:"sun",target:"tile",targetId:316,delta:{x:0,y:0}}],81529345:[{type:"sun",target:"tile",targetId:358,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463599,delta:{x:0,y:0}}],81527297:[{type:"sun",target:"tile",targetId:427,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463597,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:509053,delta:{x:0,y:0}}],80218116:[{type:"interactive",target:"interactive",targetId:463596,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463601,delta:{x:0,y:0}}],81528321:[{type:"interactive",target:"interactive",targetId:463586,delta:{x:0,y:0}}],80218626:[{type:"interactive",target:"interactive",targetId:463600,delta:{x:0,y:0}}],80216578:[{type:"interactive",target:"interactive",targetId:463602,delta:{x:0,y:0}}],80216066:[{type:"interactive",target:"interactive",targetId:463603,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463604,delta:{x:0,y:0}}],80216064:[{type:"interactive",target:"interactive",targetId:463605,delta:{x:0,y:0}}],80216068:[{type:"interactive",target:"interactive",targetId:463648,delta:{x:0,y:0}}]},t.questsHints={717:{questId:717,question:"tablet.joris.questQuestion717",answer:"tablet.joris.questAnswer717",coordinate:{x:-5,y:-1},priority:10},780:{questId:780,question:"tablet.joris.questQuestion717",answer:"tablet.joris.questAnswer717",coordinate:{x:-5,y:-1},requirements:[717],priority:10},777:{questId:777,question:"tablet.joris.questQuestion717",answer:"tablet.joris.questAnswer717",coordinate:{x:-5,y:-1},requirements:[780],priority:10},783:{questId:783,question:"tablet.joris.questQuestion783",answer:"tablet.joris.questAnswer783",coordinate:{x:0,y:3},requirements:[777],priority:9},181:{questId:181,question:"tablet.joris.questQuestion181",answer:"tablet.joris.questAnswer181",coordinate:{x:0,y:3},requirements:[777],priority:8},784:{questId:784,question:"tablet.joris.questQuestion784",answer:"tablet.joris.questAnswer784",coordinate:{x:4,y:3},requirements:[777],priority:7}},t.phoenixPosition={x:6,y:6},t.tutorialQuests={489:!0,492:!0},t.rewardsPendingHintLimit=5,t.beginnerHatGID=10801,t.INCARNAM_WORLD_MAP=2,t.noTacticalModeMaps=[80216064,80216068,80347654,80219655,80219141,80219143,80216584,80218112,80218113,80217602,80216585,80218114,80219136,80219140,80217605,80216065,80218118,80218632,80347649,80220162,80220164,80219144,80220676,80219142,80216067,81527297,81528321,81529345,81529347,81528323,81527299,81527301,81528325,81529349],t.achievementsHintId=118,t.incarnamDungeon={keyId:8545,playerLevelThreshold:29,firstMapId:80742913,coord:{x:7,y:5}},t.newEquipmentHintsId=[2478,2475,2476,2473,2477,2474,14578,14577,14579,14580,14581,14582,2428,2425,2422,2419,2416,2414,2411],t.creatureModeHintCreaturesId=[3543,3534,3533,3524,3523,3540,3539,3536,3535,3538,3537],t.numPlayersMetForGuildHint=2,t.minLevelForGuildHint=12,t.noobGuildData={306:{guildId:4,guildName:"Mora-Mora",leaders:[{id:2209,name:"Cait"},{id:2208,name:"Ceridwen"}]},300:[{guildId:27,guildName:"Go Gobball",leaders:[{id:29,name:"Verdichex"}]},{guildId:42,guildName:"LoupsJauneDevant",leaders:[{id:1126,name:"Marie-Adelle"}]}],301:{guildId:3,guildName:"Au Bazar de Papycha",leaders:[{id:8,name:"Cait"},{id:3847,name:"Hera"},{id:4649,name:"Tenebros"},{id:1705,name:"Acide-Sulfurique"}]},403:{guildId:1,guildName:"Au Bazar de Papycha",leaders:[{id:212,name:"Cait"},{id:246898,name:"Maftis"},{id:169105,name:"Ceridwen"},{id:13753,name:"Estombra"},{id:9463,name:"Ravasz"}]},404:{guildId:314,guildName:"Sapientiae Malum",leaders:[{id:53394,name:"Horasi"},{id:579078,name:"Glowing"},{id:7020,name:"Golden-Shaman"}]}}},function(e,t,i){function n(){ne=window.foreground,oe=window.gui,se=window.isoEngine,ae=oe.GPS;for(var e=0;e<xe.length;e++){var t=xe[e].key,i=xe[e].type;De[t]=Ae.getValue(oe.playerData.id+"-"+t,0),"bool"===i&&(De[t]=!!De[t])}s(),l()}function o(){for(var e=0;e<xe.length;e++){var t=xe[e].key;Ae.setValue(oe.playerData.id+"-"+t,0)}}function s(){me.on("removed",r),se.on("mapLoaded",l),pe.on("GameRolePlayShowActorMessage",c),oe.playerData.on("characterInfosUpdated",d),oe.playerData.inventory.on("weightUpdated",u),oe.on("GameActionFightTackledMessage",h),se.on("GameFightEndMessage",p),se.on("GameFightStartMessage",f),oe.once("disconnect",a)}function a(){me.removeListener("removed",r),se.removeListener("mapLoaded",l),pe.removeListener("GameRolePlayShowActorMessage",c),
oe.playerData.removeListener("characterInfosUpdated",d),oe.playerData.inventory.removeListener("weightUpdated",u),oe.removeListener("GameActionFightTackledMessage",h),se.removeListener("GameFightEndMessage",p),se.removeListener("GameFightStartMessage",f),oe.removeListener("QuestStartedMessage",te),oe.removeListener("CompassResetMessage",$),J()}function r(){Le=[],null!==Ne&&(clearTimeout(Ne),Ne=null),S()}function l(){Ie.isBeginnerAssistantRequired()&&(Oe=!1,b(),M(),ie(),w())}function c(){Ie.isBeginnerAssistantRequired()&&b()}function d(){Ie.isBeginnerAssistantRequired()&&(y(),w())}function u(){Ie.isBeginnerAssistantRequired()&&M()}function h(e){if(!De.tackleHintShown&&Ie.isBeginnerAssistantRequired({fightContextAllowed:!0})&&e.sourceId===oe.playerData.id){var t=Q(ve("tablet.joris.fight.tackle"));t&&(De.tackleHintShown=!0,Ae.setValue(oe.playerData.id+"-tackleHintShown",1))}}function p(e){J(),Ie.isBeginnerAssistantRequired({fightContextAllowed:!0})&&m(e)}function m(e){if(!De.newEquipmentHintShown&&!oe.uiLocker.isFeatureLocked("inventory")&&e.results&&0!==e.results.length){for(var t=window.gui.playerData.inventory,i=null,n=0;n<e.results.length;n++){var o=e.results[n];if("FightResultPlayerListEntry"===o._type&&o.id===oe.playerData.id&&o.rewards&&o.rewards.objects&&0!==o.rewards.objects.length){for(var s=0;s<o.rewards.objects.length;s+=2){var a=o.rewards.objects[s];if(fe.newEquipmentHintsId.indexOf(a)!==-1&&!t.isGenericItemEquipped(a)){i=a;break}}if(i)break}}i&&Te.getItems([i],function(e){if(e)return console.error(e);var t=Te.items[i],n=t.nameId;C(we.process(ve("tablet.joris.newEquipment","("+n+")"))),De.newEquipmentHintShown=!0,Ae.setValue(oe.playerData.id+"-newEquipmentHintShown",1)})}}function f(){_(),g(),v()}function g(){if(!De.tacticalModeHintShown&&Ie.isBeginnerAssistantRequired({fightContextAllowed:!0})&&fe.noTacticalModeMaps.indexOf(oe.playerData.position.mapId)===-1){var e=Q(ve("tablet.joris.fight.tactical"));e&&(De.tacticalModeHintShown=!0,Ae.setValue(oe.playerData.id+"-tacticalModeHintShown",1))}}function _(){if(!De.creatureModeHintShown&&Ie.isBeginnerAssistantRequired({fightContextAllowed:!0})){var e=!1;for(var t in window.actorManager.actors){var i=window.actorManager.actors[t];if(i.data&&fe.creatureModeHintCreaturesId.indexOf(i.data.creatureGenericId)!==-1){e=!0;break}}if(e){var n=Q(ve("tablet.joris.fight.creatureMode"));n&&(De.creatureModeHintShown=!0,Ae.setValue(oe.playerData.id+"-creatureModeHintShown",1))}}}function v(){if(!De.pingHintShown&&Ie.isBeginnerAssistantRequired({fightContextAllowed:!0})){var e=!1,t=oe.fightManager.getFighter(oe.playerData.id);if(t&&t.data&&!isNaN(t.data.teamId)){var i=t.data.teamId,n=oe.fightManager.getAvailableFighters();for(var o in n)if(Number(o)!==oe.playerData.id&&!(Number(o)<0)){var s=n[o];if(s&&s.data&&s.data.teamId===i){e=!0;break}}if(e){var a=Q(ve("tablet.joris.fight.ping"));a&&(De.pingHintShown=!0,Ae.setValue(oe.playerData.id+"-pingHintShown",1))}}}}function y(){De.dungeonKeyHintShown||Ie.isBeginnerAssistantRequired()&&oe.playerData.inventory.quantityList[fe.incarnamDungeon.keyId]&&(oe.playerData.characterBaseInformations.level<fe.incarnamDungeon.playerLevelThreshold||(C(we.process(ve("tablet.joris.dungeonKey"))),ee(fe.incarnamDungeon.coord.x,fe.incarnamDungeon.coord.y,null,fe.incarnamDungeon.firstMapId),De.dungeonKeyHintShown=!0,Ae.setValue(oe.playerData.id+"-dungeonKeyHintShown",1)))}function b(){oe.playerData.characterBaseInformations.level<fe.minLevelForGuildHint||De.numPlayersMet>=fe.numPlayersMetForGuildHint||0!==window.actorManager.getPlayers().length&&(Oe||(De.numPlayersMet++,Oe=!0,Ae.setValue(oe.playerData.id+"-numPlayersMet",De.numPlayersMet),De.numPlayersMet<fe.numPlayersMetForGuildHint||C(V())))}function M(){if(!De.maxWeightHintShown){var e=window.gui.playerData.inventory;e.weight<e.maxWeight||(C(we.process(ve("tablet.joris.maxWeight"))),De.maxWeightHintShown=!0,Ae.setValue(oe.playerData.id+"-maxWeightHintShown",1))}}function w(){(oe.playerData.characterBaseInformations.level>fe.characterLevelLimit||oe.playerData.position.worldmapId!==fe.INCARNAM_WORLD_MAP)&&X()}function T(){a();for(var e=0;e<xe.length;e++){var t=xe[e].key;Ae.delValue(oe.playerData.id+"-"+t)}}function C(e,t,i){function n(){C(e,t,i)}if(oe.npcDialogUi.inDialog){if(oe.npcDialogUi.actor&&"beginnerAssistant"===oe.npcDialogUi.actor.actorId){if(!e)return;return Le.push({content:e,buttons:t,closeCb:i})}return oe.npcDialogUi.once("closed",n)}if(re){if(!e)return;return Le.push({content:e,buttons:t,closeCb:i})}var o=me.getActor();return o?(le=null,ce=t||[],de=i||null,o.moving?me.once("actorStopped",n):(me.freeze(),e?N(e):E(),void A())):me.once("actorReady",n)}function A(){if(!ce||0===ce.length)return re=oe.newSpeechBubble({title:ve("tablet.joris"),msg:le,actor:me.getActor(),onClose:function(){return de?de():void I()},isLocked:!0,action:function(){re.close()}}),void ne.unlock("beginnerAssistantDialog");ne.lock("beginnerAssistantDialog");for(var e=[],t=0;t<ce.length;t++)e.push(ce[t].buttonText);oe.npcDialogUi.showNpcQuestion(le,e,function(e){var t;return null!==e&&ce[e].callback?t=ce[e].callback:null===e&&de&&(t=de,oe.npcDialogUi.leaveDialog()),t?(le=null,ce=[],de=null,t()):(oe.npcDialogUi.leaveDialog(),void I())},{actor:me.getActor(),npcData:{nameId:ve("tablet.joris")}})}function I(){return re=null,le=null,de=null,ce=[],Le.length>0?void(Ne=setTimeout(function(){Ne=null;var e=Le.shift();C(e.content,e.buttons,e.closeCb)},500)):(ne.unlock("beginnerAssistantDialog"),void me.unfreeze(2e3))}function S(){re&&re.close(),oe.npcDialogUi.inDialog&&(oe.npcDialogUi.leaveDialog(),I())}function E(){var e,t=[];if(fe.exits[oe.playerData.position.mapId]&&t.push({type:"exit",priority:10}),F()&&t.push({type:"nextQuest",priority:8}),oe.playerData.state===Me.STATUS_PHANTOM&&t.push({type:"ghost",priority:20}),Object.keys(oe.playerData.achievements.rewardableAchievements).length>=fe.rewardsPendingHintLimit&&t.push({type:"rewards",priority:3}),U()&&t.push({type:"beginnerHat",priority:5}),j()&&t.push({type:"guild",priority:2}),t.sort(x),0===t.length)return N(ve("tablet.joris.noHint")),void O();for(N(ve("tablet.joris.canIHelp")),e=0;e<t.length&&!(e>=Ee);e++)"exit"===t[e].type?L(D()):"nextQuest"===t[e].type?L(R()):"ghost"===t[e].type?L(q()):"rewards"===t[e].type?L(W()):"beginnerHat"===t[e].type?L(G()):"guild"===t[e].type&&L(Y())}function x(e,t){return t.priority-e.priority}function N(e){var t=new ge("div",{className:"message"});e instanceof ge?t.appendChild(e):t.setHtml(e),le=t}function L(e){return e?void ce.push(e):console.warn("beginnerAssistant.addButton: invalid buttonData")}function O(e){L({buttonText:"Ok",callback:e||S})}function D(){var e=!1,t=!1,i=fe.exits[oe.playerData.position.mapId];if(i&&i.length)for(var n=0;n<i.length;n++){var o=i[n];"sun"===o.type?e=!0:"interactive"===o.type&&(t=!0)}var s;return s=ve(e&&!t?"tablet.joris.exitSun":!e&&t?"tablet.joris.exitInteractive":"tablet.joris.exits"),{buttonText:ve("tablet.joris.searchingExit"),callback:function(){N(s),O(function(){Z(),S()}),A()}}}function R(){var e=H();return 0===e.length?null:{buttonText:ve("tablet.joris.whatToDo"),callback:function(){k(e),A()}}}function P(e,t){return fe.questsHints[t].priority-fe.questsHints[e].priority}function B(e){L({buttonText:ve(e.question),callback:function(){z(e),A()}})}function k(e){if(1===e.length)return z(fe.questsHints[e[0]]);e.sort(P);for(var t=0;t<e.length;t++){var i=fe.questsHints[e[t]];B(i)}}function z(e){N(ve(e.answer)),L({buttonText:ve("tablet.joris.yesPlease"),callback:function(){var t=oe.playerData.position.coordinates;return e.coordinate.x===t.posX&&e.coordinate.y===t.posY?(N(ve("tablet.joris.onTheMap")),L({buttonText:ve("ui.common.ok"),callback:S}),void A()):(ee(e.coordinate.x,e.coordinate.y,e.questId),void S())}}),L({buttonText:ve("tablet.joris.noThanks"),callback:S})}function F(){return H().length>0}function H(){var e=oe.playerData.quests,t=[];for(var i in fe.questsHints)if(!e.all[i]){var n=fe.questsHints[i],o=!0;if(n.requirements&&n.requirements.length>0)for(var s=0;s<n.requirements.length;s++)if(!e.finished[n.requirements[s]]){o=!1;break}o&&t.push(i)}return t}function q(){return{buttonText:ve("tablet.joris.ghostQuestion"),callback:function(){var e=fe.phoenixPosition;N(we.process(ve("tablet.joris.ghostAnswer",e.x,e.y))),L({buttonText:ve("ui.common.ok"),callback:S}),A()}}}function W(){return{buttonText:ve("tablet.joris.rewardsQuestion"),callback:function(){N(ve("tablet.joris.rewardsAnswer")),L({buttonText:ve("ui.common.ok"),callback:S}),A()}}}function U(){var e=oe.playerData.inventory;if(0!==e.getGenericItemCount(fe.beginnerHatGID)&&!e.isGenericItemEquipped(fe.beginnerHatGID)&&!e.equippedItems[Ce.hat])return!0}function G(){return{buttonText:ve("tablet.joris.beginnerHatQuestion"),callback:function(){N(we.process(ve("tablet.joris.beginnerHatAnswer"))),L({buttonText:ve("ui.common.ok"),callback:S}),A()}}}function j(){return!oe.playerData.guild.hasGuild()&&De.numPlayersMet>=2}function Y(){return{buttonText:ve("tablet.joris.guildQuestion"),callback:function(){N(V()),L({buttonText:ve("ui.common.ok"),callback:S}),A()}}}function V(){var e=ve("tablet.joris.guildAnswer"),t=fe.noobGuildData[oe.serversData.connectedServerId];if(!t)return ve("tablet.joris.guildAnswerFailover");t instanceof Array&&(t=t[Math.floor(Math.random()*t.length)]);for(var i="",n=0;n<t.leaders.length;n++)n===t.leaders.length-1&&n>0?i+=ve("tablet.joris.guildAnswerOr"):n>0&&(i+=", "),i+="{player,"+t.leaders[n].name+","+t.leaders[n].id+"}";return e=ye(e,t.guildId,t.guildName,i),e=we.process(e)}function X(){var e=me.getActor();if(!e)return me.once("actorReady",X);var t,i;if(oe.playerData.characterBaseInformations.level>fe.characterLevelLimit)t="tablet.joris.goodByeMaxLevel",i="maxLevel";else{if(oe.playerData.position.worldmapId===fe.INCARNAM_WORLD_MAP)return console.error(new Error("beginnerAssistant: no reason to say good bye"));t="tablet.joris.goodByeIncarnam",i="incarnamLeft"}var n=e.direction;3!==n&&1!==n&&(n=Math.random()<.5?3:1),Ie.setRequired(!1);var o=function(){oe.npcDialogUi.leaveDialog(),setTimeout(function(){Le=[],I(),me.freeze(),me.setAnimation("JumpAndSmoke",n,function(){me.getActor().remove(),"maxLevel"===i&&Ie.removeAndClean()})},300)};C(ve(t),[{buttonText:ve("tablet.joris.goodBye"),callback:o}],o)}function Q(e){if(he&&he.isVisible())return!1;if(he||(he=new Se,he.allowDomEvents(),he.on("dom.touchstart",K),he.open()),"string"==typeof e){var t=new ge("span");t.setHtml(e),e=t}return he.setContent(e),!0}function K(){he&&he.close()}function J(){he&&(K(),he.removeListener("dom.touchstart",K),he.destroy(),he=null)}function Z(){se.removeArrows();var e=fe.exits[oe.playerData.position.mapId];if(e&&e.length)for(var t=0;t<e.length;t++){var i=e[t],n=i.delta||{x:0,y:0};if("tile"===i.target)se.addArrowOnCell(i.targetId,n.x,n.y,void 0,5);else if("interactive"===i.target){var o=se.mapRenderer.identifiedElements[i.targetId];se.addArrowOnGraphic(o,n.x,n.y,void 0,5)}}}function $(){ue&&ue.listening&&(oe.removeListener("QuestStartedMessage",te),oe.removeListener("CompassResetMessage",$)),!ue||null===ue.questId&&null===ue.mapId||ae.removePOI("flag_srv"+be.COMPASS_TYPE_QUEST),ue={questId:null,mapId:null,listening:!1}}function ee(e,t,i,n){$(),ae.addPOI({id:"flag_srv"+be.COMPASS_TYPE_QUEST,x:e,y:t,categoryId:"hint",nameId:"("+e+","+t+")",color:{r:85,g:136,b:0,a:1},isDestination:!0}),oe.on("QuestStartedMessage",te),oe.on("CompassResetMessage",$),ue.listening=!0,ue.questId=i||null,ue.mapId=n||null}function te(e){ue&&ue.questId!==e.questId||$()}function ie(){oe.playerData.position.mapId===fe.incarnamDungeon.firstMapId&&(De.dungeonKeyHintShown=!0,Ae.setValue(oe.playerData.id+"-dungeonKeyHintShown",1)),ue&&ue.mapId===oe.playerData.position.mapId&&$()}var ne,oe,se,ae,re,le,ce,de,ue,he,pe=i(202),me=i(777),fe=i(795),ge=i(321),_e=i(29),ve=_e.getText,ye=_e.processText,be=i(615),Me=i(580),we=i(614),Te=i(461),Ce=Te.positions,Ae=i(176),Ie=i(775),Se=i(768),Ee=3,xe=[{key:"numPlayersMet",type:"int"},{key:"maxWeightHintShown",type:"bool"},{key:"tackleHintShown",type:"bool"},{key:"tacticalModeHintShown",type:"bool"},{key:"creatureModeHintShown",type:"bool"},{key:"pingHintShown",type:"bool"},{key:"dungeonKeyHintShown",type:"bool"},{key:"newEquipmentHintShown",type:"bool"}],Ne=null,Le=[],Oe=!1,De={};t.initialize=n,t.openDialog=C,t.onActorRemoved=r,t.reset=o,t.removeAndClean=T},function(e,t,i){function n(){return!1}function o(e){return x.tutorialQuests[e]||!1}function s(){A=window.gui,I=window.isoEngine,M(),f(),C()||(b(),A.playerData.on("characterInfosUpdated",a),I.on("mapLoaded",r),S.on("GameRolePlayShowActorMessage",l),A.playerData.quests.on("questStarted",c),A.playerData.quests.on("questUpdate",d),A.on("AchievementFinishedMessage",u),A.uiLocker.on("updated",h),A.once("disconnect",p),g("myShop"),r())}function a(){return A.playerData.characterBaseInformations.level>x.characterLevelLimit?m():void g(["spells","carac","bidHouse"])}function r(){return A.playerData.position.worldmapId!==x.INCARNAM_WORLD_MAP?m():void g(["worldMap","friends"])}function l(){g(["friends","directory"])}function c(){g(["quests","bestiary"])}function d(){g("bestiary")}function u(){g("achievements")}function h(e){"job"===e.featureId&&g("job")}function p(){A.playerData.removeListener("characterInfosUpdated",a),I.removeListener("mapLoaded",r),S.removeListener("GameRolePlayShowActorMessage",l),A.playerData.quests.removeListener("questStarted",c),A.playerData.quests.removeListener("questUpdate",d),A.removeListener("AchievementFinishedMessage",u),A.uiLocker.removeListener("updated",h),A.removeListener("disconnect",p),T(!1)}function m(){T(!0),p()}function f(){for(var e in D){var t=D[e];t.alreadyUnlocked||!t.evaluateCurrent||t.evaluateCurrent({init:!0})?t.alreadyUnlocked=!0:(A.uiLocker.lockFeature(e,"beginnerAssistant"),t.alreadyUnlocked=!1)}}function g(e){e?e instanceof Array||(e=[e]):e=Object.keys(D);for(var t=!1,i=0;i<e.length;i++){var n=e[i],o=_(n,!1);t=t||o}t&&b()}function _(e,t){if(!E.isBeginnerAssistantRequired())return!1;var i=D[e];return!i.alreadyUnlocked&&(!!i.evaluateCurrent()&&(i.alreadyUnlocked=!0,A.uiLocker.unlockFeature(e,"beginnerAssistant"),i.jorisDialog&&E.openDialog(L.process(O(i.jorisDialog))),t&&b(),!0))}function v(){m()}function y(){return"beginnerUiLocked"}function b(){var e={};for(var t in D)D[t].alreadyUnlocked||(e[t]=1);N.setValue(y(),e)}function M(){var e=N.getValue(y(),null);if(null!==e)for(var t in D)D[t].alreadyUnlocked=!e[t]}function w(){for(var e in D)D[e].alreadyUnlocked=!1;f(),b(),N.delValue("beginnerUiLocked.alreadyConnectedChars")}function T(e){for(var t in D)D[t].alreadyUnlocked=!0,A.uiLocker.unlockFeature(t,"beginnerAssistant");e&&b()}function C(){for(var e in D)if(!D[e].alreadyUnlocked)return!1;return!0}var A,I,S=i(202),E=i(775),x=i(795),N=i(176),L=i(614),O=i(29).getText,D={spells:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.spells",evaluateCurrent:function(){return A.playerData.characterBaseInformations.level>=3}},carac:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.carac",evaluateCurrent:function(){return A.playerData.characterBaseInformations.level>=2}},bidHouse:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.bidHouse",evaluateCurrent:function(){return A.playerData.characterBaseInformations.level>=8}},worldMap:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.worldMap",evaluateCurrent:function(){var e=A.playerData.position.coordinates;return!A.compass.isInTutorialCorridor(e.posX,e.posY)}},friends:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.friends",evaluateCurrent:function(){return window.actorManager.getPlayers().length>0}},quests:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.quests",evaluateCurrent:function(){for(var e=Object.keys(A.playerData.quests.all),t=0;t<e.length;t++)if(!o(e[t]))return!0;return!1}},koliseum:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:n},directory:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:function(){return D.friends.alreadyUnlocked||D.friends.evaluateCurrent()}},alignment:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:n},bestiary:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.bestiary",evaluateCurrent:function(){for(var e in A.playerData.quests.all){var t=Number(e);if(172===t||199===t||1428===t)return!0;if(826===t){var i=A.playerData.quests.all[826].objectives;if(void 0===i)return A.playerData.quests.finished[826]||console.error(new Error("quest 826 objectives is undefined but quest is not finished")),!0;for(var n=0;n<i.length;n++)if(5246===i[n].objectiveId||5247===i[n].objectiveId)return!0}}return!1}},ornaments:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:n},achievements:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.achievements",evaluateCurrent:function(){for(var e=A.playerData.achievements.finishedAchievementsIds,t=0;t<e.length;t++)if(e[t]===x.achievementsHintId)return!0;return!1}},almanax:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:n},myShop:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.myShop",evaluateCurrent:function(e){if(e&&e.init)return D.myShop.alreadyUnlocked;var t=N.getValue("beginnerUiLocked.alreadyConnectedChars",[]);return t.indexOf(A.playerData.id)!==-1?(N.delValue("beginnerUiLocked.alreadyConnectedChars"),!0):(t.push(A.playerData.id),N.setValue("beginnerUiLocked.alreadyConnectedChars",t),!1)}},job:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.job",evaluateCurrent:function(){return A.playerData.jobs&&Object.keys(A.playerData.jobs.list).length>0}}};t.initialize=s,t.reset=w,t.unlockAll=T,t.removeAndClean=v},function(e,t,i){function n(){this.handlerMap={},this.handlerMap[c]=this.kamaConvertHandler,this.handlerMap[d]=this.kamaConvertHandler,this.handlerMap[u]=this.kamaLostHandler,this.handlerMap[l]=this.guestLimitHandler,this.handlerMap[h]=this.overweightHandler,this.previousConvertedKamaAmount=null}var o=i(366),s=i(29).getText,a=i(713),r=i(799),l=10418,c=221,d=220,u=46,h=10012;n.prototype.initialize=function(){var e=this,t=window.dofus.connectionManager,i={};i[r.TEXT_INFORMATION_MESSAGE]=o.PSEUDO_CHANNEL_INFO,i[r.TEXT_INFORMATION_PVP]=o.CHANNEL_ALLIANCE,i[r.TEXT_INFORMATION_FIGHT]=o.PSEUDO_CHANNEL_FIGHT_LOG,t.on("TextInformationMessage",function(t){if("ADMIN_DEBUG"===t.parameters[0])return console.warn(t.text);var n=1e4*t.msgType+t.msgId,o=e.handlerMap[n];o&&!o.call(e,t)||(t.msgType===r.TEXT_INFORMATION_ERROR?window.gui.chat.logError(t.text):window.gui.chat.logMsg(t.text,i[t.msgType]))})},n.prototype.kamaConvertHandler=function(e){return this.previousConvertedKamaAmount=~~e.parameters[0],!1},n.prototype.kamaLostHandler=function(e){var t=~~e.parameters[0];if(t!==this.previousConvertedKamaAmount)return this.previousConvertedKamaAmount=null,!0;this.previousConvertedKamaAmount=null;var i=a.computeHardPrice(t);return i?(e.text=s("tablet.spent.hard",i),!0):console.warn("Cannot convert currency")},n.prototype.guestLimitHandler=function(){return window.gui.loginScreen.proposeRegistrationAfterGuestLimit(),!1},n.prototype.overweightHandler=function(e){return window.gui.openPopup({title:s("ui.popup.warning"),message:e.text}),!0},e.exports=new n},function(e,t){e.exports={TEXT_INFORMATION_MESSAGE:0,TEXT_INFORMATION_ERROR:1,TEXT_INFORMATION_PVP:2,TEXT_INFORMATION_FIGHT_LOG:3,TEXT_INFORMATION_POPUP:4,TEXT_LIVING_OBJECT:5,TEXT_ENTITY_TALK:6,TEXT_INFORMATION_FIGHT:7}},function(e,t,i){function n(){return c}function o(){s=window.gui,r.call(this),this.lockStatus={};for(var e in d)this.lockStatus[e]={base:null,customLockedReasons:null};this._setupEvents(),this.updateAll()}var s,a=i(172).inherits,r=i(188).EventEmitter,l=!0,c=!1,d={carac:{windowId:"characteristics",menuButtonId:"Carac",evaluateCurrent:n},spells:{windowId:"grimoire",tabId:"spells",menuButtonId:"Spell",evaluateCurrent:n},inventory:{windowId:"equipment",menuButtonId:"Bag",evaluateCurrent:n},bidHouse:{windowId:"bidHouseShop",menuButtonId:"BidHouse",evaluateCurrent:n},worldMap:{windowId:"worldMap",menuButtonId:"Map",evaluateCurrent:n},friends:{windowId:"social",tabId:"friends",menuButtonId:"Friend",evaluateCurrent:n},quests:{windowId:"grimoire",tabId:"quests",menuButtonId:"Book",evaluateCurrent:n},guild:{windowId:"social",tabId:"guild",menuButtonId:"Guild",evaluateCurrent:function(){return s.playerData.guild.hasGuild()?c:l}},koliseum:{windowId:"arena",menuButtonId:"Conquest",evaluateCurrent:n},market:{windowId:"market",tabId:"shop",menuButtonId:"Goultine",evaluateCurrent:n},job:{windowId:"grimoire",tabId:"jobs",menuButtonId:"Job",evaluateCurrent:function(){return s.playerData.jobs&&Object.keys(s.playerData.jobs.list).length>0?c:l}},alliance:{windowId:"social",tabId:"alliance",menuButtonId:"Alliance",evaluateCurrent:function(){return s.playerData.alliance.hasAlliance()?c:l}},mount:{windowId:"mount",menuButtonId:"Mount",evaluateCurrent:function(){return s.playerData.equippedMount?c:l}},directory:{windowId:"social",tabId:"directory",menuButtonId:"Directory",evaluateCurrent:n},alignment:{windowId:"grimoire",tabId:"alignment",menuButtonId:"Alignment",evaluateCurrent:n},bestiary:{windowId:"grimoire",tabId:"bestiary",menuButtonId:"Bestiary",evaluateCurrent:n},ornaments:{windowId:"grimoire",tabId:"ornaments",menuButtonId:"Title",evaluateCurrent:n},achievements:{windowId:"grimoire",tabId:"achievements",menuButtonId:"Achievement",evaluateCurrent:n},almanax:{windowId:"grimoire",tabId:"almanax",menuButtonId:"Almanax",evaluateCurrent:n},spouse:{windowId:"social",tabId:"spouse",menuButtonId:"Spouse",evaluateCurrent:function(){return s.playerData.socialData.spouse?c:l}},myShop:{windowId:"tradeStorage",menuButtonId:"Shop",evaluateCurrent:n}};a(o,r),e.exports=o,o.prototype.updateAll=function(){for(var e in d)this.updateFeatureId(e)},o.prototype.updateFeatureId=function(e){var t=d[e],i=this.lockStatus[e].base,n=t.evaluateCurrent();n!==i&&this._setStatus(e,n)},o.prototype.isFeatureLocked=function(e){return void 0===this.lockStatus[e]?(console.error(new Error("UiLocker.isFeatureLocked: featureId `"+e+"` unknown")),!0):!(this.lockStatus[e].base!==l&&!this.lockStatus[e].customLockedReasons)},o.prototype.isFeatureAvailable=function(e){return!this.isFeatureLocked(e)},o.prototype.isMenuButtonAvailable=function(e){for(var t in d){var i=d[t];if(i.menuButtonId===e)return this.isFeatureAvailable(t)}return console.error(new Error("UiLocker.isMenuButtonAvailable: no feature is matching the menuButtonId "+e)),!1},o.prototype.isTabAvailable=function(e,t){for(var i in d){var n=d[i];if(n.windowId===e&&n.tabId===t)return this.isFeatureAvailable(i)}return console.error(new Error("UiLocker.isTabAvailable: no feature matching window "+e+" w/ tabId "+t)),!1},o.prototype._setStatus=function(e,t,i){var n=d[e];if(!n)return console.error(new Error("UiLocker._setStatus: featureId "+e+" unknown"));var o=this.isFeatureLocked(e),s=this.lockStatus[e],a=s.base;if(i){var r=-1;s.customLockedReasons&&(r=s.customLockedReasons.indexOf(i)),t?r===-1&&(s.customLockedReasons||(s.customLockedReasons=[]),s.customLockedReasons.push(i)):(r!==-1&&(s.customLockedReasons.splice(r,1),0===s.customLockedReasons.length&&(s.customLockedReasons=null)),s.base=n.evaluateCurrent())}else s.base=t;var l=this.isFeatureLocked(e),c=s.base;l===o&&c===a||this.emit("updated",{featureId:e,locked:l,baseLocked:c,menuButtonId:n.menuButtonId,windowId:n.windowId,tabId:n.tabId})},o.prototype._setupEvents=function(){var e=this;s.playerData.jobs.on("jobListUpdated",function(){e.updateFeatureId("job")}),s.playerData.alliance.on("allianceUpdated",function(){e.updateFeatureId("alliance")}),s.playerData.alliance.on("allianceJoined",function(){e.updateFeatureId("alliance")}),s.playerData.alliance.on("allianceLeft",function(){e.updateFeatureId("alliance")}),s.playerData.guild.on("GuildGeneralInformationUpdate",function(){e.updateFeatureId("guild")}),s.playerData.guild.on("guildLeft",function(){e.updateFeatureId("guild")}),s.playerData.on("setMount",function(){e.updateFeatureId("mount")}),s.playerData.on("unsetMount",function(){e.updateFeatureId("mount")}),s.playerData.socialData.on("spouseUpdate",function(){e.updateFeatureId("spouse")}),s.playerData.socialData.on("spouseLeft",function(){e.updateFeatureId("spouse")})},o.prototype.lockFeature=function(e,t){return t?void this._setStatus(e,!0,t):console.error(new Error("UiLocker.lockFeature: a reasonKey is required to lock a feature"))},o.prototype.unlockFeature=function(e,t){return t?void this._setStatus(e,!1,t):console.error(new Error("UiLocker.unlockFeature: a reasonKey is required to unlock a feature"))},o.prototype.lockAllFeatures=function(e){if(!e)return console.error(new Error("UiLocker.lockAllFeatures: a reasonKey is required to lock features"));for(var t in this.lockStatus)this.lockFeature(t,e)},o.prototype.unlockAllFeatures=function(e){if(!e)return console.error(new Error("UiLocker.unlockAllFeatures: a reasonKey is required to unlock features"));for(var t in this.lockStatus)this.unlockFeature(t,e)}},function(e,t,i){function n(e){e.on("connected",function(){o()})}function o(){W=!1,U={},G=[],j=null}function s(e){return W?G.push(e):void(j?V.setImmediate(function(){e(null,j)}):(G.push(e),r()))}function a(e,t){for(var i=0;i<G.length;i++)G[i](e,t);G=[]}function r(){return W=!0,window.wizPurchase?void window.dofus.send("shopIAPListRequest"):h({})}function l(){f(new Error("Request IAP keys failed"))}function c(e){var t=e.iapList;if(!t.length)return h({});for(var i=[],n=0;n<t.length;n++)i.push(t[n].key);u(i)}function d(e){var t;try{var i=new X(e);t=i.times("0.000001").toNumber()}catch(n){return console.error(new Error("Could not parse price "+e)),NaN}return t===1/0||t===-(1/0)?NaN:t}function u(e){return window.wizPurchase?e.length?void window.wizPurchase.getProductDetails(e,function(e){var t=e.products;for(var i in t){var n=t[i],o=d(n.priceMicros);isNaN(o)||(n._parsedPrice=o,U[i]=n)}var s={platform:K.osName,currency:e.currency,country:e.country};h(s)},function(t){return f(new Error("wizPurchase.getProductDetails failed with keys: "+e+" and error: "+t))}):h({}):f(new Error("Purchases are not available on this platform"))}function h(e){e=e||{},window.dofus.send("setShopDetailsRequest",e)}function p(){f(new Error("Request to set shop details failed"))}function m(e){f(null,e.shopDetails)}function f(e,t){return W=!1,e?a(e):(j=t,void a(null,t))}function g(e){e.key||j.goultineOnlyArticles[e.id]||(e._softPrice=$.computeSoftPrice(e.price),e.original_price&&(e._softOriginalPrice=$.computeSoftPrice(e.original_price)))}function _(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];if(n.key){var o=U[n.key];if(!o)continue;n.product=o}else{if(n.currency!==Q.GOULTINE)continue;g(n)}if(n.price&&n.original_price){var s=Math.floor(100-100*n.price/n.original_price);n._promoRate=s?"- "+s+"%":""}for(var a=[],r=!1,l=n.references,c=0;c<l.length;c++){var d=l[c].reference_virtualgift;if(d)for(var u=0;u<d.length;u++)a.push(d[u].id);var h=l[c].reference_kard;if(h)for(var p=0;p<h.length;p++)if("MULTIPLE"===h[p].type){r=!0;break}}n.isMysteryBox=r,n.itemsId=a,t.push(n)}return t}function v(e){var t=J("tablet.price.hard",Z.kamasToString(e.price,""));window.gui.openConfirmPopup({title:J("ui.popup.warning"),message:J("tablet.shop.notEnoughKamas",e.name,t),cb:function(t){t&&M(e,Q.GOULTINE)}})}function y(e){var t=ee.getWindow("buyHardCurrencyConfirm");t.confirmBuy(e)}function b(e){return e?void H(function(t,i){return t?(console.error(t),window.gui.openSimplePopup(J("tablet.shop.couldNotBuy"))):i.length?ee.getWindow("purchasesPending").validatePendingPurchases(i):void ee.getWindow("shopConfirm").confirmBuy({article:e},function(t){if(t){if(!j)return console.error(new Error("Purchase could not be done, store infos are no longer available")),P(),window.gui.openSimplePopup(J("tablet.shop.couldNotBuy"));var i={currency:j.currency,iapKey:e.key,purchase:JSON.stringify([{quantity:1,id:e.id,amount:e.product._parsedPrice}])};console.error("[Haapi info] ShopWindow sending shopBuyIAPRequest with data: "+JSON.stringify(i)),window.dofus.send("shopBuyIAPRequest",i)}})}):console.error(new Error("Trying to buy a non-existent article"))}function M(e,t){if(!e)return console.error(new Error("Trying to buy a non-existent article"));var i=window.gui.playerData.inventory,n=i.goultines,o=i.kamas,s=t===Q.KAMA;if(s&&e._softPrice>o)return v(e);if(!s&&e.price>n){var a=e.price-n;return y(a)}ee.getWindow("shopConfirm").confirmBuy({article:e,isSoft:s},function(i){i&&(te.wKpi.shopBuyPrepare({article:e,currency:t}),window.dofus.send("shopBuyRequest",{currency:t,amountHard:e.price,amountSoft:e._softPrice,purchase:[{quantity:1,id:e.id}],isMysteryBox:e.isMysteryBox}))})}function w(e){var t;return t="android"===e.platform?JSON.stringify({json:e.json,developerPayload:e.developerPayload,signature:e.signature}):e.receipt}function T(e,t,i){return i=i||function(e){e&&console.error(e)},window.wizPurchase?(window.dofus.send("moneyGoultinesAmountRequest"),void window.wizPurchase.finishPurchase(e,!0,function(){return i(null,e)},function(n){return i(new Error("Finish purchase failed for key "+e+" and order id "+t+" with error: "+n),e)})):i(new Error("Purchase should not have been possible on this platform, for key: "+e+" and order id: "+t),e)}function C(e){"RECEIPT_ALREADY_VALIDATED"===e.reason?T(e.iapKey,e.orderId,function(){P()}):(P(),window.gui.openSimplePopup(J("tablet.shop.validateIAPFail")))}function A(e){window.gui.openSimplePopup(J("tablet.shop.validateIAPSuccess"),J("ui.common.informations")),T(e.iapKey,e.buyResult.order_id,function(){P()})}function I(){P(),window.gui.openSimplePopup(J("tablet.shop.buyFail"))}function S(e){P(),window.gui.openSimplePopup(J("tablet.shop.buySuccess"),J("ui.common.informations")),e.currency===Q.GOULTINE&&window.dofus.send("moneyGoultinesAmountRequest"),te.wKpi.shopBuySuccess()}function E(){window.gui.openSimplePopup(J("tablet.shop.mysteryBoxFail"))}function x(e){window.gui.openSimplePopup(J("tablet.shop.mysteryBoxSuccess"),J("ui.common.informations")),te.wKpi.mysteryBoxSuccess(e)}function N(){window.gui.openSimplePopup(J("tablet.shop.restoreMysteryBoxFail"))}function L(e){window.gui.openSimplePopup(J("tablet.shop.restoreMysteryBoxSuccess"),J("ui.common.informations")),te.wKpi.restoreMysteryBoxSuccess(e)}function O(e,t){var i=w(t),n=t.productId;"android"===t.platform?console.error("[Haapi info] ShopWindow sending shopMobileValidateOrderRequest with data: "+JSON.stringify({orderId:e,receipt:i,iapKey:n})):console.error("[Haapi info] ShopWindow sending shopMobileValidateOrderRequest with data: "+JSON.stringify({orderId:e,iapKey:n})),window.dofus.send("shopMobileValidateOrderRequest",{orderId:e,receipt:i,iapKey:n})}function D(){P(),window.gui.openSimplePopup(J("tablet.shop.buyFail"))}function R(e){if(!window.wizPurchase)return console.error(new Error("Purchase should not have been possible on this platform, for key: "+e.iapKey+" and order id: "+e.buyResult.order_id));var t=e.iapKey,i=e.buyResult.order_id;window.wizPurchase.makePurchase(t,function(e){var n=U[t];j?n?Y.trackIAPBought(n._parsedPrice,j.currency,i):console.error(new Error("Could not send event to Adjust, no product found for key: "+t)):console.error(new Error("Could not send event to Adjust, store infos are no longer available")),O(i,e)},function(e){return e===window.WizPurchaseError.ALREADY_OWNED?F():(P(),void window.gui.openSimplePopup(J("tablet.shop.validateIAPFail")))})}function P(){ee.close("shopConfirm")}function B(e){"RECEIPT_ALREADY_VALIDATED"===e.reason?T(e.iapKey,null,function(e,t){ee.getWindow("purchasesPending").validateNextPendingPurchases(e,t)}):ee.getWindow("purchasesPending").validateNextPendingPurchases(new Error("Validate pending order failed for productId: "+e.iapKey+" with reason: "+e.reason),e.iapKey)}function k(e){T(e.iapKey,e.buyResult.order_id,function(e,t){ee.getWindow("purchasesPending").validateNextPendingPurchases(e,t)})}function z(e){var t=w(e),i=e.productId;"android"===e.platform?console.error("[Haapi info] ShopWindow sending shopMobileValidatePendingOrderRequest with data: "+JSON.stringify({receipt:t,iapKey:i})):console.error("[Haapi info] ShopWindow sending shopMobileValidatePendingOrderRequest with data: "+JSON.stringify({
iapKey:i})),window.dofus.send("shopMobileValidatePendingOrderRequest",{receipt:t,iapKey:i})}function F(){return window.wizPurchase?void window.wizPurchase.restoreAllPurchases(function(e){e=e||[],P(),ee.getWindow("purchasesPending").validatePendingPurchases(e)},function(e){console.error(new Error("Restore all purchases failed with error: "+e)),P(),window.gui.openSimplePopup(J("tablet.shop.restoreFailed"))}):console.error(new Error("Restoring purchases should not have been possible on this platform"))}function H(e){return window.wizPurchase?void window.wizPurchase.getPendingPurchases(function(t){return t=t||[],e(null,t)},function(t){return e(new Error("Get pending purchases failed with error: "+t))}):e(new Error("Check pending purchases should not have been possible on this platform"))}function q(){H(function(e,t){return e?console.error(new Error("Check pending purchases failed with error: "+e)):void(t.length&&ee.getWindow("purchasesPending").validatePendingPurchases(t))})}var W,U,G,j,Y=i(312),V=i(31),X=i(802),Q=i(43),K=i(168),J=i(29).getText,Z=i(339),$=i(713),ee=i(194),te=i(7);X.config({ROUNDING_MODE:X.ROUND_HALF_EVEN,ERRORS:!0});var ie=window.dofus.connectionManager;ie.on("setShopDetailsSuccess",m),ie.on("setShopDetailsError",p),ie.on("shopIAPListSuccess",c),ie.on("shopIAPListError",l),ie.on("shopMobileValidateOrderError",C),ie.on("shopMobileValidateOrderSuccess",A),ie.on("shopBuyError",I),ie.on("shopBuySuccess",S),ie.on("mysteryBoxError",E),ie.on("mysteryBoxSuccess",x),ie.on("restoreMysteryBoxError",N),ie.on("restoreMysteryBoxSuccess",L),ie.on("shopBuyIAPError",D),ie.on("shopBuyIAPSuccess",R),ie.on("shopMobileValidatePendingOrderError",B),ie.on("shopMobileValidatePendingOrderSuccess",k),t.initialize=n,t.getStoreInfos=s,t.enrichWithSoftPrice=g,t.validateArticles=_,t.purchaseArticleOnStore=b,t.purchaseArticleOnAnkama=M,t.openNotEnoughHardCurrencyPopup=y,t.validatePendingIAP=z,t.checkPendingPurchases=q},function(e,t,i){var n;!function(o){"use strict";function s(e){function t(e,n){var o,s,a,r,l,c,d=this;if(!(d instanceof t))return G&&O(26,"constructor call without new",e),new t(e,n);if(null!=n&&j(n,2,64,P,"base")){if(n=0|n,c=e+"",10==n)return d=new t(e instanceof t?e:c),D(d,z+d.e+1,F);if((r="number"==typeof e)&&0*e!=0||!new RegExp("^-?"+(o="["+C.slice(0,n)+"]+")+"(?:\\."+o+")?$",n<37?"i":"").test(c))return _(d,c,r,n);r?(d.s=1/e<0?(c=c.slice(1),-1):1,G&&c.replace(/^0\.0*|\./,"").length>15&&O(P,T,e),r=!1):d.s=45===c.charCodeAt(0)?(c=c.slice(1),-1):1,c=i(c,10,n,d.s)}else{if(e instanceof t)return d.s=e.s,d.e=e.e,d.c=(e=e.c)?e.slice():e,void(P=0);if((r="number"==typeof e)&&0*e==0){if(d.s=1/e<0?(e=-e,-1):1,e===~~e){for(s=0,a=e;a>=10;a/=10,s++);return d.e=s,d.c=[e],void(P=0)}c=e+""}else{if(!v.test(c=e+""))return _(d,c,r);d.s=45===c.charCodeAt(0)?(c=c.slice(1),-1):1}}for((s=c.indexOf("."))>-1&&(c=c.replace(".","")),(a=c.search(/e/i))>0?(s<0&&(s=a),s+=+c.slice(a+1),c=c.substring(0,a)):s<0&&(s=c.length),a=0;48===c.charCodeAt(a);a++);for(l=c.length;48===c.charCodeAt(--l););if(c=c.slice(a,l+1))if(l=c.length,r&&G&&l>15&&O(P,T,d.s*e),s=s-a-1,s>U)d.c=d.e=null;else if(s<W)d.c=[d.e=0];else{if(d.e=s,d.c=[],a=(s+1)%I,s<0&&(a+=I),a<l){for(a&&d.c.push(+c.slice(0,a)),l-=I;a<l;)d.c.push(+c.slice(a,a+=I));c=c.slice(a),a=I-c.length}else a-=l;for(;a--;c+="0");d.c.push(+c)}else d.c=[d.e=0];P=0}function i(e,i,n,o){var s,a,l,c,d,h,m,f=e.indexOf("."),g=z,_=F;for(n<37&&(e=e.toLowerCase()),f>=0&&(l=X,X=0,e=e.replace(".",""),m=new t(n),d=m.pow(e.length-f),X=l,m.c=u(p(r(d.c),d.e),10,i),m.e=m.c.length),h=u(e,n,i),a=l=h.length;0==h[--l];h.pop());if(!h[0])return"0";if(f<0?--a:(d.c=h,d.e=a,d.s=o,d=R(d,m,g,_,i),h=d.c,c=d.r,a=d.e),s=a+g+1,f=h[s],l=i/2,c=c||s<0||null!=h[s+1],c=_<4?(null!=f||c)&&(0==_||_==(d.s<0?3:2)):f>l||f==l&&(4==_||c||6==_&&1&h[s-1]||_==(d.s<0?8:7)),s<1||!h[0])e=c?p("1",-g):"0";else{if(h.length=s,c)for(--i;++h[--s]>i;)h[s]=0,s||(++a,h.unshift(1));for(l=h.length;!h[--l];);for(f=0,e="";f<=l;e+=C.charAt(h[f++]));e=p(e,a)}return e}function n(e,i,n,o){var s,a,l,c,d;if(n=null!=n&&j(n,0,8,o,w)?0|n:F,!e.c)return e.toString();if(s=e.c[0],l=e.e,null==i)d=r(e.c),d=19==o||24==o&&l<=H?h(d,l):p(d,l);else if(e=D(new t(e),i,n),a=e.e,d=r(e.c),c=d.length,19==o||24==o&&(i<=a||a<=H)){for(;c<i;d+="0",c++);d=h(d,a)}else if(i-=l,d=p(d,a),a+1>c){if(--i>0)for(d+=".";i--;d+="0");}else if(i+=a-c,i>0)for(a+1==c&&(d+=".");i--;d+="0");return e.s<0&&s?"-"+d:d}function o(e,i){var n,o,s=0;for(d(e[0])&&(e=e[0]),n=new t(e[0]);++s<e.length;){if(o=new t(e[s]),!o.s){n=o;break}i.call(n,o)&&(n=o)}return n}function f(e,t,i,n,o){return(e<t||e>i||e!=m(e))&&O(n,(o||"decimal places")+(e<t||e>i?" out of range":" not an integer"),e),!0}function L(e,t,i){for(var n=1,o=t.length;!t[--o];t.pop());for(o=t[0];o>=10;o/=10,n++);return(i=n+i*I-1)>U?e.c=e.e=null:i<W?e.c=[e.e=0]:(e.e=i,e.c=t),e}function O(e,t,i){var n=new Error(["new BigNumber","cmp","config","div","divToInt","eq","gt","gte","lt","lte","minus","mod","plus","precision","random","round","shift","times","toDigits","toExponential","toFixed","toFormat","toFraction","pow","toPrecision","toString","BigNumber"][e]+"() "+t+": "+i);throw n.name="BigNumber Error",P=0,n}function D(e,t,i,n){var o,s,a,r,l,c,d,u=e.c,h=E;if(u){e:{for(o=1,r=u[0];r>=10;r/=10,o++);if(s=t-o,s<0)s+=I,a=t,l=u[c=0],d=l/h[o-a-1]%10|0;else if(c=y((s+1)/I),c>=u.length){if(!n)break e;for(;u.length<=c;u.push(0));l=d=0,o=1,s%=I,a=s-I+1}else{for(l=r=u[c],o=1;r>=10;r/=10,o++);s%=I,a=s-I+o,d=a<0?0:l/h[o-a-1]%10|0}if(n=n||t<0||null!=u[c+1]||(a<0?l:l%h[o-a-1]),n=i<4?(d||n)&&(0==i||i==(e.s<0?3:2)):d>5||5==d&&(4==i||n||6==i&&(s>0?a>0?l/h[o-a]:0:u[c-1])%10&1||i==(e.s<0?8:7)),t<1||!u[0])return u.length=0,n?(t-=e.e+1,u[0]=h[(I-t%I)%I],e.e=-t||0):u[0]=e.e=0,e;if(0==s?(u.length=c,r=1,c--):(u.length=c+1,r=h[I-s],u[c]=a>0?b(l/h[o-a]%h[a])*r:0),n)for(;;){if(0==c){for(s=1,a=u[0];a>=10;a/=10,s++);for(a=u[0]+=r,r=1;a>=10;a/=10,r++);s!=r&&(e.e++,u[0]==A&&(u[0]=1));break}if(u[c]+=r,u[c]!=A)break;u[c--]=0,r=1}for(s=u.length;0===u[--s];u.pop());}e.e>U?e.c=e.e=null:e.e<W&&(e.c=[e.e=0])}return e}var R,P=0,B=t.prototype,k=new t(1),z=20,F=4,H=-7,q=21,W=-1e7,U=1e7,G=!0,j=f,Y=!1,V=1,X=100,Q={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:" ",fractionGroupSize:0};return t.another=s,t.ROUND_UP=0,t.ROUND_DOWN=1,t.ROUND_CEIL=2,t.ROUND_FLOOR=3,t.ROUND_HALF_UP=4,t.ROUND_HALF_DOWN=5,t.ROUND_HALF_EVEN=6,t.ROUND_HALF_CEIL=7,t.ROUND_HALF_FLOOR=8,t.EUCLID=9,t.config=function(){var e,t,i=0,n={},o=arguments,s=o[0],a=s&&"object"==typeof s?function(){if(s.hasOwnProperty(t))return null!=(e=s[t])}:function(){if(o.length>i)return null!=(e=o[i++])};return a(t="DECIMAL_PLACES")&&j(e,0,N,2,t)&&(z=0|e),n[t]=z,a(t="ROUNDING_MODE")&&j(e,0,8,2,t)&&(F=0|e),n[t]=F,a(t="EXPONENTIAL_AT")&&(d(e)?j(e[0],-N,0,2,t)&&j(e[1],0,N,2,t)&&(H=0|e[0],q=0|e[1]):j(e,-N,N,2,t)&&(H=-(q=0|(e<0?-e:e)))),n[t]=[H,q],a(t="RANGE")&&(d(e)?j(e[0],-N,-1,2,t)&&j(e[1],1,N,2,t)&&(W=0|e[0],U=0|e[1]):j(e,-N,N,2,t)&&(0|e?W=-(U=0|(e<0?-e:e)):G&&O(2,t+" cannot be zero",e))),n[t]=[W,U],a(t="ERRORS")&&(e===!!e||1===e||0===e?(P=0,j=(G=!!e)?f:c):G&&O(2,t+M,e)),n[t]=G,a(t="CRYPTO")&&(e===!!e||1===e||0===e?(Y=!(!e||!g||"object"!=typeof g),e&&!Y&&G&&O(2,"crypto unavailable",g)):G&&O(2,t+M,e)),n[t]=Y,a(t="MODULO_MODE")&&j(e,0,9,2,t)&&(V=0|e),n[t]=V,a(t="POW_PRECISION")&&j(e,0,N,2,t)&&(X=0|e),n[t]=X,a(t="FORMAT")&&("object"==typeof e?Q=e:G&&O(2,t+" not an object",e)),n[t]=Q,n},t.max=function(){return o(arguments,B.lt)},t.min=function(){return o(arguments,B.gt)},t.random=function(){var e=9007199254740992,i=Math.random()*e&2097151?function(){return b(Math.random()*e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var n,o,s,a,r,l=0,c=[],d=new t(k);if(e=null!=e&&j(e,0,N,14)?0|e:z,a=y(e/I),Y)if(g&&g.getRandomValues){for(n=g.getRandomValues(new Uint32Array(a*=2));l<a;)r=131072*n[l]+(n[l+1]>>>11),r>=9e15?(o=g.getRandomValues(new Uint32Array(2)),n[l]=o[0],n[l+1]=o[1]):(c.push(r%1e14),l+=2);l=a/2}else if(g&&g.randomBytes){for(n=g.randomBytes(a*=7);l<a;)r=281474976710656*(31&n[l])+1099511627776*n[l+1]+4294967296*n[l+2]+16777216*n[l+3]+(n[l+4]<<16)+(n[l+5]<<8)+n[l+6],r>=9e15?g.randomBytes(7).copy(n,l):(c.push(r%1e14),l+=7);l=a/7}else G&&O(14,"crypto unavailable",g);if(!l)for(;l<a;)r=i(),r<9e15&&(c[l++]=r%1e14);for(a=c[--l],e%=I,a&&e&&(r=E[I-e],c[l]=b(a/r)*r);0===c[l];c.pop(),l--);if(l<0)c=[s=0];else{for(s=-1;0===c[0];c.shift(),s-=I);for(l=1,r=c[0];r>=10;r/=10,l++);l<I&&(s-=I-l)}return d.e=s,d.c=c,d}}(),R=function(){function e(e,t,i){var n,o,s,a,r=0,l=e.length,c=t%x,d=t/x|0;for(e=e.slice();l--;)s=e[l]%x,a=e[l]/x|0,n=d*s+a*c,o=c*s+n%x*x+r,r=(o/i|0)+(n/x|0)+d*a,e[l]=o%i;return r&&e.unshift(r),e}function i(e,t,i,n){var o,s;if(i!=n)s=i>n?1:-1;else for(o=s=0;o<i;o++)if(e[o]!=t[o]){s=e[o]>t[o]?1:-1;break}return s}function n(e,t,i,n){for(var o=0;i--;)e[i]-=o,o=e[i]<t[i]?1:0,e[i]=o*n+e[i]-t[i];for(;!e[0]&&e.length>1;e.shift());}return function(o,s,r,l,c){var d,u,h,p,m,f,g,_,v,y,M,w,T,C,S,E,x,N=o.s==s.s?1:-1,L=o.c,O=s.c;if(!(L&&L[0]&&O&&O[0]))return new t(o.s&&s.s&&(L?!O||L[0]!=O[0]:O)?L&&0==L[0]||!O?0*N:N/0:NaN);for(_=new t(N),v=_.c=[],u=o.e-s.e,N=r+u+1,c||(c=A,u=a(o.e/I)-a(s.e/I),N=N/I|0),h=0;O[h]==(L[h]||0);h++);if(O[h]>(L[h]||0)&&u--,N<0)v.push(1),p=!0;else{for(C=L.length,E=O.length,h=0,N+=2,m=b(c/(O[0]+1)),m>1&&(O=e(O,m,c),L=e(L,m,c),E=O.length,C=L.length),T=E,y=L.slice(0,E),M=y.length;M<E;y[M++]=0);x=O.slice(),x.unshift(0),S=O[0],O[1]>=c/2&&S++;do{if(m=0,d=i(O,y,E,M),d<0){if(w=y[0],E!=M&&(w=w*c+(y[1]||0)),m=b(w/S),m>1)for(m>=c&&(m=c-1),f=e(O,m,c),g=f.length,M=y.length;1==i(f,y,g,M);)m--,n(f,E<g?x:O,g,c),g=f.length,d=1;else 0==m&&(d=m=1),f=O.slice(),g=f.length;if(g<M&&f.unshift(0),n(y,f,M,c),M=y.length,d==-1)for(;i(O,y,E,M)<1;)m++,n(y,E<M?x:O,M,c),M=y.length}else 0===d&&(m++,y=[0]);v[h++]=m,y[0]?y[M++]=L[T]||0:(y=[L[T]],M=1)}while((T++<C||null!=y[0])&&N--);p=null!=y[0],v[0]||v.shift()}if(c==A){for(h=1,N=v[0];N>=10;N/=10,h++);D(_,r+(_.e=h+u*I-1)+1,l,p)}else _.e=u,_.r=+p;return _}}(),_=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,i=/^([^.]+)\.$/,n=/^\.([^.]+)$/,o=/^-?(Infinity|NaN)$/,s=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(a,r,l,c){var d,u=l?r:r.replace(s,"");if(o.test(u))a.s=isNaN(u)?null:u<0?-1:1;else{if(!l&&(u=u.replace(e,function(e,t,i){return d="x"==(i=i.toLowerCase())?16:"b"==i?2:8,c&&c!=d?e:t}),c&&(d=c,u=u.replace(i,"$1").replace(n,"0.$1")),r!=u))return new t(u,d);G&&O(P,"not a"+(c?" base "+c:"")+" number",r),a.s=null}a.c=a.e=null,P=0}}(),B.absoluteValue=B.abs=function(){var e=new t(this);return e.s<0&&(e.s=1),e},B.ceil=function(){return D(new t(this),this.e+1,2)},B.comparedTo=B.cmp=function(e,i){return P=1,l(this,new t(e,i))},B.decimalPlaces=B.dp=function(){var e,t,i=this.c;if(!i)return null;if(e=((t=i.length-1)-a(this.e/I))*I,t=i[t])for(;t%10==0;t/=10,e--);return e<0&&(e=0),e},B.dividedBy=B.div=function(e,i){return P=3,R(this,new t(e,i),z,F)},B.dividedToIntegerBy=B.divToInt=function(e,i){return P=4,R(this,new t(e,i),0,1)},B.equals=B.eq=function(e,i){return P=5,0===l(this,new t(e,i))},B.floor=function(){return D(new t(this),this.e+1,3)},B.greaterThan=B.gt=function(e,i){return P=6,l(this,new t(e,i))>0},B.greaterThanOrEqualTo=B.gte=function(e,i){return P=7,1===(i=l(this,new t(e,i)))||0===i},B.isFinite=function(){return!!this.c},B.isInteger=B.isInt=function(){return!!this.c&&a(this.e/I)>this.c.length-2},B.isNaN=function(){return!this.s},B.isNegative=B.isNeg=function(){return this.s<0},B.isZero=function(){return!!this.c&&0==this.c[0]},B.lessThan=B.lt=function(e,i){return P=8,l(this,new t(e,i))<0},B.lessThanOrEqualTo=B.lte=function(e,i){return P=9,(i=l(this,new t(e,i)))===-1||0===i},B.minus=B.sub=function(e,i){var n,o,s,r,l=this,c=l.s;if(P=10,e=new t(e,i),i=e.s,!c||!i)return new t(NaN);if(c!=i)return e.s=-i,l.plus(e);var d=l.e/I,u=e.e/I,h=l.c,p=e.c;if(!d||!u){if(!h||!p)return h?(e.s=-i,e):new t(p?l:NaN);if(!h[0]||!p[0])return p[0]?(e.s=-i,e):new t(h[0]?l:3==F?-0:0)}if(d=a(d),u=a(u),h=h.slice(),c=d-u){for((r=c<0)?(c=-c,s=h):(u=d,s=p),s.reverse(),i=c;i--;s.push(0));s.reverse()}else for(o=(r=(c=h.length)<(i=p.length))?c:i,c=i=0;i<o;i++)if(h[i]!=p[i]){r=h[i]<p[i];break}if(r&&(s=h,h=p,p=s,e.s=-e.s),i=(o=p.length)-(n=h.length),i>0)for(;i--;h[n++]=0);for(i=A-1;o>c;){if(h[--o]<p[o]){for(n=o;n&&!h[--n];h[n]=i);--h[n],h[o]+=A}h[o]-=p[o]}for(;0==h[0];h.shift(),--u);return h[0]?L(e,h,u):(e.s=3==F?-1:1,e.c=[e.e=0],e)},B.modulo=B.mod=function(e,i){var n,o,s=this;return P=11,e=new t(e,i),!s.c||!e.s||e.c&&!e.c[0]?new t(NaN):!e.c||s.c&&!s.c[0]?new t(s):(9==V?(o=e.s,e.s=1,n=R(s,e,0,3),e.s=o,n.s*=o):n=R(s,e,0,V),s.minus(n.times(e)))},B.negated=B.neg=function(){var e=new t(this);return e.s=-e.s||null,e},B.plus=B.add=function(e,i){var n,o=this,s=o.s;if(P=12,e=new t(e,i),i=e.s,!s||!i)return new t(NaN);if(s!=i)return e.s=-i,o.minus(e);var r=o.e/I,l=e.e/I,c=o.c,d=e.c;if(!r||!l){if(!c||!d)return new t(s/0);if(!c[0]||!d[0])return d[0]?e:new t(c[0]?o:0*s)}if(r=a(r),l=a(l),c=c.slice(),s=r-l){for(s>0?(l=r,n=d):(s=-s,n=c),n.reverse();s--;n.push(0));n.reverse()}for(s=c.length,i=d.length,s-i<0&&(n=d,d=c,c=n,i=s),s=0;i;)s=(c[--i]=c[i]+d[i]+s)/A|0,c[i]%=A;return s&&(c.unshift(s),++l),L(e,c,l)},B.precision=B.sd=function(e){var t,i,n=this,o=n.c;if(null!=e&&e!==!!e&&1!==e&&0!==e&&(G&&O(13,"argument"+M,e),e!=!!e&&(e=null)),!o)return null;if(i=o.length-1,t=i*I+1,i=o[i]){for(;i%10==0;i/=10,t--);for(i=o[0];i>=10;i/=10,t++);}return e&&n.e+1>t&&(t=n.e+1),t},B.round=function(e,i){var n=new t(this);return(null==e||j(e,0,N,15))&&D(n,~~e+this.e+1,null!=i&&j(i,0,8,15,w)?0|i:F),n},B.shift=function(e){var i=this;return j(e,-S,S,16,"argument")?i.times("1e"+m(e)):new t(i.c&&i.c[0]&&(e<-S||e>S)?i.s*(e<0?0:1/0):i)},B.squareRoot=B.sqrt=function(){var e,i,n,o,s,l=this,c=l.c,d=l.s,u=l.e,h=z+4,p=new t("0.5");if(1!==d||!c||!c[0])return new t(!d||d<0&&(!c||c[0])?NaN:c?l:1/0);if(d=Math.sqrt(+l),0==d||d==1/0?(i=r(c),(i.length+u)%2==0&&(i+="0"),d=Math.sqrt(i),u=a((u+1)/2)-(u<0||u%2),d==1/0?i="1e"+u:(i=d.toExponential(),i=i.slice(0,i.indexOf("e")+1)+u),n=new t(i)):n=new t(d+""),n.c[0])for(u=n.e,d=u+h,d<3&&(d=0);;)if(s=n,n=p.times(s.plus(R(l,s,h,1))),r(s.c).slice(0,d)===(i=r(n.c)).slice(0,d)){if(n.e<u&&--d,i=i.slice(d-3,d+1),"9999"!=i&&(o||"4999"!=i)){+i&&(+i.slice(1)||"5"!=i.charAt(0))||(D(n,n.e+z+2,1),e=!n.times(n).eq(l));break}if(!o&&(D(s,s.e+z+2,0),s.times(s).eq(l))){n=s;break}h+=4,d+=4,o=1}return D(n,n.e+z+1,F,e)},B.times=B.mul=function(e,i){var n,o,s,r,l,c,d,u,h,p,m,f,g,_,v,y=this,b=y.c,M=(P=17,e=new t(e,i)).c;if(!(b&&M&&b[0]&&M[0]))return!y.s||!e.s||b&&!b[0]&&!M||M&&!M[0]&&!b?e.c=e.e=e.s=null:(e.s*=y.s,b&&M?(e.c=[0],e.e=0):e.c=e.e=null),e;for(o=a(y.e/I)+a(e.e/I),e.s*=y.s,d=b.length,p=M.length,d<p&&(g=b,b=M,M=g,s=d,d=p,p=s),s=d+p,g=[];s--;g.push(0));for(_=A,v=x,s=p;--s>=0;){for(n=0,m=M[s]%v,f=M[s]/v|0,l=d,r=s+l;r>s;)u=b[--l]%v,h=b[l]/v|0,c=f*u+h*m,u=m*u+c%v*v+g[r]+n,n=(u/_|0)+(c/v|0)+f*h,g[r--]=u%_;g[r]=n}return n?++o:g.shift(),L(e,g,o)},B.toDigits=function(e,i){var n=new t(this);return e=null!=e&&j(e,1,N,18,"precision")?0|e:null,i=null!=i&&j(i,0,8,18,w)?0|i:F,e?D(n,e,i):n},B.toExponential=function(e,t){return n(this,null!=e&&j(e,0,N,19)?~~e+1:null,t,19)},B.toFixed=function(e,t){return n(this,null!=e&&j(e,0,N,20)?~~e+this.e+1:null,t,20)},B.toFormat=function(e,t){var i=n(this,null!=e&&j(e,0,N,21)?~~e+this.e+1:null,t,21);if(this.c){var o,s=i.split("."),a=+Q.groupSize,r=+Q.secondaryGroupSize,l=Q.groupSeparator,c=s[0],d=s[1],u=this.s<0,h=u?c.slice(1):c,p=h.length;if(r&&(o=a,a=r,r=o,p-=o),a>0&&p>0){for(o=p%a||a,c=h.substr(0,o);o<p;o+=a)c+=l+h.substr(o,a);r>0&&(c+=l+h.slice(o)),u&&(c="-"+c)}i=d?c+Q.decimalSeparator+((r=+Q.fractionGroupSize)?d.replace(new RegExp("\\d{"+r+"}\\B","g"),"$&"+Q.fractionGroupSeparator):d):c}return i},B.toFraction=function(e){var i,n,o,s,a,l,c,d,u,h=G,p=this,m=p.c,f=new t(k),g=n=new t(k),_=c=new t(k);if(null!=e&&(G=!1,l=new t(e),G=h,(h=l.isInt())&&!l.lt(k)||(G&&O(22,"max denominator "+(h?"out of range":"not an integer"),e),e=!h&&l.c&&D(l,l.e+1,1).gte(k)?l:null)),!m)return p.toString();for(u=r(m),s=f.e=u.length-p.e-1,f.c[0]=E[(a=s%I)<0?I+a:a],e=!e||l.cmp(f)>0?s>0?f:g:l,a=U,U=1/0,l=new t(u),c.c[0]=0;d=R(l,f,0,1),o=n.plus(d.times(_)),1!=o.cmp(e);)n=_,_=o,g=c.plus(d.times(o=g)),c=o,f=l.minus(d.times(o=f)),l=o;return o=R(e.minus(n),_,0,1),c=c.plus(o.times(g)),n=n.plus(o.times(_)),c.s=g.s=p.s,s*=2,i=R(g,_,s,F).minus(p).abs().cmp(R(c,n,s,F).minus(p).abs())<1?[g.toString(),_.toString()]:[c.toString(),n.toString()],U=a,i},B.toNumber=function(){return+this},B.toPower=B.pow=function(e){var i,n,o=b(e<0?-e:+e),s=this;if(!j(e,-S,S,23,"exponent")&&(!isFinite(e)||o>S&&(e/=0)||parseFloat(e)!=e&&!(e=NaN)))return new t(Math.pow(+s,e));for(i=X?y(X/I+2):0,n=new t(k);;){if(o%2){if(n=n.times(s),!n.c)break;i&&n.c.length>i&&(n.c.length=i)}if(o=b(o/2),!o)break;s=s.times(s),i&&s.c&&s.c.length>i&&(s.c.length=i)}return e<0&&(n=k.div(n)),i?D(n,X,F):n},B.toPrecision=function(e,t){return n(this,null!=e&&j(e,1,N,24,"precision")?0|e:null,t,24)},B.toString=function(e){var t,n=this,o=n.s,s=n.e;return null===s?o?(t="Infinity",o<0&&(t="-"+t)):t="NaN":(t=r(n.c),t=null!=e&&j(e,2,64,25,"base")?i(p(t,s),0|e,10,o):s<=H||s>=q?h(t,s):p(t,s),o<0&&n.c[0]&&(t="-"+t)),t},B.truncated=B.trunc=function(){return D(new t(this),this.e+1,1)},B.valueOf=B.toJSON=function(){var e,t=this,i=t.e;return null===i?t.toString():(e=r(t.c),e=i<=H||i>=q?h(e,i):p(e,i),t.s<0?"-"+e:e)},null!=e&&t.config(e),t}function a(e){var t=0|e;return e>0||e===t?t:t-1}function r(e){for(var t,i,n=1,o=e.length,s=e[0]+"";n<o;){for(t=e[n++]+"",i=I-t.length;i--;t="0"+t);s+=t}for(o=s.length;48===s.charCodeAt(--o););return s.slice(0,o+1||1)}function l(e,t){var i,n,o=e.c,s=t.c,a=e.s,r=t.s,l=e.e,c=t.e;if(!a||!r)return null;if(i=o&&!o[0],n=s&&!s[0],i||n)return i?n?0:-r:a;if(a!=r)return a;if(i=a<0,n=l==c,!o||!s)return n?0:!o^i?1:-1;if(!n)return l>c^i?1:-1;for(r=(l=o.length)<(c=s.length)?l:c,a=0;a<r;a++)if(o[a]!=s[a])return o[a]>s[a]^i?1:-1;return l==c?0:l>c^i?1:-1}function c(e,t,i){return(e=m(e))>=t&&e<=i}function d(e){return"[object Array]"==Object.prototype.toString.call(e)}function u(e,t,i){for(var n,o,s=[0],a=0,r=e.length;a<r;){for(o=s.length;o--;s[o]*=t);for(s[n=0]+=C.indexOf(e.charAt(a++));n<s.length;n++)s[n]>i-1&&(null==s[n+1]&&(s[n+1]=0),s[n+1]+=s[n]/i|0,s[n]%=i)}return s.reverse()}function h(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function p(e,t){var i,n;if(t<0){for(n="0.";++t;n+="0");e=n+e}else if(i=e.length,++t>i){for(n="0",t-=i;--t;n+="0");e+=n}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}function m(e){return e=parseFloat(e),e<0?y(e):b(e)}var f,g,_,v=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,y=Math.ceil,b=Math.floor,M=" not a boolean or binary digit",w="rounding mode",T="number type has more than 15 significant digits",C="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",A=1e14,I=14,S=9007199254740991,E=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],x=1e7,N=1e9;f=s(),n=function(){return f}.call(t,i,t,e),!(void 0!==n&&(e.exports=n))}(this)},function(e,t,i){var n=i(194),o=i(804),s=i(810),a=i(813),r=i(816),l=i(818),c=i(838),d=i(842),u=i(849),h=i(861),p=i(840),m=i(863),f=i(869),g=i(873),_=i(876),v=i(878),y=i(882),b=i(885),M=i(887),w=i(914),T=i(916),C=i(922),A=i(924),I=i(926),S=i(928),E=i(930),x=i(932),N=i(936),L=i(938),O=i(940),D=i(942),R=i(944),P=i(946),B=i(948),k=i(951),z=i(953),F=i(955),H=i(957),q=i(958),W=i(960),U=i(964),G=i(968),j=i(972),Y=i(974),V=i(977),X=i(979),Q=i(981),K=i(987),J=i(989),Z=i(991),$=i(993),ee=i(995),te=i(448),ie=i(999),ne=i(1022),oe=i(1057),se=i(1059),ae=i(1061),re=i(1063),le=i(1065),ce=i(1067),de=i(1070),ue=i(1072),he=i(1081),pe=i(1088),me=i(1089),fe=i(1091),ge=i(1094),_e=i(1098),ve=i(1100),ye=i(1105),be=i(1107),Me=i(1113),we=i(1115),Te=i(1117),Ce=i(1119),Ae=i(1123),Ie=i(1125),Se=i(1127),Ee=i(1134),xe=i(1145),Ne=i(1147),Le=i(1149);e.exports=function(){var e=new o({enablePresets:!0,dataHandler:window.gui.playerData.inventory}),t=new o({enablePresets:!1,dataHandler:null}),i=new o({enablePresets:!1,dataHandler:window.gui.playerData.inventory});n.addWindow("breedDetail",new r),n.addWindow("breeding",new l,{fixed:!0,group:"inventory"}),n.addWindow("cancel",new Te),n.addWindow("characterCreation",new ue,{fixed:!0}),n.addWindow("serverSimpleSelection",new j,{fixed:!0}),n.addWindow("serverListSelection",new U,{fixed:!0}),n.addWindow("serverDetails",new W),n.addWindow("serverSelection",new G,{fixed:!0}),n.addWindow("worldMap",new ie),n.addWindow("characteristics",new c,{group:"mainGroup"}),n.addWindow("characUpdate",new p),n.addWindow("fightEnd",new v),n.addWindow("fightList",new y),n.addWindow("itemAppearance",new N),n.addWindow("itemBox",new L),n.addWindow("itemManage",new O),n.addWindow("itemRecipes",new D),n.addWindow("itemSets",new R),n.addWindow("levelUp",new P),n.addWindow("rewardsPending",new q),n.addWindow("characterSelection",new d,{fixed:!0}),n.addWindow("giftSelection",new u,{fixed:!0}),n.addWindow("deleteCharacterConfirm",new h,{fixed:!0}),n.addWindow("options",new Ce),n.addWindow("adminConsole",new s),n.addWindow("document",new m),n.addWindow("houseBuySell",new x),n.addWindow("teleporterList",new Y),n.addWindow("exchangeInventory",new V(e),{group:"inventory"}),n.addWindow("exchangeStorage",new X(t)),n.addWindow("wallet",new ee),n.addWindow("tradeInventory",new Z(e),{group:"inventory"}),n.addWindow("tradeStorage",new $),n.addWindow("tradeMode",new J),n.addWindow("tradeItem",new Q),n.addWindow("tradeItemConfirm",new K),n.addWindow("bidHouseShop",new te),n.addWindow("mimicry",new B),n.addWindow("itemPicking",new k(e),{group:"inventory"}),n.addWindow("padlock",new z),n.addWindow("global",new b),n.addWindow("prismVulnerabilityDate",new w),n.addWindow("socialGroupCreation",new T),n.addWindow("allianceCard",new C),n.addWindow("guildCard",new A),n.addWindow("guildHouseInfo",new I),n.addWindow("guildHouseSetting",new S),n.addWindow("equipment",new f(e),{group:"inventory"}),n.addWindow("estateForSale",new g),n.addWindow("estateInformation",new _),n.addWindow("partyInviteDetails",new F),n.addWindow("presetChooseIcon",new H),n.addWindow("arena",new a),n.addWindow("grimoire",new M,{group:"mainGroup"}),n.addWindow("social",new ne,{group:"mainGroup"}),n.addWindow("paddockBuy",new oe),n.addWindow("mount",new se),n.addWindow("feed",new ae(i)),n.addWindow("mountRename",new re),n.addWindow("familyTree",new le),n.addWindow("jobOptions",new ce),n.addWindow("spellForget",new de),n.addWindow("crafting",new he),n.addWindow("craftingMulti",new pe),n.addWindow("craftersList",new me),n.addWindow("crafter",new fe),n.addWindow("craftMagus",new ge),n.addWindow("craftMagusMulti",new _e),n.addWindow("craftPayment",new ve),n.addWindow("craftInventory",new ye(e),{group:"inventory"}),n.addWindow("tradeWithNPC",new Me),n.addWindow("tradeWithPlayer",new be),n.addWindow("tradeWithPlayerAndNPCInventory",new we(e),{group:"inventory"}),n.addWindow("guildMemberRights",new E),n.addWindow("fightEndRewards",new Ae),n.addWindow("hardcoreDeath",new Ie),n.addWindow("purchasesPending",new Ne),n.addWindow("buyHardCurrencyConfirm",new xe),n.addWindow("shopConfirm",new Se),n.addWindow("market",new Ee),n.addWindow("recaptcha",new Le)}},function(e,t,i){function n(e,t,i,n,o,s){return e.position===S&&(0!==t&&(!(this.filteringOptions.usable&&!e.item.usable)&&(!!this.filterCategories[i]&&((i===this.filteringOptions.filterId||!o)&&((e.item.typeId===this.filteringOptions.subFilterId||!s)&&(!n||e.item.getNameForSearch().indexOf(n)!==-1))))))}function o(e){p.call(this),e=e||{},this.itemList={},this.itemsQuantityList={},this.slotList={},this._filters=[n],this.weight=0,this.maxWeight=1,this.enablePresets=e.enablePresets;var t=e.dataHandler;t&&(this._setupEvents(t),this.enablePresets&&this.on("StorageViewerOpen",function(){this.setWeight(t.weight,t.maxWeight),this.setKamas(t.kamas)})),this.currentOpenedWindow=null,this.selectedSlot=null,this.slotToShow=null,this.filterCategories={};for(var i in _.categories)this.filterCategories[_.categories[i]]=!0;this.filteringOptions={},this.storageUI=new A("div",{className:"StorageViewer"}),this.domIsCreated=!1,this.contentInitiated=!1,this.listUpdateRequested=null,this.sortingCriterias=["none"],this.currentPage=-1,this.pageCount=-1,this.dragSourceData={}}function s(){this.addClassNames("pressed")}function a(){this.delClassNames("pressed")}function r(e){var t=new A("div",{className:["arrow",e]});return C(t),t.on("tapstart",s),t.on("tapend",a),t}function l(e,t,i){var n=i.storageViewer.currentOpenedWindow;return!n.prepareForDragFunction||n.prepareForDragFunction(e,t,i)}function c(e,t,i){return t[i]-e[i]}function d(e,t,i){for(var n=0,o=e.length;n<o;n+=1){var s=e[n],a=E[s]||c,r=a(t,i,s);if(0!==r)return r}return 0}i(805);var u=i(337).addTooltip,h=i(317),p=i(188).EventEmitter,m=i(29).getText,f=i(339),g=i(172).inherits,_=i(461),v=i(737),y=i(528),b=i(733),M=i(806),w=i(557),T=i(198).events,C=i(197),A=i(321),I=40,S=_.positions.notEquipped;g(o,p),e.exports=o,o.prototype._updatePageSystem=function(){var e=this.currentOpenedWindow;e&&(e._storageViewer=e._storageViewer||{},this.slotsMask.setStyles({width:e.availableSlotBoxWidth,height:e.availableSlotBoxHeight}),this._updatePageCount(e),this.slotsBox.setStyle("height",e._storageViewer.slotsPerColumn*this.pageCount*I+"px"),this.slotsContainer.delClassNames("spinner"),this.slotsBox.show())},o.prototype._updatePageCount=function(e){var t=e._storageViewer;if(t.slotsPerPage){var i=Math.ceil(this.displayedSlotCount/t.slotsPerPage)||1;i!==this.pageCount&&(this.pageCount=i,this._displayPage(0),this.pagination.setPageCount(i))}},o.prototype._getAvailableSpaceAndUpdatePageSystem=function(){var e=this.currentOpenedWindow;if(!e)return!1;var t=e._storageViewer,i=this.slotsContainer.rootElement.clientHeight;if(0===i)return!1;var n=this.slotsContainer.rootElement.clientWidth,o=Math.floor(n/I);return t.slotsPerColumn=Math.floor(i/I),t.slotsPerPage=o*t.slotsPerColumn,e.availableSlotBoxWidth=o*I+"px",e.availableSlotBoxHeight=t.slotsPerColumn*I+"px",this._updatePageSystem(),!0},o.prototype._initializeView=function(){this._getAvailableSpaceAndUpdatePageSystem()&&this.slotToShow&&this._displaySlotPage(this.slotToShow)},o.prototype.registerView=function(e,t){var i=this;t=t||{},e.on("open",function(){var n=i.currentOpenedWindow=this;if(i.dragSourceData.source=this.id,n.tapSelectedEmitsDoubleTap=t.tapSelectedEmitsDoubleTap,n.prepareForDragFunction=t.prepareForDragFunction,i.contextParams=t.contextParams||{},i.enableAveragePrice=!t.hasOwnProperty("enableAveragePrice")||t.enableAveragePrice,i.enableSlotContext=!t.hasOwnProperty("enableSlotContext")||t.enableSlotContext,i.domIsCreated||(i._createDom(),i.domIsCreated=!0),i.averagePrice.toggleDisplay(!!i.enableAveragePrice),i.listUpdateRequested?(i.setItemList(i.listUpdateRequested),i.listUpdateRequested=null):t.manualReset||i.resetDisplay(),t.manualOpening||e.windowBody.appendChild(i.storageUI),e.availableSlotBoxWidth?i._updatePageSystem():(i.slotsBox.hide(),i.slotsContainer.addClassNames("spinner")),i.currentOpenedWindow!==i.lastOpenedWindow){i.leftArrow.toggleDisplay(!!t.leftArrow),i.rightArrow.toggleDisplay(!!t.rightArrow),i.slotsMask.toggleClassName("hoverable",!!t.showHoverFrame);var o;if(!i.listUpdateRequested)for(o in i.slotList){var s=i.slotList[o];s.data&&(i.contextParams.item=s.data,s.setContextMenu("item",i.contextParams),s.enableContextMenu(!!i.enableSlotContext))}var a={equipment:!0,consumables:!0,resources:!0,quest:!1,preset:!1};for(o in _.categories){var r=!(!t.filters||!t.filters[o])||a[o];i.filter.toggleCategoryDisplay(_.categories[o],r),i.filter.selectedFilter!==_.categories[o]||r||i.filter.selectCategory(-1)}}i.contentInitiated=!0,i.emit("StorageViewerOpen")}),e.on("opened",function(){i.domIsCreated?i._initializeView():i.once("domCreated",i._initializeView)}),e.on("close",function(){i.lastOpenedWindow=i.currentOpenedWindow,i.currentOpenedWindow=null})},o.prototype._createDom=function(){var e=this,t=this.storageUI=new A("div",{className:"StorageViewer"}),i=t.createChild("div",{className:"filterBox"}),n=this.leftArrow=i.appendChild(r("left"));u(n,m("ui.storage.advancedTransferts")),n.on("tap",function(t){e.currentOpenedWindow&&e.currentOpenedWindow.emit("leftArrow-tap",t)}),this.filter=i.appendChild(new y),this.enablePresets&&(this.presetsBox=t.appendChild(new M),this.presetsBox.on("setItemSlotTapped",function(t){t.data&&"placeholder"===t.data.mountLocation||e.currentOpenedWindow.emit("slot-tap",t)})),this.filter.toggleCategoryDisplay(_.categories.preset,!!this.enablePresets),this.filter.on("filter",function(t,i,n){var o=e.filteringOptions.filterId!==t||e.filteringOptions.subFilterId!==i||e.filteringOptions.search!==n;if(o){var s=e.filteringOptions.filterId===t;e.filteringOptions.filterId=t,e.filteringOptions.subFilterId=i,e.filteringOptions.search=n,e.filterList(),e._displayPage(0),e.presetsBox&&e._enablePresetsView(t===_.categories.preset),s||e._getAvailableSpaceAndUpdatePageSystem(),e.emit("filter",t)}}),n=this.rightArrow=i.appendChild(r("right")),u(n,m("ui.storage.advancedTransferts")),n.on("tap",function(t){e.currentOpenedWindow&&e.currentOpenedWindow.emit("rightArrow-tap",t)}),this.slotsContainer=t.createChild("div",{className:"slotBox"}),this.slotsMask=this.slotsContainer.createChild("div",{className:"slotsMask"}),this.slotsBox=this.slotsMask.createChild("div",{className:"slots"}),this.slotsBox.hide(),this.slotsBox.rootElement.addEventListener(T.end,function(e){e.preventDefault()},!1),this.pagination=t.appendChild(new b),this.pagination.on("previous",function(){e._displayPage(e.currentPage-1)}),this.pagination.on("next",function(){e._displayPage(e.currentPage+1)}),this.pagination.on("page",function(t){e._displayPage(t)});var o=this.podContainer=t.createChild("div",{className:"podContainer"}),s=o.createChild("div",{className:"priceBox"});this.averagePrice=s.createChild("div",{className:"averagePrice",text:0}),u(this.averagePrice,function(){var t=f.kamasToString(e.averagePriceValue);return new A("div",{text:m("ui.storage.estimatedValue")+m("ui.common.colon")+t})}),this.kamas=s.createChild("div",{className:"kamas",text:0}),u(this.kamas,function(){var t=f.kamasToString(e.kamasValue);return new A("div",{text:m("ui.storage.ownedKamas")+m("ui.common.colon")+t})});var a=o.createChild("div",{className:"progressBarContainer"});this.barLabel=a.createChild("div",{text:m("tablet.common.pods")+":",className:"label"}),this.progressBar=a.appendChild(new w({className:"green"})),u(this.progressBar,function(){return new A("div",{text:f.intToString(e.weight)+" / "+f.intToString(e.maxWeight)})}),this.emit("domCreated")},o.prototype.setBarLabel=function(e){this.barLabel.setText(e)},o.prototype._enablePresetsView=function(e){this.filter.subFiltersBox.toggleDisplay(!e),this.pagination.toggleDisplay(!e),this.podContainer.toggleDisplay(!e),this.kamas.toggleDisplay(!e),this.presetsBox.toggleDisplay(e)},o.prototype._filter=function(e,t,i,n,o,s){for(var a=0,r=this._filters.length;a<r;a+=1){var l=this._filters[a];if(!l.call(this,e,t,i,n,o,s))return!1}return!0},o.prototype._displayPage=function(e){if(this.currentPage!==e&&this.currentOpenedWindow&&!(e<0||e>this.pageCount-1)){var t=this.currentOpenedWindow._storageViewer;this.currentPage=e;var i="translateY(-"+e*t.slotsPerColumn*I+"px)";this.slotsBox.setStyles({webkitTransform:i,transform:i}),this.pagination.setCurrent(e)}},o.prototype.addFilters=function(e){for(var t=0,i=e.length;t<i;t+=1)this._filters.push(e[t])},o.prototype.removeFilter=function(e){var t=this._filters;t.indexOf(e)!==-1?t.splice(t.indexOf(e),1):console.error(new Error("StorageViewer: remove unknown filter"))},o.prototype.clearFilters=function(){this._filters=[n]},o.prototype._updateAveragePrice=function(){var e=0;for(var t in this.slotList)if(this.slotList[t].isVisible()){var i=this.itemList[t];if(!i)continue;var n=i.item.averagePrice===-1?0:i.item.averagePrice;e+=n*this.itemsQuantityList[t]}this.averagePriceValue=e,this.averagePrice.setText(f.intToString(e))},o.prototype._updateFilter=function(){var e={};for(var t in this.itemList){
var i=this.itemList[t];if(i.isInitialised&&i.position===S&&this.itemsQuantityList[t]>0){if(!i.item){console.error(new Error('Missing the property "item" for itemInstance: '+i.id));continue}e[i.item.typeId]=!0}}this.filter.updateSubFilters(Object.keys(e))},o.prototype._filterItem=function(e){var t=this.filteringOptions.search?f.simplifyString(this.filteringOptions.search):null,i=this.filteringOptions.filterId!==y.filters.all,n=this.filteringOptions.subFilterId!==y.subFilters.all,o=_.getItemTypeMap(),s=o[e.item.typeId].category,a=this.itemsQuantityList[e.objectUID],r=a&&this._filter(e,a,s,t,i,n),l=this.slotList[e.objectUID];l.isVisible()&&(this.displayedSlotCount-=1),r?(this.displayedSlotCount+=1,l.show()):(this.unSelectSlot(e.objectUID),l.hide()),this._updatePageSystem(),this.enableAveragePrice&&this._updateAveragePrice()},o.prototype.filterList=function(){var e=this.filteringOptions.search?f.simplifyString(this.filteringOptions.search):null,t=this.filteringOptions.filterId!==y.filters.all,i=this.filteringOptions.subFilterId!==y.subFilters.all,n=_.getItemTypeMap();this.displayedSlotCount=0;for(var o in this.itemList){var s=this.itemList[o];if(s.isInitialised){var a=n[s.item.typeId].category,r=this._filter(s,this.itemsQuantityList[o],a,e,t,i),l=this.slotList[s.objectUID];r?(this.displayedSlotCount+=1,l.show()):(this.unSelectSlot(s.objectUID),l.hide())}}this._updatePageSystem(),this.enableAveragePrice&&this._updateAveragePrice()},o.prototype.getDisplayedItemsUIDs=function(){var e=[],t=this.slotList;for(var i in t)t[i].isVisible()&&e.push(i);return e},o.prototype._createSlot=function(e){var t=new v({itemData:e,enableContextMenu:this.enableSlotContext});t.storageViewer=this,t.setQuantity(e.quantity),t.setContextMenu("item",this.contextParams);var i=this;return t.on("tap",function(e){t!==i.selectedSlot?(i.selectSlot(t),i.currentOpenedWindow.emit("slot-tap",t,e.x,e.y)):i.currentOpenedWindow.tapSelectedEmitsDoubleTap&&i.currentOpenedWindow.emit("slot-doubletap",t,e.x,e.y)}),t.on("doubletap",function(e){i.currentOpenedWindow.emit("slot-doubletap",this,e.x,e.y)}),t.on("dragStart",function(){h.setElementSource(this,i.currentOpenedWindow.id),i.dragSourceData.slot=t,i.currentOpenedWindow.emit("slot-dragStart",t)}),h.setDraggable(t,{backgroundImage:t.getImage(),prepareForDrag:l},"storageViewer",i.dragSourceData),this.emit("slotCreated",t),t};var E={none:function(e,t){return t.objectUID-e.objectUID},name:function(e,t){return t.item.nameId.localeCompare(e.item.nameId)},level:function(e,t){return t.item.level-e.item.level},totalWeight:function(e,t){return t.quantity*t.weight-e.quantity*e.weight},averagePrice:function(e,t){var i=e.item.averagePrice;i=i===-1?0:i;var n=t.item.averagePrice;return n=n===-1?0:n,n-i},totalAveragePrice:function(e,t){var i=e.item.averagePrice;i=i===-1?0:i;var n=t.item.averagePrice;return n=n===-1?0:n,t.quantity*i-e.quantity*n},category:function(e,t){t.item.type.nameId.localeCompare(e.item.type.nameId)}};o.prototype._positionItem=function(e){for(var t=this.slotsBox.getChildren(),i=this.slotList[e.objectUID],n=this,o=0,s=t.length;o<s;o+=1)if(d(n.sortingCriterias,e,t[o].itemInstance)<0)return void i.insertBefore(t[o]);this.slotsBox.appendChild(i)},o.prototype._displaySlotPage=function(e){var t=this.currentOpenedWindow&&this.currentOpenedWindow._storageViewer;if(!t||!t.slotsPerPage)return void(this.slotToShow=e);this.slotToShow=null;for(var i=this.slotsBox.getChildren(),n=0,o=0;o<i.length;o++){var s=i[o];if(s.isVisible()){if(s===e)return void this._displayPage(~~(n/t.slotsPerPage));n++}}},o.prototype.sortBy=function(e){if(e){this.sortingCriterias=e;for(var t=this.itemList,i=Object.keys(t).sort(function(i,n){return d(e,t[i],t[n])}),n=0,o=i.length;n<o;n+=1){var s=this.slotList[i[n]];this.slotsBox.appendChild(s)}}},o.prototype.resetDisplay=function(){for(var e in this.itemList){var t=this.itemsQuantityList[e]=this.itemList[e].quantity;this.slotList[e]&&this.slotList[e].setQuantity(t)}this.filter.reset(),this.pageCount=-1,this.currentPage=-1,this._updatePageSystem(),this.selectedSlot&&this.unSelectSlot()},o.prototype.unloadContent=function(){this.slotList={},this.slotsBox&&this.slotsBox.clearContent(),this.itemsQuantityList={},this.itemList=[],this.selectedSlot=null,this.contentInitiated=!1},o.prototype.setItemList=function(e){this.slotList={},this.slotsBox.clearContent(),this.itemsQuantityList={},this.itemList=e,this.selectedSlot=null;for(var t in this.itemList){var i=this.itemList[t];this.slotList[t]=this._createSlot(i),this.itemsQuantityList[t]=i.quantity}this.filterList(),this._updateFilter(),this.filter.reset(),this.sortBy(this.sortingCriterias)},o.prototype.modifyItem=function(e){if(this.contentInitiated){var t=e.objectUID,i=this.slotList[t];i&&(this.unSelectSlot(t),i.destroy()),this.slotList[t]=this._createSlot(e),this.itemList[t]=e,this.itemsQuantityList[t]=e.quantity,this._positionItem(e),this._filterItem(e),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemModified",e)}},o.prototype.moveItem=function(e){this.contentInitiated&&(this._filterItem(e),this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemMoved",e))},o.prototype.setItemQuantity=function(e,t){if(this.contentInitiated){var i=this.slotList[e];if(!i)return console.warn("StorageViewer.setItemQuantity: no slot with item UID "+e);i.setQuantity(t),this.itemsQuantityList[e]=t,this._filterItem(this.itemList[e]),this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemQuantity",this.itemList[e],t)}},o.prototype.setItemsQuantity=function(e){if(this.contentInitiated){for(var t in e){var i=this.slotList[t],n=e[t];i.setQuantity(n),this.itemsQuantityList[t]=n,this._filterItem(this.itemList[t])}this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemsQuantity",e)}},o.prototype.resetItemQuantity=function(e){var t=this.itemList[e];t&&this.setItemQuantity(e,t.quantity)},o.prototype.resetItemsQuantity=function(){for(var e in this.itemList)this.resetItemQuantity(e)},o.prototype._addItem=function(e){var t=e.objectUID,i=this.slotList[t];i&&(this.unSelectSlot(t),i.destroy()),i=this.slotList[t]=this._createSlot(e),i.hide(),this.itemList[t]=e,this.itemsQuantityList[t]=e.quantity},o.prototype.addItem=function(e){this.contentInitiated&&(this._addItem(e),this._filterItem(e),this._positionItem(e),this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemAdded",e))},o.prototype.addItems=function(e){if(this.contentInitiated){for(var t in e){var i=e[t];this._addItem(i),this._filterItem(i),this._positionItem(i)}this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemsAdded",e)}},o.prototype._removeItem=function(e){var t=this.slotList[e];this.unSelectSlot(t.itemInstance.objectUID),t.destroy(),delete this.slotList[e],delete this.itemList[e],delete this.itemsQuantityList[e]},o.prototype.removeItems=function(e){if(this.contentInitiated){for(var t=0,i=e.length;t<i;t+=1)this._removeItem(e[t]);this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemsRemoved",e),this._updateAveragePrice()}},o.prototype.removeItem=function(e){this.contentInitiated&&(this._removeItem(e),this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemRemoved",e),this._updateAveragePrice())},o.prototype.setPodProgressBarValue=function(e){this.progressBar.setValue(e),this.progressBar.toggleClassName("green",e<.75),this.progressBar.toggleClassName("yellow",e>=.75&&e<.9),this.progressBar.toggleClassName("orange",e>=.9&&e<1),this.progressBar.toggleClassName("red",e>=1)},o.prototype.setMaxWeight=function(e){this.maxWeight=e||1,this.contentInitiated&&(this.setPodProgressBarValue(this.weight/this.maxWeight),this.currentOpenedWindow&&this.currentOpenedWindow.emit("weightUpdated",this.weight,this.maxWeight))},o.prototype.setWeight=function(e,t){this.weight=e,this.maxWeight=t||this.maxWeight,this.contentInitiated&&(this.setPodProgressBarValue(this.weight/this.maxWeight),this.currentOpenedWindow&&this.currentOpenedWindow.emit("weightUpdated",e,this.maxWeight))},o.prototype.setKamas=function(e){this.contentInitiated&&(this.kamasValue=e,this.kamas.setText(f.intToString(e)),this.currentOpenedWindow&&this.currentOpenedWindow.emit("kamasUpdated",e))},o.prototype.selectAndShowSlotByGID=function(e){for(var t in this.slotList){var i=this.itemList[t];if(i.getProperty("id")===e&&this._selectSlotAndDisplayPage(this.slotList[t]))return i}return null},o.prototype.getSlotByUID=function(e){return this.slotList[e]},o.prototype.selectAndShowSlotByUID=function(e){var t=this.slotList[e];return t&&this._selectSlotAndDisplayPage(t)?t.itemInstance:null},o.prototype._selectSlotAndDisplayPage=function(e){return!!e.isVisible()&&(this.selectSlot(e),this._displaySlotPage(e),!0)},o.prototype.selectSlot=function(e,t){this.selectedSlot&&e!==this.selectedSlot&&this.selectedSlot.unselect(),e&&e.select(t),this.selectedSlot=e},o.prototype.unSelectSlot=function(e){if(void 0===e)return void(this.selectedSlot&&(this.selectedSlot.unselect(),this.selectedSlot=null));var t=this.slotList[e];this.selectedSlot===t&&(t.unselect(),this.selectedSlot=null)},o.prototype.toggleSlotSelection=function(e){var t=this.slotList[e];this.selectedSlot!==t?(this.selectedSlot&&this.selectedSlot.unselect(),t.select(),this.selectedSlot=t):(t.unselect(),this.selectedSlot=null)},o.prototype.getSelectedSlot=function(){return this.selectedSlot},o.prototype._setupEvents=function(e){var t=this;e.on("listUpdate",function(e){t.currentOpenedWindow?t.setItemList(e):t.listUpdateRequested=e}),e.on("unloaded",function(){t.unloadContent()}),e.on("itemAdded",function(e){t.addItem(e)}),e.on("itemsAdded",function(e){t.addItems(e)}),e.on("itemDeleted",function(e){t.removeItem(e)}),e.on("itemsDeleted",function(e){t.removeItems(e)}),e.on("itemModified",function(e){t.modifyItem(e)}),e.on("itemMoved",function(e){t.moveItem(e)}),e.on("itemQuantity",function(e,i){t.setItemQuantity(e,i)}),e.on("itemsQuantity",function(e){t.setItemsQuantity(e)}),e.on("kamasUpdated",function(e){t.setKamas(e)}),e.on("weightUpdated",function(e,i){t.setWeight(e,i)}),e.on("sort",function(e){t.sortBy(e)})},o.prototype.getDisplayedQuantity=function(e){return this.itemsQuantityList[e]}},function(e,t){},function(e,t,i){function n(){function e(){var e=L.setSlotsBox.selectedSlot;t(!e.preset),e.preset?(L.deleteSetButton.enable(),L.saveSetButton.enable()):(L.deleteSetButton.disable(),L.saveSetButton.disable());var i=window.gui.playerData.inventory.presets;Object.keys(i).length>=g?L.addSetButton.disable():L.addSetButton.enable()}function t(e){L.explanationPanel.toggleDisplay(e),L.setItemSlotsBox.toggleDisplay(!e),L.buttonsBox.toggleDisplay(!e)}function i(e){function t(t){if("remove"===t){var n=L.setSlotsBox.selectedSlot.preset.presetId,o=i.nameId||i.item.nameId;I(o,n,function(t){t===f.YES?L.saveCustom=!0:e.setItem(i)})}}var i=e.itemInstance||e.dbItem;e.setContextMenu("preset",{slot:e,canRemove:!0,onClose:t})}function n(t){t.select();var i;L.setSlotsBox.getChild(t.getWuiName())?(i=L.setSlotsBox,L._displaySet(t.preset)):L.setItemSlotsBox.getChild(t.getWuiName())?(i=L.setItemSlotsBox,L.emit("setItemSlotTapped",t)):i=L.setIconsBox,i.selectedSlot&&t!==i.selectedSlot&&i.selectedSlot.unselect(),i.selectedSlot=t,i===L.setSlotsBox&&e()}function c(e){e.preset&&(window.dofus.sendMessage("InventoryPresetUseMessage",{presetId:e.preset.presetId}),L.addClassNames("spinner"))}function h(e){e.on("tap",function(){n(this)})}function p(e){e.on("doubletap",function(){c(this)})}function M(e){e.on("setData",function(){i(this)})}function w(){for(var e=0;e<g;e+=1){var t=L.setSlotsBox.appendChild(new d({name:"setSlot"+e}));h(t),p(t),t.dragUI={width:y,height:y,onDragClassName:"slot"},r.setDraggable(t,t.dragUI,"presets",{type:b})}}function T(){for(var e=0;e<_;e+=1){var t=L.setItemSlotsBox.appendChild(new u({name:"setItemSlot"+e,errorIcon:!0}));t.addClassNames("pos"+e),h(t),M(t)}}function C(){L.setIconsBox.addClassNames("spinner");for(var e=[],t=0;t<v;t+=1){e.push("gfx/presets/small_"+t+".png");var i=L.setIconsBox.appendChild(new d({name:"setIconSlot"+t}));h(i)}s.preloadImages(e,function(e){for(var t=0;t<e.length;t+=1){var i=L.setIconsBox.getChild("setIconSlot"+t);i.setImage(e[t])}L.setIconsBox.delClassNames("spinner")})}function A(e,t){window.gui.openConfirmPopup({title:l("ui.popup.warning"),message:l("ui.preset.warningDelete",e+1),cb:t})}function I(e,t,i){window.gui.openConfirmPopup({title:l("ui.popup.warning"),message:l("ui.preset.warningItemDelete",e,t+1),cb:i})}function S(){L.addSetButton.on("tap",function(){this.disable(),L._addSet()}),L.importSetButton.on("tap",function(){L._importSet()}),o(L.importSetButton,l("ui.preset.importCurrentStuff")),L.deleteSetButton.on("tap",function(){var e=L.deleteSetButton;e.disable();var t=L.setSlotsBox.selectedSlot&&L.setSlotsBox.selectedSlot.preset;return t?void A(t.presetId,function(i){i===f.YES?(window.dofus.sendMessage("InventoryPresetDeleteMessage",{presetId:t.presetId}),L.addClassNames("spinner")):e.enable()}):e.enable()}),o(L.deleteSetButton,l("ui.preset.delete")),L.chooseIconButton.on("tap",function(){L._confirmIconPopup(function(e){e===f.YES&&L._saveSet()})}),L.saveSetButton.on("tap",function(){this.disable(),L._saveSet()})}function E(){for(var e=L.setSlotsBox.getChildren(),t=0;t<e.length;t+=1){var i=e[t];i.preset&&L._deleteSet(i.preset.presetId)}var n=window.gui.playerData.inventory.presets||{};for(var o in n)L._updateSetSlot(o);e[0].emit("tap")}function x(e){var t={usePartial:l("ui.preset.error.usePartial"),badObjectId:l("ui.preset.error.badObjectId"),tooMany:l("ui.preset.error.tooMany"),criterion:l("ui.preset.error.criterion"),badId:l("ui.preset.error.badId"),badPosition:l("ui.preset.error.badPosition"),unknown:l("ui.common.unknownFail")};window.gui.openSimplePopup(t[e])}function N(){L.displayedPreset&&L.displayedPreset.mount&&L._displaySet(L.displayedPreset)}m.call(this,"div",{className:"PresetsBox"});var L=this;this.displayedItems={},this.setSlotsBox=this.createChild("div",{className:"setSlotsBox"}),this.addSetButton=this.appendChild(new a(l("ui.common.new"),{className:["addSetButton"]})),this.setItemSlotsBox=this.createChild("div",{className:"setItemSlotsBox"}),this.setIconsBox=this.createChild("div",{className:"setIconsBox"});var O=this.createChild("div",{className:"buttonsBox"});this.importSetButton=O.appendChild(new a("",{className:["importSetButton"]})),this.importSetButton.createChild("div",{className:"icon"}),this.deleteSetButton=O.appendChild(new a("",{className:["deleteSetButton"]})),this.deleteSetButton.createChild("div",{className:"icon"}),this.chooseIconButton=O.appendChild(new a("!",{className:["chooseIconButton"]})),this.chooseIconButton.createChild("div",{className:"icon"}),this.saveSetButton=O.appendChild(new a(l("ui.common.save"),{className:["saveSetButton"]})),this.buttonsBox=O,this.createChild("div",{className:"overlay"}),this.explanationPanel=this.createChild("div",{className:"explanationPanel"}),this.explanationPanel.createChild("div",{className:"instruction",text:l("ui.preset.howToUse")}),w(),T(),C(),S(),E();var D=window.gui.playerData,R=D.inventory;R.on("listUpdate",function(){E()}),R.on("presetSaved",function(t,i){if(L.delClassNames("spinner"),i)return e(),x(i)}),R.on("presetDeleted",function(t,i){return L.delClassNames("spinner"),i?(e(),x(i)):(L._deleteSet(t),void e())}),R.on("presetUpdated",function(t,i){return i?x(i):(L._updateSetSlot(t),void e())}),R.on("presetItemUpdated",function(e){L._updateSetSlot(e)}),R.on("presetItemUpdateError",x),R.on("presetUsed",function(e,t){if(L.delClassNames("spinner"),t)return x(t);var i=R.presets[e],n=D.equippedMount&&i.mount&&!D.isRiding;n&&window.gui.textNotification.add(l("tablet.mount.cannotRide"))}),D.on("setMount",N),D.on("unsetMount",N)}i(807);var o=i(337).addTooltip,s=i(182),a=i(335).DofusButton,r=i(317),l=i(29).getText,c=i(461),d=i(739),u=i(737),h=i(172),p=i(194),m=i(321),f=i(808).actionsEnum,g=8,_=16,v=27,y=40,b=i(732).GENERAL_SHORTCUT_BAR,M=c.positions.pets,w=3;h.inherits(n,m),e.exports=n,n.prototype._getItemPosMap=function(e){if(e){for(var t=e.objects||e,i=window.gui.playerData.inventory,n={},o=0;o<t.length;o+=1){var s,a=t[o].objUid||t[o].objectUID,r=t[o].position;if(a)s=i.objects[a];else{var l=t[o].objGid;s=c.items[l]}n[r]=s}return n}},n.prototype._updateSetSlot=function(e){var t=window.gui.playerData.inventory.presets[e],i=this.setSlotsBox.getChild("setSlot"+t.presetId);i.preset=t,s.preloadImage("gfx/presets/icon_"+t.symbolId+".png",function(e){i.setImage(e),i.dragUI.backgroundImage=i.getImage(),r.enableDrag(i)});var n=this.setIconsBox.getChild("setIconSlot"+t.symbolId);n.preset=t;var o=this.setSlotsBox.selectedSlot&&this.setSlotsBox.selectedSlot.preset;o&&o.presetId===t.presetId&&this._displaySet(t)},n.prototype._getIsItemUnavailable=function(e){if(!e)return!1;if(e.mountLocation){var t=window.gui.playerData.equippedMount;return!t}return!e.objectUID||e.conditions&&!e.conditions.isRespected()},n.prototype._updateSetItemSlots=function(e){function t(e,t){e.setData(t),s.preloadImage("gfx/mounts/"+t.model+".png",function(t){e.setImage(t)})}if(!e)return this._resetItemSlots(this.setItemSlotsBox.getChildren());for(var i=0;i<_;i+=1){var n=e[i],o=this.setItemSlotsBox.getChild("setItemSlot"+i);o.unset(),o.delClassNames("unavailable"),n&&(n.mountLocation?t(o,n):o.setItem(n),o.toggleClassName("unavailable",!!this._getIsItemUnavailable(n)))}var a=this.setItemSlotsBox.selectedSlot;a&&a.unselect()},n.prototype._resetItemSlots=function(e){for(var t=0;t<e.length;t+=1)e[t].unset()},n.prototype._displaySet=function(e){var t=window.gui.playerData,i=this._getItemPosMap(e),n=e&&e.symbolId;if(e)n=e.symbolId,e.mount&&(i[M]=t.equippedMount||{model:w,mountLocation:"placeholder"});else{var o=this.setIconsBox.getChildren(),s=this._getNextAvailableSlot(o);n=o.indexOf(s)}this._updateSetItemSlots(i),this.shouldSaveEquipment=!1,this.saveCustom=!1,this.setIconsBox.getChild("setIconSlot"+n).emit("tap"),this.displayedPreset=e},n.prototype._deleteSet=function(e){for(var t=this.setSlotsBox.getChildren(),i=0;i<t.length;i+=1){var n=t[i];if(n.preset&&n.preset.presetId===e){delete n.preset,n.unset(),r.disableDrag(n),this._resetItemSlots(this.setItemSlotsBox.getChildren());break}}},n.prototype._importSet=function(){var e=window.gui.playerData,t=e.inventory.equippedItems;e.isRiding&&(t[M]=e.equippedMount),this._updateSetItemSlots(t),this.shouldSaveEquipment=!0},n.prototype._saveSet=function(){var e=this,t=this.setSlotsBox.getChildren(),i=this.setItemSlotsBox.getChildren(),n=this.setIconsBox.getChildren(),o=this.setSlotsBox.selectedSlot,s=this.setIconsBox.selectedSlot;if(o.preset){var a=n[o.preset.symbolId];delete a.preset}var r,l;if(this.saveCustom){for(var c=[],d=[],u=0;u<i.length;u+=1){var h=i[u].itemInstance;if(h)c.push(h.position),d.push(h.objectUID||h.mountLocation&&h.id);else{var p=i[u].data;p&&p.mountLocation&&(c.push(M),d.push(p.id))}}r={presetId:t.indexOf(o),symbolId:n.indexOf(s),itemsPositions:c,itemsUids:d},l="InventoryPresetSaveCustomMessage"}else r={presetId:t.indexOf(o),symbolId:n.indexOf(s),saveEquipment:this.shouldSaveEquipment},l="InventoryPresetSaveMessage";window.dofus.sendMessage(l,r),e.addClassNames("spinner")},n.prototype._getNextAvailableSlot=function(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(!i.preset)return i}},n.prototype._confirmIconPopup=function(e){p.open("presetChooseIcon",this.setIconsBox),p.getWindow("presetChooseIcon").once("close",e)},n.prototype._addSet=function(){var e=this,t=this._getNextAvailableSlot(this.setSlotsBox.getChildren());if(t){var i=this._getNextAvailableSlot(this.setIconsBox.getChildren());t.emit("tap"),i.emit("tap"),this._confirmIconPopup(function(t){return t!==f.YES?e.addSetButton.enable():(e._importSet(),void e._saveSet())})}}},function(e,t){},function(e,t,i){function n(e){e=e||{className:"confirmWindow",positionInfo:{left:"c",top:"c",width:600,height:200,isModal:!0},noCloseButton:!0},s.call(this,e),this._domCreated=!1,this.actionsEnum=c;var t=this._box=this.windowBody.createChild("div",{className:"messageBox"});this.message=t.createChild("div",{className:"message"})}i(809);var o=i(172).inherits,s=i(541),a=i(194),r=i(335).DofusButton,l=i(29).getText,c={NO:0,YES:1,IGNORE:2};o(n,s),e.exports=n,e.exports.actionsEnum=c,n.prototype.createDom=function(){var e=this,t=this.windowBody.createChild("div",{className:"buttonContainer"});this._buttonYes=t.appendChild(new r(l("ui.common.yes"))),this._buttonYes.on("tap",function(){"function"==typeof e.cb&&e.cb(c.YES),a.close(e.id,{keepDialog:e.keepDialog})}),this._buttonNo=t.appendChild(new r(l("ui.common.no"))),this._buttonNo.on("tap",function(){"function"==typeof e.cb&&e.cb(c.NO),a.close(e.id)}),this._buttonIgnore=t.appendChild(new r(l("ui.common.ignore"))),this._buttonIgnore.on("tap",function(){"function"==typeof e.cb&&e.cb(c.IGNORE),a.close(e.id)}),this._buttonIgnore.hide(),this._domCreated=!0},n.prototype.update=function(e,t){var i=this;if(this._domCreated||this.createDom(),t=t||{},this.windowTitle.setText(e.title||l("ui.common.confirm")),this.message.setHtml(e.message),this.cb=e.cb,this.keepDialog=t.keepDialog,this._buttonNo.toggleDisplay(!e.noDisable),this._buttonIgnore.toggleDisplay(!!t.ignoreEnable),e.timer){var n=e.timer;this._buttonYes.setText(l("ui.common.ok")+" ("+n+")"),this._buttonYes.disable();var o=setInterval(function(){n--,n<=0?(i._buttonYes.setText(l("ui.common.ok")),i._buttonYes.enable(),clearInterval(o)):i._buttonYes.setText(l("ui.common.ok")+" ("+n+")")},1e3)}else this._buttonYes.enable()}},function(e,t){},function(e,t,i){function n(){function e(){t.logScroller.refresh(),t.logScroller.goToBottom()}a.call(this,{className:"adminConsoleWindow",title:w,positionInfo:{left:"c",top:"c",width:800,height:500}}),f(this,{minWidth:480,minHeight:300});var t=this;this.history=[],this.historyPointer=0,this.autoScroll=!0,this.domCreated=!1,this.once("open",function(){t._createDom()}),this.on("open",function(){t.setTitle(t.getAdminTitle())}),this.on("focus",function(){window.setTimeout(function(){t.cmdInput.focus()},100)}),this.on("close",function(){u.hide()}),this.on("opened",function(){t.cmdInput.focus()}),this.on("resize",e),this.on("repositioned",e),window.gui.on("ConsoleCommandsListMessage",function(e){t.helpInfo=e}),window.gui.on("ConsoleMessage",function(e){return t.log?void t.logMessage(e.content,S[e.type]):console.warn(e.content)}),window.gui.on("DebugInClientMessage",function(e){t.log&&t.logMessage(e.message,E[e.level]),e.level>=x?console.warn(e.message):console.log(e.message)}),C.on("step",function(e){e=e||{};var i=e.percent;t._preloadPB.setValue(i),t._preloadCount.setText(e.count+"/"+e.nbTotalMaps),t._preloadPercent.setText(~~(100*i)+"%"),t._preloadEstimate.setText(e.secondLeft<0?0:e.secondLeft+"s")}),C.on("error",function(e){t.cmdInput.enable(),t._buttonSend.enable(),t._preloadBox.hide(),console.error(e)}),C.on("end",function(e){t.cmdInput.enable(),t._buttonSend.enable(),t._preloadBox.hide(),t.logMessage("Finished preloading of in "+e.elapsedSecond+"s")}),this.optionButton=new r({className:"optionButton",scaleOnPress:!0},function(){var e=[];e.push({caption:"25%",cb:function(){t.setOpacity(.25)}}),e.push({caption:"50%",cb:function(){t.setOpacity(.5)}}),e.push({caption:"75%",cb:function(){t.setOpacity(.75)}}),e.push({caption:"100%",cb:function(){t.setOpacity(1)}}),window.gui.openContextualMenu("generic",{title:"Opacity",actions:e})}),this.optionButton.insertBefore(this.closeButton);var i=y.getValue(T);i&&t.setOpacity(i)}i(811);var o=i(594),s=i(172).inherits,a=i(541),r=i(335),l=i(530),c=i(557),d=i(29).getText,u=i(435),h=i(775),p=i(436),m=i(612),f=i(622),g=i(339),_=i(321),v=i(198).events,y=i(176),b=i(812),M=100,w="Admin Console",T="adminOpacity",C=new b,A="incarnam",I=45,S=["Info","Warn","Error"],E=["Debug","Debug","Info","Warn","Error","Fatal"],x=3;s(n,a),e.exports=n,n.prototype._createDom=function(){if(!this.domCreated){var e=this,t=this.windowBody,i=t.createChild("div",{className:"topDom"}),n=i.createChild("div",{className:"upDownContainer"}),o=n.appendChild(new r({text:"Next cmd",className:["greenButton","upAndDown"]}));o.on("tap",function(){e.nextCmd()});var s=n.appendChild(new r({text:"Reset",className:["greenButton","upAndDown"]}));s.on("tap",function(){e._reset()});var a=n.appendChild(new r({text:"Previous cmd",className:["greenButton","upAndDown"]}));a.on("tap",function(){e.previousCmd()}),this.autoScrollCheckbox=n.appendChild(new m("autoscroll",(!0))),this.autoScrollCheckbox.addClassNames("upAndDown"),this.autoScrollCheckbox.on("change",function(t){e.autoScroll=t});var u=i.createChild("form",{attr:{action:"#_",method:"post"}}),h=u.createChild("table",{className:"cmdInputBar"}),f=h.createChild("td"),g=this.cmdInput=new l({className:"cmdInput",attr:{id:"cmdInput"}});f.appendChild(g),f=h.createChild("td",{className:"buttonSend"});var _=this._buttonSend=f.appendChild(new r({text:d("ui.social.reportSend"),className:["greenButton"]})),v=this._preloadBox=t.createChild("div",{className:"preloadBox",hidden:!0});this._preloadPB=v.appendChild(new c({className:["preloadPB","green"]})),this._preloadCount=v.createChild("div",{className:"preloadCount"}),this._preloadPercent=v.createChild("div",{className:"preloadPercent"}),this._preloadEstimate=v.createChild("div",{className:"preloadEstimate"}),this.logScroller=t.appendChild(new p({className:"logBox"})),this.log=this.logScroller.content,_.on("tap",function(){var t=g.getValue();g.setValue(""),e.runCommand(t)}),g.rootElement.addEventListener("keydown",function(t){if(t){var i=t.keyCode;40===i?(t.preventDefault(),e.nextCmd()):38===i&&(t.preventDefault(),e.previousCmd())}}),u.rootElement.addEventListener("submit",function(e){e.preventDefault(),_.emit("tap")}),this.domCreated=!0}},n.prototype.addToHistory=function(e){return this.history[this.history.length-1]!==e&&e?(this.history.push(e),void(this.historyPointer=this.history.length)):void(this.historyPointer=this.history.length)},n.prototype.previousCmd=function(){if(!(this.historyPointer<1)){this.historyPointer-=1;var e=this.history[this.historyPointer];this.cmdInput.setValue(e)}},n.prototype.nextCmd=function(){if(!(this.historyPointer>this.history.length-1)){this.historyPointer+=1;var e=this.history[this.historyPointer]||"";this.cmdInput.setValue(e)}},n.prototype.setOpacity=function(e){this.windowBorder.setStyle("opacity",e),y.setValue(T,e)},n.prototype._handleEvent=function(e){e=e.replace("event:","");var t=e.split(","),i=t[0];switch(i){case"player":var n={playerName:t[1],playerId:t[2]};window.gui.openContextualMenu(i,n);break;case"admin":var o="true"===t[1],s=window.atob(t[2]);o?this.runCommand(s):this.cmdInput.setValue(s)}},n.prototype._formatLinks=function(e){function t(e,t){var n=t.match(/^event:/);e.addEventListener(v.end,function(e){n?i._handleEvent(t):(t=encodeURI(t),g.openUrlInAppBrowser(t)),e.preventDefault()})}var i=this,n=new _("div");n.setHtml(e);for(var o,s,a=n.rootElement.getElementsByTagName("a"),r=0;r<a.length;r++)o=a[r],s=o.href,t(o,s);return n},n.prototype.logMessage=function(e,t){if(this._createDom(),this.log.getChildCount()>M){var i=this.log.getChildren();Array.isArray(i)&&i[0]&&i[0].destroy()}var n="message"+(t||"Info"),o=this.log.createChild("div",{className:["message",n]});e=e.replace(/\n/g,"<br/>"),e=this._formatLinks(e),o.appendChild(e),this.logScroller.refresh(),this.autoScroll&&this.logScroller.goToBottom()},n.prototype.runCommand=function(e){if(e=e.trim(),this.logMessage(e,"Command"),"help"===e||""===e)return this.logMessage("\n"+this.helpInfo.descriptions.join(""),"Debug");this.addToHistory(e);var t=e.split(" ");if(window.gui.playerData.isAdmin()){var i;if("preload"===t[0]){t.shift(),this.cmdInput.disable(),this._buttonSend.disable(),this._preloadBox.show(),this._preloadPB.setValue(0);var n=t[0];return n=n===A?I:parseInt(n,10),C.preloadAreas([n])}if("joris"===t[0])return t.shift(),i=h.adminCommand(t),this.logMessage(i,"Debug");if("tutorial"===t[0])return t.shift(),i=window.gui.tutorialManager.adminCommand(t),this.logMessage(i,"Debug");if("autotest"===t[0]&&o.run)return t.shift(),o.run(t.join(" "));if("gridcolor"===t[0])return t.shift(),4!==t.length?this.logMessage("4 arguments required: gridcolor [red] [green] [blue] [alpha]","Debug"):t[0]>1?this.logMessage("Red   component has to be in range [0, 1]","Debug"):t[1]>1?this.logMessage("Green component has to be in range [0, 1]","Debug"):t[2]>1?this.logMessage("Blue  component has to be in range [0, 1]","Debug"):t[3]>1?this.logMessage("Alpha has to be in range [0, 1]","Debug"):(window.isoEngine.background.setGridColor(t),this.logMessage("Grid color changed!","Debug"));if("haapi"===t[0])return this.logMessage(window.Config.haapi.url,"Debug");if("setanimation"===t[0]){t.shift();var s=this,a={animationString:t[0],direction:t[1]};return void window.actorManager.userActor.testAnimation(a,function(e){s.logMessage(e,"Debug")})}}if(window.gui.playerData.isModeratorOrMore()&&"setadminmenu"===t[0]){var r=!1,l=t[1];return r=!l||"help"===l||!window.gui.playerData.adminMenu.setAdminMenuId(l),void(r&&(this.logMessage("setadminmenu &lt;menuId&gt;: menuId must be one of the following:","Debug"),this.logMessage(window.gui.playerData.adminMenu.helpToString(),"Debug")))}window.dofus.sendMessage("AdminCommandMessage",{content:e})},n.prototype.runQuietCommand=function(e){window.dofus.sendMessage("AdminQuietCommandMessage",{content:e})},n.prototype._reset=function(){this.log.clearContent(),this.logScroller.refresh()},n.prototype.getAdminTitle=function(){var e=[],t=window.gui.serversData,i=window.gui.playerData.characterBaseInformations,n=t.getMyServerName();return n&&e.push(n+" ("+t.connectedServerId+")"),i.id&&i.name&&e.push(i.name+" ("+i.id+")"),0===e.length&&e.push(w),e.join(", ")},n.prototype.adminStartup=function(){this._createDom(),window.setTimeout(function(e){for(var t=["lookinvis","unmutable","adminaway","admininvisible"],i=0;i<t.length;i+=1)e.runCommand(t[i])},0,this)}},function(e,t){},function(e,t,i){function n(){u.call(this),this._reset()}function o(e,t){if(!e)return null;var i=Date.now(),n=(i-t)/1e3,o=n/e;return~~(o-n)}function s(e,t){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}function a(e,t){var i=g+e+".json";p.loadJson(i,function(i){if(i===m.EMPTY_JSON)return t("emptyMapJson");var n=[_+e+".jpg"];i.foreground&&n.push(v+e+".png");for(var o=i.midgroundLayer,a=Object.keys(o),r=0;r<a.length;r++)for(var l=a[r],c=o[l],d=0;d<c.length;d++){var u=c[d],h=u.g;if(h){var g=u.jpg?"jpg":"png",y=g+"/"+h+"."+g;n.push(f+y)}}p.preloadAssets(n,!1,null,function(e){return s(null,e)?t("emptyMapImage"):t(null,e)})})}function r(e,t){for(var i=0;i<e.length;i++)t.hasOwnProperty(e[i])||(t[e[i]]=!0)}function l(e,t){return e.length?void h.getAllDataMap("SubAreas",function(i,n){if(i)return t(i);var o={};for(var s in n)if(n.hasOwnProperty(s)){var a=n[s],l=a.mapIds||[];if(e.indexOf(a.areaId)===-1)continue;r(l,o)}return t(null,o)}):this._onError("noArea:"+e)}var c=i(31),d=i(172).inherits,u=i(188).EventEmitter,h=i(30),p=i(182),m=i(167),f=m.IMG_PATH,g=m.MAP_PATH,_=m.BACKGROUND_PATH,v=m.FOREGROUND_PATH,y="MapPreloaderInterrupt";d(n,u),e.exports=n,n.prototype._reset=function(){this._isStopped=!1,this._shouldStop=!1,this._remainingMaps={},this._lastCount=0},n.prototype._onError=function(e){this._isStopped=!0,this.emit("error",e)},n.prototype._onEnd=function(e){this._isStopped=!0,this.emit("end",e)},n.prototype._onStop=function(){this._isStopped=!0,this.emit("stop")},n.prototype._onStep=function(e){this.emit("step",e)},n.prototype._preload=function(e,t){var i=this,n=Object.keys(e),s=n.length;if(!s)return i._onEnd({elapsedSecond:0});var r=0,l=Date.now();return c.forEachSeries(n,function(n,d){return i._shouldStop?c.setImmediate(function(){return d(y)}):a(n,function(a){if(a)return d(a);delete e[n],r++;var c=r/s,u=o(c,l),h=r+t,p=s+t,m=h/p,f=Math.round(100*m)/100;return i._onStep({count:h,nbTotalMaps:p,percent:f,secondLeft:u}),d()})},function(t){return i._remainingMaps=e,i._lastCount+=r,t?t===y?i._shouldStop?i._onStop():i._restart():i._onError(t):i._onEnd({
elapsedSecond:~~((Date.now()-l)/1e3)})})},n.prototype.preloadAreas=function(e){var t=this;this._reset(),this._isStopped=!1,l(e,function(e,i){return e?t._onError(e):void t._preload(i,0)})},n.prototype.stop=function(){this._shouldStop=!0,this._isStopped&&this._onStop()},n.prototype.restart=function(){this._shouldStop=!1,this._isStopped&&this._restart()},n.prototype._restart=function(){this._isStopped=!1,this._preload(this._remainingMaps,this._lastCount)}},function(e,t,i){function n(){s.call(this,{className:"ArenaWindow",title:l("ui.common.koliseum"),positionInfo:{left:"c",top:"c",width:500,height:500}}),this.mustReload=!0,this.on("open",function(){this.statusTitle||(this.createContent(),this.setupListeners()),this.mustReload&&this.reloadPartyData()})}i(814);var o=i(172).inherits,s=i(541),a=i(335).DofusButton,r=i(649),l=i(29).getText,c=i(704),d=i(815);o(n,s),e.exports=n,n.prototype.createContent=function(){this.messageContainerSetup(),this.tableSetup(),this.informationSetup(),this.buttonsSetup()},n.prototype.messageContainerSetup=function(){var e=this.windowBody.createChild("div",{className:"wrapper",name:"status"});this.statusTitle=e.createChild("div",{className:"title"}),this.statusText=e.createChild("div",{className:"text"})},n.prototype.tableSetup=function(){this.table=this.windowBody.appendChild(new r({colIds:["icon","name","status"],headerContent:["",l("ui.common.team")],minRows:3,defaultRowContent:["",l("ui.common.randomCharacter")]}))},n.prototype.informationSetup=function(){var e=this.windowBody.createChild("div",{className:"wrapper",name:"informations"});e.createChild("div",{className:"title",text:l("ui.common.myInformations")}),e.createChild("div",{className:"text",name:"currentRating"}),e.createChild("div",{className:"text",name:"dailyRating"}),e.createChild("div",{className:"text",name:"maxRating"}),e.createChild("div",{className:"text",name:"fightsWon"})},n.prototype.registerInArena=function(){window.dofus.sendMessage("GameRolePlayArenaRegisterMessage",{battleMode:d.ARENA_TYPE_3VS3})},n.prototype.buttonsSetup=function(){var e=this,t=this.windowBody.createChild("div",{className:"buttons"});this.unregisterBtn=t.appendChild(new a(l("ui.teamSearch.unregistration"))),this.registerBtn=t.appendChild(new a(l("ui.teamSearch.registration"))),this.leaveArenaBtn=t.appendChild(new a(l("ui.party.arenaQuit"))),this.registerBtn.on("tap",function(){e.registerInArena()}),this.unregisterBtn.on("tap",function(){window.dofus.sendMessage("GameRolePlayArenaUnregisterMessage")}),this.leaveArenaBtn.on("tap",function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:e.partyId})})},n.prototype.setLeaderRow=function(e,t){e.getChild("icon").toggleClassName("leaderIcon",t)},n.prototype.addMemberRow=function(e,t){var i=this.table.addRow({name:e},{id:t});return t===this.leaderId&&this.setLeaderRow(i,!0),this.memberCount++,i},n.prototype.addThisPlayerRow=function(){var e=window.gui.playerData,t=e.characterBaseInformations.name;return this.addMemberRow(t,e.id)},n.prototype.findMemberRow=function(e){if(!e)return-1;for(var t=this.table.getRows(),i=0;i<t.length;i++)if(t[i].id===e)return i;return-1},n.prototype.removeMemberRow=function(e){var t=this.findMemberRow(e);return t===-1?console.warn("Cannot remove unknown arena member #"+e):(this.table.delRow(t),void this.memberCount--)},n.prototype.enableOrDisableLeaveArenaButton=function(){this.partyId?this.leaveArenaBtn.enable():this.leaveArenaBtn.disable()},n.prototype.enableOrDisableRegisterButton=function(){this.isLeader||!this.leaderId?(this.registerBtn.enable(),this.unregisterBtn.enable()):(this.registerBtn.disable(),this.unregisterBtn.disable())},n.prototype.showOrHideRegisterButton=function(e){e.arenaRegistered?(this.registerBtn.hide(),this.unregisterBtn.show()):(this.registerBtn.show(),this.unregisterBtn.hide())},n.prototype.setNewLeader=function(e){var t=this.findMemberRow(this.leaderId);t>=0&&this.setLeaderRow(this.table.getRow(t),!1),t=this.findMemberRow(e),t>=0&&this.setLeaderRow(this.table.getRow(t),!0),this.leaderId=e,this.isLeader=e===window.gui.playerData.id,this.enableOrDisableRegisterButton()},n.prototype.updateArenaStats=function(e){var t=e.arenaStats,i=this.windowBody.getChild("informations");i.getChild("currentRating").setText(l("ui.party.arenaRank",t.rank)),i.getChild("dailyRating").setText(l("ui.party.arenaRankMaxToday",t.bestDailyRank)),i.getChild("maxRating").setText(l("ui.party.arenaRankMax",t.bestRank)),i.getChild("fightsWon").setText(l("ui.party.arenaFightsOfTheDay",t.victoryCount,t.arenaFightCount))},n.prototype.reloadPartyData=function(){this.mustReload=!1;var e=window.gui.playerData.partyData;this.updateArenaStats(e),this._updatePartyData(e),this.updateRegistrationStatus(e)},n.prototype._updatePartyData=function(e){this.memberCount=0,this.table.clearContent();var t=e.getArenaParty();if(!t)return this.setNewLeader(null),this.partyId=null,void this.addThisPlayerRow();this.setNewLeader(t.getLeaderId()),this.partyId=t.getPartyId(),this.isLeader&&this.addThisPlayerRow();var i=t.getMembers();for(var n in i)this.addMemberRow(i[n].name,~~n);this.isLeader||this.addThisPlayerRow()};var u=["ui.party.arenaInfoSearch","ui.party.arenaInfoWaiting","ui.party.arenaInfoFighting","ui.party.arenaInfoInvite"],h=l;n.prototype.getStepText=function(e,t){return h(u[e],t)},n.prototype.updateRegistrationStatus=function(e){var t=e.arenaStep;switch(this.statusTitle.setText(l("ui.common.step",(t+1)%4+1,4)),this.statusText.setText(this.getStepText(t,0)),this.showOrHideRegisterButton(e),t){case c.ARENA_STEP_REGISTRED:this.enableOrDisableLeaveArenaButton();break;case c.ARENA_STEP_WAITING_FIGHT:case c.ARENA_STEP_STARTING_FIGHT:this.leaveArenaBtn.disable(),this.registerBtn.disable();break;case c.ARENA_STEP_UNREGISTER:this.enableOrDisableLeaveArenaButton(),this.enableOrDisableRegisterButton();break;default:console.error("Unknown arena step #"+t)}},n.prototype.onFightEnd=function(){if(this.enableOrDisableLeaveArenaButton(),this.isLeader){this.registerBtn.enable();var e=this;window.gui.openConfirmPopup({title:l("ui.common.confirm"),message:l("ui.party.arenaPopupReinscription"),cb:function(t){t&&e.registerInArena()}})}},n.prototype.setupListeners=function(){var e=this,t=window.gui.playerData.partyData;window.gui.on("disconnect",function(){e.mustReload=!0}),t.on("arenaRegistrationStatus",function(){e.updateRegistrationStatus(t)}),t.on("arenaFightEnd",function(){e.onFightEnd()}),t.on("arenaStatsUpdated",function(){e.updateArenaStats(t)}),t.on("arenaJoined",function(){e._updatePartyData(t)}),t.on("arenaNewMember",function(t){return e.findMemberRow(t.id)>=0?console.error("Dupe arena member #"+t.name):void e.addMemberRow(t.name,t.id)}),t.on("arenaMemberLeaving",function(t){e.removeMemberRow(t)}),t.on("playerLeftParty",function(t){t===e.partyId&&e.reloadPartyData()}),t.on("arenaLeaderUpdate",function(t){e.setNewLeader(t)}),t.on("arenaFighterReady",function(t){e.statusText.setText(e.getStepText(1,t))})}},function(e,t){},function(e,t){e.exports={ARENA_TYPE_3VS3:3,ARENA_TYPE_5VS5:5}},function(e,t,i){function n(){p.call(this,{title:s("ui.charcrea.more"),className:"BreedDetailWindow",positionInfo:{left:"c",top:"c",width:912,height:"90%",maxHeight:683,isModal:!0,isFullScreen:!0}}),this.loadedSpells={},this.favSpells=[],this.on("open",this._initialize)}function o(){h.showNotification(s("tablet.common.longTapForTooltip"),this)}i(817);var s=i(29).getText,a=i(172).inherits,r=i(436),l=i(339).showProgressively,c=i(745),d=i(412),u=i(743),h=i(337),p=i(541),m=[[],[10,7,3],[34,31,27],[60,58,50],[72,80,67],[88,81,95],[105,101,109],[126,130,140],[142,159,153],[179,168,174],[191,190,186],[434,446,431],[686,705,696],[2778,2806,2810],[2890,2897,2872],[3212,3211,3218]],f={spellTooltipAll:!0},g={visibilityOptions:{spellTooltipName:!0,spellTooltipDescription:!0}};a(n,p),e.exports=n,n.prototype.freeContent=function(){this.windowBody.clearContent(),this.loadedSpells={},this.favSpells=[]},n.prototype._initialize=function(e){this.breedData=e.breedData,this._createContent(this.windowBody),this._updateBreedDescription(),this._updateSpells()},n.prototype._createContent=function(e){var t=this.scroller=e.appendChild(new r({},{showHintArrows:!0})),i=t.content;this.breedDescription=i.createChild("div",{className:"breedDescription",hidden:!0});var n=this.breedDescription.createChild("div",{className:"descriptionZone"}),o=n.createChild("div",{className:"descriptionText"});this.breedName=o.createChild("div",{className:"breedName",text:"."}),this.breedName.setText(""),this.breedStory=o.createChild("div",{className:"breedStory"});var a=this.favoriteSpells=i.createChild("div",{className:"favSpells",hidden:!0});a.createChild("div",{className:"title",text:s("tablet.charCrea.popularSpells")});for(var l=m[this.breedData.id]||[],c=0;c<l.length;c++){var d=this.favSpells[c]=a.createChild("div",{className:"spell",hidden:!0});d.spellId=l[c]}var u=this.allSpells=i.createChild("div",{className:"spells",hidden:!0});u.createChild("div",{className:"title",text:s("tablet.charCrea.allSpells")}),this.spellsContainer=u.createChild("div",{className:"spellsContainer"})},n.prototype._appearWhenReady=function(){l(this.breedDescription),l(this.favoriteSpells),l(this.allSpells),this.scroller.refresh(),this.scroller.notify()},n.prototype._updateBreedDescription=function(){var e=this.breedData;this.breedName.setText(e.longNameId),this.breedStory.setText(e.descriptionId)},n.prototype._updateSpells=function(){this.windowBody.addClassNames("spinner");var e=this.breedId,t=this.breedData.breedSpellsId,i=this;this._loadSpellsData(t,function(n){return n?console.error(n):void(i.openState&&i.breedId===e&&i._updateSpellSlots(t))})},n.prototype._loadSpellsData=function(e,t){for(var i=[],n=this.loadedSpells,o=0;o<e.length;o+=1)n[e[o]]||i.push(e[o]);return i.length?void d.createSpells(i,function(e,i){if(e)return t(e);i=d.sortSpells(i,"minPlayerLevel");for(var o=0;o<i.length;o+=1){var s=i[o];n[s.id]=s}t()}):t()},n.prototype._updateSpellSlots=function(e){for(var t,i=0;i<e.length;i+=1){var n=this.spellsContainer.appendChild(new u);t=this.loadedSpells[e[i]],n.setSpell(t,f),n.toggleDisplay(!!t),n.on("tap",o)}for(this.windowBody.delClassNames("spinner"),i=0;i<this.favSpells.length;i++){var s=this.favSpells[i];t=this.loadedSpells[s.spellId],t&&(s.slot=s.appendChild(new u),s.slot.setSpell(t,f),s.slot.on("tap",o),s.appendChild(new c({spell:t},g)),s.show())}this._appearWhenReady()}},function(e,t){},function(e,t,i){function n(){T.call(this,{className:"BreedingWindow",positionInfo:{left:"0",bottom:"0",width:"100%",height:"100%"},noTitle:!0}),this.mountDataFromCertifId={},this.babyMap={},this._reset(),this._setupEvents()}function o(){var e=this.room.breedingWindow;e._setFilterBoxVisible(!1),e._selectTile(this.room,this)}i(819);var s=i(335),a=i(612),r=i(820),l=i(317),c=i(822),d=i(824),u=i(550),h=i(29).getText,p=i(172).inherits,m=i(548),f=i(825),g=i(827),_=i(831),v=i(455),y=i(832),b=i(532),M=i(834),w=i(836),T=i(541),C=i(194),A=i(321),I=r.DRAG_ID,S="c",E=150,x=1,N=200,L="paddock",O=m.EFFECT_INVALID_CERTIF,D=996,R=997,P=998,B={id:!0,name:!0,model:!0},k=2,z=!0,F=6e5;p(n,T),e.exports=n,n.prototype._reset=function(){this.isWindowSizeFull=!1,this.isMultiselect=!1,this.selectionRoom=null,this.focusedTile=null,this.openedRoom=null,this.dropZones={},this.certificateQueue=[],this.certificateTilePendingSelection=null,this.nonLoadedCertifCount=0,this.waitingGaugeGoal=0,this.certifAreRequested=!1,this.numMassRemove=0,this.numMassAdd=0,this.filters=new _,this.isFilterEmpty=!0,this.isWaitingForInventory=!1,this._purgeNewbornList()},n.prototype.freeContent=function(){this.windowBody.clearContent(),this.equipBox=null,this.focusedMountDetails=null,this.rooms=null,this.roomBoxes=null,this.roomTabs=null,this.displayedRooms=null,this.roomDropZones=null,this.mountFilterBox=null,this.filterButtonBar=null,this.allNoneCheckbox=null,this.waitingGauge=null},n.prototype._resetDom=function(){for(var e in this.rooms)this.rooms[e].reset();this._hideMountDetails(),this.equipBox.updateMount(null),this._setFilterBoxVisible(!1),this.mountFilterBox?this.mountFilterBox.resetFilters():console.error("_resetDom: mountFilterBox was "+this.mountFilterBox),window.clearTimeout(this.debugCheckTimeout),this.allNoneCheckbox.toggleActivation(!1,!0),this.waitingGauge.hideGauge(),f.freeContent()},n.prototype._createDom=function(){this._createRooms();var e=this.windowBody.createChild("div",{className:"leftCol"});this._setupMountDetails(e),this._setupEquipBox(e),this._hideMountDetails();var t=this.windowBody.createChild("div",{className:"rightCol"});this._setupFilterMenuBox(t),this.rooms.paddock.capacity=this.paddockCapacity,this._setupRoomBoxes(t),this.waitingGauge=this.windowBody.appendChild(new w),this._setupMountFilterBox(t),this._setupDropZones()},n.prototype._setupEvents=function(){function e(e){if(t.waitingGauge.hideGauge(),e===d.MOUNT_PADDOCK_ERROR){var i=h("ui.exchange.cantExchangeMountPaddockError");window.gui.openSimplePopup(i)}}var t=this,i=window.gui,n=window.dofus.connectionManager,o=i.playerData,s=o.inventory;i.on("disconnect",function(){t.mountDataFromCertifId={}}),this.on("close",function(){this._resetDom(),this._reset(),i.uiLocker.unlockFeature("mount","breedingOpened")}),this.on("opened",function(){this.isWindowSizeFull=!0}),n.on("ExchangeStartOkMountMessage",function(e){t._initDisplay(e)}),o.on("setMount",this.localizeEvent(function(){t._updateEquipBox(),t.waitingGauge.hideGauge()})),o.on("unsetMount",this.localizeEvent(function(){t.numMassRemove&&t.numMassRemove--,t._updateEquipBox()})),i.on("ExchangeMountStableBornAddMessage",function(e){var i=e.mountDescription;t.babyMap[i.id]=Date.now(),t.equipBox&&t._addMountsToRoom(t.rooms.shed,i)}),i.on("ExchangeMountStableAddMessage",this.localizeEvent(function(e){t._addMountsToRoom(t.rooms.shed,e.mountDescription)})),i.on("ExchangeMountStableRemoveMessage",this.localizeEvent(function(e){t._removeMountsFromRoom(t.rooms.shed,e.mountId)})),i.on("ExchangeMountPaddockAddMessage",this.localizeEvent(function(e){t._addMountsToRoom(t.rooms.paddock,e.mountDescription)})),i.on("ExchangeMountPaddockRemoveMessage",this.localizeEvent(function(e){t._removeMountsFromRoom(t.rooms.paddock,e.mountId)})),i.on("PaddockPropertiesMessage",this._updatePaddockProperties.bind(this)),s.on("listUpdate",function(e){t.isWaitingForInventory&&t._loadCertificatesAfterInventoryLoads(e)}),s.on("itemAdded",this.localizeEvent(function(e){t._addCertificates([e])})),s.on("itemsAdded",this.localizeEvent(function(e){t._addCertificates(e)})),s.on("itemDeleted",this.localizeEvent(function(e,i){t._removeCertificates([i])})),s.on("itemsDeleted",this.localizeEvent(function(e,i){t._removeCertificates(i)})),n.on("MountDataMessage",this.localizeEvent(function(e){t._receiveMountData(e.mountData)})),n.on("MountRenamedMessage",this.localizeEvent(function(e){var i=t._findTileInRooms(e.mountId);i.mountData.name=e.name,t._refreshTile(i)})),n.on("MountSterilizedMessage",this.localizeEvent(function(e){var i=t._findTileInRooms(e.mountId);i.mountData.reproductionCount=-1,t._refreshTile(i)})),i.on("ExchangeMountStableErrorMessage",function(){e(d.MOUNT_PADDOCK_ERROR)}),n.on("ExchangeErrorMessage",this.localizeEvent(function(t){e(t.errorType)})),l.on("dragStart",this.localizeEvent(function(e,i,n){i===I&&t._startDragging(e,n)})),l.on("dragEnd",this.localizeEvent(function(e,i){i===I&&t._endDragging(e)}))},n.prototype._initDisplay=function(e){window.gui.uiLocker.lockFeature("mount","breedingOpened"),C.openDialog(this.id),this.equipBox?this._resetDom():this._createDom(),this._updateEquipBox(!0),this.roomBoxes.hide(),this._addMountsToRoom(this.rooms.shed,e.stabledMountsDescription),this._addMountsToRoom(this.rooms.paddock,e.paddockedMountsDescription),this._loadCertificatesFromInventory(),this.roomBoxes.show(),this.roomTabs.openTab(L,null,{forceOpen:!0})},n.prototype._loadCertificatesFromInventory=function(){var e=window.gui.playerData.inventory;return e.isLoaded?this._addCertificates(Object.keys(e.objects)):(this.waitingGauge.showGauge(1),void(this.isWaitingForInventory=!0))},n.prototype._loadCertificatesAfterInventoryLoads=function(e){this.isWaitingForInventory=!1,this._addCertificates(Object.keys(e)),this.waitingGauge.hideGauge()},n.prototype._createRooms=function(){var e=[{id:"paddock",name:h("ui.common.mountPark")},{id:"shed",name:h("ui.mount.barn"),capacity:E},{id:"certificate",name:h("ui.mount.certificates")},{id:"equip",name:h("ui.common.equip"),capacity:x,hidden:!0}];this.rooms={},this.displayedRooms={};for(var t=0;t<e.length;t+=1){var i=e[t],n=i.id,o=this.rooms[n]=new y(this,n,i.name,i.capacity);i.hidden||(this.displayedRooms[n]=o)}this.numTabs=Object.keys(this.displayedRooms).length},n.prototype._updatePaddockProperties=function(e){this.paddockCapacity=e.properties.maxOutdoorMount,this.openState&&this._updateRoomTab(this.rooms.paddock)},n.prototype._setupMountDetails=function(e){var t=e.createChild("div",{className:"mountDetailsBox"}),i=this.focusedMountDetails=t.appendChild(new m),n=i.getIllustrationElement();i.placeholder=new v(t),i.dragInfo=new r(this,n)},n.prototype._setupEquipBox=function(e){this.equipBox=new c(e,this.rooms.equip,o)},n.prototype._selectTab=function(e){this.openedRoom=this.rooms[e],this._updateDisplayedRoom();var t=this.isMultiselect&&this.openedRoom===this.selectionRoom;this.allNoneCheckbox.toggleActivation(t,!0)},n.prototype._setupRoomBoxes=function(e){var t=this.roomBoxes=e.createChild("div",{className:"roomBoxes"}),i=t.createChild("div",{className:"roomBoxWrapper"}),n=i.createChild("div",{className:"tileSpace"});this.roomPlaceholder=new v(n);var o=this.roomTabs=t.appendChild(new M({className:"roomTabs"})),s=i.rootElement.clientHeight/this.numTabs,a=0;o.on("openTab",this._selectTab.bind(this));for(var r in this.rooms)if(this.displayedRooms[r]){var l=this.rooms[r],c=l.createBox(n);o.addTab(l.name,c,r);var d=o.getTabsMap()[r].tab;d.setStyles({width:s+"px",top:a+"px"}),a+=s,d.title=d.createChild("div",{className:"title",text:l.name}),d.statusLabel=d.createChild("div",{className:"statusLabel"}),this._updateRoomTab(l)}},n.prototype._setupFilterMenuBox=function(e){var t=e.createChild("div",{className:"filterMenuBox"}),i=t.createChild("div",{className:"filterMenu"});this._createFilterButton(i),this._createSortSelector(i),this._createSelectAndFilterInfo(i),this._createSelectAllOrNone(i),this.filterButtonBar=t.createChild("div",{className:"filterButtonBar"})},n.prototype._createFilterButton=function(e){var t=this;this.filterBtn=e.appendChild(new s({text:h("tablet.mount.filter"),className:["button","filterButton"],addIcon:"before"},function(){t._setFilterBoxVisible(!t.isFilterBoxVisible)}))},n.prototype._createSortSelector=function(e){var t=e.appendChild(new b({className:"sortSelector"}));this.sorters=[{name:h("ui.common.sort")+h("ui.common.colon"),property:"id"},{name:h("tablet.mount.type"),property:"model"},{name:h("ui.common.sex"),property:"sex"},{name:h("ui.common.name"),property:"name"},{name:h("ui.common.level"),property:"level"}];for(var i=0;i<this.sorters.length;i+=1){var n=this.sorters[i];t.addOption(n.name,n.property),t.toggleOption(i,!0)}t.on("change",this._changeSorter.bind(this)),this.selectedSorter=t.selectFirst(!0)},n.prototype._createSelectAndFilterInfo=function(e){this.selectAndFilterInfo=e.createChild("div",{className:"selectAndFilterInfo"})},n.prototype._createSelectAllOrNone=function(e){var t=this,i=h("ui.common.all")+" / "+h("ui.common.none"),n=this.allNoneCheckbox=e.appendChild(new a(i));n.addClassNames("allNoneCheckbox"),n.on("change",function(e){t._setMultiselect(e,!0)})},n.prototype._setupDropZones=function(){function e(e,t,i){n._droppedMount(this,e,i)}function t(){n._handleDragEnter(this.id,!0)}function i(){n._handleDragEnter(this.id,!1)}var n=this,o=[];for(var s in this.rooms){o.push(s);var a=this.roomTabs.getTabsMap()[s];if(a){var r=this.roomTabs.getTabsMap()[s].tab;l.setDroppable(r,[I]),r.id=s,r.on("drop",e),r.on("dragEnter",t),r.on("dragLeave",i)}}this.roomDropZones=this.roomBoxes.createChild("div",{className:"roomDropZones"});for(var c=0;c<o.length;c+=1){s=o[c];var d=this.dropZones[s]=new A("div",{className:["dropZone",s,"transition"]});d.id=s;var u=this.rooms[s];"equip"===s?(this.equipBox.box.appendChild(d),d.addClassNames("equip")):(this.roomDropZones.appendChild(d),d.addClassNames("room")),d.createChild("div",{className:"amount",name:"amount"}),d.createChild("div",{className:"label",text:u.name,name:"label"}),l.setDroppable(d,[I]),d.on("drop",e),d.on("dragEnter",t),d.on("dragLeave",i)}},n.prototype._setupMountFilterBox=function(e){if(!this.isWindowSizeFull)return this.debugCheckTimeout=window.setTimeout(function(e){e.mountFilterBox||console.error("Absence of MountFilterBox after 2 seconds")},2e3,this),this.once("opened",this._setupMountFilterBox.bind(this,e));this.mountFilterBox=e.appendChild(new g(this.filters)),this.mountFilterBox.setButtonBar(this.filterButtonBar);var t=this;this.mountFilterBox.on("activeFiltersUpdated",function(){t.isFilterEmpty=t.filters.isEmpty(),t._setMultiselect(!1),t._updateDisplayedRoom(),t.filterBtn.toggleClassName("hasFilter",!t.isFilterEmpty)})},n.prototype._receiveMountData=function(e){var t,i=e.id;if(!this.certificateQueue.length)return(t=this._findTileInRooms(i))?(t.mountData=this._prepareMountForRoom(e,t.room),this._refreshTile(t),void(t===this.focusedTile&&this._displayMountDetails(e))):console.error("Received data about unknown mount ",e);var n=this.certificateQueue.shift(),o=S+n.objectUID;if(this.mountDataFromCertifId[o]=this._prepareMountForRoom(e,this.rooms.certificate),e.isNewborn&&(this.babyMap[o]=this.babyMap[i]),t=this.rooms.certificate.getTile(o),t.mountData.receivedData=e,this._refreshTile(t),t.setSpinnerVisible(!1),this.certificateTilePendingSelection===t&&(this.certificateTilePendingSelection=null,this._selectTile(this.rooms.certificate,t)),this.nonLoadedCertifCount--,this.certifAreRequested&&this.waitingGauge.refreshGauge(this.nonLoadedCertifCount),!z){var s=this.certificateQueue[0];if(s)return this._requestMountData(s)}0===this.nonLoadedCertifCount&&this.certifAreRequested&&(this.certifAreRequested=!1,"certificate"===this.openedRoom.id&&this._updateDisplayedRoom())},n.prototype._requestOneCertificate=function(e){this.certificateQueue.indexOf(e)>=0||(this.certificateQueue.push(e),!z&&this.certificateQueue.length>1||this._requestMountData(e))},n.prototype._requestAllCertificates=function(){this.certifAreRequested=!0,this.waitingGauge.showGauge(this.nonLoadedCertifCount,h("tablet.mount.loadingCertif",this.nonLoadedCertifCount));var e=this.rooms.certificate.mountMap;for(var t in e)this.mountDataFromCertifId[t]||this._requestOneCertificate(e[t].certificate)},n.prototype.tileTapHandler=function(e){return this._setFilterBoxVisible(!1),e.mountData.certificate&&!e.mountData.receivedData?(e.setSpinnerVisible(!0),this.certificateTilePendingSelection=e,this._requestOneCertificate(e.mountData.certificate)):(e.selected&&!this.isMultiselect&&this._setMultiselect(!0),void this._selectTile(e.room,e))},n.prototype._purgeNewbornList=function(){var e=Date.now();for(var t in this.babyMap)e-this.babyMap[t]>F&&delete this.babyMap[t]},n.prototype._prepareMountForRoom=function(e,t){return e.mountLocation=t.id,e.isNewborn=!!(this.babyMap[e.id]||e.receivedData&&this.babyMap[e.receivedData.id]),e},n.prototype._addMountsToRoom=function(e,t){t=Array.isArray(t)?t:[t];for(var i=t.length,n=0;n<i;n++)e.addMount(this._prepareMountForRoom(t[n],e));this.numMassAdd&&(this.numMassAdd-=i,this.waitingGauge.refreshGauge(this.numMassAdd+this.numMassRemove)),0===this.numMassAdd&&(this._updateRoomTab(e),e===this.openedRoom&&this._updateDisplayedRoom())},n.prototype._removeMountsFromRoom=function(e,t){t=Array.isArray(t)?t:[t];var i=t.length,n=this.focusedTile&&this.focusedTile.id;t.indexOf(n)!==-1&&(this._hideMountDetails(),this.focusedTile=null);for(var o=0;o<t.length;o+=1)e.removeMount(t[o]);this.numMassRemove&&(this.numMassRemove-=i,this.waitingGauge.refreshGauge(this.numMassAdd+this.numMassRemove)),0===this.numMassRemove&&(e===this.selectionRoom&&0===e.getNumSelected()&&this._setMultiselect(!1),this._updateRoomTab(e),e===this.openedRoom&&this._updateDisplayedRoom())},n.prototype._addCertificates=function(e){for(var t=this._extractCertificates(e),i=[],n=0;n<t.length;n++){var o=t[n],s=o.mountInfo,a=S+o.objectUID,r=this.mountDataFromCertifId[a];r||this.nonLoadedCertifCount++,i.push({id:a,certificate:o,model:s.modelId,name:s.name,receivedData:r})}this._addMountsToRoom(this.rooms.certificate,i)},n.prototype._removeCertificates=function(e){for(var t=[],i=0;i<e.length;i+=1){var n=S+e[i].objectUID,o=this.mountDataFromCertifId[n];o?delete this.mountDataFromCertifId[n]:this.nonLoadedCertifCount--,t.push(n)}this._removeMountsFromRoom(this.rooms.certificate,t)},n.prototype._extractCertificates=function(e){for(var t=window.gui.playerData.inventory,i=[],n=0;n<e.length;n+=1){var o=e[n],s=o.objectUID?o:t.objects[o],a=m.getMountInfoFromCertificate(s);a&&(s.effectsMap[O]||(this._enrichCertificateData(s,a),i.push(s)))}return i},n.prototype._enrichCertificateData=function(e,t){var i={mountId:t.mountId,date:t.date,modelId:t.modelId},n=e.effectsMap,o=n[R];o&&(i.name=o.text);var s=n[P];s&&(i.validityDays=s.days,i.validityHours=s.hours,i.validityMinutes=s.minutes,i.validityDesc=s.description);var a=n[D];a&&(i.ownerDesc=a.description),e.mountInfo=i},n.prototype._requestMountData=function(e){var t=e.mountInfo;window.dofus.sendMessage("MountInformationRequestMessage",{id:t.mountId,time:t.date})},n.prototype._updateRoomTab=function(e){var t=this.roomTabs.getTabsMap()[e.id];if(t){var i=t.tab.statusLabel,n='(<span class="highlight">'+e.numMounts;n+=void 0!==e.capacity&&e.capacity!==Number.POSITIVE_INFINITY?"</span> / "+e.capacity+")":"</span>)",i.setHtml(n)}},n.prototype._showRoomPlaceholderIfNeeded=function(){var e=this.openedRoom,t=e.getNumHiddenMounts(),i=e.numMounts,n=null;0===i?n=h("tablet.mount.emptyRoom"):i===t&&(n=h("tablet.mount.filteredMounts",i)),e.toggleDisplay(!n),this.roomPlaceholder.setText(n)},n.prototype._updateRoomStats=function(){var e=this.openedRoom,t=e.getNumHiddenMounts(),i=e.numMounts,n="";this.isFilterEmpty||(n=h("tablet.mount.filter")+h("ui.common.colon")+(i-t)+" / "+i+"\n");var o="";if(this.selectionRoom){var s=this.selectionRoom.getNumSelected();s>0&&(o=h("tablet.common.selection")+h("ui.common.colon")+s)}this.selectAndFilterInfo.setText(n+o)},n.prototype._updateDisplayedRoom=function(){var e=this.openedRoom;e&&("certificate"===e.id&&!this.isFilterEmpty&&this._initLoadAllCertificates()||(e.refreshDisplay(this.filters,this.selectedSorter),this._showRoomPlaceholderIfNeeded(),this._updateRoomStats()))},n.prototype._refreshTile=function(e){e.refreshDisplay(),e.room===this.openedRoom&&this._updateDisplayedRoom()},n.prototype._clearSelection=function(){var e=this.focusedTile;e&&(e.room.setMountSelected(e.id,!1),this.focusedTile=null),this.selectionRoom&&(this.selectionRoom.unselectAll(),this.selectionRoom=null),this._updateRoomStats()},n.prototype._setMultiselect=function(e,t){this.allNoneCheckbox.toggleActivation(e,!0),this.isMultiselect=e,this._clearSelection(),this._hideMountDetails(),e&&(this.selectionRoom=this.openedRoom,t&&(this.openedRoom.selectAll(),this._updateRoomStats()))},n.prototype._selectTile=function(e,t){var i=this.focusedTile;if(this.isMultiselect&&t.room!==this.selectionRoom&&this._setMultiselect(!1),this.isMultiselect){if(e.setMountSelected(t.id,!t.selected),0===e.getNumSelected())return this._setMultiselect(!1)}else{if(t===i)return;i&&i.room.setMountSelected(i.id,!1),e.setHightlightedMount(t.id)}this.focusedTile=t,this._displayMountDetails(t.mountData),this._updateRoomStats()},n.prototype._updateEquipBox=function(e){var t=window.gui.playerData.equippedMount;if(t&&this._prepareMountForRoom(t,this.rooms.equip),this.equipBox.updateMount(t),!e){var i=this.focusedTile===this.equipBox.tile;t?i?this._displayMountDetails(t):this._selectTile(this.rooms.equip,this.equipBox.tile):i&&this._hideMountDetails()}},n.prototype._hideMountDetails=function(){var e=this.focusedMountDetails;e.hide(),e.placeholder.toggleDisplay(!0);var t=h(this.isMultiselect?"tablet.mount.pendingMultiselect":"tablet.mount.selectMount");e.placeholder.setText(t)},n.prototype._displayMountDetails=function(e){if(e.certificate&&(e=e.receivedData,!e))return this._hideMountDetails();var t=this.focusedMountDetails;t.show(),t.placeholder.toggleDisplay(!1),t.dragInfo.setMount(e),t.setMount(e,{context:"breeding"})},n.prototype._requestExchangeBetweenRooms=function(e,t,i){var n=u[e][t];n&&window.dofus.sendMessage("ExchangeHandleMountStableMessage",{actionType:n,rideId:i})},n.prototype._getIdForExchange=function(e,t){return"certificate"!==e?t:~~t.substr(1)},n.prototype._moveMounts=function(e,t,i,n){void 0===n&&(n=i.length);var o=k*n;for(this.waitingGauge.showGauge(o,h("tablet.mount.moving",n),k),this.numMassRemove=this.numMassAdd=n;n>0;n--){var s=this._getIdForExchange(e,i.pop());this._requestExchangeBetweenRooms(e,t,s)}},n.prototype.prepareDraggedTiles=function(e){var t=this.rooms[e.mountLocation],i=t.getTile(e.id);return i.selected||this._selectTile(t,i),t.getNumSelected()},n.prototype._startDragging=function(e,t){var i=this;this.roomDropZones.addClassNames("enable"),e.addClassNames("dragging");var n=t.mount,o=this.rooms[n.mountLocation],s=o.getNumSelected();this.dragTimeout=setTimeout(function(){for(var e in i.dropZones){var t=i.dropZones[e];if(t.isEnabled=e!==o.id&&("equip"!==t.id||s<=1),t.toggleClassName("enable",t.isEnabled),t.isEnabled){var n=i.rooms[e],a=n.capacity-n.numMounts,r="";s>a&&(r=a>0?h("tablet.mount.roomLeft",a):h("tablet.mount.roomFullShort")),t.toggleClassName("warning",!!r&&a>0),t.toggleClassName("full",!!r&&a<=0),t.getChild("amount").setText(r)}}},N)},n.prototype._endDragging=function(e){clearTimeout(this.dragTimeout),e.delClassNames("dragging");for(var t in this.dropZones){var i=this.dropZones[t];i.delClassNames("enable","dragEnter");var n=this.roomTabs.getTabsMap()[t];if(n){var o=n.tab;o.delClassNames("dragEnter")}}if(this.roomDropZones.delClassNames("enable"),l.isLostDrop&&this.focusedTile){var s=this.focusedTile.mountData;s.certificate&&!s.receivedData&&this._clearSelection()}},n.prototype._handleDragEnter=function(e,t){var i=this.dropZones[e];i.toggleClassName("dragEnter",t);var n=this.roomTabs.getTabsMap()[e];if(n){var o=n.tab;o.toggleClassName("dragEnter",t&&i.isEnabled)}},n.prototype._droppedMount=function(e,t,i){var n=i.mount,o=n.mountLocation,s=e.id;if(o!==s){var a=this.rooms[o],r=this.rooms[s],l="equip"!==s?r.capacity-r.numMounts:r.capacity,c="equip"!==s?a.getSelection():[n.id],d=c.length;if(l<=0)window.gui.openSimplePopup(h("tablet.mount.roomFull"));else if(l<d){var u=this;window.gui.openConfirmPopup({title:h("ui.popup.warning"),message:h("tablet.mount.partialMoveMounts",l),cb:function(e){e&&u._moveMounts(o,s,c,l)}})}else this._moveMounts(o,s,c)}},n.prototype._findTileInRooms=function(e){for(var t in this.rooms){var i=this.rooms[t].getTile(e);if(i)return i}return null},n.prototype._initLoadAllCertificates=function(){return 0!==this.nonLoadedCertifCount&&(this.rooms.certificate.lockRoom(),this.roomPlaceholder.setText(" "),this._requestAllCertificates(),!0)},n.prototype._changeSorter=function(e){this.selectedSorter=e,"certificate"===this.openedRoom.id&&!B[e]&&this._initLoadAllCertificates()||this._updateDisplayedRoom()},n.prototype._setFilterBoxVisible=function(e){this.isFilterBoxVisible=e,this.filterBtn.toggleClassName("enabled",e),this.mountFilterBox&&this.mountFilterBox.toggleClassName("enable",e)}},function(e,t){},function(e,t,i){function n(e){var t=Math.min(e-1,l),i=new a("div",{className:"emptyFrame"});i.setStyles({left:t*c+"px",top:t*d+"px"});for(var n=i,o=t-1;o>=0;o--)n=n.createChild("div",{className:"emptyFrame"});return n.createChild("div",{className:"number",text:e}),i}function o(e,t){this.sourceData={mount:null},this.styles={},this.onDragClassName="draggedMount",this.wElement=t,this.imgElement=t,this.breedingWindow=e;var i={containerWidth:u,
containerHeight:h};s.setDraggable(t,this,r,this.sourceData,i)}i(821);var s=i(317),a=i(321),r="mountRoom",l=7,c=-4,d=4,u=138,h=118;e.exports=o,o.DRAG_ID=r,o.prototype.setMount=function(e,t){this.sourceData.mount=e,this.imgElement=t||this.imgElement},o.prototype.setStyle=function(e,t){this.styles[e]=t},o.prototype.prepareForDrag=function(e,t){this.setStyle("backgroundImage",this.imgElement.getStyle("backgroundImage"));var i=this.breedingWindow.prepareDraggedTiles(this.sourceData.mount);if(i>1){t.addClassNames("multiselect");var o=n(i);t.insertAsFirstChild(o),this.wElement.once("dragEnd",function(){t.removeChild(o),t.delClassNames("multiselect")})}return!0}},function(e,t){},function(e,t,i){function n(e,t,i){this.mountData=null,this.box=e.createChild("div",{className:"equipBox"}),this._createTile(t,i),this.placeholder=new r(this.box),this.placeholder.setText(a("tablet.mount.noEquipped"))}i(823);var o=i(182),s=i(820),a=i(29).getText,r=i(455),l=i(197);e.exports=n,n.prototype._createTile=function(e,t){var i=this.tile=this.box.createChild("div",{className:["mount","neutralTile"]});e.getTile=function(e){return i.id===e?i:null},i.createChild("div",{className:"title",text:a("tablet.mount.equipped")}),this.mountImg=i.createChild("div",{className:"mountImg"});var n=i.createChild("div",{className:"nameAndLevel"});this.mountName=n.createChild("div",{className:"mountName"}),this.mountLevel=n.createChild("div",{className:"level"}),l(i),i.on("tap",t),i.setTileSelected=this._setTileSelected.bind(this),i.refreshDisplay=this._refreshTile.bind(this),i.highlightTile=function(){},i.id=null,i.mountData=null,i.selected=!1,i.room=e,i.equipBox=this,this.dragInfo=new s(e.breedingWindow,i)},n.prototype.updateMount=function(e){var t=this.mountData,i=!!e;return this.tile.toggleDisplay(i),this.placeholder.toggleDisplay(!i),e?(this.mountData=e,this._refreshTile(),this.dragInfo.setMount(e,this.mountImg)):(this.mountData=null,this.tile.addClassNames("neutralTile"),this.tile.delClassNames("focusedTile")),t},n.prototype._setTileSelected=function(e){e=void 0===e||e,this.tile.toggleClassName("focusedTile",e),this.tile.toggleClassName("neutralTile",!e),this.tile.selected=e},n.prototype._refreshTile=function(){var e=this.mountData;this.tile.mountData=e,this.tile.id=e.id,this.mountName.setText(e.name||a("ui.common.noName")),this.mountLevel.setText(a("ui.common.short.level")+" "+e.level);var t=this;o.preloadImage("gfx/mounts/"+e.model+".png",function(e){t.mountImg.setStyle("backgroundImage",e)})}},function(e,t){},function(e,t){e.exports={REQUEST_IMPOSSIBLE:1,REQUEST_CHARACTER_OCCUPIED:2,REQUEST_CHARACTER_JOB_NOT_EQUIPED:3,REQUEST_CHARACTER_TOOL_TOO_FAR:4,REQUEST_CHARACTER_OVERLOADED:5,REQUEST_CHARACTER_NOT_SUSCRIBER:6,REQUEST_CHARACTER_RESTRICTED:7,BUY_ERROR:8,SELL_ERROR:9,MOUNT_PADDOCK_ERROR:10,BID_SEARCH_ERROR:11}},function(e,t,i){function n(e,t){var i=e.id;v.call(this,"div",{className:"mountBox",name:i,hidden:!0}),"certificate"===t.id&&this.addClassNames("certificate"),this.id=i,this.room=t,this.mountData=e,this.selected=!1,this.renderingForeground=null,this.detailLevel=w}function o(){var e=this.mountBox;e.room.breedingWindow.tileTapHandler(e)}function s(){return o.call(this.foreground)}function a(){this.cancelTap();var e=this.foreground.mountBox.mountData.certificate.mountInfo,t=e.ownerDesc+"\n"+e.validityDesc;_.showNotification(t,this)}function r(e){var t="certificate"===e.id,i=t?["fg","certificate"]:"fg",n=new v("div",{className:i,hidden:!0});if(n.mountBox=null,g(n,{doubletapTimeout:1}),n.on("tap",o),n.dragInfo=new c(e.breedingWindow,n),n._mountName=n.createChild("div",{className:"mountName"}),n._mountImg=n.createChild("div",{className:"mountImg"}),t){n._certifValidity=n.createChild("div",{className:"certifValidity"});var r=n.createChild("div",{className:"certifImg"});g(r,{doubletapTimeout:1}),r.foreground=n,r.on("tap",s),r.on("longtap",a)}else{n._level=n.createChild("div",{className:"level"}),n._fertileIcon=n.appendChild(new f("fertile"));var l=n.gaugeDiv=n.createChild("div",{className:["gaugeDiv","partial"]}),u=l.createChild("div",{className:"iconGaugeBar"});n._staminaGauge=u.appendChild(new d("stamina",null,{size:y,withoutLabel:!0})),n._maturityGauge=u.appendChild(new d("maturity",null,{size:y,withoutLabel:!0})),n._loveGauge=u.appendChild(new d("love",null,{size:y,withoutLabel:!0})),n._serenityGauge=l.appendChild(new m({isMini:!0})),n._serenityGauge.resize()}return n}i(826);var l=i(182),c=i(820),d=i(551),u=i(29).getText,h=i(172).inherits,p=i(548),m=i(559),f=i(561),g=i(197),_=i(337),v=i(321),y=27,b=4,M=2,w=0,T=1,C=2,A={};A.shed=[],A.paddock=[],A.certificate=[];var I={};h(n,v),e.exports=n,n.freeContent=function(){A.shed=[],A.paddock=[],A.certificate=[]},n.prototype.setSpinnerVisible=function(e){this.renderingForeground&&this.renderingForeground.toggleClassName("spinner",!!e)},n.prepareTilePool=function(e,t){for(var i=A[e.id],n=t-i.length,o=0;o<n;o++){var s=e.box.appendChild(r(e));i.push(s)}},n.prototype._createTile=function(){var e=this.room,t=A[e.id],i=t.pop();i||(i=e.box.appendChild(r(e))),i.mountBox=this,this.renderingForeground=i},n.prototype._moveTile=function(e){var t=this.renderingForeground;if(t.index!==e){var i=this.room,n=i.numColumns,o=Math.floor(e/n)*i.rowHeight,s=e%n*i.columnWidth;t.index=e,t.setStyle("webkitTransform","translate3d("+s+"px, "+o+"px, 0)")}},n.prototype._releaseTileContent=function(){var e=A[this.room.id];e.push(this.renderingForeground),this.renderingForeground=null,this.detailLevel=w},n.prototype._updateTileContent=function(e){var t=this.renderingForeground;if(t){this.detailLevel=e;var i=this.mountData;if(t._mountName.setText(i.name||u("ui.common.noName")),t._mountName.toggleClassName("noName",!i.name),i.certificate){var n=i.receivedData;t._mountName.toggleClassName("sexUnknown",!n),t._mountName.toggleClassName("female",!!n&&n.sex);var o=i.certificate.mountInfo;this._setValidity(t._certifValidity,o.validityDays,o.validityHours,o.validityMinutes)}else{t._mountName.toggleClassName("female",!!i.sex),t._level.setText(u("ui.common.short.level")+" "+i.level);var s=p.getFertilityState(i);t._fertileIcon.setFertileIcon(s),e===C?(t._staminaGauge.setValue(i.stamina,i.staminaMax),t._maturityGauge.setValue(i.maturity,i.maturityForAdult),t._loveGauge.setValue(i.love,i.loveMax),t._serenityGauge.setValue(i.serenity),t.gaugeDiv.delClassNames("partial")):t.gaugeDiv.addClassNames("partial")}t.dragInfo.setMount(i,t._mountImg),this._retrieveMountImgUrl(t._mountImg,i.model),t.show()}},n.prototype._retrieveMountImgUrl=function(e,t){if(t!==e.currentModel){e.currentModel=t;var i=I[t];return i?e.setStyle("backgroundImage",i):void l.preloadImage("gfx/mounts/"+t+".png",function(i){I[t]=i,e.currentModel===t&&e.setStyle("backgroundImage",i)})}},n.prototype._setValidity=function(e,t,i,n){var o=u("tablet.common.validity")+u("ui.common.colon");o+=t>0?t+" "+u("ui.time.days",t):i>0?i+" "+u("ui.time.hours",i):n+" "+u("ui.time.minutes",n),e.toggleClassName("expiringSoon",t<b&&t>=M),e.toggleClassName("expiringVerySoon",t<M),e.setText(o)},n.prototype.refreshDisplay=function(){this._updateTileContent(C)},n.prototype.setTileSelected=function(e){this.selected=e,this.toggleClassName("selected",e),this.delClassNames("focusedTile")},n.prototype.highlightTile=function(){this.selected=!0,this.addClassNames("focusedTile")},n.prototype.prepareToShow=function(e,t){if(this.renderingForeground&&this.renderingForeground.index<0&&this._moveTile(e),1===t){if(this.detailLevel>=T)return!1;this._createTile(),this._moveTile(e),this._updateTileContent(T)}else if(2===t){if(this.detailLevel===C)return!1;this._updateTileContent(C)}return!0},n.prototype.prepareToGoOffScreen=function(){this.renderingForeground&&this._releaseTileContent()},n.prototype.showTile=function(){this.show()},n.prototype.hideTile=function(){this.hide(),this.renderingForeground&&(this.renderingForeground.hide(),this._releaseTileContent())},n.hidePoolTiles=function(e){for(var t=A[e.id],i=t.length-1;i>=0;i--)t[i].hide()},n.prototype.markForReorder=function(){this.renderingForeground&&(this.renderingForeground.index=-1)}},function(e,t){},function(e,t,i){function n(e){w.call(this,"div",{className:"MountFilterBox"}),this.isReady=!1,this.buttonBar=null,this.filterButtons=[],this.batchUpdateLevel=0,this.mountFilters=e,e.isReady?this._createDom():e.once("mountFiltersReady",this._createDom.bind(this))}function o(e,t){e.createChild("div",{className:"barTitle",text:t.toUpperCase()})}function s(){var e=this.mountFilterBox,t=!e.serenityFlagMap[this.zoneName];e.serenityFlagMap[this.zoneName]=t,e.numSerenityZonesOn+=t?1:-1,e._updateSerenityFilter()}function a(e){var t=e&&e.id,i=e&&e.caption;this.mountFilterBox._setColorButtonValue(this,t,i),this.mountFilterBox._updateFilter()}function r(e,t){t?(this.selectState(E),window.gui.openContextualMenuAround("generic",this,{actions:this.menuActions})):a.call(this,null)}function l(e){var t=e&&e.id,i=e&&e.caption;if(t!==this.abilityId){var n=this.filterName,o=this.mountFilterBox;this.abilityId&&(o._delFilterButton(n),o.mountFilters.removeFilter(n)),this.abilityId=t,t?(o.mountFilters.addBehaviorFilter(n,t,!0),o._addFilterButton(n,i),this.setLabel(i),this.selectState(x)):(this.setLabel(this.emptyLabel),this.selectState(E)),o._updateFilter()}}function c(e,t){t?(this.selectState(E),window.gui.openContextualMenuAround("generic",this,{actions:this.menuActions})):l.call(this,null)}function d(){this.mountFilterBox[this.filterName].reset()}i(828);var u,h=i(335),p=i(442),m=i(458),f=i(29).getText,g=i(172).inherits,_=i(342),v=i(544),y=i(559),b=i(197),M=i(829),w=i(321),T=[["maleBtn","femaleBtn"],["newbornBtn","rideableBtn"],["fertileBtn","sterilizedBtn"],["pregnantBtn","fertileBtn"],["pregnantBtn","sterilizedBtn"]],C={maleBtn:{filterId:"sex",isReversed:!0,label:"ui.common.animalMale",addIcon:!0},femaleBtn:{filterId:"sex",label:"ui.common.animalFemale",addIcon:!0},newbornBtn:{filterId:"baby",isReversible:!0,label:"tablet.mount.filterNewborn"},pregnantBtn:{filterId:"pregnant",isReversible:!0,label:"tablet.mount.filterPregnant"},fertileBtn:{filterId:"fruitful",isReversible:!0,label:"tablet.mount.filterFertile"},sterilizedBtn:{filterId:"sterilized",isReversible:!0,label:"tablet.mount.filterSterilized"},rideableBtn:{filterId:"mountable",isReversible:!0,label:"tablet.mount.filterMountable"},loveBtn:{filterId:"love",isReversible:!0,label:"ui.common.love",addIcon:!0},staminaBtn:{filterId:"stamina",isReversible:!0,label:"ui.common.stamina",addIcon:!0},maturityBtn:{filterId:"maturity",isReversible:!0,label:"ui.common.maturity",addIcon:!0},energyBtn:{filterId:"energy",isReversible:!0,label:"ui.common.energy",addIcon:!0}},A=[["tired0Btn","tiredInf50Btn"],["tired0Btn","tiredSup50Btn"],["tired0Btn","tiredInf100Btn"],["tired0Btn","tired100Btn"],["tiredInf50Btn","tiredSup50Btn"],["tiredInf50Btn","tiredInf100Btn"],["tiredInf50Btn","tired100Btn"],["tiredSup50Btn","tired100Btn"],["tiredInf100Btn","tired100Btn"]],I={tired0Btn:{label:"= 0%",equal:0},tiredInf50Btn:{label:"< 50%",max:49.99},tiredSup50Btn:{label:">= 50%",min:50},tiredInf100Btn:{label:"< 100%",max:99.99},tired100Btn:{label:"= 100%",min:100}},S=-1,E=0,x=1,N=2,L=[{value:null},{value:!0,className:"active"},{value:!1,className:"reversed"}],O=[{value:null},{value:!1,className:"active"}];g(n,w),e.exports=n,n.prototype.getFilters=function(){return this.mountFilters},n.prototype.setButtonBar=function(e){this.buttonBar=e},n.prototype.resetFilters=function(){this.isReady&&this._resetFilters(!0)},n.prototype._resetFilters=function(e){this._enterBatchUpdate(),this._clearSearchBox();for(var t in C)this[t].reset();for(t in I)this[t].reset();this._resetSerenityFilter(),this.colorA.reset(),this.colorB.reset(),this.abilityA.reset(),this.abilityB.reset(),this.minFatigue=0,this.maxFatigue=100,this._leaveBatchUpdate(e)},n.prototype._enterBatchUpdate=function(){this.batchUpdateLevel++},n.prototype._leaveBatchUpdate=function(e){this.batchUpdateLevel--,0!==this.batchUpdateLevel||e||this._updateFilter()},n.prototype._updateFilter=function(){this.batchUpdateLevel>0||(this._updateButtonBar(),this.emit("activeFiltersUpdated",this.mountFilters))},n.prototype._createDom=function(){u=f("tablet.mount.pureColor"),this._setupNameBar(),this._setupToggles(),this._setupSerenityBar(),this._setupFatigueBar(),this._setupColorBar(),this._setupAbilityBar(),this.appendChild(new h({text:f("ui.common.reset"),className:["button","resetButton"]},this._resetFilters.bind(this,!1))),this._resetFilters(!0),this.isReady=!0},n.prototype._setupNameBar=function(){var e=this.createChild("div",{className:"nameBar"}),t=this.searchBox=e.appendChild(new v({isLiveSearch:!0,maxLength:_.MAX_RIDE_NAME_LEN}));t.setPlaceholder(f("ui.common.name")),t.on("search",this._searchBoxChanged.bind(this)),t.reset=this._clearSearchBox.bind(this)},n.prototype._searchBoxChanged=function(e){this._delFilterButton("searchBox"),e?(this.mountFilters.setFilter("name",e.toLowerCase()),this._addFilterButton("searchBox",'"'+e+'"')):this.mountFilters.removeFilter("name"),this._updateFilter()},n.prototype._clearSearchBox=function(){this.searchBox.setValue(""),this._searchBoxChanged("")},n.prototype._deactivateOppositeToggles=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];if(!(n.indexOf(e)<0))for(var o=0;o<n.length;o++)n[o]!==e&&this[n[o]].reset()}},n.prototype._toggleBtnHandler=function(e,t,i){this._enterBatchUpdate();var n=C[e],o=n.filterId;switch(i){case E:this._delFilterButton(e),this.mountFilters.removeFilter(o);break;case x:this._deactivateOppositeToggles(e,T),this._addFilterButton(e,f(n.label)),this.mountFilters.setFilter(o,t);break;case N:this._delFilterButton(e),this._addFilterButton(e,f(n.label),"reversed"),this.mountFilters.setFilter(o,t);break;default:console.error("invalid valueIndex: "+i)}this._leaveBatchUpdate()},n.prototype._newToggleButton=function(e,t,i){var n,o=C[t],s=f(o.label),a=o.addIcon;o.isReversible?n=L:o.isReversed&&(n=O),this[t]=e.appendChild(new M(t,i,{text:s,addIcon:a,states:n}))},n.prototype._setupToggles=function(){var e=this._toggleBtnHandler.bind(this),t=this.createChild("div",{className:"sexBar"});this._newToggleButton(t,"maleBtn",e),this._newToggleButton(t,"femaleBtn",e),t=this.createChild("div",{className:"sexBar"}),this._newToggleButton(t,"newbornBtn",e),this._newToggleButton(t,"rideableBtn",e),t=this.createChild("div",{className:"fertileBar"}),this._newToggleButton(t,"pregnantBtn",e),this._newToggleButton(t,"fertileBtn",e),this._newToggleButton(t,"sterilizedBtn",e);var i=this.createChild("div",{className:"hasOrNeedsBar"});t=i.createChild("div",{className:"hasOrNeedsDiv"}),this._newToggleButton(t,"staminaBtn",e),this._newToggleButton(t,"loveBtn",e),t=i.createChild("div",{className:"hasOrNeedsDiv"}),this._newToggleButton(t,"maturityBtn",e),this._newToggleButton(t,"energyBtn",e)},n.prototype._updateSerenityFilter=function(){for(var e in this.serenityFlagMap)this.serenity[e].toggleClassName("active",this.serenityFlagMap[e]);this.serenity.toggleClassName("allOff",0===this.numSerenityZonesOn);var t=y.SERENITY_MIN,i=y.SERENITY_MAX;switch(this.numSerenityZonesOn){case 0:this.mountFilters.removeFilter("serenity");break;case 1:this.serenityFlagMap.stamina?i=-1:this.serenityFlagMap.maturity?(t=y.GOOD_SERENITY_MIN,i=y.GOOD_SERENITY_MAX):t=1,this.mountFilters.setFilter("serenity",[t,i]);break;case 2:if(this.serenityFlagMap.stamina){if(!this.serenityFlagMap.maturity){this.mountFilters.setFilter("serenity",[0,0,!0]);break}i=y.GOOD_SERENITY_MAX}else t=y.GOOD_SERENITY_MIN;this.mountFilters.setFilter("serenity",[t,i]);break;case 3:this.mountFilters.removeFilter("serenity")}this._delFilterButton("serenity"),this.numSerenityZonesOn&&this._addFilterButton("serenity",f("ui.common.serenity")),this._updateFilter()},n.prototype._resetSerenityFilter=function(){this.serenityFlagMap={stamina:!1,maturity:!1,love:!1},this.numSerenityZonesOn=0,this._updateSerenityFilter()},n.prototype._addSerenityButton=function(e){var t=new w("div",{className:e});return b(t),t.on("tap",s),t.mountFilterBox=this,t.zoneName=e,this.serenity[e]=t,t},n.prototype._setupSerenityBar=function(){var e=this.createChild("div",{className:"serenityBar"});this.serenity=e,e.reset=this._resetSerenityFilter.bind(this),e.createChild("div",{className:["bigIcon","bigIcon_mad"]});var t=e.createChild("div",{className:"bigButton"});e.createChild("div",{className:["bigIcon","bigIcon_happy"]}),t.appendChild(this._addSerenityButton("stamina")),t.appendChild(this._addSerenityButton("maturity")),t.appendChild(this._addSerenityButton("love")),t.createChild("div",{className:"bigButtonShape"})},n.prototype._setColorButtonValue=function(e,t,i){var n=e.filterName,o=this.mountFilters;if(e.colorId&&(this._delFilterButton(n),o.removeFilter(n)),e.colorId=t,t){var s=null;t!==S?(s=o.getSingleColorMap()[t].colors[0],o.addColorFilter(n,t)):(i=u,o.addPureColorFilter(n)),this._addFilterButton(n,i),e.colorTile.setStyle("backgroundColor",s),e.setLabel(i),e.setIcon(t!==S?e.colorTile:null),e.selectState(x);var a=e===this.colorB?this.colorA:this.colorB;t===a.colorId&&o.isRealColor(t)&&this._setColorButtonValue(a,S,u)}else e.setLabel(e.emptyLabel),e.setIcon(null),e.selectState(E)},n.prototype._newColorList=function(e,t,i){var n=f("tablet.common.color")+" "+i,o=e.appendChild(new M(t,r,{text:n}));o.addClassNames(t),o.colorTile=new w("div",{className:"colorTile"}),o.emptyLabel=n,o.mountFilterBox=this,o.filterName=t;var s=this.mountFilters.getSingleColorMap(),l=a.bind(o),c=o.menuActions=[];for(var d in s)c.push({id:~~d,caption:s[d].singleColorName,cb:l});return p.sortMenuActions(c),c.unshift({id:S,caption:"("+u+")",cb:l}),o},n.prototype._setupColorBar=function(){var e=this.createChild("div",{className:"colorBar"}),t=e.createChild("div",{className:"colorDiv"});this.colorA=this._newColorList(t,"colorA",1),this.colorB=this._newColorList(t,"colorB",2)},n.prototype._newAbilityList=function(e,t,i){var n=f("ui.common.capacity",1)+" "+i,o=e.appendChild(new M(t,c,{text:n}));o.addClassNames(t),o.emptyLabel=n,o.mountFilterBox=this,o.filterName=t;var s=window.gui.databases.MountBehaviors,a=l.bind(o),r=o.menuActions=[];for(var d in s)r.push({id:~~d,caption:s[d].nameId,cb:a});return p.sortMenuActions(r),o},n.prototype._setupAbilityBar=function(){var e=this.createChild("div",{className:"abilityBar"}),t=e.createChild("div",{className:"abilityDiv"});this.abilityA=this._newAbilityList(t,"abilityA",1),this.abilityB=this._newAbilityList(t,"abilityB",2)},n.prototype._fatigueBtnHandler=function(e,t){this._enterBatchUpdate(),t&&this._deactivateOppositeToggles(e,A);var i=I[e];t?(this._addFilterButton(e,i.label),void 0!==i.equal&&(this.minFatigue=this.maxFatigue=i.equal),void 0!==i.min&&(this.minFatigue=i.min),void 0!==i.max&&(this.maxFatigue=i.max)):(this._delFilterButton(e),void 0===i.min&&void 0===i.equal||(this.minFatigue=0),void 0===i.max&&void 0===i.equal||(this.maxFatigue=100)),0!==this.minFatigue||100!==this.maxFatigue?this.mountFilters.setFilter("fatigue",[this.minFatigue,this.maxFatigue]):this.mountFilters.removeFilter("fatigue"),this._leaveBatchUpdate()},n.prototype._setupFatigueBar=function(){var e=this._fatigueBtnHandler.bind(this),t=this.createChild("div",{className:"fatigueBar"});o(t,f("ui.common.tire"));var i=t.createChild("div",{className:"fatigueDiv"});this.tired0Btn=i.appendChild(new M("tired0Btn",e,{text:"0%"})),this.tiredInf50Btn=i.appendChild(new M("tiredInf50Btn",e,{text:"< 50%"})),this.tiredSup50Btn=i.appendChild(new M("tiredSup50Btn",e,{text:">= 50%"})),this.tiredInf100Btn=i.appendChild(new M("tiredInf100Btn",e,{text:"< 100%"})),this.tired100Btn=i.appendChild(new M("tired100Btn",e,{text:"100%"}))},n.prototype._addFilterButton=function(e,t,i){var n=new m(t,d,e);i&&n.addClassNames(i),n.mountFilterBox=this,this.filterButtons.push(n)},n.prototype._delFilterButton=function(e){for(var t=0;t<this.filterButtons.length;t++){var i=this.filterButtons[t];if(i.filterName===e)return void this.filterButtons.splice(t,1)}},n.prototype._updateButtonBar=function(){if(this.buttonBar){for(var e=new w("div"),t=0;t<this.filterButtons.length;t++){var i=this.filterButtons[t];e.appendChild(i)}this.buttonBar.clearContent(),this.buttonBar.appendChild(e)}}},function(e,t){},function(e,t,i){function n(e,t,i){a.call(this,"div"),this.name=e,this.tapHandler=t,this.states=i.states||r,this._createDom(i),this._setValueByIndex(0),s(this),this.on("tap",this._changeToNextValue)}i(830);var o=i(172).inherits,s=i(197),a=i(321),r=[{value:!1},{value:!0,className:"active"}];o(n,a),e.exports=n,n.prototype._createDom=function(e){e.addIcon&&(this.icon=this.createChild("div",{className:"btnIcon"})),e.text&&(this.labelElement=this.createChild("div",{className:"label",text:e.text}))},n.prototype._changeToNextValue=function(){var e=(this.valueIndex+1)%this.states.length;this._setValueByIndex(e),this._notifyOfUpdate()},n.prototype._notifyOfUpdate=function(){this.tapHandler(this.name,this.states[this.valueIndex].value,this.valueIndex)},n.prototype._setValueByIndex=function(e){this.valueIndex=e;var t=this.icon?"withIcon":"";this.setClassNames(["toggleButton",this.name,t,this.states[e].className])},n.prototype.setIcon=function(e){e!==this.icon&&(this.icon&&this.removeChild(this.icon),this.icon=e,this.toggleClassName("withIcon",!!e),e&&this.insertAsFirstChild(e))},n.prototype.setLabel=function(e){this.labelElement.setText(e)},n.prototype.reset=function(){0!==this.valueIndex&&(this._setValueByIndex(0),this._notifyOfUpdate())},n.prototype.selectState=function(e){return e<0||e>=this.states.length?console.error("Bad state index for toggle: "+e):void this._setValueByIndex(e)}},function(e,t){},function(e,t,i){function n(e,t,i,n){this.id=e,this.name=t,this["do"]=i,this.args=n}function o(){c.call(this),this.activeFilters={},this.singleColorMap={},this.filterMap={};for(var e=this._getFilterDefinitions(),t=0;t<e.length;t++){var i=e[t];this.filterMap[i.id]=i}this.isReady=!1;var n=this;this._setupTypes(function(){n.isReady=!0,n.emit("mountFiltersReady")})}function s(e,t){var i=this.behaviors.indexOf(e)!==-1;return i&&t||!i&&!t}function a(e){var t=M[this.model]||this.model,i=y[t];return i.singleColorName?t===e:w[t].indexOf(e)!==-1}function r(){var e=y[this.model];return p.isSingleColor(e.colors)}function l(e){var t=d("tablet.mount.dragoturkey").toLowerCase(),i=e.toLowerCase().replace(t,"").trim(),n=i.length-1;return"-"===i[n]&&(i=i.substr(0,n-1)),i[0].toUpperCase()+i.substr(1)}var c=i(188).EventEmitter,d=i(29).getText,u=i(172).inherits,h=i(352).isEmptyObject,p=i(555),m=i(30),f=5,g=7500,_=p.ARMOURED_MOUNT_ID,v=p.FEATHERY_MOUNT_ID,y={},b=[3,10,15,16,17,18,19,20,21,22,23,_,v],M={1:20,6:10,74:18},w={9:[3,16],11:[16,10],12:[3,10],33:[20,18],34:[20,3],35:[20,21],36:[20,17],37:[20,16],38:[20,10],39:[20,15],40:[20,22],41:[20,19],42:[18,3],43:[18,21],44:[18,17],45:[18,16],46:[18,10],47:[18,15],48:[18,22],49:[18,19],50:[3,21],51:[3,17],52:[3,15],53:[3,22],54:[3,19],55:[21,17],56:[21,16],57:[21,10],58:[21,15],59:[21,22],60:[21,19],61:[17,16],62:[17,10],63:[17,15],64:[17,22],65:[17,19],66:[16,15],67:[16,22],68:[16,19],69:[15,10],70:[22,10],71:[19,10],72:[15,22],73:[15,19],76:[22,19],77:[23,20],78:[23,18],79:[23,3],80:[23,21],82:[23,17],83:[23,16],84:[23,10],85:[23,15],86:[23,22],87:[23,19]};u(o,c),e.exports=o,o.MountFilter=n,o.prototype._getFilterDefinitions=function(){return[{id:"name","do":function(e){return this.name.toLowerCase().indexOf(e)>-1}},{id:"sex",name:d("ui.common.animalFemale"),antiName:d("ui.common.animalMale"),"do":function(e){return this.sex===e}},{id:"baby",name:d("tablet.mount.filterNewborn"),"do":function(e){var t=!!this.isNewborn;return t===e}},{id:"fruitful",name:d("tablet.mount.filterFertile"),"do":function(e){var t=this.isFecondationReady,i=this.reproductionCount>=0&&this.reproductionCount<this.reproductionCountMax,n=!t&&i&&this.level>=f;return t&&e||n&&!e}},{id:"pregnant",name:d("tablet.mount.filterPregnant"),"do":function(e){return this.fecondationTime>0===e&&void 0!==this.fecondationTime}},{id:"mountable",name:d("tablet.mount.filterMountable"),"do":function(e){return this.isRideable===e}},{id:"sterilized",name:d("tablet.mount.filterSterilized"),"do":function(e){var t=this.reproductionCount<0||this.reproductionCount>=this.reproductionCountMax;return t===e}},{id:"love",name:d("tablet.mount.filterNeedLove"),"do":function(e){return this.love>=g===e}},{id:"stamina",name:d("tablet.mount.filterNeedStamina"),"do":function(e){return this.stamina>=g===e}},{id:"maturity",name:d("tablet.mount.filterNeedMaturity"),"do":function(e){return this.maturity>=this.maturityForAdult===e}},{id:"energy",name:d("tablet.mount.filterNeedEnergy"),"do":function(e){return this.energy>=this.energyMax===e}},{id:"serenity",name:d("ui.common.serenity"),"do":function(e,t,i){return i?this.serenity<e||this.serenity>t:this.serenity>=e&&this.serenity<=t}},{id:"fatigue",name:d("ui.common.tire"),"do":function(e,t){var i=this.boostLimiter/this.boostMax*100;return i>=e&&i<=t}}]},o.prototype.isEmpty=function(){return h(this.activeFilters)},o.prototype.isMatch=function(e){var t=this.activeFilters;for(var i in t){var n=t[i];if(!n["do"].apply(e,n.args))return!1}return!0},o.prototype.setFilter=function(e,t){var i=this.filterMap[e];return i.args=Array.isArray(t)?t:[t],this.activeFilters[e]=i,i},o.prototype.removeFilter=function(e){delete this.activeFilters[e]},o.prototype.addBehaviorFilter=function(e,t,i){var o=window.gui.databases.MountBehaviors[t];this.activeFilters[e]=new n("behavior"+t,o.nameId,s,[t,i])},o.prototype.addColorFilter=function(e,t){var i=this.singleColorMap[t];this.activeFilters[e]=new n("color"+t,i.singleColorName,a,[t])},o.prototype.addPureColorFilter=function(e){this.activeFilters[e]=new n("colorPure","",r)},o.prototype.getSingleColorMap=function(){return this.singleColorMap},o.prototype.isRealColor=function(e){return e!==_&&e!==v},o.prototype._setupTypes=function(e){var t=this.singleColorMap;m.getAllDataTable("Mounts",function(i,n){if(i)return console.error(i);for(var o=0;o<n.length;o++){var s=n[o];y[s.id]=s,s.colors=p.parseColorsFromLook(s.id,s.look),b.indexOf(s.id)!==-1&&(s.singleColorName=l(s.nameId),t[s.id]=s)}return e&&e()})}},function(e,t,i){function n(e,t,i,n){c.call(this),this.breedingWindow=e,this.id=t,this.name=i||"",this.capacity=n||Number.POSITIVE_INFINITY,this.box=null,this.reset()}function o(){var e=this.room;e.scrollStartTime=Date.now(),e.isScrolling=!0,e.refreshInterval||(e.refreshInterval=window.setInterval(r,_,e))}function s(){this.room.isScrolling=!1}function a(){var e=this.room;e.isScrolling=!1,e._stopTicker()}function r(e){Date.now()-e.scrollStartTime<v||(e._refreshView(),e.isRefreshComplete&&!e.isScrolling&&e._stopTicker())}function l(e,t,i,n,o,s){if(n<=i)return 0;var a,r,l;o?(l=-1,a=n-1,r=i-1):(l=1,a=i,r=n);for(var c=0,d=a;d!==r&&(!t[d].prepareToShow(d,e)||(c++,!s||c!==s));d+=l);return c}i(833);var c=i(188),d=i(172).inherits,u=i(825),h=i(436),p=4,m=37,f=14,g=1.5,_=90,v=100,y=2;d(n,c),e.exports=n,n.prototype.reset=function(){this.delayedSetup=0,this._stopTicker(),this.refreshInterval=null,this.lastRenderedScrollY=-1,this.scrollStartTime=0,this.isScrolling=!1,this.isRefreshComplete=!0,this.numMounts=0,this.mountMap={},this.selectedTiles={},this.numSelected=0,this.isLocked=!1,this.needsScrollerRefresh=!1,this.needRefilter=!1,this.hasNoFilter=!0,this.hasNoSorter=!0,this.currentSorter="",this.tilesPerPage=0,this.allTiles=[],this.allVisibleTiles=[],this.box&&(this.box.clearContent(),this.scroller.goToTop())},n.prototype.createBox=function(e){var t=this.scroller=e.appendChild(new h(null,{maxSpeed:g,bounce:!0}));t.room=this,t.setStyle("maxHeight",e.rootElement.clientHeight+"px"),t.on("scrollStart",o),t.on("scrollEnd",s),t.on("scrollCancel",a);var i=t.content.createChild("div",{className:["roomBox",this.id]});return this.box=i.createChild("div",{className:"tileRoom"}),this.scrollGrip=i.createChild("div",{className:"scrollGrip"}),t},n.prototype.getTile=function(e){return this.box.getChild(e)},n.prototype.setMountSelected=function(e,t){var i=this.getTile(e);return i?(t?i.selected||(this.selectedTiles[e]=i,this.numSelected++):i.selected&&(delete this.selectedTiles[e],this.numSelected--),i.setTileSelected(t),i):console.error("Invalid tileId:",e)},n.prototype.setHightlightedMount=function(e){var t=this.setMountSelected(e,!0);t.highlightTile()},n.prototype.selectAll=function(){for(var e=this.allVisibleTiles,t=0;t<e.length;t++){var i=e[t];i.selected||(this.selectedTiles[i.id]=i,i.setTileSelected(!0))}this.numSelected=e.length},n.prototype.unselectAll=function(){for(var e in this.selectedTiles){var t=this.selectedTiles[e];t.setTileSelected(!1)}this.selectedTiles={},this.numSelected=0},n.prototype.getSelection=function(){return Object.keys(this.selectedTiles)},n.prototype.getNumSelected=function(){return this.numSelected},n.prototype.getNumHiddenMounts=function(){return this.allTiles.length-this.allVisibleTiles.length},n.prototype.addMount=function(e){this.mountMap[e.id]=e,this.numMounts++;var t=new u(e,this);this.box.appendChild(t),this.allTiles.push(t),this.hasNoSorter?this.allVisibleTiles.push(t):this.currentSorter=null,this.needsScrollerRefresh=!0},n.prototype.removeMount=function(e){var t=this.mountMap[e];if(!t)return console.warn("removeMount: invalid ID:",e);var i=this.box.getChild(e);delete this.mountMap[e],this.numMounts--,i.selected&&(delete this.selectedTiles[e],this.numSelected--);var n=this.allTiles.indexOf(i);this.allTiles.splice(n,1);var o=this.allVisibleTiles;n=o.indexOf(i),o.splice(n,1);for(var s=o.length-1;s>=n;s--)o[s].markForReorder();i.hideTile(),this.box.removeChild(e),this.needsScrollerRefresh=!0},n.prototype._sortByProperty=function(e){function t(t,i){var o=t.mountData,s=i.mountData;return o.receivedData&&(o=o.receivedData),s.receivedData&&(s=s.receivedData),o[e]>s[e]?n:o[e]<s[e]?-n:o.id>s.id?n:-n}if(e!==this.currentSorter){this.currentSorter=e,this.hasNoSorter=!1;var i=!1,n=i?-1:1;this._hideAllTiles(),this.needRefilter=!0,this.allTiles.sort(t);for(var o=this.allTiles,s=0;s<o.length;s++)this.box.appendChild(o[s])}},n.prototype._filter=function(e){var t=e.isEmpty();if(!t||!this.hasNoFilter||this.needRefilter){this.needsScrollerRefresh=!0,this.hasNoFilter=t,this.needRefilter=!1,this._hideAllTiles(),this.allVisibleTiles=[];for(var i=this.allTiles,n=0;n<i.length;n++){var o=i[n],s=o.mountData;s.receivedData&&(s=s.receivedData),e.isMatch(s)&&(this.allVisibleTiles.push(o),o.showTile())}}},n.prototype.toggleDisplay=function(e){this.scroller.toggleDisplay(e)},n.prototype.lockRoom=function(){this.isLocked=!0,this.scroller.hide(),this._hideAllTiles()},n.prototype.refreshDisplay=function(e,t){return this.isLocked&&(this.isLocked=!1,this._showAllTiles()),this.scroller.show(),t&&this._sortByProperty(t),this._filter(e),this.tilesPerPage?(this.needsScrollerRefresh&&(this.scroller.refresh(),this.needsScrollerRefresh=!1),void this._refreshView(!0)):this._setupLayout()},n.prototype._setupLayout=function(){if(this.allVisibleTiles.length){var e=this.scroller.getParent().rootElement,t=e.clientWidth,i=e.clientHeight,n=this.allVisibleTiles[0];n.setStyle("opacity",0);var o=n.rootElement.clientWidth,s=this.columnWidth=o+2*p;this.rowHeight=n.rootElement.clientHeight+2*p,n.setStyle("opacity",null);var a=Math.floor(t/s),r=t-a*s-f;r<m&&a>1&&(a--,r+=s),this.numColumns=a;var l=Math.ceil(i/this.rowHeight)+1;this.tilesPerPage=l*this.numColumns,this.extraTilesTopOrBottom=this.tilesPerPage,u.prepareTilePool(this,Math.min(this.numMounts,this.tilesPerPage+2*this.extraTilesTopOrBottom)),this.scrollGrip.setStyle("width",r+"px"),this.scroller.refresh(),this._refreshView(!0)}},n.prototype._stopTicker=function(){window.clearInterval(this.refreshInterval),this.refreshInterval=null},n.prototype._refreshView=function(e){var t=Math.min(0,this.scroller.iScroll.y);if(!(this.isRefreshComplete&&!e&&Math.abs(t-this.lastRenderedScrollY)<this.rowHeight)){var i=t-this.lastRenderedScrollY>0;this.isRefreshComplete=!1;for(var n=this.allVisibleTiles,o=n.length,s=Math.floor(-t/this.rowHeight)*this.numColumns,a=s,r=Math.min(s+this.tilesPerPage,o),c=this.extraTilesTopOrBottom,d=Math.max(0,s-c),u=Math.min(s+this.tilesPerPage+c,o),h=0;h<o;h++)h>=d&&h<u||n[h].prepareToGoOffScreen();
var p=e?1/0:this.numColumns*y,m=l(1,n,a,r,i,p);p-=m,m&&!e||(m=l(2,n,a,r,i,p)),e&&(m+=l(1,n,d,u)),0===m&&(this.isRefreshComplete=!0,this.lastRenderedScrollY=t)}},n.prototype._hideAllTiles=function(){for(var e=this.allVisibleTiles,t=0;t<e.length;t++)e[t].hideTile();u.hidePoolTiles(this)},n.prototype._showAllTiles=function(){for(var e=this.allVisibleTiles,t=0;t<e.length;t++)e[t].showTile()}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"tabs"}),e=e||{},this.addClassNames(e.className),this.options=e,this.tabsMap={},this.tabsOrderIds=[],this.curentTabId=null,this.nextId=0}i(835);var o=i(172).inherits,s=i(321),a=i(197),r=i(247).playUiSound;o(n,s),e.exports=n,n.prototype.addTab=function(e,t,i){var n=this,o=i,s=!1;o||(o=this.nextId,this.nextId+=1,s=!0);var l=s?"tab"+o:o,c=this.createChild("div",{className:["tab",l],text:e});return a(c),c.on("tap",function(){n.options.closable&&o===n.curentTabId?n.close():(n.openTab(o),r("TAB"))}),c.on("enable",function(e){this._isDisable=!e,this.toggleClassName("disabled",!e),e||n.curentTabId!==o||n.openFirstTab()}),this.tabsMap[o]={tab:c,target:t},this.tabsOrderIds.push(o),t&&t.hide(),o},n.prototype.toggleTabDisplay=function(e,t){var i=this.tabsMap[e];if(i&&i.tab.toggleDisplay(t),this.curentTabId===e&&!i.tab.isVisible()){var n=this.tabsOrderIds[0];e===n?this.close():this.openTab(n)}},n.prototype.openTab=function(e,t,i){i=i||{},t=t||{};var n=this.curentTabId===e;if(i.forceOpen||!n){"number"==typeof e&&(e=this.tabsOrderIds[e]);var o=this.tabsMap[e];if(!o)return console.error("openTab - invalid tab ID given: "+e);n||this.close(),o.tab.addClassNames("on"),this.toggleTabNotification(e,!1);var s=o.target;s&&(s.emit("open",t),s.show(),i.delayOpenedEvent||s.emit("opened",t)),this.curentTabId=e,this.emit("openTab",e)}},n.prototype.openFirstTab=function(){this.openTab(this.tabsOrderIds[0])},n.prototype.getTabsMap=function(){return this.tabsMap},n.prototype.getFirstTab=function(){return this.tabsMap[this.tabsOrderIds[0]]},n.prototype.getCurrentTabId=function(){return this.curentTabId},n.prototype.getCurrentTab=function(){return this.tabsMap[this.curentTabId]},n.prototype.getTabTarget=function(e){var t=this.tabsMap[e]||{};return t.target},n.prototype.close=function(){if(this.curentTabId||"number"==typeof this.curentTabId){var e=this.tabsMap[this.curentTabId];e.tab.delClassNames("on");var t=e.target;t&&(t.hide(),t.emit("close"))}this.curentTabId=null},n.prototype.setClosable=function(e){this.options.closable=e},n.prototype.toggleTabNotification=function(e,t){var i=this.tabsMap[e];i&&i.tab.toggleClassName("notification",t)},n.prototype.toggleTabAvailability=function(e,t){var i=this.tabsMap[e];if(i){var n=i.tab;void 0===t&&(t=!n._isDisable),n.setEnable(t)}},n.prototype.emitOnCurrentTab=function(e,t){t=t||{};var i=this.getCurrentTab();i&&i.target.emit(e,t)}},function(e,t){},function(e,t,i){function n(e){a.call(this,"div",{className:["waitingGauge","spinner"],hidden:!0}),e=e||{};var t=this.createChild("div",{className:"verticalCenterDiv"}),i=this.gauge=t.createChild("div",{className:"gauge"});this.progressCircle=i.appendChild(new s({size:e.size||r,thickness:e.thickness||l,color:e.color||c,bgColor:e.bgColor||d})),this.valueElement=i.createChild("div",{className:"value",text:""}),this.labelElt=t.createChild("div",{className:"label",text:""})}i(837);var o=i(172).inherits,s=i(553),a=i(321),r=70,l=7,c="#58b",d="#555";o(n,a),e.exports=n,n.prototype.setLabel=function(e){this.labelElt.setText(e)},n.prototype.showGauge=function(e,t,i){this.goal=e,i=i||1,e>i?(this.progressCircle.setValue(0,1),this.valueElement.setText("0%"),this.labelElt.setText(t?t:""),this.delClassNames("spinner"),this.gauge.show(),this.labelElt.show()):this.labelElt.hide(),this.show()},n.prototype.refreshGauge=function(e){if(this.gauge.isVisible()){var t=(this.goal-e)/this.goal;this.progressCircle.setValue(t,1),this.valueElement.setText(Math.round(100*t)+"%")}0===e&&this.hideGauge()},n.prototype.hideGauge=function(){this.goal=0,this.addClassNames("spinner"),this.gauge.hide(),this.hide()}},function(e,t){},function(e,t,i){function n(){v.call(this,{title:M("ui.common.caracteristics"),className:"characteristics",positionInfo:{left:40,top:"c",width:320,height:630}});var e=this;this.on("open",this.alignWithEquipment),this.infos=this.windowBody.createChild("div",{className:"infos"}),this.logoWrapper=this.infos.createChild("div",{className:"logoWrapper"}),this.logo=this.logoWrapper.appendChild(new E({className:"logo"},function(){T.open("grimoire",{tabId:"alignment"})})),this.playerName=this.infos.createChild("div",{className:"playerName"}),this.infosSup=this.infos.createChild("div",{className:"infosSup"}),this.stats=this.windowBody.createChild("div",{className:"stats"});var t=window.gui;t.on("CharacterStatsListMessage",function(t){window.gui.playerData.characterBreed&&e.updateStats(t.stats)}),g={maxLifePoints:M("ui.help.life"),actionPoints:M("ui.help.AP"),movementPoints:M("ui.help.MP"),initiative:M("ui.help.initiative"),prospecting:M("ui.help.prospecting"),range:M("ui.help.range"),summonableCreaturesBoost:M("ui.help.summonableCreatures"),vitality:M("ui.help.vitality"),wisdom:M("ui.help.wisdom"),strength:M("ui.help.strength"),intelligence:M("ui.help.intelligence"),chance:M("ui.help.chance"),agility:M("ui.help.agility"),level:M("ui.help.level"),red:M("ui.help.energy"),blue:M("ui.help.xp"),characteristics:M("ui.help.boostPoints")},window.gui.playerData.alignment.on("alignmentChanged",function(){var t=window.gui.playerData.characterBaseInformations,i=window.gui.playerData.alignment;i.getAlignmentImageUrl(function(t){e.logo.setStyle("backgroundImage",t)}),e.playerName.setText(t.name),window.gui.playerData.characterBreed&&e.infosSup.setText(window.gui.playerData.characterBreed.shortNameId+", "+M("ui.common.level")+" "+t.level),C(e.infosSup,g.level)})}function o(e){return e.createChild("div",{className:"panel"})}function s(e,t){return e.createChild("table",{className:t})}function a(e,t,i,n,o){var s=e.createChild("div",{className:"barWrapper"}),a=s.createChild("div",{className:"label",text:t}),r=s.appendChild(new b({className:i,value:n/o}));C(a,g[i]),C(r,n+" / "+o)}function r(e){return e||"-"}function l(e){return e.base+e.alignGiftBonus+e.objectsAndMountBonus+e.contextModif}function c(e,t,i){var n;C(t,function(){if(!n){var t=e[i],o=M("ui.common.base")+M("ui.common.colon")+r(t.base),s=M("ui.common.equipement")+M("ui.common.colon")+r(t.objectsAndMountBonus),a=M("ui.common.gifts")+"+"+M("ui.common.boost")+M("ui.common.colon");a+=r(t.alignGiftBonus+t.contextModif),n=new A("div",{className:"toolTipLabelBlock"}),n.createChild("div",{className:"toolTipLabel",text:o}),n.createChild("div",{className:"toolTipLabel",text:s}),n.createChild("div",{className:"toolTipLabel",text:a})}return n})}function d(e,t,i,n,o){var s=e.createChild("tr"),a=s.createChild("td",{className:["label",o],text:t});C(a,g[i]),s.createChild("td",{className:"value",text:r(n)})}function u(e,t,i){i=i||4;var n=e.createChild("tr");return n.createChild("td",{className:"tableTitle",text:t,attr:{colspan:i}}),n}function h(e,t,i,n){var o=r(i.base),s=r(i.alignGiftBonus+i.objectsAndMountBonus+i.contextModif),a=r(i.base+i.alignGiftBonus+i.objectsAndMountBonus+i.contextModif),l=e.createChild("tr");l.createChild("td",{className:["label",n],text:t}),l.createChild("td",{className:"base",text:o}),l.createChild("td",{className:"bonus",text:s}),l.createChild("td",{className:"total",text:a})}function p(e,t,i,n,o){var s=e.createChild("tr"),a=s.createChild("td",{className:["label",o],text:i});C(a,g[n]);var d=t[n],u=s.createChild("td",{className:"value",text:r(l(d))});c(t,u,n);var h=s.createChild("td",{className:"upgrade"}),p=h.createChild("div",{className:"upgradeButton"});w(p);var m="statsPointsFor"+n[0].toUpperCase()+n.substr(1),f=window.gui.playerData.characterBreed[m];p.on("tap",function(){S("PLUS_BUTTON"),T.open("characUpdate",{label:i,characteristicName:n,initialLevel:t[n].base,pointsRemaining:t.statsPoints,costSteps:f})});var _=I(f,d.base);t.statsPoints<_&&(p.disable(),p.addClassNames("disabled"))}function m(e,t,i){var n=e.createChild("tr");n.createChild("td",{className:["label","pointCapital"],text:t}),n.createChild("td",{className:["value","pointCapital"],text:i}),C(n,g.characteristics)}function f(e){var t=e.createChild("tr");t.createChild("td",{className:"label",text:M("ui.common.caracteristics")}),t.createChild("td",{className:"base",text:M("ui.common.base")}),t.createChild("td",{className:"bonus",text:M("ui.fightend.bonus")}),t.createChild("td",{className:"total",text:M("ui.common.total")})}i(839);var g,_=i(172).inherits,v=i(541),y=i(834),b=i(557),M=i(29).getText,w=i(197),T=i(194),C=i(337).addTooltip,A=i(321),I=i(840).getStatCost,S=i(247).playUiSound,E=i(335);_(n,v),e.exports=n,n.prototype.alignWithEquipment=function(){var e=T.getWindow("equipment");e.openState&&(this.setStyles({top:e.getStyle("top"),height:e.getStyle("height")}),T.arrangeOpeningWindow(this.id,{leftOf:e.id}))},n.prototype.updateStats=function(e){this.stats.clearContent(),this.tabs=new y,this.stats.appendChild(this.tabs),this.panels=this.stats.createChild("div",{className:"panels"}),this.panelSummary=o(this.panels),a(this.panelSummary,M("ui.common.energy"),"red",e.energyPoints,e.maxEnergyPoints),a(this.panelSummary,M("ui.common.experiment"),"blue",e.experience-e.experienceLevelFloor,e.experienceNextLevelFloor-e.experienceLevelFloor);var t=s(this.panelSummary,"summaryTable");d(t,M("ui.stats.lifePoints"),"maxLifePoints",e.lifePoints+" / "+e.maxLifePoints,"iconLifePoints"),d(t,M("ui.stats.shortAP"),"actionPoints",l(e.actionPoints),"iconActionPoints"),d(t,M("ui.stats.shortMP"),"movementPoints",l(e.movementPoints),"iconMovementPoints");var i=l(e.initiative),n=Math.floor(i*e.lifePoints/e.maxLifePoints);d(t,M("ui.stats.initiative"),"initiative",n+" / "+i,"iconInitiative"),d(t,M("ui.stats.prospecting"),"prospecting",l(e.prospecting),"iconProspecting"),d(t,M("ui.stats.range"),"range",l(e.range),"iconRange"),d(t,M("ui.stats.summonableCreatures"),"summonableCreaturesBoost",l(e.summonableCreaturesBoost),"iconSummon");var r=s(this.panelSummary,"characTable");u(r,M("ui.common.caracteristics"),3),p(r,e,M("ui.stats.vitality"),"vitality","iconVitality"),p(r,e,M("ui.stats.wisdom"),"wisdom","iconWisdom"),p(r,e,M("ui.stats.strength"),"strength","iconStrength"),p(r,e,M("ui.stats.intelligence"),"intelligence","iconIntelligence"),p(r,e,M("ui.stats.chance"),"chance","iconChance"),p(r,e,M("ui.stats.agility"),"agility","iconAgility"),m(r,M("ui.stats.statPoints"),e.statsPoints),this.panelAdvanced=o(this.panels);var c=s(this.panelAdvanced,"advancedTable");f(c),u(c,M("ui.charaSheet.primaryStats")),h(c,M("ui.stats.vitality"),e.vitality,"iconVitality"),h(c,M("ui.stats.wisdom"),e.wisdom,"iconWisdom"),h(c,M("ui.stats.strength"),e.strength,"iconStrength"),h(c,M("ui.stats.intelligence"),e.intelligence,"iconIntelligence"),h(c,M("ui.stats.chance"),e.chance,"iconChance"),h(c,M("ui.stats.agility"),e.agility,"iconAgility"),h(c,M("ui.stats.shortAP"),e.actionPoints,"iconActionPoints"),h(c,M("ui.stats.shortMP"),e.movementPoints,"iconMovementPoints"),h(c,M("ui.stats.initiative"),e.initiative,"iconInitiative"),h(c,M("ui.stats.prospecting"),e.prospecting,"iconProspecting"),h(c,M("ui.stats.range"),e.range,"iconRange"),h(c,M("ui.stats.summonableCreatures"),e.summonableCreaturesBoost,"iconSummon"),u(c,M("ui.charaSheet.secondaryStats")),h(c,M("ui.stats.PAAttack"),e.PAAttack,"iconAttackAP"),h(c,M("ui.stats.dodgeAP"),e.dodgePALostProbability,"iconDodgeAP"),h(c,M("ui.stats.PMAttack"),e.PMAttack,"iconAttackMP"),h(c,M("ui.stats.dodgeMP"),e.dodgePMLostProbability,"iconDodgeMP"),h(c,M("ui.stats.criticalHit"),e.criticalHit,"iconCriticalHit"),h(c,M("ui.stats.healBonus"),e.healBonus,"iconHeal"),h(c,M("ui.stats.takleBlock"),e.tackleBlock,"iconTackle"),h(c,M("ui.stats.takleEvade"),e.tackleEvade,"iconEvade"),u(c,M("ui.stats.damagesBonus")),h(c,M("ui.stats.damagesBonus"),e.allDamagesBonus,"iconDamage"),h(c,M("ui.stats.damagesBonusPercent"),e.damagesBonusPercent,"iconDamagePercent"),h(c,M("ui.stats.criticalDamageBonus"),e.criticalDamageBonus,"iconCriticalDamage"),h(c,M("ui.stats.neutralDamageBonus"),e.neutralDamageBonus,"iconYinyang"),h(c,M("ui.stats.earthDamageBonus"),e.earthDamageBonus,"iconStrength"),h(c,M("ui.stats.fireDamageBonus"),e.fireDamageBonus,"iconIntelligence"),h(c,M("ui.stats.waterDamageBonus"),e.waterDamageBonus,"iconChance"),h(c,M("ui.stats.airDamageBonus"),e.airDamageBonus,"iconAgility"),h(c,M("ui.stats.return"),e.reflect,"iconReturn"),h(c,M("ui.stats.weaponDamagesPercent"),e.weaponDamagesBonusPercent,"iconWeaponDamage"),h(c,M("ui.stats.trapBonus"),e.trapBonus,"iconTrap"),h(c,M("ui.stats.trapBonusPercent"),e.trapBonusPercent,"iconTrapPercent"),h(c,M("ui.stats.pushDamageBonus"),e.pushDamageBonus,"iconPushDamage"),u(c,M("ui.common.resistances")),h(c,M("ui.stats.neutralReduction"),e.neutralElementReduction,"iconYinyang"),h(c,M("ui.stats.neutralReductionPercent"),e.neutralElementResistPercent,"iconYinyang"),h(c,M("ui.stats.earthReduction"),e.earthElementReduction,"iconStrength"),h(c,M("ui.stats.earthReductionPercent"),e.earthElementResistPercent,"iconStrength"),h(c,M("ui.stats.fireReduction"),e.fireElementReduction,"iconIntelligence"),h(c,M("ui.stats.fireReductionPercent"),e.fireElementResistPercent,"iconIntelligence"),h(c,M("ui.stats.waterReduction"),e.waterElementReduction,"iconChance"),h(c,M("ui.stats.waterReductionPercent"),e.waterElementResistPercent,"iconChance"),h(c,M("ui.stats.airReduction"),e.airElementReduction,"iconAgility"),h(c,M("ui.stats.airReductionPercent"),e.airElementResistPercent,"iconAgility"),h(c,M("ui.stats.criticalDamageReduction"),e.criticalDamageReduction,"iconCriticalReduction"),h(c,M("ui.stats.pushDamageReduction"),e.pushDamageReduction,"iconPushDamageReduction"),u(c,M("ui.common.resistancesPvp")),h(c,M("ui.stats.neutralReduction"),e.pvpNeutralElementReduction,"iconYinyang"),h(c,M("ui.stats.neutralReductionPercent"),e.pvpNeutralElementResistPercent,"iconYinyang"),h(c,M("ui.stats.earthReduction"),e.pvpEarthElementReduction,"iconStrength"),h(c,M("ui.stats.earthReductionPercent"),e.pvpEarthElementResistPercent,"iconStrength"),h(c,M("ui.stats.fireReduction"),e.pvpFireElementReduction,"iconIntelligence"),h(c,M("ui.stats.fireReductionPercent"),e.pvpFireElementResistPercent,"iconIntelligence"),h(c,M("ui.stats.waterReduction"),e.pvpWaterElementReduction,"iconChance"),h(c,M("ui.stats.waterReductionPercent"),e.pvpWaterElementResistPercent,"iconChance"),h(c,M("ui.stats.airReduction"),e.pvpAirElementReduction,"iconAgility"),h(c,M("ui.stats.airReductionPercent"),e.pvpAirElementResistPercent,"iconAgility"),this.tabs.addTab(M("ui.stats.summary"),this.panelSummary),this.tabs.addTab(M("ui.stats.advanced"),this.panelAdvanced),this.tabs.openTab(0)}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"characUpdateWindow",title:"Characteristic Update",positionInfo:{top:"c",left:"c",width:410,height:300}}),this.on("open",function(e){var t=l.getWindow("characteristics");t.openState&&(l.arrangeOpeningWindow(this.id,{rightOf:t.id}),this.updateContent(e))}),this.on("close",function(){u.hide()}),this.closeButton.on("tap",function(){d("CANCEL_BUTTON")})}i(841);var o=i(172).inherits,s=i(541),a=i(335),r=i(649),l=i(194),c=i(29).getText,d=i(247).playUiSound,u=i(435),h=i(340),p={vitality:11,wisdom:12,strength:10,intelligence:15,chance:13,agility:14},m=0,f=1;o(n,s),e.exports=n,n.prototype.updateContent=function(e){var t=this;this.pointsRemaining=e.pointsRemaining,this.initialLevel=e.initialLevel,this.characteristicName=e.characteristicName,this.costSteps=e.costSteps,this.pointsSpent=this.addedLevel=0,this.findCurrentCostStep(),this.windowTitle.setText(e.label),this.windowBody.clearContent();var i=this.windowBody.createChild("div",{className:"points"});i.createChild("span",{text:c("ui.charaSheet.boostPoints")+c("ui.common.colon")}),this.pointsRemainingElt=i.createChild("span",{className:"pointsRemaining",text:this.pointsRemaining}),this.container=this.windowBody.createChild("div",{className:"containerBlock"});var n=this.container.createChild("div",{className:"additionBlock"});n.appendChild(new a({className:"minusButton",repeatDelay:50,scaleOnPress:!0},function(){t.updatePoints(-1)&&t.displayValues()})),this.pointsLineAdded=new h({className:"pointsInput",minValue:0,maxValue:this.pointsRemaining}),this.pointsLineAdded.on("change",function(e){t.updatePointsUntil(e)}),n.appendChild(this.pointsLineAdded),n.appendChild(new a({className:"plusButton",repeatDelay:50,scaleOnPress:!0},function(){t.updatePoints(1)&&t.displayValues()}));var o=n.createChild("div",{className:"additionLine"});o.createChild("span",{text:"+ "}),this.levelAddedElt=o.createChild("span",{text:0}),o.createChild("span",{text:" "+e.label});var s=n.createChild("div",{className:"totalLine"});this.finalLevelElt=s.createChild("span",{text:this.initialLevel}),s.createChild("span",{text:" "+e.label}),this.createCostLevelTable(),this.container.appendChild(new a({text:c("ui.common.validation"),className:"button"},function(){if(t.pointsSpent<=0)return d("GEN_BUTTON");d("OK_BUTTON");var e=p[t.characteristicName];window.dofus.sendMessage("StatsUpgradeRequestMessage",{statId:e,boostPoint:t.pointsSpent}),l.close(t.id)})),this.displayValues()},n.prototype.createCostLevelTable=function(){for(var e=["title"],t=["Level"],i=["Cost"],n=this.costSteps,o=0;o<n.length;o++)e.push("l"+o),t.push("> "+n[o][m]),i.push(n[o][f]);this.table=this.container.appendChild(new r({colIds:e,colCount:n.length,headerContent:t})),this.costRow=this.table.addRow(i)},n.prototype.displayValues=function(){if(this.pointsRemainingElt.setText(this.pointsRemaining-this.pointsSpent),this.pointsLineAdded.setValue(this.pointsSpent),this.levelAddedElt.setText(this.addedLevel),this.finalLevelElt.setText(this.initialLevel+this.addedLevel),this.currentCostStep!==this.previousCostStep){if(void 0!==this.previousCostStep){var e=this.table.getHeaderCol("l"+this.previousCostStep),t=this.table.getCol(0,"l"+this.previousCostStep);e.delClassNames("selected"),t.delClassNames("selected")}this.previousCostStep=this.currentCostStep;var i=this.table.getHeaderCol("l"+this.currentCostStep),n=this.table.getCol(0,"l"+this.currentCostStep);i.addClassNames("selected"),n.addClassNames("selected")}},n.prototype.findCurrentCostStep=function(){var e=this.costSteps;this.previousCostStep=void 0,this.currentCostStep=0;for(var t=0;t<e.length;t++)this.initialLevel>=e[t][m]&&(this.currentCostStep=t)},n.prototype.updatePointsUntil=function(e){if(e-this.pointsSpent>0)for(;this.pointsSpent<e;){var t=this.costSteps[this.currentCostStep][f];if(this.pointsSpent+t>e)break;if(!this.updatePoints(1))break}else for(;this.pointsSpent>e&&this.updatePoints(-1););this.displayValues()},n.prototype.updatePoints=function(e){var t=this.costSteps[this.currentCostStep],i=t[f];if(e>0){if(this.pointsSpent+i>this.pointsRemaining)return!1;this.pointsSpent+=i,t.length>2?this.addedLevel+=t[2]:this.addedLevel++;var n=this.costSteps[this.currentCostStep+1];n&&this.initialLevel+this.addedLevel>=n[m]&&this.currentCostStep++}else{if(!this.pointsSpent)return!1;this.initialLevel+this.addedLevel<=t[m]&&(this.currentCostStep--,t=this.costSteps[this.currentCostStep],i=t[f]),this.pointsSpent-=i,t.length>2?this.addedLevel-=t[2]:this.addedLevel--}return!0},e.exports.getStatCost=function(e,t){for(var i=0,n=e.length-1;n>=0;n--)if(t>=e[n][m])return e[n][f];return i}},function(e,t){},function(e,t,i){function n(){function e(e){c.close("deleteCharacterConfirm");var t=e.data;n.setText(t.name),o.setText(d("ui.common.level")+" "+t.level),r.selectedCharacter=t,r.characterDisplay.setLook(t.entityLook,{boneType:"characters/",skinType:"characters/"}),r.xpSticker.setClassNames(["xpSticker","x"+t.bonusXp])}function t(){var e=M.playerData.identification.secretQuestion,t=r.selectedCharacter.level,i=r.selectedCharacter.id,n=r.selectedCharacter.name;t>=y&&e?c.open("deleteCharacterConfirm",{id:i,name:n,secretQuestion:e}):M.openConfirmPopup({title:d("ui.popup.warning"),message:d("ui.popup.warnBeforeDelete",n),cb:function(e){if(e){var t=u(i+"~000000000000000000");window.dofus.sendMessage("CharacterDeletionRequestMessage",{characterId:i,secretAnswerHash:t})}}})}function i(e){var t="default",i={TooManyDeletion:d("ui.charSel.deletionErrorTooManyDeletion"),WrongAnswer:d("ui.charSel.deletionErrorWrongAnswer"),UnsecureMode:d("ui.charSel.deletionErrorUnsecureMode"),"default":d("ui.charSel.deletionError")};e.reason===_.DEL_ERR_TOO_MANY_CHAR_DELETION?t="TooManyDeletion":e.reason===_.DEL_ERR_BAD_SECRET_ANSWER?t="WrongAnswer":e.reason===_.DEL_ERR_RESTRICED_ZONE&&(t="UnsecureMode"),M.openSimplePopup(i[t])}l.call(this,{className:"CharacterSelectionWindow",title:d("ui.charsel.title"),positionInfo:{left:"c",top:"c",width:650,height:520,isFullScreen:!0}});var n,o,r=this,v=7,y=20,b=this.windowBody,M=window.gui;this.selectedCharacter=null;var w=this.leftColumn=b.createChild("div",{className:"leftColumn"});this.charactersTable=w.appendChild(new m({className:"characterTable",minRows:v,highlightable:!0,colIds:["name","bonusXp"],headerContent:[""],onRowTap:function(t){t.data&&e(t)}}));var T=w.createChild("div",{className:"buttonsDiv"});this.btnCreate=T.appendChild(new h({text:d("ui.charsel.createCharacter"),className:["newCharacterBtn","button"],sound:"OK_BUTTON"},function(){c.close("deleteCharacterConfirm"),c.close(r.id),c.open("characterCreation")})),T.createChild("div",{className:"xpBubble"});var C=T.appendChild(new h({text:d("ui.charsel.changeServer"),className:["changeServerBtn","button"],sound:"CANCEL_BUTTON"},function(){c.close(r.id),f.goBackToSelectionOf("server")})),A=b.createChild("div",{className:"centerPanel"}),I=A.createChild("div",{className:["line","nameLine"]}),S=I.createChild("div",{className:"nameDiv"});n=S.createChild("div",{className:"name"}),this.btnDelete=S.appendChild(new h({className:"delCharacterBtn",text:"X"},t));var E=A.createChild("div",{className:["line","levelLine"]});o=E.createChild("div",{className:"level"});var x=A.appendChild(new g({scale:2.3}));this.characterDisplay=x;var N=x.createChild("div",{className:"leftButton"});p(N,{repeatDelay:100}),N.on("tap",function(){x.rotateCharacter(!1)});var L=x.createChild("div",{className:"rightButton"});p(L,{repeatDelay:100}),L.on("tap",function(){x.rotateCharacter(!0)}),this.xpSticker=x.createChild("div",{className:"xpSticker"}),s(this.xpSticker,d("ui.information.xpFamilyBonus"));var O=this.btnPlay=A.appendChild(new h({text:d("ui.common.play"),className:["btnPlay","button"],sound:"PLAY_BUTTON"},function(){this.disable(),a.selectCharacter(r.selectedCharacter.id)}));this.closeButton.on("tap",function(){C.emit("tap")}),this._consoleButton=b.appendChild(new h({className:["consoleButton"],hidden:!0},function(){c["switch"]("adminConsole")})),this.on("open",function(e){return e=e.length?e:null,r._consoleButton.toggleDisplay(window.gui.playerData.isModeratorOrMore()),this.charactersList=e||this.charactersList,this.charactersList?(r.updateCharacterList(this.charactersList),void O.enable()):console.error("CharacterSelectionWindow opened without character list info")}),this.on("close",function(){c.close("deleteCharacterConfirm"),x.release()}),M.on("CharacterDeletionErrorMessage",this.localizeEvent(i))}function o(e){for(var t=1,i=0,n=e.length;i<n;i++){for(var o=1,s=0;s<n;s++)e[s].id!==e[i].id&&e[s].level>e[i].level&&o<4&&o++;e[i].bonusXp=o,e[i].level>1&&t++}return Math.min(t,4)}i(843);var s=i(337).addTooltip,a=i(601),r=i(172).inherits,l=i(541),c=i(194),d=i(29).getText,u=i(844),h=i(335),p=i(197),m=i(649),f=i(204),g=i(369),_=i(848);r(n,l),e.exports=n,n.prototype.updateCharacterList=function(e){var t=o(e);this.leftColumn.setClassNames(["leftColumn","x"+t+"Bubble"]),this.charactersTable.clearContent();var i=this.charactersTable.header.getChildren()[0].getChild("name");i.setHtml(d("ui.connection.listCharacterLabel",e.length));for(var n=window.gui.databases.Breeds,s=0;s<e.length;s++){var a=e[s],r=a.breed||0,l=a.name+" ("+n[r].shortNameId+" "+a.level+")",c=this.charactersTable.addRow({name:l},{data:a}),u=a.bonusXp;u>1&&c.getChildren()[1].addClassNames(["x"+u])}}},function(e,t){},function(e,t,i){!function(){var t=i(845),n=i(846).utf8,o=i(847),s=i(846).bin,a=function(e,i){e.constructor==String?e=i&&"binary"===i.encoding?s.stringToBytes(e):n.stringToBytes(e):o(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var r=t.bytesToWords(e),l=8*e.length,c=1732584193,d=-271733879,u=-1732584194,h=271733878,p=0;p<r.length;p++)r[p]=16711935&(r[p]<<8|r[p]>>>24)|4278255360&(r[p]<<24|r[p]>>>8);r[l>>>5]|=128<<l%32,r[(l+64>>>9<<4)+14]=l;for(var m=a._ff,f=a._gg,g=a._hh,_=a._ii,p=0;p<r.length;p+=16){var v=c,y=d,b=u,M=h;c=m(c,d,u,h,r[p+0],7,-680876936),h=m(h,c,d,u,r[p+1],12,-389564586),u=m(u,h,c,d,r[p+2],17,606105819),d=m(d,u,h,c,r[p+3],22,-1044525330),c=m(c,d,u,h,r[p+4],7,-176418897),h=m(h,c,d,u,r[p+5],12,1200080426),u=m(u,h,c,d,r[p+6],17,-1473231341),d=m(d,u,h,c,r[p+7],22,-45705983),c=m(c,d,u,h,r[p+8],7,1770035416),h=m(h,c,d,u,r[p+9],12,-1958414417),u=m(u,h,c,d,r[p+10],17,-42063),d=m(d,u,h,c,r[p+11],22,-1990404162),c=m(c,d,u,h,r[p+12],7,1804603682),h=m(h,c,d,u,r[p+13],12,-40341101),u=m(u,h,c,d,r[p+14],17,-1502002290),d=m(d,u,h,c,r[p+15],22,1236535329),c=f(c,d,u,h,r[p+1],5,-165796510),h=f(h,c,d,u,r[p+6],9,-1069501632),u=f(u,h,c,d,r[p+11],14,643717713),d=f(d,u,h,c,r[p+0],20,-373897302),c=f(c,d,u,h,r[p+5],5,-701558691),h=f(h,c,d,u,r[p+10],9,38016083),u=f(u,h,c,d,r[p+15],14,-660478335),d=f(d,u,h,c,r[p+4],20,-405537848),c=f(c,d,u,h,r[p+9],5,568446438),h=f(h,c,d,u,r[p+14],9,-1019803690),u=f(u,h,c,d,r[p+3],14,-187363961),d=f(d,u,h,c,r[p+8],20,1163531501),c=f(c,d,u,h,r[p+13],5,-1444681467),h=f(h,c,d,u,r[p+2],9,-51403784),u=f(u,h,c,d,r[p+7],14,1735328473),d=f(d,u,h,c,r[p+12],20,-1926607734),c=g(c,d,u,h,r[p+5],4,-378558),h=g(h,c,d,u,r[p+8],11,-2022574463),u=g(u,h,c,d,r[p+11],16,1839030562),d=g(d,u,h,c,r[p+14],23,-35309556),c=g(c,d,u,h,r[p+1],4,-1530992060),h=g(h,c,d,u,r[p+4],11,1272893353),u=g(u,h,c,d,r[p+7],16,-155497632),d=g(d,u,h,c,r[p+10],23,-1094730640),c=g(c,d,u,h,r[p+13],4,681279174),h=g(h,c,d,u,r[p+0],11,-358537222),u=g(u,h,c,d,r[p+3],16,-722521979),d=g(d,u,h,c,r[p+6],23,76029189),c=g(c,d,u,h,r[p+9],4,-640364487),h=g(h,c,d,u,r[p+12],11,-421815835),u=g(u,h,c,d,r[p+15],16,530742520),d=g(d,u,h,c,r[p+2],23,-995338651),c=_(c,d,u,h,r[p+0],6,-198630844),h=_(h,c,d,u,r[p+7],10,1126891415),u=_(u,h,c,d,r[p+14],15,-1416354905),d=_(d,u,h,c,r[p+5],21,-57434055),c=_(c,d,u,h,r[p+12],6,1700485571),h=_(h,c,d,u,r[p+3],10,-1894986606),u=_(u,h,c,d,r[p+10],15,-1051523),d=_(d,u,h,c,r[p+1],21,-2054922799),c=_(c,d,u,h,r[p+8],6,1873313359),h=_(h,c,d,u,r[p+15],10,-30611744),u=_(u,h,c,d,r[p+6],15,-1560198380),d=_(d,u,h,c,r[p+13],21,1309151649),c=_(c,d,u,h,r[p+4],6,-145523070),h=_(h,c,d,u,r[p+11],10,-1120210379),u=_(u,h,c,d,r[p+2],15,718787259),d=_(d,u,h,c,r[p+9],21,-343485551),c=c+v>>>0,d=d+y>>>0,u=u+b>>>0,h=h+M>>>0}return t.endian([c,d,u,h])};a._ff=function(e,t,i,n,o,s,a){var r=e+(t&i|~t&n)+(o>>>0)+a;return(r<<s|r>>>32-s)+t},a._gg=function(e,t,i,n,o,s,a){var r=e+(t&n|i&~n)+(o>>>0)+a;return(r<<s|r>>>32-s)+t},a._hh=function(e,t,i,n,o,s,a){var r=e+(t^i^n)+(o>>>0)+a;return(r<<s|r>>>32-s)+t},a._ii=function(e,t,i,n,o,s,a){var r=e+(i^(t|~n))+(o>>>0)+a;return(r<<s|r>>>32-s)+t},a._blocksize=16,a._digestsize=16,e.exports=function(e,i){if("undefined"!=typeof e){var n=t.wordsToBytes(a(e,i));return i&&i.asBytes?n:i&&i.asString?s.bytesToString(n):t.bytesToHex(n)}}}()},function(e,t){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&i.rotl(e,8)|4278255360&i.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=i.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],i=0,n=0;i<e.length;i++,n+=8)t[n>>>5]|=e[i]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],i=0;i<32*e.length;i+=8)t.push(e[i>>>5]>>>24-i%32&255);return t},bytesToHex:function(e){for(var t=[],i=0;i<e.length;i++)t.push((e[i]>>>4).toString(16)),t.push((15&e[i]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],i=0;i<e.length;i+=2)t.push(parseInt(e.substr(i,2),16));return t},bytesToBase64:function(e){for(var i=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],s=0;s<4;s++)8*n+6*s<=8*e.length?i.push(t.charAt(o>>>6*(3-s)&63)):i.push("=");return i.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var i=[],n=0,o=0;n<e.length;o=++n%4)0!=o&&i.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|t.indexOf(e.charAt(n))>>>6-2*o);return i}};e.exports=i}()},function(e,t){var i={utf8:{stringToBytes:function(e){return i.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(i.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],i=0;i<e.length;i++)t.push(255&e.charCodeAt(i));return t},bytesToString:function(e){for(var t=[],i=0;i<e.length;i++)t.push(String.fromCharCode(e[i]));return t.join("")}}};e.exports=i},function(e,t){e.exports=function(e){return!(null==e||!e.constructor||"function"!=typeof e.constructor.isBuffer||!e.constructor.isBuffer(e))}},function(e,t){e.exports={DEL_ERR_NO_REASON:1,DEL_ERR_TOO_MANY_CHAR_DELETION:2,DEL_ERR_BAD_SECRET_ANSWER:3,DEL_ERR_RESTRICED_ZONE:4}},function(e,t,i){function n(){s.call(this,{className:"GiftSelectionWindow",title:a("ui.connection.giftReceived"),noCloseButton:!0,positionInfo:{left:"c",top:"c",width:800,height:520}});var e=this;this._giftList=[],this._giftListIndex=0,this._hasDom=!1,this._itemSpace=null,this._charactersSpace=null,this._selectedCharaId=null,this.on("open",function(t){e._characterList=window.gui.gifts.getCharaListMinusDeadPeople(),e._giftList=t||[],e._createDom(),e._setupEvents(),e._updateCharactersSpace(),e._updateGift()}),this.on("open",function(){window.foreground.lock("giftAttribution")}),this.on("close",function(){window.foreground.unlock("giftAttribution"),e._reset()})}i(850);var o=i(172).inherits,s=i(541),a=i(29).getText,r=i(851),l=i(857),c=i(335).DofusButton,d=i(196);o(n,s),e.exports=n,n.prototype._reset=function(){this._charactersSpace&&this._charactersSpace.reset(),this.windowBody.clearContent(),this._hasDom=!1,this._giftListIndex=0,this._giftList=[],this._itemSpace=null,this._charactersSpace=null,this._selectedCharaId=null},n.prototype._setupEvents=function(){var e=this;window.gui.gifts.on("giftAssignRequestResult",function(t){if(e.openState){var i=e._giftList[e._giftListIndex];i&&t.actionId===i.uid&&(e._charactersSpace.setAssignLoading(!1),e._nextGift())}})},n.prototype._createDom=function(){var e=this;if(!this._hasDom){var t=this.windowBody,i=t.createChild("div",{className:"left"});this._itemSpace=i.appendChild(new r);var n=t.createChild("div",{className:"right"});this._charactersSpace=n.appendChild(new l),this._charactersSpace.on("selectTile",function(t){e._selectedCharaId=t});var o=t.createChild("div",{className:"buttonSpace"});o.appendChild(new c(a("ui.connection.notNow"),{scaleOnPress:!0,className:"buttonSpaceButton"},function(){e._nextGift()})),this._assignBtn=o.appendChild(new c(a("ui.connection.assignGift"),{scaleOnPress:!0,className:"buttonSpaceButton"},function(){e._charactersSpace.setAssignLoading(!0),e._assignGift()})),this._hasDom=!0}},n.prototype._nextGift=function(){var e=this,t=this._giftListIndex+1>=this._giftList.length;if(t)return this.close();this._giftListIndex+=1;var i=this.position.x,n=this.position.y;d.tween(this,{opacity:0,webkitTransform:"translate3d("+i+"px,"+n+"px,0) scale(0.8)"},{time:150,delay:0,easing:"ease-out"},function(){d.tween(e,{opacity:1,webkitTransform:"translate3d("+i+"px,"+n+"px,0)  scale(1)"},{time:150,delay:0,easing:"ease-out"},function(){e._updateGift()})})},n.prototype._assignGift=function(){if(this._selectedCharaId){var e=this._giftList[this._giftListIndex];e&&window.gui.gifts.assignGift(e.uid,this._selectedCharaId);
}},n.prototype._updateGift=function(){var e=this._giftList[this._giftListIndex]||{};this._itemSpace.update(e)},n.prototype._updateCharactersSpace=function(){this._charactersSpace.update(this._characterList)}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"ItemSpace"});var e=this,t=this.createChild("div",{className:"topContainer"}),i=t.createChild("div",{className:"top"});this._title=i.createChild("div",{className:"title"}),this._description=i.createChild("div",{className:"description"}),i.createChild("div",{className:"contentText",text:l("ui.connection.contents")}),this._rewardBoxes=i.appendChild(new r({nbRewards:8})),this._itemBox=this.appendChild(new a({showTitle:!0})),this._rewardBoxes.on("tapSlot",function(t){e._updateItemBox(t)})}i(852);var o=i(172).inherits,s=i(321),a=i(853),r=i(855),l=i(29).getText;o(n,s),e.exports=n,n.prototype.update=function(e){e=e||{},this._title.setText(e.title);var t=e.text;"null"===t.trim().toLowerCase()&&(t=""),this._description.setText(t);var i=e.items||[],n=i[0];n?this._updateItemBox(n):this._itemBox.hide(),this._rewardBoxes.reset();for(var o=0,s=i.length;o<s;o+=1){var a=i[o];this._rewardBoxes.addItemInstance(a)}},n.prototype._updateItemBox=function(e){this._itemBox.displayItem(e),this._itemBox.show()}},function(e,t){},function(e,t,i){function n(){window.gui.openContextualMenuAround("item",this,{item:this.myWindow.itemInstance||this.myWindow.item,enableActions:!0,enableSet:!1,enableRecipe:!1,enableInsertRecipe:!0,enableSell:!1,enableDestroy:!1})}function o(){g.openBidHouse(!1,null,this.myWindow.itemId)}function s(){g.openBidHouse(!0,null,this.myWindow.itemInstance)}function a(){R.open("itemRecipes",{itemData:this.myWindow.item})}function r(){var e=this.myWindow,t=e.itemInstance;return 1===t.quantity?void window.gui.playerData.inventory.confirmDestroyItem(t,1):void e._minMaxSelector.openAround(this,{min:1,max:t.quantity})}function l(){R.open("itemSets",this.myWindow.itemInstance)}function c(e){D.call(this,"div",{className:"ItemBox"}),this.itemInstance=null,this.item=null;var t=this;e=e||{},this.showTitle=!!e.showTitle,this.showItemActions=!!e.hasOwnProperty("showItemActions")&&e.showItemActions,this.showDescription=!!e.hasOwnProperty("showDescription")&&e.showDescription;var i=this._itemTitle=this.createChild("div",{className:"itemBox-title"});this._name=i.createChild("div",{className:"itemBox-name"}),this._level=i.createChild("div",{className:"itemBox-level"});var c=this.createChild("div",{className:"infoContainer"}),d=c.createChild("div",{className:"topLeftInfoContainer"});this.weight=d.createChild("div",{className:"weight"}),this.twoHandedIcon=d.createChild("div",{className:"twoHandedIcon"}),m(this.twoHandedIcon,b("ui.common.twoHandsWeapon"));var u=d.createChild("div",{className:"itemContainer"});this.image=u.createChild("div",{className:"itemImage"}),this.durabilityBar=u.appendChild(new I({className:["durabilityBar","red"]})),this.durabilityBarDescription=new D("div"),m(this.durabilityBar,this.durabilityBarDescription),this.tooltipItemDescription=new M,m(this.image,this.tooltipItemDescription),B(this.image),this.image.on("tap",function(){t.item&&window.gui.openContextualMenuAround("item",this,{item:t.item.getItemInstance()||t.item.getItem(),enableCertificate:!0})});var h=[{title:b("ui.common.effects",2),name:"effects"},{title:b("ui.common.conditions"),name:"conditions"},{title:b("ui.common.short.caracteristic"),name:"characteristics"}];this.panelCollection={},this.topRightInfoContainer=c.createChild("div",{className:"topRightInfoContainer"}),this.itemInfoTabs=new x,this.topRightInfoContainer.appendChild(this.itemInfoTabs),this.itemInfoPanels=this.topRightInfoContainer.createChild("div",{className:"itemInfoPanels"});for(var p={colIds:["info"],minRows:isNaN(e.minRows)?F:e.minRows},f=0,g=h.length;f<g;f+=1){var _=h[f];this.panelCollection[_.name]=this.itemInfoPanels.appendChild(new E(p)),this.itemInfoTabs.addTab(_.title,this.panelCollection[_.name])}var v=this.itemActionContainer=this.createChild("div",{className:"actionContainer"}),y=this.actionBtn=v.appendChild(new N({text:b("tablet.itemAction"),className:"actionButton"},n));y.myWindow=this,y=this.bidHouseSellBtn=v.appendChild(new N({className:["bidHouseSellButton","greenButton"],addIcon:!0,tooltip:b("tablet.itemSellInBidHouse")},s)),y.myWindow=this,y=this.setButton=v.appendChild(new N({className:"setButton",tooltip:b("ui.common.set")},l)),y.myWindow=this;var w=e.withCraftBtn?this.image:v;y=this.recipeButton=w.appendChild(new N({className:"recipeButton",tooltip:b("ui.craft.associateReceipts")},a)),y.myWindow=this,e.withBidHouseBtn&&(y=this.image.appendChild(new N({className:["bidHouseButton","greenButton"],addIcon:!0,tooltip:b("tablet.itemSearchInBidHouse")},o)),y.myWindow=this);var T=this._minMaxSelector=window.gui.windowsContainer.appendChild(new P);T.on("confirm",function(e){window.gui.playerData.inventory.confirmDestroyItem(t.itemInstance,e)}),y=this.destroyButton=v.appendChild(new N({className:"destroyButton",tooltip:b("ui.common.destroyThisItem")},r)),y.myWindow=this,this.itemDescriptionContainer=this.appendChild(new O({className:"itemDescriptionContainer"})),this.categoryText=this.itemDescriptionContainer.content.createChild("div",{className:"category"}),this.descriptionText=this.itemDescriptionContainer.content.createChild("div",{className:"description"}),this.itemInfoTabs.openTab(0),window.gui.playerData.inventory.on("itemModified",function(e){t.itemInstance&&t.itemInstance.objectUID===e.objectUID&&t.displayItem(e)})}function d(e,t){if(t)for(var i=v.exoticEffects,n=0;n<t.length;n+=1){var o=t[n],s=o.effect;if(s.id!==k){var a=o.description,r=o.monsterCount;r&&(a+=r);var l=e.addRow([a]);i[s.id]?l.addClassNames("exotic"):s.bonusType===-1?l.addClassNames("malus"):1===s.bonusType&&l.addClassNames("bonus")}}}function u(e,t,i){var n=i.addRow([e]);t&&n.addClassNames("malus")}function h(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=n.text;if("string"==typeof o)u(o,n.isMalus,t);else for(var s=0;s<o.length;s++){var a=o[s];u(a,n.isMalus,t)}}}function p(e,t){for(var i=0;i<e.length;i++)t.addRow([e[i]])}i(854);var m=i(337).addTooltip,f=i(182),g=i(448),_=i(355),v=i(538),y=i(337).enableTooltip,b=i(29).getText,M=i(534),w=i(461),T=w.Item,C=w.ItemInstance,A=i(548),I=i(557),S=i(30),E=i(649),x=i(834),N=i(335),L=i(172),O=i(436),D=i(321),R=i(194),P=i(332),B=i(197),k=A.EFFECT_MOUNT,z=812,F=5;L.inherits(c,D),c.prototype._toggleItemActions=function(e){if(this.showItemActions){var t=!(!e||!e.isItemInstance);this.actionBtn.setEnable(t),this.bidHouseSellBtn.setEnable(!!e),e&&e.getProperty("itemSetId")!==-1?this.setButton.enable():this.setButton.disable(),this.recipeButton.setEnable(!!e),this.destroyButton.setEnable(t)}else this.itemActionContainer.hide()},c.prototype._canDisplayDescription=function(){return this.showDescription&&("auto"!==this.showDescription||this.itemDescriptionContainer.rootElement.clientHeight>30)},c.prototype.displayMount=function(e,t){t=t||{},this.item=null,this.itemInstance=null,this.showTitle=t.hasOwnProperty("showTitle")?t.showTitle:this.showTitle,this.showDescription=t.hasOwnProperty("showDescription")?t.showDescription:this.showDescription,this.weight.setText(b("ui.common.short.weight",0)),this.twoHandedIcon.hide(),this.durabilityBar.hide();var i=this;if(f.preloadImage("gfx/mounts/"+e.model+".png",function(e){i.image.setStyle("backgroundImage",e)}),y(this.image,!1),this._toggleItemActions(),this._canDisplayDescription()){this.categoryText.setText(b("ui.common.category")+b("ui.common.colon")+b("ui.common.ride"));var n=b("ui.mount.description",e.name,e.level,e.xpRatio);this.descriptionText.setText(n),this.itemDescriptionContainer.show(),this.itemDescriptionContainer.refresh()}else this.itemDescriptionContainer.hide();this._itemTitle.toggleDisplay(!!this.showTitle),this.showTitle&&(S.getData("Mounts",e.model,function(e,t){return e?console.error(e):void i._name.setText(t.nameId)}),this._level.setText(b("ui.common.short.level")+" "+e.level));for(var o in this.panelCollection)this.panelCollection[o].clearContent();this.itemInfoTabs.toggleTabDisplay(2,!1),_.createEffectInstances(e.effectList,function(e,t){if(e)return console.error(e);var n=v.sortEffects(t);d(i.panelCollection.effects,n)})},c.prototype.displayItem=function(e,t){if(!(e instanceof T||e instanceof C))return console.error(new Error("ItemBox: item is not Item or ItemInstance"));if(t=t||{},this.showTitle=t.hasOwnProperty("showTitle")?t.showTitle:this.showTitle,this.showDescription=t.hasOwnProperty("showDescription")?t.showDescription:this.showDescription,this.itemInstance=e.getItemInstance(),this.item=e,e.isItemInstance&&!e.isInitialised){var i=this;return e.once("initialised",function(){i.item===e&&i.displayItem(e,t)})}if(this.itemId=e.getProperty("id"),this.weight.setText(b("ui.common.short.weight",e.getProperty("weight"))),this.twoHandedIcon.toggleDisplay(!!e.getProperty("twoHanded")),this.image.setStyle("backgroundImage",e.getProperty("image")),y(this.image,!0),this.tooltipItemDescription.updateUI(e),this._toggleItemActions(e),this._canDisplayDescription()){var n=w.getItemTypeMap()[e.getProperty("typeId")].nameId;this.categoryText.setText(b("ui.common.category")+b("ui.common.colon")+n),this.descriptionText.setText(e.getProperty("descriptionId")),this.itemDescriptionContainer.show(),this.itemDescriptionContainer.refresh()}else this.itemDescriptionContainer.hide();this._itemTitle.toggleDisplay(!!this.showTitle),this.showTitle&&(this._name.setText(e.getProperty("nameId")),this._level.setText(b("ui.common.short.level")+" "+e.getProperty("level")));for(var o in this.panelCollection)this.panelCollection[o].clearContent();var s=null!==window.gui.playerData.inventory.getGenericItem(this.itemId),a=e.getProperty("hideEffects")&&!s;if(a)this.panelCollection.effects.addRow([b("ui.set.secretBonus")]);else{var r=v.getSortedEffectInstances(e);d(this.panelCollection.effects,r)}h(e.getProperty("conditionsFormatted"),this.panelCollection.conditions),h(e.getProperty("targetConditionsFormatted"),this.panelCollection.conditions),e.getProperty("isWeapon")?(p(e.getProperty("statsFormatted"),this.panelCollection.characteristics),this.itemInfoTabs.toggleTabDisplay(2,!0)):this.itemInfoTabs.toggleTabDisplay(2,!1);var l=this.itemInstance&&this.itemInstance.effectsMap[z];this.durabilityBar.toggleDisplay(!!l),l&&(this.durabilityBar.setValue(l.diceNum/l.value),this.durabilityBarDescription.setText(l.description))},e.exports=c},function(e,t){},function(e,t,i){function n(e){a.call(this,"div",{className:"RewardBoxes"}),e=e||{},this._NB_REWARDS=e.nbRewards||6,this._slotList=[],this._rewardNextSlot=0,this._content=this.createChild("div",{className:"rewardContent"}),this.reset()}i(856);var o=i(739),s=i(541),a=i(321),r=i(172).inherits,l=i(737);r(n,s),e.exports=n,n.prototype.reset=function(){this._slotList=[],this._rewardNextSlot=0,this._content.clearContent();for(var e=0;e<this._NB_REWARDS;e+=1)this._slotList.push(this._content.appendChild(new o))},n.prototype.addItemInstance=function(e){var t=this;if(!(this._rewardNextSlot>=this._NB_REWARDS)){var i=this._slotList[this._rewardNextSlot];i.addClassNames("spinner"),this._rewardNextSlot+=1;var n=new l({itemData:e,quantity:e.quantity});n.on("tap",function(){t.emit("tapSlot",e)}),n.insertBefore(i),i.destroy()}}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"CharactersSpace"}),this._tiles=[],this.createChild("div",{className:"title",text:l("ui.connection.whosGift")});var e=this.createChild("div",{className:"content"});this._scroll=e.appendChild(new r({className:"scroll"})),this._scrollContent=this._scroll.content.createChild("div",{className:"scrollContent"});var t=this.createChild("div",{className:"characterContainer"});this._characterDisplayWebGL=t.appendChild(new c({scale:"fitin",horizontalAlign:"center"})),this._loadingOverlay=t.createChild("div",{className:"loadingOverlay",hidden:!0,text:l("ui.connection.assignGift")})}i(858);var o=i(172).inherits,s=i(321),a=i(859),r=i(436),l=i(29).getText,c=i(369);o(n,s),e.exports=n,n.prototype.update=function(e){function t(){i._deselecteAll(),this.addClassNames("selected"),i.emit("selectTile",this.id),i._characterDisplayWebGL.release(),i._characterDisplayWebGL.setLook(this.entityLook,{boneType:"characters/",skinType:"characters/"})}var i=this;this._scrollContent.clearContent(),this._tiles=[];for(var n=0,o=e.length;n<o;n+=1){var s=e[n],r=this._scrollContent.appendChild(new a(s.id,s.name,s.level,s.entityLook));i._tiles.push(r),r.on("select",t)}this._scroll.refresh(),this._tiles[0]&&t.call(this._tiles[0])},n.prototype._deselecteAll=function(){for(var e=0,t=this._tiles.length;e<t;e+=1){var i=this._tiles[e];i.delClassNames("selected")}},n.prototype.setAssignLoading=function(e){this._loadingOverlay.toggleDisplay(e),this._loadingOverlay.addClassNames("spinner")},n.prototype.reset=function(){this._deselecteAll(),this._characterDisplayWebGL.release()}},function(e,t){},function(e,t,i){function n(e,t,i,n){s.call(this,{className:"CharacterTile",scaleOnPress:!0},function(){o.emit("select")});var o=this;this.id=e,this.entityLook=n;var r=t;this.createChild("div",{className:"name",text:r});var l="("+a("ui.common.level")+" "+i+")";this.createChild("div",{className:"level",text:l})}i(860);var o=i(172).inherits,s=i(335),a=i(29).getText;o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"DeleteCharacterConfirmWindow",title:l("ui.popup.delete"),positionInfo:{left:"c",top:"c",width:p.w,height:p.h},noCloseButton:!0});var e,t,i,n,o=50,m=this,f=this.windowBody,g="";this.once("open",function(){f.createChild("div",{text:l("ui.charSel.secretQuestion"),className:"explications"});var s=function(){window.gui.openConfirmPopup({title:l("ui.popup.warning"),message:l("ui.popup.warnBeforeDelete",n),cb:function(e){e&&window.dofus.sendMessage("CharacterDeletionRequestMessage",{characterId:i,secretAnswerHash:d(i+"~"+g)}),a.close(m.id)}})};t=f.createChild("div",{className:"secretQuestionDiv"}),e=f.appendChild(new c({attr:{maxlength:o,value:""},onEnter:function(){e.blur(),s()}})),e.addClassNames("inputSecretAnswer"),e.on("change",function(e){g=e});var h=f.createChild("div",{className:"buttonContainer"}),p=h.appendChild(new r(l("ui.common.ok")));p.on("tap",s);var _=h.appendChild(new r(l("ui.common.cancel")));_.on("tap",function(){a.close(m.id)}),this.keyboardHeight=.6*u.screenHeight}),this.on("open",function(e){h.disableScroll(!0),e=e||{},i=e.id,n=e.name,e.secretQuestion||console.error("DeleteCharacterConfirmWindow: missing secretQuestion for characterId",i),t.setText(e.secretQuestion)}),this.on("opened",function(){e.focus()}),this.on("close",function(){e.setValue(""),g="",e.blur(),h.disableScroll(!1)}),h.on("show",function(e){m.setPosition(e)})}i(862);var o=i(172).inherits,s=i(541),a=i(194),r=i(335).DofusButton,l=i(29).getText,c=i(530),d=i(844),u=i(166).dimensions,h=i(435),p={w:380,h:250};o(n,s),e.exports=n,n.prototype.setPosition=function(e){var t=u.screenHeight-e,i={left:"c",top:(t-p.h)/2,width:p.w,height:p.h};a.positionWindow(this.id,i)}},function(e,t){},function(e,t,i){function n(){function e(){r.close(o.id),l("CLOSE_DOCUMENT")}function t(e){r.openDialog(o.id),a.getData("Documents",e.documentId,function(e,t){return e?(r.close(o.id),console.warn("Documents error",e)):(t.typeId===d&&n.open(t),t.typeId===u&&c.open(t),void l("OPEN_DOCUMENT"))})}s.call(this,{className:"documentWindow",noTitle:!0,noCloseButton:!0,positionInfo:{left:"c",top:"c",width:"90%",height:"90%"}});var n,o=this;window.gui.once("DocumentReadingBeginMessage",function(s){n=i(868),o.windowBody.appendChild(c),o.windowBody.appendChild(n),c.on("close",e),n.on("close",e),window.gui.on("DocumentReadingBeginMessage",t),t(s)})}i(864);var o=i(172).inherits,s=i(541),a=i(30),r=i(194),l=i(247).playUiSound,c=i(865),d=1,u=2;o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"Scroll"}),this.setClassNames("Scroll"),this.btnClose=this.appendChild(new r({className:"btnClose"})),this.lblTitle=this.createChild("div",{className:"lblTitle"}),this.createChild("div",{className:"scrollOrnament"}),this.lblContent=this.createChild("div",{className:"lblContent"}),this.txIllu=this.createChild("div",{className:"scrollImage"}),this._image=null,this._illuUri=null,this._styleSheet=new l,this._hasText=!0;var e=this;this.btnClose.on("tap",function(){e.close()})}function o(e){var t=new RegExp(d).exec(e);return null!==t}var s=i(172).inherits,a=i(866),r=i(335),l=i(867),c=i(182),d=/(<[a-zA-Z]+\s*[^>]*>)+([^<].*?)/gi;s(n,a),e.exports=new n,n.prototype.open=function(e){if(this._title=e.titleId,this._page=e.contentId,this._image=this._getImageData(this._page),!this._page)return console.warn("Scroll does not exist",e.id),this.close();e.contentCSS&&this._styleSheet.create(this._formatText(e.contentCSS),".Scroll");var t=this;this._preInitData(function(){t.show()})},n.prototype._preInitData=function(e){if(this._hasText=o(this._page),!this._image)return this._initScroll(),e();var t=this;c.preloadImageUrl(this._image.imageId,function(i){return t._image&&(t._image.src=i,t._initScroll()),e()})},n.prototype.close=function(){this.hide(),this.lblTitle.clearContent(),this.lblContent.clearContent(),this._image=null,this.txIllu.setStyle("backgroundImage",""),this._styleSheet.destroy(),a.prototype.close.call(this)},n.prototype._initScroll=function(){this.lblTitle.setHtml(this._title);var e="";e=this._styleSheet?this._formatText(this._page):this._page,this.lblContent.clearContent();var t=!!this._image;!this._hasText&&t?(this.lblContent.hide(),this.txIllu.setStyles({backgroundImage:"url("+this._image.src+")",backgroundPosition:"center center",width:"100%"})):(this.lblContent.show(),this.lblContent.toggleClassName("small",t),this.txIllu.toggleDisplay(t),t&&(e=e.replace(this._image.regExpResult,""),this.txIllu.setStyles({backgroundImage:"url("+this._image.src+")",backgroundPosition:"center top",width:""})),this.lblContent.appendChild(this._formatLinks(e)))}},function(e,t,i){function n(){o.call(this,"div",{hidden:!0}),this._styleSheet=null,this._title=null,this._author=null,this._subTitle=null,this._pages=null}var o=i(321),s=i(615),a=i(172).inherits,r=i(198).events,l=i(339),c=/(.*?)(<img.*?\/?>)/gi,d=/#+/g,u=/<a\shref=['"](.*?)['"]\s*>(.*?)<\/a>/gi,h=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))/g,p="startquest",m="validateobjective",f="map",g="url";a(n,o),e.exports=n,n.prototype._linkHandler=function(e){var t=e.split(",");t[0]===p?(window.dofus.sendMessage("QuestStartRequestMessage",{questId:t[1]}),this.close()):t[0]===m?(window.dofus.sendMessage("QuestObjectiveValidationMessage",{questId:t[1],objectiveId:t[2]}),this.close()):t[0]===f&&window.gui.emit("CompassUpdateMessage",{type:s.COMPASS_TYPE_SIMPLE,worldX:~~t[1],worldY:~~t[2]})},n.prototype.close=function(){this.emit("close")},n.prototype._getImageData=function(e){var t=new RegExp(c),i=t.exec(e);if(!i)return null;for(var n,o=i[2],s=new RegExp(h),a={};null!==(n=s.exec(o));)n.index===s.lastIndex&&s.lastIndex++,a[n[1]]=n[2]||n[3];var r={};r.regExpResult=i[0],r.before=i[1];var l=a.src.replace(d,""),u=l.split(",");return l="swf"===u[0]?"gfx/documents/swf/"+u[1]+".png":"gfx/documents/"+u[1]+"."+u[0],r.imageId=l,r.width=parseInt(a.width,10),r.height=parseInt(a.height,10),r.hspace=parseInt(a.hspace,10),r.align=a.align||"",r},n.prototype._getAllImagesData=function(e){for(var t,i=[],n=new RegExp(c);null!==(t=n.exec(e));)i.push(this._getImageData(t[0]));return i},n.prototype._getAllLinks=function(e){for(var t,i=[],n=new RegExp(u);null!==(t=n.exec(e));)i.push({text:t[2],href:t[1].replace("event:",""),original:t[0]});return i},n.prototype._formatText=function(e){var t=e;return t=t.replace(/\n/g," "),t=t.replace(/\r/g," "),t=t.replace(/\t/g,""),t=t.replace(/<p><\/p>/g,"<br/>")},n.prototype._formatLinks=function(e){function t(e,t,n){n?e.addEventListener(r.end,function(e){l.openUrlInAppBrowser(t),e.preventDefault()}):e.addEventListener(r.end,function(e){i._linkHandler(t),e.preventDefault()})}var i=this,n=new o("div");n.setHtml(e);for(var s=n.rootElement.getElementsByTagName("a"),a=0,c=s.length;a<c;a++){var d=s[a],u=d.href.replace("event:","");u.indexOf(g)!==-1?t(d,u.split(",")[1],!0):(t(d,u),d.href="#")}return n}},function(e,t){function i(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e}function n(e,t,i,n){"insertRule"in e?e.insertRule(t+"{"+i+"}",n):"addRule"in e&&e.addRule(t,i,n)}function o(){this.styleTag=null}var s=/(\.*?[a-z0-9_\-]+?)[ ]*{[ ]*(.*?\/?)[ ]*}/gi;e.exports=o,o.prototype.destroy=function(){this.styleTag&&(document.head.removeChild(this.styleTag),this.styleTag=null)},o.prototype.create=function(e,t){this.styleTag||(this.styleTag=i());for(var o,a=this.styleTag.sheet,r=new RegExp(s);null!==(o=r.exec(e));)o.index===r.lastIndex&&r.lastIndex++,t&&("body"===o[1]?o[1]=t:o[1]=t+" "+o[1]),n(a,o[1],o[2],0)}},function(e,t,i){function n(){o.call(this),this.setClassNames("ReadingBook"),this.btnClose=this.appendChild(new r({className:"btnClose"})),this.btnHome=this.appendChild(new r({className:"btnHome"})),this.pageLeft=this.createChild("div",{className:["page","pageLeft"]}),this.pageRight=this.createChild("div",{className:["page","pageRight"]}),this.pageTitle=this.createChild("div",{className:["pageTitle","page","pageRight"]}),this.lblTitle=this.pageTitle.createChild("div",{className:"lblTitle"}),this.lblSubtitle=this.pageTitle.createChild("div",{className:"lblSubtitle"}),this.pageTitle.createChild("div",{className:"bookOrnament"}),this.lblAuthor=this.pageTitle.createChild("div",{className:"lblAuthor"}),this.txDeco={},this.lblPageNumberLeft=this.appendChild(new r({className:["pageNumber","left"]})),this.lblPageNumberRight=this.appendChild(new r({className:["pageNumber","right"]})),this.btnPrevious=this.appendChild(new r({className:["btnNav","previous"]})),this.btnNext=this.appendChild(new r({className:["btnNav","next"]})),this._lastIndex=null,this._currentIndex=null,this._nbPages=null,this._styleSheet=new s;var e=this,t=this.appendChild(new l);this.btnClose.on("tap",function(){e.close()}),this.btnHome.on("tap",function(){e._currentIndex=-1,e._updateButtons(),e._updateBook(),d("BACK_TO_BEGINNING_DOCUMENT")}),this.btnPrevious.on("tap",function(){e._currentIndex-=2,e._updateButtons(),e._updateBook(),d("TURN_PAGE_DOCUMENT_1")}),this.btnNext.on("tap",function(){e._currentIndex+=2,e._updateButtons(),e._updateBook(),d("TURN_PAGE_DOCUMENT_2")}),this.lblPageNumberLeft.on("tap",function(){t.setStyles({left:"15%",right:"initial"}),t.open({min:1,max:e._nbPages+1,placeholder:e._currentIndex+1})}),this.lblPageNumberRight.on("tap",function(){t.setStyles({right:"15%",left:"initial"}),t.open({min:1,max:e._nbPages+1,placeholder:e._currentIndex+2})}),t.on("confirm",function(t){e._selectPage(parseInt(t,10)-2),d("TURN_PAGE_DOCUMENT_3")})}var o=i(866),s=i(867),a=i(172).inherits,r=i(335),l=i(332),c=i(182),d=i(247).playUiSound,u="linkpage",h=840;a(n,o),e.exports=new n,n.prototype.open=function(e){this._title=e.titleId,this._author=e.authorId,this._subTitle=e.subTitleId,e.contentCSS&&this._styleSheet.create(this._formatText(e.contentCSS),".ReadingBook"),this._pages=e.contentId.split("<pagefeed/>"),this._lastIndex=-1,this._currentIndex=-1,this._nbPages=this._pages.length,this._initBook();var t=this._getAllImagesData(e.contentId);this.imageMap={};var i=t.map(function(e){return e.imageId});this.show();var n=this;c.preloadImageUrls(i,function(e){for(var i=0;i<t.length;i++)n.imageMap[t[i].imageId]=e[i];n._selectPage(n._currentIndex)})},n.prototype.close=function(){this._clearPages(),this.hide(),this._styleSheet.destroy(),o.prototype.close.call(this)},n.prototype._clearPages=function(e){e&&"left"!==e||this.pageLeft.clearContent(),e&&"right"!==e||this.pageRight.clearContent()},n.prototype._initBook=function(){this.lblTitle.setHtml(this._title),this.lblSubtitle.setHtml(this._subTitle),this.lblAuthor.setHtml(this._author||"")},n.prototype._updateBook=function(){var e=this._currentIndex===-1;this.pageTitle.toggleDisplay(e),this.pageRight.toggleDisplay(!e),this.lblPageNumberLeft.toggleDisplay(!e),this.lblPageNumberRight.show(),this._clearPages(),e?(this._updatePageLeft(),this.lblPageNumberRight.setText(this._currentIndex+2)):(this._updatePageLeft(),this._updatePageRight()),this._lastIndex=this._currentIndex},n.prototype._updatePageLeft=function(){var e="";e=this._styleSheet&&this._currentIndex!==-1?this._formatText(this._pages[this._currentIndex-1]):this._pages[this._currentIndex-1]||"",this._insertContent(this.pageLeft,e),this.lblPageNumberLeft.setText(this._currentIndex+1)},n.prototype._updatePageRight=function(){if(this._currentIndex<this._nbPages){this.pageRight.isVisible()||this.pageRight.show();var e="";e=this._styleSheet&&this._currentIndex!==-1?this._formatText(this._pages[this._currentIndex]):this._pages[this._currentIndex],this._insertContent(this.pageRight,e),this.lblPageNumberRight.setText(this._currentIndex+2)}else this.pageRight.hide(),this.lblPageNumberRight.setText("")},n.prototype._updateButtons=function(){var e=this._currentIndex===-1,t=this._currentIndex+1>=this._nbPages;this.btnHome.toggleDisplay(!e),this.btnPrevious.toggleDisplay(!e),this.btnNext.toggleDisplay(!t)},n.prototype._selectPage=function(e){this._currentIndex=e%2?e:e+1,this._updateButtons(),this._updateBook()},n.prototype._linkHandler=function(e){if(e.indexOf(u)!==-1){var t=parseInt(e.substr(u.length),10);return this._selectPage(t)}o.prototype._linkHandler.call(this,e)},n.prototype._insertContent=function(e,t){var i=this._getAllImagesData(t);if(i.length){for(var n=0;n<i.length;n++){var o=i[n];o.before&&e.appendChild(this._formatLinks(o.before)),this._addTextureOnPage(e,o),t=t.replace(o.regExpResult,"")}t&&e.appendChild(this._formatLinks(t))}else e.appendChild(this._formatLinks(t))},n.prototype._addTextureOnPage=function(e,t){var i=e.createChild("div",{className:"image"}),n=parseInt(this.getComputedStyle("height"),10),o=t.height/h*n,s={height:o+"px",width:"100%",backgroundImage:"url("+this.imageMap[t.imageId]+")"};"center"===t.align&&(s.backgroundPosition=t.align),i.setStyles(s)}},function(e,t,i){function n(e){function t(){var e=i.drawer;e.updateCharacter()}d.call(this,{title:a("ui.common.inventory"),className:"EquipmentWindow",plusButton:!1,positionInfo:{left:"10%",top:"c",width:636,height:"90%",minHeight:550},openingSound:"OPEN_INVENTORY",closingSound:"CLOSE_INVENTORY"}),this.storageView=e,this.storageView.registerView(this,{manualOpening:!0,enableAveragePrice:!1,enableSlotContext:!1,contextParams:{enableActions:!0},filters:{quest:!0,preset:!0}}),this.once("open",function(){this._createDom(),this._setupEvents()}),this.once("opened",function(){this.drawer.setEquipment()}),this.on("open",function(){this.alignWithCharacteristics(),this.storageBox.appendChild(this.storageView.storageUI),this.drawer.resetItem()});var i=this,n=window.gui;n.on("connected",function(){i.once("opened",t)}),n.on("disconnect",function(){i.removeListener("opened",t),i.drawer&&i.drawer.disconnect()})}i(870);var o=i(317),s=i(871),a=i(29).getText,r=i(172).inherits,l=i(461),c=o.setDroppable,d=i(541),u=i(194);r(n,d),e.exports=n,n.prototype.alignWithCharacteristics=function(){var e=u.getWindow("characteristics");e.openState&&(this.setStyle("top",e.getStyle("top")),u.arrangeOpeningWindow(this.id,{rightOf:e.id,sameHeight:!0}))},n.prototype.getEquipmentSlots=function(){if(this.drawer)return this.drawer.getSlots()},n.prototype._setupEvents=function(){function e(){t.drawer.removePossiblePositionsHighlight()}var t=this,i=window.gui;this.on("slot-tap",function(e){e.itemInstance&&this.drawer.displayItem(e.itemInstance)}),this.on("slot-doubletap",function(e){e.itemInstance.doDefaultAction()}),this.on("slot-dragStart",function(t){var i=t.dbItem.type.possiblePositions;i.length&&this.drawer.highlightPossiblePositions(i),o.once("dragEnd",e)}),this.on("focus",function(){i.shortcutBar.openPanel("item")}),this.drawer.on("equippableHighlighted",function(e){t.emit("equippableHighlighted",e)}),this.drawer.on("itemDropped",function(e,i){t.emit("itemDropped",e,i)}),this.drawer.on("itemSelect",function(){t.storageView.unSelectSlot()})},n.prototype._createDom=function(){this.storageBox=this.windowBody.createChild("div",{className:"storageBox"}),c(this.storageBox,["characterBox"]),this.storageBox.on("drop",function(e){window.dofus.sendMessage("ObjectSetPositionMessage",{objectUID:e.itemInstance.objectUID,position:l.positions.notEquipped,quantity:1})}),this.drawer=this.windowBody.appendChild(new s)}},function(e,t){},function(e,t,i){function n(){f.call(this,"div",{className:"EquipmentDrawer"}),this.content=this.createChild("div",{className:"drawerContent"}),this._slots={},this._createDom(),this._setupEvents()}function o(){this.data&&this.data.isInitialised&&window.gui.playerData.inventory.unEquipItem(this.data.objectUID)}function s(e,t){var i=window.gui.playerData.inventory.isPetFood(e,t),n=116===t.getProperty("typeId");(i||n)&&window.dofus.sendMessage("ObjectFeedMessage",{objectUID:e.objectUID,foodUID:t.getProperty("objectUID"),foodQuantity:1})}i(872);var a=i(369),r=i(197),l=i(317),c=i(29).getText,d=i(172).inherits,u=i(853),h=i(461),p=i(737),m=i(182),f=i(321),g=h.positions,_={bottom:[g.amulet,g.shield,g.ringLeft,g.ringRight,g.belt,g.boots],left:[g.dofus1,g.dofus2,g.dofus3,g.dofus4,g.dofus5,g.dofus6],right:[g.hat,g.weapon,g.cape,g.pets,g.mount]};d(n,f),e.exports=n,n.prototype._createSlot=function(e,t){function i(e){this.containsPet()?s(this.data,e.data):window.gui.playerData.inventory.equipItem(e.data.objectUID,this.position),n.emit("itemDropped",e.data,this.position)}var n=this,a=this._slots[t]=e.appendChild(new p({scaleOnPress:!0}));a.addClassNames("pos"+t),a.position=t,l.setDroppable(a,["characterBox","equipment"],{matchPositionOnDrop:!0}),a.on("drop",i),a.itemUI={},l.setDraggable(a,a.itemUI,"characterBox"),a.on("tap",function(){this.data&&this.data.isInitialised&&(n.displayItem(this.data),n.emit("itemSelect",this.data))}),a.on("doubletap",o)},n.prototype._createDom=function(){function e(e){window.gui.playerData.inventory.equipItem(e.itemInstance.objectUID)}var t=this.content.createChild("div",{className:"characterBox"}),i={};i.left=t.createChild("div",{className:"leftSlotBox"});var n=t.createChild("div",{className:"rightContainer"}),o=n.createChild("div",{className:"topBox"}),s=this._character=o.appendChild(new a({scale:"fitin",horizontalAlign:"center"}));l.setDroppable(s,["equipment"]),s.on("drop",e);var d=s.createChild("div",{className:"leftButton"});r(d,{repeatDelay:100}),d.on("tap",function(){s.rotateCharacter(!1)});var h=s.createChild("div",{className:"rightButton"});r(h,{repeatDelay:100}),h.on("tap",function(){s.rotateCharacter(!0)}),i.right=o.createChild("div",{className:"rightSlotBox"}),i.bottom=n.createChild("div",{className:"bottomSlotBox"});for(var p in _)for(var m=_[p],f=i[p],g=0,v=m.length;g<v;g+=1)this._createSlot(f,m[g]);this._placeHolder=this.content.createChild("div",{className:"itemBoxPlaceHolder",text:c("ui.common.selectItem")}),this._itemBox=this.content.appendChild(new u({showTitle:!0,showItemActions:!0,minRows:7}))},n.prototype._setSlot=function(e,t){var i=this._slots[e];if(i)if(t.mountLocation)i.setData(t),m.preloadImage("gfx/mounts/"+t.model+".png",function(e){i.setImage(e)});else{i.setItem(t),i.itemUI.backgroundImage=i.getImage(),l.enableDrag(i);var n=this._slots[g.weapon],o=this._slots[g.shield],s=n.itemInstance&&n.itemInstance.item;s&&s.twoHanded?o.lock():o.itemInstance||o.unset()}},n.prototype._unsetSlot=function(e){var t=this._slots[e];t&&(t.unset(),l.disableDrag(t))},n.prototype.updateCharacterLook=function(e){this._character.setLook(e,{riderOnly:!0,boneType:"characters/",skinType:"characters/",keepDirection:!0,keepModels:!0})},n.prototype.updateCharacter=function(){var e=window.gui.playerData.characterBaseInformations;this.updateCharacterLook(e.entityLook);var t=this._character;m.preloadImage("gfx/illusUi/symboles_classe/FichePerso_tx_symboleClasse_frame"+(e.breed-1)+".png",function(e){
t.setStyle("backgroundImage",e)})},n.prototype.disconnect=function(){this._character.release()},n.prototype.setEquipment=function(){var e,t=window.gui.playerData,i=t.inventory.equippedItems;for(e in this._slots){var n=i[e];n?this._setSlot(e,n):this._unsetSlot(e)}t.isRiding&&this._setSlot(g.pets,t.equippedMount)},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=t.playerData,n=i.inventory;n.on("itemMoved",function(t,i,n){n===g.notEquipped?e._unsetSlot(i):e._setSlot(n,t)}),n.on("itemAdded",function(t){t.position!==g.notEquipped&&e._setSlot(t.position,t)}),n.on("itemDeleted",function(t,i){var n=e._itemBox.item;n&&n===i&&e.resetItem(),i.position!==g.notEquipped&&e._unsetSlot(i.position)}),n.on("itemModified",function(t){t.position!==g.notEquipped&&e._setSlot(t.position,t)}),n.on("listUpdate",function(){e.setEquipment()}),i.on("lookUpdate",function(t){e.updateCharacterLook(t)}),i.on("mountRiding",function(){i.isRiding?e._setSlot(g.pets,i.equippedMount):e._unsetSlot(g.pets)}),i.on("setMount",function(){i.isRiding&&e._setSlot(g.pets,i.equippedMount)})},n.prototype.displayItem=function(e){this._placeHolder.hide(),this._itemBox.show(),e.mountLocation?this._itemBox.displayMount(e):this._itemBox.displayItem(e)},n.prototype.resetItem=function(){this._placeHolder.show(),this._itemBox.hide()},n.prototype.getSlots=function(){return this._slots},n.prototype.highlightPossiblePositions=function(e){e=e||[];for(var t=0;t<e.length;t+=1){var i=e[t];this._slots[i].addClassNames("selected")}this.emit("equippableHighlighted",e)},n.prototype.removePossiblePositionsHighlight=function(){for(var e in this._slots)this._slots[e].delClassNames("selected")}},function(e,t){},function(e,t,i){function n(){l.call(this,{className:"EstateForSellWindow",title:g("ui.estate.agency"),positionInfo:{top:"c",left:"c",width:"82%",height:"94%",maxHeight:660}});var e=this;this.once("open",function(){e.setupContainer1(),e.setupContainer2(),e.setupContainer3()}),this.on("open",function(){e.resetFilterData()}),this.on("close",function(){e.table.clearContent(),h.close("estateInformation")}),this.setupSocketEvents()}function o(e,t){for(var i={},n={},o=0;o<e.length;o++)i[e[o].modelId]=!0,n[e[o].subAreaId]=!0;u.getDataMap("Houses",Object.keys(i),function(i,o){return i?t(i):void u.getDataMap("SubAreas",Object.keys(n),function(i,n){if(i)return t(i);for(var s=window.gui.databases.Areas,a=[],r=0;r<e.length;r++){var l=e[r],c=n[l.subAreaId],d=o[l.modelId];a.push({type:"house",gfxId:d.gfxId,name:d.nameId,areaName:s[c.areaId].nameId,price:p.kamasToString(l.price),rooms:l.nbRoom,chests:l.nbChest,skillsCount:l.skillListIds.length,subAreaName:c.nameId,ownerName:l.ownerName,ownerConnected:l.ownerConnected,worldX:l.worldX,worldY:l.worldY})}return t(null,a)})})}function s(e,t){for(var i={},n=0;n<e.length;n++)i[e[n].subAreaId]=!0;u.getDataMap("SubAreas",Object.keys(i),function(i,n){if(i)return t(i);for(var o=[],s=window.gui.databases.Areas,a=0;a<e.length;a++){var r=e[a],l=n[r.subAreaId];o.push({type:"paddock",name:g("ui.mount.paddockWithRoom",r.nbObject),areaName:s[l.areaId].nameId,price:p.kamasToString(r.price),mounts:r.nbMount,objects:r.nbObject,subAreaName:l.nameId,ownerName:r.guildOwner?r.guildOwner:"?",worldX:r.worldX,worldY:r.worldY})}return t(null,o)})}function a(){h.open("estateInformation",this.data)}i(874);var r=i(172).inherits,l=i(541),c=i(335).DofusButton,d=i(340),u=i(30),h=i(194),p=i(339),m=i(532),f=i(875),g=i(29).getText,_=i(539);r(n,l),e.exports=n,n.prototype.setupRoomSelector=function(){var e=this,t=4;this.roomSelector.addOption(g("ui.estate.filter.atLeastNbRoom"),0);for(var i=1;i<=t;i++)this.roomSelector.addOption(g("ui.estate.filter.nbRoom",i),i);this.roomSelector.on("change",function(t){e.houseToSellFilter.atLeastNbRoom=parseInt(t,10)})},n.prototype.setupChestSelector=function(){var e=this,t=4;this.chestSelector.addOption(g("ui.estate.filter.atLeastNbChest"),0);for(var i=1;i<=t;i++)this.chestSelector.addOption(g("ui.estate.filter.nbChest",i),i);this.chestSelector.on("change",function(t){e.houseToSellFilter.atLeastNbChest=parseInt(t,10)})},n.prototype.setupMountSelector=function(){var e=this,t=20,i=5;this.mountSelector.addOption(g("ui.estate.filter.atLeastNbMount"),0);for(var n=i;n<=t;n+=i)this.mountSelector.addOption(g("ui.estate.filter.nbMount",n),n);this.mountSelector.on("change",function(t){e.paddockToSellFilter.atLeastNbMount=parseInt(t,10)})},n.prototype.setupBreedingSelector=function(){var e=this,t=20,i=5;this.breedingSelector.addOption(g("ui.estate.filter.atLeastNbMachine"),0);for(var n=i;n<=t;n+=i)this.breedingSelector.addOption(g("ui.estate.filter.nbMachine",n),n);this.breedingSelector.on("change",function(t){e.paddockToSellFilter.atLeastNbMachine=parseInt(t,10)})},n.prototype.setupHousingAreaSelector=function(){var e=this;this.housingAreaSelector.addOption(g("ui.estate.filter.areaRequested"),-1);for(var t=f.getAreasWithHouseOrPaddock("house"),i=0;i<t.length;i++)e.housingAreaSelector.addOption(t[i].nameId,t[i].id);this.housingAreaSelector.on("change",function(t){e.houseToSellFilter.areaId=parseInt(t,10)})},n.prototype.setupPaddockAreaSelector=function(){var e=this;this.paddocksAreaSelector.addOption(g("ui.estate.filter.areaRequested"),-1);for(var t=f.getAreasWithHouseOrPaddock("paddock"),i=0;i<t.length;i++)e.paddocksAreaSelector.addOption(t[i].nameId,t[i].id);this.paddocksAreaSelector.on("change",function(t){e.paddockToSellFilter.areaId=parseInt(t,10)})},n.prototype.setupSkillSelector=function(){var e=this;this.skillSelector.addOption(g("ui.estate.filter.skillRequested"),0),f.getSkillsAvailableInHouse(function(t,i){if(t)return console.error("Failed to retrieve skill list",t);for(var n=0;n<i.length;n++)e.skillSelector.addOption(i[n].nameId,i[n].id)}),this.skillSelector.on("change",function(t){e.houseToSellFilter.skillRequested=parseInt(t,10)})},n.prototype.changeDialogType=function(e){this.dialogType=e,"house"===e?(this.roomSelector.show(),this.chestSelector.show(),this.housingAreaSelector.show(),this.skillSelector.show(),this.mountSelector.hide(),this.breedingSelector.hide(),this.paddocksAreaSelector.hide()):(this.roomSelector.hide(),this.chestSelector.hide(),this.housingAreaSelector.hide(),this.skillSelector.hide(),this.mountSelector.show(),this.breedingSelector.show(),this.paddocksAreaSelector.show())},n.prototype.setupContainer1=function(){var e=this,t=this.windowBody.createChild("div",{className:"container1"});t.createChild("div",{className:["text","inline"],text:g("ui.estate.typeChoice")}),this.propertySelector=t.appendChild(new m({className:"propertySelector"})),this.propertySelector.addOption(g("ui.common.housesWord"),"house"),this.propertySelector.addOption(g("ui.common.mountPark"),"paddock"),this.propertySelector.on("change",function(t){e.changeDialogType(t),e.searchButton.emit("tap")})},n.prototype.setupContainer2=function(){var e=this,t=this.windowBody.createChild("div",{className:["wrapper","container2"]});t.createChild("div",{className:"text",text:g("ui.search.criteria")});var i=t.createChild("div",{className:"priceContainer"});i.createChild("div",{className:["text","inline"],text:g("ui.estate.filter.maxPrice")});var n=i.createChild("div",{className:"inputContainer"});this.priceInput=n.appendChild(new d({minValue:0,title:g("ui.estate.filter.maxPrice")})),n.createChild("div",{className:"kamaUnit",text:g("ui.common.short.kama")});var o=t.createChild("div",{className:"col1"});this.roomSelector=o.appendChild(new m({className:"roomSelector"})),this.setupRoomSelector(),this.chestSelector=o.appendChild(new m({className:"chestsSelector"})),this.setupChestSelector(),this.mountSelector=o.appendChild(new m({className:"mountsSelector"})),this.setupMountSelector(),this.breedingSelector=o.appendChild(new m({className:"breedingSelector"})),this.setupBreedingSelector(),this.housingAreaSelector=o.appendChild(new m({className:"areaSelector"})),this.setupHousingAreaSelector(),this.paddocksAreaSelector=o.appendChild(new m({className:"areaSelector"})),this.setupPaddockAreaSelector(),this.skillSelector=o.appendChild(new m({className:"skillSelector"})),this.setupSkillSelector(),this.searchButton=t.appendChild(new c(g("ui.search.search"),{className:["searchButton","inline"]})),this.searchButton.on("tap",function(){var t=e.priceInput.getValue();return"house"===e.dialogType?(e.houseToSellFilter.maxPrice=t,window.dofus.sendMessage("HouseToSellFilterMessage",e.houseToSellFilter),void window.dofus.sendMessage("HouseToSellListRequestMessage",{pageIndex:1})):(e.paddockToSellFilter.maxPrice=t,window.dofus.sendMessage("PaddockToSellFilterMessage",e.paddockToSellFilter),void window.dofus.sendMessage("PaddockToSellListRequestMessage",{pageIndex:1}))})},n.prototype.setupContainer3=function(){function e(e){var t=new c("",{className:"info"});return t.data=e.button,t.on("tap",a),t}var t=this,i=this.windowBody.createChild("div",{className:["wrapper","container3"]}),n=[{id:"name",header:g("ui.common.name"),sort:!0},{id:"subarea",header:g("ui.map.subarea"),sort:!0},{id:"price",header:g("ui.common.price"),sort:!0},{id:"button",format:e}],o={clickable:!1};this.table=i.appendChild(new _(n,null,o));var s=i.createChild("div",{className:"navigator"});this.leftButton=s.appendChild(new c("",{className:["leftButton","inline"]})),this.pages=s.createChild("div",{className:["pages","inline"]}),this.rightButton=s.appendChild(new c("",{className:["rightButton","inline"]})),this.leftButton.on("tap",function(){var e={pageIndex:t.currentPageIndex-1};return"house"===t.dialogType?void window.dofus.sendMessage("HouseToSellListRequestMessage",e):void window.dofus.sendMessage("PaddockToSellListRequestMessage",e)}),this.rightButton.on("tap",function(){var e={pageIndex:t.currentPageIndex+1};return"house"===t.dialogType?void window.dofus.sendMessage("HouseToSellListRequestMessage",e):void window.dofus.sendMessage("PaddockToSellListRequestMessage",e)})},n.prototype.updateList=function(e){var t=this;this.table.clearContent();var i="house"===t.dialogType?o:s;i(e,function(e,i){if(e)return console.error("Failed to retrieve data",e);for(var n=[],o=0;o<i.length;o++){var s=i[o];n.push({name:s.name,subarea:s.areaName,price:s.price,button:s})}t.table.addList(n)})},n.prototype.resetFilterData=function(){this.houseToSellFilter={areaId:-1,atLeastNbRoom:0,atLeastNbChest:0,skillRequested:0,maxPrice:0},this.paddockToSellFilter={areaId:-1,atLeastNbMount:0,atLeastNbMachine:0,maxPrice:0},this.roomSelector.setValue(0),this.chestSelector.setValue(0),this.mountSelector.setValue(0),this.breedingSelector.setValue(0),this.housingAreaSelector.setValue(-1),this.paddocksAreaSelector.setValue(-1),this.skillSelector.setValue(0),this.priceInput.setValue(0),window.dofus.sendMessage("HouseToSellFilterMessage",this.houseToSellFilter),window.dofus.sendMessage("PaddockToSellFilterMessage",this.paddockToSellFilter)},n.prototype.updateDisplay=function(e,t){this.currentPageIndex=t.pageIndex,this.currentPageIndex<=1?this.leftButton.disable():this.leftButton.enable(),this.currentPageIndex>=t.totalPage?this.rightButton.disable():this.rightButton.enable(),this.pages.setText(t.pageIndex+"/"+t.totalPage),this.propertySelector.setValue(e),this.changeDialogType(e)},n.prototype.setupSocketEvents=function(){var e=this;window.gui.on("HouseToSellListMessage",function(t){h.openDialog(e.id),e.updateDisplay("house",t),e.updateList(t.houseList)}),window.gui.on("PaddockToSellListMessage",function(t){h.openDialog(e.id),e.updateDisplay("paddock",t),e.updateList(t.paddockList)})}},function(e,t){},function(e,t,i){var n=i(339),o=i(30),s=null,a=null,r=null;e.exports.getAreasWithHouseOrPaddock=function(e){var t="paddock"===e;if(s)return t?a:s;var i=window.gui.databases.Areas;a=[],s=[];for(var o in i){var r=i[o];if(r.containPaddocks||r.containHouses){var l={id:o,nameId:r.nameId};r.containPaddocks&&a.push(l),r.containHouses&&s.push(l)}}return n.sortObjectInArray(a,"nameId"),n.sortObjectInArray(s,"nameId"),t?a:s},e.exports.getSkillsAvailableInHouse=function(e){return r?e(null,r):void o.getAllDataMap("Skills",function(t,i){if(t)return e(t);r=[];for(var o in i){var s=i[o];s.availableInHouse&&r.push({id:s.id,nameId:s.nameId})}return n.sortObjectInArray(r,"nameId"),e(null,r)})}},function(e,t,i){function n(){r.call(this,{className:"EstateInformationWindow",title:a("ui.popup.information"),positionInfo:{top:"c",left:"c",width:580,height:355}});var e=this;this.worldX=0,this.worldY=0,this.once("open",function(){e.setupDom()}),this.on("open",function(t){return t?(e.windowBody.show(),void e.updateData(t)):void e.windowBody.hide()})}i(877);var o=i(172).inherits,s=i(335).DofusButton,a=i(29).getText,r=i(541),l=i(194),c=i(182);o(n,r),e.exports=n,n.prototype.setupDom=function(){var e=this,t=this.windowBody.createChild("div",{className:["container","container1"]}),i=t.createChild("div",{className:"imageContainer"});this.image=i.createChild("div",{className:"image"});var n=t.createChild("div",{className:"houseDetails"});this.name=n.createChild("div",{className:"name"});var o=n.createChild("div",{className:["textContainer","price"]});o.createChild("div",{className:"left",text:a("ui.common.price")}),this.price=o.createChild("div",{className:"right"}),n.createChild("div",{className:"message",text:a("ui.estate.visit")}),this.roomsContainer=n.createChild("div",{className:["textContainer","clear"]}),this.roomsContainer.createChild("div",{className:"left",text:a("ui.estate.nbRoom")}),this.roomCount=this.roomsContainer.createChild("div",{className:"right"}),this.chestContainer=n.createChild("div",{className:"textContainer"}),this.chestContainer.createChild("div",{className:"left",text:a("ui.estate.nbChest")}),this.chestCount=this.chestContainer.createChild("div",{className:"right"}),this.mountsContainer=n.createChild("div",{className:["textContainer","clear"]}),this.mountsContainer.createChild("div",{className:"left",text:a("ui.estate.nbMount")}),this.mountCount=this.mountsContainer.createChild("div",{className:"right"}),this.breedingContainer=n.createChild("div",{className:"textContainer"}),this.breedingContainer.createChild("div",{className:"left",text:a("ui.estate.nbMachine")}),this.breedingCount=this.breedingContainer.createChild("div",{className:"right"}),this.skills=n.createChild("div",{className:"message"});var r=this.windowBody.createChild("div",{className:["container","container2"]}),c=r.createChild("div",{className:"textContainer"});c.createChild("div",{className:["titleText","text"],text:a("ui.common.localisation")}),this.coordinate=c.createChild("div",{className:"text"});var d=c.appendChild(new s("",{className:"positionBtn"}));this.locationName=r.createChild("div",{className:"locationName"});var u=this.windowBody.createChild("div",{className:["container","container3"]}),h=u.createChild("div",{className:"textContainer"});h.createChild("div",{className:["titleText","text"],text:a("ui.common.ownerWord")}),this.ownerName=h.createChild("div",{className:"text"}),this.ownerStatus=h.createChild("div",{className:"text"}),this.chatButton=h.appendChild(new s("",{className:"chatBtn"})),d.on("tap",function(){isNaN(e.worldX)||isNaN(e.worldY)||(window.gui.emit("CompassUpdateMessage",{type:"estate",worldX:e.worldX,worldY:e.worldY,name:e.nameTxt}),l.open("worldMap",{x:e.worldX,y:e.worldY}))}),this.chatButton.on("tap",function(){window.gui.chat.startPrivateMessage(e.ownerName.getText(),!0)})},n.prototype.updateData=function(e){var t=this;if(this.worldX=e.worldX,this.worldY=e.worldY,this.price.setText(e.price),this.coordinate.setText(e.worldX+","+e.worldY),this.ownerName.setText("?"===e.ownerName?a("ui.common.none"):e.ownerName),"?"!==e.ownerName&&e.hasOwnProperty("ownerConnected")){var i=a(e.ownerConnected?"ui.server.state.online":"ui.server.state.offline");this.ownerStatus.setText(" ("+i+")")}else this.ownerStatus.setText("");this.locationName.setText(e.areaName+" ( "+e.subAreaName+" )"),this.chatButton.toggleDisplay("?"!==e.ownerName&&e.ownerConnected);var n="gfx/illusUi/enclos_tx_illuEnclos.png",o="house"===e.type?"gfx/houses/"+e.gfxId+".png":n;if(this.image.setStyle("backgroundImage","none"),c.preloadImage(o,function(e){t.image.setStyle("backgroundImage",e)}),"house"===e.type){this.mountsContainer.hide(),this.breedingContainer.hide(),this.roomsContainer.show(),this.chestContainer.show(),this.nameTxt=e.name,this.name.setText(e.name),this.roomCount.setText(e.rooms),this.chestCount.setText(e.chests);var s;return s=e.skillsCount>0?a("ui.estate.houseSkills",e.skillsCount):a("ui.estate.noSkill"),this.skills.setText(s),void this.skills.show()}this.nameTxt=a("ui.common.mountPark"),this.name.setText(a("ui.common.mountPark")),this.skills.hide(),this.roomsContainer.hide(),this.chestContainer.hide(),this.mountsContainer.show(),this.breedingContainer.show(),this.mountCount.setText(e.mounts),this.breedingCount.setText(e.objects)}},function(e,t){},function(e,t,i){function n(){m.call(this,{className:"FightEndWindow",title:b("ui.fightend.gameResult"),positionInfo:{left:"c",top:"c",width:780,height:E+"%"}});var e=this;this.once("open",function(){function t(e,t){var i=e.outcome,n=[];if(i===v.RESULT_LOST||i===v.RESULT_VICTORY?(n.push("outcome","outcome"+i),t.addClassNames("title")):"dead"===i&&n.push(i),n.length)return new f("div",{className:n})}function i(e){var t=new f("div",{className:"nameBox"});return t.createChild("div",{className:"nameText",text:e.name}),o(e)&&t.createChild("div",{className:"isMeArrow"}),t}function n(e){var t="";return e.showExperienceFightDelta&&(t+=b("ui.fightend.xp")+b("ui.common.colon")+w.intToString(e.experienceFightDelta),e.isIncarnationExperience&&(t+=" ("+b("ui.common.incarnation")+")")),e.showExperienceForGuild&&(t+="\n"+b("ui.common.guild")+b("ui.common.colon")+w.intToString(e.experienceForGuild)),e.showExperienceForMount&&(t+="\n"+b("ui.common.ride")+b("ui.common.colon")+w.intToString(e.experienceForMount)),t}function c(e){var t=o(e),i=e.additional||[];if(i.length&&i[0]){var a=i[0],r=a.experienceFightDelta,c=a.experienceLevelFloor,u=a.experience-c,h=a.experienceNextLevelFloor-c,p=Math.floor(r*(d.BONUS_PACK_XP/100)),m=t&&p>1&&!window.gui.playerData.isSubscriber(),_=Math.max(0,(u-r)/h),v=u/h,y=m?(u+p)/h:0,M=new f("div",{className:"xpBox"}),T=M.appendChild(new g({valueClassNames:["oldXp","gainedXp","extraXp"]}));t?(T.setValues([_,v,y]),y>=1&&T.createChild("div",{className:"reached100"})):T.setValues([_,v]);var C=Math.floor(100*v)+"% ("+w.intToString(u)+" / "+w.intToString(h)+")";l(T,C);var A=M.createChild("div",{className:"underGauge"}),I=A.createChild("div",{className:"xpTextDiv"});if(I.createChild("div",{className:"gainedXpText",text:w.intToString(r)}),m){var S=I.createChild("div",{className:"extraXpDiv"}),E=w.intToString(p),x=b("tablet.shop.xpBonusPoints",E);S.createChild("div",{className:"ifBonusPack",text:" + "+E}),S.createChild("div",{className:"unlockIcon"}),l(M,x),M.on("tap",s),M.getMorePointsMsg=x}else l(I,n(a));var N=a.rerollExperienceMul;if(N>1){A.addClassNames("withXpBonusIcon");var L=A.createChild("div",{className:["xpBonusIcon","bonus"+N]});l(L,b("ui.common.experiencePoint")+" x "+N+"\n\n"+b("ui.information.xpFamilyBonus"))}return M}}function u(e){var t=e.drops||[];if(t.length){for(var i,n,o=[],s={},a=0;a<t.length;a+=1)a%2===0&&(i=t[a],n=t[a+1]||0,o.push(i),s[i]=n);if(o.length){var r=new f("div",{className:["dropRow","spinner"]});return y(o,function(t,i){if(t)return console.warn("Error while getting items",t);if(r.rootElement){i.sort(function(e,t){var i=e.averagePrice*s[e.id],n=t.averagePrice*s[t.id];return n-i});var n,o;for(n=0;n<i.length&&(o=i[n],n!==S);n+=1)r.appendChild(new T({itemData:o,quantity:s[o.id],tooltipOptions:{openOnTap:!0}}));if(i.length>S){var a=r.appendChild(new A({className:"moreButton"},function(){_.getWindow("fightEndRewards").updateContent(e.name,i,s),_.open("fightEndRewards")})),c="";for(n=0;n<i.length;n+=1)o=i[n],c+=s[o.id]+" x "+o.nameId+"\n";l(a,c)}r.delClassNames("spinner")}}),r}}}a={0:b("ui.fightend.losers"),2:b("ui.fightend.winners"),5:b("ui.common.taxCollector")},r={0:b("ui.fightend.loss"),2:b("ui.fightend.victory")},e.summary=e.windowBody.createChild("div",{className:"summary"});var h=e.summary.createChild("div",{className:["summaryBlock","block1"]}),p=e.summary.createChild("div",{className:["summaryBlock","block2"]});e.block3=e.summary.createChild("div",{className:["summaryBlock","block3"]}),e.outcomeSummary=h.createChild("div",{className:"outcomeSummary"});var m=p.createChild("div",{className:"labels"});m.createChild("div",{text:b("ui.fightend.duration")+b("ui.common.colon")}),m.createChild("div",{text:b("ui.fightend.bonus")+b("ui.common.colon")});var I=p.createChild("div",{className:"values"});e.duration=I.createChild("div",{className:"duration"}),e.starCounter=I.appendChild(new M),l(e.starCounter,function(){var t=e.ageBonus||0;return t?b("ui.fightend.bonus")+b("ui.common.colon")+t+"%":b("ui.fightend.noBonus")}),e.table=e.windowBody.appendChild(new C([{id:"icon",format:t},{id:"name",header:b("ui.common.name"),format:i},{id:"level",header:b("ui.common.short.level")},{id:"xp",header:b("ui.fightend.xp"),format:c},{id:"kamas",header:b("ui.common.kamas")},{id:"drops",header:b("ui.fightend.objects"),format:u}],null,{clickable:!1}))}),this.on("open",function(t){e._updateResultList(t.msg,t.fighters),e._resize()}),this.on("close",function(){p.closeNotifications(),e._reset()})}function o(e){return e.id&&e.id===window.gui.playerData.id}function s(){var e=this.getMorePointsMsg,t=new f("div",{className:"getBonusPack"});t.createChild("div",{className:"msg",text:e});var i=t.appendChild(new A({className:["getPackBtn","greenButton"]}));i.createChild("div",{className:"text",text:b("tablet.shop.getBonusPack")}),i.createChild("div",{className:"icon"}),i.on("tap",function(){_.open("market",{tabId:"shop",tabParams:{category:"bonuspack"}})}),p.showClosableNotification(t,this)}i(879);var a,r,l=i(337).addTooltip,c=i(247),d=i(167),u=i(166).dimensions,h=i(172).inherits,p=i(546),m=i(541),f=i(321),g=i(880),_=i(194),v=i(771),y=i(461).getItems,b=i(29).getText,M=i(417),w=i(339),T=i(737),C=i(539),A=i(335),I={0:29099,2:29098},S=5,E=80;h(n,m),e.exports=n,n.prototype.addChallenge=function(e,t,i,n,o,s){function a(){c.clearContent(),c.createChild("div",{className:"challengeName",text:i}),c.createChild("div",{className:"challengeDesc",text:n}),c.createChild("div",{className:"challengeLoot",text:b("ui.common.loot")+" +"+o+"%"}),c.createChild("div",{className:"challengeXp",text:b("ui.common.xp")+" +"+s+"%"});var e=c.createChild("div",{className:"challengeStatus"});return t?(e.addClassNames("success"),e.setText(b("ui.fight.challenge.complete"))):(e.addClassNames("fail"),e.setText(b("ui.fight.challenge.failed"))),c}var r=this.block3.createChild("div",{className:["challenge",t?"success":"fail"]});r.setStyle("backgroundImage",e);var c=new f("div",{className:"challengeDetails",name:"challengeDetails"});l(r,a)},n.prototype._updateResultList=function(e,t){var i=w.durationToString(e.duration/1e3),n=" ("+b("ui.fight.turnCount",window.gui.fightManager.getTurnCount()+1)+")";this.duration.setText(i+n),this.ageBonus=e.ageBonus||0,this.starCounter.setValue(e.ageBonus);var o=window.gui.challengeIndicator.iconDetailsListByChallengeId;for(var s in o)this.addChallenge(o[s].iconUrl,o[s].success,o[s].name,o[s].description,o[s].dropBonus,o[s].xpBonus);w.sortObjectInArray(e.results,"outcome",!0);for(var l,d,u,h=[],p=[],m=0;m<e.results.length;m+=1)if(l=e.results[m],d=l.id,u=l.outcome,u!==v.RESULT_DEFENDER_GROUP){if(d===window.gui.playerData.id){this.outcomeSummary.setText(r[u]||"");var f=I[u];f&&c.playSound("ui",f)}h[u]||(p.push({outcome:u,name:a[u]}),h[u]=!0);var g=t[d].name;p.push({id:l.id,outcome:l.alive?"":"dead",name:g,level:l.level||t[l.id].level,additional:l.additional,kamas:w.intToString(l.rewards.kamas),drops:l.rewards.objects})}else console.warn("Hardcode loots not handled (skipped)",l.rewards);this.table.addList(p)},n.prototype._resize=function(){var e=this.table,t=e.rows.rootElement.offsetHeight,i=e.header.rootElement.offsetHeight,n=123,o=Math.round(u.windowFullScreenHeight*E/100),s=t+i+n;s=s<o?s:o,_.positionWindow(this.id,{left:"c",top:"c",width:this.position.width,height:s}),e.scroller.refresh();var a=window.device;a&&"iOS"===a.platform&&0===a.version.indexOf("10.")&&(this.hide(),w.forceReflow(this),this.show())},n.prototype._reset=function(){this.block3.clearContent(),this.table.clearContent()}},function(e,t){},function(e,t,i){function n(e){e=e||{},this.isVertical=e.vertical||!1,this.pixelValue=1/p,this.hasTriedToGetPixelValue=!1,this.shouldGetPixelValue=!1,this.mustRecompute=!1,c.call(this,"div",{className:"ProgressBarMultiple",name:e.name}),this.barBg=this.createChild("div",{className:"barBg"}),this.currentValues=[],this.previousValues=[],this.colorBars=[],this.maskSizes=[];for(var t=e.valueClassNames||[""],i=t.length-1;i>=0;i--)this.currentValues[i]=this.previousValues[i]=0,this.colorBars[i]=this._newColorBar(t[i]);e.tooltip&&(this.tooltipText=e.tooltip,r.addTooltip(this,this._tooltipHandler.bind(this))),this.on("destroy",function(){this.tweener&&this.tweener.cancel(),this.colorBars=null})}i(881);var o=i(29).getText,s=i(339),a=i(172).inherits,r=i(337),l=i(196),c=i(321),d=0,u=2,h=4,p=100,m="webkitMaskSize";a(n,c),e.exports=n,n.prototype._newColorBar=function(e){var t=this.createChild("div",{className:"barFill"});return this.isVertical&&t.addClassNames("vertical"),t.createChild("div",{className:["barColor",e]}),t},n.prototype.setValue=function(e,t,i){this.maxValue=t,this._setGaugeLogicalValue(d,e,i),this._computeGaugePhysicalValue(d),this.shouldGetPixelValue?this._tryAndGetPixelValue(this._refresh):this._refresh()},n.prototype._setGaugeLogicalValue=function(e,t,i){this.maxValue?(e===d&&(this.humanValue=t),void 0!==i?t=i:t/=this.maxValue):e===d&&(this.humanValue=Math.round(100*t)),this.currentValues[e]=t},n.prototype._computeGaugePhysicalValue=function(e){var t=this.currentValues[e],i=e?this.currentValues[e-1]:0,n=u*this.pixelValue,o=t>i&&t-i<n,s=t<1&&1-t<n;!o&&!s||this.hasTriedToGetPixelValue||(this.shouldGetPixelValue=!0);var a;if(o){var r=u+(0===i?h:0);a="calc("+Math.round(100*i)+"% + "+r+"px)"}else a=s?"calc(100% - "+(u+h)+"px)":Math.round(100*t)+"%";this.maskSizes[e]=a},n.prototype._tryAndGetPixelValue=function(e){this.shouldGetPixelValue=!1,window.setTimeout(function(t){if(t.colorBars){var i=t.colorBars[0].rootElement,n=t.isVertical?i.offsetHeight:i.offsetWidth;0!==n&&(t.pixelValue=1/n,t.mustRecompute=!0),t.hasTriedToGetPixelValue=!0,e.call(t)}},50,this)},n.prototype._getMaskSizeStyle=function(e){return"0%"===e&&(e="1px"),this.isVertical?"100% "+e:e+" 100%"},n.prototype._setColorBarPos=function(e,t){e.setStyle(m,this._getMaskSizeStyle(t))},n.prototype._tooltipHandler=function(){var e=this.tooltipText+o("ui.common.colon");return this.maxValue?e+this.humanValue+" / "+this.maxValue:e+this.humanValue+"%"},n.prototype.setValues=function(e){for(var t=0;t<this.colorBars.length;t++)this._setGaugeLogicalValue(t,Math.max(Math.min(e[t]||0,1),0)),this._computeGaugePhysicalValue(t);this.shouldGetPixelValue?this._tryAndGetPixelValue(this._refresh):this._refresh()},n.prototype._recompute=function(){for(var e=0;e<this.colorBars.length;e++)this._computeGaugePhysicalValue(e);this.mustRecompute=!1},n.prototype._refresh=function(){this.mustRecompute&&this._recompute();for(var e=0;e<this.colorBars.length;e++)this._setColorBarPos(this.colorBars[e],this.maskSizes[e]),this.previousValues[e]=this.currentValues[e]},n.prototype.setValuesWithAnimation=function(e,t,i){this.animTimeInMs=t;for(var n=0;n<this.colorBars.length;n++)this._setGaugeLogicalValue(n,Math.max(Math.min(e[n]||0,1),0)),this._computeGaugePhysicalValue(n);if(this.shouldGetPixelValue){var o=this;return this._tryAndGetPixelValue(function(){o._recompute(),o._startAnim(i)})}this._startAnim(i)},n.prototype._startAnim=function(e){this.currentAnimBarIndex=0,this.nextAnimFunc=this.nextAnimFunc||this._startNextAnim.bind(this),this.endAnimCb=e,this._startNextAnim()},n.prototype._startNextAnim=function(){if(this.colorBars){var e=this.currentAnimBarIndex;this.currentAnimBarIndex++;var t=this.colorBars[e],i=this.maskSizes[e],n=e===this.currentValues.length-1?this.endAnimCb:this.nextAnimFunc,o=e>=1?this.currentValues[e-1]:0,a=Math.max(this.previousValues[e],o),r=this.currentValues[e],c=this.previousValues[e];this.previousValues[e]=r;var d=~~(Math.abs(r-a)*this.animTimeInMs);if(d<15)return this._setColorBarPos(t,i),n&&n();a!==c&&(this._setColorBarPos(t,Math.round(100*a)+"%"),s.forceReflow(t));var u={};u[m]=this._getMaskSizeStyle(i),this.tweener=l.tween(t,u,{time:d,easing:"linear"},n)}}},function(e,t){},function(e,t,i){function n(){function e(e,t){var i="gfx/heads/SmallHead_"+e.breed+(e.sex?1:0)+".png";t.setStyle("backgroundImage","none"),v.preloadImage(i,function(e){t.rootElement&&t.setStyle("backgroundImage",e)})}function t(e,t){var i="";if(t.teamSide>=0)switch(t.teamSide){case r.ALIGNMENT_NEUTRAL:i+="Neutre";break;case r.ALIGNMENT_ANGEL:i+="Bonta";break;case r.ALIGNMENT_EVIL:i+="Brakmar";break;case r.ALIGNMENT_MERCENARY:i+="Seriane"}else switch(t.teamTypeId){case f.TEAM_TYPE_MONSTER:i+="Monstre";break;case f.TEAM_TYPE_TAXCOLLECTOR:i+="Perco";break;default:i+="Neutre"}i+=0===t.teamId?"G":"D",i="gfx/illusUi/fightersType/spectator_tx_Picto"+i+".png",v.preloadImage(i,function(t){e.rootElement&&e.setStyle("backgroundImage",t)})}function i(){for(var e=U.fightListTable.getRows(),t=0;t<e.length;t+=1)e[t].durationTimeoutId&&clearTimeout(e[t].durationTimeoutId)}function n(e,t){var i=e.getChild("duration");if(!t)return i.setText("-");var o=~~(Date.now()/1e3)-t,s=p.durationToString(o),a=s.split(":"),r=a[0]+":"+a[1];i.setText(r);var l=~~o%60,c=60-l;e.durationTimeoutId=setTimeout(function(){n(e,t)},1e3*(c+1))}function o(e){for(var t=U.fightListTable.getRows(),i=0;i<t.length;i+=1){var n=t[i].fight||{};if(e===n.fightId)return i}}function y(e){var t=o(e);return U.fightListTable.getRow(t)}function b(e,i){var n=e.createChild("div",{className:"nbPlayers"});n.createChild("div",{className:"num",text:i.teamMembersCount});var o=new s("div",{className:"fighterTypeIcon"});0===i.teamId?n.insertAsFirstChild(o):n.appendChild(o),t(o,i)}function M(e,t){var i=new s("div",{className:"relation"});return i.addClassNames(e),a(i,t),i}function w(e){var t=e.fightTeams[0],i=e.fightTeams[1],n="",o=e.fightType,r="";o===d.FIGHT_TYPE_PVP_ARENA?(n+=" fightType1",r+=h("ui.common.koliseum")):o===d.FIGHT_TYPE_CHALLENGE?(n+=" fightType2",r+=h("ui.fight.challenge")):o===d.FIGHT_TYPE_AGRESSION?(n+=" fightType3",r+=h("ui.alert.event.11")):o===d.FIGHT_TYPE_PvT&&(n+=" fightType3",r+=h("ui.spectator.taxcollectorAttack"));var l=("nbPlayersLine"+n).split(" "),c=new s("div",{className:l});b(c,t),b(c,i),r&&a(c,r);var u,p=t.meanLevel*t.teamMembersCount+i.meanLevel*i.teamMembersCount,m=Math.round(p/(t.teamMembersCount+i.teamMembersCount));t.hasGroupMember||i.hasGroupMember?u=M("relation1",h("ui.spectator.isGroup")):t.hasFriend||i.hasFriend?u=M("relation2",h("ui.spectator.isFriend")):(t.hasGuildMember||i.hasGuildMember)&&(u=M("relation3",h("ui.spectator.isGuild")));var f=new s("div",{className:"spectatorLocked",name:"spectatorLocked"});return f.toggleDisplay(e.fightSpectatorLocked),{spectatorLocked:f,nbPlayers:c,level:m,duration:new s("div",{name:"duration"}),friend:u||""}}function T(t,i){var n;i.breed>0&&(n=new s("div",{className:"classIcon"}),e(i,n));var o=i.enrichData.name,a=i.id,r={playerName:o,playerId:a};t.table.addRow({name:o,"class":n||"",level:i.level},r)}function C(e){var t=new s("div",{className:["option","option"+e],hidden:!0}),i="";return e===c.FIGHT_OPTION_SET_TO_PARTY_ONLY?i=h("ui.fight.option.blockJoinerExceptParty"):e===c.FIGHT_OPTION_SET_CLOSED?i=h("ui.fight.option.blockJoiner"):e===c.FIGHT_OPTION_ASK_FOR_HELP&&(i=h("ui.fight.option.help")),i&&a(t,i),t}function A(e,t,i){function n(e){if(e.playerId){var t={playerName:e.playerName,playerId:e.playerId};window.gui.openContextualMenu("player",t)}}var o=new s("div",{className:t}),a=o.createChild("div",{className:"colTop"}),r=a.createChild("div",{className:"titleContainer"});r.createChild("div",{className:"title",
text:i});var c=r.createChild("div",{className:"gameFightOptions"});o.gameFightOptions={};for(var d=0;d<Y.length;d+=1){var u=Y[d],p=C(u);c.appendChild(p),o.gameFightOptions[u]=p}o.averageLevelContainer=a.createChild("div",{className:"averageLevelContainer"});var f=h("ui.common.averageLevel")+h("ui.common.colon");return o.averageLevelContainer.createChild("span",{text:f}),o.averageLevel=o.averageLevelContainer.createChild("span",{className:"averageLevel"}),o.table=o.appendChild(new m({colIds:["name","class","level"],colCount:3,highlightable:!0,disableAutoSelect:!0,headerContent:[h("ui.common.name"),h("ui.charcrea.breed"),h("ui.common.short.level")],onRowTap:n})),o.joinBtn=o.appendChild(new l(h("ui.common.join"))),o.joinBtn.on("tap",function(){if(G&&G.fightId){var e=G.fightTeams[o.teamId].leaderId;window.dofus.sendMessage("GameFightJoinRequestMessage",{fightId:G.fightId,fighterId:e}),_.close(U.id)}}),o.teamId=e,o}function I(e){var t=e.gameFightOptions;for(var i in t)R(e.teamId,i,!1)}function S(){i(),U.fightListTable.clearContent()}function E(){U.col1.table.clearContent(),U.col1.averageLevelContainer.hide(),U.col2.table.clearContent(),U.col2.averageLevelContainer.hide(),I(U.col1),I(U.col2)}function x(){U.col1.joinBtn.disable(),U.col2.joinBtn.disable(),U.buttonSpectate.disable()}function N(){G=null,S(),E(),x()}function L(e){var t=e.joinBtn;if(!G)return void t.disable();var i=e.teamId,n=G.fightTeamsOptions[i]||{},o=n.isClosed,s=(i+1)%2,a=G.fightTeams[i]||{},r=G.fightTeams[s]||{},l=o||G.fightStart||a.teamTypeId===f.TEAM_TYPE_MONSTER||a.teamTypeId===f.TEAM_TYPE_TAXCOLLECTOR&&!a.hasMyTaxCollector||r.teamTypeId===f.TEAM_TYPE_TAXCOLLECTOR&&r.hasMyTaxCollector;l?t.disable():t.enable()}function O(){var e=window.gui.playerData.identification.hasRights;!e&&G&&G.fightSpectatorLocked?U.buttonSpectate.disable():U.buttonSpectate.enable()}function D(){L(U.col1),L(U.col2),O()}function R(e,t,i){if(t){var n=U["col"+(e+1)],o=n.gameFightOptions[t];o&&n&&o.toggleDisplay(i)}}function P(e,t,i){if(G)for(var n in j)if(j[n]===t){var o=G.fightTeamsOptions[e];o[n]=i;break}}function B(e){var t=o(e.fightId);if(t>=0){var i=U.fightListTable.getRow(t);i.fight.fightSpectatorLocked=e.state;var n=U.fightListTable.getCol(t,"spectatorLocked"),s=n.getChild("spectatorLocked");s.toggleDisplay(e.state)}}function k(e){0===e.option&&B(e),G&&G.fightId===e.fightId&&(P(e.teamId,e.option,e.state),R(e.teamId,e.option,e.state),D())}function z(e,t){if(t=t||[],e.table.clearContent(),e.averageLevelContainer.toggleDisplay(!!t.length),I(e),t.length){var i=e.teamId,n=G.fightTeamsOptions[i];for(var o in n)if(j.hasOwnProperty(o)){var s=j[o],a=n[o];R(i,s,a)}for(var r=0,l=t.length,c=0;c<l;c++){var d=t[c];T(e,d),r+=d.level}e.averageLevel.setText(Math.round(r/l))}}function F(e){e=e||{},z(U.col1,e.attackers),z(U.col2,e.defenders)}function H(e){e=e||{};var t=e.fights||[];if(t.length<1)return void N();i();var s,a,r,l=U.fightListTable.getRows(),c=[];l.forEach(function(e){c.push(e.fight.fightId)});var d=[];for(t.forEach(function(e){d.push(e.fightId)}),s=0;s<c.length;s+=1){var u=c[s];d.indexOf(u)<0&&(r=o(u),U.fightListTable.delRow(r))}for(s=0;s<t.length;s++){var h=t[s],p=w(h);r=o(h.fightId),a=r>=0?U.fightListTable.updateRow(r,p,{fight:h}):U.fightListTable.addRow(p,{fight:h}),n(a,h.fightStart)}if(G&&G.fightId){var m=y(G.fightId);if(m)return void m.tap()}var f=U.fightListTable.getRows()[0];f.tap()}function q(){window.dofus.sendMessage("MapRunningFightDetailsRequestMessage",{fightId:G.fightId})}function W(){window.dofus.sendMessage("MapRunningFightListRequestMessage")}var U=this;g.call(this,{className:"FightListWindow",title:h("ui.spectator.fightList"),positionInfo:{left:"c",top:"c",width:"680px",height:"96%",maxHeight:630}});var G,j=u.FIGHT_OPTION_KEY_TO_ENUM,Y=u.FIGHT_OPTION_ICON_ID;this.once("open",function(){this.fightListTable=this.windowBody.appendChild(new m({colIds:["spectatorLocked","nbPlayers","level","duration","friend"],colCount:4,highlightable:!0,disableAutoSelect:!0,headerContent:["",h("ui.common.numberOfPlayers"),h("ui.common.level"),h("ui.fightend.duration"),h("ui.common.friends")],onRowTap:function(e){G=e.fight,q()}})),this.fightListTable.addClassNames("fightListTable");var e=this.windowBody.createChild("div",{className:"colsWrapper"});this.col1=A(0,["colTeam","col1"],h("ui.common.attackers")),this.col2=A(1,["colTeam","col2"],h("ui.common.defenders")),e.appendChild(this.col1),e.appendChild(this.col2),this.buttonSpectate=new l(h("ui.common.tospectate"),{className:"buttonSpectate"}),this.buttonSpectate.on("tap",function(){G&&G.fightId&&(window.dofus.sendMessage("GameFightJoinRequestMessage",{fightId:G.fightId,fighterId:0}),_.close(U.id))}),this.windowBody.appendChild(this.buttonSpectate)}),this.on("open",function(){N(),W()}),this.on("close",function(){window.dofus.sendMessage("StopToListenRunningFightRequestMessage")});var V=window.gui;V.on("MapFightCountMessage",function(){U.isVisible()&&W()}),V.on("MapRunningFightListMessage",H),V.on("MapRunningFightDetailsMessage",function(e){F(e),D()}),V.on("GameRolePlayRemoveChallengeMessage",function(){U.isVisible()&&W()}),V.on("GameFightOptionStateUpdateMessage",function(e){U.isVisible()&&k(e)}),V.playerData.position.on("mapChanged",function(){_.close(U.id)})}i(883);var o=i(172).inherits,s=i(321),a=i(337).addTooltip,r=i(425),l=i(335).DofusButton,c=i(349),d=i(666),u=i(347),h=i(29).getText,p=i(339),m=i(649),f=i(884),g=i(541),_=i(194),v=i(182);o(n,g),e.exports=n},function(e,t){},function(e,t){e.exports={TEAM_TYPE_PLAYER:0,TEAM_TYPE_MONSTER:1,TEAM_TYPE_MUTANT:2,TEAM_TYPE_TAXCOLLECTOR:3,TEAM_TYPE_BAD_PLAYER:4}},function(e,t,i){function n(){a.call(this,{className:"globalWindow",title:c("ui.common.mainMenu"),positionInfo:{left:"c",top:"c",width:300,height:235}}),this.once("open",function(){this._createContent()}),this.on("open",function(){this._buildVersion.setText(window.gui.getBuildVersion()),this._setupCharacterChange()})}i(886);var o=i(172).inherits,s=i(204),a=i(541),r=i(194),l=i(335).DofusButton,c=i(29).getText,d=i(532),u=i(601);o(n,a),e.exports=n,n.prototype._createContent=function(){this.buttonOptions=this.windowBody.appendChild(new l(c("ui.common.options"))),this.buttonOptions.on("tap",function(){r.close("global"),r.open("options")}),this.container=this.windowBody.createChild("div",{className:"container"}),this.multiCharacterSelector=new d({className:"multiCharacterSelector"}),this.container.appendChild(this.multiCharacterSelector),this.multiCharacterSelector.on("change",function(e){s.reconnectByCharId(e),r.close("global")}),this.buttonChangeCharacter=this.container.appendChild(new l(c("ui.common.changeCharacter"),{className:"changeCharacterButton"})),this.buttonChangeCharacter.on("tap",function(){window.gui.openConfirmPopup({title:c("ui.common.confirm"),message:c("ui.common.confirmChangeCharacter"),cb:function(e){e&&(r.close("global"),s.goBackToSelectionOf("character"))}})}),this.buttonDisconnect=this.windowBody.appendChild(new l(c("ui.common.disconnect"))),this.buttonDisconnect.on("tap",function(){window.gui.openConfirmPopup({title:c("ui.common.confirm"),message:c("ui.common.confirmDisconnect"),cb:function(e){e&&(r.close("global"),window.dofus.disconnect())}})}),this.buttonReturnToGame=this.windowBody.appendChild(new l(c("ui.common.returnToGame"))),this.buttonReturnToGame.on("tap",function(){r.close("global")}),this._buildVersion=this.windowBody.createChild("div",{className:"buildVersion"})},n.prototype._setupCharacterChange=function(){var e=u.getCharacterList(),t=window.gui.playerData.isFighting;this.buttonChangeCharacter.setEnable(!t);var i=!t&&e.length>=2;if(this.multiCharacterSelector.setEnable(i),i){var n=window.gui.databases.Breeds;this.multiCharacterSelector.clearContent();for(var o=0;o<e.length;o++){var s=e[o],a=s.name+" ("+n[s.breed].shortNameId+" "+s.level+")";this.multiCharacterSelector.addOption(a,s.id)}var r=!0;this.multiCharacterSelector.select(window.gui.playerData.id,r)}}},function(e,t){},function(e,t,i){function n(){function e(){t.setTitle(t.tabsDefinitions[this.tabId].title)}s.call(this,{className:"GrimoireWindow",positionInfo:{top:"c",left:"c+20px",width:"90%",height:"97%",maxWidth:905,maxHeight:620,mustAvoidToolbar:!0}});var t=this,i=["spells","quests","alignment","jobs","almanax","achievements","ornaments","bestiary"],n=this.tabsDefinitions={spells:{target:new m},quests:{target:new p},alignment:{target:new l},jobs:{target:new f},almanax:{target:new c},achievements:{target:new d},ornaments:{target:new h},bestiary:{target:new u}},o=this.windowBody;this.tabs=o.appendChild(new r);for(var a=0;a<i.length;a+=1){var g=i[a],_=n[g],v=o.appendChild(_.target);v.tabId=g,this.tabs.addTab("",v,g),v.on("open",e)}this._initTabs(),this.on("open",function(e){this.tabs.openTab(e.tabId,e.tabParams,{delayOpenedEvent:!0,forceOpen:!0})}),this.on("opened",function(){this.tabs.emitOnCurrentTab("opened")}),this.on("focus",function(){this.tabs.emitOnCurrentTab("focus")}),this.on("close",function(){this._resetTabs()}),window.gui.uiLocker.on("updated",function(e){if("grimoire"===e.windowId&&e.tabId)return n[e.tabId]?void t.tabs.toggleTabAvailability(e.tabId,!e.locked):console.error(new Error("Unknown tab id `"+e.tabId+"` in grimoire window."))}),window.gui.on("disconnect",function(){t._resetTabs(),t._initTabs()})}i(888);var o=i(172).inherits,s=i(541),a=i(29).getText,r=i(889),l=i(891),c=i(893),d=i(895),u=i(899),h=i(901),p=i(903),m=i(906),f=i(908);o(n,s),e.exports=n,n.prototype._initTabs=function(){var e=this.tabsDefinitions;e.spells.title=a("ui.grimoire.mySpell"),e.quests.title=a("ui.common.quests"),e.alignment.title=a("ui.common.alignment"),e.jobs.title=a("ui.common.myJobs"),e.almanax.title=a("ui.almanax.almanax"),e.achievements.title=a("ui.achievement.achievement"),e.ornaments.title=a("ui.common.titles"),e.bestiary.title=a("ui.common.bestiary");for(var t in e){var i=window.gui.uiLocker.isTabAvailable("grimoire",t);this.tabs.toggleTabAvailability(t,i)}},n.prototype.getOpenedTabId=function(){return this.tabs.getCurrentTabId()},n.prototype._resetTabs=function(){this.tabs.close()}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"WindowSideTabs"}),this.delClassNames("tabs")}i(890);var o=i(172).inherits,s=i(834);o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"AlignmentWindow",name:"alignment"});var e=this;this._setupEvents(),this.once("opened",function(){e._createDom(),e._updateDisplay(),e.on("open",function(){e._updateDisplay()}),e.on("opened",function(){e.updateCharacter()})}),this.on("closed",function(){this.characterDisplay.release()})}i(892);var o=i(172).inherits,s=i(321),a=i(649),r=i(557),l=i(335).DofusButton,c=i(29).getText,d=i(369),u=i(410),h=i(337).addTooltip;o(n,s),e.exports=n,n.prototype.updateCharacter=function(){var e=window.gui.playerData.characterBaseInformations.entityLook;this.characterDisplay.setLook(e,{riderOnly:!0,direction:u.DIRECTION_SOUTH,animation:"AnimStatique",boneType:"characters/",skinType:"characters/"})},n.prototype._createDom=function(){function e(){return window.gui.playerData.isPvpAggressable()?window.gui.playerData.alignment.alignmentInfos.honor+" / "+window.gui.playerData.alignment.alignmentInfos.honorNextGradeFloor:"0"}var t=this.createChild("div",{className:"leftColumn"}),i=this.rightColumn=this.createChild("div",{className:"rightColumn"}),n=t.createChild("div",{className:"topRow"}),o=n.createChild("div",{className:"thumbnail"});this.alignmentImage=o.createChild("div",{className:"alignmentImage"}),this.characterDisplay=n.appendChild(new d({scale:2,verticalAlign:"top",horizontalAlign:"center"}));var u=new s("div",{className:"alignmentWingsWrapper"});this.characterDisplay.insertAsFirstChild(u),this.alignmentWingsContainer=u.createChild("div",{className:"alignmentWingsContainer"});var p=t.createChild("div",{className:"alignmentInfo"});this.alignmentName=p.createChild("div",{className:"title"}),this.alignmentLevel=p.createChild("div",{className:"level"});var m=t.createChild("div",{className:"pvpBox"});m.createChild("div",{className:"title",text:c("ui.pvp.pvpMode")});var f=this.pvpContainer=m.createChild("div",{className:"pvpContainer"}),g=f.createChild("div",{className:"rankContainer"});g.createChild("div",{className:"rank",text:c("ui.pvp.rank")}),this.alignmentGrade=g.createChild("div",{className:"value"});var _=f.createChild("div",{className:"progress"});_.createChild("div",{className:"text",text:c("ui.pvp.honourPoints")}),this.honorPoints=_.appendChild(new r({className:"yellow"})),h(this.honorPoints,e),f.createChild("div",{className:"text"}),f.appendChild(new a({className:"balance",headerContent:[c("ui.pvp.alignedAreaModificators")],colIds:["modifier"]})),this.pvpButton=m.appendChild(new l(c("ui.pvp.enabled",{className:"pvpButton"}))),this.pvpButton.on("tap",function(){window.dofus.sendMessage("SetEnablePVPRequestMessage",{enable:!window.gui.playerData.isPvpAggressable()})});var v=i.createChild("div",{className:"headerRow"});this.icon=v.createChild("div",{className:["icon","image"]}),this.title=v.createChild("div",{className:"title"}),this.specialisations=i.appendChild(new a({className:"specialisations",headerContent:[c("ui.pvp.allSpecializations")],colIds:["spec","minimumAlignment"]})),i.createChild("div",{className:"arrow"}),i.appendChild(new a({className:"abilities",headerContent:[c("ui.common.feats")],colIds:["ability"]}))},n.prototype._displayPvpInformations=function(){var e=this,t=window.gui.playerData.alignment,i=window.gui.playerData.isPvpAggressable();i?(this.pvpButton.setText(c("ui.pvp.disabled")),this.pvpContainer.delClassNames("disabled"),t.getTopWings(t.alignmentInfos,function(t){e.alignmentWingsContainer.setStyles({backgroundImage:t.backgroundImage,left:t.left,top:t.top,width:t.width,height:t.height})}),this.alignmentGrade.setText(t.getAlignmentGradeString()),this.honorPoints.setValue(t.getHonor())):(this.pvpButton.setText(c("ui.pvp.enabled")),this.pvpContainer.addClassNames("disabled"),this.alignmentWingsContainer.setStyle("backgroundImage","none"),this.alignmentGrade.setText("-"),this.honorPoints.setValue(0))},n.prototype._displaySpecialisations=function(e){var t=window.gui.playerData.alignment,i=t.alignmentInfos;if(this.specialisations.clearContent(),0!==i.alignmentSide)for(var n=0;n<t.alignmentRanks.length;n++){var o=t.alignmentRanks[n];o.orderId===e&&this.specialisations.addRow([o.nameId,o.minimumAlignment])}},n.prototype._updateDisplay=function(){var e=window.gui.playerData.alignment,t=e.alignmentInfos;if(this.characterDisplay){var i=this;0===t.alignmentSide?(this.rightColumn.addClassNames("disabled"),this.pvpButton.hide()):(this.rightColumn.delClassNames("disabled"),this.pvpButton.show()),this._displayPvpInformations();var n=e.getNameId();i.alignmentName.setText(c("ui.common.alignment")+" "+n),e.getRank(function(n,o){return n?console.error("Failed to get alignment rank",n):(i.alignmentLevel.setText(o.nameId+" - "+c("ui.common.level")+" "+t.alignmentValue),i._displaySpecialisations(o.orderId),void e.getOrder(o,function(t,n){return t?console.error("Failed to get AlignmentOrder",t):(i.title.setText(n.nameId),e.getAlignmentImageUrl(function(e){i.alignmentImage.setStyle("backgroundImage",e)}),void e.getOrderImageUrl(n.id,function(e){i.icon.setStyle("backgroundImage",e)}))}))})}},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=window.gui.playerData.alignment;i.on("alignmentChanged",function(){e._updateDisplay()}),t.playerData.on("lookUpdate",function(){e.characterDisplay&&e.updateCharacter()})}},function(e,t){},function(e,t,i){function n(){r.call(this,"div",{className:"AlmanaxWindow",name:"almanax"}),this._calendarDate=-1,this.lastUpdate=0,this.isRefreshPending=!1;var e=window.dofus.connectionManager,t=this;this.on("open",this._refreshIfNeeded),e.on("_AlmanaxDataErrorMessage",function(){t._handleError()}),e.on("_AlmanaxDataMessage",function(e){var i=window.gui.databases.AlmanaxCalendars[t._calendarDate],n=i.npcId;g.getData("Npcs",n,function(i,o){return i?console.warn("AlmanaxWindow getNpcData for npcId:",n,"error:",i):(e.meryde=o,t._setDefaultData(e),t.lastUpdate=(new Date).getUTCDate(),t._createContent(),t._updateQuestProgress(),t._updateAlmanaxData(e),t.delClassNames("spinner"),void(t.isRefreshPending=!1))})}),e.on("AlmanachCalendarDateMessage",function(e){t._calendarDate=e.date,t._showAlmanaxNotification(e.date,e._merydeName)})}i(894);var o=i(172).inherits,s=i(557),a=i(335),r=i(321),l=i(339),c=i(337),d=c.addTooltip,u=c.enableTooltip,h=i(29).getText,p=i(461),m=i(615),f=i(614),g=i(30),_=i(182),v=i(194),y=i(176),b=365,M=954,w=-4,T=-24,C=13344,A=13345;o(n,r),e.exports=n,n.prototype._refreshIfNeeded=function(){var e=(new Date).getUTCDate();return e===this.lastUpdate?this._updateQuestProgress():void(this.isRefreshPending||(this.isRefreshPending=!0,this.clearContent(),this.addClassNames("spinner"),window.dofus.send("almanaxDataRequest")))},n.prototype._handleError=function(){this._createRetryButton(),this.delClassNames("spinner"),this.isRefreshPending=!1},n.prototype._createRetryButton=function(){var e=this.createChild("div",{className:"failureBox"});e.createChild("div",{text:h("ui.common.error")+"..."});var t=e.appendChild(new a({className:"greenButton",text:h("tablet.common.retry")})),i=this;t.on("tap",function(){i._refreshIfNeeded()})},n.prototype._createContent=function(){var e=this.createChild("div",{className:"col1"}),t=e.createChild("div",{className:"dateBlock"});this.monthText=t.createChild("div",{className:"monthText"});var i=t.createChild("div",{className:"dayBg"});this.dayNumber=i.createChild("div",{className:"dayNumber"}),this.yearText=t.createChild("div",{className:"yearText"});var n=t.createChild("div",{className:"illusWrapper"});this.astro=n.createChild("div",{className:"smallIllus"}),this.monthGod=n.createChild("div",{className:"smallIllus"});var o=t.createChild("div",{className:"bottomIllusWrapper"});this.bottomIllus=o.createChild("div",{className:"bottomIllus"}),this.linkToCalendar=e.appendChild(f.newExternalLink(h("ui.almanax.link"),h("ui.almanax.calendar")));var l,c=this.createChild("div",{className:"col2"});l=c.createChild("div");var u=l.createChild("div",{className:["block","saintBlock"]}),g=u.createChild("div",{className:"saintBg"});this.merydeIllus=g.createChild("div",{className:"saintIllus"}),this.merydeTitle=u.createChild("div",{className:"title"}),this.merydeDesc=u.createChild("div",{className:"description"}),this.instructionText=u.createChild("div",{className:"instructionText"}),l=c.createChild("div");var _=l.createChild("div",{className:["block","bonusBlock"]});_.createChild("div",{className:["smallIllus","bonusIllus"]}),this.bonusTitle=_.createChild("div",{className:"title"}),this.bonusDesc=_.createChild("div",{className:"description"}),l=c.createChild("div");var v=l.createChild("div",{className:["block","questBlock"]}),y=v.createChild("div",{className:"questContent"}),b=y.createChild("div",{className:"dolmanaxBg"}),M=b.createChild("div",{className:"dolmanaxIllus"});p.getItems([C],function(e){return e?console.error(e):void M.setStyle("backgroundImage",p.items[C].image)}),y.createChild("div",{className:"title",text:h("ui.almanax.dolmanaxQuest")}),this.questDesc=y.createChild("div",{className:"description"});var A=y.createChild("div",{className:"buttonContainer"});this.locateButton=A.createChild("div",{className:"locateButton"});var I=A.appendChild(new a({className:"greenButton",text:h("ui.almanax.localizeSanctuary")}));I.on("tap",function(){window.gui.emit("CompassUpdateMessage",{type:m.COMPASS_TYPE_SIMPLE,worldX:w,worldY:T})});var S=y.createChild("div",{className:"progression"});this.questProgressTitle=S.createChild("div",{className:"questProgressTitle"}),this.questProgressBar=S.appendChild(new s({className:"questProgressBar"})),this.astroTooltipTx=new r("div"),d(this.astro,this.astroTooltipTx),this.monthGodTooltipTx=new r("div"),d(this.monthGod,this.monthGodTooltipTx),this.merydeTootipTx=new r("div"),d(this.merydeIllus,this.merydeTootipTx),this.questTooltipTx=new r("div"),d(this.questProgressBar,this.questTooltipTx),d(this.linkToCalendar,h("ui.almanax.goToWebsite"))},n.prototype._setDefaultData=function(e){function t(e){return e&&"false"!==e}var i=e.event,n=e.zodiac,o=e.month,s=["gfx/almanax/jour.jpg","gfx/almanax/protecteur.jpg","gfx/almanax/constellation.jpg"];_.preloadImageUrls(s,function(e){t(i.imageurl)||(i.bossText=i.bossText||h("ui.almanax.default.boss"),i.ephemeris=i.ephemeris||h("ui.almanax.default.ephemeris"),i.imageurl=i.imageurl||e[0]),t(o.protectorimageurl)||(o.protectorDescription=o.protectorDescription||h("ui.almanax.default.protector"),o.protectorimageurl=o.protectorimageurl||e[1]),t(n.imageurl)||(n.description=n.description||h("ui.almanax.default.zodiac"),n.imageurl=n.imageurl||e[2])})},n.prototype._updateAlmanaxData=function(e){var t=window.gui.databases.AlmanaxCalendars[this._calendarDate],i=l.getAlmanaxDate();this.dayNumber.setText(i.day),this.monthText.setText(i.monthName),this.yearText.setText(h("ui.common.year",i.year));var n=e.event,o=e.zodiac,s=e.month,a=e.meryde;this.astro.setStyle("backgroundImage","url("+o.imageurl+")"),this.monthGod.setStyle("backgroundImage","url("+s.protectorimageurl+")"),this.bottomIllus.setStyle("backgroundImage","url("+n.imageurl+")"),this.merydeTitle.setText(h("ui.almanax.dayMeryde",a.nameId)),this.merydeDesc.setText(n.ephemeris),this.instructionText.setText(h("ui.almanax.offeringTo",a.nameId)),this.bonusTitle.setText(h("ui.almanax.dayBonus")+h("ui.common.colon")+t.nameId),this.bonusDesc.setHtml(t.descId),this.merydeIllus.setStyle("backgroundImage","url("+n.bossimageurl+")"),this.astroTooltipTx.setText(o.description),u(this.astro,!!o.description),this.monthGodTooltipTx.setText(s.protectordesc),u(this.monthGod,!!s.protectordesc),this.merydeTootipTx.setText(n.bosstext),u(this.merydeIllus,!!n.bosstext)},n.prototype._updateQuestProgress=function(){if(window.gui.playerData.quests.finished[M])return this.questDesc.setText(h("ui.almanax.dolmanaxQuestDone")),this.questProgressTitle.setText(h("ui.almanax.questDone")),void this.questProgressBar.setValue(1);this.questDesc.setText(h("ui.almanax.dolmanaxQuestDesc")),this.questProgressTitle.setText(h("ui.almanax.questProgress"));var e=window.gui.playerData.inventory.quantityList[A]||0,t=Math.min(e,b);this.questProgressBar.setValue(t/b),this.questTooltipTx.setText(h("ui.almanax.calendarSheetsCollected",t,b))},n.prototype._showAlmanaxNotification=function(e,t){if(y.getValue("almanaxLastNotif")!==e){y.setValue("almanaxLastNotif",e);var i=l.getAlmanaxDate(),n=window.gui.notificationBar;n.newNotification("almanax",{type:n.notificationType.INVITATION,title:i.day+" "+i.monthName+" "+i.year,text:h("ui.almanax.offeringTo",t),buttons:[{label:h("ui.almanax.almanax"),action:function(){v.open("grimoire",{tabId:"almanax"})}}]})}}},function(e,t){},function(e,t,i){function n(){var e=this;r.call(this,"div",{className:"AchievementsWindow",name:"achievements"}),this.achievementToOpen=null,this.achievementDataFromServer=null,this._createMinimumContent(),e.setupSocketEvents(),this.once("opened",function(){this._createRemainingContent(function(){e.setupListUpdateEvents(),e.selectFirstTab(),e.on("open",function(){e.selectFirstTab()})})}),window.gui.on("disconnect",function(){e.achievementsList&&e.achievementsList.empty()})}function o(e,t){function i(e,t,i,n,o,s){var a=[],r={},c=[],d=t.length,u=0;l.getDataMap(e,t,function(e,l){function h(e){return a.length!==e.length?console.error("AchievementsWindow: Missing rewards data or images"):(c=a.map(function(t,i){var n=r[t]||{};return{url:e[i],quantity:n.quantity,data:n.data}}),s(null,c))}if(e)return s(e);if(u===d)return s(null,c);for(var p,m,f=0;f<t.length;f+=1){p=t[f],m=l[p];var _=null!==n?i+"/"+m[n]+".png":i,v=o[f];if(r[_]={data:m,quantity:v||null},a.push(_),u+=1,u===d)return g.preloadImages(a,h)}})}var n=[];if(!e.rewardIds.length)return t(null,n);var o=e.rewardIds;l.getDataMap("AchievementRewards",o,function(e,s){function a(e,i){if(!p){if(e)return p=!0,t(e);n=n.concat(i),d+=i.length,u+=1,d===c&&u===h.length&&t(null,n)}}if(e)return t(e);for(var r,l,c=0,d=0,u=0,h=["Ornaments","Items","Spells","Titles"],p=!1,m=0;m<o.length;m+=1)r=o[m],l=s[r],l?(c+=l.itemsReward.length+l.ornamentsReward.length+l.spellsReward.length+l.titlesReward.length,i(h[0],l.ornamentsReward,"gfx/ornaments","iconId",[],a),i(h[1],l.itemsReward,"gfx/items","iconId",l.itemsQuantityReward,a),i(h[2],l.spellsReward,"gfx/spells","iconId",[],a),i(h[3],l.titlesReward,"gfx/illusUi/genericTitleIcon.png",null,[],a)):console.error("unable to find reward id "+r+" in AchievementRewards DB")})}function s(){window.dofus.sendMessage("AchievementRewardRequestMessage",{achievementId:this.achievementId})}i(896);var a=i(172).inherits,r=i(321),l=i(30),c=i(897),d=i(335),u=i(739),h=i(197),p=i(612),m=i(557),f=i(29).getText,g=i(182),_=i(339),v=i(544),y=i(337);a(n,r),e.exports=n,n.prototype.selectFirstTab=function(){this.categoriesList.activate(this.categoriesList.items.mainProgressBar)},n.prototype.showRightSideDisplay=function(e){this.text.hide(),"mainProgressBar"===e?(this.achievementsScroll.hide(),this.hideUnlockedCheckbox.hide(),this.summary.show()):(this.achievementsScroll.show(),this.hideUnlockedCheckbox.show(),this.summary.hide())},n.prototype.hideRightSideDisplay=function(){this.text.show(),this.achievementsScroll.hide(),this.hideUnlockedCheckbox.hide()},n.prototype._createMinimumContent=function(){},n.prototype._createRemainingContent=function(e){if(this.col1)return e();var t=this;this.col1=this.createChild("div",{className:"col1"}),this.col2=this.createChild("div",{className:"col2"}),this.categoriesScroll=this.col1.createChild("div",{className:"scroll"}),this.categoriesList=this.categoriesScroll.appendChild(new c),this.categoriesList.addClassNames("tree"),this.categoriesList.on("activate",function(e){var i=e.getWuiName();t.showRightSideDisplay(i),"mainProgressBar"!==i&&e.sublist&&e.data&&(e.sublist.show(),t.addAchievements(e.data.achievementIds))}),this.categoriesList.on("deactivate",function(e){e.sublist&&(e.sublist.hide(),e.sublist.deactivate())}),this.searchBlock=this.col2.createChild("div",{className:"searchBlock"}),this.searchBox=this.searchBlock.appendChild(new v),this.searchBox.on("search",function(){t._search()}),this.searchName=!0,this.searchObjective=!0,this.optionButton=this.searchBox.appendChild(new d({className:"optionButton",addIcon:!0},function(){window.gui.openContextualMenu("generic",{title:f("ui.search.criteria"),actions:[{caption:f("ui.common.name"),cb:function(){t.searchName=!t.searchName,t.setSearchOption("name",t.searchName)},ticked:t.searchName},{caption:f("ui.grimoire.quest.objectives"),cb:function(){t.searchObjective=!t.searchObjective,t.setSearchOption("objectives",t.searchObjective)},ticked:t.searchObjective}]})})),this.text=this.col2.createChild("div",{className:"noResult",text:f("ui.search.noResult")}),this.summary=this.col2.createChild("div",{className:"summary"}),this.achievementsScroll=this.col2.createChild("div",{className:"achievementsScroll"}),this.achievementsList=this.achievementsScroll.appendChild(new c),this.achievementsList.addClassNames("achievementsList"),this.achievementsList.on("activate",function(e){e.data.objectivesLoaded||window.dofus.sendMessage("AchievementDetailsRequestMessage",{achievementId:e.data.id}),e.more.show()}),this.achievementsList.on("deactivate",function(e){e.more.hide()}),this.hideUnlockedCheckbox=this.col2.appendChild(new p(f("ui.achievement.hideAchieved"))),this.hideUnlockedCheckbox.on("activate",function(){t.addClassNames("hideUnlocked")}),this.hideUnlockedCheckbox.on("deactivate",function(){t.delClassNames("hideUnlocked")}),this._createContentProgressBars(e)},n.prototype._createContentProgressBars=function(e){var t=this;this.banners=[];var i=new r("div",{className:["label","noPadding"]});i.createChild("div",{className:"icon"}),i.createChild("div",{className:"text",text:f("ui.achievement.synthesis")}),l.getAllDataBulk("AchievementCategories",function(n,o){if(n)return console.error("AchievementCategories error",n);o.sort(function(e,t){return e.order-t.order});var s=t.col2.rootElement.getBoundingClientRect().width;t.bannerHeight=s/8,t.total=t.summary.createChild("div",{className:"total",text:window.gui.playerData.achievements.points}),t.total.setStyles({height:s/12+"px",fontSize:.05*s+"px"}),t.addSummaryBar({id:"mainProgressBar",nameId:f("ui.tutorial.progress")}),t.categoriesList.addItem("mainProgressBar",i);var a=[],l="gfx/illusUi/illu_",d=[l+"cat_0.png"];o.forEach(function(e){if(0===e.parentId){var i=new r("div",{className:["label","noPadding"]});i.createChild("div",{className:["icon",e.icon]}),i.createChild("div",{className:"text",text:e.nameId}),d.push(l+e.icon+".png"),t.addSummaryBar(e);var n=t.categoriesList.addItem(e.id,i,e);n.sublist=n.appendChild(new c),n.sublist.addClassNames("tree"),n.sublist.hide(),n.sublist.on("activate",function(e){e.data&&t.addAchievements(e.data.achievementIds)})}else a.push(e)}),g.preloadImages(d,function(e){for(var i=0;i<t.banners.length;i+=1)t.banners[i].setStyle("backgroundImage",e[i])}),a.forEach(function(e){var i=new r("div",{className:"label",text:e.nameId});t.categoriesList.items[e.parentId].sublist.addItem(e.id,i,e)}),e()})},n.prototype.setupSocketEvents=function(){function e(e,t,n){var o=[],s=i.achievementsList.getChild(e);if(s){for(var a=s.getChild("more").getChild("progression"),r=s.getChild("more").getChild("objectives"),l=s.getChild("more").getChild("spinner"),c=0;c<t.length;c+=1){var d=t[c],u=n||d.maxValue&&d.value===d.maxValue;if(u&&o.push(d.id),1===d.maxValue)a.hide(),r.show();else{var h=u?d.maxValue:d.value;a.getChild("text").setText(h+"/"+d.maxValue),a.getChild("progressBar").setValue(h/d.maxValue),a.show(),r.hide()}}var p=s.getChild("more").getChild("objectives");for(c=0;c<o.length;c+=1){var m=p.getChild(o[c]);m&&m.addClassNames("completed")}l.hide(),s.objectivesLoaded=!0}}function t(t){var i=t.startedObjectives,n=t.finishedObjective;e(t.id,i),e(t.id,n,!0)}var i=this;window.gui.on("AchievementDetailedListMessage",function(e){var i,n=e.startedAchievements,o=e.finishedAchievements;for(i=0;i<n.length;i+=1)t(n[i]);for(i=0;i<o.length;i+=1)t(o[i])}),window.gui.on("AchievementDetailsMessage",function(e){t(e.achievement)}),window.gui.playerData.achievements.on("achievementListUpdated",function(){var e=window.gui.playerData.achievements;i.achievementDataFromServer=e,i.total&&i.total.setText(this.points)})},n.prototype.setupListUpdateEvents=function(){var e=this;window.gui.playerData.achievements.on("achievementFinished",function(t){e.total&&e.total.setText(this.points);var i=e.achievementsList.getChild(t.id);if(!i)return console.warn("Achievement not found: ",t.id);i.addClassNames("completed");var n=i.getChild("more").getChild("rewards").getChild("claimButton");n.show(),n.enable()}),window.gui.playerData.achievements.on("achievementRewardSuccess",function(t){var i=e.achievementsList.getChild(t);if(!i)return console.warn("Achievement not found: ",t);var n=i.getChild("more").getChild("rewards").getChild("claimButton");n.hide(),n.disable()})},n.prototype.addSummaryBar=function(e){var t=this,i=this.summary.createChild("div",{className:"summaryBar",name:e.id}),n=i.createChild("div",{className:"banner"});n.setStyles({height:this.bannerHeight+"px"}),this.banners.push(n),n.createChild("div",{className:"text",text:e.nameId});var o="yellow";switch(e.id){case 15:o="orange";break;case 6:o="green";break;case 3:o="blue";break;case 25:o="red";break;case 8:o="lightGreen";break;case 7:o="yellow";break;case 5:o="yellow";break;case 9:o="yellow"}return i.appendChild(new m({className:o,name:"progressBar"})),"mainProgressBar"===e.id?i.addClassNames("mainProgressBar"):(h(n),void n.on("tap",function(){t.showRightSideDisplay(e.id),t.categoriesList.activate(t.categoriesList.items[e.id])}))},n.prototype.addAchievements=function(e){if(e.length>100)return window.gui.openSimplePopup(f("tablet.ui.search.tooManyResults"));var t=this;l.getData("Achievements",e,function(e,i){if(e)return console.error("Achievements with data error",e);
i.sort(function(e,t){return e.order-t.order});var n={};t.showRightSideDisplay(),t.achievementsList.empty();for(var o=[],s=[],a={},r=0;r<i.length;r++){var c=i[r].objectiveIds;n[i[r].categoryId]=!0;for(var d=0;d<c.length;d++){var u=c[d];a[u]=!0}}a=Object.keys(a),n=Object.keys(n),l.getDataMap("AchievementObjectives",a,function(e,a){if(e)return console.error("unable to retrieve data from AchievementObjectives",e);1===n.length&&window.dofus.sendMessage("AchievementDetailedListRequestMessage",{categoryId:n[0]});for(var r=0;r<i.length;r++)o.push("gfx/achievements/"+i[r].iconId+".png"),s.push(t.addAchievement(i[r],a));null!==t.achievementToOpen&&void 0!==t.achievementsList.items[t.achievementToOpen]&&(t.isCompleted(t.achievementToOpen)&&t.hideUnlockedCheckbox.deactivate(),t.achievementsList.activate(t.achievementsList.items[t.achievementToOpen]),t.achievementToOpen=null),g.preloadImages(o,function(e){for(var t=0;t<e.length;t+=1){var i=s[t].getChild("icon");i?i.setImage(e[t]):console.warn("Missing icon for achievement #"+t,s[t])}})})})},n.prototype.addAchievement=function(e,t){function i(){l.activateAchievement(this.achievementId)}function n(e){var t=window.gui.playerData.characterBaseInformations.sex,i=t?e.nameFemaleId:e.nameMaleId;return i}var a,l=this,c=window.gui.playerData.achievements,p=new r("div",{className:"infos"});p.appendChild(new u({name:"icon"}));var g=p.createChild("div",{className:"infosGroupRight"}),v=g.createChild("div",{className:"cf"});v.createChild("div",{className:"title",text:e.nameId}),v.createChild("div",{className:"points",text:e.points}),g.createChild("div",{className:"description",text:e.descriptionId});var y=this.achievementsList.addItem(e.id,p,e);y.data.objectivesLoaded=!1,y.addClassNames("achievement"),y.more=y.createChild("div",{className:"more",name:"more"});var b=y.more.createChild("div",{className:"progression",name:"progression"});b.hide(),b.appendChild(new m({className:"green",name:"progressBar"})),b.createChild("div",{className:"text",name:"text"});var M=y.more.createChild("div",{className:"objectives",name:"objectives"});M.hide(),y.more.createChild("div",{className:"spinner",name:"spinner"});var w=y.more.createChild("div",{className:"rewards",name:"rewards"});w.createChild("div",{className:"text",text:f("ui.grimoire.quest.rewards")});var T=w.createChild("div",{className:"rewardList"}),C=6;for(a=0;a<C;a++)T.appendChild(new u({name:"icon"+a}));var A=w.appendChild(new d({name:"claimButton"}));A.achievementId=e.id,A.hide(),A.disable(),A.on("tap",s);var I=c.completedData(e.id),S=I.finishedlevel;I.isCompleted&&(y.addClassNames("completed"),this.isAchievementRewardClaimed(e.id)||(A.show(),A.enable()));var E=w.createChild("div",{className:"kamasXP"}),x=_.kamasToString(c.getAchievementExperienceReward(e,S),""),N=_.kamasToString(c.getAchievementKamasReward(e,S),""),L=E.createChild("div",{className:"line"});L.createChild("div",{className:"text",text:x}),L.createChild("div",{className:["icon","xp"]});var O=E.createChild("div",{className:"line"});for(O.createChild("div",{className:"text",text:N}),O.createChild("div",{className:["icon","kamas"]}),y.more.hide(),a=0;a<e.objectiveIds.length;a++){var D=e.objectiveIds[a],R=t[D];if(R&&M.rootElement){var P=M.createChild("div",{className:["objective",R.id],name:R.id,text:R.nameId}),B=0===R.criterion.indexOf("OA");if(B){var k=Number(R.criterion.substr(3,R.criterion.length));isNaN(k)?console.warn("Failed parsing achievementId of objective.criterion: "+R.criterion):(P.achievementId=k,h(P),P.on("tap",i))}var z=P.createChild("span",{className:"text"});z.setHtml(R.nameId+(B?" "+f("ui.common.fakeLinkSee"):""))}}return o(e,function(e,t){if(e)return console.error("Loaded static achievement data error",e);for(var i=0;i<t.length;i+=1){var o=T.getChild("icon"+i),s=t[i].url,a=t[i].quantity,l=t[i].data;if(!o)return console.warn("AchievementsWindow: Missing icon"+i);o.setImage(s),a&&o.setQuantity(a);var c=new r("div");c.createChild("div",{text:l.nameId||n(l)}),l.descriptionId&&c.createChild("div",{text:l.descriptionId,style:{color:"#b9e154"}}),o.setTooltip(c)}}),p},n.prototype.activateAchievement=function(e){var t=this;this.achievementToOpen=e,l.getData("Achievements",e,function(i,n){if(i||!n)return console.error("Failed getting Achievements #"+e+" error: "+i+" res: "+n);var o=t.categoriesList.items;if(o[n.categoryId])return void t.categoriesList.activate(o[n.categoryId]);for(var s in o){var a=o[s].sublist;if(a.items[n.categoryId])return t.categoriesList.activate(o[s]),void a.activate(a.items[n.categoryId])}})},n.prototype.isCompleted=function(e){for(var t=this.achievementDataFromServer.finishedAchievementsIds.indexOf(e)!==-1,i=this.achievementDataFromServer.rewardableAchievements,n=0;n<i.length;n+=1)if(i[n].id===e){t=!0;break}return t},n.prototype.isAchievementRewardClaimed=function(e){return this.achievementDataFromServer.finishedAchievementsIds.indexOf(e)!==-1},n.prototype.setSearchOption=function(e,t){switch(e){case"name":this.searchName=t;break;case"objectives":this.searchObjective=t}this._search()},n.prototype._search=function(){var e=this,t=this.searchBox.searchInput.getValue();if(null!==t&&""!==t){if(t.length<3)return y.showNotification(f("ui.common.searchFilterTooltip"),this.searchBox);t=_.simplifyString(t),this.searching=!0,this.searchAchievementIds=[],this.isSearchNameOver=!1,this.isSearchObjectiveOver=!1,this.searchName&&l.searchDataMap("Achievements",{match:t},function(i,n){if(i)return console.error("AchievementsWindow achievements search",i);for(var o in n){var s=n[o];e.searchAchievementIds.indexOf(s.id)===-1&&e.searchAchievementIds.push(s.id)}l.searchDataMap("Achievements",{match:t,matchProp:"descriptionId"},function(t,i){if(t)return console.error("AchievementsWindow description search",t);for(var n in i){var o=i[n];e.searchAchievementIds.indexOf(o.id)===-1&&e.searchAchievementIds.push(o.id)}e.isSearchNameOver=!0,e._searchResult()})}),this.searchObjective&&l.searchDataMap("AchievementObjectives",{match:t},function(t,i){if(t)return console.error("AchievementsWindow objectives search",t);for(var n in i){var o=i[n],s=o.achievementId;e.searchAchievementIds.indexOf(s)===-1&&e.searchAchievementIds.push(s)}e.isSearchObjectiveOver=!0,e._searchResult()}),this._searchResult()}},n.prototype._searchResult=function(){this.searchName&&!this.isSearchNameOver||this.searchObjective&&!this.isSearchObjectiveOver||this.addAchievements(this.searchAchievementIds)}},function(e,t){},function(e,t,i){function n(e){e=e||{},s.call(this,"ul",e),this.addClassNames("List"),e.cannotActivate&&(this._cannotActivate=e.cannotActivate),this.activeItem=null,this.items={}}i(898);var o=i(172).inherits,s=i(321),a=i(339),r=i(197),l=i(247).playUiSound;o(n,s),e.exports=n,n.prototype.addItem=function(e,t,i){var n=this,o=this.createChild("li",{name:e,className:e});return o.appendChild(t),o.element=t,i&&(o.data=i),r(t),t.on("tap",function(){o===n.activeItem?n.deactivate():n.activate(o)}),this.items[e]=o,o},n.prototype.removeItem=function(e){var t=this.items[e];t&&(t.destroy(),delete this.items[e])},n.prototype.selectItem=function(e){var t=this.items[e];if(t)return this.activate(t),t},n.prototype.activate=function(e){this._cannotActivate||(this.deactivate(!0),e.addClassNames("on"),this.emit("activate",e),this.activeItem=e,l("GEN_BUTTON"))},n.prototype.deactivate=function(e){this.activeItem&&(this.activeItem.delClassNames("on"),this.emit("deactivate",this.activeItem),this.activeItem=null,e||l("GEN_BUTTON"))},n.prototype.empty=function(){this.clearContent(),this.activeItem=null,this.items={}},n.prototype.sort=function(e,t){a.sortObjectInArray(this.items,e,t)}},function(e,t){},function(e,t,i){function n(){function e(e){e.search&&(t.searchBox.setValue(e.search),t._search(e.search))}d.call(this,"div",{className:"BestiaryWindow",name:"bestiary"});var t=this;this.subAreas={},this.monsters={},this.col1=this.createChild("div",{className:"col1"}),this.col2=this.createChild("div",{className:"col2"}),this.tabs=new c,this.col1.appendChild(this.tabs),this.panels=this.col1.createChild("div",{className:"panels"});var i=this.panels.createChild("div",{className:"panel"}),n=this.areaList=i.appendChild(new h);n.addClassNames("tree"),n.on("activate",function(e){e.sublist.show(),v("TAB")}),n.on("deactivate",function(e){e.sublist.hide(),e.sublist.deactivate()});var o=this.panels.createChild("div",{className:"panel"}),s=o.appendChild(new h);s.addClassNames("tree"),s.on("activate",function(e){e.sublist.show(),v("TAB")}),s.on("deactivate",function(e){e.sublist.hide(),e.sublist.deactivate()}),this.searchBlock=this.col2.createChild("div",{className:"searchBlock"}),this.searchBox=this.searchBlock.appendChild(new b),this.searchBox.on("search",function(e){t._search(e)}),this.monsterList=this.col2.appendChild(new p),this.monsterList.on("selected",function(e){e.more?(e.more.show(),this.refresh()):t._createMonsterMoreInfo(e)}),this.monsterList.on("deselected",function(e){e.more.hide(),this.refresh()}),this.noResultText=this.monsterList.createChild("div",{className:"noResultText",text:g("ui.search.noResult")}),this.errorText=this.monsterList.createChild("div",{className:"errorText",text:g("ui.secureMode.error.default")}),t.errorText.hide();var a=this.col2.appendChild(new M(g("ui.monster.showCriteriaDrop")));a.on("activate",function(){t.addClassNames("showCriteriaDrop"),t.monsterList.refresh()}),a.on("deactivate",function(){t.delClassNames("showCriteriaDrop"),t.monsterList.refresh()}),this.tabs.addTab(g("ui.monster.areas"),i),this.tabs.addTab(g("ui.monster.families"),o),this.tabs.openTab(0),this.once("open",function(i){u.getAllDataBulk(["Areas","SubAreas","MonsterSuperRaces","MonsterRaces"],function(o,a){if(o)return console.error("Bestiary: getAllDataAreas error",o);var r=a.Areas,l=a.SubAreas,c=a.MonsterSuperRaces,u=a.MonsterRaces,h=y.createPropertyNameCompareFunc("nameId");r.sort(h),r.forEach(function(e){t.addToList(n,e)}),l.sort(h),l.forEach(function(e){if(e.monsters.length>0){var i=new d("div",{className:"label",text:e.nameId});n.items[e.areaId].sublist.addItem(e.id,i,e),t.subAreas[e.id]=e}}),c.sort(h),c.forEach(function(e){t.addToList(s,e)}),u.sort(h),u.forEach(function(e){if(e.monsters.length>0){var t=new d("div",{className:"label",text:e.nameId});s.items[e.superRaceId].sublist.addItem(e.id,t,e)}}),t.on("open",e),e(i)})})}function o(e){return e.base+e.alignGiftBonus+e.objectsAndMountBonus+e.contextModif}function s(e,t){return e===t?e:e+" "+g("ui.chat.to")+" "+t}function a(e){return Math.round(1e3*e)/1e3}function r(){var e=this.data.nameId,t=g("ui.item.averageprice")+" : ",i=this.itemDataElement.getProperty("averagePrice");t+=i===-1?g("ui.item.averageprice.unavailable"):y.kamasToString(i),e+="\n"+t;var n=o(window.gui.playerData.characters.mainCharacter.characteristics.prospecting),r=n;r<100&&(n=100);var l=a(this.dropInfo.percentDropForGrade1),c=a(this.dropInfo.percentDropForGrade5),d=Math.min(100,a(this.dropInfo.percentDropForGrade1*n/100)),u=Math.min(100,a(this.dropInfo.percentDropForGrade5*n/100));return e+="\n"+g("ui.monster.obtaining"),e+=" ("+r+" "+g("ui.short.prospection")+") : ",e+=s(d,u)+"%",e+="\n"+g("ui.monster.obtaining"),e+=" ("+g("ui.common.base")+") : ",e+=s(l,c)+"%",this.dropInfo.findCeil&&(e+="\n"+g("ui.monster.prospectionThreshold")+" : "+this.dropInfo.findCeil),e}i(900);var l=i(172).inherits,c=i(834),d=i(321),u=i(30),h=i(897),p=i(452).SingleSelectionList,m=i(461),f=i(737),g=i(29).getText,_=i(182),v=i(247).playUiSound,y=i(339),b=i(544),M=i(612);l(n,d),e.exports=n,n.prototype.addToList=function(e,t){var i=this,n=new d("div",{className:"label"});n.createChild("div",{className:"arrow"}),n.createChild("div",{className:"text",text:t.nameId});var o=e.addItem(t.id,n,t);o.sublist=o.appendChild(new h),o.sublist.addClassNames("tree"),o.sublist.hide(),o.sublist.on("activate",function(e){i._showMonsters(e.data.monsters)})},n.prototype._search=function(e){var t=this;return""===e?void(this.searching=!1):(e=y.simplifyString(e),this.searching=!0,this.monsterList.clearContent(),this.monsterList.addClassNames("spinner"),t.errorText.hide(),t.noResultText.hide(),void u.searchDataMap("Items",{match:e},function(i,n){if(t.searching){if(i)return t.monsterList.delClassNames("spinner"),t.errorText.show(),console.error("BestiaryWindow items search",i);var o=[];for(var s in n){var a=n[s];if(a.dropMonsterIds.length)for(var r=0;r<a.dropMonsterIds.length;r++){var l=a.dropMonsterIds[r];o.indexOf(l)===-1&&o.push(l)}}u.searchDataMap("Monsters",{match:e},function(e,i){if(t.searching){if(e)return t.monsterList.delClassNames("spinner"),t.errorText.show(),console.error("BestiaryWindow monsters search",e);for(var n in i){var s=i[n];o.indexOf(s.id)===-1&&o.push(s.id)}t._showMonsters(o)}})}}))},n.prototype._showMonsters=function(e){var t=this;this.searching=!1,t.errorText.hide(),t.noResultText.hide(),u.getData("Monsters",e,function(e,i){if(e)return t.monsterList.delClassNames("spinner"),t.errorText.show(),console.error("BestiaryWindow showMonsters error",e);var n=y.createPropertyNameCompareFunc("nameId");i.sort(n),t.monsterList.clearContent(),t.monsterList.delClassNames("spinner");var o=[],s=i.length;0===s&&t.noResultText.show();for(var a=0;a<s;a+=1)o.push("gfx/monsters/"+i[a].id+".png");_.preloadImages(o,function(e){for(var n=0;n<s;n+=1)t.addMonster(i[n],e[n]);t.monsterList.refresh()})})},n.prototype.addMonster=function(e,t){var i=new d("div",{className:"infos"}),n=i.createChild("div",{className:"gfx"});n.setStyle("backgroundImage",t);var o=i.createChild("div",{className:"infosGroupRight"}),s=o.createChild("div",{className:"cf"}),a=["name"];e.isBoss&&a.push("boss"),e.isMiniBoss&&a.push("miniBoss"),e.isQuestMonster&&a.push("questMonster");var r=window.gui.playerData.isModeratorOrMore(),l=e.nameId;r&&(l+=" ("+e.id+")"),s.createChild("div",{className:a,text:l});var c=e.grades[0].level,u=e.grades[e.grades.length-1].level,h=g("ui.common.short.level")+" "+c;if(c!==u&&(h+=" "+g("ui.chat.to")+" "+u),s.createChild("div",{className:"level",text:h}),0!==e.favoriteSubareaId){var p=this.subAreas[e.favoriteSubareaId].nameId,m=this.areaList.items[this.subAreas[e.favoriteSubareaId].areaId].data.nameId;o.createChild("div",{className:"favoriteSubarea",text:p+" ("+m+")"})}var f=this.monsterList.addItem({id:e.id,element:i,data:e},{noRefresh:!0});f.addClassNames("monster"),f.monsterData=e},n.prototype._createMonsterMoreInfo=function(e){function t(e,t){var i=o.grades[0][t],n=o.grades[o.grades.length-1][t],a=e+": "+i;i!==n&&(a+=" "+g("ui.chat.to")+" "+n),s.createChild("div",{className:"stat",text:a})}function i(e){var t=o.grades[0][e],i=o.grades[o.grades.length-1][e],n=t;t!==i&&(n+=" "+g("ui.chat.to")+" "+i),a.createChild("div",{className:["stat","resistance",e],text:n})}e.more=e.createChild("div",{className:"more"});var n=e.more.createChild("div",{className:"cf"}),o=e.monsterData,s=n.createChild("div",{className:["col","colLeft"]});s.createChild("div",{className:"subtitle",text:g("ui.common.caracteristics")}),t(g("ui.short.lifePoints"),"lifePoints"),t(g("ui.short.actionPoints"),"actionPoints"),t(g("ui.short.movementPoints"),"movementPoints");var a=n.createChild("div",{className:["col","colRight"]});a.createChild("div",{className:"subtitle",text:g("ui.common.resistances")}),i("neutralResistance"),i("earthResistance"),i("fireResistance"),i("waterResistance"),i("airResistance"),this._createMonsterDrops(e,o.drops)},n.prototype._createMonsterDrops=function(e,t){if(0!==t.length){e.more.createChild("div",{className:"subtitle",text:g("ui.common.loot")}),this.monsterList.refresh();var i=t.map(function(e){return e.objectId}),n=this;m.getItems(i,function(o){if(o)return console.error("Failed to get items",o);for(var s=0;s<i.length;s+=1){var a=i[s],l=m.items[a];if(l){var c=e.more.appendChild(new f);c.itemDataElement=l,c.dropInfo=t[s],c.setTooltip(r),c.toggleClassName("special",t[s].hasCriteria),c.setItem(l),c.setContextMenu("item",{item:l}),t[s].percentDropForGrade1<2?c.addClassNames("rareDrop"):t[s].percentDropForGrade1<10&&c.addClassNames("okDrop")}else console.warn("monster",e.monsterData.id,"contains invalid drop item in pos ",s)}n.monsterList.refresh()})}}},function(e,t){},function(e,t,i){function n(){function e(e){return t._ornamentIdToSelect=~~e.ornamentId,t._titleIdToSelect=~~e.titleId,t._titlesAndOrnamentsListRequested?void t._selectOnceReady():(t._displayLoading(!0),t._titlesAndOrnamentsListRequested=!0,void window.dofus.sendMessage("TitlesAndOrnamentsListRequestMessage"))}f.call(this,"div",{className:"OrnamentsWindow",name:"ornaments"});var t=this;this._titlesAndOrnaments=null,this._currentTitleId=null,this._currentOrnamentId=null,this._titlesAndOrnamentsListRequested=!1,this.once("open",function(i){t._createDom(),t._displayLoading(!0),t._loadContent(function(){t._setupEvents(),t.on("opened",e),e(i)});var n=window.gui.playerData.characterBaseInformations.entityLook;t._updateCharacter(n)})}i(902);var o=i(182),s=i(335).DofusButton,a=i(369),r=i(612),l=i(29).getText,c=i(172).inherits,d=i(420),u=i(452).SingleSelectionList,h=i(30),p=i(834),m=i(176),f=i(321);c(n,f),e.exports=n,n.prototype._selectOnceReady=function(){this._ornamentIdToSelect?(this.tabs.openTab("ornaments"),this.ornamentList.selectItem(this._ornamentIdToSelect)):this._titleIdToSelect?(this.tabs.openTab("titles"),this.titleList.selectItem(this._titleIdToSelect)):this._selectActiveTitleAndOrnament()},n.prototype._setupEvents=function(){var e=this;window.gui.on("disconnect",function(){e._titlesAndOrnamentsListRequested=!1,e.tabs&&e.tabs.openFirstTab()}),window.gui.on("TitlesAndOrnamentsListMessage",function(t){e._titlesAndOrnaments=t,e._titlesAndOrnaments.titles.push(0),e._titlesAndOrnaments.ornaments.push(0),e._updateOrnamentList(),e._updateTitleList(),e._displayLoading(!1);var i=m.getValue("dofus_titleOrnaments_display_all",!1);e.showAllCheckbox.toggleActivation(i),e._selectOnceReady()}),window.gui.on("OrnamentSelectedMessage",function(t){e._titlesAndOrnaments&&(e._titlesAndOrnaments.activeOrnament=t.ornamentId)}),window.gui.on("TitleSelectedMessage",function(t){e._titlesAndOrnaments&&(e._titlesAndOrnaments.activeTitle=t.titleId)}),window.gui.on("OrnamentSelectErrorMessage",function(){}),window.gui.on("TitleSelectErrorMessage",function(){}),window.gui.on("TitleGainedMessage",function(t){var i=t.titleId;e._titlesAndOrnaments.titles.push(i),e._updateTitleList(),e._displayObtainedTitles()}),window.gui.on("TitleLostMessage",function(t){var i=t.titleId,n=e._titlesAndOrnaments.titles.indexOf(i);n!==-1&&e._titlesAndOrnaments.titles.splice(n,1),e._updateTitleList(),e._displayObtainedTitles()}),window.gui.on("OrnamentGainedMessage",function(t){var i=t.ornamentId;e._titlesAndOrnaments.ornaments.push(i),e._updateOrnamentList(),e._displayObtainedOrnaments()}),window.gui.playerData.on("lookUpdate",function(t){e.character&&e._updateCharacter(t)})},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"col1"});this.col2=this.createChild("div",{className:"col2"});var i=this.tabs=t.appendChild(new p);this.titleList=t.appendChild(new u({className:"titleList"},{disableSelectionToggle:!0})),this.titleList.on("selected",function(t){e._setCharacterTitle(t.data.id),this.showElement(t)}),this.ornamentList=t.appendChild(new u({className:"ornamentList"},{disableSelectionToggle:!0})),this.ornamentList.on("selected",function(t){e._setCharacterOrnament(t.data.id),this.showElement(t)});var n=i.addTab(l("ui.ornament.titles"),this.titleList,"titles"),o=i.getTabTarget(n);o.on("opened",function(){e.titleList.refresh()}),n=i.addTab(l("ui.ornament.ornaments"),this.ornamentList,"ornaments");var c=i.getTabTarget(n);c.on("opened",function(){e.ornamentList.refresh()}),i.openFirstTab(),this.showAllCheckbox=t.appendChild(new r(l("ui.ornament.displayAll"))),this.showAllCheckbox.on("change",function(t){m.setValue("dofus_titleOrnaments_display_all",t),e._displayObtainedTitlesOrnaments()}),this.container=this.col2.createChild("div",{className:"container"}),this.character=this.container.appendChild(new a({scale:"cover",verticalAlign:"bottom"})),this.ornamentContainer=this.container.createChild("div",{className:"ornamentContainer"}),this.ornament=this.ornamentContainer.appendChild(new d),this.ornament.on("sizeChanged",function(){e.ornament.setStyle("marginTop","0px");var t=e.ornamentContainer.rootElement.offsetHeight-this.getHeight();t<0&&(t=0),e.ornament.setStyle("marginTop",t+"px"),e.ornament.setStyle("marginLeft","0px");var i=0;e.ornament._canvas.rootElement.offsetWidth>e.ornamentContainer.rootElement.offsetWidth&&(i=.5*-(e.ornament._canvas.rootElement.offsetWidth-e.ornamentContainer.rootElement.offsetWidth)),e.ornament.setStyle("marginLeft",i+"px")}),this.warningWings=this.col2.createChild("div",{className:"warningWings",text:l("ui.ornament.warningWings"),hidden:!0});var h=this.col2.createChild("div",{className:"buttons"}),f=h.appendChild(new s(l("ui.common.reset")));this.saveButton=h.appendChild(new s(l("ui.common.save"))),this.saveButton.disable(),f.on("tap",function(){e._selectActiveTitleAndOrnament(),e.saveButton.disable()}),this.saveButton.on("tap",function(){var t=e._getActiveTitleId(),i=e._getActiveOrnamentId();t!==e._currentTitleId&&window.dofus.sendMessage("TitleSelectRequestMessage",{titleId:e._currentTitleId}),i!==e._currentOrnamentId&&window.dofus.sendMessage("OrnamentSelectRequestMessage",{ornamentId:e._currentOrnamentId}),this.disable()})},n.prototype._addTitleElement=function(e){var t=this._getTitleText(e),i=new f("div",{className:"row",text:t||l("ui.common.none")});this.titleList.addItem({id:e.id,element:i,data:e},{noRefresh:!0})},n.prototype._getTitleText=function(e){var t=window.gui.playerData.characterBaseInformations.sex;return t?e.femaleText:e.maleText},n.prototype._addOrnamentElement=function(e,t){var i=new f("div",{className:"row"}),n=i.createChild("div",{className:"icon"});n.setStyle("backgroundImage",t),i.createChild("div",{text:e.nameId||l("ui.common.none"),className:"name"}),this.ornamentList.addItem({id:e.id,element:i,data:{id:e.id,assetId:e.assetId,visible:e.visible}},{noRefresh:!0})},n.prototype._loadContent=function(e){for(var t=this,i=["ui/slot.png","gfx/illusUi/tx_bgTitleOrnament.png"],n=0;n<6;n++)i.push("gfx/ornaments/"+n+".png");o.preloadImages(i,function(i){h.getAllDataTable(["Titles","Ornaments"],function(n,o){if(n)return console.error("Titles and Ornaments: failed getting data",n),e(n);var s=o.Titles,a=o.Ornaments;t.container.setStyle("backgroundImage",i[1]),t._addTitleElement({id:0}),t._addOrnamentElement({id:0},i[0]);var r,l;for(r=0;r<s.length;r+=1)l=s[r],t._addTitleElement({id:l.id,maleText:l.nameMaleId,femaleText:l.nameFemaleId,visible:l.visible});for(r=0;r<a.length;r+=1)l=a[r],t._addOrnamentElement(l,i[l.iconId+2]);e()})})},n.prototype._displayLoading=function(e){this.titleList.toggleClassName("spinner",e),this.ornamentList.toggleClassName("spinner",e),this.titleList.getContentElement().toggleDisplay(!e),this.ornamentList.getContentElement().toggleDisplay(!e)},n.prototype._getActiveOrnamentId=function(){return this._titlesAndOrnaments&&this._titlesAndOrnaments.activeOrnament},n.prototype._getActiveTitleId=function(){return this._titlesAndOrnaments&&this._titlesAndOrnaments.activeTitle},n.prototype._getOwnedOrnaments=function(){return this._titlesAndOrnaments&&this._titlesAndOrnaments.ornaments},n.prototype._getOwnedTitles=function(){return this._titlesAndOrnaments&&this._titlesAndOrnaments.titles},n.prototype._updateCharacter=function(e){console.log("Setting character's look",e),this.character.setLook(e,{riderOnly:!0,direction:2,boneType:"characters/",skinType:"characters/"})},n.prototype._selectActiveTitleAndOrnament=function(){if(this._titlesAndOrnaments){var e=this._getActiveTitleId(),t=this._getActiveOrnamentId();this._currentTitleId=e,this._currentOrnamentId=t,this.titleList.deselectAll(),this.ornamentList.deselectAll(),this.titleList.selectItem(e,{noEvent:!0,noSound:!0}),this.ornamentList.selectItem(t,{noEvent:!0,noSound:!0}),this._setCharacterTitleAndOrnament(e,t)}},n.prototype._displayObtainedTitles=function(){for(var e=m.getValue("dofus_titleOrnaments_display_all",!1),t=this.titleList.getItems(),i=0,n=0;n<t.length;n+=1){var o=t[n],s=e&&o.data.visible;o.toggleDisplay(s||o.data.isAvailable),o.isVisible()&&(o.toggleClassName("odd",i%2===0),i+=1)}if(this.titleList.refresh(),null!==this._currentTitleId){var a=this.titleList.getItem(this._currentTitleId);a.data.isAvailable||this.titleList.selectItem(this._getActiveTitleId(),{noSound:!0})}},n.prototype._displayObtainedOrnaments=function(){for(var e=m.getValue("dofus_titleOrnaments_display_all",!1),t=this.ornamentList.getItems(),i=0,n=0;n<t.length;n+=1){var o=t[n],s=e&&o.data.visible;o.toggleDisplay(s||o.data.isAvailable),o.isVisible()&&(o.toggleClassName("odd",i%2===0),i+=1)}if(this.ornamentList.refresh(),null!==this._currentOrnamentId){var a=this.ornamentList.getItem(this._currentOrnamentId);a.data.isAvailable||this.ornamentList.selectItem(this._getActiveOrnamentId(),{noSound:!0})}},n.prototype._displayObtainedTitlesOrnaments=function(){this._displayObtainedTitles(),this._displayObtainedOrnaments()},n.prototype._updateTitleList=function(){for(var e=this._getOwnedTitles(),t=this.titleList.getItems(),i=0;i<t.length;i+=1){var n=t[i],o=n.data.id,s=this._getTitleText(n.data);if(s){var a=n.getChildren();a[0].setText(s)}var r=e.indexOf(o)>=0;n.data.isAvailable=r,n.toggleClassName("unavailable",!r)}},n.prototype._updateOrnamentList=function(){for(var e=this._getOwnedOrnaments(),t=this.ornamentList.getItems(),i=0;i<t.length;i+=1){var n=t[i],o=n.data.id,s=e.indexOf(o)>=0;n.data.isAvailable=s,n.toggleClassName("unavailable",!s)}},n.prototype._isSavable=function(e,t){var i=this._getOwnedTitles(),n=this._getOwnedOrnaments(),o=this._getActiveTitleId(),s=this._getActiveOrnamentId();return(o!==e||s!==t)&&i.indexOf(e)>=0&&n.indexOf(t)>=0},n.prototype._setCharacterTitle=function(e){var t=this.titleList.getItem(e);this._currentTitleId=e;var i=this._isSavable(this._currentTitleId,this._currentOrnamentId);this.saveButton.setEnable(i),this.ornament.changeAttributes({title:this._getTitleText(t.data)||""}),this.ornament.display()},n.prototype._setCharacterOrnament=function(e){var t=this.ornamentList.getItem(e);this._currentOrnamentId=e;var i=this._isSavable(this._currentTitleId,this._currentOrnamentId);this.saveButton.setEnable(i),this.ornament.changeAttributes({ornamentAssetId:t.data.assetId}),this.ornament.display()},n.prototype._setCharacterTitleAndOrnament=function(e,t){var i,n=window.gui.playerData,o=this.titleList.getItem(e),s=this.ornamentList.getItem(t);o&&(i=this._getTitleText(o.data)),this.ornament.setAttributes({charName:window.gui.playerData.characterBaseInformations.name,title:i,ornamentAssetId:s&&s.data&&s.data.assetId,guild:n.guild&&n.guild.current,alliance:n.alliance&&n.alliance.current,alignmentInfos:window.gui.playerData.alignment.alignmentInfos}),this.ornament.display(),0!==window.gui.playerData.alignment.alignmentInfos.alignmentGrade?this.warningWings.show():this.warningWings.hide()}},function(e,t){},function(e,t,i){function n(){T.call(this,"div",{className:"QuestsWindow",name:"quests"});var e=this,t=!1;A=window.gui.playerData.quests,this.currentQuest=null,this.selectedQuestElement=null,this.updateRequired=!0,this.questsListUpdated=!1,this.params={},this.locateButtonMap={},A.on("listUpdated",function(){e.updateRequired=!0,e.questsListUpdated=!0,e.isVisible()&&(e.emit("open",e.params),e.questsList.delClassNames("spinner"))}),this.once("open",function(){this._createDom(),this._setupEvents(),this._getQuestCategoryStaticData(function(){e._createQuestCategories(),t=!0,e.emit("initialized")})}),this.on("open",function(e){return this.questsList.toggleClassName("spinner",!this.questsListUpdated),t?void this._onOpen(e):this.once("initialized",this._onOpen.bind(this,e))})}function o(e,t){if(t.length){for(var i={},n=0,o=t.length;n<o;n+=1){var s=t[n];i[s[0]]=s[1]}var a=Object.keys(i);u.getItems(a,function(t,n){return t?console.error("Failed to retrieve items",a):void n.forEach(function(t){if(t){var n=e.appendChild(new h);n.addClassNames("rewardSlot"),n.setItem(t),n.setQuantity(i[t.id]),n.on("tap",function(){w.open("itemBox",{itemData:t})})}})})}}function s(e,t){t.length&&y.getData("Emoticons",t,function(t,i){if(t)return console.error(t);var n=[],o=[];i.forEach(function(t){if(t){var i=e.appendChild(new v);i.addClassNames("rewardSlot"),o.push(i),i.icon.addClassNames("spinner"),n.push("gfx/emotes/"+t.id+".png"),i.setTooltip(t.nameId)}}),a.preloadImages(n,function(e){for(var t=0,i=e.length;t<i;t+=1){var n=o[t];n.rootElement&&(n.icon.delClassNames("spinner"),n.setImage(e[t]))}})})}i(904);var a=i(182),r=i(612),l=i(29).getText,c=i(614),d=i(172).inherits,u=i(461),h=i(737),p=i(452),m=i(247).playUiSound,f=i(905),g=i(436),_=i(532),v=i(739),y=i(30),b=i(197),M=i(176),w=i(194),T=i(321),C=i(337).addTooltip,A={},I=[];d(n,T),e.exports=n,n.prototype._onOpen=function(e){var t=this;this.params=e||{};var i=!0,n=M.getValue("showCompletedQuest",!1);this.showCompletedCheckbox.toggleActivation(n,i),this.updateRequired&&this._updateQuestList();var o=this.params.categoryId||this.currentQuest&&this.currentQuest.dbQuest.categoryId,s=this.params.questId||this.currentQuest&&this.currentQuest.questId;setTimeout(function(){t._selectQuest(o,s)},0)},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"col1"}),i=this.createChild("div",{className:"col2"});this.counter=t.createChild("div",{className:["header","counter"]}),this.questsList=t.appendChild(new p({className:"tree"})),this.showCompletedCheckbox=t.appendChild(new r(l("ui.grimoire.displayFinishedQuests")));var n=i.createChild("div",{className:["header","steps"]}),o=n.createChild("div",{className:"followedQuest"});this.questFollowed=o.appendChild(new T("div",{className:"followedQuestButton"})),C(o,l("tablet.ui.grimoire.followQuest")),this.questFollowed.createChild("div",{className:"locateBackground"}),this.questFollowed.createChild("div",{className:"locateIcon"}),b(o),o.on("tap",function(){var t=window.gui.GPS,i=e.currentQuest.questId,n=!t.questFollower.isQuestFollowed(i);e._updateQuestFollow(i,n,!0)}),this.questFollowed.toggleClassName("selected",!0),this.questFollowed.hide(),this.stepTitle=n.createChild("div",{className:"stepTitle"}),this.stepSelector=n.appendChild(new _({className:"stepSelector"}));var s=i.createChild("div",{className:"descWrapper"});s.createChild("div",{className:"image"}),this.description=s.createChild("div",{className:"description"}),i.createChild("div",{className:"header",text:l("ui.grimoire.quest.objectives")}),this.objectivePlaceHolder=new T("div",{text:l("ui.grimoire.quest.objectivesNonAvailable"),name:"objectivePlaceHolder",className:"objectiveRow"}),this.objectivesScroller=i.appendChild(new g({className:"objectiveList"})),this.objectives=this.objectivesScroller.content;var a=this.rewardHeader=i.createChild("div",{className:"header"});a.createChild("div",{className:"rewardTitle",text:l("ui.grimoire.quest.rewards")});var c=this.xpPoint=a.createChild("div",{className:"point"});this.xp=c.createChild("div",{className:"text"}),c.createChild("div",{className:["xp","icon"]}),c.hide();var d=this.kamasPoint=a.createChild("div",{className:"point"});this.kamas=d.createChild("div",{className:"text"}),d.createChild("div",{className:["kamas","icon"]}),d.hide(),this.rewardList=i.createChild("div",{className:"rewardList"}),this.stepSelector.on("change",function(t){var i=e.currentQuest.dbSteps[t],n=e.currentQuest.dbQuest.stepIds.indexOf(parseInt(t,10));n<=this.index?e._displayStepData(i):e._displayUnknownStep(i)}),this.questsList.on("selected",function(t){t.sublist.show(),e._updateQuestItemsStyle(),e.questsList.refresh(),e.questsList.scrollToElement(t)}),this.questsList.on("deselected",function(t){t.sublist.hide(),e._updateQuestItemsStyle(),e.questsList.refresh()}),this.showCompletedCheckbox.on("change",function(t){M.setValue("showCompletedQuest",t),e._showCompletedQuest()})},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=t.GPS;A.on("questUpdate",function(t){
e.isVisible()&&e.currentQuest&&t===e.currentQuest.questId&&e._selectQuest(e.currentQuest.dbQuest.categoryId,e.currentQuest.questId)}),A.on("questFinished",function(t){e._endQuest(t.questId),e._sortSublist(t.questId),e._showCompletedQuest(),e._updateQuestCounter(),e.currentQuest&&t.questId===e.currentQuest.questId&&e._reset()}),A.on("questStarted",function(t){e._addQuest(t),e._sortSublist(t),e._showCompletedQuest(),e._updateQuestCounter(),e.currentQuest||(e.currentQuest=A.all[t],e.isVisible()&&e._selectQuest(e.currentQuest.dbQuest.categoryId,e.currentQuest.questId))}),t.on("disconnect",function(){e.currentQuest=null,e.selectedQuestElement=null,e.updateRequired=!0,e.questsListUpdated=!1,e.params={},e.locateButtonMap={}}),i.on("addDestination",function(t){var i=e.locateButtonMap[t.id];i&&i.rootElement&&i.addClassNames("selected")}),i.on("removeDestination",function(t){var i=e.locateButtonMap[t];i&&i.rootElement&&i.delClassNames("selected")})},n.prototype._getQuestCategoryStaticData=function(e){y.getAllDataTable("QuestCategory",function(t,i){return t?console.error(t):(I=i||[],I.sort(function(e,t){return e.order-t.order}),void e())})},n.prototype._createQuestCategories=function(){for(var e=this,t=0,i=I.length;t<i;t+=1){var n=I[t],o=new T("div",{className:"label"});o.createChild("div",{className:"arrow"}),o.createChild("div",{className:"text",text:n.nameId});var s=e.questsList.addItem({id:n.id,element:o},{noRefresh:!0});s.hide(),s.sublist=s.appendChild(new T("div",{className:"sublist"})),s.sublist.hide()}},n.prototype._updateQuestList=function(){this.updateRequired=!1,this._reset(),this._generateQuestList(),this._updateQuestCounter()},n.prototype._reset=function(){this.currentQuest=null,this._resetSelectedQuestElement(),this.stepTitle.setText(""),this.description.setText(""),this._resetObjectives(),this.rewardList.clearContent(),this.kamas.setText(""),this.kamasPoint.hide(),this.xp.setText(""),this.xpPoint.hide(),this.questsList.deselectAll(),this.stepSelector.clearContent(),this.stepSelector.hide(),this.questFollowed.hide()},n.prototype._resetSelectedQuestElement=function(){this.selectedQuestElement&&(this.selectedQuestElement.delClassNames("selected"),this.selectedQuestElement=null)},n.prototype._generateQuestList=function(){for(var e=this.questsList.getItems(),t=0;t<e.length;t+=1){var i=e[t].sublist;i.clearContent()}var n=Object.keys(A.active).sort(),o=Object.keys(A.finished).sort();for(t=0;t<n.length;t+=1)this._addQuest(n[t]);for(t=0;t<o.length;t+=1)this._addQuest(o[t]);this._showCompletedQuest()},n.prototype._updateQuestCounter=function(){var e=l("ui.grimoire.pendingQuests",Object.keys(A.active).length),t=l("ui.grimoire.completedQuests",Object.keys(A.finished).length);this.counter.setText(e+" - "+t)},n.prototype._selectQuest=function(e,t){if(e){var i=this.questsList.getItem(e);if(i){this.questsList.selectItem(e);var n=i.sublist.getChild(t);n.hasClassName("completed")||(n.tap(),this.questsList.scrollToElement(n))}}},n.prototype._updateQuestItemsStyle=function(){for(var e,t,i,n=this.questsList.getItems(),o=0,s=0;s<n.length;s+=1)if(e=n[s],e.isVisible()&&(e.toggleClassName("odd",o%2===0),o+=1,e.sublist.isVisible())){t=e.sublist.getChildren();for(var a=0;a<t.length;a+=1)i=t[a],i.isVisible()&&(i.toggleClassName("odd",o%2===0),o+=1)}},n.prototype._showCompletedQuest=function(){for(var e,t,i,n,o=M.getValue("showCompletedQuest",!1),s=this.questsList.getItems(),a=!0,r=0;r<s.length;r+=1){t=s[r],i=t.sublist.getChildren(),a=!0;for(var l=0;l<i.length;l+=1)n=i[l],e=n.getWuiName(),o||!A.finished[e]?(a=!1,n.show()):n.hide();a?t.hide():t.show()}this._updateQuestItemsStyle(),this.questsList.refresh()},n.prototype._resetObjectives=function(){this.locateButtonMap={},this._removeObjectivePlaceHolder(),this.objectives.clearContent(),this.objectives.appendChild(this.objectivePlaceHolder),this.objectivesScroller.refresh()},n.prototype._removeObjectivePlaceHolder=function(){var e=this.objectives.getChild("objectivePlaceHolder");e&&this.objectives.removeChild(e)},n.prototype._createLocateButton=function(e,t,i,n){var o=this,s=window.gui.GPS,a=e.appendChild(new T("div",{className:"locateButton"}));a.createChild("div",{className:"locateBackground"}),a.createChild("div",{className:"locateIcon"});var r=s.getQuestObjectivePoiId(i.objectiveId);this.locateButtonMap[r]=a,b(e),e.on("tap",function(){s.getPOI(r)?(s.removePOI(r),s.isAtLeastOneQuestObjectiveFollowed(n)||o._updateQuestFollow(n,!1,!1)):(s.addQuestObjectiveFromObjective({objectiveDb:t,objectiveId:i.objectiveId,questId:n}),s.questFollower.isQuestFollowed(n)||o._updateQuestFollow(n,!0,!1))}),a.toggleClassName("selected",!!s.getPOI(r))},n.prototype._createObjectiveElement=function(e,t,i){var n=new T("div",{className:"objectiveRow"}),o=n.createChild("div",{className:"description"});o.appendChild(c.process(t.text));var s=t.objectiveStatus;return n.toggleClassName("complete",!s),n.toggleClassName("disabled",!s),s&&(e.coords||e.mapId)?(this._createLocateButton(n,e,t,i),n):n},n.prototype._displayStepObjectives=function(e){this._resetObjectives();var t=this.currentQuest.objectives;if((!this.currentQuest||this.currentQuest.questId!==e.questId||this.currentQuest.stepId===e.id)&&t.length){this._removeObjectivePlaceHolder();for(var i,n=0,o=t.length;n<o;n+=1)i=t[n],this.objectives.appendChild(this._createObjectiveElement(this.currentQuest.dbObjectives[i.objectiveId],i,e.questId));this.objectivesScroller.refresh()}},n.prototype._displayStepRewards=function(e){this.rewardList.clearContent();for(var t=window.gui.playerData.characterBaseInformations.level,i=0,n=e.length;i<n;i+=1){var a=this.currentQuest.dbRewards[e[i]];!a||a.levelMin!==-1&&t<a.levelMin||a.levelMax!==-1&&t>a.levelMax||(o(this.rewardList,a.itemsReward),s(this.rewardList,a.emotesReward))}},n.prototype._setKamas=function(e){var t=f.calculateStepKamasRatio(e);return t?(this.kamasPoint.show(),void this.kamas.setText(t)):void this.kamasPoint.hide()},n.prototype._setXp=function(e){var t=f.calculateStepXpRatio(e);return t?(this.xpPoint.show(),void this.xp.setText(t)):void this.xpPoint.hide()},n.prototype._displayStepData=function(e){var t=window.gui.GPS;this.stepTitle.setText(e.nameId),this.description.clearContent(),this.description.appendChild(c.process(e.descriptionId)),this.questFollowed.show(),this.questFollowed.toggleClassName("selected",t.questFollower.isQuestFollowed(this.currentQuest.questId)),this._displayStepObjectives(e),this._displayStepRewards(e.rewardsIds),this._setKamas(e),this._setXp(e)},n.prototype._displayUnknownStep=function(e){this.stepTitle.setText(e.nameId),this.description.setText(l("ui.grimoire.quest.descriptionNonAvailable")),this._resetObjectives(),this._displayStepRewards(e.rewardsIds),this._setKamas(e),this._setXp(e)},n.prototype._updateStepList=function(){var e=this.currentQuest;this.stepSelector.clearContent(),this.stepSelector.index=0;for(var t=e.dbQuest.stepIds,i=0,n=t.length;i<n;i+=1){var o=t[i];this.stepSelector.addOption(l("ui.grimoire.quest.step")+" "+(i+1),o),e.stepId===o&&(this.stepSelector.index=i)}this.stepSelector.select(e.stepId),this.stepSelector.show()},n.prototype._getQuestCategoryElement=function(e){var t=A.all[e];return this.questsList.getItem(t.dbQuest.categoryId)},n.prototype._sortSublist=function(e){var t=this._getQuestCategoryElement(e),i=t.sublist.getChildren();i.sort(function(e,t){return parseInt(e.getWuiName(),10)-parseInt(t.getWuiName(),10)}),i.sort(function(e,t){return e.hasClassName("completed")?1:t.hasClassName("completed")?-1:void 0});for(var n=0;n<i.length;n+=1)t.sublist.appendChild(i[n])},n.prototype._addQuest=function(e){var t=this,i=window.gui.GPS,n=A.all[e],o=this._getQuestCategoryElement(e);o.show();var s=o.sublist.getChild(e);if(!s){var a=new T("div",{className:"label",name:e});a.hourglass=a.createChild("div",{className:"icon"}),i.questFollower.isQuestFollowed(e)||a.hourglass.addClassNames("notFollowed"),a.createChild("div",{className:"text",text:n.dbQuest.nameId}),b(a),a.on("tap",function(){m("GEN_BUTTON");var e=a.getWuiName();t.currentQuest=A.all[e],t._updateStepList(),t._resetSelectedQuestElement(),a.addClassNames("selected"),t.selectedQuestElement=a}),s=o.sublist.appendChild(a)}A.active[e]?(s.delClassNames("completed"),s.enable()):(s.addClassNames("completed"),s.disable())},n.prototype._endQuest=function(e){var t=window.gui.GPS,i=this._getQuestCategoryElement(e),n=i.sublist.getChild(e);n&&(n.addClassNames("completed"),n.disable(),t.questFollower.unfollowQuest(e,!1))},n.prototype._updateQuestFollow=function(e,t,i){var n=window.gui.GPS,o=n.questFollower.isQuestFollowed(e);t&&!o?n.questFollower.followQuest(e,i):!t&&o&&n.questFollower.unfollowQuest(e,i),this.questFollowed.toggleClassName("selected",t),this._updateHourglass(e,t)},n.prototype._updateHourglass=function(e,t){var i=this._getQuestCategoryElement(e),n=i.sublist.getChild(e);n&&n.hourglass.toggleClassName("notFollowed",!t)}},function(e,t){},function(e,t){function i(e,t){return Math.floor(e*Math.pow(100+2*e,2)/20*t.duration*t.xpRatio)}t.calculateStepKamasRatio=function(e){var t=window.gui.playerData.characterBaseInformations.level,i=e.kamasScaleWithPlayerLevel?t:e.optimalLevel;return Math.floor((Math.pow(i,2)+20*i-20)*e.kamasRatio*e.duration)},t.calculateStepXpRatio=function(e){var t=1.5,n=.7,o=window.gui.playerData.characterBaseInformations.level,s=1+window.gui.playerData.experienceFactor/100,a=e.optimalLevel;if(o>a){var r=Math.floor(Math.min(o,a*t)),l=(1-n)*i(a,e),c=n*i(r,e);return Math.floor((l+c)*s)}return Math.floor(i(o,e)*s)}},function(e,t,i){function n(e,t){if(e.isItem)return-1;if(t.isItem)return 1;var i=e.getProperty("minPlayerLevel",1),n=t.getProperty("minPlayerLevel",1);return i<n?-1:i>n?1:e.id>t.id?1:e.id<t.id?-1:0}function o(e,t){return e.isItem?-1:t.isItem?1:e.level>t.level?1:e.level<t.level?-1:e.id>t.id?1:e.id<t.id?-1:0}function s(e,t){return e.id===g.WEAPON_SPELL_ID||(void 0===t&&(t=e.level),e.getProperty("minPlayerLevel",t)<=window.gui.playerData.characterBaseInformations.level)}function a(){p.call(this,"div",{className:"SpellsWindow",name:"spells"}),this.mustRefreshAll=!0,this.once("open",function(){this._createDom(),this._setupEvents()});var e=window.gui;this.on("open",function(){this.updateRemainingPoints(),this._refreshAllContent(),e.shortcutBar.openPanel("spell")}),this.on("focus",function(){e.shortcutBar.openPanel("spell")})}i(907);var r=i(172).inherits,l=i(197),c=i(29).getText,d=i(335).DofusButton,u=i(539),h=i(532),p=i(321),m=i(745),f=i(317),g=i(412),_=i(182),v=i(247).playUiSound,y=i(415).SpellData.SPELL_STATUS;r(a,p),e.exports=a,a.prototype._createDom=function(){function e(e){var t=new p("div",{className:"icon"}),i=e.getIconUrl();return i&&t.setStyle("backgroundImage",i),t}function t(e){var t=new d("",{name:"addButton"});return t.spell=e,t.on("tap",function(){var e=this.rootElement.getBoundingClientRect();window.gui.openContextualMenu("spellUpgrade",{spell:this.spell,remainingPoints:i.remainingPoints},{x:e.left+e.width,y:e.top}),v("PLUS_BUTTON")}),i._refreshAddButtonState(t),t}var i=this,s=this.createChild("div",{className:"col1"});this.col2=this.createChild("div",{className:"col2"}),this.selector=s.appendChild(new h),this.table=s.appendChild(new u([{id:"icon",format:e,sort:n},{id:"name",header:c("ui.common.spellName"),getContent:function(e){return e.getName()},sort:!0},{id:"rank",header:c("ui.common.level"),format:function(e){return e.isItem||e.id===g.WEAPON_SPELL_ID?"-":e.level},sort:o},{id:"add",format:t}],"id")),this.table.on("rowTap",function(e,t){i.displaySpell({spell:t,imageUri:e.icon.content.getStyle("backgroundImage")}),v("GEN_BUTTON")});var a,r=!0;this.table.addFilter(function(e){return r||e.getProperty("typeId")===a}),this.selector.on("change",function(e){r=!1,"-"===e?r=!0:a=parseInt(e,10),i.table.filter()});var l=s.createChild("div",{className:"pointsBox"});l.createChild("div",{text:c("ui.grimoire.spellCapital"),className:"label"}),this.remainingPointsBox=l.createChild("div",{className:"remainingPoints"})},a.prototype._setupEvents=function(){var e=this,t=window.gui;t.on("SpellUpgradeFailureMessage",function(){window.gui.openPopup({title:c("ui.common.error"),message:c("ui.grimoire.popup.upgradeSpellFailMessage")})}),t.on("CharacterLevelUpMessage",function(){e.enableSpellsOnLevelUp()}),t.on("disconnect",function(){e.mustRefreshAll=!0}),t.playerData.characters.mainCharacter.on("weaponChanged",function(){e.updateWeaponSpell()});var i=t.playerData.characters;i.mainCharacter.on("spellUpgrade",function(t,i){return e.table.getRow(t)?void e._updateDisplayedSpellLevel(t,i):console.error(new Error("spell "+t+" does not exist in spell window"))}),i.mainCharacter.on("newSpellLearned",function(t){if(!e.table.getRow(t)){var i=window.gui.playerData.characters.mainCharacter.spellData.spells[t];if(!i)return console.error(new Error("spell "+t+" is not loaded"));var n={};n[i.id]=i,e.table.addMap(n),i.getIconUrl()||_.preloadImage(i.getIconUri(),function(t){i.spell.image=t;var n=e.table.getCell(i.id,"icon");n.setStyle("backgroundImage",t),e.currentSpellId===i.id&&e.displaySpell({spell:i,imageUri:t}),e.refreshAllSpellState()})}}),t.playerData.on("spellsPointsUpdated",function(){e.updateRemainingPoints(),e._refreshAllAddButtonState()}),i.on("spellList",function(){e._askForRefresh()}),i.on("switchControlledCharacter",function(){f.cancelDragFromSource("spellsWindow")})},a.prototype._refreshAllContent=function(){this.mustRefreshAll=!1;var e=window.gui.playerData.characters,t=e.getControlledCharacter();this._onMainCharacter=e.isMainCharacterControlled(),this.table.setSorter(n),this._loadAllSpells(t.spellData.getSpells(y.VISIBLE)),this.setupSelectorOptions(),this.table.selectFirstRow()},a.prototype._askForRefresh=function(){this.isVisible()?this._refreshAllContent():this.mustRefreshAll=!0},a.prototype.updateRemainingPoints=function(){var e=window.gui.playerData.characters.getControlledCharacter(),t=e.characteristics.spellsPoints;this.remainingPoints!==t&&(this.remainingPointsBox.setText(t),this.remainingPoints=t)},a.prototype.setupSelectorOptions=function(){var e=this;this.selector.clearContent(),this.selector.addOption(c("ui.common.allTypes"),"-"),this.selector.setValue("-");var t={},i=window.gui.playerData.characters.getControlledCharacter(),n=i.spellData.getSpells(y.VISIBLE);for(var o in n){var s=n[o],a=s.getProperty("typeId");t[a]||(e.selector.addOption(s.getHumanReadableSpellType(),a),t[a]=!0)}},a.prototype.updateWeaponSpell=function(){var e=this,t=window.gui.playerData.characters.mainCharacter.spellData.spells[g.WEAPON_SPELL_ID];_.preloadImage(t.getIconUri(),function(i){e.table.updateRow(t);var n=e.table.getCell(t.id,"icon");n.setStyle("backgroundImage",i),e.refreshSpellState(t.id),e.currentSpellId===t.id&&e.displaySpell({spell:t,imageUri:i})})},a.prototype._loadAllSpells=function(e){this.spellMap=e,this.table.clearContent(),this.table.addMap(e);var t=[],i=[];for(var n in e){var o=e[n];o.getIconUrl()||(i.push(o),t.push(o.getIconUri()))}var s=this;_.preloadImages(t,function(e){for(var t=0;t<e.length;t++){var n=i[t],o=n.spell.image=e[t],a=s.table.getCell(n.id,"icon");a.setStyle("backgroundImage",o),s.currentSpellId===n.id&&s.displaySpell({spell:n,imageUri:o})}s.refreshAllSpellState()})},a.prototype.setSpellDraggable=function(e,t){var i=this.table.getCell(e,"icon");if(f.isDraggable(i))return void(t?f.enableDrag(i):f.disableDrag(i));if(t){var n=this.spellMap[e].getIconUrl();n&&f.setDraggable(i,{backgroundImage:n},"spellsWindow",{spellId:e},{dragOnTouchstart:!0})}},a.prototype.setSpellEnabled=function(e,t){this.table.getRow(e).toggleClassName("grayed",!t)},a.prototype.refreshSpellState=function(e){var t=this.spellMap[e],i=t&&(t.isItem||s(t)),n=i&&this._onMainCharacter;this.setSpellEnabled(e,i),this.setSpellDraggable(e,n)},a.prototype.refreshAllSpellState=function(){for(var e in this.spellMap)this.refreshSpellState(e)},a.prototype._updateDisplayedSpellLevel=function(e,t){if(this.table.hasRow(e)){var i=this.table.getCell(e,"rank");i.setText(t)}},a.prototype.enableSpellsOnLevelUp=function(){this.table.getRowCount()&&(this.refreshAllSpellState(),this._refreshAllAddButtonState())},a.prototype._refreshAllAddButtonState=function(){for(var e in this.spellMap)if(this.table.hasRow(e)){var t=this.table.getCell(e,"add");this._refreshAddButtonState(t)}},a.prototype._refreshAddButtonState=function(e){var t=e.spell,i=t.level;if(0===i||i===t.getMaxLevel())return void e.hide();if(!s(t,i+1))return void e.hide();e.show();var n=t.getUpgradeCost();return this.remainingPoints<n?void e.disable():void e.enable()},a.prototype.displaySpell=function(e){function t(t,o){var a=Number(o)+1,r=t.createChild("div",{className:"tab",text:a});r.rankNum=o,i.getSpellLevelId(a)===s&&r.addClassNames("on"),l(r),r.on("tap",function(){n.displaySpell({spell:e.spell,imageUri:e.imageUri,spellLevel:a}),v("TAB")})}var i,n=this;e.spellLevel&&e.spellLevel!==e.spell.level?(i=e.spell.clone(),i.setLevel(e.spellLevel)):i=e.spell;var o=i.level,s=i.getSpellLevelId(o),a=e.imageUri;if(this.currentSpellLevelId===s)return void this.tabIcon.setStyle("backgroundImage",a);this.col2.clearContent(),this.currentSpellLevelId=s,this.currentSpellId=i.id;for(var r=n.col2.createChild("div",{className:"tabs"}),d=i.getMaxLevel(),u=0;u<d;u++)t(r,u.toString());var h=n.col2.createChild("div",{className:"panel"}),p=h.createChild("div",{className:"header"}),f=this.tabIcon=p.createChild("div",{className:"icon"});f.setStyle("backgroundImage",a);var g=p.createChild("div",{className:"panelTop"});g.createChild("div",{className:"spellName",text:i.getName()}),g.createChild("div",{className:"minPlayerLevel",text:c("ui.spell.requiredLevel")+" "+(i.getProperty("minPlayerLevel",o)||1)}),h.appendChild(new m({spell:i,level:o},{spellTooltipAll:!0}))}},function(e,t){},function(e,t,i){function n(){l.call(this,"div",{className:"jobsWindow",name:"jobs"});var e=this;this.jobButtons=[],this.jobSelectButtons=[],this.jobSelectSpecialButtons=[],this._expBarTooltip=new l("div"),this.mustRefreshJobs=!0,this.numRefreshTasks=0,this._setupEvents(),this.on("open",function(t){e.jobListElement||e._createDom();var i=t?t.jobId:null;return e.mustRefreshJobs?e._refreshJobs(i):void(i&&e.selectJob(i))}),this.on("close",function(){e.mustRefreshJobs=!0,_.getWindow("jobOptions").openState&&_.close("jobOptions"),e.recipeList.reset()})}function o(e,t){var i=e.getChild("level");i&&(t=t?p("ui.common.short.level")+" "+t:"",i.setText(t))}function s(e){var t=e.jobId?C[e.jobId]:null;e.getChild("jobIcon").setImage(t)}function a(e,t){var i,n;null===t?(i=null,n=null):(i=t.id,n=t.experience?t.experience.jobLevel:1),e.jobId=i,s(e),o(e,n)}i(909);var r=i(172).inherits,l=i(321),c=i(30),d=i(557),u=i(335),h=i(897),p=i(29).getText,m=i(461),f=i(739),g=i(737),_=i(194),v=i(910),y=i(182),b=i(337).addTooltip,M=i(167),w=3,T=3,C={};r(n,l),e.exports=n,n.prototype._reset=function(){this.mustRefreshJobs=!0,this.numRefreshTasks=0},n.prototype._refreshJobs=function(e){this.mustRefreshJobs=!1,window.gui.playerData.isSubscriber()?(this._bonusPackText.setHtml(p("tablet.shop.xpBonusActive",M.BONUS_PACK_XPJOB)),this._linkToShop.hide()):(this._bonusPackText.setHtml(p("tablet.shop.xpBonusInactive",M.BONUS_PACK_XPJOB)),this._linkToShop.show());var t=window.gui.playerData.jobs;this.jobMap=t.list;var i=Object.keys(this.jobMap);if(i.length){this._updateJobButtons(t.jobOriginalOrder);var n=this;this._getJobImages(function(){n._updateJobIcons()}),e=e||t.jobOriginalOrder[0],this.selectJob(e,!0)}},n.prototype._getJobImages=function(e){var t=[],i=[],n=this.jobMap;for(var o in n){var s=n[o];s.info.iconId===-1||C[o]||(t.push("gfx/jobs/"+s.info.iconId+".png"),i.push(o))}return t.length?void y.preloadImages(t,function(t){for(var n=0;n<t.length;n++)C[i[n]]=t[n];return e()}):e()},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"col1"}),i=this.createChild("div",{className:"col2"});this.jobListElement=t.createChild("div",{className:"jobsList"});for(var n=0;n<w;n++)this._createJobIcon(n);var o=this.jobListElement.createChild("div",{className:"specialisation"});for(o.createChild("div",{className:"text",text:p("ui.common.specializations")});n<w+T;n++)this._createJobIcon(n,o);this.jobExpBlock=t.createChild("div",{className:"jobExpBlock"}),this.jobWrapper=this.jobExpBlock.createChild("div",{className:"jobWrapper"}),this.jobName=this.jobWrapper.createChild("div",{className:"jobName"}),this.jobLevel=this.jobWrapper.createChild("div",{className:"jobLevel"}),this._jobExpBar=this.jobExpBlock.appendChild(new d({className:"jobExpBar"})),b(this._jobExpBar,this._expBarTooltip),this.skillsBlock=t.createChild("div",{className:"skillsBlock"}),this.skillsTitle=this.skillsBlock.createChild("div",{className:"skillsTitle",text:p("ui.common.abilities")});var s=t.appendChild(new u({text:p("ui.craft.jobOptions"),className:["greenButton"]}));s.on("tap",function(){_.open("jobOptions",{jobId:e.selectedJobId})}),this.skillsList=this.skillsBlock.appendChild(new h({className:"skillsList",cannotActivate:!0})),this.recipeList=i.appendChild(new v);var a=i.createChild("div",{className:"bonusPackMessage"});this._bonusPackText=a.createChild("span"),this._linkToShop=a.appendChild(new u({className:"linkToShop",scaleOnPress:!1})),this._linkToShop.on("tap",function(){_.open("market",{tabId:"shop",tabParams:{category:"bonuspack"}})})},n.prototype._createJobIcon=function(e,t){var i=this,n=t||this.jobListElement,o=n.createChild("div",{className:"job"});o.itemSlot=o.appendChild(new f({name:"jobIcon"})),this.jobButtons.push(o),t?this.jobSelectSpecialButtons.push(o):(this.jobSelectButtons.push(o),o.createChild("div",{className:"level",name:"level"})),o.itemSlot.on("tap",function(){o.jobId&&i.selectJob(o.jobId)})},n.prototype._updateJobButtons=function(e){for(var t=0;t<this.jobButtons.length;t++)a(this.jobButtons[t],null);var i=0,n=0;for(t=0;t<e.length;t++){var o=this.jobMap[e[t]],s=o.info.specializationOfId?this.jobSelectSpecialButtons[n++]:this.jobSelectButtons[i++];a(s,o)}},n.prototype._updateJobIcons=function(){for(var e=0;e<this.jobButtons.length;e++)s(this.jobButtons[e])},n.prototype._getJobButton=function(e){for(var t=this.jobButtons,i=0;i<t.length;i++)if(t[i].jobId===e)return t[i];return console.error("_getJobButton: invalid Job ID: "+e),null},n.prototype._setupEvents=function(){var e=this,t=window.gui.playerData.jobs;window.gui.on("disconnect",function(){e._reset()}),t.on("jobListUpdated",function(){var i=0!==Object.keys(t.list).length;i&&(e.mustRefreshJobs=!0,e.isVisible()&&e._refreshJobs())}),t.on("jobLevelUp",function(t,i){if(!e.mustRefreshJobs){var n=e._getJobButton(t.id);if(n)return o(n,i),e.isVisible()&&t.id===e.selectedJobId?e._refreshJobs(t.id):void 0}}),t.on("jobExperienceUpdate",function(t){e.isVisible()&&t.jobId===e.selectedJobId&&e._updateJobInfo(t)})},n.prototype._updateJobInfo=function(e){var t="";t=100!==e.currentLevel?e.percentage+"% ("+e.currentExperience+" / "+e.levelExperienceCeil+")":e.percentage+"% ("+e.currentExperience+")",this._expBarTooltip.setText(t),this._jobExpBar.setValue(e.percentage/100),this.jobName.setText(this.jobMap[e.jobId].info.nameId),this.jobLevel.setText(p("ui.common.level")+" "+e.currentLevel)},n.prototype._selectJobButton=function(e){var t=this._getJobButton(e);if(!t)return!1;if(this.currentJobBtn){if(this.currentJobBtn.jobId===e)return!1;this.currentJobBtn.itemSlot.unselect()}return t.itemSlot.select(),this.currentJobBtn=t,!0},n.prototype.selectJob=function(e,t){if(this._selectJobButton(e)||t){var i=this;window.setTimeout(function(){i._refreshCurrentJob(e)},50)}},n.prototype._afterRefreshTask=function(){if(this.numRefreshTasks--,this.numRefreshTasks>0)return!this.lastJobIdRequested;if(!this.lastJobIdRequested)return!0;var e=this.lastJobIdRequested;return this.lastJobIdRequested=null,this._refreshCurrentJob(e),!1},n.prototype._refreshCurrentJob=function(e){if(this.numRefreshTasks)return void(this.lastJobIdRequested=e);this.selectedJobId=e;var t=window.gui.playerData.jobs,i=2,n=[],o=this.jobMap[e],s=o.description.skills;this._updateJobInfo(t.getJobExperience(e)),this.skillsList.empty();for(var a=[],r=[],d=[],u=[],h=[],f=0;f<s.length;f++){var _=s[f],v=_.skillId,y=_.info;if(y){var b=new l("div",{className:"label"});this.skillsList.addItem(v,b);var M=b.appendChild(new g);M.addClassNames("skillIcon"),h.push(M);var w=b.createChild("div",{className:"skillLeft"});w.createChild("div",{className:"skillName",text:y.nameId}),d.push(w.createChild("div",{className:"skillDetail"})),u.push(y.interactiveId);var T=b.createChild("div",{className:"skillRight"}),C=T.createChild("div",{className:"skillStats"});if("SkillActionDescriptionCollect"===_._type){C.setText(p("ui.jobs.collectSkillInfos",_.time/10,_.min,_.max)),r.push(y.gatheredRessourceItem);var A=T.appendChild(new g({descriptionOptions:{effects:!1}}));a.push(A)}if("SkillActionDescriptionCraft"===_._type){var I=p("ui.jobs.slotPercents",_.maxSlots,_.probability);C.setText(I),n=n.concat(y.recipes),C.addClassNames("bottom")}}}this.numRefreshTasks+=4;var S=this;window.gui.playerData.jobs.getToolFromJob(e,function(t,i){if(t)return S._afterRefreshTask(),console.error("JobsWindow: Failed to get tools image for jobId",e,t);if(S._afterRefreshTask())for(var n=0,o=h.length;n<o;n+=1){var s=h[n];s.setItem(i)}}),m.getItems(r,function(e,t){if(e)return S._afterRefreshTask(),console.error("JobsWindow: Failed to get ingredients",e);if(S._afterRefreshTask())for(var i=0;i<t.length;i++){var n=t[i];a[i].setItem(n)}}),c.getDataMap("Interactives",u,function(e,t){if(e)return S._afterRefreshTask(),console.error("JobsWindow: Failed to get interactive data",e);if(S._afterRefreshTask())for(var i=0;i<u.length;i++){var n=u[i],o=t[n];o?d[i].setText(o.nameId):console.error(new Error("JobsWindow: no interactive for id "+n))}}),this.recipeList.reset();var E=window.gui.playerData.jobs.getMaxSlotsByJobId(e)||i;this.recipeList.addRecipes(n,{nbCase:E},function(){S._afterRefreshTask()})}},function(e,t){},function(e,t,i){function n(e){function t(e,t){function n(e){i.filterNbSlots[o.slotNumber]=e,i.filterRecipes()}var o=i.filterCheckboxes.appendChild(new l(e,t));return o.slotNumber=e,o.on("change",n),o}e=e||{};var i=this;s.call(this,"div",{className:"RecipeList"}),this._filterCraftableOnly=!1,this.isMenuOnItemDisabled=!!e.isMenuOnItemDisabled,this.selectedRecipe=null,this.tappedRecipe=null;var n=this.createChild("div",{className:"searchBar"}),o=n.createChild("div",{className:"searchLine"});o.createChild("div",{className:"label",text:r("ui.common.recipes",2)});var d=new c({className:"searchInput"});d.on("change",function(e){i._checkOnInput(e)}),this.searchInput=o.appendChild(d);var u=n.createChild("div",{className:"searchLine"});u.createChild("div",{className:"label",text:r("ui.common.ingredients")}),this.filterNbSlots={},this.filterText="",this.filterCheckboxes={},this.filterCheckboxes=u.createChild("div",{className:"filterCheckboxes"});for(var h=1;h<=g;h+=1)this.filterCheckboxes[h]=t(h,!0),i.filterNbSlots[h]=!0;this.recipesWrapper=this.appendChild(new a({className:["recipesWrapper","spinner"]})),this._recipesPlaceholder=this.recipesWrapper.createChild("div",{className:"recipesPlaceholder",hidden:!0}),this._recipesPlaceholder.createChild("div",{className:"recipesPlaceholderText",text:r("ui.craft.noCraftAvailable")}),this.recipesList=this.recipesWrapper.content,this._showCraftableCheckbox=this.appendChild(new l(r("ui.craft.possibleRecipes"))),this._showCraftableCheckbox.addClassNames("possibleRecipeCheckbox"),this._showCraftableCheckbox.toggleDisplay(!!e.showCraftableFilter),this._showCraftableCheckbox.on("change",function(e){i.filterCraftable(e)}),this._checkOnInput=function(e){e.length>=3?(i.filterText=f(e),i.filterRecipes()):""!==i.filterText&&(i.filterText="",i.filterRecipes())}}i(911);var o=i(172).inherits,s=i(321),a=i(436),r=i(29).getText,l=i(612),c=i(530),d=i(461),u=i(31),h=i(197),p=i(912),m=i(317),f=i(339).simplifyString,g=8,_=3;o(n,s),e.exports=n,n.prototype.addRecipes=function(e,t,i){t=t||{},this._recipesPlaceholder.hide(),this.recipesList.clearContent();var n=this;this._nbCase=t.nbCase||(Object.keys(this.filterNbSlots).length?null:g),i=i||function(){};var o=(new Date).getTime();this._timestamp=o;var s={},a=[];if(0===e.length)return this._recipesPlaceholder.show(),this.recipesWrapper.delClassNames("spinner"),i();for(var r=0,l=e.length;r<l;r+=1){var c=e[r];if(c){a.push(c);var h=c.ingredientIds;s[c.resultId]=!0;for(var p=0,m=h.length;p<m;p+=1){var f=h[p];s[f]=!0}}}s=Object.keys(s),d.getItems(s,function(e){return e?(console.error("Failed to get ingredients",e),i(e)):n._timestamp!==o?i():u.eachSeries(a,function(e,t){n._addRecipe(e,t)},function(e){if(e)return console.error(e),i(e);if(n._nbCase)for(var t=1;t<=g;t+=1){var o=t<=n._nbCase;n.filterNbSlots[t]=o,n.filterCheckboxes[t].toggleActivation(o)}return n.recipesWrapper.delClassNames("spinner"),n.recipesList.show(),n.filterRecipes(),i()})})},n.prototype._addRecipe=function(e,t){function i(){n.emit("recipeSelected",o)}var n=this,o=e.resultId,s=new p(e,{nbCases:this._nbCase,isMenuOnItemDisabled:this.isMenuOnItemDisabled});return n.recipesList.appendChild(s),h(s,{doubletapTimeout:1}),s.on("tap",function(){if(n.tappedRecipe&&n.tappedRecipe.rootElement){if(n.tappedRecipe===this)return void i();n.tappedRecipe.delClassNames("tapped")}this.addClassNames("tapped"),n.tappedRecipe=this}),s.on("itemTapped",function(e){n.emit("itemTapped",e)}),s.on("craftButtonTapped",function(){i()}),s.setupRecipe(function(e,n){if(e)return console.error(new Error("Cannot setup recipe for recipeId "+o)),t(e);var a=s.getItemSlot();m.setDraggable(a,{backgroundImage:a.image},"recipeList",{selectRecipe:i,source:"recipeList"}),t(null,n)})},n.prototype.isRecipeCraftableFromInventory=function(e){var t=this.recipesList.getChild(e);return t.isCraftableFromInventory()},n.prototype.filterCraftable=function(e){this._filterCraftableOnly=e,this.filterRecipes()},n.prototype.filterRecipes=function(){for(var e=this.filterText.length,t=this.recipesList.getChildren(),i=0,n=t.length;i<n;i+=1){var o=t[i],s=!0;o.isCraftableFromInventory()?o.craftButton.enable():(o.craftButton.disable(),this._filterCraftableOnly&&(s=!1)),s&&this.filterNbSlots[o.nbIngredients]?e>=_&&o.searchString.indexOf(this.filterText)===-1&&(s=!1):s=!1,o.toggleDisplay(s)}this.recipesWrapper.refresh()},n.prototype.highlightRecipe=function(e){if(this.selectedRecipe&&this.selectedRecipe.rootElement&&this.selectedRecipe.delClassNames("selected"),null!==e){var t=this.recipesList.getChild(e);t&&(t.addClassNames("selected"),this.selectedRecipe=t)}},n.prototype.reset=function(){this.selectedRecipe=null,this.tappedRecipe=null,this._recipesPlaceholder.hide(),this.recipesList.hide(),this.recipesList.clearContent(),this.recipesWrapper.addClassNames("spinner"),this.filterNbSlots={},this.filterText="",this.searchInput.setValue(""),this._showCraftableCheckbox.deactivate()}},function(e,t){},function(e,t,i){function n(e,t){var i=this;l.call(this,"div",{className:"RecipeBox",name:e.resultId}),t=t||{},this.rawRecipe=e,this.isMain=t.isMain,this.nbCases=t.nbCases||0,this.isMenuOnItemDisabled=!!t.isMenuOnItemDisabled;var n=i.createChild("div",{className:"recipeTitle"});this._item=n.appendChild(new a({noDoubleTap:!0})),this.isMenuOnItemDisabled||this._item.setContextMenu("item",{}),this._recipeLeft=n.createChild("div",{className:"recipeLeft"}),this._recipeLeft.createChild("div",{className:"recipeName",text:e.resultNameId});var s=n.createChild("div",{className:"recipeRight"});s.createChild("div",{className:"recipeLevel",text:o("ui.common.short.level")+" "+e.resultLevel});var r=e.ingredientIds.length,u=t.nbCases-r>=4,p=u?0:h[r];if(p>0&&window.gui.playerData.isSubscriber()){var m=Math.floor(p*d.BONUS_PACK_XPJOB/100);p+=' <span class="bonusXP">(+'+m+")</span>"}var f=s.createChild("div",{className:"recipeXP"});f.setHtml(o("ui.tooltip.monsterXpAlone",p)),u&&f.addClassNames("warningText"),this._ingredientsList=i.createChild("div",{className:"ingredientsList"}),this.craftButton=this._ingredientsList.appendChild(new c({className:"recipeButton",scaleOnPress:!0})),this.craftButton.on("tap",function(){
i.emit("craftButtonTapped")})}i(913);var o=i(29).getText,s=i(461),a=i(737),r=i(172).inherits,l=i(321),c=i(335),d=i(167),u=i(339).simplifyString,h={1:1,2:10,3:25,4:50,5:100,6:250,7:500,8:1e3};r(n,l),e.exports=n,n.prototype.setupRecipe=function(e){function t(){i.emit("itemTapped",this.dbItem)}var i=this,n=this.rawRecipe,o=window.gui.playerData.inventory,r=n.resultId,l=[r].concat(n.ingredientIds),c=n.ingredientIds.length;s.getItems(l,function(l){if(l)return console.error(l),e(l);var d=s.items[r];if(!d)return e();i._item.setItem(d),i._item.on("tap",t),i._recipeLeft.createChild("div",{className:"recipeSkillName",text:d.nameId});for(var h=d.nameId,p={},m=0;m<c;m+=1){var f=s.items[n.ingredientIds[m]];if(f){h+=" "+f.nameId;var g=n.quantities[m],_=null;if(i.isMain){var v=o.getGenericItemCount(f.id);_=v>=g?"quantityGood":"quantityNoGood",g=v+"/"+g}var y=new a({itemData:f,quantity:g,forceQuantity:!0,noDoubleTap:!0});_&&y.addClassNames(_),i._ingredientsList.appendChild(y),y.on("tap",t),i.isMenuOnItemDisabled||y.setContextMenu("item",{}),p[f.id]=g}}return i.nbIngredients=c,i.searchString=u(h),i.quantityList=p,e(null,i)})},n.prototype.getItemSlot=function(){return this._item},n.prototype.isCraftableFromInventory=function(){var e=window.gui.playerData.inventory.quantityList,t=this.quantityList;for(var i in t)if(!e[i]||e[i]<t[i])return!1;return!0}},function(e,t){},function(e,t,i){function n(){c.call(this,{title:s("ui.zaap.prism"),className:"PrismVulnerabilityDateWindow",positionInfo:{left:"c",top:"c",width:400,height:256}});var e,t,i,n,o,p,m,f,g;this.once("open",function(){e=this.windowBody.createChild("div",{className:"subAreaName"}),t=this.windowBody.createChild("div",{className:"explanation"});var r=this.windowBody.createChild("div",{className:"selectorBox"});i=r.appendChild(new a({className:"hours"})),i.on("change",function(e){f=e});for(var c=0;c<10;c+=1)i.addOption("0"+c,c);for(c=10;c<24;c+=1)i.addOption(c,c);n=r.appendChild(new a({className:"minutes"})),n.on("change",function(e){g=e}),n.addOption("00",h[0]),n.addOption("30",h[30]);var _=this,v=this.windowBody.createChild("div",{className:"buttonBox"});o=v.appendChild(new l(s("ui.common.save"))),o.on("tap",function(){var e=d.time.timezoneOffset,t=e/1e3*60%60,i=e/36e5%24,n=4*(f-i)+(g-t);n<0&&(n+=96),window.dofus.sendMessage("PrismSettingsRequestMessage",{subAreaId:m.subAreaId,startDefenseTime:n}),u.close(_.id)}),p=v.appendChild(new l(s("ui.common.cancel"))),p.on("tap",function(){u.close(_.id)})}),this.on("open",function(o){m=o.prism;var a=o.vulnerableTime.getServerDate(),l=a.toString(),c=m.enrichData;e.setText(c.subAreaName+" ("+c.areaName+")");var d=window.gui.serversData.sessionConstants[r.SERVER_CONST_KOH_DURATION];t.setText(s("ui.prism.vulnerabilityHourInfos",Math.round(d/1e3/360)/10,l.hour,l.minute)),i.select(a.hour),n.select(h[a.minute]||h[0])})}i(915);var o=i(172).inherits,s=i(29).getText,a=i(532),r=i(645).serverConstants,l=i(335).DofusButton,c=i(541),d=i(28),u=i(194),h={0:0,30:2};o(n,c),e.exports=n},function(e,t){},function(e,t,i){function n(){r.call(this,{className:"SocialGroupCreationWindow",title:"",positionInfo:{left:"c",top:"c",width:"80%",height:"90%"}});var e=this;this._isModeratorOrMore=!1,this.once("open",function(){e.addClassNames("spinner"),e.windowBody.hide(),e._createDom(),M.preloadImage("ui/slot.png",function(t){e.slotIconImage=t}),f.getAllDataTable(["EmblemSymbolCategories","EmblemSymbols","EmblemBackgrounds"],function(t,i){return t?console.error("SocialGroupCreationWindow: Failed to retrieve emblem data",t):(e.emblemBackgrounds=i.EmblemBackgrounds,e.emblemSymbols=i.EmblemSymbols,e.emblemSymbolCategories=i.EmblemSymbolCategories,e._generateSelectorOptions(),e._displayEmblemBackgrounds(i.EmblemBackgrounds),e._displayEmblemSymbols(i.EmblemSymbols),e._setupUI(),e.delClassNames("spinner"),e.windowBody.show(),e._updateUISize(),e.on("open",function(){e.addClassNames("spinner"),e._generateSelectorOptions(),e.windowBody.hide(),e.tabs.openTab("background"),e._setupUI(),e.delClassNames("spinner"),e.windowBody.show()}),void e.on("opened",function(){e._updateUISize()}))})});var t=window.gui;t.on("GuildCreationStartedMessage",function(){e.mode="guild",e.modification=!1,d.openDialog(e.id)}),t.on("GuildModificationStartedMessage",function(t){e.mode="guild",t.canChangeName&&t.canChangeEmblem?e.modification="all":t.canChangeName?e.modification="name":e.modification="emblem",d.openDialog(e.id)}),t.on("AllianceCreationStartedMessage",function(){e.mode="alliance",e.modification=!1,d.openDialog(e.id)}),t.on("AllianceModificationStartedMessage",function(t){e.mode="alliance",t.canChangeName&&t.canChangeEmblem&&t.canChangeTag?e.modification="all":t.canChangeName?e.modification="name":e.modification="emblem",d.openDialog(e.id)})}function o(e,t,i,n){var o=e.length;return!(o<t||o>i)||(window.gui.openSimplePopup(c(n,t,i)),!1)}i(917);var s=i(337).addTooltip,a=i(172).inherits,r=i(541),l=i(29).getText,c=i(29).processText,d=i(194),u=i(532),h=i(335).DofusButton,p=i(918),m=i(530),f=i(30),g=i(335),_=i(436),v=i(563),y=i(422),b=i(342),M=i(182),w=i(321),T=250,C=110,A=20;a(n,r),e.exports=n,n.prototype._setupUI=function(){if("alliance"===this.mode?(this.tagNameBox.show(),this.tagInput.show(),this.nameLabel.setText(l("ui.alliance.name")+l("ui.common.colon")),this.setTitle(l("ui.alliance.creation"))):(this.tagNameBox.hide(),this.tagInput.hide(),this.nameLabel.setText(l("ui.social.guildName")+l("ui.common.colon")),this.setTitle(l("ui.social.guildCreation"))),!this.modification)return this._generateRandomEmblem(),this.nameInput.enable(),this.nameInput.setValue(""),this.tagInput.enable(),this.tagInput.setValue(""),void this.cover.hide();var e=window.gui.playerData[this.mode].current;switch("alliance"===this.mode?(this.nameInput.setValue(e.allianceName),this.tagInput.setValue(e.allianceTag),this._setEmblem(e.allianceEmblem)):(this.nameInput.setValue(e.guildName),this._setEmblem(e.guildEmblem)),this.modification){case"all":this.nameInput.enable(),this.tagInput.enable(),this.cover.hide();break;case"name":this.nameInput.enable(),this.tagInput.enable(),this.cover.show();break;case"emblem":this.nameInput.disable(),this.tagInput.disable(),this.cover.hide()}},n.prototype._setEmblem=function(e){this.emblem.setValue(e,!0),this.bgColor=e.backgroundColor,this.bgId=e.backgroundShape,this.symbolColor=e.symbolColor,this.symbolId=e.symbolShape;for(var t=null,i=0;i<this.emblemSymbols.length;i+=1){var n=this.emblemSymbols[i];if(n.id===this.symbolId){t=n;break}}t?this.selector.select(t.categoryId):console.error("SocialGroupCreationWindow._setEmblem: emblemSymbol is null for symbolId",this.symbolId)},n.prototype._generateSelectorOptions=function(){if(this.emblemSymbolCategories){this.selector.clearContent(),this._isModeratorOrMore=window.gui.playerData.isModeratorOrMore();for(var e=0;e<this.emblemSymbolCategories.length;e++){var t=this.emblemSymbolCategories[e];(this._isModeratorOrMore||13!==t.id)&&this.selector.addOption(t.nameId,t.id)}this.selector.select(1)}},n.prototype._generateRandomEmblem=function(){this.bgColorPicker.generateRandomColor(),this.motifColorPicker.generateRandomColor();var e=Math.round(Math.random()*(this.emblemBackgrounds.length-1)),t=Math.round(Math.random()*(this.emblemSymbols.length-(this._isModeratorOrMore?2:1)));this._setBackgroundShape(this.emblemBackgrounds[e].id),this._setSymbolShape(this.emblemSymbols[t].iconId)},n.prototype._setBackgroundShape=function(e){this.emblem.setValue({backgroundShape:e}),this.bgId=e},n.prototype._setSymbolShape=function(e){this.emblem.setValue({symbolShape:e}),this.symbolId=e},n.prototype._displayEmblemBackgrounds=function(e){function t(){i._setBackgroundShape(this.id)}for(var i=this,n=[],o=0;o<e.length;o++)n.push("gfx/emblems/icons/back/"+e[o].id+".png");M.preloadImages(n,function(n){for(var o=0;o<n.length;o++){var s=i.backgroundScroller.content.appendChild(new g({className:"icon"},t));s.setStyle("backgroundImage",n[o]+", "+i.slotIconImage),s.id=e[o].id}i.backgroundScroller.refresh()})},n.prototype._displayEmblemSymbols=function(e){function t(){i._setSymbolShape(this.id)}var i=this,n=[];i.notColorizable=[];for(var o=0;o<e.length;o++)n.push("gfx/emblems/icons/up/"+e[o].iconId+".png"),e[o].colorizable||i.notColorizable.push(e[o].id);M.preloadImages(n,function(n){for(var o=0;o<n.length;o++){var s=i.symbolScroller.content.appendChild(new g({className:["icon","white"]},t));s.setStyle("backgroundImage",n[o]+", "+i.slotIconImage),s.categoryId=e[o].categoryId,s.id=e[o].id}i.selector.select(1)})},n.prototype._createDom=function(){function e(e){i.bgColor!==e.hex.substr(1)&&(i.bgColor=parseInt(e.hex.substr(1),16),i.emblem.setValue({backgroundColor:e.rgb}))}function t(e){i.symbolColor!==e.hex.substr(1)&&(i.symbolColor=parseInt(e.hex.substr(1),16),i.notColorizable.indexOf(i.symbolId)===-1&&i.emblem.setValue({symbolColor:e.rgb}))}var i=this,n=this.windowBody.createChild("div",{className:"guildNameBox"});this.nameLabel=n.createChild("div",{className:"label"});var a=n.createChild("div",{className:"info"});s(a,l("ui.social.nameRules"),{openOnTap:!0});var r=this.nameInput=this.windowBody.appendChild(new m({className:"socialInputBox",attr:{type:"text",maxlength:30}})),c=this.tagNameBox=this.windowBody.createChild("div",{className:"tagNameBox"});c.createChild("div",{className:"label",text:l("ui.alliance.tagInfo")+l("ui.common.colon")}),a=c.createChild("div",{className:"info"}),s(a,l("ui.alliance.tagRules"),{openOnTap:!0});var d=this.tagInput=this.windowBody.appendChild(new m({className:"socialInputBox",attr:{type:"text",maxlength:30}}));this.emblem=this.windowBody.appendChild(new y),this.windowBody.createChild("div",{className:"text",text:l("ui.social.createEmblem")+l("ui.common.colon")});var f=this.tabs=this.windowBody.appendChild(new v);this.cover=f.content.createChild("div",{className:"cover"});var g=new w("div",{className:"backgroundTab"}),M=new w("div",{className:"motifTab"});f.addTab(l("ui.social.emblemBack"),g,"background"),f.addTab(l("ui.social.emblemUp"),M,"motif"),f.openTab("background"),this.backgroundScroller=g.appendChild(new _({className:"iconScroller"})),this.bgColorPicker=g.appendChild(new p({tintWidth:T,tintHeight:C,lumWidth:A})),this.bgColorPicker.on("colorChanged",e),this.bgColorPicker.on("newColor",e);var I=M.createChild("div",{className:"motifContainer"});this.selector=I.appendChild(new u),this.selector.on("change",function(e){var t=i.symbolScroller.content.getChildren();e=parseInt(e,10);for(var n=0;n<t.length;n++)e!==t[n].categoryId?t[n].hide():t[n].show();i.symbolScroller.refresh()}),this.symbolScroller=I.appendChild(new _({className:"iconScroller"})),M.once("opened",function(){i.symbolScroller.refresh()}),this.motifColorPicker=M.appendChild(new p({tintWidth:T,tintHeight:C,lumWidth:A})),this.motifColorPicker.on("colorChanged",t),this.motifColorPicker.on("newColor",t);var S=this.windowBody.createChild("div",{className:"buttonContainer"}),E=S.appendChild(new h(l("ui.common.validation")));E.on("tap",function(){var e=r.getValue(),t={symbolShape:i.symbolId,symbolColor:i.symbolColor,backgroundShape:i.bgId,backgroundColor:i.bgColor};if("alliance"===i.mode){if(!o(e,b.MIN_ALLIANCENAME_LEN,b.MAX_ALLIANCENAME_LEN,l("ui.alliance.invalidLengthName")))return;var n=d.getValue();if(!o(n,b.MIN_ALLIANCETAG_LEN,b.MAX_ALLIANCETAG_LEN,l("ui.alliance.invalidLengthTag")))return;if(!i.modification)return window.dofus.sendMessage("AllianceCreationValidMessage",{allianceName:e,allianceTag:n,allianceEmblem:t});switch(i.modification){case"all":window.dofus.sendMessage("AllianceModificationValidMessage",{allianceName:e,allianceTag:n,Alliancemblem:t});break;case"emblem":window.dofus.sendMessage("AllianceModificationEmblemValidMessage",{Alliancemblem:t});break;case"name":window.dofus.sendMessage("AllianceModificationNameAndTagValidMessage",{allianceName:e,allianceTag:n})}}else{if(!o(e,b.MIN_GUILDNAME_LEN,b.MAX_GUILDNAME_LEN,l("ui.alliance.invalidLengthName")))return;if(!i.modification)return window.dofus.sendMessage("GuildCreationValidMessage",{guildName:e,guildEmblem:t});switch(i.modification){case"all":window.dofus.sendMessage("GuildModificationValidMessage",{guildName:e,guildEmblem:t});break;case"emblem":window.dofus.sendMessage("GuildModificationEmblemValidMessage",{guildEmblem:t});break;case"name":window.dofus.sendMessage("GuildModificationNameValidMessage",{guildName:e})}}})},n.prototype._updateUISize=function(){var e=this.bgColorPicker.rootElement.clientHeight,t=this.bgColorPicker.rootElement.clientWidth;0!==e&&0!==t&&(this.bgColorPicker.updateDimensions(t,e,A),this.motifColorPicker.updateDimensions(t,e,A))}},function(e,t){},function(e,t,i){function n(e){function t(e,t){this.deltaX=e.x-t.left-this.picker.x,this.deltaY=e.y-t.top-this.picker.y,this.box=t}function i(){p.emit("colorChanged",p.getCurrentColor())}function n(e){var t=e.x-this.box.left,n=e.y-this.box.top;p._cursorMove({x:t,y:n},this.box,this.panelType),i()}function o(e){var t=e.x-this.box.left-this.deltaX,i=e.y-this.box.top-this.deltaY;p._cursorMove({x:t,y:i},this.box,this.panelType)}function r(){m.open({x:0,y:0,defaultValue:""})}var u=void 0===e;e=e||{};var p=this;l.call(this,"div",{className:"ColorPicker"});var m=this.appendChild(new c);m.on("confirm",function(e){var t=d.hexToRgb(e);t&&(p.setCurrentColor([t.r,t.g,t.b]),i())}),this.params={tintWidth:e.tintWidth||162,tintHeight:e.tintHeight||110,lumWidth:e.lumWidth||16,lumHeight:e.lumHeight||110},this.currentTint=[255,0,0],this.currentColor=[255,0,0],this.tintWrapper=this.createChild("div",{className:"tintWrapper"}),this.tintCanvas=this.tintWrapper.createChild("canvas",{className:"tintCanvas"}),this.tintCanvas.rootElement.width=this.params.tintWidth,this.tintCanvas.rootElement.height=this.params.tintHeight,s(this.tintCanvas),a(this.tintCanvas),this.tintCanvas.panelType="tint",this.tintCanvas.on("slideStart",t),this.tintCanvas.on("slide",o),this.tintCanvas.on("slideEnd",i),this.tintCanvas.on("tapstart",t),this.tintCanvas.on("tap",n),this.tintCanvas.on("doubletap",r),this.tintPicker=this.tintWrapper.createChild("div",{className:"tintPicker"}),this.tintCanvas.picker=this.tintPicker,this.lumWrapper=this.createChild("div",{className:"lumWrapper"}),this.lumCanvas=this.lumWrapper.createChild("canvas",{className:"lumCanvas"}),this.lumCanvas.rootElement.width=1,this.lumCanvas.rootElement.height=this.params.lumHeight,s(this.lumCanvas),a(this.lumCanvas),this.lumCanvas.panelType="lum",this.lumCanvas.on("slideStart",t),this.lumCanvas.on("slide",o),this.lumCanvas.on("slideEnd",i),this.lumCanvas.on("tapstart",t),this.lumCanvas.on("tap",n);var f=this.lumPicker=this.lumWrapper.createChild("div",{className:"lumPicker"});this.lumCanvas.picker=f,f.dark=f.createChild("div",{className:["triangle","black"]}),f.bright=f.createChild("div",{className:["triangle","white"]}),u||this.updateDimensions(this.params.tintWidth+this.params.lumWidth+h,this.params.tintHeight,this.params.lumWidth)}i(919);var o=i(378),s=i(201),a=i(197),r=i(172).inherits,l=i(321),c=i(920),d=i(378),u=40,h=10,p=1e-5,m=127.5,f=[[255,0,0],[255,255,0],[0,255,0],[0,255,255],[0,0,255],[255,0,255],[255,0,0]];r(n,l),e.exports=n,n.prototype.updateDimensions=function(e,t,i){this.params.lumWidth=i||Math.min(e/5,u);var n=e-this.params.lumWidth-h;n=n>0?n:this.params.tintWidth,this.params.tintWidth=n,this.params.tintHeight=t,this.tintCanvas.rootElement.width=n,this.tintCanvas.rootElement.height=t,this.tintCanvas.setStyles({width:n+"px",height:t+"px"}),this.params.lumHeight=t,this.lumCanvas.rootElement.height=t,this.lumCanvas.setStyles({width:this.params.lumWidth+"px",height:this.params.lumHeight+"px"}),this.fillTint(),this.updateLuminosity(),this._setPickerPosition(this.tintPicker,0,0),this._setPickerPosition(this.lumPicker,0,t/2)},n.prototype._lumCoordinatesToColor=function(e){var t=e/(this.params.lumHeight/2),i=t<1?[255,255,255]:this.currentTint,n=t<1?this.currentTint:[0,0,0],o=t%1;return[i[0]*(1-o)+n[0]*o,i[1]*(1-o)+n[1]*o,i[2]*(1-o)+n[2]*o]},n.prototype._tintCoordinatesToColor=function(e,t){var i=this.params.tintWidth/(f.length-1),n=Math.floor(e/i),o=e/i%1,s=f[n][0],a=f[n+1][0],r=f[n][1],l=f[n+1][1],c=f[n][2],d=f[n+1][2],u=s*(1-o)+a*o,h=r*(1-o)+l*o,p=c*(1-o)+d*o,g=t/this.params.tintHeight,_=u*(1-g)+m*g,v=h*(1-g)+m*g,y=p*(1-g)+m*g;return[_,v,y]},n.prototype._colorToTintAndLum=function(e){var t=this.params.tintWidth,i=this.params.tintHeight,n=i/2,o=Math.min.apply(Math,e),s=Math.max.apply(Math,e),a=e.indexOf(o),r=e.indexOf(s);if(a===r){var l=(1-o/255)*i-p;return[0,i-p,l]}var c;c=0!==a&&0!==r?0:1!==a&&1!==r?1:2;var d,u=e[r],h=e[c],g=e[a],_=[[null,3,2],[4,null,5],[1,0,null]],v=_[a][c],y=(h-g)/(u-g),b=v%2?1-y:y,M=t/(f.length-1),w=M*(v+b)%t,T=(g+u)/255;d=T<=1?255*g/m/(u+g):(255*u-65025)/(m*(u+g)-65025);var C=d*i,A=n+(1-T)/2*i;return[w,C,A]},n.prototype.setCurrentColor=function(e){var t=this._colorToTintAndLum(e);this.cursorMoveTo(t[0],t[1],"tint",!0),this.cursorMoveTo(0,t[2],"lum",!0)},n.prototype.updateLuminosity=function(){for(var e=this.lumCanvas.rootElement,t=e.getContext("2d"),i=t.getImageData(0,0,e.width,e.height),n=0;n<this.params.lumHeight;n++){var o=this._lumCoordinatesToColor(n),s=4*n;i.data[s]=Math.round(o[0]),i.data[s+1]=Math.round(o[1]),i.data[s+2]=Math.round(o[2]),i.data[s+3]=255}t.putImageData(i,0,0)},n.prototype.cursorMoveTo=function(e,t,i,n){this._setPickerPosition(this[i+"Picker"],e,t),"tint"===i&&(this.currentTint=this._tintCoordinatesToColor(e,t),this.updateLuminosity()),this.currentColor=this._lumCoordinatesToColor(this.lumPicker.y),n||this.emit("newColor",this.getCurrentColor())},n.prototype.randomize=function(e,t){var i=this[e+"Canvas"].rootElement,n=Math.random()*i.width,o=Math.random()*i.height;this.cursorMoveTo(n,o,e,t)},n.prototype.generateRandomColor=function(e){this.randomize("tint",e),this.randomize("lum",e)},n.prototype._cursorMove=function(e,t,i){var n=this[i+"Canvas"].rootElement,o=e.x,s=e.y,a=n.width/t.width,r=n.height/t.height;o=Math.round(o*a),s=Math.round(s*r),o=Math.max(0,Math.min(o,n.width-1)),s=Math.max(0,Math.min(s,n.height-1)),this.cursorMoveTo(o,s,i)},n.prototype.fillTint=function(){for(var e=this.tintCanvas.rootElement,t=e.getContext("2d"),i=t.getImageData(0,0,e.width,e.height),n=0;n<this.params.tintWidth;n++)for(var o=0;o<this.params.tintHeight;o++){var s=this._tintCoordinatesToColor(n,o),a=4*(o*this.params.tintWidth+n);i.data[a]=Math.round(s[0]),i.data[a+1]=Math.round(s[1]),i.data[a+2]=Math.round(s[2]),i.data[a+3]=255}t.putImageData(i,0,0)},n.prototype.getCurrentColor=function(){var e=this.currentColor,t=[Math.round(e[0]),Math.round(e[1]),Math.round(e[2])];return{rgb:t,hex:o.colorArrayToHexa(t)}},n.prototype._setPickerPosition=function(e,t,i){if(e.setStyle("webkitTransform","translate3d("+t+"px,"+i+"px,0)"),e.x=t,e.y=i,e===this.lumPicker){var n=i/this.params.lumHeight>.5?1:0;e.bright.setStyle("opacity",n),e.dark.setStyle("opacity",1-n)}},n.prototype.reset=function(){this._setPickerPosition(this.tintPicker,0,0),this.currentTint=this._tintCoordinatesToColor(0,0),this.updateLuminosity(),this._setPickerPosition(this.lumPicker,0,this.params.lumHeight/2),this.currentColor=this._lumCoordinatesToColor(this.lumPicker.y)},n.prototype.getCursorPosition=function(e){var t=this[e+"Picker"];return{x:t.x,y:t.y}}},function(e,t){},function(e,t,i){function n(){function e(){t.closeHex(),t.emit("confirm",t.currentValue)}var t=this;c.call(this,"div",{className:"HexSelector",hidden:!0}),this.close=this.appendChild(new a({className:["simpleButton","closeBtn"]})),this.createChild("div",{className:"hexLabel",text:"0x"}),this.inputBox=this.appendChild(new r({className:"hexInputBox",attr:{maxlength:6}},e)),this.confirm=this.appendChild(new a({className:["simpleButton","confirmBtn"]})),this.currentValue=0,this.confirm.on("tap",e),this.close.on("tap",function(){t.closeHex()}),this.inputBox.on("change",function(e){t.currentValue=e})}i(921);var o=i(334).getElementPositionAt,s=i(172).inherits,a=i(335),r=i(530),l=i(196),c=i(321),d={opacity:0,webkitTransform:"scale(0.8)"},u={opacity:1,webkitTransform:"scale(1)"};s(n,c),e.exports=n,n.prototype.position=function(e,t){var i=o(this,e,t);this.setStyles({left:i.x+"px",top:i.y+"px"})},n.prototype.open=function(e){function t(){delete i.openTweener,i.inputBox.focus(),i.emit("opened")}var i=this;return e=e||{},void 0!==e.placeholder&&void 0===e.defaultValue?(this.inputBox.setPlaceholder(e.placeholder),this.currentValue=""):void 0!==e.defaultValue&&(this.currentValue=e.defaultValue),this.inputBox.setValue(this.currentValue),this.show(),e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&this.position(e.x,e.y),this.setStyles(d),this.openTweener?(this.openTweener.cancel(),t()):void(this.openTweener=l.tween(this,u,{time:150,delay:0,easing:"ease-out"},t))},n.prototype.closeHex=function(){function e(){delete t.closeTweener,t.hide(),t.emit("closed"),t.inputBox.blur()}var t=this;return this.closeTweener?(this.closeTweener.cancel(),e()):void(this.closeTweener=l.tween(this,d,{time:150,delay:0,easing:"ease-out"},e))}},function(e,t){},function(e,t,i){function n(){u.call(this,{className:"AllianceCardWindow",positionInfo:{top:"c",left:"c",width:400,height:380}}),this.once("open",function(){this._createDom()}),this.on("open",function(e){this._setAlliance(e)})}function o(e){var t=new a({width:25,height:25});t.setValue(e.guildEmblem,!0);var i=new h("div",{text:e.guildName});return m(i),i.on("tap",function(){r.openGuildCard(e.guildId)}),[t,i,e.guildLevel]}i(923);var s=i(28).DofusDate,a=i(422),r=i(478),l=i(29).getText,c=i(172).inherits,d=i(649),u=i(541),h=i(321),p=i(194),m=i(197);c(n,u),n.prototype._createDom=function(){var e=this.windowBody.createChild("div",{className:"description"});this.emblem=e.appendChild(new a({width:70,height:70}));var t=e.createChild("div",{className:"labelBox"});t.createChild("div",{className:"label",text:l("ui.alliance.tag")+l("ui.common.colon")}),t.createChild("div",{className:"label",text:l("ui.social.guilds")+l("ui.common.colon")}),t.createChild("div",{className:"label",text:l("ui.common.members")+l("ui.common.colon")}),t.createChild("div",{className:"label",text:l("ui.common.creationDate")+l("ui.common.colon")});var i=e.createChild("div",{className:"valueBox"});this.tag=i.createChild("div",{className:"value"}),this.guilds=i.createChild("div",{className:"value"}),this.members=i.createChild("div",{className:"value"}),this.creationDate=i.createChild("div",{className:"value"}),this.prisms=this.windowBody.createChild("div",{className:"prisms"}),this.guildList=this.windowBody.appendChild(new d({colCount:3,headerContent:["",l("ui.common.name"),l("ui.common.level")]}))},n.prototype.display=function(e){this.openState?(this._setAlliance(e),p.focusWindow("allianceCard")):p.open("allianceCard",e)},n.prototype._setAlliance=function(e){var t=e.infos,i=e.guilds;this.setTitle(l("ui.common.alliance")+" - "+t.allianceName),this.emblem.setValue(t.allianceEmblem,!0),this.tag.setText("["+t.allianceTag+"]"),this.guilds.setText(i.length);var n=new s(t.creationDate).getServerDate().toString(!0);this.creationDate.setText(n.day+" "+n.monthName+" "+n.year),this.prisms.setText(l("ui.prism.nbPrisms",e.controlledSubareaIds.length)),this.guildList.clearContent();for(var a=0,r=0,c=i.length;r<c;r+=1){var d=i[r];a+=d.nbMembers,this.guildList.addRow(o(d))}this.members.setText(a)},e.exports=n},function(e,t){},function(e,t,i){function n(){h.call(this,{className:"GuildCardWindow",positionInfo:{top:"c",left:"c",width:400,height:380}}),this.once("open",function(){this._createDom()}),this.on("open",function(e){this._setGuild(e)})}function o(e){var t=new p("div",{text:e.name});return f(t),t.on("tap",function(){window.gui.openContextualMenu("player",{playerName:e.name,playerId:e.id,hasGuild:!0})}),[t,e.level]}i(925);var s=i(583),a=i(337).addTooltip,r=i(28).DofusDate,l=i(422),c=i(29).getText,d=i(172).inherits,u=i(649),h=i(541),p=i(321),m=i(194),f=i(197);d(n,h),n.prototype._createDom=function(){var e=this.windowBody.createChild("div",{className:"description"});this.emblem=e.appendChild(new l({width:70,height:70}));var t=e.createChild("div",{className:"labelBox"});t.createChild("div",{className:"label",text:c("ui.common.level")+c("ui.common.colon")}),t.createChild("div",{className:"label",text:c("ui.guild.right.leader")+c("ui.common.colon")}),t.createChild("div",{className:"label",text:c("ui.common.members")+c("ui.common.colon")}),t.createChild("div",{className:"label",text:c("ui.common.creationDate")+c("ui.common.colon")});var i=this,n=e.createChild("div",{className:"valueBox"});this.level=n.createChild("div",{className:"value"}),this.leader=n.createChild("div",{className:["value","link"]}),f(this.leader),this.leader.on("tap",function(){window.gui.openContextualMenu("player",{playerName:i._leaderName,playerId:i._leaderId,hasGuild:!0})}),this.members=n.createChild("div",{className:"value"}),this.creationDate=n.createChild("div",{className:"value"}),this.perceptors=this.windowBody.createChild("div",{className:"perceptors"}),this.memberList=this.windowBody.appendChild(new u({colCount:2,headerContent:[c("ui.common.name"),c("ui.common.level")]}));var o=this.windowBody.createChild("div",{className:"alliance"}),r=o.createChild("div",{className:"value"});this.allianceLabel=r.createChild("span"),this.allianceName=r.createChild("span",{className:"link"}),f(r),r.on("tap",function(){s.openAllianceCard(i._allianceId)}),this.allianceInvite=o.createChild("div",{className:"inviteBtn"}),this.allianceInviteTooltip=new p("div"),a(this.allianceInvite,this.allianceInviteTooltip),this.allianceInvite.on("tap",function(){window.dofus.sendMessage("AllianceInvitationMessage",{targetId:i._leaderId})})},n.prototype.display=function(e){this.openState?(this._setGuild(e),m.focusWindow("guildCard")):m.open("guildCard",e)},n.prototype._setGuild=function(e){var t=e.infos,i=e.members;this.setTitle(c("ui.common.guild")+" - "+t.guildName),this.emblem.setValue(t.guildEmblem,!0),this.level.setText(t.guildLevel),this.members.setText(t.nbMembers);var n=new r(e.creationDate).getServerDate().toString(!0);this.creationDate.setText(n.day+" "+n.monthName+" "+n.year),this._leaderId=t.leaderId,this._leaderName=i[0].name,this.leader.setText(this._leaderName),this.perceptors.setText(c("ui.guild.taxcollectorsCurrentlyCollecting",e.nbTaxCollectors,e.nbTaxCollectors)),this.memberList.clearContent();for(var s=0,a=i.length;s<a;s+=1)this.memberList.addRow(o(i[s]));var l=e.allianceInfos;if(l)this.allianceLabel.setText(c("ui.common.alliance")+c("ui.common.colon")),this.allianceName.setText(l.allianceName),this._allianceId=l.allianceId,this.allianceInvite.hide();else{this.allianceLabel.setText(c("ui.alliance.noAllianceForThisGuild")),this.allianceName.setText("");var d=window.gui.playerData.alliance;this.allianceInviteTooltip.setText(c("ui.alliance.inviteLeader",this._leaderName)),this.allianceInvite.toggleDisplay(d.hasAlliance()&&d.isBoss())}},e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"guildHouseInfoWindow",positionInfo:{top:"c",left:"c",width:450,height:380}}),this.rights=[],this.rightsText=[a("ui.guildHouse.Right1"),a("ui.guildHouse.Right2"),a("ui.guildHouse.Right4"),a("ui.guildHouse.Right8"),a("ui.guildHouse.Right16"),a("ui.guildHouse.Right32"),a("ui.guildHouse.Right64"),a("ui.guildHouse.Right128"),a("ui.guildHouse.Right256")],this.setupDom(),this.on("open",this.open)}i(927);var o=i(172).inherits,s=i(541),a=i(29).getText,r=i(834),l=i(649),c=i(30),d=9;o(n,s),e.exports=n,n.prototype.setupDom=function(){this.tabs=this.windowBody.appendChild(new r({className:"tabs"}));var e={colIds:["content"],minRows:10};this.rights=this.windowBody.appendChild(new l(e)),this.skills=this.windowBody.appendChild(new l(e)),this.tabs.addTab(a("ui.social.guildHouseRights"),this.rights),this.tabs.addTab(a("ui.common.abilities"),this.skills),this.tabs.openTab(0)},n.prototype.open=function(e){var t,i=this,n=e.guildshareParams,o=e.skillListIds;for(this.windowTitle.setText(e.houseName),this.tabs.openTab(0),this.rights.clearContent(),this.skills.clearContent(),t=0;t<d;t++)n>>t&1&&this.rights.addRow({content:this.rightsText[t]});c.getData("Skills",o,function(e,n){for(e&&console.error("Failed to retrieve skills data",e),t=0;t<n.length;t++)i.skills.addRow([n[t].nameId])})}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"GuildHouseSettingWindow",positionInfo:{left:"c",top:"c",width:500,height:490}});var e=this;this.checkboxes=[],this.once("open",function(){e._setupDom(),e.setupSockets()}),this.on("open",function(){var t=window.gui.playerData.guild.current;t&&e.emblemLogo.setValue({guild:t})})}i(929);var o=i(172).inherits,s=i(541),a=i(194),r=i(335).DofusButton,l=i(612),c=i(29).getText,d=i(422);o(n,s),e.exports=n,n.prototype._setupDom=function(){var e=this,t=this.windowBody.createChild("div",{className:["container","topContainer"]});this.emblemLogo=t.appendChild(new d({width:100,height:100}));var i=t.createChild("div",{className:"content"});this.checkboxes.push(i.appendChild(new l(c("ui.common.guildHouseEnabledForThisHouse")))),i.createChild("div",{className:"description",text:c("ui.common.guildHouseNotice")});var n=this.windowBody.createChild("div",{className:["container","bottomContainer"]}),o=n.createChild("div",{className:"wrapper"}),s=this.doorEmblem=o.createChild("div",{className:"section"});s.createChild("div",{className:"title",text:c("ui.common.guildHouseDisplayEmblemOnDoorTitle")+":"}),this.checkboxes.push(s.appendChild(new l(c("ui.common.guildHouseDisplayEmblemForGuild")))),this.checkboxes.push(s.appendChild(new l(c("ui.common.guildHouseDisplayEmblemForOthers")))),s=this.houseAccess=o.createChild("div",{className:"section"}),s.createChild("div",{className:"title",text:c("ui.common.guildHouseHouseAccessTitle")+":"}),this.checkboxes.push(s.appendChild(new l(c("ui.common.guildHouseAccessHouseAllowGuildmates")))),this.checkboxes.push(s.appendChild(new l(c("ui.common.guildHouseAccessHouseDenyOthers")))),s=this.chests=o.createChild("div",{className:"section"}),s.createChild("div",{className:"title",text:c("ui.common.guildHouseSafesAccessTitle")+":"}),this.checkboxes.push(s.appendChild(new l(c("ui.common.guildHouseRight32")))),this.checkboxes.push(s.appendChild(new l(c("ui.common.guildHouseRight64")))),s=this.miscellaneous=o.createChild("div",{className:"section"}),s.createChild("div",{className:"title",text:c("ui.common.guildHouseOtherTitle")+":"}),this.checkboxes.push(s.appendChild(new l(c("ui.common.guildHouseAllowRespawn")))),this.checkboxes.push(s.appendChild(new l(c("ui.common.guildHouseAllowTeleport"))));var u=this.windowBody.createChild("div",{className:"buttonContainer"}),h=u.appendChild(new r(c("ui.common.validation")));h.on("tap",function(){for(var t=0,i=0;i<e.checkboxes.length;i++)e.checkboxes[i].isActivate()&&(t+=1<<i);var n=e.checkboxes[0].isActivate();window.dofus.sendMessage("HouseGuildShareRequestMessage",{enable:n,rights:t}),a.close(e.id)}),this.checkboxes[0].on("activate",function(){e.enableContainers()}),this.checkboxes[0].on("deactivate",function(){e.disableContainers()})},n.prototype.updateCheckboxes=function(e){for(var t=0;t<this.checkboxes.length;t++)e>>t&1?this.checkboxes[t].activate():this.checkboxes[t].deactivate()},n.prototype.enableContainers=function(){this.doorEmblem.delClassNames("disabled"),this.houseAccess.delClassNames("disabled"),this.chests.delClassNames("disabled"),this.miscellaneous.delClassNames("disabled");for(var e=0;e<this.checkboxes.length;e++)this.checkboxes[e].enable()},n.prototype.disableContainers=function(){this.doorEmblem.addClassNames("disabled"),this.houseAccess.addClassNames("disabled"),this.chests.addClassNames("disabled"),this.miscellaneous.addClassNames("disabled");for(var e=1;e<this.checkboxes.length;e++)this.checkboxes[e].disable()},n.prototype.setupSockets=function(){var e=this;window.gui.on("HouseGuildRightsMessage",function(t){e.windowTitle.setText(c("ui.common.houseOwnerName",t.guildInfo.guildName));var i=t.guildInfo.guildEmblem;e.emblemLogo.setValue(i,!0),e.updateCheckboxes(t.rights),e.enableContainers()}),window.gui.on("HouseGuildNoneMessage",function(){for(var t=0;t<e.checkboxes.length;t++)e.checkboxes[t].deactivate();
e.disableContainers()})}},function(e,t){},function(e,t,i){function n(){function e(e){t.windowTitle.setText(e.name+" - "+a("ui.common.short.level")+" "+e.level),t._updateContent(e)}var t=this;o.call(this,{className:"GuildMemberRightsWindow",positionInfo:{left:"c",top:"c",width:450,height:490}}),this.rightCheckboxes=[],this.rightNames=[{right:m.GUILD_RIGHT_BOSS,label:a("ui.social.guildRightsAllRights")},{right:m.GUILD_RIGHT_MANAGE_GUILD_BOOSTS,label:a("ui.social.guildRightsBoost")},{right:m.GUILD_RIGHT_MANAGE_RIGHTS,label:a("ui.social.guildRightsRights")},{right:m.GUILD_RIGHT_INVITE_NEW_MEMBERS,label:a("ui.social.guildRightsInvit")},{right:m.GUILD_RIGHT_BAN_MEMBERS,label:a("ui.social.guildRightsBann")},{right:m.GUILD_RIGHT_MANAGE_XP_CONTRIBUTION,label:a("ui.social.guildRightsPercentXP")},{right:m.GUILD_RIGHT_MANAGE_MY_XP_CONTRIBUTION,label:a("ui.social.guildRightManageOwnXP")},{right:m.GUILD_RIGHT_MANAGE_RANKS,label:a("ui.social.guildRightsRank")},{right:m.GUILD_RIGHT_DEFENSE_PRIORITY,label:a("ui.social.guildRightsPrioritizeMe")},{right:m.GUILD_RIGHT_HIRE_TAX_COLLECTOR,label:a("ui.social.guildRightsHiretax")},{right:m.GUILD_RIGHT_COLLECT,label:a("ui.social.guildRightsCollect")},{right:m.GUILD_RIGHT_COLLECT_MY_TAX_COLLECTOR,label:a("ui.social.guildRightsCollectMy")},{right:m.GUILD_RIGHT_USE_PADDOCKS,label:a("ui.social.guildRightsMountParkUse")},{right:m.GUILD_RIGHT_ORGANIZE_PADDOCKS,label:a("ui.social.guildRightsMountParkArrange")},{right:m.GUILD_RIGHT_TAKE_OTHERS_MOUNTS_IN_PADDOCKS,label:a("ui.social.guildRightsManageOtherMount")},{right:m.GUILD_RIGHT_SET_ALLIANCE_PRISM,label:a("ui.social.guildRightsSetAlliancePrism")},{right:m.GUILD_RIGHT_TALK_IN_ALLIANCE_CHAN,label:a("ui.social.guildRightsTalkInAllianceChannel")}],this.minXpGivenPercentage=0,this.maxXpGivenPercentage=90,this.once("open",function(i){var n=[],o=window.gui.databases.RankNames;for(var s in o)n.push(o[s]);d.sortObjectInArray(n,"order"),t.rankNames=n,t._setupDom(),e(i),this.on("open",e)})}i(931);var o=i(541),s=i(172).inherits,a=i(29).getText,r=i(335).DofusButton,l=i(612),c=i(532),d=i(339),u=i(649),h=i(332),p=i(194),m=i(478).GuildRightsBitEnum;s(n,o),e.exports=n,n.prototype._updateContent=function(e){var t=this.selector;if(t){var i=this.rank,n=window.gui.playerData,o=n.guild,s=e.id===n.id,a=e.id===o.current.leaderId,r=n.id===o.current.leaderId,l=!s&&!a;this.memberInfo={memberId:e.id,experienceGivenPercent:e.experienceGivenPercent,name:e.name,rank:e.rank},t.toggleOption(0,r),t.setValue(e.rank),i.setText(window.gui.databases.RankNames[e.rank].nameId),this.xpContributionLabel.setText(e.experienceGivenPercent+"%");for(var c,d=o.checkRight(m.GUILD_RIGHT_BOSS,e.rights),u=o.hasRight(m.GUILD_RIGHT_MANAGE_RIGHTS),h=0;h<this.rightNames.length;h++){var p=this.rightNames[h].right;c=this.rightCheckboxes[h],c&&(a||d||o.checkRight(p,e.rights)?c.activate():c.deactivate(),c.disable(),(p!==m.GUILD_RIGHT_MANAGE_RIGHTS||r)&&(r||u&&l&&o.hasRight(p))&&c.enable())}if(this.setXpButton.disable(),(o.hasRight(m.GUILD_RIGHT_MANAGE_XP_CONTRIBUTION)||o.hasRight(m.GUILD_RIGHT_MANAGE_MY_XP_CONTRIBUTION))&&this.setXpButton.enable(),!a&&o.hasRight(m.GUILD_RIGHT_MANAGE_RANKS)||d)return t.show(),i.hide(),void this.rankTitleText.delClassNames("noMargin");t.hide(),i.show(),this.rankTitleText.addClassNames("noMargin")}},n.prototype._setupDom=function(){var e,t,i=this,n=this.windowBody.createChild("div",{className:"upperPanel"}),o=n.createChild("div",{className:"container"});this.rankTitleText=o.createChild("div",{className:"text",text:a("ui.social.guildRank")}),this.rank=o.createChild("div",{className:"rank"}),this.selector=o.appendChild(new c);var s=this.rankNames;for(e=0,t=s.length;e<t;e+=1)this.selector.addOption(s[e].nameId,s[e].id);this.selector.on("change",function(e,t){return 1===parseInt(e,10)?window.gui.openConfirmPopup({title:a("ui.popup.warning"),message:a("ui.social.doUGiveRights",i.memberInfo.name),cb:function(n){return n?void(i.memberInfo.rank=e):void i.selector.setValue(t)}}):void(i.memberInfo.rank=e)});var d=n.createChild("div",{className:["container","XpToGuild"]});d.createChild("div",{className:"text",text:a("ui.social.percentXpFull")}),this.setXpButton=d.appendChild(new r("",{className:"setXpButton"}));var m=d.appendChild(new h);m.on("confirm",function(e){i.xpContributionLabel.setText(e+"%"),i.memberInfo.experienceGivenPercent=e}),this.setXpButton.on("tap",function(){m.open({min:i.minXpGivenPercentage,max:i.maxXpGivenPercentage,defaultValue:parseInt(i.xpContributionLabel.getText(),10)})}),this.xpContributionLabel=d.createChild("div",{className:"xpLabel",text:"0%"});for(var f=this.windowBody.appendChild(new u({colIds:["name","checkbox"]})),g=0;g<this.rightNames.length;g++){var _=this.rightNames[g],v=new l("");this.rightCheckboxes.push(v),f.addRow({name:_.label,checkbox:v})}var y=this.windowBody.createChild("div",{className:"buttonContainer"}),b=y.appendChild(new r(a("ui.common.validation")));b.on("tap",function(){i.memberInfo.rights=i.getRightsMask(),window.dofus.sendMessage("GuildChangeMemberParametersMessage",i.memberInfo),p.close(i.id)}),this.on("close",function(){m.hide()})},n.prototype.getRightsMask=function(){for(var e=0,t=0;t<this.rightNames.length;t++){var i=this.rightCheckboxes[t];i&&i.isActivate()&&(e+=this.rightNames[t].right)}return e}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"houseBuySellWindow",title:"house",positionInfo:{left:"c",top:"c",width:450,height:335}});var e=this;this.currency=g,this.once("open",function(){var t=this.windowBody.createChild("div",{className:"container"}),i=t.createChild("div",{className:"imageContainer"});e.image=i.createChild("div",{className:"image"}),e.image.setStyle("backgroundImage",e.imageUrl),e.title=t.createChild("div",{className:["text","title"],text:e.titleText}),e.description=t.createChild("div",{className:["text","description"],text:e.descriptionText});var n=this.windowBody.createChild("div",{className:"priceContainer"});n.createChild("div",{className:"priceText",text:d("ui.common.price")+d("ui.common.colon")}),e.price=n.appendChild(new r({title:d("ui.common.price")})),e.currencyIcon=n.createChild("div",{className:["currencyIcon","soft"]}),e.price.on("change",function(t){e.proposedPrice=t});var o=this.windowBody.createChild("div",{className:"footer"});e.cancelSaleButton=o.appendChild(new a(d("ui.common.cancelTheSale"),{className:"cancelSaleButton"})),e.confirmButton=o.appendChild(new a(d("ui.common.validation"),{className:"confirmButton"})),e.switchButton=o.appendChild(new p),e.switchButton.on("switchToHard",function(){e._setCurrency(_),e.updateDisplay(e.houseInfo)}),e.switchButton.on("switchToSoft",function(){e._setCurrency(g),e.updateDisplay(e.houseInfo)}),e.cancelSaleButton.on("tap",function(){if(!e.houseInfo||!e.houseInfo.buyOrSell)return e.fromInside?(window.dofus.sendMessage("HouseSellFromInsideRequestMessage",{amount:0}),void l.close(e.id)):void window.dofus.sendMessage("HouseSellRequestMessage",{amount:0})}),e.confirmButton.on("tap",function(){if(e.houseInfo&&e.houseInfo.buyOrSell){var t;return t=e.currency===_?d("tablet.price.hard",e.price.getFormattedValue()):d("tablet.price.soft",e.price.getFormattedValue()),window.gui.openConfirmPopup({title:d("ui.common.housePurchase"),message:d("tablet.ui.common.doUBuyHouse",e.houseOwner,t),cb:function(t){if(t){if(e.currency===g)return window.dofus.sendMessage("HouseBuyRequestMessage",{proposedPrice:e.proposedPrice});var i=e.proposedPriceHard-window.gui.playerData.inventory.goultines;return i>0?f.openNotEnoughHardCurrencyPopup(i):window.dofus.send("houseBuyRequest",{houseId:e.houseInfo.purchasableId,amountHard:e.proposedPriceHard,amountSoft:e.proposedPrice})}}},{isModal:!0})}return e.fromInside?(window.dofus.sendMessage("HouseSellFromInsideRequestMessage",{amount:e.proposedPrice}),void l.close(e.id)):void window.dofus.sendMessage("HouseSellRequestMessage",{amount:e.proposedPrice})})}),this.on("open",function(t){return t=t||{},e.fromInside=t.fromInside,e.switchButton.setCurrency(g),e.fromInside?void e.fromInsideUpdateDisplay(t.myHouse):void e.updateDisplay(t.msg)}),this.setupSocketEvents()}i(933);var o=i(172).inherits,s=i(541),a=i(335).DofusButton,r=i(340),l=i(194),c=i(339),d=i(29).getText,u=i(30),h=i(182),p=i(934),m=i(713),f=i(801),g="soft",_="hard";o(n,s),e.exports=n,n.prototype.setupSocketEvents=function(){var e=this,t=window.gui,i=window.dofus.connectionManager;t.on("PurchasableDialogMessage",function(t){l.openDialog(e.id,{fromInside:!1,msg:t})}),t.on("HouseBuyResultMessage",function(i){i.bought?t.openPopup({title:d("ui.popup.information"),message:d("ui.common.houseBuy",e.houseOwner,c.kamasToString(i.realPrice,""))}):t.openPopup({title:d("ui.popup.information"),message:d("ui.common.cantBuyHouse",c.kamasToString(i.realPrice,""))})}),t.on("HouseSoldMessage",function(e){if(t.playerData.identification.nickname===e.buyerName){var i=d("ui.house.homeOf",e.buyerName);0===e.realPrice?t.openPopup({title:d("ui.popup.information"),message:d("ui.common.houseNosell","'"+i+"'")}):t.openPopup({title:d("ui.popup.information"),message:d("ui.common.houseSell","'"+i+"'",c.kamasToString(e.realPrice,""))})}}),m.on("computedHardPricesChange",function(){e.currency===_&&e.updateDisplay(e.houseInfo)}),i.on("houseBuyError",function(){this.send("moneyGoultinesAmountRequest")}),i.on("houseBuySuccess",function(){this.send("moneyGoultinesAmountRequest")})},n.prototype._setCurrency=function(e){if(this.currency!==e){var t=this.currency;this.currency=e,this.currencyIcon&&this.currencyIcon.replaceClassNames([t],[e])}},n.prototype.prepareDialog=function(e){var t=this;u.getData("Houses",e.modelId,function(i,n){return i||!n?console.warn("Houses Id: "+e.modelId+" not found!",i):void h.preloadImage("gfx/houses/"+n.gfxId+".png",function(i){t.houseOwner="?"===e.ownerName?d("ui.common.houseWithNoOwner"):d("ui.house.homeOf",e.ownerName);var o=n.nameId;return t.image?(delete t.imageUrl,delete t.titleText,delete t.descriptionText,t.image.setStyle("backgroundImage",i),t.title.setText(t.houseOwner),void t.description.setText(o)):(t.imageUrl=i,t.titleText=t.houseOwner,void(t.descriptionText=o))})})},n.prototype.updateDisplay=function(e){if(!e)return console.warn("Missing purchaseMsg from PurchasableDialogMessage.");this.proposedPrice=e.price,this.proposedPriceHard=m.computeHardPrice(e.price),this.houseInfo=e;var t=this.currency===_,i=t?this.proposedPriceHard:e.price;if(e.buyOrSell){this.price.disable(),this.windowTitle.setText(d("ui.common.housePurchase")),this.cancelSaleButton.disable();var n=window.gui.playerData.inventory,o=t||i&&i<=n.kamas;o?this.confirmButton.enable():this.confirmButton.disable()}else this.price.enable(),this.windowTitle.setText(d("ui.common.houseSale")),this.cancelSaleButton.enable(),this.confirmButton.enable();return this.switchButton.toggleDisplay(e.buyOrSell&&!window.Config.disabledFeatures.shop),i?void this.price.setValue(c.kamasToString(i,"")):this.price.setValue(d("ui.item.averageprice.unavailable"))},n.prototype.fromInsideUpdateDisplay=function(e){var t=this;return this.switchButton.hide(),this.confirmButton.enable(),e?(this.price.enable(),this.windowTitle.setText(d("ui.common.houseSale")),e.price?(this.cancelSaleButton.enable(),this.proposedPrice=e.price,void this.price.setValue(c.kamasToString(e.price,""))):(this.cancelSaleButton.disable(),void u.getData("Houses",e.modelId,function(i,n){return i||!n?console.warn("Houses Id: "+e.modelId+" not found!",i):(t.proposedPrice=n.defaultPrice,void t.price.setValue(c.kamasToString(t.proposedPrice,"")))}))):console.warn("Missing current house info.")}},function(e,t){},function(e,t,i){function n(e){var t=this;e=e||{},this.currency=a,s.call(this,e,function(){t.toggleCurrency()}),this.addClassNames("button","SwitchCurrencyButton",a)}i(935);var o=i(172).inherits,s=i(335),a="soft",r="hard";o(n,s),e.exports=n,n.prototype.toggleCurrency=function(){this.setCurrency(this.currency===a?r:a)},n.prototype.setCurrency=function(e){if(this.currency!==e){var t=this.currency;return this.currency=e,this.replaceClassNames([t],[this.currency]),this.currency===r?this.emit("switchToHard"):this.emit("switchToSoft")}}},function(e,t){},function(e,t,i){function n(){function e(){d.close("itemAppearance")}function t(){var t=a.itemSlots.indexOf(a.selectedSlot)+1;return a.itemInstance.livingObjectSkin===t?e():(this.disable(),void window.dofus.sendMessage("LivingObjectChangeSkinRequestMessage",{livingUID:a.itemInstance.objectUID,livingPosition:a.itemInstance.position,skinId:t}))}function i(){a.delClassNames("spinner"),a.confirmButton.enable(),a.selectedSlot&&(a.selectedSlot.unselect(),delete a.selectedSlot)}function n(){var e=a.itemSlots.indexOf(this)+1;this===a.selectedSlot||a.itemInstance.livingObjectLevel<e||(a.selectedSlot&&a.selectedSlot.unselect(),this.select(),a.selectedSlot=this)}c.call(this,{className:"ItemAppearanceWindow",title:s("ui.item.chooseSkin"),positionInfo:{left:"c",top:"c",width:450,height:200}});var a=this;this.itemSlots=[],this.selectedSlot=null,this.itemInstance=null,this.once("open",function(){this.itemSlotsBox=this.windowBody.createChild("div",{className:"itemSlotsBox"});for(var i=0;i<h;i+=1){var l=this.itemSlotsBox.appendChild(new r);l.on("tap",n),a.itemSlots.push(l)}this.confirmButton=this.windowBody.appendChild(new o(s("ui.common.validation"))),this.confirmButton.on("tap",t),window.gui.playerData.inventory.on("itemModified",function(t){a.itemInstance&&t.objectUID===a.itemInstance.objectUID&&e()})}),this.on("open",function(e){return e.itemInstance&&e.itemInstance.livingObjectCategory?void this._displayItem(e.itemInstance):console.error("Must provide a living object or living object associated itemInstance")}),this.on("close",function(){i()})}i(937);var o=i(335).DofusButton,s=i(29).getText,a=i(172).inherits,r=i(739),l=i(30),c=i(541),d=i(194),u=i(182),h=20;a(n,c),e.exports=n,n.prototype._displayItem=function(e){this.itemInstance=e;var t=this;this.addClassNames("spinner"),this.confirmButton.disable(),t.itemSlots[e.livingObjectSkin-1].emit("tap");var i=e.livingObjectId||e.objectGID;l.getData("LivingObjectSkinJntMood",i,function(i,n){if(i)return console.error(i);var o,s=[];for(o=0;o<n.moods[e.livingObjectMood].length;o+=1){var a=n.moods[e.livingObjectMood][o];s.push("gfx/items/"+a+".png")}u.preloadImages(s,function(e){for(var i=0;i<t.itemSlots.length;i+=1){var n=t.itemSlots[i];i>=t.itemInstance.livingObjectLevel?n.unset():n.setImage(e[i])}t.delClassNames("spinner"),t.confirmButton.enable()})})}},function(e,t){},function(e,t,i){function n(){function e(e,t){return t=t||{},t.showDescription=!0,t.showTitle=!0,e?(n.setTitle(e.getName()),n._itemBox.displayItem(e,t),n._itemBox.show(),void n.windowBody.delClassNames("spinner")):console.error("ItemBoxWindow: openWithItemData have not itemData")}function t(t,i){r.getItems([t],function(n,o){return n||!o[0]?console.error("ItemBoxWindow: error openWithDbItem",n,t):void e(o[0],i)})}function i(t,i){r.createItemInstances(t,function(t,n){return t?console.error("ItemBoxWindow: error createItemInstances",t):void e(n.array[0],i)})}s.call(this,{className:"ItemBoxWindow",title:"",positionInfo:{top:"c",left:"c",width:500,height:380}});var n=this,o=window.gui;this._itemBox=null,this._domCreated=!1,this.on("open",function(s){s=s||{},n._domCreated||n._createDom();var a=s.itemData,r=s.objectUID,l=s.objectGID,c=s.objectItem,d=s.options||{};return n.setTitle(""),n._itemBox.hide(),n.windowBody.addClassNames("spinner"),!a&&r&&(a=o.playerData.inventory.objects[r]),!a&&c?i(c,d):void(a?e(a,d):l?t(l,d):console.error("ItemBoxWindow need itemData or objectUID or objectGID"))}),this.on("close",function(){n._itemBox.hide(),n.windowBody.delClassNames("spinner")})}i(939);var o=i(172).inherits,s=i(541),a=i(853),r=i(461);o(n,s),e.exports=n,n.prototype._createDom=function(){var e=this.windowBody;this._itemBox=e.appendChild(new a),this._itemBox.hide(),this._domCreated=!0}},function(e,t){},function(e,t,i){function n(){function e(){var e=u.getWindow("feed");return e.possessFeedItemForLivingObject(n.itemInstance)?void u.open("feed",{mode:"livingObject",item:n.itemInstance}):window.gui.openSimplePopup(a("ui.item.errorNoFoodLivingItem",n.itemInstance.item.nameId))}function t(){n.lastLivingObjectId=n.itemInstance.livingObjectId,window.dofus.sendMessage("LivingObjectDissociateMessage",{livingUID:n.itemInstance.objectUID,livingPosition:n.itemInstance.position})}function i(){u.open("itemAppearance",{itemInstance:n.itemInstance})}d.call(this,{className:"ItemManageWindow",title:a("ui.item.manageItem"),positionInfo:{left:"c",top:"c",width:300,height:300}});var n=this;this.itemInstance=null,this.lastLivingObjectId="",this.once("open",function(){var r=this.windowBody.createChild("div",{className:"topRow"});this.itemSlot=r.appendChild(new l);var d=r.createChild("div",{className:"buttons"});this.feedButton=d.appendChild(new s(a("ui.item.feed"))),this.feedButton.on("tap",e),this.dissociateButton=d.appendChild(new s(a("ui.item.dissociate"))),this.dissociateButton.on("tap",t),this.appearanceButton=d.appendChild(new s(a("ui.item.skin"))),this.appearanceButton.on("tap",i);var u=this.windowBody.createChild("div",{className:"botRow"}),p=u.createChild("div",{className:"statsBox"});p.createChild("div",{className:"label",text:a("ui.common.state")+a("ui.common.colon")}),this.moodBox=p.createChild("div",{className:"value"}),this.lastFedBox=p.createChild("div",{className:["label","lastFedBox"]});var m=a("ui.common.level")+a("ui.common.colon");p.createChild("div",{className:"label",text:m}),this.levelBox=p.createChild("div",{className:"value"}),m=a("ui.common.experiment")+a("ui.common.colon"),p.createChild("div",{className:"label",text:m}),this.expBar=p.appendChild(new c),this.expBar.addClassNames("expBar","blue","value"),this.expTooltip=new h("div",{className:"expTooltip"}),o(this.expBar,this.expTooltip),window.gui.playerData.inventory.on("itemAdded",function(e){if(e.objectGID===n.lastLivingObjectId){var t=window.gui.playerData.inventory.objects[e.objectUID];n._displayItem(t)}}),window.gui.playerData.inventory.on("itemModified",function(e){e&&n.itemInstance&&(e.livingObjectId&&e.livingObjectId===n.itemInstance.objectGID?n._displayItem(e):e.objectUID===n.itemInstance.objectUID&&n._displayItem(e))})}),this.on("open",function(e){return e.itemInstance&&e.itemInstance.livingObjectCategory?void this._displayItem(e.itemInstance):console.error("Must provide a living object or living object associated itemInstance")})}i(941);var o=i(337).addTooltip,s=i(335).DofusButton,a=i(29).getText,r=i(172).inherits,l=i(737),c=i(557),d=i(541),u=i(194),h=i(321),p={MOOD_LEAN:0,MOOD_SATISFIED:1,MOOD_FAT:2};r(n,d),e.exports=n,n.prototype._updateMood=function(e){var t;switch(e.livingObjectMood){case p.MOOD_LEAN:t=a("ui.common.lean");break;case p.MOOD_SATISFIED:t=a("ui.common.satisfied");break;case p.MOOD_FAT:t=a("ui.common.fat")}this.moodBox.setText(t)},n.prototype._updateLastFed=function(e){this.lastFedBox.setText(e.livingObjectFoodDate)},n.prototype._updateExp=function(e){this.levelBox.setText(e.livingObjectLevel);var t=e.livingObjectXp,i=e.livingObjectMaxXp;this.expBar.setValue(0!==i?t/i:1),this.expTooltip.setText(t+" / "+i)},n.prototype._displayItem=function(e){this.itemInstance=e,this.itemSlot.setItem(e),this.itemSlot.setQuantity(1),e.livingObjectId&&e.objectGID?(this.feedButton.enable(),this.dissociateButton.enable()):(this.feedButton.disable(),this.dissociateButton.disable()),this._updateMood(e),this._updateLastFed(e),this._updateExp(e)}},function(e,t){},function(e,t,i){function n(){m.call(this,{className:"ItemRecipesWindow",positionInfo:{left:"c",top:"c",width:800,height:525}}),this.dbItemId=null,this.itemBox=null,this.itemHistory=[],this.on("open",this._onOpen),this.on("close",this._onClose)}function o(e){this.myWindow._displayNextItem(e)}function s(e){this.myWindow._displayNextItem(d.items[e])}function a(){var e=this.myWindow;e.itemHistory.pop();var t=d.items[e.itemHistory[e.itemHistory.length-1]];e._displayItem(t)}i(943);var r=i(29).getText,l=i(172).inherits,c=i(853),d=i(461),u=i(912),h=i(910),p=i(30),m=i(541),f=i(335);l(n,m),e.exports=n,n.prototype._onOpen=function(e){this.itemBox||this._createContent();var t=e.itemData&&e.itemData.item?e.itemData.item:e.itemData;this._displayNextItem(t)},n.prototype._onClose=function(){this.dbItemId=null,this.itemHistory=[],this.windowBody.clearContent(),this.itemBox=null,this.itemRecipeBox=null,this.recipeList=null,this.windowHeadWrapper.removeChild(this.backButton),this.backButton=null},n.prototype._displayNextItem=function(e){e.id!==this.dbItemId&&(this.itemHistory.push(e.id),this._displayItem(e))},n.prototype._createContent=function(){var e=this.windowBody.createChild("div",{className:"leftCol"});this.itemBox=new c({showDescription:!0,showTitle:!0,withBidHouseBtn:!0}),e.appendChild(this.itemBox),this.itemRecipeBox=e.createChild("div",{className:"itemRecipeBox"}),this.itemRecipeBox.createChild("div",{className:"title",name:"title"}),this.itemRecipeBox.on("itemTapped",o),this.itemRecipeBox.myWindow=this;var t=this.windowBody.createChild("div",{className:"rightCol"});this.recipeList=new h({isMenuOnItemDisabled:!0}),this.recipeList.on("itemTapped",o),this.recipeList.on("recipeSelected",s),this.recipeList.myWindow=this,t.appendChild(this.recipeList);var i=this.backButton=new f({className:"backButton"},a);i.insertBefore(this.windowTitle),i.myWindow=this},n.prototype._displayItem=function(e){this.dbItemId=e.id;var t=this;this.windowTitle.setText(e.nameId),this.backButton.toggleDisplay(this.itemHistory.length>1),this.itemBox.displayItem(e);var i=[e.id].concat(e.recipeIds);p.getDataMap("Recipes",i,function(n,s){if(n)return console.error(n);for(var a=s[i[0]],l=[],c=1;c<i.length;c++){var d=s[i[c]];d&&l.push(d)}t.recipeBox&&t.recipeBox.destroy();var h=!e.getProperty("secretRecipe");t.itemRecipeBox.toggleClassName("empty",!a||h),a?(t.itemRecipeBox.getChild("title").setText(r("ui.item.utilityReceipt")),t.recipeBox=new u(a,{isMain:!0,isMenuOnItemDisabled:!0}),t.recipeBox.on("itemTapped",o),t.recipeBox.myWindow=t,t.recipeBox.setupRecipe(function(){t.itemRecipeBox.appendChild(t.recipeBox)})):h?t.itemRecipeBox.getChild("title").setText(r("ui.item.secretReceipt")):t.itemRecipeBox.getChild("title").setText(r("ui.item.utilityNoReceipt")),t.recipeList.recipesWrapper.addClassNames("spinner"),t.recipeList.addRecipes(l,function(){t.recipeList.recipesWrapper.delClassNames("spinner")})})}},function(e,t){},function(e,t,i){function n(){function e(){i.selectedItemIds=[];for(var e=i.itemListBox.getChildren(),t=0;t<e.length;t+=1){var n=e[t];n.unselect()}}function t(){for(var e,t=[].concat(i.itemSet.items),n=i.itemListBox.getChildren(),o=0;o<n.length;o+=1)e=n[o],e.select();i.selectedItemIds=t}m.call(this,{className:"ItemSetsWindow",positionInfo:{left:"c",top:"c",width:800,height:525}});var i=this;this.selectedItemIds=[],this.once("open",function(){this.currentSetId=null;var n=this.windowBody.createChild("div",{className:"leftCol"});this.itemListBox=n.createChild("div",{className:"itemListBox"}),this.itemBox=new l({showDescription:!0,showTitle:!0,withBidHouseBtn:!0}),n.appendChild(this.itemBox);var s=this.windowBody.createChild("div",{className:"rightCol"}),r=s.createChild("div",{className:"selectorContainer"});r.createChild("div",{className:"tableTitle",text:a("ui.set.bonus")}),this.bonusSelector=r.appendChild(new u),this.bonusSelector.on("change",function(e){i._updateBonusTable(e,i.combineBonusesCheckbox.isActivate())}),this.combineBonusesCheckbox=r.appendChild(new o(a("ui.set.addObjectBonus"))),this.combineBonusesCheckbox.on("change",function(n){n?t():e();var o=i.selectedItemIds.length;i.bonusSelector.select(n?o:f),i.bonusSelector.toggleOption(o,n),i.bonusSelector.setEnable(!n),i.bonusSelector.toggleClassName("disabled",n)}),this.bonusTable=s.appendChild(new p([{id:"description"}],null,{noHeader:!0,clickable:!1})),window.gui.on("SetUpdateMessage",function(e){i.openState&&e.setId===i.currentSetId&&i._updateEquippedItems(e.setObjects)})}),this.on("open",function(e){var t=e.item?e.item:e;this._displayItemSet(t)}),this.on("close",function(){this.currentSetId=null})}i(945);var o=i(612),s=i(355),a=i(29).getText,r=i(172).inherits,l=i(853),c=i(737),d=i(461),u=i(532),h=i(30),p=i(539),m=i(541),f=1,g=-1;r(n,m),e.exports=n,n.prototype._getEquippedItemById=function(e){var t=window.gui.playerData.inventory.equippedItems;for(var i in t){var n=t[i];if(n.isInitialised&&n.objectGID===e)return n}},n.prototype._updateEquippedItems=function(e){for(var t=this.itemListBox.getChildren(),i=0,n=0;n<t.length;n+=1){var o=t[n];o.delClassNames("equipped"),e.indexOf(o.dbItem.id)>-1&&(o.addClassNames("equipped"),i++),o.dbItem.id===this.itemBox.itemId&&this._updateItemBox(d.items[o.dbItem.id]);var s=this._getEquippedItemById(o.dbItem.id);o.setItem(s||o.dbItem)}this.bonusSelector.select(i)},n.prototype._displayItemSet=function(e){if(e.itemSetId){var t=this;this.currentSetId=e.itemSetId,this._updateItemBox(e),h.getData("ItemSets",e.itemSetId,function(e,i){return e?console.error(e):(t.itemSet=i,t.windowTitle.setText(i.nameId),t.itemListBox.clearContent(),t.bonusSelector.clearContent(),void d.getItems(i.items,function(e){if(e)return console.error(e);var n=0;t.bonusSelector.addOption("0 "+a("ui.common.objects"),0),t.bonusSelector.toggleOption(0,!1);for(var o,s,r,l,c=0;c<i.items.length;c+=1)r=i.items[c],s=d.items[r],o=t._getEquippedItemById(r),o&&(n+=1),l=t._createItemSlot(o||s),t.itemListBox.appendChild(l),t.bonusSelector.addOption(c+1+" "+a("ui.common.objects"),c+1);t.combineBonusesCheckbox.deactivate(),t.bonusSelector.select(n)}))})}},n.prototype._createItemSlot=function(e){var t=this,i=new c({itemData:e});return i.createChild("div",{className:"equippedIcon"}),i.toggleClassName("equipped",!!i.itemInstance),i.on("tap",function(){var e=this.itemInstance&&this.itemInstance.isInitialised?this.itemInstance:null,n=window.gui.playerData.inventory.getGenericItem(this.dbItem.id);if(n&&!n.isInitialised&&(n=null),t.itemBox.displayItem(e||n||this.dbItem),t.combineBonusesCheckbox.isActivate()){var o=t.selectedItemIds.indexOf(i.dbItem.id);o<0?(t.selectedItemIds.push(i.dbItem.id),this.select()):(t.selectedItemIds.splice(o,1),this.unselect()),t.bonusSelector.select(t.selectedItemIds.length)}}),i},n.prototype._updateItemBox=function(e){var t=this._getEquippedItemById(e.id),i=window.gui.playerData.inventory.getGenericItem(e.id);this.itemBox.displayItem(t||i||e)},n.prototype._getEffectInstanceIntegerOrDie=function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t.diceNum=t.diceNum||0,t.diceSide=t.diceSide||0,t.value=t.value||0,e.diceSide?e.diceNum&&e.diceSide&&(t._type="EffectInstanceDice",t.diceNum+=t.value,t.diceSide+=t.value,t.value=0):(t._type="ObjectEffectInteger",e.diceNum&&(t.value+=e.diceNum),t.diceNum=0,t.diceSide=0),t},n.prototype._getMergedEffectInstances=function(e,t){for(var i,n=[],o={},a=0;a<e.length;a+=1){var r=e[a];r&&(i=o[r.effectId],i?i.effect.useDice&&(i.diceNum+=r.diceNum||0,i.diceSide+=r.diceSide||0,i.value+=r.value||0):(i=this._getEffectInstanceIntegerOrDie(r),o[r.effectId]=i))}for(var l in o)i=this._getEffectInstanceIntegerOrDie(o[l]),n.push(i);s.createEffectInstances(n,t)},n.prototype._updateBonusTable=function(e,t){var i=this;this.bonusTable.clearContent();var n,o,a=[],r=i.itemSet.bonusIsSecret,l=Math.max(e-1,0);if(i.itemSet.effects.length&&!r){var c=i.itemSet.effects[l];for(n=0;n<c.length;n+=1)o=c[n],o&&Object.keys(o).length&&a.push(o)}var u=i.itemSet.id,h=window.gui.playerData.inventory.itemSets[u]||{},p=h.setEffects||[],m=h.setObjects||[],f=e===m.length;if(p.length&&f&&r)for(n=0;n<p.length;n+=1)o=p[n],o&&Object.keys(o).length&&a.push(o);if(t&&i.selectedItemIds.length){var g=[];for(n=0;n<i.selectedItemIds.length;n+=1){var _=i.selectedItemIds[n],v=i._getEquippedItemById(_),y=v?v.effectsMap:d.items[_].possibleEffectsMap;for(var b in y)y[b].effect.showInSet&&g.push(y[b])}a=a.concat(g)}s.createEffectInstances(a,function(e,t){return e?console.error("_updateBonusTable createEffectInstances",e):void i._getMergedEffectInstances(t,function(e,t){return e?console.error("_updateBonusTable _getMergedEffectInstances",e):(i.bonusTable.clearContent(),void i._addEffectsToTable(t))})})},n.prototype._addEffectsToTable=function(e){if(this.itemSet.bonusIsSecret&&!e.length)return void this.bonusTable.addRow({description:a("ui.set.secretBonus")});for(var t=0;t<e.length;t+=1){var i=e[t];if(i){var n=this.bonusTable.addRow({description:i.description});n.toggleClassName("negative",i.effect.bonusType===g)}}}},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"LevelUpWindow",positionInfo:{left:"c",top:"c",width:535,height:260}}),this.hasDom=!1,this._setupEvents()}function o(e){e.sort(function(e,t){var i=e.getProperty("minPlayerLevel"),n=t.getProperty("minPlayerLevel");return i<n?-1:i>n?1:void 0})}i(947);var s=i(172).inherits,a=i(541),r=i(194),l=i(29).getText,c=i(745),d=i(337).addTooltip,u=i(369),h=i(410),p=i(182),m=i(392).Delay;s(n,a),e.exports=n,n.prototype._setupSpellData=function(){var e=window.gui.playerData.characters.mainCharacter.spellData.spells,t=window.gui.playerData.characterBaseInformations.level;this.spells=[];for(var i in e)t<=e[i].getProperty("minPlayerLevel")&&this.spells.push(e[i]);o(this.spells)},n.prototype._createDom=function(){this._characterDisplay=this.windowBody.appendChild(new u({scale:"fitin",horizontalAlign:"center"}));var e=this.windowBody.createChild("div",{className:"info"}),t=e.createChild("div",{className:"spellBlock"}),i=e.createChild("div",{className:"pointBlock"}),n=t.createChild("div",{className:"spellTextBox"});this.spellText=n.createChild("div",{className:"spellText"}),this.spellIcon=t.createChild("div",{className:"spellIcon"}),this.spellDescription=new c,d(this.spellIcon,this.spellDescription,{openOnTap:!0});var o=i.createChild("div",{className:["healthPoints","points"]}),s=i.createChild("div",{className:["spellPoints","points"]}),a=i.createChild("div",{className:["charaPoints","points"]});o.createChild("div",{className:"icon"}),o.createChild("div",{className:"text",text:l("ui.levelUp.LifePoints")}),this.health=o.createChild("div",{className:"point"}),s.createChild("div",{className:"icon"}),s.createChild("div",{className:"text",text:l("ui.levelUp.SpellPoints")}),this.spell=s.createChild("div",{className:"point"}),a.createChild("div",{className:"icon"}),a.createChild("div",{className:"text",text:l("ui.levelUp.CaracPoints")}),this.charac=a.createChild("div",{className:"point"}),this.hasDom=!0},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._characterDisplay=null,this.spellText=this.spellIcon=this.spellDescription=null,this.health=this.spell=this.charac=null,this.hasDom=!1},n.prototype.updateSpellIcon=function(e){var t=this;this.spellDescription.updateUI({spell:e}),p.preloadImage("gfx/spells/sort_"+e.spell.iconId+".png",function(e){t.spellIcon.setStyle("backgroundImage",e)})},n.prototype._setupEvents=function(){var e=this,t=window.gui.playerData;t.on("characterLevelUp",function(t){window.gui.tutorialManager.inTutorial||m(37,function(){e._levelUp(t.newLevel,t.previousLevel)}).start()}),this.on("open",this._onOpen)},n.prototype._onOpen=function(){this.hasDom||this._createDom();var e=window.gui.playerData.characterBaseInformations.entityLook;this._characterDisplay.setLook(e,{direction:h.DIRECTION_SOUTH_EAST,animation:"AnimStatique",boneType:"characters/",skinType:"characters/"})},n.prototype._levelUp=function(e,t){r.open(this.id),this._setupSpellData(),this.windowTitle.setText(l("ui.levelUp.TitleLevel",e));for(var i=this.spells,n=0;n<i.length;n++){var o=i[n],s=o.getProperty("minPlayerLevel");if(e===s){this.updateSpellIcon(o),this.spellText.setText(l("ui.levelUp.newSpell"));break}if(e<s){this.updateSpellIcon(o),this.spellText.setText(l("ui.levelUp.nextSpell")+" "+l("ui.levelUp.nextSpellLevel",s));break}}var a=e-t;this.health.setText("+ "+5*a),this.spell.setText("+ "+a),this.charac.setText("+ "+5*a)}},function(e,t){},function(e,t,i){function n(){g.call(this,{title:d("ui.mimicry.associate"),className:"MimicryWindow",
positionInfo:{left:"c",top:"c",width:450,height:326}}),this._reset(),this.on("open",this._onOpen),this.on("close",this._onClose),this._setListeners()}function o(e,t,i){var n=e.createChild("div",{className:["slotDiv",t]});n.createChild("div",{className:"icon"});var o=n.appendChild(new p);return o.mySlotDiv=n,i&&f.addTooltip(n,i),o}function s(){this.backgroundImage=null}function a(e,t,i){var n=this.mySlot;return"mimicry"!==i||e.slot!==n}i(949);var r=i(317),l=i(335),c=i(950),d=i(29).getText,u=i(172).inherits,h=i(461),p=i(737),m=i(694),f=i(337),g=i(541),_=i(194);u(n,g),e.exports=n,n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._reset=function(){this.mimicryItem=null,this.foodItem=null,this.hostItem=null,this.previewItem=null,this.hasDom=!1,this.hostSlot=this.foodSlot=this.mimicrySlot=this.previewSlot=null,this.selectedSlot=null},n.prototype._onOpen=function(e){var t=window.gui.playerData.inventory.objects;this.mimicryItem=t[e],this.mimicryItem||console.error("Missing mimicry. UID="+e),this.hasDom||this._createDom(),this._prepareItemPickingWindow(),this.mimicrySlot.setItem(this.mimicryItem,1),this._showHelp(d("tablet.mimicry.help")),this.mergeBtn.disable()},n.prototype._onClose=function(){this.itemPicking&&(this.itemPicking.removeAllListeners("close"),this.itemPicking.removeAllListeners("unpickItem"),this.itemPicking.removeAllListeners("slot-doubletap"),this.itemPicking=null),_.close("itemPicking")},n.prototype._prepareItemPickingWindow=function(){var e=this.itemPicking=_.open("itemPicking");e.once("close",function(){_.close("mimicry")}),e.on("unpickItem",this._dragItemAwayFromSlot.bind(this)),e.on("slot-doubletap",this._addItemByDoubleTap.bind(this)),e.showEquippableItems(),_.arrangeOpeningWindow(this.id,{leftOf:e.id})},n.prototype._createDom=function(){this.hasDom=!0;var e=this.windowBody.createChild("div",{className:"content"}),t=e.createChild("div",{className:"workDiv"}),i=t.createChild("div",{className:"slotsZone"});this.mimicrySlot=o(i,"mimicrySlot",d("ui.mimicry.mimicry")+" "+d("ui.mimicry.toBeDestroyed")),i.createChild("div",{className:"plusOrEqualSign",text:"+"}),this.hostSlot=o(i,"hostSlot",d("tablet.mimicry.host")),i.createChild("div",{className:"plusOrEqualSign",text:"+"}),this._setActiveSlot(this.hostSlot),this.foodSlot=o(i,"foodSlot",d("tablet.mimicry.food")+" "+d("ui.mimicry.toBeDestroyed")),i.createChild("div",{className:"plusOrEqualSign",text:"="}),this._setActiveSlot(this.foodSlot),this.previewSlot=o(i,"previewSlot",d("ui.craft.itemCreated")),this.messageBox=t.createChild("div"),this.messageText=this.messageBox.createChild("div",{className:"msgText"}),this.mergeBtn=e.appendChild(new l({text:d("ui.common.merge"),className:["greenButton","mergeBtn"]},this._mergeBtnAction.bind(this)))},s.prototype.prepareForDrag=function(e){var t=e.slot;return!!t.data&&(this.backgroundImage=t.getImage(),!0)},n.prototype._setActiveSlot=function(e){var t=e.mySlotDiv,i={isDropAllowed:a};r.setDroppable(t,["itemPicking","mimicry"],i),t.mySlot=e;var n=this;t.on("drop",function(t,i){n._dropItem(t.getItem(),e,i)});var o=new s,l={dragElement:!1};r.setDraggable(e,o,"mimicry",{slot:e},l),e.on("tap",function(){n._simpleTapOnSlot(e)}),e.on("doubletap",function(){n._simpleTapOnSlot(e),n._simpleTapOnSlot(e)})},n.prototype._simpleTapOnSlot=function(e){e.getItem()&&(e===this.selectedSlot?(e.unselect(),e.unset(),this._refreshAfterSlotChange()):(this.selectedSlot&&this.selectedSlot.unselect(),this.selectedSlot=e,e.select()))},n.prototype._dragItemAwayFromSlot=function(e,t){"mimicry"===t&&(e.unset(),this._refreshAfterSlotChange())},n.prototype._dropItem=function(e,t,i){if("mimicry"===i){var n=t===this.hostSlot?this.foodSlot:this.hostSlot,o=t.getItem();n.setItem(o,1),t.setItem(e,1)}else t.setItem(e,1);this._refreshAfterSlotChange()},n.prototype._addItemByDoubleTap=function(e){var t=e.getItem();if(this.hostItem)if(this.foodItem)t.objectUID===this.foodItem.objectUID||t.objectUID===this.hostItem.objectUID?(this.hostSlot.setItem(t,1),this.foodSlot.unset()):this.foodSlot.setItem(t,1);else{if(t.objectUID===this.hostItem.objectUID)return;this.foodSlot.setItem(t,1)}else this.hostSlot.setItem(t,1);this._refreshAfterSlotChange()},n.prototype._refreshAfterSlotChange=function(){this._clearPreviewSlot(),this.mergeBtn.disable(),this.selectedSlot&&(this.selectedSlot.unselect(),this.selectedSlot=null);var e=this.hostItem=this.hostSlot.getItem(),t=this.foodItem=this.foodSlot.getItem();return e&&!e.item.isEquippable()?this._showError(d("tablet.mimicry.errorEquippable")):t&&!t.item.isEquippable()?this._showError(d("tablet.mimicry.errorEquippable")):e&&t?e.getProperty("iconId")===t.getProperty("iconId")?this._showError(d("ui.mimicry.error.sameSkin")):e.getProperty("typeId")!==t.getProperty("typeId")?this._showError(d("ui.mimicry.error.foodType")):t.getProperty("level")>e.getProperty("level")?this._showError(d("ui.mimicry.error.foodLevel")):void this._requestMergeOrPreview(!0):e?this._showHelp(d("tablet.mimicry.helpFood")):this._showHelp(d("tablet.mimicry.help"))},n.prototype._requestMergeOrPreview=function(e){window.dofus.sendMessage("MimicryObjectFeedAndAssociateRequestMessage",{mimicryUID:this.mimicryItem.objectUID,mimicryPos:this.mimicryItem.position,foodUID:this.foodItem.objectUID,foodPos:this.foodItem.position,hostUID:this.hostItem.objectUID,hostPos:this.hostItem.position,preview:e})},n.prototype._mergeBtnAction=function(){var e=this;window.gui.openConfirmPopup({message:d("ui.mimicry.confirmPopup",this.hostItem.getName(),this.foodItem.getName(),this.mimicryItem.getName()),cb:function(t){t&&(e.mergeBtn.disable(),e._requestMergeOrPreview(!1))}})},n.prototype._clearPreviewSlot=function(){this.previewItem=null,this.previewSlot.unset(),this.previewSlot.delClassNames("success")},n.prototype._showPreviewItem=function(e){this.previewItem=e,this.previewSlot.setItem(e),this.previewSlot.addClassNames("success"),this.mergeBtn.enable(),e.item.isChangingCharacterLookWhenEquipped()?this._showHelp(d("tablet.mimicry.helpMerge")):this._showWarning(d("tablet.mimicry.fixedAppearance"))},n.prototype._showHelp=function(e){this.messageBox.setClassNames(["msgBox","help"]),this.messageText.setText(e)},n.prototype._showWarning=function(e){this.messageBox.setClassNames(["msgBox","warn"]),this.messageText.setText(e)},n.prototype._showError=function(e){this.messageBox.setClassNames(["msgBox","error"]),this.messageText.setText(e)},n.prototype._setListeners=function(){var e=window.dofus.connectionManager,t=this;e.on("ClientUIOpenedByObjectMessage",function(e){e.type===c.CLIENT_UI_OBJECT_MIMICRY&&_.open(t.id,e.uid)}),e.on("MimicryObjectPreviewMessage",function(e){h.createItemInstances(e.result,function(e,i){return e?console.error("Failed creating preview item:"+e):void t._showPreviewItem(i.array[0])})}),e.on("MimicryObjectAssociatedMessage",function(e){var i=window.gui.playerData.inventory.objects,n=i[e.hostUID],o="{itemStats,"+n.objectGID+","+n.objectUID+"}";window.gui.chat.logMsg(d("ui.mimicry.success",o)),_.close(t.id)}),e.on("MimicryObjectErrorMessage",function(e){if(e.reason===m.MIMICRY_OBJECT_ERROR){var i,n=!1;switch(e.errorCode){case-1:i=d("ui.error.state");break;case-2:i=d("ui.charSel.deletionErrorUnsecureMode");break;case-7:i=d("ui.mimicry.error.foodType");break;case-8:i=d("ui.mimicry.error.foodLevel");break;case-9:i=d("ui.mimicry.error.noValidMimicry");break;case-10:i=d("ui.mimicry.error.noValidHost");break;case-11:i=d("ui.mimicry.error.noValidFood");break;case-16:i=d("ui.mimicry.error.noMimicryAssociated");break;case-17:i=d("ui.mimicry.error.sameSkin");break;case-3:case-4:case-5:case-6:case-12:case-13:case-14:case-15:i=d("ui.popup.impossible_action"),n=!0;break;default:i=d("ui.common.unknownFail"),n=!0}n&&console.error("Abnormal mimicry error: "+e.errorCode),t._showError(i)}})}},function(e,t){},function(e,t){e.exports={CLIENT_UI_UNDEFINED:0,CLIENT_UI_TELEPORT_GUILD_HOUSE:1,CLIENT_UI_TELEPORT_GUILD_PADDOCK:2,CLIENT_UI_OBJECT_MIMICRY:3}},function(e,t,i){function n(e){c.call(this,{title:s("ui.common.inventory"),className:"ItemPickingWindow",plusButton:!1,positionInfo:{right:"10%",top:"c",width:280,height:564},openingSound:"OPEN_INVENTORY",closingSound:"CLOSE_INVENTORY"}),this.storageView=e,this.storageView.registerView(this,{manualOpening:!0,enableAveragePrice:!1,enableSlotContext:!1,tapSelectedEmitsDoubleTap:!0,filters:{quest:!0,preset:!0}}),this.hasDom=!1,this.on("open",this._onOpen)}i(952);var o=i(317),s=i(29).getText,a=i(172).inherits,r=i(528),l=o.setDroppable,c=i(541);a(n,c),e.exports=n,n.prototype._onOpen=function(){this.hasDom||this._createDom(),this.storageBox.appendChild(this.storageView.storageUI),this.isReadyForUserInteraction=!1;var e=this;this.storageView.once("StorageViewerOpen",function(){e.isReadyForUserInteraction=!0})},n.prototype._createDom=function(){var e=this;this.hasDom=!0,this.storageBox=this.windowBody.createChild("div",{className:"storageBox"}),l(this.storageBox,["mimicry"]),this.storageBox.on("drop",function(t,i){e.emit("unpickItem",t,i)})},n.prototype.showEquippableItems=function(){this.storageView.filter.selectCategory(r.filters.equipment)}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"padLockWindow",title:l("ui.common.typeCode"),positionInfo:{left:"c",top:"c",width:400,height:360}});var e=this;this.padlockInfo={codeSize:8},this.once("open",function(){function t(){e.enterCode(this.id)}var i,n=9,o={};e.currentCodeDigit=0,e.codeDigitContainer=[],e.codeDigit=[];var s=e.windowBody.createChild("div",{className:"codeContainer"});for(i=0;i<e.padlockInfo.codeSize;i++)e.codeDigitContainer.push(s.createChild("div",{className:"codeDigitContainer"})),e.codeDigit.push(e.codeDigitContainer[i].createChild("div",{className:"codeDigit"}));var c=e.windowBody.createChild("div",{className:"container"}),d=c.createChild("div",{className:"leftPanel"});e.messageText=d.createChild("div",{className:"text"}),e.resetButton=d.createChild("div",{className:"resetButton"}),e.resetButton.createChild("div",{className:"resetButtonIcon"}),e.resetButton.createChild("div",{className:"resetButtonText",text:l("ui.common.resetCode")}),a(e.resetButton);var u=c.createChild("div",{className:"keypadContainer"});for(i=n;i>=0;i--)o[i]=u.appendChild(new r(i,{className:["keypad","num"+i]})),o[i].id=i,o[i].on("tap",t);var h=this.windowBody.createChild("div",{className:"confirmPanel"});e.confirmButton=h.appendChild(new r(l("ui.common.validation"),{className:"confirmButton"})),e.setupButtonEvents()}),this.on("open",function(t){t=t||{},e.fromInside=t.fromInside,e.resetCode();var i=e.padlockInfo.changeOrUse||t.fromInside;e.messageText.setText(l(i?"ui.common.lockInfos":"ui.common.unlockInfos"))}),e.setupListeners()}i(954);var o=i(172).inherits,s=i(541),a=i(197),r=i(335).DofusButton,l=i(29).getText,c=i(194);o(n,s),e.exports=n,n.prototype.setupButtonEvents=function(){var e=this;this.confirmButton.on("tap",function(){for(var t="",i=0;i<e.padlockInfo.codeSize;i++)t+=isNaN(parseInt(e.codeDigit[i].getText(),10))?"_":e.codeDigit[i].getText();var n={code:t};return e.fromInside?(window.dofus.sendMessage("HouseLockFromInsideRequestMessage",n),void c.close(e.id)):void(e.padlockInfo.changeOrUse?window.dofus.sendMessage("LockableChangeCodeMessage",n):window.dofus.sendMessage("LockableUseCodeMessage",n))}),this.resetButton.on("tap",function(){e.resetCode()}),this.resetButton.on("tapstart",function(){this.addClassNames("pressed")}),this.resetButton.on("tapend",function(){this.delClassNames("pressed")})},n.prototype.setupListeners=function(){var e=this,t={0:l("ui.house.codeChanged"),1:l("ui.error.badCode")};window.gui.on("LockableShowCodeDialogMessage",function(t){e.padlockInfo=t,c.openDialog(e.id,{fromInside:!1})}),window.gui.on("LockableCodeResultMessage",function(e){window.gui.openPopup({title:l("ui.common.code"),message:t[e.result]})})},n.prototype.enterCode=function(e){var t=this.currentCodeDigit%this.padlockInfo.codeSize;this.codeDigit[t].setText(e),this.codeDigit[t].show(),this.currentCodeDigit++,this.highlightDigit()},n.prototype.resetCode=function(){for(var e=0;e<this.codeDigit.length;e++)this.codeDigit[e].setText(""),this.codeDigit[e].hide();this.currentCodeDigit=0,this.highlightDigit()},n.prototype.highlightDigit=function(){for(var e=this.currentCodeDigit%this.padlockInfo.codeSize,t=0;t<this.codeDigitContainer.length;t++)t===e?this.codeDigitContainer[t].addClassNames("highlight"):this.codeDigitContainer[t].delClassNames("highlight")}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"PartyInviteDetailsWindow",positionInfo:_}),this.partyMap={},this.numParties=0,this.partyId=null;var e=this;window.gui.on("disconnect",function(){e._closeAll()})}i(956);var o=i(172).inherits,s=i(541),a=i(194),r=i(335).DofusButton,l=i(197),c=i(29).getText,d=i(702),u=i(575),h=i(369),p=i(410),m=i(436),f=563,g=904,_={left:"c",top:"c",minWidth:f,height:375};o(n,s),e.exports=n,n.prototype.showPartyDetails=function(e){return e===this.partyId?a.open(this.id):(window.dofus.sendMessage("PartyInvitationDetailsRequestMessage",{partyId:e}),this.partyMap[e]||(this.partyMap[e]=!0,this.numParties++,1===this.numParties&&this._setupListeners(!0)),void(this.text?this._resetDom():this._setupDom()))},n.prototype._closeAll=function(){for(var e in this.partyMap)this._closePartyInvitation(e);this.partyMap={},this.numParties=0,this.partyId=null},n.prototype._closePartyInvitation=function(e){this.partyMap[e]&&(delete this.partyMap[e],this.numParties--,0===this.numParties&&this._setupListeners(!1),window.gui.notificationBar.removeNotification("party"+e),e===this.partyId&&(this.partyId=null,a.close(this.id),this.windowBody.clearContent(),this.text=null,this.characters=[],this.members=null,this.scroller=null,this.slotList=null))},n.prototype._setupDom=function(){var e=this;this.text=this.windowBody.createChild("div",{className:"text"});var t=this.windowBody.createChild("div",{className:"container"});this.scroller=t.appendChild(new m({className:"slotList"},{isHorizontal:!0})),this.slotList=this.scroller.content,this.characters=[];var i=this.windowBody.createChild("div",{className:"buttons"}),n=i.appendChild(new r(c("ui.common.accept"),{className:"acceptButton"})),o=i.appendChild(new r(c("ui.common.refuse"),{className:"refuseButton"})),s=i.appendChild(new r(c("ui.social.blackListTemporarly"),{className:"ignoreButton"}));n.on("tap",function(){window.dofus.sendMessage("PartyAcceptInvitationMessage",{partyId:e.partyId}),e._closePartyInvitation(e.partyId)}),o.on("tap",function(){window.dofus.sendMessage("PartyRefuseInvitationMessage",{partyId:e.partyId}),e._closePartyInvitation(e.partyId)}),s.on("tap",function(){window.dofus.sendMessage("IgnoredAddRequestMessage",{name:e.fromName,session:!0}),e._closePartyInvitation(e.partyId)})},n.prototype._newCharacterSlot=function(){var e=this.slotList.createChild("div",{className:"character"});e.createChild("div",{className:"background",name:"background"}),e.appendChild(new h({name:"characterDisplay",scale:1.4,verticalAlign:"bottom"})),e.createChild("div",{className:"name",name:"name"}),e.createChild("div",{className:"breed",name:"breed"}),e.createChild("div",{className:"level",name:"level"}),l(e);var t=this;return e.on("tap",function(){if(e.characterId){var i=t.members[e.characterId];window.gui.openContextualMenu("player",{playerId:i.id,playerName:i.name})}}),e},n.prototype._resetDom=function(){this.characters=[],this.slotList.clearContent()},n.prototype._removeMember=function(e,t){if(e===this.partyId){var i=this.members[t];if(i){var n=i.index,o=this.characters.splice(n,1)[0];this.slotList.removeChild(o),this.characters.push(this._newCharacterSlot());for(var s in this.members)i=this.members[s],i.index>n&&i.index--;delete this.members[t],this.scroller.refresh()}}};var v=["PartyGuestInformations","PartyInvitationMemberInformations","PartyMemberInformations"];n.prototype._addOrUpdateMember=function(e,t,i){if(e===this.partyId){if(v.indexOf(t._type)===-1)return console.error("Unhandled type for character: "+t._type);var n=this.members[t.id];n?t.index=n.index:t.index=Object.keys(this.members).length,this.members[t.id]=t,this._updateCharacterSlot(t),i||this.scroller.refresh()}},n.prototype._updateCharacterSlot=function(e){var t=this.characters[e.index];t||(t=this.characters[e.index]=this._newCharacterSlot()),t.characterId=e.id,t.getChild("name").setText(e.name),t.getChild("level").setText(c("ui.common.level")+" "+e.level),t.getChild("breed").setText(window.gui.databases.Breeds[e.breed].shortNameId);var i=t.getChild("characterDisplay");i.setLook(e.entityLook,{direction:p.DIRECTION_SOUTH_EAST,animation:"AnimStatique",boneType:"characters/",skinType:"characters/",riderOnly:!0}),this._toggleGuest(e.id,e.isGuest)},n.prototype._toggleGuest=function(e,t){var i=this.members[e];if(i){var n=this.characters[i.index];n.getChild("background").toggleClassName("guestFrame",!!t)}},n.prototype._toggleLeader=function(e,t){var i=this.members[e];if(i){var n=this.characters[i.index];n.getChild("background").toggleClassName("leaderIcon",!!t)}},n.prototype._setLeader=function(e,t){e===this.partyId&&(this._toggleLeader(this.leaderId,!1),this._toggleLeader(t,!0),this.leaderId=t)},n.prototype._joinParty=function(e){var t=e.partyId;this.partyId=t;var i=e.partyType===u.PARTY_TYPE_ARENA;_.width=i?f:g,this.position=null,a.open(this.id),this.windowTitle.setText(c(i?"ui.common.invitationArena":"ui.common.invitationGroupe")),this.slotList.toggleClassName("arena",i),this.slotList.toggleClassName("classic",!i);for(var n=i?d.NUM_SLOTS_ARENA:d.NUM_SLOTS_CLASSIC,o=n;o>0;o--)this.characters.push(this._newCharacterSlot());for(this.text.setText(c("ui.common.invitationPresentation",e.fromName)+"."),this.fromName=e.fromName,this.members={},o=0;o<e.members.length;o++)this._addOrUpdateMember(t,e.members[o],!0);for(o=0;o<e.guests.length;o++)this._addOrUpdateMember(t,e.guests[o],!0);this._setLeader(t,e.leaderId),this.scroller.refresh()},n.prototype._setupListeners=function(e){var t=window.gui.playerData.partyData;this.joinPartyHandler||(this.joinPartyHandler=this._joinParty.bind(this),this.closePartyInvitationHandler=this._closePartyInvitation.bind(this),this.setLeaderHandler=this._setLeader.bind(this),this.addOrUpdateMemberHandler=this._addOrUpdateMember.bind(this),this.removeMemberHandler=this._removeMember.bind(this)),e?(t.on("partyInvitationDetails",this.joinPartyHandler),t.on("partyInvitationCancelled",this.closePartyInvitationHandler),t.on("partyLeaderUpdate",this.setLeaderHandler),t.on("partyNewGuest",this.addOrUpdateMemberHandler),t.on("partyNewMember",this.addOrUpdateMemberHandler),t.on("partyUpdateMember",this.addOrUpdateMemberHandler),t.on("partyMemberLeaving",this.removeMemberHandler),t.on("partyGuestLeaving",this.removeMemberHandler)):(t.removeListener("partyInvitationDetails",this.joinPartyHandler),t.removeListener("partyInvitationCancelled",this.closePartyInvitationHandler),t.removeListener("partyLeaderUpdate",this.setLeaderHandler),t.removeListener("partyNewGuest",this.addOrUpdateMemberHandler),t.removeListener("partyNewMember",this.addOrUpdateMemberHandler),t.removeListener("partyUpdateMember",this.addOrUpdateMemberHandler),t.removeListener("partyMemberLeaving",this.removeMemberHandler),t.removeListener("partyGuestLeaving",this.removeMemberHandler))}},function(e,t){},function(e,t,i){function n(){function e(){l.close("presetChooseIcon",c.YES)}r.call(this,{className:"PresetChooseIconWindow",title:s("ui.option.tabPic"),positionInfo:{left:"c",top:"c",width:460,height:250}}),this.once("open",function(t){this.windowBody.appendChild(t),this.saveButton=this.windowBody.appendChild(new o(s("ui.common.save"))),this.saveButton.on("tap",function(){e()})})}var o=i(335).DofusButton,s=i(29).getText,a=i(172).inherits,r=i(541),l=i(194),c=i(808).actionsEnum;a(n,r),e.exports=n},function(e,t,i){function n(){var e=this;a.call(this,{title:r("ui.achievement.rewardsWaiting"),className:"rewardsPending",positionInfo:{left:"c",top:"c-32px",width:500,height:300}}),this.rewards={},this.isInFight=!1,this.isInTutorial=!1,this.rewardsList=this.windowBody.createChild("div",{className:"rewardsList"}),this.counter=this.windowBody.createChild("div",{className:"counter"}),this.acceptAllButton=this.windowBody.appendChild(new l(r("ui.common.acceptAll"))),this.acceptAllButton.on("tap",function(){e.collectAll()});var t=window.gui;t.playerData.achievements.on("achievementFinished",function(t){e.addReward(t.id,t.finishedlevel)}),t.playerData.achievements.on("achievementListUpdated",function(t){for(var i=0;i<t.rewardableAchievements.length;i+=1){var n=t.rewardableAchievements[i];e.addReward(n.id,n.finishedlevel)}}),t.playerData.achievements.on("achievementRewardSuccess",function(t){e.removeReward(t)}),t.on("disconnect",function(){e.reset()}),t.fightManager.on("fightStart",function(){e.isInFight=!0,e.handleRewardsIndicatorDisplay()}),t.fightManager.on(p.FIGHT_END,function(){e.isInFight=!1,e.handleRewardsIndicatorDisplay()}),t.tutorialManager.on("inTutorialStateChanged",function(t){e.isInTutorial=t,e.handleRewardsIndicatorDisplay()})}i(959);var o=i(31),s=i(172).inherits,a=i(541),r=i(29).getText,l=i(335).DofusButton,c=i(739),d=i(197),u=i(194),h=i(30),p=i(348),m=i(182),f=i(339);s(n,a),e.exports=n,n.prototype.addReward=function(e,t){function i(t){h.getData("Achievements",e,function(e,i){return e?t(e):(A=i.nameId,E=i.categoryId,N=i.rewardIds,I=i,t())})}function n(e){if(y.rootElement){var i=window.gui.playerData.achievements.getAchievementKamasReward(I,t);y.kamas.setText(f.kamasToString(i,""));var n=window.gui.playerData.achievements.getAchievementExperienceReward(I,t);return y.xp.setText(f.kamasToString(n,"")),e()}}function s(e){h.getData("AchievementCategories",E,function(t,i){return t?e(t):(S=i.parentId,x=i.nameId,e())})}function a(e){return 0===S?e():void h.getData("AchievementCategories",S,function(t,i){return t?e(t):(x=i.nameId,e())})}function r(e){return 0===N.length?e():void h.getData("AchievementRewards",N,function(i,n){if(i)return e(i);for(var o=0;o<n.length;o+=1){var s=n[o];if((s.levelMin===-1||s.levelMin<=t)&&(s.levelMax===-1||s.levelMax>=t))return L=s.itemsReward,O=s.itemsQuantityReward,D=s.emotesReward,R=s.titlesReward,P=s.ornamentsReward,e()}return e(new Error("rewardNotFound"))})}function l(e){return 0===L.length?e():void h.getData("Items",L,function(t,i){if(t)return e(t);for(var n=0;n<i.length;n+=1)B.push("gfx/items/"+i[n].iconId+".png");return e()})}function u(e){for(var t=0;t<D.length;t+=1)B.push("gfx/emotes/"+D[t]+".png");return e()}function p(e){for(var t=0;t<R.length;t+=1)B.push("gfx/illusUi/genericTitleIcon.png");return e()}function g(e){return 0===P.length?e():void h.getData("Ornaments",P,function(t,i){if(t)return e(t);for(var n=0;n<i.length;n+=1)B.push("gfx/ornaments/"+i[n].iconId+".png");return e()})}function _(e){return 0===B.length?e():void m.preloadImages(B,function(t){for(var i=0;i<t.length;i+=1){var n=T[i];n.rootElement&&(n.setImage(t[i]),n.setQuantity(O[i]))}return e()})}var v=this,y=this.rewardsList.createChild("div",{className:"reward"});y.id=e,y.left=y.createChild("div",{className:"rewardLeft"}),y.right=y.createChild("div",{className:"rewardRight"}),y.nameText=y.left.createChild("div",{className:"rewardName"}),y.category=y.right.createChild("div",{className:"rewardCategory"}),y.numbers=y.right.createChild("div",{className:"rewardNumbers"}),y.xp=y.numbers.createChild("div",{className:"rewardXp"}),y.kamas=y.numbers.createChild("div",{className:"rewardKamas"}),y.collectButton=y.right.createChild("div",{className:"collectButton"}),d(y.collectButton),y.collectButton.on("tap",function(){v.collectReward(y.id)});for(var b=y.left.createChild("div",{className:"rewards",name:"rewards"}),M=b.createChild("div",{className:"rewardList"}),w=6,T=[],C=0;C<w;C+=1)T[C]=M.appendChild(new c({name:"icon"+C}));this.rewards[e]=y,this.updateCounter(),this.handleRewardsIndicatorDisplay();var A,I,S,E,x,N,L=[],O=[],D=[],R=[],P=[],B=[];o.series([i,n,s,a,r,l,u,p,g,_],function(e){return e?console.error(e):void(y.rootElement&&(y.nameText.setText(A),y.category.setText(x)))})},n.prototype.removeReward=function(e){var t=this.rewards[e];t.destroy(),delete this.rewards[e],this.updateCounter(),this.handleRewardsIndicatorDisplay()},n.prototype.collectAll=function(){window.dofus.sendMessage("AchievementRewardRequestMessage",{achievementId:-1})},n.prototype.collectReward=function(e){window.dofus.sendMessage("AchievementRewardRequestMessage",{achievementId:e})},n.prototype.updateCounter=function(){var e=Object.keys(this.rewards).length;this.counter.setText(r("ui.achievement.rewardsRemaining",e))},n.prototype.handleRewardsIndicatorDisplay=function(){var e=Object.keys(this.rewards).length;0===e&&u.close("rewardsPending"),window.gui.rewardsIndicator.toggleDisplay(e>0&&!this.isInFight&&!this.isInTutorial)},n.prototype.reset=function(){this.rewards={},this.isInFight=!1,this.isInTutorial=!1,this.rewardsList.clearContent()}},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"ServerDetailsWindow",title:c("ui.sersel.suggestedServer"),positionInfo:{left:"c",top:"c",width:350,height:350},hidden:!0});var e,t=this,i=this.windowBody,n=i.appendChild(new s),o=i.createChild("div",{className:"buttonsDiv"}),d=o.appendChild(new l(c("ui.common.ok"),{className:"okBtn"})),u=o.appendChild(new l(c("ui.common.cancel"),{className:"cancelBtn"}));d.on("tap",function(){return e?(d.disable(),window.gui.serversData.selectServer(e.id),void r.close(t.id)):console.error("No server")}),u.on("tap",function(){r.close(t.id)}),this.on("open",function(t){e=t,n.setServer(e),3===e.status?d.enable():d.disable()})}i(961);var o=i(172).inherits,s=i(962),a=i(541),r=i(194),l=i(335).DofusButton,c=i(29).getText;o(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(e){var t=c.createChild("div",{className:["detail",e]});t.createChild("div",{className:["line","label"],text:n[e]}),i._detailsBlock[e]=t.createChild("div",{className:["line","text"]})}function t(e){d!==e&&("description"===e?(h.addClassNames("selected"),p.delClassNames("selected"),d="description",i._descContent.show(),i._rulesContent.hide()):(h.delClassNames("selected"),p.addClassNames("selected"),d="rules",i._descContent.hide(),i._rulesContent.show()))}s.call(this,"div",{className:"ServerDetails"});var i=this,n={name:r("ui.common.name")+":",community:r("ui.sersel.community")+":",population:r("ui.sersel.population")+":",type:r("ui.sersel.type")+":",status:r("ui.sersel.state")+":",openingDate:r("ui.sersel.date")+":"},o=this.createChild("div",{className:"content"}),l=o.createChild("div",{className:"top"});this._image=l.createChild("div",{className:"image"});var c=l.createChild("div",{className:"details"});this._detailsBlock={},e("name"),e("empty"),e("community"),e("population"),e("type"),e("status"),e("openingDate");var d="description",u=o.createChild("div",{className:"bottom"}),h=u.createChild("div",{className:"descBtn",text:r("ui.common.description")}),p=u.createChild("div",{className:"rulesBtn",text:r("ui.sersel.rules")});a(h),a(p),h.on("tap",function(){t("description")}),p.on("tap",function(){t("rules")});var m=u.createChild("div",{className:"bottomContent"});this._descContent=m.createChild("div",{className:"descContent"}),this._rulesContent=m.createChild("div",{className:"rulesContent"}),h.addClassNames("selected"),this._rulesContent.hide()}i(963);var o=i(172).inherits,s=i(321),a=i(197),r=i(29).getText,l=i(645);o(n,s),e.exports=n,n.prototype.setServer=function(e){var t=this,i={0:r("ui.server.state.unknown"),1:r("ui.server.state.offline"),2:r("ui.server.state.starting"),3:r("ui.server.state.online"),4:r("ui.server.state.nojoin"),5:r("ui.server.state.saving"),6:r("ui.server.state.stoping"),7:r("ui.server.state.full")},n={0:r("ui.server.rules.0"),1:r("ui.server.rules.1")};window.gui.serversData.syncServerStaticData(function(o){if(o)return console.error("ServerDetails setServer error",o);l.getServerImage(e.id,function(e,i){return e?console.error(e):void t._image.setStyle("backgroundImage",i)}),t._detailsBlock.status.setText(i[e.status]);var s=window.gui.serversData.staticContent,a=s.data[e.id]||{},r=s.gameTypes[a.gameTypeId]||{},c=s.populations[a.populationId]||{},d=s.communities[a.communityId]||{};t._detailsBlock.name.setText(a.nameId||e.id),t._detailsBlock.community.setText(d.nameId||"n/a"),t._detailsBlock.population.setText(c.nameId||"n/a"),t._detailsBlock.type.setText(r.nameId||"n/a");var u=new Date(a.openingDate||0);t._detailsBlock.openingDate.setText(u.getDate()+"/"+(u.getMonth()+1)+"/"+u.getFullYear()),t._descContent.setText(a.commentId),t._rulesContent.setText(n[a.gameTypeId]||"")})}},function(e,t){},function(e,t,i){function n(){function e(e,t,i){var n=e.createChild("div",{className:t});return a(n),n.on("tap",i),n}function t(){M&&(M.delClassNames("selected"),M=null),R.hide(),F.disable()}function i(){t();var e=m;y&&(e=e.filter(function(e){return e.charactersCount>0})),v||(e=e.filter(function(e){return w.indexOf(e.id)!==-1})),_&&(e=e.filter(function(e){return _.indexOf(e.id)!==-1})),window.gui.serversData.syncServerStaticData(function(t){if(t)return console.error("ServerRow getServerStaticData error",t);var i=window.gui.serversData.staticContent;e.sort(function(e,t){if(!i.data[e.id])return 1;if(!i.data[t.id])return-1;var n=i.data[e.id].populationId,o=i.data[t.id].populationId,s=i.populations[n].weight,a=i.populations[o].weight,r=s-a;return 0!==r?r:t.id-e.id});for(var o=0,s=Math.max(e.length,T.length);o<s;o+=1){var a=e[o],r=T[o];a?r?(r.setServer(a),r.show()):n(a,T.length%2):r&&r.hide()}!M&&e[0]&&T[0].emit("tap")})}function n(e,t){var i=L.appendChild(new r(e,t));T.push(i),i.on("tap",function(){M&&M.delClassNames("selected"),i.addClassNames("selected"),M=i,R.setServer(i.data),R.show(),3===i.data.status?F.enable():F.disable()})}function o(){v?(v=!1,B.delClassNames("selected")):(v=!0,B.addClassNames("selected"))}function p(){y?(y=!1,k.delClassNames("selected")):(y=!0,k.addClassNames("selected"))}s.call(this,{className:"ServerListSelectionWindow",title:d("ui.sersel.choseServer"),positionInfo:{left:"c",top:"c",width:700,height:510},hidden:!0});var m,f,g,_,v,y,b=this,M=null,w=[],T=[],C={0:d("ui.sersel.searchError.unknown"),1:d("ui.sersel.searchError.unavailable"),2:d("ui.sersel.searchError.no_result"),3:d("ui.sersel.searchError.flood")},A=this.windowBody,I=A.createChild("div",{className:"findFriendDiv"});I.createChild("div",{className:"findFriendLabel",text:d("ui.sersel.findFriend")+": "});var S=I.appendChild(new h({className:"inputFriend",attr:{type:"text",id:"inputFriend"}}));e(I,["okBtn","btn"],function(){S.rootElement.value&&(f=S.rootElement.value,window.dofus.sendMessage("AcquaintanceSearchMessage",{nickname:f}))}),e(I,["clearBtn","btn"],function(){S.rootElement.value="",_=null,i()});var E=A.createChild("div",{className:"middleDiv"}),x=E.createChild("div",{className:"leftFrame"}),N=x.createChild("div",{className:"serverList"}),L=N.createChild("div",{className:"div-table"}),O=L.createChild("div",{className:["listHead","listRow","odd"]});O.createChild("div",{className:["listHeadBox","empty"]}),O.createChild("div",{className:["listHeadBox","name"],text:d("ui.common.name")}),O.createChild("div",{className:["listHeadBox","population"],text:d("ui.sersel.population")}),O.createChild("div",{className:["listHeadBox","status"],text:d("ui.sersel.state")});var D=E.createChild("div",{className:"rightFrame"});D.createChild("div",{className:"title",text:d("ui.sersel.suggestedServer")+":"});var R=D.appendChild(new l),P=x.createChild("div",{className:"filtersBtn"}),B=e(P,"allServersBtn",function(){o(),i()}),k=e(P,"myServersBtn",function(){p(),i()}),z=A.createChild("div",{className:"topBtnDiv"}),F=z.appendChild(new c(d("ui.common.validation"),{className:"confirmBtn"}));F.on("tap",function(){M&&(F.disable(),window.gui.serversData.selectServer(M.data.id))});var H=A.createChild("div",{className:"bottomLeftBtnDiv"}),q=H.appendChild(new c(d("ui.common.back"),{className:"returnBtn"}));q.on("tap",function(){u.close(b.id)});var W=A.createChild("div",{className:"bottomRightBtnDiv"
}),U=W.appendChild(new c(d("ui.sersel.autochoice"),{className:"autochooseBtn"}));U.on("tap",function(){window.gui.serversData.pickUpOneServerForMe()}),this.on("open",function(){m=window.gui.serversData.serversRawData,t(),window.gui.serversData.getAutoChosenServers(function(e,t){e&&console.warn(e),g=t||[],v=!1,B.delClassNames("selected"),y=!1,k.delClassNames("selected"),w=[];for(var n=0,o=g.length;n<o;n+=1)w.push(g[n].id);i(),window.gui.on("serversUpdate",i)})}),this.on("close",function(){window.gui.removeListener("serversUpdate",i)}),window.gui.on("AcquaintanceSearchErrorMessage",function(e){var t=e.reason;t&&window.gui.openPopup({title:d("ui.common.error"),message:C[t].replace("%1",f)})}),window.gui.on("AcquaintanceServerListMessage",function(e){_=e.servers,i()}),window.gui.on("TrustStatusMessage",function(){u.close(b.id)})}i(965);var o=i(172).inherits,s=i(541),a=i(197),r=i(966),l=i(962),c=i(335).DofusButton,d=i(29).getText,u=i(194),h=i(530);o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(e,t){s.call(this,"div",{className:["ServerRow","listRow"]}),a(this),t&&this.addClassNames("odd"),this._DEFAULT_POPULATION_CLASSES=["listBox","listCell","population"],this._DEFAULT_NAME_CLASSES=["listBox","listCell","name"];var i=this.createChild("div",{className:["listBox","listCell","flag"]});this._flag=i.createChild("div",{className:"flagImage"}),this._serverName=this.createChild("div",{className:this._DEFAULT_NAME_CLASSES}),this._population=this.createChild("div",{className:this._DEFAULT_POPULATION_CLASSES});var n=this.createChild("div",{className:["listBox","listCell","status"]});this._status=n.createChild("div",{className:"statusImage"}),this.setServer(e)}i(967);var o=i(172).inherits,s=i(321),a=i(197),r=i(182);o(n,s),e.exports=n,n.prototype.setServer=function(e){if(!e)return this._flag.hide(),this._serverName.setText(""),this._population.setText(""),void this._status.hide();var t=this;this.id=e.id,this.data=e;var i=window.gui.serversData.staticContent,n=window.gui.serversData.staticContent.data[this.id]||{};this._flag.show(),this._status.show(),this._serverName.setText(n.nameId||e.id),this._serverName.setClassNames(this._DEFAULT_NAME_CLASSES),1===n.gameTypeId&&this._serverName.setClassNames(this._DEFAULT_NAME_CLASSES,"heroic"),this._population.setClassNames(this._DEFAULT_POPULATION_CLASSES,"popu_",n.populationId);var o=i.populations[n.populationId]||{};this._population.setText(o.nameId||"n/a"),this._status.setClassNames(["statusImage","status_"+e.status]),r.preloadImage("gfx/flags/flag_"+n.communityId+".png",function(e){t._flag.setStyle("backgroundImage",e)})}},function(e,t){},function(e,t,i){function n(){function e(){h=o.filter(function(e){return e.charactersCount>0}),h.sort(function(e,t){return e.isSelectable===t.isSelectable?t.date-e.date:!e.isSelectable})}function t(e){p&&p.delClassNames("selected"),p=e,e&&(e.addClassNames("selected"),g=e.data.id,m.selectBtn.enable(),m.createCharBtn.enable())}function i(){e(),t(null);for(var i=0;i<f;i+=1){var n=v[i],o=h[i+_];n.setServer(o),o&&o.id===g&&o.status===d.ONLINE&&t(n)}_<=0?b.disable():b.enable(),_>=h.length-f?w.disable():w.enable()}function n(e){var i=M.appendChild(new l(e));i.on("tap",function(){t(this)}),v.push(i)}a.call(this,{className:"ServerSelectionWindow",title:c("ui.sersel.choseServer"),positionInfo:{left:"c",top:"c",width:700,height:445},hidden:!0});var o,h,p,m=this,f=4,g=null,_=0,v=[];this.closeButton.on("tap",function(){window.dofus.disconnect()});var y=this.windowBody,b=y.appendChild(new s({className:["arrow","arrowLeft"]},function(){_<=0||(b.disable(),_-=1,i())}));b.on("disabled",function(){this.addClassNames("disabled")}),b.on("enabled",function(){this.delClassNames("disabled")});var M=y.createChild("div",{className:"serverBoxesDiv"}),w=y.appendChild(new s({className:["arrow","arrowRight"]},function(){_>=h.length-f||(w.disable(),_+=1,i())}));w.on("disabled",function(){this.addClassNames("disabled")}),w.on("enabled",function(){this.delClassNames("disabled")});for(var T=0;T<f;T+=1)n();var C=y.appendChild(new s({className:["greenButton","selectServerBtn"],text:c("ui.common.select")},function(){C.disable(),m.createCharBtn.disable(),window.gui.serversData.connectedServerId===g?(window.dofus.sendMessage("CharactersListRequestMessage"),r.close(m.id)):window.gui.serversData.selectServer(g)}));this.selectBtn=C,C.disable();var A=y.createChild("div",{className:"createCharacterDiv"});this.createCharBtn=A.appendChild(new s({className:["greenButton","createCharacterBtn"],text:c("ui.charsel.createCharacter")},function(){r.close(m.id),r.open("serverSimpleSelection")})),window.gui.on("TrustStatusMessage",function(){r.close(m.id)}),this.on("open",function(){o=window.gui.serversData.serversRawData,e(),g||(g=u.getValue("lastServerId")),_=0,b.disable(),h.length<=f&&w.disable(),i(),window.gui.on("serversUpdate",i),m.consoleButton.toggleDisplay(window.gui.playerData.identification.hasRights)}),this.on("close",function(){window.gui.removeListener("serversUpdate",i)}),this.consoleButton=y.appendChild(new s({className:["consoleButton"],hidden:!0},function(){r["switch"]("adminConsole")}))}i(969);var o=i(172).inherits,s=i(335),a=i(541),r=i(194),l=i(970),c=i(29).getText,d=i(646),u=i(176);o(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"ServerBox"}),a(this),this._SERVER_STATUS={0:r("ui.server.state.unknown"),1:r("ui.server.state.offline"),2:r("ui.server.state.starting"),3:r("ui.server.state.online"),4:r("ui.server.state.nojoin"),5:r("ui.server.state.saving"),6:r("ui.server.state.stoping"),7:r("ui.server.state.full")},this._completions=[],this._title=this.createChild("div",{className:"title"}),this._content=this.createChild("div",{className:"content"}),this._placeholder=this.createChild("div",{className:"placeholderDiv"}),this._content.createChild("div",{className:"selection"}),this._image=this._content.createChild("div",{className:"image"});for(var t=0;t<5;t+=1)this._completions.push(this._content.createChild("div",{className:"completion"}));this._heroicIcon=this._content.createChild("div",{className:"heroicIcon"});var i=this._content.createChild("div",{className:"statusBlock"});this._statusIcon=i.createChild("div",{className:"statusIcon"}),this._statusText=i.createChild("div",{className:"statusText"}),this.setServer(e)}i(971);var o=i(172).inherits,s=i(321),a=i(197),r=i(29).getText,l=i(645),c=i(646);o(n,s),e.exports=n,n.prototype.setServer=function(e){var t=this;if(this.delClassNames("placeHolder"),this._placeholder.hide(),!e)return this.addClassNames("placeHolder"),this.disable(),this._content.hide(),this._placeholder.show(),void this._title.setText("");this._title.setText(e._name||"");for(var i=0,n=this._completions.length;i<n;i+=1){var o=this._completions[i];i<e.charactersCount?o.addClassNames("on"):o.delClassNames("on")}var s=1===e._gameTypeId;this._heroicIcon.toggleDisplay(s),this.data=e,e.status===c.ONLINE?this.enable():this.disable(),this._statusIcon.setClassNames(["statusIcon","status_"+e.status]),this._statusText.setText(this._SERVER_STATUS[e.status||0]),this._content.show(),l.getServerImage(e.id,function(e,i){return e?console.error(e):void t._image.setStyle("backgroundImage",i)})}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"ServerSimpleSelectionWindow",title:c("ui.sersel.choseServer"),positionInfo:{left:"c",top:"c",width:700,height:400},hidden:!0}),this.once("open",n.prototype._createContent)}i(973);var o=i(172).inherits,s=i(541),a=i(194),r=i(335),l=r.DofusButton,c=i(29).getText,d=i(182);o(n,s),e.exports=n,n.prototype._createContent=function(){var e=this,t=this.windowBody,i=t.createChild("div",{className:"bg"});d.preloadImage("gfx/illusUi/simpleServerChoiceIllu.png",function(e){i.setStyle("backgroundImage",e)});var n=t.appendChild(new l(c("ui.sersel.autoChoice"),{className:"autoSelectServerBtn"}));n.on("tap",function(){window.gui.serversData.pickUpOneServerForMe()});var o=t.createChild("div",{className:"manualCreationDiv"}),s=o.appendChild(new l(c("ui.sersel.manualChoice"),{className:"manualCreationBtn"}));s.on("tap",function(){a.open("serverListSelection")}),this.on("close",function(e){e&&e.validated||a.open("serverSelection")}),window.gui.on("TrustStatusMessage",function(){a.close(e.id,{validated:!0})}),this.consoleButton=t.appendChild(new r({className:["consoleButton"],hidden:!window.gui.playerData.identification.hasRights},function(){a["switch"]("adminConsole")}))}},function(e,t){},function(e,t,i){function n(){l.call(this,{className:"teleporterListWindow",title:"_",positionInfo:{left:"c",top:"c",width:"600",height:"440"}});var e=this;this.parentBody=null,this.zaapBody=this.windowBody.createChild("div",{className:["teleporterBody","zaapBody"]}),this.subwayBody=this.windowBody.createChild("div",{className:["teleporterBody","subwayBody"]}),this.createTabs(this.zaapBody,[{title:p("ui.zaap.zaap"),name:"Zaap"},{title:p("ui.zaap.prism"),name:"Prism"}]),this.createTabs(this.subwayBody,[{title:p("ui.map.craftHouse"),name:"CraftHouse"},{title:p("ui.map.bidHouse"),name:"BidHouse"},{title:p("ui.common.misc"),name:"Misc"}]),this.createFooter(),window.gui.on("ZaapListMessage",function(t){e.setContent(t)}),window.gui.on("TeleportDestinationsListMessage",function(t){e.setContent(t)})}i(975);var o,s,a,r=i(172).inherits,l=i(541),c=i(321),d=i(335),u=i(197),h=i(194),p=i(29).getText,m=i(339),f=i(834),g=i(649),_=i(976),v=3,y=2;r(n,l),e.exports=n,n.prototype.createTabs=function(e,t){e.tabs=new f,e.appendChild(e.tabs),e.panels=e.createChild("div",{className:"panels"}),e.panelCollection={};for(var i=0,n=t.length;i<n;i+=1){var o=t[i].name;e.panelCollection[o]=e.panels.createChild("div",{className:["panel"]}),e.tabs.addTab(t[i].title,e.panelCollection[o]),this.createTable(e.panelCollection[o])}},n.prototype.createTable=function(e){function t(t){e.selectedTeleporterType=t.teleporterType,e.selectedMapId=t.mapId}var i=p("ui.zaap.destination")+p("ui.common.colon"),n=p("ui.common.area")+" ("+p("ui.common.subarea")+")";e.table=e.appendChild(new g({colIds:["saved","destination","coordinates","cost"],colCount:4,highlightable:!0,headerContent:["",i+n,p("ui.common.coordinatesSmall"),p("ui.common.cost")],onRowTap:t}))},n.prototype.createFooter=function(){var e=this,t=this.windowBody.createChild("div",{className:"footer"}),i=t.appendChild(new d({className:"greenButton",text:p("ui.common.validation")}));i.on("tap",function(){var t=e.parentBody.tabs.getCurrentTab().target;window.dofus.sendMessage("TeleportRequestMessage",{teleporterType:t.selectedTeleporterType,mapId:t.selectedMapId})}),this.nbKamas=t.createChild("div",{className:"nbKamas"})},n.prototype.setContent=function(e){switch(h.openDialog(this.id),this.setClassNames("window","teleporterListWindow"),o=window.gui.playerData.inventory.kamas,s=window.gui.playerData.position.mapId,a=window.gui.playerData.position.subArea.nameId,e.teleporterType){case _.TELEPORTER_ZAAP:case _.TELEPORTER_PRISM:this.setupZaapBody(e);break;case _.TELEPORTER_SUBWAY:this.setupSubwayBody(e)}this.nbKamas.setText(m.kamasToString(o,""))},n.prototype.setupZaapBody=function(e){var t,i,n;n=p(e.teleporterType===_.TELEPORTER_ZAAP?"ui.zaap.zaap":"ui.zaap.prism"),this.windowTitle.setText(n+" - "+a),s===e.spawnMapId?this.windowTitle.addClassNames("saved"):this.windowTitle.delClassNames("saved"),this.parentBody=this.zaapBody,this.zaapBody.show(),this.subwayBody.hide();for(t in this.zaapBody.panelCollection)i=this.zaapBody.panelCollection[t],i.table&&i.table.clearContent();var o=e._subAreas.length,r=[];for(t=0;t<o;t+=1){var l=e._subAreas[t],c=e._maps[t],d=e.destTeleporterType[t];r.push({name:l.areaName+" ("+l.name+")",type:d,posX:c.posX,posY:c.posY,mapId:c.id,teleporterCost:e.costs[t],saved:c.id===e.spawnMapId})}for(r.sort(function(e,t){return e.name>t.name?1:-1}),t=0;t<o;t+=1){var u=r[t],h=u.type===_.TELEPORTER_ZAAP||u.type===_.TELEPORTER_PRISM;if(u.mapId!==s&&h){var m;u.type===_.TELEPORTER_ZAAP&&(m=this.zaapBody.panelCollection.Zaap),u.type===_.TELEPORTER_PRISM&&(m=this.zaapBody.panelCollection.Prism),this.addTeleporter({parentPanel:m,teleporterType:u.type,destinationName:u.name,posX:u.posX,posY:u.posY,mapId:u.mapId,teleporterCost:u.teleporterCost,saved:u.saved})}}this.setupTabs()},n.prototype.setupSubwayBody=function(e){var t,i,n;this.windowTitle.setText(p("ui.zaap.zaapi")+" - "+a),s===e.spawnMapId?this.windowTitle.addClassNames("saved"):this.windowTitle.delClassNames("saved"),this.parentBody=this.subwayBody,this.zaapBody.hide(),this.subwayBody.show();for(t in this.subwayBody.panelCollection)i=this.subwayBody.panelCollection[t],i.table&&i.table.clearContent();var o=e._hints.length,r=[];for(t=0;t<o;t+=1)n=e._hints[t],r.push({name:n.nameId,category:n.categoryId,posX:n.x,posY:n.y,mapId:n.realMapId||n.mapId,teleporterCost:n.teleporterCost,saved:n.mapId===e.spawnMapId});for(r.sort(function(e,t){return e.name>t.name?1:-1}),t=0;t<o;t+=1)if(n=r[t],n.mapId!==s){var l;l=n.category===v?this.subwayBody.panelCollection.CraftHouse:n.category===y?this.subwayBody.panelCollection.BidHouse:this.subwayBody.panelCollection.Misc,this.addTeleporter({parentPanel:l,teleporterType:_.TELEPORTER_SUBWAY,destinationName:n.name,posX:n.posX,posY:n.posY,mapId:n.mapId,teleporterCost:n.teleporterCost,saved:n.saved})}this.setupTabs()},n.prototype.addTeleporter=function(e){var t=new c("div");t.createChild("div",{className:"destinationName",text:e.destinationName});var i=t.appendChild(new d({className:"btnMapLocation"})),n=e.teleporterCost,s=e.parentPanel.table.addRow({saved:e.saved?new c("div",{className:"saved"}):"",destination:t,coordinates:e.posX+","+e.posY,cost:m.kamasToString(n)},{teleporterType:e.teleporterType,mapId:e.mapId});u(i),o<n&&s.addClassNames("disabled"),i.on("tap",function(){window.gui.emit("CompassUpdateMessage",{type:"zaap",worldX:e.posX,worldY:e.posY}),h.open("worldMap",{x:e.posX,y:e.posY})})},n.prototype.setupTabs=function(){var e=this.parentBody.tabs,t=e.getTabsMap(),i=!1;for(var n in t){var o=t[n];o.target.table.getRows().length<=0?o.tab.disable():(o.tab.enable(),i||(e.openFirstTab(),i=!0))}if(!i){var s=e.getFirstTab();s.tab.enable(),e.openFirstTab()}}},function(e,t){},function(e,t){e.exports={TELEPORTER_ZAAP:0,TELEPORTER_SUBWAY:1,TELEPORTER_PRISM:2}},function(e,t,i){function n(e){function t(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:n.objectUID,quantity:m?-e:e})}function i(e,i,o,s){return m=s||!1,n=e.itemInstance,1===n.quantity?t(1,m):(r="items",void g.open({min:1,max:n.quantity,x:i,y:o}))}h.call(this,{title:a("ui.common.inventory"),className:"ExchangeInventoryWindow",positionInfo:{right:"0.5%",bottom:"3%",width:"30%",height:"94%"}});var n,r,m,f;e.registerView(this,{leftArrow:!0});var g=this.minMaxSelector=window.gui.windowsContainer.appendChild(new c);g.on("confirm",function(e){"items"===r?t(e):window.dofus.sendMessage("ExchangeObjectMoveKamaMessage",{quantity:e})});var _=this.windowBody.appendChild(new o(a("tablet.exchange.deposit")));_.addClassNames("depositButton"),_.on("tap",function(){var t=e.kamasValue;if(t){var i=p.getWindow("exchangeStorage");i.closeMinMaxSelector(),d.positionNextTo(g,_),r="kamas",g.open({min:1,max:t})}}),this.on("open",function(t){f=t.exchangeType,f===s.STORAGE&&e.addFilters([l.unlinkedItemsFilter]),e.filterList(),e.resetDisplay(),this.windowBody.appendChild(_),_.toggleDisplay(t.exchangeType!==s.MOUNT),_.setEnable(!!e.kamasValue)}),this.on("close",function(){f===s.STORAGE&&e.removeFilter(l.unlinkedItemsFilter),g.closeMinMax(),f=null}),this.on("kamasUpdated",function(e){_.isVisible()&&_.setEnable(!!e)}),this.on("slot-doubletap",i),this.on("leftArrow-tap",function(t){window.gui.openContextualMenu("storage",{toInventory:!1,viewer:e},{x:t.x,y:t.y})}),u(this,["exchangeStorage"]),this.on("drop",function(e,t,n){i(e,n.x,n.y,!0)})}i(978);var o=i(335).DofusButton,s=i(578),a=i(29).getText,r=i(172).inherits,l=i(461),c=i(332),d=i(334),u=i(317).setDroppable,h=i(541),p=i(194);r(n,h),e.exports=n,n.prototype.closeMinMaxSelector=function(){this.minMaxSelector.closeMinMax()}},function(e,t){},function(e,t,i){function n(e){function t(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:l.objectUID,quantity:f?e:-e})}function i(e,i,n,o){return f=o||!1,l=e.itemInstance,1===l.quantity?t(1):(m="items",void _.open({min:1,max:l.quantity,x:i,y:n}))}function n(e){c.createItemInstances(e,function(e,t){return e?console.error(e):(g.addItems(t.map),void g.setWeight(Object.keys(g.itemList).length))})}h.call(this,{className:"ExchangeStorageWindow",positionInfo:{left:"0.5%",bottom:"3%",width:"30%",height:"94%"}});var l,m,f,g=e;g.registerView(this,{rightArrow:!0});var _=this.minMaxSelector=window.gui.windowsContainer.appendChild(new d);_.on("confirm",function(e){"items"===m?t(e):window.dofus.sendMessage("ExchangeObjectMoveKamaMessage",{quantity:-e})});var v=this.windowBody.appendChild(new o({className:"greenButton",text:r("tablet.exchange.withdraw")}));v.addClassNames("withdrawButton"),v.on("tap",function(){var e=g.kamasValue;if(e){var t=p.getWindow("exchangeInventory");t.closeMinMaxSelector(),u.positionNextTo(_,v),m="kamas",_.open({min:1,max:e})}}),this.on("open",function(e){var t;switch(e.exchangeType){case a.TAXCOLLECTOR:t=r("ui.common.taxCollector");break;case a.STORAGE:g.setBarLabel(r("tablet.common.slots")+":"),t=r("ui.common.storage");break;case a.MOUNT:t=r("ui.common.ride");break;default:console.warn("Unexpected exchangeType value:",e.exchangeType),t=r("ui.common.storage")}this.setTitle(t),this.windowBody.appendChild(v),v.setEnable(!!g.kamasValue),v.toggleDisplay(e.exchangeType!==a.MOUNT)}),this.on("close",function(){_.closeMinMax()}),this.on("kamasUpdated",function(e){v.isVisible()&&v.setEnable(!!e)}),this.on("rightArrow-tap",function(e){window.gui.openContextualMenu("storage",{toInventory:!0,viewer:g},{x:e.x,y:e.y})}),this.on("slot-doubletap",i),s(this,["exchangeInventory"]),this.on("drop",function(e,t,n){i(e,n.x,n.y,!0)});var y=window.gui;y.on("ExchangeStartedWithStorageMessage",function(e){g.setMaxWeight(e.storageMaxSlot),p.openDialog(["exchangeInventory","exchangeStorage"],e)}),y.on("ExchangeStartedMountStockMessage",function(e){p.openDialog(["exchangeInventory","exchangeStorage"],{exchangeType:a.MOUNT}),c.createItemInstances(e.objectsInfos,function(e,t){return e?console.error(e):void g.setItemList(t.map)})}),y.on("ExchangeStartedMessage",function(e){e.exchangeType===a.TAXCOLLECTOR&&p.openDialog(["exchangeInventory","exchangeStorage"],e)}),y.on("StorageInventoryContentMessage",function(e){g.setKamas(e.kamas),g.setWeight(e.objects.length),c.createItemInstances(e.objects,function(e,t){return e?console.error(e):void g.setItemList(t.map)})}),y.on("StorageKamasUpdateMessage",function(e){g.setKamas(e.kamasTotal)}),y.on("ExchangeWeightMessage",function(e){g.setWeight(e.currentWeight,e.maxWeight)}),y.on("StorageObjectUpdateMessage",function(e){n([e.object])}),y.on("StorageObjectsUpdateMessage",function(e){n(e.objectList)}),y.on("StorageObjectRemoveMessage",function(e){g.removeItem(e.objectUID),g.setWeight(g.weight-1)}),y.on("StorageObjectsRemoveMessage",function(e){g.removeItems(e.objectUIDList),g.setWeight(g.weight-e.objectUIDList.length)})}i(980);var o=i(335),s=i(317).setDroppable,a=i(578),r=i(29).getText,l=i(172).inherits,c=i(461),d=i(332),u=i(334),h=i(541),p=i(194);l(n,h),e.exports=n,n.prototype.closeMinMaxSelector=function(){this.minMaxSelector.closeMinMax()}},function(e,t){},function(e,t,i){function n(){g.call(this,{className:"tradeItemWindow",noCloseButton:!0,fixed:!0,positionInfo:{width:b,height:M}}),this._setupEvents(),this.mode="",this.item=null,this.msg=null,this.itemDescription=null,this.settingBox=null,this.selection=null,this.tradeItemConfirm=null,this.isTradePending=!1,this.tradeTimeout=null,this.on("open",function(e){switch(this.tradeItemConfirm=null,this.isTradePending=!1,this.tradeTimeout=null,this.itemDescription||this._createDom(),this.buyHardSoftDiv.hide(),this.msg._messageType){case"ExchangeStartOkNpcShopMessage":case"ExchangeStartOkHumanVendorMessage":case"ExchangeShopStockStartedMessage":this.settingBox=this.exchangeBox,"buy-human"===e.mode&&this.buyHardSoftDiv.show(),_.arrangeOpeningWindow(this.id,{rightOf:"tradeStorage",height:M});break;case"ExchangeStartedBidSellerMessage":this.settingBox=this.bidHouseSellerBox,this.settingBox.setDescriptorData(this.msg.sellerDescriptor),_.arrangeOpeningWindow(this.id,{rightOf:"tradeStorage",height:w});break;case"ExchangeStartedBidBuyerMessage":this.settingBox=this.bidHouseBuyerBox,this.settingBox.setDescriptorData(this.msg.buyerDescriptor),this.buyHardSoftDiv.show(),_.arrangeOpeningWindow(this.id,{rightOf:"bidHouseShop",height:"100%"});break;default:return}this._setContent(e.mode,e.item,e.currency)}),this.on("close",function(){this.item=null,this.selection=null,this.isTradePending=!1,window.clearTimeout(this.tradeTimeout),this._closeTradeConfirmWindow()}),this.on("closed",function(){this.settingBox.hide()})}function o(e,t){return e?void m.getItems([e],function(i,n){return i?console.error("Failed to get token "+e+" for trade: "+i):t(n[0])}):t(null)}i(982);var s=i(983),a=i(984),r=i(335),l=i(202),c=i(986),d=i(29).getText,u=i(339),h=i(172).inherits,p=i(853),m=i(461),f=i(694),g=i(541),_=i(194),v=i(801),y=i(7),b=410,M=392,w=424,T=1e4;h(n,g),e.exports=n,n.minWidth=b,n.prototype._setupEvents=function(){var e=this,t=window.gui;l.on("ExchangeStartOkNpcShopMessage",function(t){e.msg=t,o(t.tokenId,function(e){e&&(t.token=e),_.openDialog(["tradeInventory","tradeStorage"],t)})}),l.on("ExchangeStartOkHumanVendorMessage",function(t){e.msg=t,_.openDialog(["wallet","tradeStorage"],t)}),l.on("ExchangeShopStockStartedMessage",function(t){e.msg=t,_.openDialog(["tradeInventory","tradeStorage","tradeMode"],t)}),l.on("ExchangeStartedBidSellerMessage",function(t){e.msg=t,_.openDialog(["tradeInventory","tradeStorage"],t)}),l.on("ExchangeStartedBidBuyerMessage",function(t){e.msg=t,_.openDialog(["wallet","bidHouseShop"],t)});var i={1:d("ui.exchange.cantExchange"),2:d("ui.exchange.cantExchangeCharacterOccupied"),3:d("ui.exchange.cantExchangeCharacterJobNotEquiped"),4:d("ui.craft.notNearCraftTable"),5:d("ui.exchange.cantExchangeCharacterOverloaded"),6:d("ui.exchange.cantExchangeCharacterNotSuscriber"),7:d("ui.exchange.cantExchangeCharacterRestricted"),8:d("ui.exchange.cantExchangeBuyError"),9:d("ui.exchange.cantExchangeSellError"),10:d("ui.exchange.cantExchangeMountPaddockError"),11:d("ui.bidhouse.itemNotInBigStore")};l.on("ExchangeErrorMessage",function(n){var o=i[n.errorType];e._concludeTrade(!1,o)||t.openSimplePopup(o)}),l.on("ObjectErrorMessage",function(t){t.reason===f.INVENTORY_FULL&&e._concludeTrade(!1)}),l.on("exchangeBidHouseBuyError",function(){e._concludeTrade(!1,d("tablet.purchaseInHardCcyError"))}),l.on("exchangeHumanBuyError",function(){e._concludeTrade(!1,d("tablet.purchaseInHardCcyError"))}),l.on("exchangeBidHouseBuySuccess",function(){this.send("moneyGoultinesAmountRequest")}),l.on("exchangeHumanBuySuccess",function(){this.send("moneyGoultinesAmountRequest")}),l.on("ExchangeBidHouseBuyResultMessage",function(t){e._concludeTrade(t.bought,d("tablet.tradeItemFailed")),e._sendKpi(t)}),l.on("ExchangeBuyOkMessage",function(){e._concludeTrade(!0),_.close(e.id)}),l.on("ExchangeSellOkMessage",function(){e._concludeTrade(!0),_.close(e.id)}),l.on("ExchangeBidHouseItemAddOkMessage",function(){e._concludeTrade(!0)})},n.prototype._beginTrade=function(){this.isTradePending=!0,this.tradeTimeout=window.setTimeout(function(e){e._tradeTimedOut()},T,this)},n.prototype._concludeTrade=function(e,t){return!!this.tradeTimeout&&(this.isTradePending=!1,window.clearTimeout(this.tradeTimeout),this.tradeTimeout=null,this._closeTradeConfirmWindow(),!e&&t&&window.gui.openSimplePopup(t),!0)},n.prototype._tradeTimedOut=function(){this._concludeTrade(!1,d("tablet.tradeItemTimeout"))},n.prototype.getCurrentItem=function(){return this.selection?this.selection.item:this.item},n.prototype.updateSelection=function(e){if(e){var t=window.gui.playerData.inventory;this.buySoftBtn.setEnable(t.kamas>=e.amountSoft),this.buySoftBtnLabel.setText(u.intToString(e.amountSoft)),this.buyHardBtn.setEnable(!!e.amountHard),this.buyHardBtnLabel.setText(e.amountHard?u.intToString(e.amountHard):""),e.item!==this.itemDescription.item&&this.itemDescription.displayItem(e.item)}else{this.buySoftBtn.disable(),this.buyHardBtn.disable();var i=d("ui.common.buy");this.buySoftBtnLabel.setText(i),this.buyHardBtnLabel.setText(i),this._closeTradeConfirmWindow()}this.selection=e},n.prototype.updateHumanBuyQuantityRealtime=function(e){if(!(this.isTradePending||e>=this.selection.qty)){var t=this.selection.item;window.gui.chat.logMsg(d("tablet.tradeItemQtyChanged",t.getName(),e)),e?(t.quantity=e,this.settingBox.updateSettingBox(this,t),this._closeTradeConfirmWindow()):_.close(this.id)}},n.prototype.updateBidHouseBuyPriceRealtime=function(e,t){if(this.tradeItemConfirm&&!this.isTradePending){var i=this.isHardCcyTrade?t:e;if(i>this.initialPrice)return this._closeTradeConfirmWindow();this.currentPrice=i,this.tradeItemConfirm.updatePriceRealtime(i)}},n.prototype._confirmTrade=function(e,t){this.isHardCcyTrade=!!e.amountHard,this.initialPrice=this.currentPrice=e.amountHard||e.amountSoft,this.tradeItemConfirm=_.getWindow("tradeItemConfirm");var i=this;this.tradeItemConfirm.confirmTrade(e,function(e){e&&(i._beginTrade(),t())})},n.prototype._closeTradeConfirmWindow=function(){this.tradeItemConfirm&&(this.tradeItemConfirm=null,_.close("tradeItemConfirm"))},n.prototype._buyInGoultines=function(){var e=this,t=this.selection,i=t.item,n=t.amountHard,o=t.amountSoft,s=t.qty,a="buy-human"===this.mode,r=n-window.gui.playerData.inventory.goultines;return r>0?v.openNotEnoughHardCurrencyPopup(r):void this._confirmTrade({itemInstance:i,amountHard:n,qty:s},function(){window.dofus.send(a?"exchangeHumanBuyRequest":"exchangeBidHouseBuyRequest",{id:i.getProperty("id"),uid:i.objectUID,qty:s,amountHard:n,amountSoft:o}),a||e._prepareKpi("ExchangeBidHouseBuyResultMessage")})},n.prototype._buyInKamas=function(){var e=this.selection,t=e.item,i=e.qty,n="buy-human"===this.mode,o=this;this._confirmTrade({itemInstance:t,amountSoft:e.amountSoft,qty:i},function(){n?window.dofus.sendMessage("ExchangeBuyMessage",{objectToBuyId:t.objectUID,quantity:i}):(window.dofus.sendMessage("ExchangeBidHouseBuyMessage",{uid:t.objectUID,qty:i,price:o.currentPrice}),o._prepareKpi("ExchangeBidHouseBuyResultMessage"))})},n.prototype.buyItemFromNpc=function(e,t,i){i=i||e.item.price,this._confirmTrade({itemInstance:e,amountSoft:i*t,qty:t,token:this.msg.token},function(){window.dofus.sendMessage("ExchangeBuyMessage",{objectToBuyId:e.item.id,quantity:t})})},n.prototype.sellItemToNpc=function(e,t,i){i=i||e.item.price,this._confirmTrade({isSell:!0,itemInstance:e,amountSoft:i*t,qty:t},function(){window.dofus.sendMessage("ExchangeSellMessage",{objectToSellId:e.objectUID,quantity:t})})},n.prototype.sellItemInMyShop=function(e,t,i){window.dofus.sendMessage("ExchangeObjectMovePricedMessage",{objectUID:e.objectUID,quantity:t,price:i})},n.prototype.removeItemQuantityFromMyShop=function(e,t){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e.objectUID,quantity:-t})},n.prototype.modifyItemPriceInMyShop=function(e,t,i){window.dofus.sendMessage("ExchangeObjectModifyPricedMessage",{objectUID:e.objectUID,quantity:t,price:i})},n.prototype.sellInBidHouse=function(e,t,i,n){return t<=0?window.gui.openSimplePopup(d("ui.error.invalidPrice")):void this._confirmTrade({isSell:!0,itemInstance:e,amountSoft:t,qty:i,fee:n},function(){window.dofus.sendMessage("ExchangeObjectMovePricedMessage",{objectUID:e.objectUID,quantity:i,price:t})})},n.prototype.removeFromBidHouse=function(e,t,i){window.gui.openConfirmPopup({title:d("ui.popup.warning"),message:d("ui.bidhouse.doUWithdrawItemBigStore",i+" x "+e.item.nameId,u.kamasToString(t/i)),cb:function(n){n&&window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e.objectUID,quantity:-i,price:t})}})},n.prototype._createDom=function(){this.itemDescription=this.windowBody.appendChild(new p({showTitle:!0,withCraftBtn:!0})),_.makeMovable(this,this.itemDescription.getChildren()[0]),this.exchangeBox=this.windowBody.appendChild(new c),this.bidHouseSellerBox=this.windowBody.appendChild(new s),this.bidHouseBuyerBox=this.windowBody.appendChild(new a),this._createBuyHardSoftButtons(),this.errorBox=this.windowBody.createChild("div",{className:"errorBox"}),this.errorText=this.errorBox.createChild("div",{className:"errorText"})},n.prototype._createBuyHardSoftButtons=function(){var e=this.buyHardSoftDiv=this.windowBody.createChild("div",{className:"buyHardSoftButtons"}),t=this;this.buyHardBtn=e.appendChild(new r({className:["button","buyHardBtn"],text:d("ui.common.buy"),addIcon:!0},function(){t._buyInGoultines()})),this.buyHardBtnLabel=this.buyHardBtn.getChildren()[0],this.buySoftBtn=e.appendChild(new r({className:["greenButton","buySoftBtn"],text:d("ui.common.buy"),addIcon:!0},function(){t._buyInKamas()})),this.buySoftBtnLabel=this.buySoftBtn.getChildren()[0]},n.prototype.displayItem=function(e,t,i){this.openState?this._setContent(e,t,i):_.open(this.id,{mode:e,item:t,currency:i})},n.prototype._setContent=function(e,t,i){if(e!==this.mode||t!==this.item){this.mode=e,this.item=t;var n=t.item||t,o=n.nameId+" ("+n.id+") "+d("ui.common.short.level")+" "+n.level;this.errorBox.hide(),this.setTitle(o),this.itemDescription.displayItem(t),this.settingBox.updateSettingBox(this,t,i),this.errorBox.isVisible()||this.settingBox.show()}},n.prototype.showError=function(e){this.errorText.setHtml(e),this.errorBox.show(),this.settingBox.hide()},n.prototype._prepareKpi=function(e){if("ExchangeBidHouseBuyResultMessage"===e){if(!this.selection||!this.selection.item)return console.error("TradeItemWindow._prepareKpi: this.selection is not valid");y.wKpi.bidHouseBuyPrepare({itemInstance:this.selection.item,quantity:this.selection.qty,isHardCurrency:this.isHardCcyTrade,spent:this.isHardCcyTrade?this.selection.amountHard:this.selection.amountSoft})}},n.prototype._sendKpi=function(e){"ExchangeBidHouseBuyResultMessage"===e._messageType&&e.bought&&y.wKpi.bidHouseBuySuccess()}},function(e,t){},function(e,t,i){function n(){p.call(this,"div",{className:"BidHouseSellerBox",hidden:!0}),this.tradeItemWindow=null,this.item={},this.mode=null,this.descriptor=null,this.quantity=0,this.price=0,this.fees=0,this._createDom(),this._setupEvents()}function o(e,t,i){m[e.objectGID+"x"+t]=i,f[e.objectGID]=t}function s(e,t){return m[e.objectGID+"x"+t]||0}var a=i(172).inherits,r=i(340),l=i(29).getText,c=i(335),d=i(339),u=i(461),h=i(532),p=i(321),m={},f={};a(n,p),e.exports=n,n.prototype.updateSettingBox=function(e,t){var i=this;this.tradeItemWindow=e;var n=this.mode=e.mode;switch(this.item=t,this._hideAll(),n){case"modify-bidHouse":this.priceLabel.setText(d.kamasToString(t.objectPrice)),this.priceLabel.show(),this.quantityLabel.setText(d.intToString(t.quantity)),this.quantityLabel.show(),this.quantity=t.quantity,this.removeBtn.show(),this.timeLeft.setText(t.unsoldDelay+" "+l("ui.common.hourShort")),this.timeLeftBox.show();break;case"sell-bidHouse":if(this.descriptor.types.indexOf(t.item.typeId)===-1)return e.showError(l("ui.bidhouse.badType"));if(t.isLinked())return e.showError(l("ui.bidhouse.badExchange"));if(t.item.level>this.descriptor.maxItemLevel)return e.showError(l("ui.bidhouse.badLevel"));this.sellBtn.show(),this.sellBtn.disable();var o=this.descriptor.quantities;this.quantitySelect.clearContent();for(var a=1,r=0,c=o.length;r<c;r+=1){var h=o[r];t.quantity>=h&&(this.quantitySelect.addOption(h,h),a=h)}var p=f[t.objectGID],m=p?Math.min(p,a):a;this.quantitySelect.select(m),this.quantitySelect.show();var g=s(t,m);this.priceInput.setValue(g),this.price=g,this.priceInput.show(),this._updateFees()}this.quantityBox.show(),this.averagePriceBox.show(),this.priceBox.show(),this._displayAveragePrice(t.item.averagePrice),u.getFreshAveragePrice(t.objectGID,function(e){i._displayAveragePrice(e)})},n.prototype._hideAll=function(){this.quantityBox.hide(),this.averagePriceBox.hide(),this.quantitySelect.hide(),
this.quantityLabel.hide(),this.priceBox.hide(),this.priceLabel.hide(),this.priceInput.hide(),this.timeLeftBox.hide(),this.saleFeeBox.hide(),this.sellBtn.hide(),this.removeBtn.hide()},n.prototype.setDescriptorData=function(e){this.descriptor=e},n.prototype._displayAveragePrice=function(e){e===-1?this.averagePrice.setText(l("ui.item.averageprice.unavailable")):this.averagePrice.setText(d.kamasToString(e))},n.prototype._updateFees=function(){this.fees=Math.max(1,Math.round(this.descriptor.taxPercentage*(this.price-(this.item.objectPrice||0))/100)),this.saleFee.setText(d.kamasToString(this.fees)),this.saleFeeBox.show();var e=window.gui.playerData.inventory.kamas>=this.fees;this.saleFee.toggleClassName("red",!e),this.sellBtn.setEnable(e)},n.prototype._setupEvents=function(){window.gui.on("disconnect",function(){m={},f={}})},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"settingBox"}),i=this.quantityBox=t.createChild("div",{className:["setting","quantity"]});i.createChild("div",{className:"label",text:l("ui.common.quantity")+l("ui.common.colon")}),this.quantitySelect=i.appendChild(new h),this.quantitySelect.on("change",function(t){e.quantity=t,e.price=s(e.item,t),e.priceInput.setValue(e.price),e._updateFees()}),this.quantityLabel=i.createChild("div",{className:"value"});var n=this.priceBox=t.createChild("div",{className:["setting","batchPrice"]});n.createChild("div",{className:"label",text:l("ui.bidhouse.setPrice")+l("ui.common.colon")}),this.priceLabel=n.createChild("div",{className:"value"}),this.priceInput=n.appendChild(new r({title:l("ui.bidhouse.setPrice"),attr:{placeholder:l("tablet.price.placeHolder")}})),this.priceInput.on("change",function(t){e.price=t,e._updateFees()});var a=this.averagePriceBox=t.createChild("div",{className:["setting","averagePrice"]});a.createChild("div",{className:"label",text:l("ui.bidhouse.bigStoreAveragePrice")+l("ui.common.colon")}),this.averagePrice=a.createChild("div",{className:"value"});var d=this.saleFeeBox=t.createChild("div",{className:["setting","saleFee"]});d.createChild("div",{className:"label",text:l("ui.bidhouse.bigStoreTax")+l("ui.common.colon")}),this.saleFee=d.createChild("div",{className:["value","text"]});var u=this.timeLeftBox=t.createChild("div",{className:["setting","timeLeft"]});u.createChild("div",{className:"label",text:l("ui.bidhouse.bigStoreTime")+l("ui.common.colon")}),this.timeLeft=u.createChild("div",{className:"value"});var p=this.createChild("div",{className:"buttonBox"});this.sellBtn=p.appendChild(new c({className:"greenButton",text:l("ui.common.putOnSell")},function(){return 0===e.price?e.priceInput.promptForValue():(o(e.item,e.quantity,e.price),void e.tradeItemWindow.sellInBidHouse(e.item,e.price,e.quantity,e.fees))})),this.removeBtn=p.appendChild(new c({className:"greenButton",text:l("ui.common.remove")},function(){e.tradeItemWindow.removeFromBidHouse(e.item,e.item.objectPrice,e.quantity)}))}},function(e,t,i){function n(){M.call(this,"div",{className:"BidHouseBuyerBox",hidden:!0}),this._createDom(),this._setupEvents(),this.tradeItemWindow=null,this.item={},this.currentOffer=null,this.descriptor=null,this.table=null,this.actions=[],this.mountWindow=null,this.serverAveragePrice=-1,this.displayedUnitCount=0,this.displayedUnitPrice=0}function o(e,t){return t.myTable.bidHouseBuyerBox.isItemSearchable?e.item.shortName:null}function s(e){return e.amountHard=g.computeHardPrice(e.amountSoft),e.amountHard?p.intToString(e.amountHard):null}function a(e,t){return b.addTooltip(t,l),p.intToString(e.amountSoft)}function r(e,t){var i=this.id;switch(i){case"icon":var n=e.qty-t.qty;return 0!==n?n:e.unitPrice-t.unitPrice;case"shortName":return e.item.shortName.localeCompare(t.item.shortName);case"amountSoft":case"amountHard":var o=e.unitPrice-t.unitPrice;return 0!==o?o:e.qty-t.qty;default:return 0}}function l(){var e=this.myTable.bidHouseBuyerBox,t=this.rowContent,i=t.amountSoft/t.qty;i>=100?i=Math.round(i):i>=10&&(i=Math.round(10*i)/10);var n="",o=e._computeAveragePrice(),s=100*(i/o-1);s<=-1?(s<-99&&(s=-99),n=" -"+Math.round(-s)+"%"):s>=1&&(n=" +"+Math.round(s)+"%");var a=h("ui.bidhouse.bigStoreAveragePrice");return a=a[0].toLowerCase()+a.substr(1),h("tablet.unitPrice")+h("ui.common.colon")+p.intToString(i)+"\n("+a+n+")"}function c(e,t){var i=this.bidHouseBuyerBox;i.currentOffer=t,i.tradeItemWindow.updateSelection(t),i._showSpecialItemInfo(t.item)}function d(e){var t=this.bidHouseBuyerBox.searchedText;if(!t)return!0;var i=e.item;if(p.simplifyString(i.shortName).indexOf(t)!==-1)return!0;for(var n=i.effects,o=0;o<n.length;o++)if(p.simplifyString(n[o].description).indexOf(t)!==-1)return!0;return!1}i(985);var u=i(824),h=i(29).getText,p=i(339),m=i(172).inherits,f=i(461),g=i(713),_=i(548),v=i(544),y=i(539),b=i(337),M=i(321),w=i(194),T=2,C=.5,A=0,I=1,S=2,E=3,x=500,N=30,L=300,O=100;m(n,M),e.exports=n,n.prototype.updateSettingBox=function(e,t){var i=this;this.tradeItemWindow=e,this.item=t,e.updateSelection(null),window.dofus.sendMessage("ExchangeBidHouseListMessage",{id:t.id}),this._setAveragePrice(t.averagePrice),f.getFreshAveragePrice(t.id,function(e){i._setAveragePrice(e)}),this.displayedUnitCount=0,this.displayedUnitPrice=0,this.pendingItemGid=null,this.expectedItems=null,window.clearTimeout(this.chunkLoadTimeout),this.searchedText="",this.searchBox.clear(),this.table.clearContent(),this.addClassNames("spinner")},n.prototype._updateOffer=function(e,t){if(this.currentOffer&&e===this.currentOffer.id){if(t>this.currentOffer.amountSoft)return this.tradeItemWindow.updateSelection(null);this.table.selectRow(e,!0),this.tradeItemWindow.updateBidHouseBuyPriceRealtime(t,g.computeHardPrice(t))}},n.prototype._removeOffer=function(e){this.currentOffer&&e===this.currentOffer.id&&this.tradeItemWindow.updateSelection(null)},n.prototype._hideMountPreview=function(){this.mountWindow&&(this.mountWindow.close(),this.mountWindow=null)},n.prototype._showSpecialItemInfo=function(e){_.getMountInfoFromCertificate(e)?(this.mountWindow=w.getWindow("mount"),this.mountWindow.showCertificateMount(e)):this._hideMountPreview()},n.prototype.setDescriptorData=function(e){function t(e){var t=new M("div",{className:"icon"});return t.setStyle("backgroundImage",e.item.getProperty("image")),t.createChild("div",{className:"quantity",text:"x "+e.qty}),t}this.descriptor=e;var i=new M("div",{className:["currencyIcon","soft"]}),n=new M("div",{className:["currencyIcon","hard"]}),l=[{id:"icon",format:t,sort:r},{id:"shortName",header:h("ui.common.name"),format:o,sort:r},{id:"amountHard",header:n,format:s,sort:r},{id:"amountSoft",header:i,format:a,sort:r,defaultSorter:!0,order:"descending"}];this.item=null,this.expectedItems=null,this.itemCache={monstersCache:{}},this.tableBox.clearContent(),this.table=this.tableBox.appendChild(new y(l,"id")),this.table.bidHouseBuyerBox=this,this.table.on("rowTap",c),this.table.addFilter(d)},n.prototype._onHide=function(){this._hideMountPreview(),window.clearTimeout(this.chunkLoadTimeout),window.clearTimeout(this.actionTimeout),this.actionTimeout=null,this.actions=[],this.itemCache=null},n.prototype._setupEvents=function(){var e=this,t=window.dofus.connectionManager;this.on("hide",this._onHide),t.on("ExchangeErrorMessage",function(t){t.errorType===u.BID_SEARCH_ERROR&&e.delClassNames("spinner")}),t.on("ExchangeBidHouseInListUpdatedMessage",function(t){var i={objectUID:t.itemUID,objectGID:t.objGenericId,prices:t.prices,effects:t.effects,quantity:1};e._queueAction({type:S,GID:t.objGenericId,rawItem:i})}),t.on("ExchangeBidHouseInListAddedMessage",function(t){var i={objectUID:t.itemUID,objectGID:t.objGenericId,prices:t.prices,effects:t.effects,quantity:1};e._queueAction({type:I,GID:t.objGenericId,rawItems:[i]})}),t.on("ExchangeTypesItemsExchangerDescriptionForUserMessage",function(t){e._loadItemList(t.itemTypeDescriptions)}),t.on("ExchangeBidHouseInListRemovedMessage",function(t){e._queueAction({type:E,GID:e.pendingItemGid,UID:t.itemUID})}),g.on("computedHardPricesChange",function(){e.table&&e.table.refreshRows()})},n.prototype._loadItemList=function(e){this.pendingItemGid=this.item.id,window.clearTimeout(this.chunkLoadTimeout),this.table.clearContent(),this._queueAction({type:A,GID:this.pendingItemGid,bidExchangerObjectInfos:e})},n.prototype._queueAction=function(e){this.actions.push(e),this.actionTimeout||this._processNextAction()},n.prototype._processNextAction=function(){for(var e;;){if(!this.actions.length)return;if(e=this.actions.shift(),e.GID===this.pendingItemGid)break}switch(e.type){case A:return this._addItemListChunk(this.pendingItemGid,e.bidExchangerObjectInfos,0);case I:return this._addItems(e.rawItems,I,this._scheduleNextAction.bind(this));case E:return this._removeItem(e.UID,E),this._scheduleNextAction();case S:return this._updateItem(e.rawItem,this._scheduleNextAction.bind(this));default:console.error("Invalid action: "+e.type)}},n.prototype._scheduleNextAction=function(){!this.actionTimeout&&this.actions.length&&(this.actionTimeout=window.setTimeout(function(e){e.actionTimeout=null,e._processNextAction()},O,this))},n.prototype._addItemListChunk=function(e,t,i){if(e===this.pendingItemGid){for(var n=0===i,o=Math.min(i+(n?N:x),t.length),s=[],a=i;a<o;a++){var r=t[a];s.push({objectUID:r.objectUID,objectGID:e,prices:r.prices,effects:r.effects,quantity:1})}this._addItems(s,n?A:I,this._nextItemListChunk.bind(this,e,t,o))}},n.prototype._nextItemListChunk=function(e,t,i){e===this.pendingItemGid&&(i!==t.length?(this.rowCount.show(),this.rowCount.setText(i+" / "+t.length),this.chunkLoadTimeout=window.setTimeout(function(n){n._addItemListChunk(e,t,i)},L,this)):(this.rowCount.hide(),this.delClassNames("spinner")))},n.prototype._adaptTableToItemType=function(e){this.isItemSearchable=e&&e.getRawName()!==e.shortName,this.isItemSearchable?(this.searchDiv.toggleDisplay(!0),this.rowCount.setText("..."),this.rowCount.show(),this.table.sortByColumnId("shortName","ascending"),this.table.delClassNames("noShortName")):(this.searchDiv.toggleDisplay(!1),this.table.resetSort(),this.table.addClassNames("noShortName"))},n.prototype._removeItem=function(e,t){for(var i=this.descriptor.quantities,n=0;n<i.length;n++){var o=e+"x"+i[n];this.table.delRow(o),t===E&&this._removeOffer(o)}},n.prototype._updateItem=function(e,t){this._removeItem(e.objectUID,S),this._addItems([e],S,t)},n.prototype._addItems=function(e,t,i){this.expectedItems=e;var n=this;f.createItemInstances(e,this.itemCache,function(o,s){if(o)return console.error(o),i&&i(o);if(e===n.expectedItems){n.expectedItems=null,t===A&&n._adaptTableToItemType(s.array[0]);var a=s.map,r=[];for(var l in a)n._separateItemBulks(a[l],r);if(n.table.addList(r),t===S)for(var c=0;c<r.length;c++){var d=r[c];n._updateOffer(d.id,d.amountSoft)}return n._updatePriceHighlighting(),i&&i()}})},n.prototype._separateItemBulks=function(e,t){for(var i=this.descriptor.quantities,n=0;n<i.length;n++){var o=e.prices[n];if(o){var s=i[n];t.push({id:e.getProperty("objectUID")+"x"+s,item:e,qty:s,amountSoft:o,unitPrice:o/s,amountHard:null}),this.displayedUnitCount+=s,this.displayedUnitPrice+=o}}},n.prototype._setAveragePrice=function(e){if(this.serverAveragePrice=e,e===-1)return this.averagePriceElement.setText(h("ui.item.averageprice.unavailable"));var t=g.computeHardPrice(e);this.averagePriceElement.setText(p.hardAndSoftToString(t,e))},n.prototype._createDom=function(){var e=this;this.searchDiv=this.createChild("div",{className:"searchDiv"}),this.searchBox=this.searchDiv.appendChild(new v({label:h("ui.common.search")+h("ui.common.colon")})),this.searchBox.on("search",function(t){e._search(t)}),this.rowCount=this.searchDiv.createChild("div",{className:"rowCount"}),this.tableBox=this.createChild("div",{className:"tableBox"});var t=this.createChild("div",{className:["setting","averagePrice"]});t.createChild("div",{className:"label",text:h("ui.bidhouse.bigStoreAveragePrice")+h("ui.common.colon")}),this.averagePriceElement=t.createChild("div",{className:"value"})},n.prototype._search=function(e){this.searchedText=p.simplifyString(e),this.addClassNames("spinner"),window.setTimeout(function(e){e.table.filter(),e.delClassNames("spinner")},0,this)},n.prototype._computeAveragePrice=function(){return this.serverAveragePrice!==-1?this.serverAveragePrice:this.displayedUnitPrice/this.displayedUnitCount},n.prototype._updatePriceHighlighting=function(){for(var e=this._computeAveragePrice(),t=this.table.rows.getChildren(),i=0;i<t.length;i++){var n=t[i],o=n.rowContent;n.toggleClassName("expensive",o.unitPrice>=e*T),n.toggleClassName("cheap",o.unitPrice<=e*C)}}},function(e,t){},function(e,t,i){function n(){d.call(this,"div",{className:"ExchangeBox",hidden:!0}),this._createDom(),this.mode=null,this.current={},this.tradeItemWindow=null,this.currency="",this.tokenItem=null}var o=i(172).inherits,s=i(340),a=i(29).getText,r=i(335),l=i(339),c=i(713),d=i(321),u=10;o(n,d),e.exports=n,n.prototype._createDom=function(){function e(){var e=t.current.quantity,i=t.current.unitPrice;t._updatePrices();var n=t.current.quantity!==e||t.current.unitPrice!==i;t.modifyButton.setEnable(n)}var t=this,i=this.createChild("div",{className:"settingBox"}),n=i.createChild("div",{className:"setting"});n.createChild("div",{className:"label",text:a("ui.common.quantity")+a("ui.common.colon")});var o=this.quantityValue=n.appendChild(new s({minValue:1,title:a("ui.common.quantity")}));o.on("focus",function(){o.maxValue=t._getMaxQuantity()}),o.on("change",e);var l=i.createChild("div",{className:"setting"});l.createChild("div",{className:"label",text:a("ui.common.unitPrice")+a("ui.common.colon")}),this.unitPriceInput=l.appendChild(new s({minValue:1,title:a("ui.common.unitPrice")})),this.unitPriceInput.on("change",e),this.unitPriceValue=l.createChild("div",{className:"value"});var c=this.totalPrice=i.createChild("div",{className:"setting"});c.createChild("div",{className:"label",text:a("ui.common.totalPrice")+a("ui.common.colon")}),this.totalPriceValue=c.createChild("div",{className:"value"});var d=this.createChild("div",{className:"buttonBox"});this.removeButton=d.appendChild(new r({text:a("ui.common.remove"),className:["greenButton","removeButton"]},function(){this.disable(),t._updatePrices();var e=t.current;t.tradeItemWindow.removeItemQuantityFromMyShop(e.item,e.quantity)})),this.modifyButton=d.appendChild(new r({text:a("ui.common.modify"),className:"greenButton"},function(){this.disable(),t._updatePrices();var e=t.current;t.tradeItemWindow.modifyItemPriceInMyShop(e.item,e.quantity,e.unitPrice)})),this.onSaleButton=d.appendChild(new r({text:a("ui.common.putOnSell"),className:"greenButton"},function(){var e=t.current;return 0===e.unitPrice?t.unitPriceInput.promptForValue():void t.tradeItemWindow.sellItemInMyShop(e.item,e.quantity,e.unitPrice)})),this.sellButton=d.appendChild(new r({text:a("ui.common.sell"),className:"greenButton"},function(){var e=t.current;t.tradeItemWindow.sellItemToNpc(e.item,e.quantity,e.unitPrice)})),this.buyButton=d.appendChild(new r({text:a("ui.common.buy"),className:"greenButton"},function(){var e=t.current;t.tradeItemWindow.buyItemFromNpc(e.item,e.quantity,e.unitPrice)}))},n.prototype._updatePrices=function(){var e="sell-myShop"===this.mode||"modify-myShop"===this.mode,t="buy-human"===this.mode,i=e?this.unitPriceInput.getValue():this.pricePerUnit,n=this.quantityValue.getValue();this.current.quantity=n,this.current.unitPrice=i;var o=n*i,s=null;if(this.totalPrice.toggleDisplay(!t),t?(s=c.computeHardPrice(o),this.totalPrice.hide(),this.tradeItemWindow.updateSelection({item:this.current.item,amountHard:s,amountSoft:o,qty:n})):(this.totalPrice.show(),this.currency?this.totalPriceValue.setText(this.currency+" x "+l.intToString(o)):this.totalPriceValue.setText(l.kamasToString(o))),this.buyButton.isVisible()){var a=window.gui.playerData.inventory,r=this.tokenItem?a.getGenericItemCount(this.tokenItem.id):a.kamas;o>r?(this.buyButton.disable(),this.totalPriceValue.addClassNames("red")):(this.buyButton.enable(),this.totalPriceValue.delClassNames("red"))}},n.prototype._getMaxQuantity=function(){var e=window.gui.playerData,t=this.current.item;return"modify-myShop"===this.mode?e.myShop.getItemSellableAmount(t.objectGID):t.quantity},n.prototype.updateSettingBox=function(e,t,i){this.tradeItemWindow=e,this.current.item=t;var n=this.mode=e.mode;this.tokenItem=e.msg.token,this.currency=i;var o=!1,s=!1;this.totalPriceValue.delClassNames("red"),this._hideButtons();var r,c=t.getProperty("quantity"),d=1;switch(n){case"modify-myShop":o=!0,this.removeButton.show(),this.removeButton.enable(),this.modifyButton.show(),this.modifyButton.disable(),r=t.getProperty("objectPrice"),d=c;break;case"sell-myShop":s=!0,o=!0,this.onSaleButton.show(),r=0,d=c;break;case"sell-npc":s=!0,this.sellButton.show();var h=t.getProperty("price");r=h>0?Math.max(1,Math.floor(h/u)):0;break;case"buy-npc":this.buyButton.show(),r=t.getProperty("objectPrice")||t.getProperty("price");break;case"buy-human":r=t.getProperty("objectPrice");break;default:throw new Error("Invalid exchange mode: "+n)}return s&&t.isLinked()?e.showError(a("ui.bidhouse.badExchange")):(this.pricePerUnit=r,this.quantityValue.setValue(d),this.quantityValue.setReadonly(1===c),o?this.unitPriceInput.setValue(r):this.unitPriceValue.setText(i?i+" x "+l.intToString(r):l.kamasToString(r)),this.unitPriceInput.toggleDisplay(o),this.unitPriceValue.toggleDisplay(!o),void this._updatePrices())},n.prototype._hideButtons=function(){this.removeButton.hide(),this.modifyButton.hide(),this.onSaleButton.hide(),this.sellButton.hide(),this.buyButton.hide()}},function(e,t,i){function n(){l.call(this,{title:s("ui.common.confirm"),className:"TradeItemConfirmWindow",positionInfo:{left:"c",top:"c",width:350,height:300,isModal:!0}}),this._reset(),this.on("open",this._onOpen),this.on("close",this._onClose)}i(988);var o=i(335),s=i(29).getText,a=i(339),r=i(172).inherits,l=i(541),c=i(194),d=i(321);r(n,l),e.exports=n,n.prototype._reset=function(){this.cb=null,this.itemLabel=null,this.itemImg=null,this.itemQuantity=null,this.buyBtn=null,this.buyBtnLabel=null},n.prototype._onOpen=function(){this.itemLabel||this._createContent()},n.prototype._onClose=function(){this.cb(!1)},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._createContent=function(){var e=this.windowBody.createChild("div",{className:"itemLabelBox"}),t=this.windowBody.createChild("div",{className:"twoColumns"});this.itemLabel=e.createChild("div",{className:"itemLabel"});var i=t.createChild("div",{className:"leftCol"}),n=i.createChild("div",{className:"itemContainer"});this.itemImg=n.createChild("div",{className:"itemImg"}),this.itemQuantity=n.createChild("div",{className:"itemQuantity"});var s=t.createChild("div",{className:"rightCol"}),a=this,r=s.createChild("div",{className:"btnAndFee"});this.buyBtn=r.appendChild(new o({addIcon:!0,className:["buyBtn","greenButton"]},function(){this.disable(),a.cb(!0)}));var l=this.buyBtnIcon=this.buyBtn.getChildren()[0];this.buyBtnLabel=this.buyBtn.insertChildBefore(new d("div",{className:"btnLabel"}),l),this.buyBtnAmount=this.buyBtn.insertChildBefore(new d("div",{className:"btnAmount"}),l),this.feeAmount=r.createChild("div",{className:"feeAmount"})},n.prototype.confirmTrade=function(e,t){c.open(this.id);var i=e.itemInstance;this.itemLabel.setText(i.getName()),this.itemImg.setStyle("backgroundImage",i.getProperty("image")),this.itemQuantity.setText("x"+e.qty),this.buyBtnLabel.setText(s(e.isSell?"ui.common.sell":"ui.common.buy").toUpperCase()),this.buyBtnAmount.setText(a.intToString(e.amountHard||e.amountSoft)),this.buyBtn.toggleClassName("hardCcy",!!e.amountHard),this.buyBtn.toggleClassName("softCcy",!e.amountHard);var n=e.token?e.token.getProperty("image"):null;this.buyBtnIcon.setStyle("backgroundImage",n),this.feeAmount.setText(e.fee?s("tablet.salesFee")+s("ui.common.colon")+a.kamasToString(e.fee):""),this.cb=t},n.prototype.updatePriceRealtime=function(e){this.buyBtnAmount.setText(a.intToString(e))}},function(e,t){},function(e,t,i){function n(){r.call(this,{className:"TradeModeWindow",noCloseButton:!0,noTitle:!0});var e;this.once("open",function(){e=this.windowBody.appendChild(new d({className:"greenButton",text:c("ui.humanVendor.switchToMerchantMode")})),e.on("tap",function(){window.dofus.sendMessage("ExchangeShowVendorTaxMessage")})}),this.on("open",function(e){switch(e._messageType){case"ExchangeShopStockStartedMessage":var t=a.minWidth-h,i=o.minWidth+h/2;l.positionWindow(this.id,{left:i,bottom:"5%",width:t,height:70});break;default:throw new Error("Invalid open msg: "+e._messageType)}}),window.gui.on("ExchangeReplyTaxVendorMessage",function(e){return window.gui.openConfirmPopup({title:c("ui.humanVendor.poupTitleTaxMessage"),message:c("ui.humanVendor.taxPriceMessage",u.kamasToString(e.totalTaxValue)),cb:function(e){e&&(l.close("tradeStorage"),window.dofus.sendMessage("ExchangeStartAsVendorMessage"),window.gui.connectionGonnaBeClosed("SWITCHING_TO_HUMAN_VENDOR"))}})})}i(990);var o=i(448),s=i(172).inherits,a=i(981),r=i(541),l=i(194),c=i(29).getText,d=i(335),u=i(339),h=20;s(n,r),e.exports=n},function(e,t){},function(e,t,i){function n(e){function t(e){return m.types.indexOf(e.item.typeId)!==-1&&(!e.isLinked()&&!(e.item.level>m.maxItemLevel))}function i(i){i!==f&&(f=i,i?e.addFilters([t]):e.removeFilter(t),e.filterList())}function n(e){r._selectItem(e)}c.call(this,{title:u("ui.common.inventory"),className:"TradeInventoryWindow"});var r=this;this.mode=null,this.openOnItem=null,this.storageView=e,e.registerView(this);var m,f=!1,g=new s(u("ui.bidhouse.bigStoreFilter"));g.on("change",function(e){i(e)}),this.on("open",function(t){var n=this.mode=h[t._messageType],s=a.windowFullScreenWidth-o.minWidth-l.minWidth;s=Math.max(s,p),d.positionWindow(this.id,{right:0,top:0,width:s,height:"100%"}),"sell-bidHouse"===n&&(e.storageUI.appendChild(g),m=t.sellerDescriptor||t.buyerDescriptor,i(!0),g.activate(!0),this.openOnItem&&this.navigateToItem(this.openOnItem)),t.token&&(e.filter.toggleCategoryDisplay(t.token.type.category,!0),e.filter.selectCategory(t.token.type.category))}),this.on("closed",function(){"sell-bidHouse"===this.mode&&(e.storageUI.removeChild(g),i(!1))}),this.on("slot-tap",function(e){this.mode&&d.getWindow("tradeItem").displayItem(this.mode,e.itemInstance)}),this.on("itemAdded",n),this.on("itemQuantity",n),this.on("itemRemoved",function(e){var t=d.getWindow("tradeItem"),i=t.getCurrentItem();i&&e===i.getProperty("objectUID")&&d.close("tradeItem")})}i(992);var o=i(448),s=i(612),a=i(166).dimensions,r=i(172).inherits,l=i(981),c=i(541),d=i(194),u=i(29).getText,h={ExchangeStartOkNpcShopMessage:"sell-npc",ExchangeShopStockStartedMessage:"sell-myShop",ExchangeStartedBidSellerMessage:"sell-bidHouse"},p=198;r(n,c),e.exports=n,n.prototype.isMyShopOpen=function(){return this.openState&&"sell-myShop"===this.mode},n.prototype.navigateToItem=function(e){this.openOnItem=null;var t,i;return"number"==typeof e?t=e:(t=e.getProperty("id"),i=e.getItemInstance()),!(!i||!this._selectItem(i,!0))||!!(i=this.storageView.selectAndShowSlotByGID(t))&&(this._selectItem(i,!0),!0)},n.prototype._selectItem=function(e,t){return!(!this.mode||"sell-myShop"===this.mode)&&(!!this.storageView.selectAndShowSlotByUID(e.objectUID)&&(t&&d.getWindow("tradeStorage").setFilter(e.getProperty("typeId")),d.getWindow("tradeItem").displayItem(this.mode,e),!0))}},function(e,t){},function(e,t,i){function n(){h.call(this,{className:"TradeStorageWindow",positionInfo:g}),this.openOnItem=null,this.mode=null,this.currentItem=null,this.on("open",this._onOpen),this.on("closed",this._onClose)}i(994);var o=i(448),s=i(335),a=i(29).getText,r=i(339),l=i(172).inherits,c=i(461),d=i(526),u=i(337),h=i(541),p=i(194),m=i(321),f={ExchangeStartOkNpcShopMessage:"buy-npc",ExchangeShopStockStartedMessage:"modify-myShop",ExchangeStartedBidSellerMessage:"modify-bidHouse",ExchangeStartOkHumanVendorMessage:"buy-human"},g={left:0,top:0,width:300,height:"100%"};l(n,h),e.exports=n,n.prototype.navigateToItem=function(e){this.openOnItem=null;var t,i;"number"==typeof e?t=e:(t=e.getProperty("id"),i=e.getItemInstance());var n=p.getWindow("tradeInventory");if(!(n.navigateToItem(e)||i&&this._selectItemByUID(i.objectUID,!0))){var o=this.shopViewer.findItemByGID(t);o&&this._selectItemByUID(o,!0)}},n.prototype._onOpen=function(e){if(this.mode=f[e._messageType],!this.mode)return console.error(new Error("Unexpected msg type for TradeStorageWindow: "+e._messageType));this.shopViewer||(this._createContent(),this._setupEventListeners());var t=this,i=!1,n=!1;switch(this.mode){case"buy-npc":this.setTitle(a("ui.common.shop")),this.shopViewer.table.setSlideEnable(!1);break;case"modify-myShop":this.setTitle(a("ui.common.shop")),this.shopViewer.table.setSlideEnable(!0),this._slideBack.modify.show(),this._slideBack.remove.hide();break;case"modify-bidHouse":this.setTitle(a("ui.common.shopStock"));var o=this.descriptor=e.sellerDescriptor;this.npcId=o.npcContextualId,i=!0,this.infoContent.setHtml(this._getBidHouseInfoHtml(o)),this._updateItemCount(e.objectsInfos.length),this.switchToBuyModeBtn.enable(),this.shopViewer.table.setSlideEnable(!0),this._slideBack.modify.hide(),this._slideBack.remove.show();break;case"buy-human":n=!0,window.actorManager.getActorData(e.sellerId,function(e,i){return e?(console.error(e),t.setTitle("")):void t.setTitle(i.name)}),this.shopViewer.table.setSlideEnable(!1)}n?p.arrangeOpeningWindowVertically(this.id,{below:"wallet",fullHeight:!0}):p.positionWindow(this.id,g),this.headerRow.toggleDisplay(i),this.shopViewer.table.setContentLoading(!0),c.createItemInstances(e.objectsInfos,function(i,n){return i?console.error(i):(t.currency=e.tokenId,t.token=e.token||null,t.shopViewer.table.setContentLoading(!1),t.shopViewer.setItemList(n.array),void(t.openOnItem&&t.navigateToItem(t.openOnItem)))}),this.lastOpenMode!==this.mode&&(this.lasOpenMode&&this.delClassNames(this.lasOpenMode),this.addClassNames(this.mode)),this.lasOpenMode=this.mode},n.prototype._onClose=function(){this.currentItem=null,this.shopViewer.clearContent(),p.close("tradeItem")},n.prototype._createContent=function(){this._createHeader(),this._createViewer()},n.prototype._createHeader=function(){var e=this.headerRow=this.windowBody.createChild("div",{className:"headerRow"});this.itemCountElt=e.createChild("div",{className:"itemCount"}),this.itemCountTooltip=new m("div"),u.addTooltip(this.itemCountElt,this.itemCountTooltip),this._createInfoButton(),this._createSwitchToBuyModeButton()},n.prototype._updateItemCount=function(e){this.itemCount=e,this.itemCountElt.setText(e+"/"+this.descriptor.maxItemPerAccount),this.itemCountTooltip.setText(a("ui.bidhouse.quantityObjectSold",e,this.descriptor.maxItemPerAccount))},n.prototype._getBidHouseInfoHtml=function(e){var t=a("ui.common.colon"),i="";return e.maxItemLevel<1e3&&(i+=a("ui.common.maxLevel")+t+e.maxItemLevel+"<br/>"),i+a("ui.bidhouse.bigStoreTax")+t+e.taxPercentage+"%<br/>"+a("ui.bidhouse.bigStoreMaxSellTime")+t+e.unsoldDelay+" "+a("ui.time.hours",e.unsoldDelay)},n.prototype._createInfoButton=function(){var e=this.infoContent=new m("div"),t=this.headerRow.createChild("div",{className:"infoButton"});u.addTooltip(t,e,{openOnTap:!0})},n.prototype._createSwitchToBuyModeButton=function(){var e=this;this.switchToBuyModeBtn=this.headerRow.appendChild(new s({addIcon:!0,className:["buyModeBtn","greenButton"],tooltip:a("ui.bidhouse.bigStoreModeBuy")},function(){o.switchBuySellMode(!1,e.npcId),this.disable()}))},n.prototype._createViewer=function(){function e(e,t){return e.objectPrice-t.objectPrice}function t(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e.objectUID,quantity:-e.quantity})}var i=this,n=[{id:"icon",format:function(e){var t=new m("div",{className:"slot"}),i=t.createChild("div",{className:"icon"});return i.setStyle("backgroundImage",e.getProperty("image")),i.createChild("div",{className:"quantity",text:e.quantity>1?e.quantity:""}),t}},{id:"name",header:a("ui.common.name"),getContent:function(e){return e.item.nameId},sort:!0},{id:"price",header:a("ui.common.price"),format:function(e){var t;if(i.currency){t=new m("div",{className:"token"});var n=t.createChild("div",{className:"icon"});n.setStyle("backgroundImage",i.token.image),t.createChild("div",{className:"quantity",text:"x"+e.objectPrice})}else t=r.kamasToString(e.objectPrice);return t},sort:e,defaultSorter:!0}],o=this._slideBack=new m("div",{className:"slideBack"});o.modify=o.createChild("div",{className:"modify",text:a("ui.common.modify")}),o.remove=o.createChild("div",{className:"remove",text:a("ui.common.remove")}),o.createChild("div",{className:["remove","right"],text:a("ui.common.remove")}),this.shopViewer=this.windowBody.appendChild(new d(n,function(e){return e.hasOwnProperty("objectUID")?e.objectUID:e.hasOwnProperty("objectGID")?e.objectGID:0},{tableOption:{slidable:o}})),this.shopViewer.on("itemSelected",function(e){i._showCurrentItem(e)}),this.shopViewer.on("rowSlidedRight",function(e,i){t(i)}),this.shopViewer.on("rowSlidedLeft",function(e,n){"modify-myShop"===i.mode?(i._showCurrentItem(n),e.slideBack()):t(n)})},n.prototype._showCurrentItem=function(e){this.currentItem=e,p.getWindow("tradeItem").displayItem(this.mode,e,this.token&&this.token.nameId)},n.prototype._selectItemByUID=function(e,t){var i=this.shopViewer.getItem(e);return!!i&&(t&&this.setFilter(i.getProperty("typeId")),this.shopViewer.selectItem(e),this._showCurrentItem(i),!0)},n.prototype.setFilter=function(e){return this.shopViewer.selectFilter(e)},n.prototype._updateHumanBuyQuantity=function(e){var t=p.getWindow("tradeItem");t.updateHumanBuyQuantityRealtime(e),e||(this.currentItem=null)},n.prototype._setupEventListeners=function(){function e(e,t){if("buy-human"===n.mode&&n.currentItem)for(var i=n.currentItem.objectUID,o=0;o<e.length;o++)if(e[o].objectUID===i){n._updateHumanBuyQuantity(e[o].quantity);break}c.createItemInstances(e,function(e,i){return e?console.error(e):void(t?n.shopViewer.addItemsAndHighlightThem(i.array):n.shopViewer.addItems(i.array))})}function t(e){n.currentItem&&e.indexOf(n.currentItem.objectUID)>=0&&("buy-human"===n.mode?n._updateHumanBuyQuantity(0):"modify-bidHouse"!==n.mode&&"modify-myShop"!==n.mode||p.close("tradeItem"));for(var t=0;t<e.length;t++)n.shopViewer.table.endSlide(e[t]);n.shopViewer.removeItems(e)}var i=window.dofus.connectionManager,n=this;i.on("ExchangeShopStockMultiMovementUpdatedMessage",function(t){e(t.objectInfoList)}),i.on("ExchangeShopStockMovementUpdatedMessage",function(t){var i="modify-myShop"===n.mode;e([t.objectInfo],i)}),i.on("ExchangeShopStockMultiMovementRemovedMessage",function(e){t(e.objectIdList)}),i.on("ExchangeShopStockMovementRemovedMessage",function(e){t([e.objectId])}),i.on("ExchangeBidHouseItemAddOkMessage",function(t){e([t.itemInfo],!1),n._updateItemCount(n.itemCount+1)}),i.on("ExchangeBidHouseItemRemoveOkMessage",function(e){t([e.sellerId]),n._updateItemCount(n.itemCount-1)})}},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"WalletWindow",positionInfo:{left:0,top:0,width:r,height:l},noCloseButton:!0,noTitle:!0}),this.wallet=null,this.on("open",this._onOpen)}i(996);var o=i(172).inherits,s=i(997),a=i(541),r=300,l=62;o(n,a),e.exports=n,n.height=l,n.width=r,n.prototype._onOpen=function(){this.wallet||(this.wallet=this.windowBody.appendChild(new s({className:"small"})))}},function(e,t){},function(e,t,i){function n(e){e=e||{},c.call(this,"div",e),this.addClassNames("wallet"),this.goultineAmount=0,this.kamaAmount=0,this.emitTap=e.emitTap,this._createContent(),this._initialize()}function o(){var e=this.myWallet;return e.emitTap?e.emit("moreGoultinesTap"):void l.open("market",{tabId:"shop",tabParams:{category:"goultines"}})}i(998);var s=i(335),a=i(339),r=i(172).inherits,l=i(194),c=i(321);r(n,c),e.exports=n,n.prototype._initialize=function(){this._setupListeners();var e=window.gui.playerData.inventory;this._setSoftAmount(e.kamas),this._setHardAmount(e.goultines)},n.prototype._setHardAmount=function(e){this.goultineAmount=e,this.hardAmountElt.setText(a.intToString(e))},n.prototype._setSoftAmount=function(e){
this.kamaAmount=e,this.softAmountElt.setText(a.intToString(e))},n.prototype._createContent=function(){var e=this.createChild("div",{className:["currency","goultines"]});this.hardAmountElt=e.createChild("div",{className:"text"}),e.createChild("div",{className:"currencyIcon"}),this.goultinesBtn=e.appendChild(new s({className:"moreButton"},o)),this.goultinesBtn.myWallet=this;var t=this.createChild("div",{className:["currency","kamas"]});this.softAmountElt=t.createChild("div",{className:"text"}),t.createChild("div",{className:"currencyIcon"})},n.prototype._setupListeners=function(){function e(e){n._setHardAmount(e)}function t(e){n._setSoftAmount(e)}var i=window.gui.playerData.inventory,n=this;i.on("goultinesUpdated",e),i.on("kamasUpdated",t),this.on("destroy",function(){i.removeListener("goultinesUpdated",e),i.removeListener("kamasUpdated",t)})}},function(e,t){},function(e,t,i){function n(){d.call(this,{className:["WorldMapWindow","withoutLeftColumn"],plusButton:!0,minusButton:!0,positionInfo:{width:"w",height:"h",isDefault:!0},title:u("ui.cartography.title")}),this.status={isWorldMapRefreshing:!1,isLoading:!1,lastOpenCoord:{},lastWindowInfo:{x:null,y:null,w:null,h:null}},this._worldMap=null;var e={hidden:!0,className:"tree"};this._conquestUIList=new v(e),this._conquestPresenter=new g(new _,this._conquestUIList),this._taxCollectors=new b,this._poi=null,this._optionButtonsLoaded=!1,this._buttonBox=null,this._optionButtons=null,this._maxContentSize=null,this.minusButton.hide(),this.plusButton.hide(),this._isOpened=!1,this.once("open",function(e){this._addSpinner();var t={x:p.mapLeft,y:p.mapTop,width:Math.round(p.mapWidth/2),height:Math.round(p.mapHeight/2)};m.positionWindow(this.id,t),this.status.lastWindowInfo.x=this.position.x,this.status.lastWindowInfo.y=this.position.y,this.status.lastWindowInfo.w=this.position.width,this.status.lastWindowInfo.h=this.position.height;var i=this;this._createWorldMap(function(t){return t?(i._removeSpinner(),console.error(t)):(i._createDom(),i._setEvents(),i._poi=new c(i._worldMap),i.on("open",i._onOpen),void i._onOpen(e))})}),this.on("close",this._onClose),this._isConquestListDisplayed=!1,this._isMaximized=!1}function o(e,t){var i=w+e;return y.getValue(i,t)}function s(e,t){var i=w+e;y.setValue(i,t)}i(1e3);var a=i(337).addTooltip,r=i(172).inherits,l=i(1001),c=i(1016),d=i(541),u=i(29).getText,h=i(335),p=i(166).dimensions,m=i(194),f=i(622),g=i(1017),_=i(1020),v=i(897),y=i(176),b=i(1021),M=216,w="mapButtons-",T={temples:1,markets:2,workshops:3,miscellaneous:4,dungeons:6,possessions:7,lairs:9};r(n,d),e.exports=n,n.prototype._onClose=function(){this.status.isWorldMapRefreshing&&this._worldMap.stopRefreshing(),this._buttonBox&&this._buttonBox.addClassNames("hidden"),this._isOpened=!1},n.prototype._onOpen=function(e){var t=this,i=window.gui;this._cropWorldMapToWindow();var n={posX:i.playerData.position.coordinates.posX,posY:i.playerData.position.coordinates.posY};return e&&void 0!==e.x&&void 0!==e.y&&(n.posX=e.x,n.posY=e.y),this.status.lastOpenCoord=n,this._isOpened?void t._worldMap.centerToPosition(t.status.lastOpenCoord):void(this.status.isLoading||(this.status.isLoading=!0,this._addSpinner(),this._worldMap.initialize(n,function(){if(t.status.isWorldMapRefreshing=!0,t._removeSpinner(),t.status.isLoading=!1,t._isOpened=!0,!t.openState)return t._onClose();t._worldMap.centerToPosition(t.status.lastOpenCoord);var e=i.playerData.position.coordinates;t._worldMap.setIconPosition("userPosition",e.posX,e.posY),t._poi.update(),t._conquestPresenter.setWorldMap(t._worldMap),t._taxCollectors.setWorldMap(t._worldMap),t._optionButtonsLoaded?t._refreshOptionsButtonsSelections():(t._createOptionsButtons(),t._createConquestButton()),1===t._worldMap._worldMapId?t.conquestButton.show():t.conquestButton.hide()})))},n.prototype._addSpinner=function(){this.windowBodyWrapper.addClassNames("spinner")},n.prototype._removeSpinner=function(){this.windowBodyWrapper.delClassNames("spinner")},n.prototype._getMaxContentSize=function(){if(!this._maxContentSize){var e=this._getCurrentInnerBoundaries();this._maxContentSize={width:p.windowFullScreenWidth-(this.position.width-e.width),height:p.windowFullScreenHeight-(this.position.height-e.height)}}return this._maxContentSize},n.prototype._getCurrentInnerBoundaries=function(){var e=this.rightColumn.getComputedStyles("width","height");return{width:parseInt(e.width,10),height:parseInt(e.height,10)}},n.prototype._cropWorldMapToWindow=function(){var e=this._getMaxContentSize(),t=this._getCurrentInnerBoundaries();this._worldMap.crop((e.width-t.width)/2,(e.height-t.height)/2,t.width,t.height)},n.prototype._exitFullScreen=function(){this.setStyles({width:this.status.lastWindowInfo.w+"px",height:this.status.lastWindowInfo.h+"px",webkitTransform:"translate3d("+this.status.lastWindowInfo.x+"px,"+this.status.lastWindowInfo.y+"px,0)"}),this.position.x=this.status.lastWindowInfo.x,this.position.y=this.status.lastWindowInfo.y,this.position.width=this.status.lastWindowInfo.w,this.position.height=this.status.lastWindowInfo.h,this.emit("resize",!1)},n.prototype._setEvents=function(){var e=this,t=window.gui;t.playerData.position.on("mapUpdate",function(){if(e.openState){if(e._worldMap.isLoading()){var t=this.coordinates.posX,i=this.coordinates.posY;e._worldMap.once("loaded",function(){e._worldMap.setIconPosition("userPosition",t,i),e._worldMap.centerToMyPosition()})}else e._worldMap.setIconPosition("userPosition",this.coordinates.posX,this.coordinates.posY),e._worldMap.centerToMyPosition();e.status.isLoading&&(e.status.lastOpenCoord=this.coordinates)}}),this.on("repositioned",function(){e.emit("resize",!0)}),this.on("positioned",function(){e.status.lastWindowInfo.x=e.position.x,e.status.lastWindowInfo.y=e.position.y,e._updateMySize()}),t.playerData.position.on("worldMapUpdate",function(){e._onOpen(),e._poi.update()}),t.on("disconnect",function(){e._conquestPresenter.clear(),e._worldMap.clear(),e._resetOptionsButtons(),e.close()})},n.prototype._createWorldMap=function(e){this.leftColumn=this.createChild("div",{className:"leftColumn"}),this.rightColumn=this.createChild("div",{className:"rightColumn"}),this._worldMap=new l,this._leftColumScroll=this.leftColumn.createChild("div",{className:"scroll"}),this._leftColumScroll.appendChild(this._conquestUIList),this.rightColumn.appendChild(this._worldMap),this.windowBody.appendChild(this.leftColumn),this.windowBody.appendChild(this.rightColumn),this._worldMap.setupUI(this);var t=this._getMaxContentSize();this._worldMap.setDimensions(t.width,t.height),this._cropWorldMapToWindow(),this._worldMap.addClassNames("centerMap"),this._worldMap.preloadGenericAssets(e)},n.prototype._createOptionsButtons=function(){var e=this;this._optionButtons={},this._buttonBox=this.windowBody.createChild("div",{className:["buttonBox","hidden"]});var t=o("grid",!1);this._worldMap.setGridVisibility(t),this._buttonBox.appendChild(this._createToggleButton("grid",t,u("ui.option.displayGrid"),function(){e._worldMap.setGridVisibility(this.selected),s("grid",this.selected)}));var i=o("landmarks",!0);this._worldMap.setVisibilityOfIconType("customFlag",i),this._worldMap.setVisibilityOfIconType("userPosition",i),this._worldMap.setVisibilityOfIconType("questObjective",i),this._worldMap.setVisibilityOfIconType("hint",i),this._buttonBox.appendChild(this._createToggleButton("landmarks",i,u("ui.cartography.flags"),function(){e._worldMap.setVisibilityOfIconType("customFlag",this.selected),e._worldMap.setVisibilityOfIconType("userPosition",this.selected),e._worldMap.setVisibilityOfIconType("questObjective",this.selected),e._worldMap.setVisibilityOfIconType("hint",this.selected),s("landmarks",this.selected)}));var n=o(T.possessions,!0);this._worldMap.setVisibilityOfIconType(T.possessions,n),this._buttonBox.appendChild(this._createToggleButton("possessions",n,u("ui.common.possessions"),function(){e._setIconsVisibleAndSaveUserPref(T.possessions,this.selected)}));var r=o(T.temples,!0);this._worldMap.setVisibilityOfIconType(T.temples,r),this._buttonBox.appendChild(this._createToggleButton("temples",r,u("ui.map.temple"),function(){e._setIconsVisibleAndSaveUserPref(T.temples,this.selected)}));var l=o(T.markets,!0);this._worldMap.setVisibilityOfIconType(T.markets,l),this._buttonBox.appendChild(this._createToggleButton("markets",l,u("ui.map.bidHouse"),function(){e._setIconsVisibleAndSaveUserPref(T.markets,this.selected)}));var c=o(T.workshops,!0);this._worldMap.setVisibilityOfIconType(T.workshops,c),this._buttonBox.appendChild(this._createToggleButton("workshops",c,u("ui.map.craftHouse"),function(){e._setIconsVisibleAndSaveUserPref(T.workshops,this.selected)}));var d=o(T.miscellaneous,!0);this._worldMap.setVisibilityOfIconType(T.miscellaneous,d),this._buttonBox.appendChild(this._createToggleButton("miscellaneous",d,u("ui.common.misc"),function(){e._setIconsVisibleAndSaveUserPref(T.miscellaneous,this.selected)}));var p=o("prisms",!0);this._worldMap.setVisibilityOfIconType("prisms",p),this._buttonBox.appendChild(this._createToggleButton("conquests",p,u("ui.map.conquest"),function(){e._setIconsVisibleAndSaveUserPref("prisms",this.selected)}));var m=o(T.dungeons,!0);this._worldMap.setVisibilityOfIconType(T.dungeons,m),this._buttonBox.appendChild(this._createToggleButton("dungeons",m,u("ui.map.dungeon"),function(){e._setIconsVisibleAndSaveUserPref(T.dungeons,this.selected)}));var f=o(T.lairs,!0);this._worldMap.setVisibilityOfIconType(T.lairs,f),this._buttonBox.appendChild(this._createToggleButton("lairs",f,u("tablet.ui.map.lair"),function(){e._setIconsVisibleAndSaveUserPref(T.lairs,this.selected)})),this.optionButton=new h({className:"optionButton",scaleOnPress:!0},function(){e._buttonBox.toggleClassName("hidden")}),this.optionButton.insertBefore(this.windowTitle),this.centerButton=new h({className:"centerButton",scaleOnPress:!0},function(){e._worldMap.centerToMyPosition()}),a(this.centerButton,u("ui.map.player")),this.centerButton.insertBefore(this.windowTitle),e._optionButtonsLoaded=!0},n.prototype._createToggleButton=function(e,t,i,n){var o=new h({className:["mapBtn",e]},function(){o.selected=!o.selected,o.toggleClassName("selected",this.selected),n.call(this)});return t?(o.selected=!0,o.addClassNames("selected")):o.selected=!1,o.defaultSelected=t,this._optionButtons[e]=o,a(o,i),o},n.prototype._createConquestButton=function(){var e=this;this.conquestButton=new h({className:"conquestButton",text:u("ui.common.conquest")},function(){e._isConquestListDisplayed?(e._conquestPresenter.hideConquestList(),e._isConquestListDisplayed=!1,e.toggleClassName("withoutLeftColumn",!0)):(e._conquestPresenter.showConquestList(),e._isConquestListDisplayed=!0,e.toggleClassName("withoutLeftColumn",!1)),e.emit("resize",e._isMaximized)}),this.conquestButton.insertBefore(e.optionButton)},n.prototype._setIconsVisibleAndSaveUserPref=function(e,t){s(e,t),this._worldMap.setVisibilityOfIconType(e,t)},n.prototype._setIconsVisibleFromUserPref=function(e,t){var i=o(e,t);this._worldMap.setVisibilityOfIconType(e,i)},n.prototype._refreshOptionsButtonsSelections=function(){this._setIconsVisibleFromUserPref("grid",!1);var e=o("landmarks",!0);this._worldMap.setVisibilityOfIconType("customFlag",e),this._worldMap.setVisibilityOfIconType("userPosition",e),this._worldMap.setVisibilityOfIconType("questObjective",e),this._worldMap.setVisibilityOfIconType("hint",e),this._setIconsVisibleFromUserPref(T.possessions,!0),this._setIconsVisibleFromUserPref(T.temples,!0),this._setIconsVisibleFromUserPref(T.markets,!0),this._setIconsVisibleFromUserPref(T.workshops,!0),this._setIconsVisibleFromUserPref(T.miscellaneous,!0),this._setIconsVisibleFromUserPref("prisms",!0),this._setIconsVisibleFromUserPref(T.dungeons,!0),this._setIconsVisibleFromUserPref(T.lairs,!0)},n.prototype._createDom=function(){var e=this;f(this,{minWidth:M,minHeight:M}),this.on("resizeStart",function(){var t=e._getMaxContentSize();e._worldMap.crop(0,0,t.width,t.height)}),this.on("resize",function(t){e._cropWorldMapToWindow(),e._updateMySize(t)}),this.plusButton.on("tap",function(){m.positionWindow("worldMap")}),this.plusButton.show(),this.minusButton.on("tap",function(){e._exitFullScreen()})},n.prototype._updateMySize=function(e){if(this.plusButton.toggleDisplay(!e),this.minusButton.toggleDisplay(!!e),this._isMaximized=e,!e){var t=parseInt(this.getStyle("width"),10),i=parseInt(this.getStyle("height"),10);t>.9*p.windowFullScreenWidth&&i>.9*p.windowFullScreenHeight||(this.status.lastWindowInfo.w=t,this.status.lastWindowInfo.h=i)}},n.prototype._resetOptionsButtons=function(){for(var e in this._optionButtons){var t=this._optionButtons[e];t.selected=t.defaultSelected,t.toggleClassName("selected",t.selected)}},n.prototype.isMaximized=function(){return this._isMaximized}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"WorldMap"}),this.canvas=this.createChild("canvas",{className:["WorldMap","canvas"]}).rootElement,this._scene=new r({canvas:this.canvas,name:"worldMapScene",l:0,t:0,w:1,h:1,pixelRatio:l.PIXEL_RATIO,textureRatio:l.PRERENDER_RATIO_WORLDMAP,nbCacheableSprites:l.MAX_SPRITES_BUFFER_WORLDMAP,textureMemoryCacheSize:l.MAX_TEXTURE_MEMORY_WORLDMAP,prerenderQualityRatio:l.PRERENDER_RATIO_WORLDMAP}),this._nZonesHorizontally=0,this._nZonesVertically=0,this._worldMapWidth=1,this._worldMapHeight=1,this.cropPosition={x:0,y:0,width:1,height:1},this._topLeftZoneCoordinate=null,this._worldMapId=0,this._worldMapData=null,this._isLoadingWorldMapData=!1,this._zoomLevels=[],this._chunkSprites={},this._chunkBatchIndexes={},this._chunkBatchCurrent=0,this._fullMapSprite=null,this._subAreaSprites={},this._subAreaData={},this._subAreaIdPerCoordinate={},this._gridSprite=null,this._zoneHighlight=null,this.dimensions={width:0,height:0},this._iconsInfo={},this._iconsImage=null,this._iconBatchData=new I(this)}i(1002);var o=i(31),s=i(172).inherits,a=i(321),r=i(1003),l=i(167),c=i(673),d=i(1005),u=i(671),h=i(1006),p=i(672),m=i(384),f=i(424),g=i(30),_=i(392),v=i(1007),y=i(1008),b=i(1009),M=b.SUBAREA_COLOR,w=b.VIEW_MARGIN,T=b.CHUNK_WIDTH,C=b.CHUNK_HEIGHT,A=i(1010),I=i(1011),S=i(1015),E=i(1014),x=i(337).addTooltip,N=i(475),L=i(431),O=i(198).getPosition,D=i(339),R=i(419),P=i(197),B=i(567),k=_.Tween,z=_.easing,F=30;s(n,a),e.exports=n,n.prototype.preloadGenericAssets=function(e){var t=this;g.getAllDataMap(["SubAreaIdPerCoordinate","SubAreasWorldMapData","Hints"],function(i,n){return i?e(i):(t._subAreaIdPerCoordinate=n.SubAreaIdPerCoordinate,t._subAreaData=n.SubAreasWorldMapData,t._iconsInfo=n.Hints,void f.loadModel("icon","assets",function(i,n){var o=1;i.meta&&i.symbols&&(o=i.meta.scale/b.ICONS_ORIGINAL_EXPORT_SCALE,i=i.symbols),t._iconsImage=n;var s=t._scene.createTexture(n,"worldMapIcons","linear","permanent");t._iconBatchData.createIconModels(i,s,o),e()}))})},n.prototype.stopMovingWorldMap=function(){this._scene.camera.stopMoving(),this._loadChunksInView()},n.prototype.centerToPosition=function(e){if(this._worldMapData){var t=this._convertGridToSceneCoordinate(e.posX,e.posY);this._scene.camera.follow(t),this._loadChunksInView()}},n.prototype.centerToMyPosition=function(){if(this._worldMapData){var e=window.gui.playerData.position.coordinates;this.centerToPosition(e)}},n.prototype.setDimensions=function(e,t){this.dimensions.width=e,this.dimensions.height=t,this.cropPosition.width=e,this.cropPosition.height=t,this.setStyles({width:e+"px",height:t+"px"}),this.setCanvasDimensions(e,t)},n.prototype.initialize=function(e,t){var i=window.gui.playerData.position.worldmapId;if(this._worldMapId===i)return this._isLoadingWorldMapData?console.warn("[WorldMap.initialize]","Initialisation already launched"):this._display(),t();if(this._isLoadingWorldMapData)return console.warn("[WorldMap.initialize]","Initialisation of a world map of another id is already launched","Asked ",i,"Loading",this._worldMapId),t();null!==this._fullMapSprite&&(console.warn("[WorldMap.initialize]","Loading data for a new world map while previous map was not cleared.","Automatically clearing the previous world map."),this.clear()),this._worldMapId=i||1,this._isLoadingWorldMapData=!0;var n=this._worldMapData=window.gui.databases.WorldMaps[this._worldMapId];if(window.gui.playerData.position.worldmapId!==this._worldMapId)return this.initialize(e,t);this._worldMapData=n,3===this._worldMapId?(this._worldMapWidth=n.totalWidth/2,this._worldMapHeight=n.totalHeight/2):(this._worldMapWidth=n.totalWidth,this._worldMapHeight=n.totalHeight),this._zoneWidth=n.mapWidth,this._zoneHeight=n.mapHeight;var o=window.gui.playerData.position.coordinates,s=e.posX||o.posX,a=e.posY||o.posY,r=this._convertGridToSceneCoordinate(s,a),d=n.zoom,u=parseFloat(d[0]),h=parseFloat(d[1]);this._zoomLevels=[u];for(var p=2;p<d.length;p+=1){var f=parseFloat(d[p]);2*f<u?(this._zoomLevels.push(h),u=h,h=f):h=f}this._zoomLevels.push(h),this._scene.camera.setZoomMax(this._zoomLevels[0]),this._scene.setDimensions(0,0,this._worldMapWidth,this._worldMapHeight),this._scene.camera.setZoom(this._zoomLevels[0]),this._scene.camera.setPosition(r.x,r.y),this._topLeftZoneCoordinate=this.convertSceneToGridCoordinate(0,0);var g=this,_=l.WORLDMAP_PATH+this._worldMapId+"-full.jpg";m.loadTexture(_,function(e){g._fullMapSprite=new c({scene:g._scene,x:0,y:0,w:g._worldMapWidth,h:g._worldMapHeight,layer:-1},e),g._prepareGrid(),g._prepareIcons(),g._display(),g._isLoadingWorldMapData=!1,t(),g.emit("loaded")},this._scene.renderer,"linear")},n.prototype.isLoading=function(){return this._isLoadingWorldMapData},n.prototype._display=function(){this._loadChunksInView(),v.addScene(this._scene)},n.prototype._prepareGrid=function(){null!==this._gridSprite&&this._gridSprite.remove();var e=this._zoneWidth,t=this._zoneHeight,i=this._worldMapData.origineX%e,n=this._worldMapData.origineY%t,o=Math.floor((this._worldMapWidth-i)/e),s=Math.floor((this._worldMapHeight-n)/t);this._nZonesHorizontally=o,this._nZonesVertically=s;for(var a=o+1,r=s+1,c=a*e,u=r*t,p=[],m=0;m<a;m+=1){var f=m*e;p.push(new d(f,(-n),f,u-n))}for(var g=0;g<r;g+=1){var _=g*t;p.push(new d((-i),_,c-i,_))}this._gridSprite=new h({scene:this._scene,x:i,y:n,lines:p,alpha:0,lineWidth:1*l.PIXEL_RATIO,hue:[.85,.85,.85,.8],layer:2,id:"worldMapGrid"+this._worldMapId}),this._gridSprite.hide(),this._gridTween=new k(this._gridSprite,["alpha"]);var v=window.gui.playerData.position.coordinates,y=this._convertGridToSceneCoordinate(v.posX,v.posY),b=[{x0:-e/2,y0:-t/2,x1:-e/2,y1:-t/4},{x0:-e/2,y0:-t/2,x1:-e/4,y1:-t/2},{x0:e/2,y0:t/4,x1:e/2,y1:t/2},{x0:e/4,y0:t/2,x1:e/2,y1:t/2},{x0:e/2,y0:-t/4,x1:e/2,y1:-t/2},{x0:e/2,y0:-t/2,x1:e/4,y1:-t/2},{x0:-e/2,y0:t/4,x1:-e/2,y1:t/2},{x0:-e/4,y0:t/2,x1:-e/2,y1:t/2}];this._zoneHighlight=new h({scene:this._scene,x:y.x,y:y.y,w:e,h:t,lines:b,lineWidth:4*l.PIXEL_RATIO,hue:[.1,.1,.1,1],layer:3,id:"worldMapHighlight"+this._worldMapId}),this._zoneHighlight.hide(),this._zoneHighlightTween=new k(this._zoneHighlight,["x","y"])},n.prototype.setHighlightOn=function(e,t){if(!this._isLoadingWorldMapData){var i=this._convertGridToSceneCoordinate(e,t);this._zoneHighlight.isDisplayed?((this._zoneHighlightTween.starting||this._zoneHighlightTween.playing)&&this._zoneHighlightTween.stop(),this._zoneHighlightTween.reset().from({x:this._zoneHighlight.x,y:this._zoneHighlight.y}).to({x:i.x,y:i.y},16,z.polyOut,9).start()):(this._zoneHighlight.show(),this._zoneHighlight.x=i.x,this._zoneHighlight.y=i.y)}},n.prototype.hideHighlight=function(){this._zoneHighlight&&((this._zoneHighlightTween.starting||this._zoneHighlightTween.playing)&&this._zoneHighlightTween.stop(),this._zoneHighlight.hide())},n.prototype.setGridVisibility=function(e){if(this._gridTween){this._gridTween.playing&&this._gridTween.stop(),this._gridTween.removeOnFinish();var t=this._gridSprite.isDisplayed?this._gridSprite.alpha:0;if(e)this._gridSprite.show(),this._gridTween.reset().from({alpha:t}).to({alpha:1},4);else{this._gridTween.reset().from({alpha:t}).to({alpha:0},4);var i=this._gridSprite;this._gridTween.onFinish(function(){i.hide()})}this._gridTween.start()}},n.prototype.getSubAreaAtGridCoordinate=function(e,t){for(var i=this._convertGridCoordinateToCompressedCoordinate(e,t),n=this._subAreaIdPerCoordinate[this._worldMapId][i];void 0===n;)i-=1,n=this._subAreaIdPerCoordinate[this._worldMapId][i];if(null!==n)return this._subAreaData[n]},n.prototype.convertGridCoordinateToZoneId=function(e,t){return(t-this._topLeftZoneCoordinate.j)*this._nZonesHorizontally+(e-this._topLeftZoneCoordinate.i)},n.prototype.convertSceneToGridCoordinate=function(e,t){return{i:Math.floor((e-this._worldMapData.origineX)/this._zoneWidth),j:Math.floor((t-this._worldMapData.origineY)/this._zoneHeight)}},n.prototype.convertCanvasToGridCoordinate=function(e,t){var i=this._scene.convertCanvasToSceneCoordinate(e,t);return this.convertSceneToGridCoordinate(i.x,i.y)},n.prototype.convertGridToCanvasCoordinate=function(e,t){var i=this._convertGridToSceneCoordinate(e,t);return this._scene.convertSceneToCanvasCoordinate(i.x,i.y)},n.prototype.getSubAreaBounds=function(e){var t=this._subAreaData[e],i=t.gridPositions[this._worldMapId];if(!i)return null;for(var n=1/0,o=1/0,s=-(1/0),a=-(1/0),r=0;r<i.length;r+=2){var l=i[r],c=i[r+1];l<n&&(n=l),l>s&&(s=l),c<o&&(o=c),c>a&&(a=c)}var d=s-n,u=a-o;return{x:n,y:o,width:d,height:u}},n.prototype.addSubAreaHighlight=function(e,t){var i=this._subAreaData[e];if(void 0===i||null===i)return void console.warn("[WorldMap.setVisbilityOfSubArea] Trying to set visibility of undefined sub-area.");var n="subAreaOverlay"+e;if(null===this._subAreaSprites[e]||void 0===this._subAreaSprites[e]||this._subAreaSprites[e].id!==n){var o=[],s=1/0,a=1/0,r=-(1/0),l=-(1/0),c={},d=i.gridPositions[this._worldMapId];if(d){for(var h=0;h<d.length;h+=2){var m=d[h],f=d[h+1],g=m+":"+f;if(void 0===c[g]){c[g]=!0;var _=this._convertGridToSceneCoordinate(m,f),v=_.x-this._zoneWidth/2,y=_.y-this._zoneHeight/2;o.push(new u(v,y,v+this._zoneWidth,y,v+this._zoneWidth,y+this._zoneHeight,v,y+this._zoneHeight)),v<s&&(s=v),v>r&&(r=v),y<a&&(a=y),y>l&&(l=y)}}null!==this._subAreaSprites[e]&&void 0!==this._subAreaSprites[e]&&this._subAreaSprites[e].remove(),this._subAreaSprites[e]=new p({scene:this._scene,x:0,y:0,boxes:o,hue:t||M,layer:1,id:"subAreaOverlay"+e}),k(this._subAreaSprites[e],["alpha"]).from({alpha:.4}).to({alpha:1},15,z.polyOut,3).to({alpha:.4},15,z.polyIn,2).start(!0),k(this._subAreaSprites[e].highlight,["red","green","blue"]).from({red:.3,green:.3,blue:.3}).to({red:1,green:1,blue:1},15,z.polyOut,3).to({red:.3,green:.3,blue:.3},15,z.polyIn,2).start(!0)}}},n.prototype.removeSubAreaHighlight=function(e){if(null!==this._subAreaSprites[e]&&void 0!==this._subAreaSprites[e]){var t=this._subAreaSprites[e];delete this._subAreaSprites[e],k(t,["alpha"]).from({alpha:1}).to({alpha:0},5).start().onFinish(function(){t.remove()})}},n.prototype.clearSubAreaHighlights=function(e){for(var t in this._subAreaSprites)e!==Number(t)&&this.removeSubAreaHighlight(t)},n.prototype.move=function(e,t,i,n,o){this._scene.move(e,t,i,n,o),this._loadChunksInView()},n.prototype.addInertia=function(e,t){this._scene.camera.addInertia(e,t,.8),this._loadChunksInView()},n.prototype._getZoomLevel=function(e){for(var t,i=this._zoomLevels[0],n=1;n<this._zoomLevels.length&&(t=this._zoomLevels[n],!(e>=1.2*t));n+=1)i=t;return i},n.prototype._loadChunksInView=function(){function e(e,t){var i=W._chunkBatchIndexes[e.id];return i!==W._chunkBatchCurrent?(delete W._chunkBatchIndexes[e.id],t()):void m.loadTexture(e.path,function(i){var n=W._chunkBatchIndexes[e.id];return delete W._chunkBatchIndexes[e.id],n!==W._chunkBatchCurrent?(i.release(),t()):(e.texture=i,W._createChunkGraphic(e),void t())},W._scene.renderer,"linear")}var t=this._scene.camera.zoomTarget;if(void 0!==t){if(0===this._zoomLevels.length||1.5*t<=this._zoomLevels[this._zoomLevels.length-1])return void this._clearChunks();this._chunkBatchCurrent+=1;var i,n,s,a,r=this._getZoomLevel(t),c=this._scene.camera,d=c.followee.x-c.fovW/2*w;if(d<0)i=0,n=Math.min(c.fovW*w,this._worldMapWidth);else{var u=c.followee.x+c.fovW/2*w;u>this._worldMapWidth?(i=Math.max(this._worldMapWidth-c.fovW*w,0),n=this._worldMapWidth):(i=d,n=u)}var h=c.followee.y-c.fovH/2*w;if(h<0)s=0,a=Math.min(c.fovH*w,this._worldMapHeight);else{var p=c.followee.y+c.fovH/2*w;p>this._worldMapHeight?(s=Math.max(this._worldMapHeight-c.fovH*w,0),a=this._worldMapHeight):(s=h,a=p)}var f=this._convertSceneToChunkCoordinate(r,i,s),g=this._convertSceneToChunkCoordinate(r,n,a),_=f.k,v=g.k,b=f.l,M=g.l,A=[],I=r*this._worldMapWidth/T,S=r*this._worldMapHeight/C,E=Math.ceil(I),x=Math.ceil(S);v===I&&I===E&&(v-=1),M===S&&S===x&&(M-=1);var N,L,O,D=Object.keys(this._chunkSprites);for(O=0;O<D.length;O+=1)this._chunkSprites[D[O]].id=null;for(var R=b;R<=M;R+=1)for(var P=_;P<=v;P+=1)if(N=this._worldMapId+"-"+r+"-"+(R*E+P+1).toString(),L=this._chunkSprites[N],void 0===L)if(void 0===this._chunkBatchIndexes[N]){var B=l.WORLDMAP_PATH+N+".jpg",k=R-(b+M)/2,z=P-(_+v)/2,F=Math.sqrt(k*k+z*z),H=this._scene.holdTexture(N),q=new y(P,R,r,N,B,H,this._scene,F);void 0===H?(A.push(q),this._chunkBatchIndexes[N]=this._chunkBatchCurrent):this._createChunkGraphic(q)}else this._chunkBatchIndexes[N]=this._chunkBatchCurrent;else L.id=N;for(O=0;O<D.length;O+=1)N=D[O],L=this._chunkSprites[N],null===L.id&&(L.remove(),delete this._chunkSprites[N]);A.sort(function(e,t){return e.distToViewCenter-t.distToViewCenter});var W=this;o.eachLimit(A,5,e,function(e){e&&console.error("Chunk textures not loaded correctly",e)})}},n.prototype._createChunkGraphic=function(e){e.w*=e.texture.element.width/T,e.h*=e.texture.element.height/C,this._chunkSprites[e.id]=new c(e,e.texture)},n.prototype._clearChunks=function(){for(var e=Object.keys(this._chunkSprites),t=0;t<e.length;t+=1){var i=this._chunkSprites[e[t]];i.remove()}this._chunkSprites={}},n.prototype._convertGridCoordinateToCompressedCoordinate=function(e,t){return((e<0?32768|32767&e:32767&e)<<16)+(t<0?32768|32767&t:32767&t)},n.prototype._convertGridToSceneCoordinate=function(e,t){var i=this._worldMapData.origineX+e*this._zoneWidth+this._zoneWidth/2,n=this._worldMapData.origineY+t*this._zoneHeight+this._zoneHeight/2;return{x:i,y:n}},n.prototype._convertSceneToChunkCoordinate=function(e,t,i){var n=Math.floor(e*t/T),o=Math.floor(e*i/C);return{k:n,l:o}},n.prototype.setCanvasDimensions=function(e,t){this._scene.setCanvasDimensions(e,t),this._loadChunksInView()},n.prototype.stopRefreshing=function(){v.removeScene(this._scene)},n.prototype.crop=function(e,t,i,n){this.cropPosition.x=e,this.cropPosition.y=t,this.cropPosition.width=i,this.cropPosition.height=n,this._scene.crop(e,t,i,n),this._loadChunksInView()},n.prototype.resetCropping=function(){this.cropPosition.x=this.cropPosition.y=0,this.cropPosition.width=this.dimensions.width,this.cropPosition.height=this.dimensions.height,this._scene.resetCropping(),this._loadChunksInView()},n.prototype.clear=function(){this._scene.clean(),this._scene.clear(),this._worldMapId=0,this._fullMapSprite=null,this._chunkSprites={},this._zoomLevels=[],this._worldMapData=null,this._iconBatchData.clearIconBatch()},n.prototype._prepareIcons=function(){this._iconBatchData.reset(),this._iconBatchData.createIconsFromInfo(this._iconsInfo,this._worldMapId),this._iconBatchData.iconBatch=new S({id:"iconWorldMap_"+this._worldMapId,x:0,y:0,w:this._worldMapWidth,h:this._worldMapHeight,layer:4,scene:this._scene,iconsData:this._iconBatchData});var e=window.gui.playerData.position.coordinates,t=this._convertGridToSceneCoordinate(e.posX,e.posY),i="userPosition",n=new A(i,i,{color:[1,1.1,2,1],clusterId:i},this._iconBatchData.iconDimensions.myPosition),o=new E(i,t.x,t.y);this._iconBatchData.addCluster(o),o.add(n),n.cluster=o,this._iconBatchData.addIcon(n),this.emit("iconsPrepared")},n.prototype.hasIcon=function(e){return this._iconBatchData.hasIcon(e)},n.prototype.getIcon=function(e){return this._iconBatchData.getIcon(e)},n.prototype.addIcon=function(e,t){return this._iconBatchData.createIcon(e,t)},n.prototype.removeIcon=function(e){if(null===this._iconBatchData){var t=this;return void this.on("iconsPrepared",function(){t._iconBatchData.removeIcon(e)})}this._iconBatchData.removeIcon(e)},n.prototype.setVisibilityOfIconType=function(e,t){if(null===this._iconBatchData){var i=this;return void this.on("iconsPrepared",function(){i._iconBatchData.setVisibilityOfIconType(e,t)})}this._iconBatchData.setVisibilityOfIconType(e,t)},n.prototype.setIconPosition=function(e,t,i){if(null===this._iconBatchData){var n=this;return void this.on("iconsPrepared",function(){n._iconBatchData.setIconPosition(e,t,i)})}this._iconBatchData.setIconPosition(e,t,i)},n.prototype.convertZoneIdToGridCoordinate=function(e){var t=Math.floor(e/this._nZonesHorizontally),i=this._topLeftZoneCoordinate;return{i:e-t*this._nZonesHorizontally+i.i,j:t+i.j}},n.prototype.getSubAreaAtCanvasCoordinate=function(e,t){var i=this.convertCanvasToGridCoordinate(e,t);return this.getSubAreaAtGridCoordinate(i.i,i.j)},n.prototype.getIconsAtCanvasCoordinate=function(e,t){var i=this.convertCanvasToGridCoordinate(e,t),n=this.convertGridCoordinateToZoneId(i.i,i.j);return this._iconBatchData.getClusterIcons(n)},n.prototype.setupUI=function(e){this._setupMapTransform(),this._setupMapTooltip(e)},n.prototype._setupMapTransform=function(){R(this,"HIGH");var e,t=0,i=0;this.on("transformStart",function(){e=Date.now(),t=0,i=0}),this.on("transform",function(n,o,s,a,r){e=Date.now(),t=.5*t+.5*-s,i=.5*i+.5*-a,this.move(n,o,-s,-a,r)}),this.on("transformEnd",function(){Date.now()-e>100||this.addInertia(t,i)})},n.prototype._setupMapTooltip=function(e){function t(e){if(p||(p=g.rootElement.getBoundingClientRect()),r=e.x,l=e.y,c=r-p.left,d=l-p.top,m){var t=null,i=null,n=c-g.cropPosition.x,o=Math.min(.1*g.cropPosition.width,50),s=0;n<o?(t=0,s=n):n>g.cropPosition.width-o&&(t=g._worldMapWidth,s=g.cropPosition.width-n);var a=d-g.cropPosition.y,u=0;if(a<o?(i=0,u=a):a>g.cropPosition.height-o&&(i=g._worldMapHeight,u=g.cropPosition.height-a),null===t&&null===i)M.playing&&(M.stop(),g._loadChunksInView());else{b.x=g._scene.camera.x,b.y=g._scene.camera.y,g._scene.camera.follow(b);var h={x:b.x,y:b.y},f={},v=0,y=w;null===t?f.x=b.x:(f.x=t,Math.abs(t-b.x)>v&&(v=Math.abs(t-b.x),y=w*(o-s)/o)),null===i?f.y=b.y:(f.y=i,Math.abs(i-b.y)>v&&(v=Math.abs(i-b.y),y=w*(o-u)/o)),M.playing||M.start(!1),_.closeTooltip(),M.reset().from(h).to(f,v/y),g._loadChunksInView()}}}function i(){p=g.rootElement.getBoundingClientRect()}function n(e,t){var i=g.convertGridToCanvasCoordinate(e,t),n=g._scene.camera.zoom;return{centerX:i.x+p.left,centerY:i.y+p.top,width:Math.round(g._zoneWidth*n),height:Math.round(g._zoneHeight*n)}}function o(e,t,i){var n=e.subAreaData,o=g.getSubAreaAtGridCoordinate(t,i);if(e.setCoordinates(t,i),o){if(o&&o!==n){n&&g.removeSubAreaHighlight(n.id),e.subAreaData=n=o,e.setSubArea(n);var s=N.entities.prism[n.id];if(s&&s.prism){var a=s.getAlliance();e.setAlliance(a);var r=D.hexToRgb(a.allianceEmblem.backgroundColor.toString(16));g.addSubAreaHighlight(n.id,[r[0]/255,r[1]/255,r[2]/255,.25])}else e.unsetAlliance(),g.addSubAreaHighlight(n.id,[1,0,0,.25])}}else n&&(g.removeSubAreaHighlight(n.id),n=null),e.unsetSubArea();var l=g._iconBatchData.getClusterIcons(g.convertGridCoordinateToZoneId(t,i));l?(e.setIcons(l,g._iconsImage),e.displayIcons()):n?e.displaySubArea():e.displayCoordinates()}function s(){if(!M.playing){var e=g.convertCanvasToGridCoordinate(c,d);if((u!==e.i||h!==e.j)&&m){u=e.i,h=e.j,g.setHighlightOn(u,h),o(v,u,h);var t=n(u,h),i=2*F;_.openTooltipAt(t.centerX,t.centerY,t.width+i,t.height+i)}}}function a(e){t(O(e)),s()}P(this);var r,l,c,d,u,h,p,m,f=window.gui,g=this,_=f.tooltipBox,v=new B;this.on("tap",function(){if(g._worldMapData){var e=g.convertCanvasToGridCoordinate(c,d),t=this.convertGridCoordinateToZoneId(e.i,e.j);e.icons=this._iconBatchData.getClusterIcons(t),f.openContextualMenu("map",e),g.setHighlightOn(e.i,e.j)}});var y=L.getContextMenu("map");y.on("open",function(e){o(y.worldMapTooltip,e.i,e.j)}),y.on("close",function(e){"reopen"!==e&&g.hideHighlight()});var b={},M=new k(b,["x","y"]);M.onFinish(function(){g._loadChunksInView()});var w=50;this.on("dom.touchstart",function(e){
this.stopMovingWorldMap(),t(O(e))}),e.on("positioned",i),e.on("resize",i),x(this,v),this.on("tooltipOn",function(){m=!0,_.closeForRecomputing(),s(),f.wBody.on("dom.touchmove",a)}),this.on("tooltipOut",function(){m=!1,f.wBody.removeListener("dom.touchmove",a);var e=v.subAreaData;e&&g.removeSubAreaHighlight(e.id),g.hideHighlight(),M.playing&&M.stop(),e=u=h=null})}},function(e,t){},function(e,t,i){function n(e,t){return e._layer===t._layer?e._position-t._position:e._layer-t._layer}function o(){var e=document.createElement("canvas");e.width=128,e.height=128;var t=e.getContext("2d");return t.fillStyle="rgba(200, 100, 30, 0.27)",t.fillRect(0,0,128,128),t.lineWidth=2,t.strokeStyle="rgba(200, 100, 30, 0.9)",t.strokeRect(0,0,128,128),e}function s(e){void 0===e.name&&console.error("[Scene] Parameter `name` required."),void 0===e.canvas&&console.error("[Scene] Parameter `canvas` required."),void 0===e.pixelRatio&&console.error("[Scene] Parameter `pixelRatio` required."),void 0===e.textureRatio&&e.usePrecisionRendering&&console.error("[Scene] Parameter `textureRatio` required."),void 0===e.w&&console.error("[Scene] Parameter `w` required."),void 0===e.h&&console.error("[Scene] Parameter `h` required."),void 0===e.t&&console.error("[Scene] Parameter `t` required."),void 0===e.l&&console.error("[Scene] Parameter `l` required."),void 0===e.nbCacheableSprites&&console.error("[Scene] Parameter `nbCacheableSprites` required."),void 0===e.textureMemoryCacheSize&&console.error("[Scene] Parameter `textureMemoryCacheSize` required."),void 0===e.prerenderQualityRatio&&console.error("[Scene] Parameter `prerenderQualityRatio` required."),this.name=e.name,this.canvas=e.canvas,this.canvas.id=this.name+"-canvas",this.maxZoom=e.maxZoom||1,this.pixelRatio=e.pixelRatio,this.sceneTextureRatio=e.textureRatio,this.viewWidth=this.canvas.width,this.viewHeight=this.canvas.height,this.adjustToCanvasRatio=e.adjustToCanvasRatio||!1,this.w=e.w,this.h=e.h,this.l=e.l,this.t=e.t,this.r=this.l+this.w,this.b=this.t+this.h;var t=this.w/2+this.l,i=this.h/2+this.t;this.camera=new a(t,i,1,this.l,this.r,this.t,this.b,this.canvas.width,this.canvas.height,this.maxZoom),e.cameraAcceleration&&this.camera.setDefaultAcceleration(e.cameraAcceleration),this.cropping={x:-(1/0),y:-(1/0),w:1/0,h:1/0,isActive:!1},this.displayList=new r(n),this.hudDisplayList=new r(n),this.staticElements={sprite:null,render:function(e,t){null!==this.sprite&&this.sprite.draw(e,t)},add:function(e){return this.sprite=e,e},removeByRef:function(e){e===this.sprite&&(this.sprite=null)},reposition:function(e){return e},clear:function(){null!==this.sprite&&(this.sprite.remove(),this.sprite=null)}},this.updateList=[],this.renderer=new l(this.canvas,0,0,e.nbCacheableSprites,e.textureMemoryCacheSize,e.prerenderQualityRatio,(!1)),this._debug=!1,this._textureDebug=this.createTexture(o(),"mapDebug","linear","permanent"),this.usePrecisionRendering=e.usePrecisionRendering||!1,this.usePrecisionRendering?(this.areasToRefresh=[],this.sceneRendering=this.renderer.startTextureUsage(this.r-this.l,this.b-this.t,this.sceneTextureRatio,this.name),this.sceneTextureRatio=this.sceneRendering.width/(this.r-this.l),this.renderingProgram=this.renderer._programFiltering,this.renderingParams={ratio:.15,resolution:250},this.refresh=this._refreshPrecisionRendering,this.render=this._compositePrecisionRendering,this.clear=this._clearPrecisionRendering):(this.refresh=this._refresh,this.render=this._composite,this.clear=this._clear),this.setCanvasDimensions(this.canvas.width,this.canvas.height)}var a=i(1004),r=i(403),l=i(398);e.exports=s,s.prototype.togglePixelArt=function(){this.renderingProgram===this.renderer._programPixelArt?this.renderingProgram=this.renderer._programFiltering:this.renderingProgram=this.renderer._programPixelArt},s.prototype.setShader=function(e){switch(e){case"pixelArt":this.renderingProgram=this.renderer._programPixelArt;break;case"mapTransition":this.renderingProgram=this.renderer._programMapTransition;break;default:this.renderingProgram=this.renderer._programFiltering}},s.prototype._setSceneTransform=function(){var e=this.canvas.width/this.w,t=this.canvas.height/this.h,i=Math.max(e,t),n=Math.max(0,this.cropping.x)*this.pixelRatio,o=Math.max(0,this.cropping.y)*this.pixelRatio;this.renderer.setTransform(i,0,0,i,n,o)},s.prototype._setFieldOfView=function(){this.viewWidth=Math.min(this.cropping.w,this.canvas.width/this.pixelRatio),this.viewHeight=Math.min(this.cropping.h,this.canvas.height/this.pixelRatio),this.camera.setFieldOfView(this.viewWidth,this.viewHeight),this._setSceneTransform()},s.prototype.setCanvasDimensions=function(e,t,i,n,o){if(void 0!==o&&(this.canvas.style.position=o),this._viewWidth===e&&this._viewHeight===t&&this._viewLeft===i&&this._viewTop===n)return!1;this._viewWidth=e,this._viewHeight=t,this._viewLeft=i,this._viewTop=n,this.canvas.style.width=e.toString()+"px",this.canvas.style.height=t.toString()+"px",void 0!==i&&(this.canvas.style.left=i+"px"),void 0!==n&&(this.canvas.style.top=n+"px");var s=e*this.pixelRatio,a=t*this.pixelRatio;if(this.canvas.width=s,this.canvas.height=a,this.renderer.resetDimension(s,a),this.adjustToCanvasRatio){var r=this.h*s/a;this.setDimensions(this.l,this.t,r,this.h)}return this._setFieldOfView(),!0},s.prototype.setDimensions=function(e,t,i,n){this.w=i,this.h=n,this.l=e,this.t=t,this.r=this.l+this.w,this.b=this.t+this.h,this.camera.setBounds(this.l,this.r,this.t,this.b),this._setSceneTransform()},s.prototype.requireCompleteRefresh=function(){this.areasToRefresh.push([this.l,this.r,this.t,this.b])},s.prototype._refresh=function(e){var t=this.camera.updatePosition(e);if(0!==this.updateList.length||t!==!1){if(this.renderer.clear(),this.cropping.isActive){var i=this.pixelRatio,n=Math.ceil(i*this.cropping.x),o=Math.ceil(i*this.cropping.y),s=Math.ceil(i*this.cropping.w),a=Math.ceil(i*this.cropping.h);o=this.canvas.height-a-o,this.renderer.enableScissor(n,o,s,a)}this._composite(),this.cropping.isActive&&this.renderer.disableScissor()}},s.prototype._composite=function(){for(var e=0;e<this.updateList.length;e+=1)this.updateList[e].refreshAnimation();this.updateList.length=0;var t=this.pixelRatio*this.camera.zoom*Math.min(this.w/this.canvas.width,this.h/this.canvas.height);this.renderer.save(),this.renderer.translate(t/this.camera.zoom*this.viewWidth/2,t/this.camera.zoom*this.viewHeight/2),this.renderer.scale(t,t),this.renderer.translate(-this.camera.x,-this.camera.y);for(var i=this.displayList.first;null!==i;i=i.next)i.object.render();this._debug&&this._renderDebug(),this.renderer.restore()},s.prototype._renderDebug=function(){for(var e=this.displayList.first;null!==e;e=e.next){var t=e.object;this.renderer.drawImage(this._textureDebug,t.x,t.y,t.w,t.h)}},s.prototype._refreshPrecisionRendering=function(e){var t=this.camera.updatePosition(e);if(0!==this.updateList.length){for(var i=0;i<this.updateList.length;i+=1)this.updateList[i].refreshAnimation(this.areasToRefresh);this.updateList.length=0}if(0!==this.areasToRefresh.length){for(var n=0;n<this.areasToRefresh.length;n+=1){var o=this.areasToRefresh[n];if(o[1]<=o[0]||o[3]<=o[2])this.areasToRefresh.splice(n,1),n-=1;else for(var s=0;s<this.areasToRefresh.length;s+=1)if(n!==s){var a=this.areasToRefresh[s],r=(o[0]-a[1])*(a[0]-o[1])>0,l=(o[2]-a[3])*(a[2]-o[3])>0;r&&l&&(o[0]=Math.min(o[0],a[0]),o[1]=Math.max(o[1],a[1]),o[2]=Math.min(o[2],a[2]),o[3]=Math.max(o[3],a[3]),this.areasToRefresh.splice(s,1),s-=1,s<n&&(n-=1))}}this._refreshAreas(),t=!0}(t||this.hudDisplayList.count>0)&&(this._compositePrecisionRendering(),this._debug&&this._renderDebugPrecisionRendering(this.areasToRefresh),this.areasToRefresh.length=0),this.areasToRefresh.length>0&&(this.areasToRefresh.length=0)};var c={layer:-(1/0)},d={layer:1/0};s.prototype._refreshAreas=function(){this.renderer.startTextureRendering(this.sceneRendering,this.l,this.r,this.t,this.b);for(var e=c,t=0;t<this.areasToRefresh.length;t+=1){var i=this.areasToRefresh[t],n=Math.floor(this.sceneTextureRatio*(i[0]-this.l))-1,o=Math.floor(this.sceneTextureRatio*(i[2]-this.t))-1,s=Math.ceil(this.sceneTextureRatio*(i[1]-i[0]))+2,a=Math.ceil(this.sceneTextureRatio*(i[3]-i[2]))+2;this.renderer.enableScissor(n,o,s,a);for(var r=this.displayList.first;null!==r;r=r.next){var l=r.object,u=l.bbox;if(!(u[0]>=u[1])){var h=(i[0]-u[1])*(u[0]-i[1])>=0,p=(i[2]-u[3])*(u[2]-i[3])>=0;h&&p&&(this.staticElements.render(e,l),e=l,l.render())}}this.staticElements.render(e,d)}this.renderer.stopTextureRendering(),this.renderer.disableScissor()},s.prototype._compositePrecisionRendering=function(){var e=this.pixelRatio*this.camera.zoom*Math.min(this.w/this.canvas.width,this.h/this.canvas.height);if(this.renderer.disableBlending(),this.renderer.useProgram(this.renderingProgram,this.renderingParams),this.renderer.drawImage(this.sceneRendering.texture,this.w/2-(this.camera.x-this.l)*e,this.h/2-(this.camera.y-this.t)*e,e*this.w,e*this.h),this.renderer.stopProgram(),this.renderer.enableBlending(),this.hudDisplayList.count>0){this.renderer.useProgram(this.renderer._programRegular);for(var t=this.hudDisplayList.first;null!==t;t=t.next)t.object.render();this.renderer.stopProgram()}},s.prototype._renderDebugPrecisionRendering=function(e){var t=this.camera.zoom*this.pixelRatio*this.w/this.canvas.width;this.renderer.save(),this.renderer.translate(this.w/2,this.h/2),this.renderer.scale(t,t),this.renderer.translate(-(this.camera.x-this.l),-(this.camera.y-this.t)),this.renderer.enableBlending();for(var i=0;i<e.length;i+=1){var n=e[i],o=n[0]-this.l,s=n[2]-this.t,a=n[1]-n[0],r=n[3]-n[2];this.renderer.drawImage(this._textureDebug,o,s,a,r)}this.renderer.restore()},s.prototype.crop=function(e,t,i,n){this.cropping.isActive=!0,this.cropping.x=e,this.cropping.y=t,this.cropping.w=i,this.cropping.h=n,this._setFieldOfView()},s.prototype.resetCropping=function(){this.cropping.isActive=!1,this.cropping.x=-(1/0),this.cropping.y=-(1/0),this.cropping.w=1/0,this.cropping.h=1/0,this._setFieldOfView()},s.prototype.convertSceneToCanvasCoordinate=function(e,t){var i=Math.max(0,this.cropping.x),n=Math.max(0,this.cropping.y);return{x:(e-this.camera.x+this.camera.fovW/2)*this.camera.zoom+i,y:(t-this.camera.y+this.camera.fovH/2)*this.camera.zoom+n}},s.prototype.convertCanvasToSceneCoordinate=function(e,t){var i=Math.max(0,this.cropping.x),n=Math.max(0,this.cropping.y);return{x:(e-i)/this.camera.zoom+this.camera.x-this.camera.fovW/2,y:(t-n)/this.camera.zoom+this.camera.y-this.camera.fovH/2}},s.prototype.move=function(e,t,i,n,o){e-=Math.max(0,this.cropping.x),t-=Math.max(0,this.cropping.y),this.camera.transform(e,t,i,n,o)},s.prototype.toggleDebugMode=function(){this._debug=!this._debug},s.prototype.showSprites=function(e){for(var t=0;t<e.length;t++)e[t].show()},s.prototype.hideSprites=function(e){for(var t=0;t<e.length;t++)e[t].hide()},s.prototype.createTexture=function(e,t,i,n){return this.renderer.createTexture(e,t,i,n)},s.prototype.useTexture=function(e){return this.renderer.useTexture(e)},s.prototype.holdTexture=function(e){return this.renderer.holdTexture(e)},s.prototype.clean=function(){for(var e=this.displayList.first;null!==e;){var t=e.next;e.object.remove(),e=t}this.staticElements.clear()},s.prototype._clear=function(e,t,i,n){this.renderer.setClearColor(e,t,i,n),this.renderer.clear(),this.renderer.resetClearColor()},s.prototype._clearPrecisionRendering=function(e,t,i,n){this.renderer.startTextureRendering(this.sceneRendering,this.l,this.r,this.t,this.b),this.renderer.setClearColor(e,t,i,n),this.renderer.clear(),this.renderer.stopTextureRendering(),this.renderer.clear(),this.renderer.resetClearColor()}},function(e,t,i){function n(e,t,i,n,s,a,l,c,d,u){o.call(this),this.l=n,this.r=s,this.t=a,this.b=l,this.w=s-n,this.h=l-a,this.min={x:0,y:0},this.max={x:0,y:0},this.fovWAbsolute=c,this.fovHAbsolute=d,this.setZoomMax(u),this._updateZoomBounds(),this.setZoom(i),this.setPosition(e,t),this.acceleration=r,this.a=this.acceleration,this._frozen=!1,this.emitAtDestination=!1}var o=i(175).EventEmitter,s=i(172).inherits,a=.005,r=1.25,l=3e3,c=.008,d=.013;s(n,o),e.exports=n,n.prototype.setAcceleration=function(e){this.a=e},n.prototype.setDefaultAcceleration=function(e){this.acceleration=e},n.prototype.freeze=function(){this._frozen=!0},n.prototype.unfreeze=function(){this._frozen=!1},n.prototype.stopMoving=function(){this.followee={x:this.x,y:this.y},this.zoomTarget=this.zoom,this.z=l/this.zoom},n.prototype.setZoom=function(e){e=Math.max(this.minZoom,Math.min(this.maxZoom,e)),this.z=l/e,this.zoom=e,this.zoomTarget=e,this._updatePositionBounds()},n.prototype.setZoomMax=function(e){this.maxZoom=e},n.prototype.setPosition=function(e,t){this.x=Math.min(this.max.x,Math.max(this.min.x,e)),this.y=Math.min(this.max.y,Math.max(this.min.y,t)),this.followee={x:e,y:t}},n.prototype._updateZoomBounds=function(){var e=this.fovWAbsolute/this.w,t=this.fovHAbsolute/this.h;this.minZoom=Math.max(e,t),this.zoom<this.minZoom&&(this.zoom=this.minZoom),this.zoomTarget<this.minZoom&&(this.zoomTarget=this.minZoom),this.z=l/this.zoom},n.prototype._updatePositionBounds=function(){this.fovW=this.fovWAbsolute/this.zoomTarget,this.fovH=this.fovHAbsolute/this.zoomTarget,this.min.x=this.l+this.fovW/2,this.min.y=this.t+this.fovH/2,this.max.x=this.r-this.fovW/2,this.max.y=this.b-this.fovH/2,this.min.x>this.max.x&&(this.min.x=this.max.x=(this.min.x+this.max.x)/2),this.min.y>this.max.y&&(this.min.y=this.max.y=(this.min.y+this.max.y)/2)},n.prototype.zoomTo=function(e){this.zoomTarget=Math.min(Math.max(e,this.minZoom),this.maxZoom),this._updatePositionBounds()},n.prototype.moveTo=function(e,t,i){this.followee={x:e,y:t},null!==i&&void 0!==i&&(this.emitAtDestination=!0)},n.prototype.transform=function(e,t,i,n,o){var s=this.zoomTarget;e/=s,t/=s,i/=s,n/=s;var a=Math.max(this.minZoom,Math.min(this.maxZoom,s*o)),r=1-s/a,l=Math.min(this.max.x,Math.max(this.min.x,this.followee.x)),c=Math.min(this.max.y,Math.max(this.min.y,this.followee.y)),d=l+(e-this.fovW/2)*r+i,u=c+(t-this.fovH/2)*r+n;this.zoomTo(a),this.moveTo(d,u)},n.prototype.addInertia=function(e,t,i){e/=this.zoom,t/=this.zoom;var n=Math.sqrt(e*e+t*t);if(0!==n){this.a=Math.pow(this.acceleration,1-i);var o=Math.log(n/a)/Math.log(this.a)-1,s=a*(1-Math.pow(this.a,o))/(1-this.a);this.moveTo(this.x+s*e/n,this.y+t*s/n)}},n.prototype.setFieldOfView=function(e,t){this.fovWAbsolute=e,this.fovHAbsolute=t,this._updateZoomBounds(),this._updatePositionBounds()},n.prototype.setBounds=function(e,t,i,n){this.l=e,this.r=t,this.t=i,this.b=n,this.w=t-e,this.h=n-i,this._updateZoomBounds(),this._updatePositionBounds()},n.prototype.follow=function(e){this.followee=e},n.prototype.updatePosition=function(e){if(!this._frozen){this.a+=(this.acceleration-this.a)*(d*e);var t=this.min.x,i=this.max.x,n=this.min.y,o=this.max.y,s=Math.min(i,Math.max(t,this.followee.x)),a=Math.min(o,Math.max(n,this.followee.y)),r=l/this.zoomTarget,u=s-this.x,h=a-this.y,p=r-this.z;if(0===u&&0===h&&0===p)return this.emitAtDestination&&(this.emitAtDestination=!1,this.emit("atDestination")),!1;if(Math.abs(u)<.5&&Math.abs(h)<.5&&Math.abs(p)<.5)return this.x=s,this.y=a,this.z=r,this.zoom=this.zoomTarget,this.a+=(1-this.a)*c,!1;var m=1-Math.pow(2-this.a,e);this.x+=m*u,this.y+=m*h,this.z+=m*p,this.zoom=l/this.z;var f=this.fovWAbsolute/this.zoom,g=this.fovHAbsolute/this.zoom;return t=this.l+f/2,n=this.t+g/2,i=this.r-f/2,o=this.b-g/2,this.x<t?this.x=t:this.x>i&&(this.x=i),this.y<n?this.y=n:this.y>o&&(this.y=o),!0}}},function(e,t){function i(e,t,i,n){this.x0=e,this.y0=t,this.x1=i,this.y1=n}e.exports=i},function(e,t,i){function n(e){s.call(this,e),this._lines=e.lines,this._lineWidth=e.lineWidth*a.PIXEL_RATIO,this._lineByteSize=this.renderer.getNbBytesPerLine(),this._bbox=[1/0,-(1/0),1/0,-(1/0)],this._createVertexBuffer()}var o=i(172).inherits,s=i(375),a=i(167);o(n,s),e.exports=n,n.prototype._createVertexBuffer=function(){var e=this._lines.length;this._vertexBuffer=new ArrayBuffer(e*this._lineByteSize),this._positions=new Float32Array(this._vertexBuffer),this._colorView=new Uint32Array(this._vertexBuffer);for(var t=0;t<e;t+=1){var i=this._lines[t];this._expandToFitLine(i);var n=t*this._lineByteSize/4;this._positions[n+0]=i.x0,this._positions[n+1]=i.y0,this._positions[n+5]=i.x1,this._positions[n+6]=i.y1,this._colorView[n+3]=this._colorView[n+8]=1077952576}this.renderer.releaseBuffer(this.id),this.forceRefresh()},n.prototype.draw=function(){this.renderer.drawLineBatch(this.id,this._lineWidth)},n.prototype._expandToFitPoint=function(e,t){this._bbox[0]>e&&(this._bbox[0]=e),this._bbox[2]>t&&(this._bbox[2]=t),this._bbox[1]<e&&(this._bbox[1]=e),this._bbox[3]<t&&(this._bbox[3]=t)},n.prototype._expandToFitLine=function(e){this._expandToFitPoint(e.x0,e.y0),this._expandToFitPoint(e.x1,e.y1)},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this._positions,i=!1;this.renderer.loadLineBuffer(this.id,t,this._bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t,i){var n=i(167),o=i(392),s=1e3/n.FPS,a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,s)},r={gameScenes:[],previousUpdate:Date.now(),addScene:function(e){var t=this.gameScenes.indexOf(e);t===-1?this.gameScenes.push(e):console.warn("[animationController.addScene] Scene already in the animation controller")},removeScene:function(e){var t=this.gameScenes.indexOf(e);t!==-1?this.gameScenes.splice(t,1):console.warn("[animationController.removeScene] Scene not in the animation controller")},start:function(){function e(){o.update();var i=Date.now(),n=Math.min(i-t.previousUpdate,200),r=n>s;if(r){t.previousUpdate=i-n%s,n/=s;for(var l=t.gameScenes,c=0;c<l.length;c+=1)l[c].refresh(n)}a(e)}var t=this;e()},stop:function(){o.stop()}};e.exports=r},function(e,t,i){function n(e,t,i,n,o,r,l,c){var d=s/i,u=a/i;this.x=e*d,this.y=t*u,this.w=d,this.h=u,this.id=n,this.path=o,this.texture=r,this.scene=l,this.distToViewCenter=c}var o=i(1009),s=o.CHUNK_WIDTH,a=o.CHUNK_HEIGHT;e.exports=n},function(e,t,i){t.WORLDMAP_PATH=i(167).WORLDMAP_PATH,t.SUBAREA_COLOR=[16/255,186/255,105/255,.25],t.VIEW_MARGIN=1.1,t.CHUNK_WIDTH=250,t.CHUNK_HEIGHT=250,t.ICON_DIAMETER=28,t.ICONS_ANCHOR_POINT={DEFAULT:{x:-.5,y:-.5},myPosition:{x:-.5,y:-1},flag0:{x:-.5,y:-1},flag1:{x:-.5,y:-1}},t.ICONS_ORIGINAL_EXPORT_SCALE=1.5},function(e,t){function i(e,t,i,n){this.id=e,this.visible=!0,this.color=null,this.categoryId=t,this.infoData=i,this.dimensions=n,this.cluster=null,this.vertexBufferSlot=null}e.exports=i,i.prototype.setVisibility=function(e){return this.visible!==e&&(this.visible=e,this.cluster&&(e?this.cluster.nVisibleIcons+=1:this.cluster.nVisibleIcons-=1),!0)}},function(e,t,i){function n(e){this.texture=null,this.iconDimensions=null,this.iconBatch=null,this.worldMap=e,this.reset()}var o=i(1012).clusterOrdering,s=i(1014),a=i(1010),r=i(1009).ICONS_ANCHOR_POINT;e.exports=n,n.prototype.getClusterIcons=function(e){var t=this.iconClusters[e];if(t)return t.icons},n.prototype.reset=function(){this.icons={},this.iconClusters={},this.iconsPerCategory={},this.zIndexedIconClusters=[]},n.prototype.addCluster=function(e){this.iconClusters[e.id]=e,this.zIndexedIconClusters.push(e),this.zIndexedIconClusters.sort(o)},n.prototype.removeCluster=function(e){var t=this.zIndexedIconClusters.indexOf(e);return t===-1?void console.error(new Error("[IconBatchData.removeCluster] Trying to remove inexistent cluster")):(delete this.iconClusters[e.id],void this.zIndexedIconClusters.splice(t,1))},n.prototype.createIconModels=function(e,t,i){var n={},o=Object.keys(e);i=i||1;for(var s=0;s<o.length;s+=1){var a=e[o[s]];a.w*=i,a.h*=i;var l=r[a.className]||r.DEFAULT;l&&(a.x=a.w*l.x,a.y=a.h*l.y),n[a.className]=a}this.texture=t,this.iconDimensions=n},n.prototype.clearIconBatch=function(){null!==this.iconBatch&&(this.iconBatch.clear(),this.iconBatch=null)},n.prototype.addIcon=function(e){var t=e.id;if(void 0!==this.icons[t])return void console.error("addIcon: An icon of id",t,"already exists.");this.icons[t]=e;var i=e.categoryId;void 0===this.iconsPerCategory[i]?this.iconsPerCategory[i]=[e]:this.iconsPerCategory[i].push(e),null!==this.iconBatch&&this.iconBatch.addIcon(e)},n.prototype.removeIcon=function(e){var t=this.icons[e];if(void 0!==t){delete this.icons[e];var i=t.cluster;i.remove(t),0===i.icons.length&&this.removeCluster(i);var n=this.iconsPerCategory[t.categoryId],o=n.indexOf(t.id);n.splice(o,1),null!==this.iconBatch&&this.iconBatch.removeIcon(t)}},n.prototype._addIconToZoneCluster=function(e,t,i){var n=this.worldMap.convertGridCoordinateToZoneId(t,i),o=this.iconClusters[n];if(void 0===o){var a=this.worldMap._convertGridToSceneCoordinate(t,i);o=new s(n,a.x,a.y),this.addCluster(o)}o.add(e),e.cluster=o},n.prototype.createIcon=function(e,t){if(!this.iconDimensions[t])return console.error("WorldMap (IconBatchData): unknown icon "+t);var i=e.x,n=e.y,o=e.categoryId,s=new a(e.id,o,e,this.iconDimensions[t]);return void 0===this.icons[e.id]?(this._addIconToZoneCluster(s,i,n),this.addIcon(s)):console.warn("createIcon: An icon of id",e.id,"already exists."),s},n.prototype.createIconsFromInfo=function(e,t){for(var i=Object.keys(e),n=0;n<i.length;n+=1){var o=e[i[n]];o.worldMapId===t&&this.createIcon(o,"icon_"+o.gfx)}},n.prototype.hasIcon=function(e){return this.icons.hasOwnProperty(e)},n.prototype.getIcon=function(e){return this.icons[e]},n.prototype.setVisibilityOfIconType=function(e,t){var i=this.iconsPerCategory[e];if(void 0!==i){for(var n=[],o=0;o<i.length;o+=1){var s=i[o],a=s.setVisibility(t);a&&n.push(s)}null!==this.iconBatch&&this.iconBatch.setVisibility(n,t)}},n.prototype.setIconPosition=function(e,t,i){var n=this.icons[e];if(void 0!==n){var s=n.cluster;if("userPosition"===e){var a=this.worldMap._convertGridToSceneCoordinate(t,i);s.position.x=a.x,s.position.y=a.y,this.zIndexedIconClusters.sort(o)}else s.remove(n),this._addIconToZoneCluster(n,t,i);null!==this.iconBatch&&this.iconBatch.updateIconPosition(n)}}},function(e,t,i){var n=i(1009).ICON_DIAMETER,o=i(1013);t.positionOrdering=function(e,t){var i=e.y-t.y;return 0===i?e.x-t.x:i},t.clusterOrdering=function(e,t){var i=e.position,n=t.position,o=i.y-n.y;return 0===o?i.x-n.x:o};var s=[];t.computeRelativePositions=function(e){for(var i=[],a=e<=1?0:n/(2*Math.sin(Math.PI/e)),r=0;r<e;r+=1){var l=2*Math.PI*r/e;i[r]=new o(Math.cos(l)*a,Math.sin(l)*a)}return i.sort(t.positionOrdering),i.push(new o(0,0)),s[e]=i,i},t.getRelativePositions=function(e){var i=s[e];return void 0===i&&(i=t.computeRelativePositions(e)),i}},function(e,t){function i(e,t){this.x=e,this.y=t}e.exports=i,i.prototype.plus=function(e){return new i(this.x+e.x,this.y+e.y)},i.prototype.copy=function(){return new i(this.x,this.y)}},function(e,t,i){function n(e,t,i){this.id=e,this.position=new o(t,i),this.icons=[],this.nVisibleIcons=0}var o=i(1013),s=i(1012).getRelativePositions;e.exports=n,n.prototype.getIconPosition=function(e){var t=s(this.nVisibleIcons);return this.position.plus(t[e])},n.prototype.add=function(e){this.icons.unshift(e),e.visible&&(this.nVisibleIcons+=1)},n.prototype.remove=function(e){var t=this.icons.indexOf(e);t===-1?console.error(new Error("[IconCluster.remove] Icon not in cluster: "+e.id)):(this.icons.splice(t,1),e.visible&&(this.nVisibleIcons-=1))}},function(e,t,i){function n(e,t){this.icon=e,this.index=t,this.reference=null}function o(e){a.call(this,e),this._bbox=[0,e.w,0,e.h],this._iconsData=e.iconsData,this._texture=this._iconsData.texture,this._textureWidth=this._texture.element.width,this._textureHeight=this._texture.element.height,this._iconByteSize=this.renderer.getNbBytesPerSprite(),this._vertexBufferSlots=new l,this._populateVertexBuffer()}var s=i(172).inherits,a=i(375),r=i(392),l=i(383),c=r.Tween,d=3.3,u=.2,h=9;s(o,a),e.exports=o,o.prototype._createVertexBuffer=function(){this._vertexBuffer=new ArrayBuffer(this._vertexBufferSlots.length*this._iconByteSize),this._floatView=new Float32Array(this._vertexBuffer),this._longView=new Uint32Array(this._vertexBuffer),this._shortView=new Uint16Array(this._vertexBuffer),this._byteView=new Uint8Array(this._vertexBuffer)},o.prototype._assignVertexBufferSlots=function(){for(var e=0,t=this._iconsData.zIndexedIconClusters,i=0;i<t.length;i+=1)for(var o=t[i],s=o.icons,a=0;a<s.length;a+=1){var r=s[a],l=new n(r,e);l.reference=this._vertexBufferSlots.addBack(l),r.vertexBufferSlot=l,e+=1}},o.prototype._populateVertexBuffer=function(){this._assignVertexBufferSlots(),this._createVertexBuffer();for(var e=this._iconsData.zIndexedIconClusters,t=0;t<e.length;t++)this._populateClusterVertexBuffer(e[t]);this.renderer.releaseBuffer(this.id),this.forceRefresh()},o.prototype._populateClusterVertexBuffer=function(e){for(var t=0,i=e.icons,n=0;n<i.length;n+=1)t=this._populateIconVertexBuffer(i[n],t)},o.prototype._populateIconVertexBuffer=function(e,t){var i=this._floatView,n=this._longView,o=this._longView,s=e.cluster.getIconPosition(t),a=e.vertexBufferSlot.index*this._iconByteSize/4;i[a+0]=i[a+5]=i[a+10]=s.x,i[a+15]=i[a+20]=i[a+25]=s.x,i[a+1]=i[a+6]=i[a+11]=s.y,i[a+16]=i[a+21]=i[a+26]=s.y;var r=e.dimensions,l=r.sx/this._textureWidth,c=r.sy/this._textureHeight,d=(r.sx+r.sw)/this._textureWidth,h=(r.sy+r.sh)/this._textureHeight,p=65535&65535*l,m=65535&65535*d,f=4294901760&4294901760*c,g=4294901760&4294901760*h;n[a+2]=p+f,n[a+7]=p+g,n[a+12]=m+g,n[a+17]=p+f,n[a+22]=m+g,n[a+27]=m+f;var _=e.infoData.color||[1,1,1,1],v=Math.max(-128,Math.min(127,64*_[0])),y=Math.max(-128,Math.min(127,64*_[1])),b=Math.max(-128,Math.min(127,64*_[2])),M=e.visible?Math.max(-128,Math.min(127,64*_[3])):0,w=(M<<24&4278190080)+(b<<16&16711680)+(y<<8&65280)+(255&v);n[a+3]=n[a+8]=n[a+13]=w,n[a+18]=n[a+23]=n[a+28]=w;var T=r.x,C=r.w+T,A=r.y,I=r.h+A,S=255&T,E=255&C,x=(255&A)<<8,N=(255&I)<<8,L=127*(1-u)&255,O=(L<<24)+(L<<16);return o[a+4]=S+x+O,o[a+9]=S+N+O,o[a+14]=E+N+O,o[a+19]=S+x+O,o[a+24]=E+N+O,o[a+29]=E+x+O,e.visible?t+1:t},o.prototype.setVisibility=function(e,t,i,n){for(var o,s,a=n||{},r=0;r<e.length;r+=1)s=e[r].cluster,void 0===a[s.id]&&(a[s.id]=s);for(var l=[],d={},p=Object.keys(a),m=0;m<p.length;m+=1){var f=p[m];s=a[f];var g=s.icons,_=0;for(r=0;r<g.length;r+=1)if(o=g[r],o.visible){var v=o.vertexBufferSlot.index*this._iconByteSize/4;l.push(o),d[o.id]={origin:{x:this._floatView[v],y:this._floatView[v+1]},destination:s.getIconPosition(_)},_+=1}}var y={ease:0},b=this,M=new c(y,["ease"]);M.onUpdate(function(){var i=b._floatView,n=b._shortView,o=b._byteView,s=y.ease,a=t?s:1-s,r=64*a&255,c=a-1,h=2,p=c*c*((h+1)*c+h)+1-u;p=127*p&255,p+=p<<8;for(var m=0;m<e.length;m+=1){var f=e[m],g=f.vertexBufferSlot.index*b._iconByteSize,_=g/2;n[_+9]=n[_+19]=n[_+29]=p,n[_+39]=n[_+49]=n[_+59]=p,o[g+15]=o[g+35]=o[g+55]=r,o[g+75]=o[g+95]=o[g+115]=r}var v=1-Math.pow((1-s)/1,4);for(m=0;m<l.length;m+=1){var M=l[m],w=d[M.id],T=w.origin.x*(1-v)+w.destination.x*v,C=w.origin.y*(1-v)+w.destination.y*v,A=M.vertexBufferSlot.index*b._iconByteSize/4;i[A+0]=i[A+5]=i[A+10]=T,i[A+15]=i[A+20]=i[A+25]=T,i[A+1]=i[A+6]=i[A+11]=C,i[A+16]=i[A+21]=i[A+26]=C}b.renderer.releaseBuffer(b.id),b.forceRefresh()}),M.from({ease:0}),M.to({ease:1},h),M.onFinish(i),M.start()},o.prototype.getSlotWhereIconShouldFit=function(e){var t=e.cluster,i=this._iconsData.zIndexedIconClusters,n=i,o=n.indexOf(t);if(o===-1)return void console.error(new Error("[IconBatch.addIconToVertexBuffer] Icon cluster not present in ordered list"));var s=t.icons,a=s.indexOf(e);if(a===-1)return void console.error(new Error("[IconBatch.addIconToVertexBuffer] Icon not present in its cluster"));var r;if(a===s.length-1)if(o===i.length-1)if(0===o){if(!this._vertexBufferSlots.first)return null;r=this._vertexBufferSlots.first.object}else{var l=i[o-1].icons;r=l[l.length-1].vertexBufferSlot}else r=i[o+1].icons[0].vertexBufferSlot;else r=s[a+1].vertexBufferSlot;var c=e.vertexBufferSlot;return null!==e.vertexBufferSlot&&c.index<r.index&&(r=r.reference.previous.object),r},o.prototype.addIcon=function(e){if(null!==e.vertexBufferSlot)return void console.warn("[IconBatch.addIconToVertexBuffer] Trying to add an icon already present in the vertex buffer");var t,i,o=this.getSlotWhereIconShouldFit(e);if(null===o){var s=new n(e,0);s.reference=this._vertexBufferSlots.add(s),e.vertexBufferSlot=s,i=null,t=0}else{t=o.index;var a=new n(e,t);for(a.reference=this._vertexBufferSlots.addBefore(o.reference,a),e.vertexBufferSlot=a,i=o.reference;null!==i&&null!==i.icon;)i.object.index+=1,i=i.next}if(null===i){var r=this._floatView;this._createVertexBuffer();var l=t*this._iconByteSize/4,c=r.subarray(0,l),d=r.subarray(l);this._floatView.set(c,0),this._floatView.set(d,l+this._iconByteSize/4)}else{var u=t*this._iconByteSize/4,h=i.object.index*this._iconByteSize/4;this._vertexBufferSlots.removeByReference(i);var p=this._floatView.subarray(u,h);this._floatView.set(p,u+this._iconByteSize/4)}this._populateIconVertexBuffer(e,0),this.setVisibility([e],!0)},o.prototype.updateIconPosition=function(e){var t=e.vertexBufferSlot;if(null===t)return void console.error(new Error("[IconBatch.updateIconPosition] Given icon is not present in the vertex buffer"));var i=this.getSlotWhereIconShouldFit(e);if(t.index!==i.index){var n,o,s,a,r,l=t.index*this._iconByteSize/4,c=l+this._iconByteSize/4,d=new Float32Array(this._floatView.subarray(l,c));if(t.index<i.index)for(n=c,o=i.index*this._iconByteSize/4+this._iconByteSize/4,this._floatView.set(this._floatView.subarray(n,o),l),r=t.reference;null!==r&&r.object!==i;)s=r.object,r=r.next,a=r.object.icon,a.vertexBufferSlot=s,s.icon=a;else for(n=i.index*this._iconByteSize/4,o=l,this._floatView.set(this._floatView.subarray(n,o),n+this._iconByteSize/4),r=t.reference;null!==r&&r.object!==i;)s=r.object,r=r.previous,a=r.object.icon,a.vertexBufferSlot=s,s.icon=a;i.icon=e,e.vertexBufferSlot=i,this._floatView.set(d,i.index*this._iconByteSize/4)}var u={},h=e.cluster;u[h.id]=h,this.setVisibility([],!0,null,u)},o.prototype.removeIcon=function(e){this.setVisibility([e],!1,function(){e.visible===!1&&(e.vertexBufferSlot.icon=null,e.vertexBufferSlot=null)})},o.prototype.render=function(){this.renderer.drawSpriteBatchAbsoluteScale(this.id,d*this.scene.pixelRatio)},o.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=this._floatView,n=this._texture,o=!1;this.renderer.loadSpriteBuffer(t,i,n,this._bbox,o),this.renderer.lockBuffer(this.id)}return this._bbox},o.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t){function i(e){var t=this,i=window.gui,n=i.GPS;this._lastWorld=null,this._worldMap=e,n.on("addPOI",function(e,n){n&&n!==i.playerData.position.worldmapId||t._worldMap.hasIcon(e.id)||(t._worldMap.isLoading()?t._worldMap.once("loaded",function(){t._worldMap.addIcon(e,e.iconId)}):t._worldMap.addIcon(e,e.iconId))}),n.on("removePOI",function(e,n){n&&n!==i.playerData.position.worldmapId||t._worldMap.hasIcon(e)&&t._worldMap.removeIcon(e)}),n.on("updatePOI",function(e,n){n&&n!==i.playerData.position.worldmapId||t._worldMap.hasIcon(e.id)&&(t._worldMap.removeIcon(e.id),t._worldMap.addIcon(e,e.iconId))})}e.exports=i,i.prototype.update=function(){var e=window.gui,t=e.GPS,i=e.playerData.position.worldmapId;if(this._lastWorld!==i){var n=t.getPOIs(this._lastWorld);for(var o in n)this._worldMap.hasIcon(o)&&this._worldMap.removeIcon(o);n=t.getPOIs();for(o in n)if(!this._worldMap.hasIcon(o)){var s=n[o];this._worldMap.addIcon(s,s.iconId)}this._lastWorld=i}}},function(e,t,i){function n(e,t){this._prisms=e,this._worldMap=null,this._conquestUIList=t,this._worldMapLoaded=!1,this._deferredActionQueue=new m;var i=this;window.gui.on("PrismsListMessage",function(e){function t(){i._prisms.setPrisms(e.prisms),i._updateWorldMapIcons(),i.loadUILists()}i._worldMapLoaded?t():i._deferredActionQueue.enqueue(t)}),window.gui.on("PrismsListUpdateMessage",function(e){function t(){i._prisms.updatePrisms(e.prisms),i._updateWorldMapIcons(),i.loadUILists()}i._worldMapLoaded?t():i._deferredActionQueue.enqueue(t);
})}var o=i(30),s=i(321),a=i(897),r=i(402),l=i(485),c=i(247).playUiSound,d=i(475),u=i(339),h=i(29).getText,p=i(1018),m=i(1019);e.exports=n,n.prototype.clear=function(){this._worldMap=null,this._worldMapLoaded=!1,this._deferredActionQueue.clear()},n.prototype.setWorldMap=function(e){1===e._worldMapId&&(this._worldMap=e,this._worldMapLoaded=!0,this._deferredActionQueue.signal())},n.prototype._updateWorldMapIcons=function(){var e=this;this._prisms.forEachEmptyPrism(function(t){e._worldMap.removeIcon(t.subAreaId)}),this._prisms.forEachChangingActivePrism(function(t){var i=p.getIconInfo(t);e._worldMapLoaded?(e._worldMap.removeIcon(i.id),e._worldMap.addIcon(i,"icon_"+i.gfx)):console.error("map not loaded!")})},n.prototype.showConquestList=function(){this._conquestUIList.show()},n.prototype.hideConquestList=function(){this._conquestUIList.hide()},n.prototype.loadUILists=function(){var e=this;o.getAllDataMap("SubAreas",function(t,i){if(t)return console.error("WorldMapWindow: getAllDataAreas error",t);e._conquestUIList.empty();var n=[{id:"AllTerritories",nameId:h("ui.pvp.conquestAllAreas")},{id:"Conquerable",nameId:h("ui.pvp.conquestCapturableAreas")},{id:"Normal",nameId:h("ui.prism.cartography.normal")},{id:"Weakened",nameId:h("ui.prism.cartography.weakened")},{id:"Vulnerable",nameId:h("ui.prism.cartography.vulnerable")}];n.forEach(function(t){e.addToList(e._conquestUIList,t)});var o=u.createPropertyNameCompareFunc("nameId"),a=new r(o),p=new r(o),m=new r(o),f=new r(o),g=new r(o);e._prisms.forEachPrism(function(e){var t=i[e.subAreaId];t&&a.add(t)}),e._prisms.forEachEmptyPrism(function(e){var t=i[e.subAreaId];t&&p.add(t)}),e._prisms.forEachPrism(function(e){var t=i[e.subAreaId];t&&m.add(t)},l.PRISM_STATE_NORMAL),e._prisms.forEachPrism(function(e){var t=i[e.subAreaId];t&&f.add(t)},l.PRISM_STATE_WEAKENED),e._prisms.forEachPrism(function(e){var t=i[e.subAreaId];t&&g.add(t)},l.PRISM_STATE_VULNERABLE),a.forEach(function(t){var i=new s("div",{className:"label",text:t.nameId});e._conquestUIList.items.AllTerritories.sublist.addItem(t.id,i,t)}),p.forEach(function(t){var i=new s("div",{className:"label",text:t.nameId});e._conquestUIList.items.Conquerable.sublist.addItem(t.id,i,t)}),m.forEach(function(t){var i=new s("div",{className:"label",text:t.nameId});e._conquestUIList.items.Normal.sublist.addItem(t.id,i,t)}),f.forEach(function(t){var i=new s("div",{className:"label",text:t.nameId});e._conquestUIList.items.Weakened.sublist.addItem(t.id,i,t)}),g.forEach(function(t){var i=new s("div",{className:"label",text:t.nameId});e._conquestUIList.items.Vulnerable.sublist.addItem(t.id,i,t)}),e._conquestUIList.removeAllListeners(),e._conquestUIList.on("activate",function(t){t.sublist.show(),c("TAB"),e._worldMap.clearSubAreaHighlights();for(var i in t.sublist.items){var n=t.sublist.items[i].data,o=d.entities.prism[n.id];if(o&&o.prism){var s=o.getAlliance(),a=u.hexToRgb(s.allianceEmblem.backgroundColor.toString(16));e._worldMap.addSubAreaHighlight(n.id,[a[0]/255,a[1]/255,a[2]/255,.5])}else e._worldMap.addSubAreaHighlight(n.id,[1,0,0,.25])}}),e._conquestUIList.on("deactivate",function(e){e.sublist.hide(),e.sublist.deactivate()})})},n.prototype.addToList=function(e,t){var i=this,n=new s("div",{className:"label"});n.createChild("div",{className:"arrow"}),n.createChild("div",{className:"text",text:t.nameId});var o=e.addItem(t.id,n,t);o.sublist=o.appendChild(new a),o.sublist.addClassNames("tree"),o.sublist.hide(),o.sublist.on("activate",function(e){i._worldMap.clearSubAreaHighlights(e.data.id);var t=e.data,n=d.entities.prism[t.id];if(n&&n.prism){var o=n.getAlliance(),s=u.hexToRgb(o.allianceEmblem.backgroundColor.toString(16));i._worldMap.addSubAreaHighlight(t.id,[s[0]/255,s[1]/255,s[2]/255,.65])}else i._worldMap.addSubAreaHighlight(t.id,[1,0,0,.25]);var a=i._worldMap.getSubAreaBounds(t.id);if(a){var r=a.height,l=a.width,c=a.x,h=a.y,p={posX:c+l/2,posY:h+r/2};i._worldMap.centerToPosition(p)}}),o.sublist.on("deactivate",function(e){i._worldMap.removeSubAreaHighlight(e.data.id)})}},function(e,t,i){function n(e,t){return function(){var i=new l(e.prism.nextVulnerabilityDate);return t+" "+s(i.getServerDate().date)}}function o(e,t){return function(){var i=new Date;i.setTime(1e3*e.prism.nextVulnerabilityDate);var n={month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"};return t+" "+i.toLocaleString(window.Config.language,n)}}function s(e){return e.getUTCHours().toString()+":"+a(e.getUTCMinutes().toString())+":"+a(e.getUTCSeconds().toString())}function a(e){return("0"+e).slice(-2)}var r=i(485),l=i(28).DofusDate,c=i(29).getText,d=436,u=421,h=420;t.getIconInfo=function(e){var t,i,s,a=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_INVULNERABLE)),l=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_ATTACKED)),p=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_FIGHTING)),m=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_NORMAL)),f=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_WEAKENED)),g=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_VULNERABLE)),_=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_DEFEATED)),v=c("ui.prism.startVulnerability")+c("ui.common.colon"),y=c("ui.prism.vulnerabilityHour");switch(e.prism.state){case r.PRISM_STATE_INVULNERABLE:t=h,i=a+"\n"+y,s=n(e,i);break;case r.PRISM_STATE_NORMAL:t=h,i=m+"\n"+y,s=n(e,i);break;case r.PRISM_STATE_ATTACKED:t=h,i=l+"\n"+y,s=n(e,i);break;case r.PRISM_STATE_FIGHTING:t=h,i=p+"\n"+y,s=n(e,i);break;case r.PRISM_STATE_WEAKENED:t=u,i=f+"\n"+v,s=o(e,i);break;case r.PRISM_STATE_VULNERABLE:t=d,i=g,s=function(e){return function(){return e}}(i);break;case r.PRISM_STATE_DEFEATED:t=d,i=_,s=function(e){return function(){return e}}(i);break;default:t=d,i=_,s=function(e){return function(){return e}}(i)}return{id:"prisms_"+e.subAreaId,x:e.worldX,y:e.worldY,subAreaId:e.subAreaId,categoryId:"prisms",gfx:t,nameIdOverRideFunc:s}}},function(e,t){function i(){this._queue=[]}e.exports=i,i.prototype.enqueue=function(e){this._queue.push(e)},i.prototype.signal=function(){for(var e in this._queue)this._queue[e]();this._queue.length=0},i.prototype.hasActions=function(){return this._queue.length>0},i.prototype.clear=function(){this._queue.length=0}},function(e,t){function i(){this._prisms={},this._emptyPrisms={},this._activePrisms={},this._changingPrisms={}}e.exports=i,i.prototype.setPrisms=function(e){this._changingPrisms=e;for(var t=Object.keys(e),i=0;i<t.length;i++){var n=e[t[i]];this._prisms[n.subAreaId]=n,"PrismGeolocalizedInformation"===n._type?this._activePrisms[n.subAreaId]=n:this._emptyPrisms[n.subAreaId]=n}},i.prototype.updatePrisms=function(e){this._changingPrisms={};for(var t=Object.keys(e),i=0;i<t.length;i++){var n=e[t[i]],o=n.subAreaId,s=this._prisms[n.subAreaId];"PrismGeolocalizedInformation"===n._type?((!s||s.mapId!==n.mapId||s.worldX!==n.worldX||s.worldY!==n.worldY||s.subAreaId!==n.subAreaId||s.prism.state!==n.prism.state||s.prism.alliance&&n.prism.alliance&&s.prism.alliance.allianceTag!==n.prism.alliance.allianceTag)&&(this._changingPrisms[n.subAreaId]=n),this._activePrisms[o]=n,delete this._emptyPrisms[o]):(this._emptyPrisms[o]=n,delete this._activePrisms[o]),this._prisms[n.subAreaId]=n}},i.prototype.forEachChangingActivePrism=function(e){for(var t=Object.keys(this._changingPrisms),i=0;i<t.length;i++){var n=this._changingPrisms[t[i]];this._activePrisms[n.subAreaId]&&e(n)}},i.prototype.forEachPrism=function(e,t){for(var i=Object.keys(this._prisms),n=0;n<i.length;n++){var o=this._prisms[i[n]];o.prism&&(null!==t&&void 0!==t&&o.prism.state!==t||e(this._prisms[i[n]]))}},i.prototype.forEachEmptyPrism=function(e){for(var t=Object.keys(this._emptyPrisms),i=0;i<t.length;i++)e(this._emptyPrisms[t[i]])}},function(e,t,i){function n(){this._deferredActionQueue=new a,this._taxCollectors=null,this._worldmap=null,s.on("taxCollectorList",this.onTaxCollectorsList.bind(this))}function o(e,t){if(!t)return!1;for(var i=e.complements||[],n=0;n<i.length;n+=1){var o=i[n];if("TaxCollectorGuildInformations"===o._type&&o.guild.guildId!==t.guildId)return!1}return!0}var s=i(475),a=i(1019),r=i(29).getText;e.exports=n,n.prototype.onTaxCollectorsList=function(){function e(){t._taxCollectors=s.entities[s.entityType.taxCollector];for(var e in t._taxCollectors){var i=t._taxCollectors[e];if(o(i,window.gui.playerData.guild.current)){var n=t.getIconInfo(i);t._worldmap.addIcon(n,"icon_"+n.gfx)}}}var t=this;this._worldmap?e():this._deferredActionQueue.enqueue(e)},n.prototype.setWorldMap=function(e){this._worldmap=e,this._deferredActionQueue.signal()},n.prototype.getIconInfo=function(e){return{id:"tax_"+e.worldX+"_"+e.worldY,x:e.worldX,y:e.worldY,subAreaId:e.subAreaId,categoryId:7,gfx:"1003",nameId:r("ui.common.taxCollector")}}},function(e,t,i){function n(){function e(){t.setTitle(t.tabsDefinitions[this.tabId].title)}s.call(this,{className:"SocialWindow",positionInfo:{top:40,left:80,right:40,bottom:40}});var t=this;this.closedWithGuildFightLeaveRequest=!1;var i=["friends","guild","alliance","spouse","directory"],n=this.tabsDefinitions={friends:{target:new d},guild:{target:new u},alliance:{target:new l},spouse:{target:new h},directory:{target:new p}},o=this.windowBody;this.tabs=o.appendChild(new f);for(var a=0;a<i.length;a+=1){var c=i[a],m=n[c],_=o.appendChild(m.target);_.tabId=c,this.tabs.addTab("",_,c),_.on("open",e)}this._initTabs(),this.on("open",function(e){this.tabs.openTab(e.tabId,e.tabParams,{delayOpenedEvent:!0,forceOpen:!0})}),this.on("opened",function(){this.tabs.emitOnCurrentTab("opened")}),this.on("close",function(){var e,t=window.gui.playerData.id;e=r.isPlayerDefending(r.entityType.taxCollector,t),e&&r.playerAutoKick(r.entityType.taxCollector,e),e=r.isPlayerDefending(r.entityType.prism,t),e&&r.playerAutoKick(r.entityType.prism,e),this._resetTabs()}),g.on("gameContextChanged",this.onGameContextChanged.bind(this)),this._setupEvents()}i(1023);var o=i(172).inherits,s=i(541),a=i(29).getText,r=i(475),l=i(1024),c=i(950),d=i(1035),u=i(1037),h=i(1049),p=i(1051),m=i(194),f=i(889),g=i(258);o(n,s),e.exports=n,n.prototype.onGameContextChanged=function(){g.isFightMode&&m.close(this.id)},n.prototype._initTabs=function(){var e=this.tabsDefinitions;e.friends.title=a("ui.common.friends"),e.guild.title=a("ui.common.guild"),e.alliance.title=a("ui.common.alliance"),e.spouse.title=a("ui.common.spouse"),e.directory.title=a("ui.common.directory");for(var t in e){var i=window.gui.uiLocker.isTabAvailable("social",t);this.tabs.toggleTabAvailability(t,i)}},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=window.dofus.connectionManager;window.gui.uiLocker.on("updated",function(t){if("social"===t.windowId&&t.tabId)return e.tabsDefinitions[t.tabId]?void e.tabs.toggleTabAvailability(t.tabId,!t.locked):console.error(new Error("Unknown tab id `"+t.tabId+"` in social window."))}),i.on("ClientUIOpenedMessage",function(t){e._clientUiOpen(t.type)}),i.on("ClientUIOpenedByObjectMessage",function(t){e._clientUiOpen(t.type)}),t.on("disconnect",function(){e._resetTabs(),e._initTabs()})},n.prototype._clientUiOpen=function(e){if(window.gui.playerData.guild.hasGuild()){var t;switch(e){case c.CLIENT_UI_TELEPORT_GUILD_PADDOCK:t="paddocks";break;case c.CLIENT_UI_TELEPORT_GUILD_HOUSE:t="houses";break;default:return}this.openState?(this.tabs.openTab("guild",{tabId:t}),m.focusWindow(this.id)):m.open(this.id,{tabId:"guild",tabParams:{tabId:t}})}},n.prototype.updateWindowTitle=function(e,t){var i=this.tabsDefinitions[e];if(i){i.title=t;var n=this.tabs.getCurrentTabId();n===e&&this.setTitle(t)}},n.prototype.getOpenedTabId=function(){return this.tabs.getCurrentTabId()},n.prototype._resetTabs=function(){this.tabs.close()}},function(e,t){},function(e,t,i){function n(){l.call(this,"div",{className:"AllianceTab",name:"alliance"});var e=this;this.once("open",function(){this._createDom(),window.gui.playerData.alliance.on("allianceUpdated",function(t){e._updateAllianceInformation();var i=e.tabs.tabMap;for(var n in i)i[n].content.emit("allianceUpdated",t)})}),this.on("open",function(e){e=e||{};var t=e.tabId||"guilds";this.tabs.openTab(t),this._guilds.emit("allianceUpdateRequested"),window.dofus.sendMessage("AllianceInsiderInfoRequestMessage"),window.dofus.sendMessage("PrismsListRegisterMessage",{listen:u.PRISM_LISTEN_MINE})}),this.on("close",function(){this.tabs.close()})}i(1025);var o=i(583),s=i(172).inherits,a=i(29).getText,r=i(563),l=i(321),c=i(422),d=i(339),u=i(1026),h=i(197),p=i(194),m=i(1027),f=i(1029),g=i(1031);s(n,l),e.exports=n,n.prototype._updateAllianceInformation=function(){var e=window.gui.playerData.alliance.current;this._updateAllianceCreationData(e),this.emblem.setValue(e.allianceEmblem,!0);var t=p.getWindow("social");t.updateWindowTitle("alliance",a("ui.common.alliance")+" - "+e.allianceName),this.tag.setText("["+e.allianceTag+"]"),this.members.setText(a("ui.alliance.membersInGuilds",e.nbMembers,e.guildCount,e.guildCount))},n.prototype._updateAllianceCreationData=function(e){var t=d.getAlmanaxDate(1e3*e.creationDate);this.creationDate.setText(t.day+" "+t.monthName+" "+t.year)},n.prototype._createDom=function(){this._buildHeader(),this._buildTabs()},n.prototype._buildHeader=function(){var e=this.createChild("div",{className:"description"}),t=e.createChild("div",{className:["column","title"]}),i=e.createChild("div",{className:["column","content"]}),n=e.createChild("div",{className:["column","emblem"]});this.emblem=n.appendChild(new c({width:70,height:70})),t.createChild("div",{text:a("ui.alliance.tag")+":"}),this.tag=i.createChild("div",{className:"link"}),h(this.tag),this.tag.on("tap",function(){o.openAllianceCard(window.gui.playerData.alliance.current.allianceId)}),t.createChild("div",{text:a("ui.common.creationDate")+":"}),this.creationDate=i.createChild("div"),t.createChild("div",{text:a("ui.common.members")+":"}),this.members=i.createChild("div")},n.prototype._buildTabs=function(){var e=this.tabs=this.appendChild(new r);this._guilds=new m,e.addTab(a("ui.social.guilds"),this._guilds,"guilds"),e.addTab(a("ui.common.conquest"),new f,"conquests"),e.addTab(a("ui.common.attacks"),new g,"attacks")}},function(e,t){},function(e,t){e.exports={PRISM_LISTEN_NONE:0,PRISM_LISTEN_MINE:1,PRISM_LISTEN_ALL:2}},function(e,t,i){function n(){_.call(this,"div",{className:"GuildsTab"}),this._createDom(),this.on("allianceUpdated",function(e){this.table.clearContent(),this.table.addList(e.guilds),this.table.setContentLoading(!1)}),this.on("allianceUpdateRequested",function(){this.table.setContentLoading(!0)});var e=this;window.gui.playerData.alliance.on("guildLeft",function(t){e.table.delRow(t)}),this.on("open",function(){this._updateAvaMode()})}function o(e,t,i){var n=new g({className:"kick"},function(){if(t.allianceLeader&&e.guildCount>1)return window.gui.openSimplePopup(u("ui.alliance.guildLeaderCantBeBanned"));var n=i?u("ui.alliance.quitConfirm"):u("ui.alliance.kickConfirm",t.guildName);window.gui.openConfirmPopup({title:u("ui.popup.warning"),message:n,cb:function(e){e&&window.dofus.sendMessage("AllianceKickRequestMessage",{kickedId:t.guildId})}})});return l(n,u("ui.alliance.kickGuild")),n}function s(e){var t=new g({className:"leader"},function(){window.gui.openConfirmPopup({title:u("ui.popup.warning"),message:u("ui.alliance.giveLeadershipConfirm",e.guildName),cb:function(t){t&&window.dofus.sendMessage("AllianceChangeGuildRightsMessage",{guildId:e.guildId,rights:r.ALLIANCE_RIGHT_BOSS})}})});return l(t,u("ui.alliance.giveLeadership")),t}i(1028);var a=i(474),r=i(488),l=i(337).addTooltip,c=i(612),d=i(422),u=i(29).getText,h=i(478),p=i(172).inherits,m=i(539),f=i(197),g=i(335),_=i(321);p(n,_),e.exports=n,n.prototype._updateAvaMode=function(){var e=window.gui.playerData.characterBaseInformations,t=!1;if(e.level>=50){this.avaMode.enable();var i=window.gui.playerData.characters.mainCharacter.characteristics.alignmentInfos.aggressable;t=i===a.AvA_ENABLED_AGGRESSABLE||i===a.AvA_ENABLED_NON_AGGRESSABLE||i===a.AvA_DISQUALIFIED||i===a.AvA_PREQUALIFIED_AGGRESSABLE;var n=this.avaMode.isActivate();n!==t&&this.avaMode.toggleActivation(t)}else this.avaMode.disable()},n.prototype._createDom=function(){function e(e){var t=new _("div",{className:"nameBox"}),i=t.createChild("div",{text:e.guildName,className:"link"});f(i),i.on("tap",function(){h.openGuildCard(e.guildId)});var n=t.createChild("div");return f(n),n.on("tap",function(){window.gui.openContextualMenu("player",{playerName:e.leaderName,playerId:e.leaderId,hasGuild:!0})}),n.createChild("span",{text:u("ui.guild.leadBy","")}),n.createChild("span",{text:e.leaderName,className:"link"}),t}function t(e){var t=new _("div",{className:"memberBox"}),i=t.createChild("div",{text:u("ui.guild.onlineMembers",e.nbConnectedMembers,e.nbMembers)});if(0===e.nbConnectedMembers&&e.lastActivity>0){var n,o=e.getHoursSinceLastConnection(),s=Math.floor(o/720),a=Math.floor((o-720*s)/24);n=s>0?a>0?u("ui.social.monthsAndDaysSinceLastConnection",s,a,a):u("ui.social.monthsSinceLastConnection",s,s):a>0?u("ui.social.daysSinceLastConnection",a,a):u("ui.social.lessThanADay"),l(i,u("ui.social.lastConnection",n))}return t.createChild("div",{text:e.nbTaxCollectors+" "+u("ui.social.guildTaxCollectors")}),t}function i(e){var t,i=e.leaderId===g;return p?(t=new _("div",{className:"buttonBox"}),t.appendChild(o(r,e,i)),i||t.appendChild(s(e))):i?(t=new _("div",{className:"buttonBox"}),t.appendChild(o(r,e,!0))):t="",t}function n(e){var t=new d({width:50,height:50});return t.setValue({guild:e}),t}var a=window.gui.playerData,r=a.alliance.current,p=a.alliance.isBoss(),g=a.id;this.table=this.appendChild(new m([{id:"emblem",format:n},{id:"guildName",header:u("ui.common.name"),format:e,defaultSorter:!0,sort:!0},{id:"guildLevel",header:u("ui.common.level"),sort:!0},{id:"nbMembers",header:u("ui.common.members"),format:t,sort:!0},{id:"actions",format:i}],"guildId",{clickable:!1})),this.avaMode=this.appendChild(new c(u("ui.alliance.activateAvA"))),this.avaMode.on("change",function(e){window.dofus.sendMessage("SetEnableAVARequestMessage",{enable:e})})}},function(e,t){},function(e,t,i){function n(){g.call(this,"div",{className:"ConquestsTab"}),this.once("open",function(){this._createDom(),this._setupEvents(),this._updateConquests()})}function o(e,t){var i=new f({className:"settings"},function(){m.open("prismVulnerabilityDate",{prism:e,vulnerableTime:t})});return s(i,null,l("ui.prism.changeVulnerabilityHour")),i}i(1030);var s=i(337).addTooltip,a=i(583),r=i(478),l=i(29).getText,c=i(478).GuildRightsBitEnum,d=i(172).inherits,u=i(485),h=i(539),p=i(28),m=i(194),f=i(335),g=i(321);d(n,g),e.exports=n,n.prototype._setupEvents=function(){function e(){var e=window.gui.playerData.position.subAreaId;t.table.hasRow(e)?t.table.selectRow(e):t.table.unSelectRow()}var t=this;this.on("open",e);var i=window.gui.playerData.alliance;i.on("prismUpdatedList",function(i){t.table.updateRows(i),t._updateConquests(),e()}),i.on("prismDeletedList",function(i){t.table.delRows(i),t._updateConquests(),e()}),this.on("allianceUpdated",function(t){this.table.clearContent(),this.table.addMap(t.prisms),this._updateConquests(),this.table.setContentLoading(!1),e()}),this.on("allianceUpdateRequested",function(){this.table.setContentLoading(!0)}),this.table.addMap(i.current.prisms),e()},n.prototype._createDom=function(){function e(e){var t,i=e.prism,a=new p.DofusDate(i.nextVulnerabilityDate),d=a.getServerDate(),h=d.toString().time,m=n.guild.hasRight(c.GUILD_RIGHT_SET_ALLIANCE_PRISM);if(i.state!==u.PRISM_STATE_INVULNERABLE&&i.state!==u.PRISM_STATE_NORMAL||!m)t=h;else{t=new g("div",{className:"timeSetting"});var f=t.createChild("div",{text:h}),_=r.guilds[i.lastTimeSlotModificationAuthorGuildId];_&&s(f,l("ui.prism.lastVulnerabilityChange",new p.DofusDate(i.lastTimeSlotModificationDate).getLocalDate().toString().date,i.lastTimeSlotModificationAuthorName,_.guildName)+"\n"+l("ui.prism.serverVulnerabilityHour")+" : "+h+"\n"+l("ui.prism.localVulnerabilityHour")+" : "+a.getLocalDate().toString().time),t.appendChild(o(e,a))}return t}function t(e){var t=e.prism,i=new g("div",{text:a.prismState[t.state]}),n=a.getPrismStateInfo(t.state,1e3*t.nextVulnerabilityDate-Date.now());return s(i,n),i}function i(e){var t=e.enrichData,i=new g("div",{text:t.subAreaName+" ("+t.areaName+")"});return s(i,l(t.isConquestVillage?"ui.zaap.village":"ui.zaap.prism")),i}this.conquestsInfo=this.createChild("div",{className:"conquestsInfo"});var n=window.gui.playerData;this.table=this.appendChild(new h([{id:"subArea",header:l("ui.map.subarea"),format:i,getContent:function(e){return e.enrichData.subAreaName},sort:!0,defaultSorter:!0},{id:"worldX",header:l("ui.common.coordinatesSmall"),format:function(e){return e.worldX+","+e.worldY},sort:!0},{id:"placementDate",header:l("ui.social.guild.taxStartDate"),format:function(e){return new p.DofusDate(e.prism.placementDate).getServerDate().toString().date},getContent:function(e){return e.prism.placementDate},sort:!0},{id:"state",header:l("ui.common.state"),format:t,getContent:function(e){return e.prism.state},sort:!0},{id:"nextVulnerabilityDate",header:l("ui.prism.startVulnerability"),format:e,getContent:function(e){return e.prism.nextVulnerabilityDate},sort:!0}],"subAreaId",{clickable:!1}))},n.prototype._updateConquests=function(){var e=window.gui.playerData,t=e.alliance.current.prisms,i=0,n=0;for(var o in t){var s=t[o];s.mapId<=-1||(s.enrichData.isConquestVillage?n+=1:i+=1)}0===i&&0===n?this.conquestsInfo.setText(l("ui.alliance.noArea")):i>0&&0===n?this.conquestsInfo.setText(l("ui.alliance.nbAreas",i,i)):0===i&&n>0?this.conquestsInfo.setText(l("ui.alliance.nbVillages",n,n)):this.conquestsInfo.setText(l("ui.alliance.nbAreasAndVillages",i,n,n+i))}},function(e,t){},function(e,t,i){function n(){v.call(this,"div",{className:"AttacksTab"}),this.once("open",function(){this._createDom(),this._setupEvents()}),this.on("open",function(){this._loadCurrentPrismFight(),this._updateFightCount(),window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:p.INFO_TAX_COLLECTOR_ALLIANCE})}),this.on("close",function(){this.table.clearContent(),window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:p.INFO_TAX_COLLECTOR_LEAVE})})}function o(e){var t=e.remainSeconds,i=e.totalWaitTime,n=i-t;e.setValue(n/i)}function s(e){clearInterval(e.intervalId),e.intervalId=null}function a(e,t){e.totalWaitTime=Math.round(t.waitTimeForPlacement/10)||1,e.remainSeconds=Math.round(t.timeLeftBeforeFight/10)||0,e.intervalId=setInterval(function(){e.remainSeconds-=1,e.remainSeconds>0?o(e):s(e)},1e3),o(e)}function r(e){var t;if(e.type===y.prism){var i=u.getAttackedEntity(e),n=i.enrichData;t=n.isConquestVillage?"village":"prism"}else t=e.type;return new v("div",{className:["type",t]})}function l(e){var t=u.getAttackedEntity(e),i=t.enrichData,n=new v("div",{className:"target"});return n.createChild("div",{text:t.getName()}),n.createChild("div",{text:i.subAreaName+" "+t.getPosition()}),e.type===y.prism?n.createChild("div",{text:h("ui.prism.placed",t.getPlacementDate())}):n.createChild("div",{className:"owner",text:h("ui.common.guild")+h("ui.common.colon")+t.getGuild().guildName}),n}function c(e){var t=new f({vertical:!0,className:["green","timer"]});return e.waitingForHelpInfo&&a(t,e.waitingForHelpInfo),t.on("destroy",function(){s(t)}),t}function d(e){var t=u.getAttackedEntity(e),i=new m;return i.setFight(e.type,e),t.look&&i.setTarget({id:e.id,entityLook:t.look,name:t.getName(),level:t.level}),i.on("slotTap",w[e.type]),i}i(1032);var u=i(475),h=i(29).getText,p=i(640),m=i(1033),f=i(557),g=i(172).inherits,_=i(539),v=i(321),y=u.entityType,b=u.fightingSide,M=u.fightState;g(n,v);var w={};w[y.prism]=function(e){var t=this.fight;if(t.state===u.fightState.waitingForHelp){var i=t.id,n=window.gui.playerData.id;u.isPlayerFightingFor(n,y.prism,i,b.allies)?e&&n===e.id&&window.dofus.sendMessage("PrismFightJoinLeaveRequestMessage",{subAreaId:i,join:!1}):e&&5===t.fighters[b.allies].length?window.dofus.sendMessage("PrismFightSwapRequestMessage",{subAreaId:i,targetId:e.id}):window.dofus.sendMessage("PrismFightJoinLeaveRequestMessage",{subAreaId:i,join:!0})}},w[y.taxCollector]=function(e){var t=this.fight;if(t.state===u.fightState.waitingForHelp){var i=t.id,n=window.gui.playerData.id;u.isPlayerFightingFor(n,y.taxCollector,i,b.allies)?e&&n===e.id&&window.dofus.sendMessage("GuildFightLeaveRequestMessage",{taxCollectorId:i,characterId:n}):e&&5===t.fighters[b.allies].length?window.dofus.sendMessage("GuildFightTakePlaceRequestMessage",{taxCollectorId:i,replacedCharacterId:e.id}):window.dofus.sendMessage("GuildFightJoinRequestMessage",{taxCollectorId:i})}},n.prototype._createDom=function(){this.table=this.appendChild(new _([{id:"type",format:r},{id:"target",header:h("ui.common.name")+" / "+h("ui.common.localisation"),format:l},{id:"timer",format:c},{id:"fightersInfo",header:h("ui.common.defenders")+" / "+h("ui.common.attackers"),format:d}],"id",{clickable:!1})),this.currentFights=this.createChild("div",{className:"currentFights"}),this.createChild("div",{className:"howTo",text:h("ui.alliance.howToDefend")})},n.prototype._updateFightCount=function(){var e=this.table.getRowCount();this.currentFights.setText(h("ui.alliance.currentFights",e,e))},n.prototype._loadCurrentPrismFight=function(){var e=u.fights.prism;for(var t in e){var i=e[t];i.state===M.waitingForHelp&&(this.table.hasRow(i.id)||this.table.addRow(i))}},n.prototype._setupEvents=function(){function e(e){t.isVisible()&&t.table.hasRow(e)&&(t.table.delRow(e),t._updateFightCount())}var t=this;u.on("fightStarted",function(e,i){t.isVisible()&&i.state===M.waitingForHelp&&(t.table.addRow(i),t._updateFightCount())}),u.on("fighting",function(t,i){e(i.id)}),u.on("fightEnded",function(t,i){e(i)}),u.on("fighterList",function(e,i,n,o){t.isVisible()&&t.table.hasRow(i)&&t.table.getCell(i,"fightersInfo").setFighters(n,o)}),u.on("fighterJoined",function(e,i,n,o,s){t.isVisible()&&t.table.hasRow(i)&&t.table.getCell(i,"fightersInfo").setFighter(n,o,s)}),u.on("fightTarget",function(e,i,n){t.isVisible()&&e===y.prism&&t.table.hasRow(i)&&t.table.getCell(i,"fightersInfo").setTarget({id:n.id,entityLook:n.look,name:n.getName(),level:n.level})}),u.on("fighterLeft",function(e,i,n,o,s){t.isVisible()&&t.table.hasRow(i)&&t.table.getCell(i,"fightersInfo").removeFighter(n,s)})},e.exports=n},function(e,t){},function(e,t,i){function n(){l.call(this,"div",{className:"FightersInfo"});var e,t=this.allies={},i=this.enemies={},n=this.createChild("div",{className:"fighterRow"}),o=this.createChild("div",{className:"fighterRow"});e=t.icon=n.createChild("div",{className:["fightMode","defend","hidden"]}),this._addFightModeToolTip(e,u("ui.common.defenders"),"allies"),e=i.icon=o.createChild("div",{className:["fightMode","attack","hidden"]}),this._addFightModeToolTip(e,u("ui.common.attackers"),"enemies");var s=t.slotContainer=n.createChild("div",{className:"fighterList"}),a=i.slotContainer=o.createChild("div",{className:"fighterList"});this.targetSlot=s.appendChild(this._createTargetDisplay());for(var r,c=t.slots=[],d=i.slots=[],h=0;h<m;h+=1)r=s.appendChild(this._createFighterSlot(!0)),c.push(r),r=a.appendChild(this._createFighterSlot()),d.push(r)}function o(e){var t=e.name+" ("+u("ui.common.short.level")+" "+e.level+") ";switch(e._type){case"CharacterMinimalAllianceInformations":t+=e.guild.guildName+" - ["+e.alliance.allianceTag+"]";break;case"CharacterMinimalGuildInformations":t+=e.guild.guildName}return t}function s(e,t){e.fighter=t,h.enableTooltip(e,!0),e.setLook(t.entityLook,{riderOnly:!0,direction:d.DIRECTION_SOUTH_WEST,animation:"AnimArtwork",boneType:"timeline/",skinType:"timeline/"})}function a(e){e.fighter=null,e.clear(),console.log("CLEARING SLOT!"),h.enableTooltip(e,!1)}i(1034);var r=i(172).inherits,l=i(321),c=i(369),d=i(410),u=i(29).getText,h=i(337),p=i(475).fightingSide,m=5;r(n,l),e.exports=n,n.prototype._addFightModeToolTip=function(e,t,i){var n=this;h.addTooltip(e,function(){var e=t+u("ui.common.colon")+"\n",s=n[i].slots;if("allies"===i){var a=n.targetSlot.fighter;e+=a.name+" ("+u("ui.common.short.level")+" "+a.level+")\n"}for(var r=0;r<s.length;r+=1){var c=s[r].fighter;c&&(e+=o(c)+"\n")}return new l("div",{text:e})})},n.prototype._createTargetDisplay=function(){var e=new c({className:"fighterIcon",scale:"fitin"});return h.addTooltip(e,function(){var t=e.fighter;return new l("div",{text:t.name+" ("+u("ui.common.short.level")+" "+t.level+")"})}),h.enableTooltip(e,!1),e},n.prototype._createFighterSlot=function(e){var t=new c({className:"fighterIcon",scale:"fitin"});if(h.addTooltip(t,function(){return new l("div",{text:o(t.fighter)})}),h.enableTooltip(t,!1),!e)return t;var i=this;return t.on("tap",function(){i.fight&&i.emit("slotTap",this.fighter)}),t},n.prototype.reset=function(){this.fight=null,this.allies.icon.addClassNames("hidden"),this.enemies.icon.addClassNames("hidden"),a(this.targetSlot);for(var e=this.allies.slots,t=this.enemies.slots,i=0;i<m;i+=1)a(e[i]),a(t[i])},n.prototype.setTarget=function(e){s(this.targetSlot,e)},n.prototype.setFight=function(e,t){this.type=e,this.fight=t,this.allies.icon.delClassNames("hidden"),this.enemies.icon.delClassNames("hidden");var i=t.fighters;this.setFighters(p.allies,i.allies),this.setFighters(p.enemies,i.enemies)},n.prototype.setFighter=function(e,t,i){s(this[e].slots[i],t)},n.prototype.removeFighter=function(e,t){var i=this[e].slots,n=i.splice(t,1)[0];a(n),this[e].slotContainer.appendChild(n),i.push(n)},n.prototype.setFighters=function(e,t){for(var i=this[e].slots,n=0;n<m;n+=1){var o=t[n];o?s(i[n],o):a(i[n])}}},function(e,t){},function(e,t,i){function n(){function e(e,t,i,n){window.gui.openConfirmPopup({title:h("ui.common.confirm"),message:h("tablet.ui.social.playerRemoveConfirmation",i),cb:function(i){i&&window.dofus.sendMessage(e,{accountId:t,session:n})}})}d.call(this,"div",{className:"FriendsWindow",name:"friends"});var t=this;this.ListAddFailureEnum={0:h("ui.common.unknownFail"),1:h("ui.social.friend.addFailureListFull"),2:h("ui.social.friend.addFailureNotFound"),3:h("ui.social.friend.addFailureEgocentric"),4:h("ui.social.friend.addFailureAlreadyInList")},this.tables={},this.tableParams={colIds:["playerIcon","name","level","guild","achievement","stateIcon","button"],headerContent:["",h("ui.common.name"),h("ui.common.level"),h("ui.common.guild"),h("ui.achievement.achievement")],onRowTap:function(){window.gui.tooltipBox.closeTooltip()}},this.deleteTapCallback={friends:function(t,i){e("FriendDeleteRequestMessage",t,i)},enemies:function(t,i){e("IgnoredDeleteRequestMessage",t,i,!1)},ignored:function(t,i){e("IgnoredDeleteRequestMessage",t,i,!0)}},this.once("open",function(){t._createDom(),t._setupEvents();var e=window.gui.playerData.socialData;for(var i in e.ignoredList)t.addPlayer(e.ignoredList[i],"ignored")}),this.on("open",function(e){e=e||{},t.tabs.openTab(e.tabId||0),t.tables.friends.clearContent(),t.tables.enemies.clearContent(),window.dofus.sendMessage("FriendsGetListMessage"),window.dofus.sendMessage("IgnoredGetListMessage")})}function o(e,t,i){var n=e.createChild("div",{className:"addCharacter"}),o=n.createChild("div",{text:h("ui.common.addSomeone"),className:"addLabel"}),s=n.appendChild(new p({text:h("ui.common.add"),className:["addButton","greenButton"]})),a=n.appendChild(new g({className:"addInput",attr:{type:"text"}}));return s.on("tap",function(){var e=a.rootElement.value;if(e){var n={name:e};i&&(n.session=i),window.dofus.sendMessage(t,n),a.rootElement.value=""}}),{addCharacterArea:n,label:o,textInput:a,button:s}}function s(e,t){if(e.showRows(),!t){for(var i=e.getRowCount(),n=[],o=0;o<i;o++){var s=e.getRow(o);s.isConnected||(s.hide(),n.push(o))}e.hideRows(n)}}function a(e,t){if(!e.hasOwnProperty("breed"))return console.error(new Error("Friends loadHeadImage: player has no breed")),void t.setStyle("backgroundImage",null);var i="gfx/heads/SmallHead_"+e.breed+(e.sex?1:0)+".png";_.preloadImage(i,function(e){t.setStyle("backgroundImage",e)})}function r(e){var t="FriendOnlineInformations"===e._type;return{isConnected:t,accountId:e.accountId,characterId:e.playerId,name:e.playerName||e.accountName,nameText:e.accountName+(e.playerName?" ("+e.playerName+")":""),
lastConnection:e.lastConnection}}function l(){var e=this.myRow;e.isConnected?window.gui.openContextualMenu("player",{playerId:e.id,accountId:e.accountId,playerName:e.name}):window.gui.openContextualMenu("offlinePlayer",{playerId:e.id,playerName:e.name,hoursSinceLastConnection:e.lastConnection})}i(1036);var c=i(172).inherits,d=i(321),u=i(563),h=i(29).getText,p=i(335),m=i(649),f=i(612),g=i(530),_=i(182),v=i(176),y=i(619),b=i(425);c(n,d),e.exports=n,n.prototype._createDom=function(){var e=this.tabs=this.appendChild(new u);this.friendsPanel=this.createChild("div",{className:["mainPanel","friendsPanel"]}),this.enemiesPanel=this.createChild("div",{className:["mainPanel","enemiesPanel"]}),this.ignoredPanel=this.createChild("div",{className:["mainPanel","ignoredPanel"]}),e.addTab(h("ui.common.friends"),this.friendsPanel,"friends"),e.addTab(h("ui.common.enemies"),this.enemiesPanel,"enemies"),e.addTab(h("ui.common.ignoreds"),this.ignoredPanel,"ignoreds"),e.openTab(0),this._buildFriendsPanel(),this._buildEnemiesPanel(),this._buildIgnoredPanel()},n.prototype._buildFriendsPanel=function(){var e=this,t=this.friendsPanel;o(t,"FriendAddRequestMessage"),this.tables.friends=t.appendChild(new m(this.tableParams));var i=v.getValue("showFriendOffline",!0),n=t.createChild("div",{className:"checkBoxes"});this.showFriendOfflineCheckbox=n.appendChild(new f(h("ui.social.showOfflinePerson"),i));var a=n.appendChild(new f(h("ui.social.warnWhenFriendsComeOnline"),window.gui.playerData.socialData.onConnectNotification));this.showFriendOfflineCheckbox.on("change",function(t){s(e.tables.friends,t),v.setValue("showFriendOffline",t)}),a.on("change",function(e){window.dofus.sendMessage("FriendSetWarnOnConnectionMessage",{enable:e})})},n.prototype._buildEnemiesPanel=function(){var e=this,t=this.enemiesPanel;o(t,"IgnoredAddRequestMessage",!1),this.tables.enemies=t.appendChild(new m(this.tableParams));var i=v.getValue("showEnemyOffline",!0),n=t.createChild("div",{className:"checkBoxes"});this.showEnemyOfflineCheckbox=n.appendChild(new f(h("ui.social.showOfflinePerson"),i)),this.showEnemyOfflineCheckbox.on("change",function(t){s(e.tables.enemies,t),v.setValue("showEnemyOffline",t)})},n.prototype._buildIgnoredPanel=function(){o(this.ignoredPanel,"IgnoredAddRequestMessage",!0),this.tables.ignored=this.ignoredPanel.appendChild(new m(this.tableParams))},n.prototype._updateStateIcon=function(e,t){var i=e.getChild("stateIcon").getChild("stateIcon");if(i.delClassNames("offline","fight","smiley"),i.getStyle("backgroundImage")&&i.setStyle("backgroundImage",""),i.clearContent(),i.hide(),!e.isConnected)return i.addClassNames("offline"),void i.show();var n;if(t.hasOwnProperty("moodSmileyId")&&t.moodSmileyId>0){n=t.moodSmileyId;var o=window.gui.databases.Smileys[n];if(!o)return console.error("Smiley "+n+" details are not available, it could not be displayed");i.addClassNames("smiley"),_.preloadImage("gfx/smilies/"+o.gfxId+".png",function(e){i.rootElement&&(i.setStyle("backgroundImage",e),i.show())})}t.playerState===y.GAME_TYPE_FIGHT&&(n?i.appendChild(new d("div",{className:"smallFight"})):(i.addClassNames("fight"),i.show()))},n.prototype._updatePlayerRow=function(e,t){for(var i=this.tables[e],n=i.getRows(),o=0;o<n.length;o++){var s=n[o];if(s.accountId===t.accountId){i.updateRow(o,{level:t.level||"?",guild:t.guildInfo?t.guildInfo.guildName:"?",achievement:t.achievementPoints>0?t.achievementPoints:"-"},r(t));var l=s.isConnected;s.toggleClassName("offline",!l);var c=s.getChild("playerIcon").getChild("playerIcon");if(t.status){var d=c.getChild("onlineStatusIcon");d.setClassNames("onlineStatusIcon","status"+t.status.statusId)}var u=s.getChild("name").getChild("name");u.setText(s.nameText);var h=c.getChild("alignmentSide").getChild("headIcon");return l&&!h.getStyle("backgroundImage")&&a(t,h),void this._updateStateIcon(s,t)}}},n.prototype._setupEvents=function(){var e=this,t=window.gui.playerData.socialData;window.gui.on("disconnect",function(){e.tables.ignored.clearContent()}),t.on("friendUpdate",function(t){e._updatePlayerRow("friends",t);var i=v.getValue("showFriendOffline",!0);s(e.tables.friends,i)}),t.on("ignoredUpdate",function(t){e._updatePlayerRow("ignored",t)}),t.on("enemyUpdate",function(t){e._updatePlayerRow("enemies",t)}),t.on("newFriendList",function(){var i=t.friendsList;for(var n in i)e.addPlayer(i[n],"friends");var o=e.showFriendOfflineCheckbox;o.isActivate()?o.activate():o.deactivate()}),t.on("newEnemyList",function(){var i=t.enemiesList;for(var n in i)e.addPlayer(i[n],"enemies");var o=e.showEnemyOfflineCheckbox;o.isActivate()?o.activate():o.deactivate()}),t.on("friendAdded",function(t){e.addPlayer(t,"friends")}),t.on("ignoredAdded",function(t){e.addPlayer(t,"ignored")}),t.on("enemyAdded",function(t){e.addPlayer(t,"enemies")}),t.on("friendDeleted",function(t){e.deletePlayer(t,"friends")}),t.on("ignoredDeleted",function(t){e.deletePlayer(t,"ignored")}),t.on("enemyDeleted",function(t){e.deletePlayer(t,"enemies")})},n.prototype.addPlayer=function(e,t){var i=this,n=this.tables[t],o=e.guildInfo?e.guildInfo.guildName:"?",s=window.gui.playerData.alignment,c=new p({name:"deleteButton",className:"greenButton"});c.on("tap",function(){i.deleteTapCallback[t](this.accountId,this.playerName)}),c.accountId=e.accountId,c.playerName=e.playerName||e.accountName;var u=e.achievementPoints>0?e.achievementPoints:"-",h=new p({name:"playerIcon",className:"playerIcon"},l);h.createChild("div",{name:"onlineStatusIcon",className:["onlineStatusIcon",e.status?"status"+e.status.statusId:""]});var m=h.createChild("div",{name:"alignmentSide",className:"alignmentSide"});e.alignmentSide!==b.ALIGNMENT_ANGEL&&e.alignmentSide!==b.ALIGNMENT_EVIL||s.getSmallWingsUrl(e.alignmentSide,function(e){m.rootElement&&m.setStyle("backgroundImage",e)});var f=m.createChild("div",{className:"playerHead",name:"headIcon"}),g=new p({name:"name",text:" "},l),_=n.addRow({playerIcon:h,name:g,level:e.level?e.level:"?",guild:o,achievement:u,stateIcon:new d("div",{name:"stateIcon",className:"stateIcon"}),button:c},r(e));h.myRow=_,g.myRow=_,g.setText(_.nameText);var v=_.isConnected;_.toggleClassName("offline",!v),this._updateStateIcon(_,e),v&&a(e,f)},n.prototype.deletePlayer=function(e,t){var i=this.tables[t],n=i.getRows();e=parseInt(e,10);for(var o=0;o<n.length;o++)if(n[o].accountId===e)return i.delRow(o)}},function(e,t){},function(e,t,i){function n(){r.call(this,"div",{className:"GuildWindow",name:"guild"});var e=this;this.openedTabId=null,this.once("open",function(){e._setupDom(),e._setupEvents()}),this.on("open",function(t){t=t||{},window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:g.INFO_GENERAL}),this.openedTabId=t.tabId||"members",e.tabs.openTab(this.openedTabId,null,{forceOpen:!0})}),this.on("close",function(){this._resetTabs()})}i(1038);var o=i(172).inherits,s=i(29).getText,a=i(563),r=i(321),l=i(337).addTooltip,c=i(1039),d=i(1041),u=i(1043),h=i(1045),p=i(1047),m=i(557),f=i(422),g=i(640),_=i(339),v=i(194);o(n,r),e.exports=n,n.prototype._buildGuildGeneralInfoArea=function(){var e=this.createChild("div",{className:"guildGeneralInfo"}),t=e.createChild("div",{className:["column","title"]}),i=e.createChild("div",{className:["column","content"]}),n=e.createChild("div",{className:["column","emblem"]});this.emblem=n.appendChild(new f({width:70,height:70})),this.level=t.createChild("div"),t.createChild("div",{className:"member",text:s("ui.common.members")+":"}),t.createChild("div",{text:s("ui.common.creationDate")+":"}),this.levelBar=i.appendChild(new m({className:"yellow"})),l(this.levelBar,function(){var e=window.gui.playerData.guild.current,t=_.intToString(e.experience||0),i=_.intToString(e.expNextLevelFloor||0);return new r("div",{text:t+" / "+i})}),this.membersValue=i.createChild("div",{className:"memberValue"}),this.creationDateValue=i.createChild("div")},n.prototype._setupDom=function(){function e(){window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:this.id})}this._buildGuildGeneralInfoArea(),this.tabs=this.appendChild(new a);var t=new c({className:"panel"}),i=new u({className:"panel"}),n=new p,o=new h({className:"panel"}),r=new d;t.id=g.INFO_MEMBERS,i.id=g.INFO_BOOSTS,n.id=g.INFO_TAX_COLLECTOR_GUILD_ONLY,o.id=g.INFO_PADDOCKS,r.id=g.INFO_HOUSES,this.tabs.addTab(s("ui.common.members"),t,"members"),this.tabs.addTab(s("ui.social.guildBoosts"),i,"customisation"),this.tabs.addTab(s("ui.social.guildTaxCollectors"),n,"perceptors"),this.tabs.addTab(s("ui.common.mountPark"),o,"paddocks"),this.tabs.addTab(s("ui.common.housesWord"),r,"houses"),t.on("open",e),i.on("open",e),o.on("open",e),r.on("open",e)},n.prototype._setupEvents=function(){var e=this,t=window.gui.playerData.guild;t.on("guildMemberCountUpdate",function(){e.isVisible()&&e.membersValue.setText(t.current.nbConnectedMembers+" / "+t.current.nbMembers)}),t.on("GuildGeneralInformationUpdate",function(){e.isVisible()&&(e._updateEmblemLogoAndWindowTitle(),e._updateTabNotification())})},n.prototype._resetTabs=function(){null!==this.openedTabId&&(this.openedTabId=null,this.tabs.close()),this._updateTabNotification(!0)},n.prototype._updateTabNotification=function(e){var t=window.gui.playerData.guild.current,i=!e&&!!t.abandonnedPaddock;this.tabs.toggleTabNotification("paddocks",i)},n.prototype._updateGuildCreationData=function(){var e=_.getAlmanaxDate(1e3*window.gui.playerData.guild.current.creationDate);this.creationDateValue.setText(e.day+" "+e.monthName+" "+e.year)},n.prototype._updateEmblemLogoAndWindowTitle=function(){var e=window.gui.playerData.guild.current,t=e.guildEmblem,i=v.getWindow("social");i.updateWindowTitle("guild",s("ui.common.guild")+" - "+e.guildName),this.level.setText(s("ui.common.rank",e.level)),this.levelBar.setValue(e.experiencePercentage),this.membersValue.setText(e.nbConnectedMembers+" / "+e.nbMembers),this._updateGuildCreationData(),this.emblem.setValue(t,!0)}},function(e,t){},function(e,t,i){function n(e,t){return e.name<t.name?-1:1}function o(e,t){return e.rankValue<t.rankValue?-1:1}function s(e,t){return e.onlineStatus<t.onlineStatus?-1:1}function a(e){e=e||{},r.call(this,"div",{className:"GuildMembers"}),this.addClassNames(e.className),this.once("open",function(){this._setupDom(),this._setupSocketEvents()})}i(1040);var r=i(321),l=i(172).inherits,c=i(539),d=i(29).getText,u=i(335),h=i(194),p=i(612),m=i(619),f=i(478).GuildRightsBitEnum,g=i(182),_=i(425),v=i(176),y={};y[m.NOT_CONNECTED]="offline",y[m.GAME_TYPE_ROLEPLAY]="online",y[m.GAME_TYPE_FIGHT]="online",y[m.UNKNOWN_STATE]="offline",l(a,r),e.exports=a,a.prototype._setupDom=function(){var e=this,t=[{id:"playerIcon",sort:s},{id:"nameButton",header:d("ui.common.name"),sort:n},{id:"rankName",header:d("ui.pvp.rank"),sort:o},{id:"level",header:d("ui.common.short.level"),sort:!0},{id:"xpPercentage",header:"%"+d("ui.common.xp"),sort:!0},{id:"xp",header:d("ui.common.xp"),sort:!0},{id:"achievement",header:d("ui.achievement.achievement"),sort:!0},{id:"stateIcon",sort:s},{id:"buttons"}];this.table=this.appendChild(new c(t,null,{clickable:!1})),this.table.addFilter(function(t){return!!e.showOfflineCheckbox.isActivate()||"online"===t.onlineStatus});var i=window.gui.playerData.guild.current.warnMemberOnConnectionState,a=v.getValue("showGuildMembersOffline",!1);this.showOfflineCheckbox=this.appendChild(new p(d("ui.social.displayOfflineGuildMembers"),a));var r=this.appendChild(new p(d("ui.social.warnWhenGuildMembersComeOnline"),i));this.averageLevel=this.createChild("div",{className:"averageLevel"}),this.showOfflineCheckbox.on("change",function(t){e.table.filter(),v.setValue("showGuildMembersOffline",t)}),r.on("change",function(e){window.dofus.sendMessage("GuildMemberSetWarnOnConnectionMessage",{enable:e}),window.gui.playerData.guild.current.warnMemberOnConnectionState=e})},a.prototype._setupSocketEvents=function(){var e=this;window.gui.playerData.guild.on("guildMember",function(t){e.isVisible()&&e._updateMembersList(t)}),window.gui.playerData.guild.on("guildMemberStatusUpdate",function(t){if(e.isVisible()){var i=e.table.getCell(t.id,"playerIcon"),n=i.getChild("onlineStatusIcon");n.setClassNames("onlineStatusIcon","status"+t.status.statusId)}})},a.prototype._updateMembersList=function(e){function t(){h.open("guildMemberRights",this.memberInfo)}function i(){var e=this.memberInfo.id,t=1===Object.keys(a.members).length;if(e===a.leaderId&&!t)return window.gui.openSimplePopup(d("ui.social.guildBossCantBeBann"),d("ui.popup.warning"));var i=l===e?d("ui.social.doUDeleteYou"):d("ui.social.doUDeleteMember",this.memberInfo.name);window.gui.openConfirmPopup({title:d("ui.popup.warning"),message:i,cb:function(t){t&&window.dofus.sendMessage("GuildKickRequestMessage",{kickedId:e})}})}function n(){this.connected?window.gui.openContextualMenu("player",{playerId:this.id,accountId:this.accountId,playerName:this.name}):window.gui.openContextualMenu("offlinePlayer",{playerId:this.id,playerName:this.name,hoursSinceLastConnection:this.hoursSinceLastConnection})}function o(e,t){c.getSmallWingsUrl(t,function(t){e.rootElement&&e.setStyle("backgroundImage",t)})}var s=window.gui.playerData.guild,a=s.current,l=window.gui.playerData.id,c=window.gui.playerData.alignment,p=l===a.leaderId,m=[],v=[],b=[],M=[];this.table.clearContent(),this.averageLevel.setText(d("ui.social.guildAvgMembersLevel")+": "+a.averageMemberLevel);for(var w=p||s.hasRight(f.GUILD_RIGHT_BOSS)||s.hasRight(f.GUILD_RIGHT_MANAGE_GUILD_BOOSTS)||s.hasRight(f.GUILD_RIGHT_MANAGE_RIGHTS)||s.hasRight(f.GUILD_RIGHT_MANAGE_XP_CONTRIBUTION)||s.hasRight(f.GUILD_RIGHT_MANAGE_RANKS),T=s.checkRight(f.GUILD_RIGHT_BOSS,a.members[l].rights),C=window.gui.databases.RankNames,A=0,I=e.length;A<I;A++){var S=e[A],E=y[S.connected],x=new r("div",{className:"buttons"}),N=l===e[A].id;(N||w||T)&&(x.appendChild(new u({className:["boxSizing","rowButton","rights"]},t)).memberInfo={id:S.id,name:S.name,level:S.level,rank:S.rank,experienceGivenPercent:S.experienceGivenPercent,rights:S.rights}),(N||p||T||s.hasRight(f.GUILD_RIGHT_BAN_MEMBERS))&&(x.appendChild(new u({className:["boxSizing","rowButton","deletion"]},i)).memberInfo={id:S.id,name:S.name});var L=new u({className:"playerIcon",scaleOnPress:!1},n);L.createChild("div",{name:"onlineStatusIcon",className:["onlineStatusIcon","status"+S.status.statusId]});var O=L.createChild("div",{className:"alignmentSide"});S.alignmentSide!==_.ALIGNMENT_ANGEL&&S.alignmentSide!==_.ALIGNMENT_EVIL||o(O,S.alignmentSide),m.push(O.createChild("div",{className:"playerHead"})),v.push("gfx/heads/SmallHead_"+S.breed+(S.sex?1:0)+".png"),L.id=S.id,L.name=S.name,L.accountId=S.accountId,L.isMySelf=N,L.connected=S.connected,L.hoursSinceLastConnection=S.hoursSinceLastConnection;var D=new u({className:"nameButton",text:S.name,scaleOnPress:!1},n);D.id=S.id,D.name=S.name,D.accountId=S.accountId,D.isMySelf=N,D.connected=S.connected,D.hoursSinceLastConnection=S.hoursSinceLastConnection;var R={playerIcon:L,nameButton:D,name:S.name,rankName:C[S.rank].nameId,rankValue:S.rank,level:S.level,xpPercentage:S.experienceGivenPercent+"%",xp:S.givenExperience,achievement:S.achievementPoints,buttons:x,onlineStatus:E};if("offline"===E)R.stateIcon=new r("div",{className:["stateIcon","offline"]});else if(S.hasOwnProperty("moodSmileyId")&&S.moodSmileyId>0){var P=S.moodSmileyId,B=window.gui.databases.Smileys[P];B?(R.stateIcon=new r("div",{className:["stateIcon","smiley"]}),b.push(R.stateIcon),M.push("gfx/smilies/"+B.gfxId+".png")):console.error("Smiley "+P+" details are not available, it could not be displayed")}this.table.addRow(R,S.id).addClassNames(E)}this.table.filter(),g.preloadImages(v,function(e){for(var t=0,i=e.length;t<i;t++){var n=m[t];n&&n.rootElement&&n.setStyle("backgroundImage",e[t])}}),M.length&&g.preloadImages(M,function(e){if(e.length!==b.length)return console.error("Number of smileys preloaded does not match number of state icons");for(var t=0;t<e.length;t++){var i=b[t];i&&i.rootElement&&i.setStyle("backgroundImage",e[t])}})}},function(e,t){},function(e,t,i){function n(e){e=e||{},s.call(this,"div",{className:"GuildHousesWindow"}),this.addClassNames(e.className);var t=this;this.currentSelectedHouseId=null,this.once("open",function(){t._createDom()}),this.on("open",function(){t._resetAll(),t.addClassNames("spinner")})}i(1042);var o=i(172).inherits,s=i(321),a=i(337).addTooltip,r=i(335).DofusButton,l=i(29).getText,c=i(649),d=i(194);o(n,s),e.exports=n,n.prototype._createDom=function(){var e=this,t={colIds:["houseName","coordinate","owner","detail"],headerContent:[l("ui.common.houseWord"),l("ui.common.coordinatesSmall"),l("ui.common.ownerWord")],highlightable:!0,onRowTap:function(t){e.currentSelectedHouseId=t.houseId}};this.table=this.appendChild(new c(t));var i=this.createChild("div",{className:"buttonContainer"});this.joinButton=i.appendChild(new r("Join",{className:"joinButton"})),this.joinButton.on("tap",function(){window.dofus.sendMessage("GuildHouseTeleportRequestMessage",{houseId:e.currentSelectedHouseId}),d.close("social")}),this.joinButton.disable(),this._setupSocketEvents()},n.prototype._setupSocketEvents=function(){var e=this,t=window.gui.playerData.guild;t.on("guildHouseUpdateAll",function(){e.isVisible()&&(e.delClassNames("spinner"),e._updateHouses(),e._updateJoinButton())}),t.on("guildHouseUpdateInfo",function(t){e.isVisible()&&(e._updateHouse(t),e._updateJoinButton())}),t.on("guildHouseRemoved",function(t){e.isVisible()&&(e._removeHouse(t),e._updateJoinButton())})},n.prototype._createHouseInfoButton=function(e){var t=this,i=new r("?",{name:"button"});return i.on("tap",function(){var i=t._getHouseListRowIndexByHouseId(e.houseId);t.table.highlight(i),d.open("guildHouseInfo",{guildshareParams:e.guildshareParams,skillListIds:e.skillListIds})}),i},n.prototype._resetAll=function(){this.currentSelectedHouseId=null,this.table.clearContent(),this.joinButton.disable()},n.prototype._createHouseListRow=function(e){var t=e.enrichData||{};return{houseName:t.houseName,coordinate:e.worldX+","+e.worldY,owner:e.ownerName,detail:this._createHouseInfoButton(e)}},n.prototype._getHouseListRowIndexByHouseId=function(e){for(var t=this.table.getRows(),i=0;i<t.length;i+=1){var n=t[i].houseId||{};if(e===n)return i}},n.prototype._updateJoinButton=function(){var e=window.gui.playerData.guild.current.houses||[];e.length?this.joinButton.enable():this.joinButton.disable()},n.prototype._updateHouses=function(){var e=window.gui.playerData.guild.current.houses||[];this._resetAll();for(var t=0;t<e.length;t+=1)this._addHouse(e[t])},n.prototype._addHouse=function(e){var t=this._createHouseListRow(e),i=this.table.addRow(t,{houseId:e.houseId});this._addHouseRowToolTip(i,e)},n.prototype._removeHouse=function(e){var t=this._getHouseListRowIndexByHouseId(e);t>=0&&this.table.delRow(t)},n.prototype._updateHouse=function(e){var t=e.houseId,i=this._getHouseListRowIndexByHouseId(t);if(i>=0){var n=this._createHouseListRow(e);this.table.updateRow(i,n,{houseId:t})}else this._addHouse(e)},n.prototype._addHouseRowToolTip=function(e,t){var i=t.enrichData,n=i.areaName+" ("+i.subAreaName+")";a(e,n)}},function(e,t){},function(e,t,i){function n(e){u.call(this,"div",e),this.addClassNames("GuildCustomisationWindow"),this._buildDomElements(),this._listenGameServerEvents()}function o(){window.dofus.sendMessage("GuildSpellUpgradeRequestMessage",{spellId:this.spellId})}function s(e,t){var i="",n=e.getUpgradeCost();return t>=n&&e.level<e.getMaxLevel()&&(i=new f({className:"UpgradeButton"},o),i.spellId=e.id),i}function a(e,t,i,n){function o(t){for(var i=[],n=0,o=e.length;n<o;n++)i.push("gfx/spells/sort_"+e[n]+".png");_.preloadImages(i,function(e){t(null,e)})}function a(t){m.createSpells(e,t)}function r(o,a){if(o)return console.warn(o);for(var r={},l={},c=0;c<e.length;c++){var d=e[c];r[d]=a.spellUrls[c];var h=t[c]?t[c]:1;l[d]=t[c],a.spells[d].setLevel(h)}for(var m in a.spells){var f=a.spells[m],_=new u("div",{className:"spellIcon"});_.setStyle("backgroundImage",r[m]),i.addRow([_,f.getName(),l[m],s(f,n)]),g(_,new p({spell:f}))}}i.clearContent(),d.parallel({spells:a,spellUrls:o},r)}function r(e){var t=new f({className:"UpgradeButton",name:"button"},function(){window.dofus.sendMessage("GuildCharacsUpgradeRequestMessage",{charaTypeTarget:v[t.id]})});return t.id=e,t}i(1044);var l=i(172).inherits,c=i(29).getText,d=i(31),u=i(321),h=i(649),p=i(745),m=i(412),f=i(335),g=i(337).addTooltip,_=i(182),v={taxCollectorPods:0,taxCollectorProspecting:1,taxCollectorWisdom:2,maxTaxCollectorsCount:3},y={taxCollectorLifePoints:null,taxCollectorDamagesBonuses:null,taxCollectorProspecting:{cost:1,quantity:1,max:500},taxCollectorWisdom:{cost:1,quantity:1,max:400},taxCollectorPods:{cost:1,quantity:20,max:5e3},maxTaxCollectorsCount:{cost:10,quantity:1,max:50}};l(n,u),e.exports=n,n.prototype._listenGameServerEvents=function(){var e=this;window.gui.on("GuildInfosUpgradeMessage",function(t){e._updateUI(t)})},n.prototype._buildDomElements=function(){var e=this.createChild("div",{className:["sidePanel","leftPanel"],name:"leftPanel"});this.spellsTable=new h({colIds:["icon","name","level","upgrade"],headerContent:["",c("ui.common.name"),c("ui.common.level")],className:["sidePanel","rightPanel"]}),this.appendChild(this.spellsTable);var t=e.createChild("div",{className:"characterImage"}),i=t.createChild("div",{className:"image"});_.preloadImage("gfx/illusUi/SocialGuildePersonnalisation_tx_IlluPerco.png",function(e){i.setStyle("backgroundImage",e)});var n=new h({colIds:["label","value","upgrade"],headerContent:[c("ui.social.guildTaxCharacteristics")]});n.addRow([c("ui.common.lifePoints"),"0",""]),n.addRow([c("ui.social.damagesBonus"),"0",""]),n.addRow([c("ui.social.discernment"),"0",r("taxCollectorProspecting")]),n.addRow([c("ui.stats.wisdom"),"0",r("taxCollectorWisdom")]),n.addRow([c("ui.common.weight"),"0",r("taxCollectorPods")]),n.addRow([c("ui.social.taxCollectorCount"),"0",r("maxTaxCollectorsCount")]),n.addClassNames("perceptorCharacteristicsTable"),e.appendChild(n),this.perceptorCharacteristicsTable=n;var o=e.createChild("div",{className:"pointsToDistributePanel",name:"pointsToDistributePanel"});o.createChild("div",{className:"pointsToDistributeLabel",name:"pointsToDistributeLabel",text:c("ui.social.guildBonusPoints")}),this.pointsToDistributeValue=o.createChild("div",{className:"pointsToDistributeValue",name:"pointsToDistributeValue",text:"0"})},n.prototype._updateUI=function(e){var t=e.boostPoints,i=this.perceptorCharacteristicsTable,n=0;for(var o in y){var s=n++;if(i.updateRow(s,{value:e[o]}),y[o]){var r=t>=y[o].cost,l=e[o]<y[o].max,c=i.getCol(s,"upgrade").getChild("button");r&&l?c.show():c.hide()}}this.pointsToDistributeValue.setText(e.boostPoints),a(e.spellId,e.spellLevel,this.spellsTable,e.boostPoints)}},function(e,t){},function(e,t,i){function n(e){e=e||{},a.call(this,"div",{className:"GuildPaddocksWindow"}),this.addClassNames(e.className),this.selectedPaddock=null,this.once("open",function(){this._createDom(),this._setupEvents()}),this.on("open",function(){this._resetAll(),this.locationTable.addClassNames("spinner")})}i(1046);var o=i(172).inherits,s=i(335),a=i(321),r=i(337).addTooltip,l=i(29).getText,c=i(649),d=i(194),u=i(182);o(n,a),e.exports=n,n.prototype._setupEvents=function(){var e=window.gui.playerData.guild,t=this;e.on("guildPaddockUpdate",function(){t.isVisible()&&(t.locationTable.delClassNames("spinner"),t._updatePaddocks(),t._updateJoinButton())}),e.on("guildPaddockBought",function(e){t.isVisible()&&(t._addPaddock(e),t._updateJoinButton())}),e.on("guildPaddockRemoved",function(e){t.isVisible()&&(t._removePaddock(e),t._updateJoinButton())})},n.prototype._createDom=function(){var e=this;this.locationTable=this.appendChild(new c({className:"locationTable",headerContent:[l("ui.common.localisation")],colIds:["location","abandoned"],highlightable:!0,onRowTap:function(t){e._updatePaddockDetails(t)}}));var t=this.createChild("div",{className:"rightColumn"}),i=t.createChild("div",{className:"infos"}),n=i.createChild("div",{className:"image"}),o=i.createChild("div",{className:"details"});this.paddockName=o.createChild("div",{className:"name"}),o.createChild("div",{className:["text","clear"],text:l("ui.common.objects")}),this.maxItems=o.createChild("div",{className:["text","right"],text:"-"}),o.createChild("div",{className:["text","clear"],text:l("ui.common.mounts")}),this.maxMounts=o.createChild("div",{className:["text","right"],text:"-"}),this.joinButton=new s({className:["button","clear"],text:l("ui.common.join")},function(){e.selectedPaddock&&e.selectedPaddock.paddockId&&(window.dofus.sendMessage("GuildPaddockTeleportRequestMessage",{paddockId:e.selectedPaddock.paddockId}),d.close("social"))}),o.appendChild(this.joinButton),this.mountTable=t.appendChild(new c({className:"mountTable",headerContent:[l("ui.common.mountType"),l("ui.common.ownerWord")],colIds:["mount","owner"]})),u.preloadImage("gfx/illusUi/IllusDinde.png",function(e){n.setStyle("backgroundImage",e)})},n.prototype._updatePaddockDetails=function(e){var t=this.selectedPaddock=e.paddock,i=t.enrichData||{};this.paddockName.setText(l("ui.common.mountPark")+" - "+i.subAreaName),this.maxItems.setText(t.maxItems+" "+l("ui.common.maxWord"));var n=t.mountsInformations,o=n.length;if(this.maxMounts.setText(o+" / "+t.maxOutdoorMount),this.mountTable.clearContent(),o)for(var s=0;s<o;s+=1){var a=n[s],c=a.enrichData||{},d=this.mountTable.addRow({mount:c.mountType,owner:a.ownerName}),u=a.name||l("ui.common.noName");r(d,u)}},n.prototype._createLocationTableRow=function(e){var t,i=new a("div",{className:"locationInfo"}),n=i.createChild("div");e.abandonned&&(t=i.createChild("div",{className:"abandonedIcon"}),r(t,l("ui.social.paddockWithNoOwner")));var o=e.enrichData||{},s=isNaN(e.worldX)?o.worldX:e.worldX,c=isNaN(e.worldY)?o.worldY:e.worldY,d="("+s+", "+c+")";return n.setText(o.areaName+" ("+o.subAreaName+") "+d),{location:n,abandoned:t||""}},n.prototype._updateJoinButton=function(){var e=window.gui.playerData.guild.current.paddocks||[];e.length?this.joinButton.enable():this.joinButton.disable()},n.prototype._updatePaddocks=function(){var e=window.gui.playerData.guild.current.paddocks||[];this._resetAll();for(var t=0;t<e.length;t+=1)this._addPaddock(e[t])},n.prototype._addPaddock=function(e){var t=this._createLocationTableRow(e);this.locationTable.addRow(t,{paddock:e})},n.prototype._removePaddock=function(e){for(var t=this.locationTable.getRows(),i=0;i<t.length;i+=1){var n=t[i];if(n.paddock.paddockId===e){this.locationTable.delRow(i);break}}},n.prototype._resetAll=function(){this.locationTable.clearContent(),this.mountTable.clearContent(),this.joinButton.disable(),this.paddockName.setText(""),this.maxItems.setText("-"),this.maxMounts.setText("-")}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"GuildPerceptorsWindow"}),this.taxCollectorRows={},this.once("open",function(){this._createDom(),this._setupEvents()}),this.on("open",function(){this.table.addClassNames("spinner"),window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:c.INFO_TAX_COLLECTOR_GUILD_ONLY})}),this.on("close",function(){this._clearAllFightStartTimers(),window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:c.INFO_TAX_COLLECTOR_LEAVE})})}function o(e){var t=this.fight;if(t.state===m.fightState.waitingForHelp){var i=t.id,n=window.gui.playerData.id;m.isPlayerFightingFor(n,f.taxCollector,i,g.allies)?e&&n===e.id&&window.dofus.sendMessage("GuildFightLeaveRequestMessage",{taxCollectorId:i,characterId:n}):e&&5===t.fighters.allies.length?window.dofus.sendMessage("GuildFightTakePlaceRequestMessage",{taxCollectorId:i,replacedCharacterId:e.id}):window.dofus.sendMessage("GuildFightJoinRequestMessage",{taxCollectorId:i})}}i(1048);var s=i(172).inherits,a=i(321),r=i(337).addTooltip,l=i(29).getText,c=i(640),d=i(339),u=i(1033),h=i(557),p=i(649),m=i(475),f=m.entityType,g=m.fightingSide;s(n,a),e.exports=n,n.prototype._createDom=function(){var e=this.createChild("div",{className:"tableContainer"});this.table=e.appendChild(new p({headerContent:["",l("ui.common.name")+" / "+l("ui.common.localisation"),"",l("ui.common.defenders")+" / "+l("ui.common.attackers")],colIds:["fightState","taxCollectorInfo","timer","fightersInfo"]})),this.perceptorAmountText=this.createChild("div",{className:"rightAlignText"}),this._setPerceptorsAmount(0,0),this.createChild("div",{className:"rightAlignText",text:l("ui.social.guildHowDefendTax")})},n.prototype._setupEvents=function(){function e(e){return i.taxCollectorRows[e]&&i.taxCollectorRows[e].fightersInfo}function t(e){return i.taxCollectorRows[e]&&i.taxCollectorRows[e].timer}var i=this,n=0;m.on("taxCollectorList",function(e,t,o){if(i.isVisible()&&e===f.taxCollector){i.table.delClassNames("spinner"),i._resetAll();for(var s=0,a=t.length;s<a;s+=1)i._addTaxCollector(t[s]);n=o,i._setPerceptorsAmount(t.length,o)}}),m.on("entityAdded",function(e,t){i.isVisible()&&e===f.taxCollector&&(i._addTaxCollector(t),i._setPerceptorsAmount(i.table.getRowCount(),n))}),m.on("entityRemoved",function(e,t){i.isVisible()&&e===f.taxCollector&&(i._removeTaxCollector(t),i._setPerceptorsAmount(i.table.getRowCount(),n))}),m.on("fightStarted",function(n,o){if(i.isVisible()&&n===f.taxCollector){var s=e(o.id);if(s){var a=m.entities[n][o.id],r=a.enrichData||{};s.setFight(n,o),s.setTarget({id:o.id,entityLook:a.look,name:r.firstName+" "+r.lastName,level:window.gui.playerData.guild.current.level}),i._updateFightState(o.id,o.state);var l=t(o.id);i._registerFightStartTimer(l,o.waitingForHelpInfo)}}}),m.on("fighting",function(e,n){if(i.isVisible()&&e===f.taxCollector){var o=t(n.id);i._updateFightState(n.id,n.state),i._clearFightStartTimer(o)}}),m.on("fightEnded",function(t,n){if(i.isVisible()&&t===f.taxCollector){var o=e(n);o&&(i._updateFightState(n,m.fightState.noFight),o.reset())}}),m.on("fighterList",function(t,n,o,s){if(i.isVisible()&&t===f.taxCollector){var a=e(n);a&&a.setFighters(o,s)}}),m.on("fighterJoined",function(t,n,o,s,a){if(i.isVisible()&&t===f.taxCollector){var r=e(n);r&&r.setFighter(o,s,a)}}),m.on("fighterLeft",function(t,n,o,s,a){if(i.isVisible()&&t===f.taxCollector){var r=e(n);r&&r.removeFighter(o,a)}})},n.prototype._setPerceptorsAmount=function(e,t){this.perceptorAmountText.setText(l("ui.social.guild.taxCollectorCount",e,t))},n.prototype._setNameLocation=function(e,t){var i=t.enrichData||{},n=e.getChild("name");n.setText(i.firstName+" "+i.lastName);var o=" ("+t.worldX+" , "+t.worldY+")",s=e.getChild("location");s.setText(i.subAreaName+o);var a=t.complements||[],r=d.getObjectInArrayById(a,"_type","TaxCollectorLootInformations")||{},c=l("ui.common.short.weight",d.intToString(r.pods||0)),u=l("ui.social.thingsTaxCollectorGet",c,d.intToString(r.experience||0)),h=e.getChild("resources");h.setText(u);var p=e.getChild("owner"),m=t.additionalInfos.collectorCallerName;p.toggleClassName("me",window.gui.playerData.characterBaseInformations.name===m),p.setText(l("ui.common.ownerWord")+l("ui.common.colon")+m)},n.prototype._addFightStateToolTip=function(e,t){r(e,function(){var e="",i=t.state||0;e+=l(1===i?"ui.social.guild.taxInEnterFight":2===i?"ui.social.guild.taxInFight":"ui.social.guild.taxInCollect");var n=t.additionalInfos||{};e+="\n"+l("ui.common.ownerWord")+l("ui.common.colon"),e+=n.collectorCallerName+"\n",e+=l("ui.social.guild.taxStartDate")+l("ui.common.colon");var o=d.getAlmanaxDate(1e3*n.date);return e+=o.day+" "+o.monthName+" "+o.year+" "+o.hour+":"+o.minute,e+="\n"+l("ui.social.taxCollector.itemsValue",d.kamasToString(t.complements[0].itemsValue)),new a("div",{text:e})})},n.prototype._updateTimerProgressBar=function(e){var t=e.remainSeconds,i=e.totalWaitTime,n=i-t,o=Math.round(n/i*100)/100;e.setValue(o)},n.prototype._registerFightStartTimer=function(e,t){var i=this;t&&(e.remainSeconds=Math.round(t.timeLeftBeforeFight/10)||0,e.totalWaitTime=Math.round(t.waitTimeForPlacement/10)||1,e.intervalId=setInterval(function(){e.remainSeconds-=1,e.remainSeconds>0?i._updateTimerProgressBar(e):i._clearFightStartTimer(e)},1e3),this._updateTimerProgressBar(e))},n.prototype._clearFightStartTimer=function(e){clearInterval(e.intervalId),e.intervalId=null,e.remainSeconds=0,e.totalWaitTime=0,
e.setValue(0)},n.prototype._clearAllFightStartTimers=function(){for(var e=this.table.getRows()||[],t=0;t<e.length;t+=1){var i=e[t].timer;this._clearFightStartTimer(i)}},n.prototype._createTaxCollectorRow=function(e){var t=new a("div",{className:["fightState","state"+e.state]});this._addFightStateToolTip(t,e);var i=new a("div",{className:"taxCollectorInfo"});i.createChild("div",{name:"name"}),i.createChild("div",{name:"location"}),i.createChild("div",{name:"resources"}),i.createChild("div",{name:"owner",className:"taxCollectorInfoOwner"}),this._setNameLocation(i,e);var n=new h({vertical:!0,className:["green","timer"]}),s=new u;return s.on("slotTap",o),{fightState:t,taxCollectorInfo:i,timer:n,fightersInfo:s}},n.prototype._addTaxCollector=function(e){var t=e.uniqueId,i=this.table.addRow(this._createTaxCollectorRow(e),{collectorId:t});this.taxCollectorRows[t]=i},n.prototype._updateFightState=function(e,t){var i=this.taxCollectorRows[e];i&&i.fightState.replaceClassNames(["state0","state1","state2"],["state"+t])},n.prototype._removeTaxCollector=function(e){var t=this.taxCollectorRows[e];if(t){this._clearFightStartTimer(t.timer),delete this.taxCollectorRows[e];var i=this.table.getRows().indexOf(t);this.table.delRow(i)}},n.prototype._resetAll=function(){this.taxCollectorRows={},this._clearAllFightStartTimers(),this.table.clearContent(),this._setPerceptorsAmount(0,0)}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"SpouseWindow",name:"spouse"});var e=this;window.gui.playerData.socialData.once("spouseUpdate",function(t){e._updateSocialWindowTitle(t)}),this.once("open",function(){e._setupDom(),e._setupEvents()}),this.on("open",function(){window.dofus.sendMessage("SpouseGetInformationsMessage")})}i(1050);var o=i(172).inherits,s=i(29).getText,a=i(321),r=i(335),l=i(30),c=i(369),d=i(410),u=i(194),h=i(182);o(n,a),e.exports=n,n.prototype._setupDom=function(){var e=this,t=this.createChild("div",{className:"col1"}),i=this.createChild("div",{className:"col2"});this.name=t.createChild("div",{className:"name"});var n=this.info=t.createChild("div",{className:"info"}),o=n.createChild("div",{className:"line"});o.createChild("div",{className:"title",text:s("ui.charcrea.breed")+":"}),this["class"]=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),o.createChild("div",{className:"title",text:s("ui.common.averageLevel")+":"}),this.level=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),o.createChild("div",{className:"title",text:s("ui.common.alignment")+":"}),this.alignment=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:["line","guild"]}),o.createChild("div",{className:"title",text:s("ui.common.guild")+":"}),this.guild=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),o.createChild("div",{className:"title",text:s("ui.common.state")+":"}),this.status=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),o.createChild("div",{className:"title",text:s("ui.common.localisation")+":"}),this.location=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),this.fightingIcon=o.createChild("div",{className:"fightingIcon",hidden:!0});var a=n.createChild("div",{className:"buttons"});this.inviteButton=a.appendChild(new r({text:s("ui.party.addToParty"),className:"button"},function(){window.dofus.sendMessage("PartyInvitationRequestMessage",{name:e.name.getText()})})),this.followButton=a.appendChild(new r({text:s("ui.common.follow"),className:"button"},function(){window.dofus.sendMessage("FriendSpouseFollowWithCompassRequestMessage",{enable:!0})})),this.stopFollowingButton=a.appendChild(new r({text:s("ui.common.stopFollow"),className:"button",hidden:!0},function(){window.dofus.sendMessage("FriendSpouseFollowWithCompassRequestMessage",{enable:!1})})),this.joinButton=a.appendChild(new r({text:s("ui.common.join"),className:"button"},function(){window.dofus.sendMessage("FriendSpouseJoinRequestMessage")}));var l=i.createChild("div",{className:["image","bird"]});this.character=i.appendChild(new c({scale:3.5,verticalAlign:"center"})),h.preloadImage("gfx/illusUi/tofus_bague.png",function(e){l.setStyle("backgroundImage",e)})},n.prototype._setupEvents=function(){var e=this;window.gui.playerData.socialData.on("spouseUpdate",function(t){e._updateSocialWindowTitle(t),e.updateDomData(t)}),window.gui.on("CompassUpdateMessage",function(){e.stopFollowingButton.show(),e.followButton.hide()}),window.gui.on("CompassResetMessage",function(){e.stopFollowingButton.hide(),e.followButton.show()})},n.prototype.updateDomData=function(e){var t=this,i=window.gui.databases;this.name.setText(e.spouseName),this["class"].setText(i.Breeds[e.breed].shortNameId),this.level.setText(e.spouseLevel),this.alignment.setText(i.AlignmentSides[e.alignmentSide].nameId);var n=e.guildInfo?e.guildInfo.guildName:"";return this.guild.setText("#NONAME#"===n?s("ui.guild.noName"):n),this.stopFollowingButton.toggleDisplay(!!e.followSpouse),this.followButton.toggleDisplay(!e.followSpouse),this.fightingIcon.toggleDisplay(!!e.inFight),t.character.setLook(e.spouseEntityLook,{direction:d.DIRECTION_SOUTH_WEST,boneType:"characters/",skinType:"characters/",riderOnly:!0}),e.subAreaId?(this.status.setText(s("ui.server.state.online")),this.inviteButton.enable(),this.followButton.enable(),this.stopFollowingButton.enable(),this.joinButton.enable(),void l.getData("SubAreas",e.subAreaId,function(e,i){e&&console.warn("Failed to retrieve subArea data",e),t.location.setText(i.nameId)})):(this.status.setText(s("ui.server.state.offline")),this.location.setText("-"),this.inviteButton.disable(),this.followButton.disable(),this.stopFollowingButton.disable(),void this.joinButton.disable())},n.prototype._updateSocialWindowTitle=function(e){var t=u.getWindow("social");t.updateWindowTitle("spouse",s("ui.common.spouse",e.sex))}},function(e,t){},function(e,t,i){function n(e){r.call(this,"div",{className:"FellowPagesWindow",name:"directory"}),e=e||{},this.addClassNames(e.className);var t=this;this.once("open",function(){t._setupDom()})}i(1052);var o=i(172).inherits,s=i(29).getText,a=i(563),r=i(321),l=i(1053),c=i(1055);o(n,r),e.exports=n,n.prototype._setupDom=function(){var e=this.appendChild(new a({className:"tabs"}));e.addTab(s("ui.social.guilds"),new l,"guilds"),e.addTab(s("ui.alliance.alliances"),new c,"alliances"),e.openTab(0)}},function(e,t){},function(e,t,i){function n(){o.call(this,"div",{className:"FellowGuildsWindow"}),this.selector=null,this.table=null;var e=this;this.once("open",function(){e._setupDom()})}i(1054);var o=i(321),s=i(172).inherits,a=i(29).getText,r=i(532),l=i(530),c=i(649);s(n,o),e.exports=n,n.prototype._setupDom=function(){var e=this.createChild("div",{className:"line"});e.createChild("div",{className:"left",text:a("ui.search.criteria")}),e.createChild("div",{className:"right",text:a("ui.social.dataUpdate")}),e=this.createChild("div",{className:"line"}),this.selector=e.appendChild(new r),this.selector.addOption(a("ui.common.name"),"name"),this.selector.addOption(a("ui.alliance.memberName"),"memberName"),e.appendChild(new l),this.table=this.appendChild(new c({colIds:["name","level","members","button"],headerContent:[a("ui.common.name"),a("ui.common.level"),a("ui.common.members")]}))}},function(e,t){},function(e,t,i){function n(){o.call(this,"div",{className:"FellowAlliancesWindow"});var e=this;this.once("open",function(){e._setupDom()})}i(1056);var o=i(321),s=i(172).inherits,a=i(29).getText,r=i(532),l=i(530),c=i(649);s(n,o),e.exports=n,n.prototype._setupDom=function(){var e=this.createChild("div",{className:"line"});e.createChild("div",{className:"left",text:a("ui.search.criteria")}),e.createChild("div",{className:"right",text:a("ui.social.dataUpdate")}),e=this.createChild("div",{className:"line"}),this.selector=e.appendChild(new r),this.selector.addOption(a("ui.common.name"),"name"),this.selector.addOption(a("ui.alliance.memberName"),"memberName"),e.appendChild(new l),this.table=this.appendChild(new c({colIds:["name","abbr","guilds","members","territories","button"],headerContent:[a("ui.common.name"),a("ui.alliance.tag"),a("ui.social.guilds"),a("ui.common.members"),a("ui.common.territory")]}))}},function(e,t){},function(e,t,i){function n(){function e(e,t){t?e.enable():e.disable()}function t(){D||u.preloadImage("gfx/illusUi/enclos_tx_illuEnclos.png",function(e){D=!0,A.setStyle("backgroundImage",e)});var t=w.currency===_,s=t?n:i;if(o)x.replaceClassNames(["buy"],["sell"]),w.windowTitle.setText(l("ui.mount.paddockSell")),N.setText(l("ui.common.cancelTheSale")),E.setReadonly(!1),e(L,b);else{x.replaceClassNames(["sell"],["buy"]),w.windowTitle.setText(l("ui.mount.paddockPurchase")),N.setText(l("ui.common.cancel")),E.setReadonly(!0);var a=window.gui.playerData.inventory,r=t||s&&s<=a.kamas;e(L,r)}return O.toggleDisplay(!o&&!window.Config.disabledFeatures.shop),I.setText(l("ui.mount.paddockDescription",v,y)),s?void E.setValue(s):E.setValue(l("ui.item.averageprice.unavailable"))}s.call(this,{className:"PaddockBuyWindow",positionInfo:{left:"c",top:"c",width:350,height:270}}),this.currency=g;var i,n,o,v,y,b,M,w=this,T=this.windowBody.createChild("div",{className:"wrapContainer"}),C=T.createChild("div",{className:"container"}),A=C.createChild("div",{className:"illus"}),I=C.createChild("div",{className:"description"}),S=this.windowBody.createChild("div",{className:"price"}),E=S.appendChild(new c({className:"priceValue",attr:{readonly:!0},title:l("ui.common.price")}));S.createChild("div",{className:"priceLabel",text:l("ui.common.price")+":"});var x=this.windowBody.createChild("div",{className:"buttons"}),N=x.appendChild(new a(null,{className:"cancel"}));N.on("tap",function(){o?(m.hide(),window.dofus.sendMessage("PaddockSellRequestMessage",{price:0})):d.close(w.id)});var L=x.appendChild(new a(l("ui.common.validation"),{className:"confirm"}));L.on("tap",function(){if(o){m.hide(),i=E.getValue();var e=E.getFormattedValue();window.gui.openConfirmPopup({title:l("ui.mount.paddockSell"),message:l("ui.mount.doUSellPaddock",e),cb:function(e){e&&window.dofus.sendMessage("PaddockSellRequestMessage",{price:i})}})}else{var t,s=w.currency===g;t=s?l("tablet.price.soft",r.kamasToString(i,"")):l("tablet.price.hard",r.kamasToString(n,"")),window.gui.openConfirmPopup({title:l("ui.mount.paddockPurchase"),message:l("tablet.ui.mount.doUBuyPaddock",t),cb:function(e){if(e){if(s)return window.dofus.sendMessage("PaddockBuyRequestMessage");var t=n-window.gui.playerData.inventory.goultines;return t>0?f.openNotEnoughHardCurrencyPopup(t):window.dofus.send("paddockBuyRequest",{amountHard:n,amountSoft:i})}}},{isModal:!0})}}),E.on("change",function(t){w.currency===g?e(L,t!==M):e(L,!0)});var O=x.appendChild(new h);O.on("switchToHard",function(){w._setCurrency(_),t()}),O.on("switchToSoft",function(){w._setCurrency(g),t()});var D=!1;window.gui.on("PaddockPropertiesMessage",function(e){v=e.properties.maxOutdoorMount,y=e.properties.maxItems,b=0===e.properties.price}),window.gui.on("PaddockSellBuyDialogMessage",function(e){o=e.bsell,i=M=e.price,n=p.computeHardPrice(i),O.setCurrency(g),t(),d.openDialog("paddockBuy")}),p.on("computedHardPricesChange",function(){n=p.computeHardPrice(i),w.currency===_&&t()});var R=window.dofus.connectionManager;R.on("paddockBuyError",function(){this.send("moneyGoultinesAmountRequest")}),R.on("paddockBuySuccess",function(){this.send("moneyGoultinesAmountRequest")}),this.on("close",function(){m.hide()})}i(1058);var o=i(172).inherits,s=i(541),a=i(335).DofusButton,r=i(339),l=i(29).getText,c=i(340),d=i(194),u=i(182),h=i(934),p=i(713),m=i(435),f=i(801),g="soft",_="hard";o(n,s),e.exports=n,n.prototype._setCurrency=function(e){if(this.currency!==e){var t=this.currency;this.currency=e,this.currencyIcon&&this.currencyIcon.replaceClassNames([t],[e])}}},function(e,t){},function(e,t,i){function n(){function e(e,i){l.setMount(e,{context:i||"equipped"}),t.windowTitle.setText(l.getName())}s.call(this,{title:"",className:"MountWindow",positionInfo:{right:30,top:"c",width:280,height:525}});var t=this,i=this.windowBody,n=window.gui.playerData,o=window.dofus.connectionManager,l=i.appendChild(new a);o.on("ExchangeStartOkMountMessage",function(){r.close(t.id)}),l.on("freeMount",function(){r.close(t.id)}),l.on("renameMount",function(e){t.windowTitle.setText(e)}),n.on("setMount",this.localizeEvent(function(t){e(t.mountData)})),o.on("MountDataMessage",this.localizeEvent(function(n){if(t.isMountInfoExpected){t.isMountInfoExpected=!1;var o=n.mountData;o.mountLocation="certificate",e(o,"inventory"),i.delClassNames("spinner"),l.show()}})),this.on("open",function(t){if(t=t||{},this.isMountInfoExpected)return l.hide(),void i.addClassNames("spinner");var o=t.mountData||n.equippedMount;e(o)}),this.on("close",function(){r.close("feed")})}i(1060);var o=i(172).inherits,s=i(541),a=i(548),r=i(194);o(n,s),e.exports=n,n.prototype.showPaddockMount=function(e){this.isMountInfoExpected=!0,r.open(this.id),window.dofus.sendMessage("MountInformationInPaddockRequestMessage",{mapRideId:e})},n.prototype.showCertificateMount=function(e){var t=a.getMountInfoFromCertificate(e);t&&(this.isMountInfoExpected=!0,r.open(this.id),window.dofus.sendMessage("MountInformationRequestMessage",{id:t.mountId,time:t.date}))}},function(e,t){},function(e,t,i){function n(e){return g.indexOf(e.objectGID)!==-1||_.indexOf(e.item.typeId)!==-1}function o(e,t,i){window.dofus.sendMessage("ObjectFeedMessage",{objectUID:i.item.objectUID,foodUID:t,foodQuantity:e})}function s(e,t,i){window.dofus.sendMessage("MountFeedRequestMessage",{mountUid:i.mountUid,mountLocation:i.mountLocation,mountFoodUid:t,quantity:e})}function a(){return d("ui.item.confirmFoodLivingItem")}function r(e,t){return d("ui.item.confirmFoodMount",e,t)}function l(e){function t(e){var t=p.params.item;return window.gui.playerData.inventory.isPetFood(t,e)}function i(e){return!e.livingObjectCategory&&e.item.type.id===h}function l(){p.quantity.show(),p.quantityLabel.setText(d("ui.common.quantity")+d("ui.common.colon")),p.maxBtn.show(),p.minBtn.show()}function c(){p.quantity.hide(),p.quantityLabel.setText(d("ui.common.quantity")+d("ui.common.colon")+" 1"),p.maxBtn.hide(),p.minBtn.hide()}function u(e){var t={},i=window.gui.playerData.inventory.objects;for(var n in i){var o=i[n];e(o)&&(t[n]=o)}return t}f.call(this,{title:d("ui.common.feed"),className:"FeedWindow",positionInfo:{right:315,bottom:30,width:400,height:510}});var h,p=this,m={mount:{handleInput:function(){},setupUI:l,filter:n,confirmMessage:r,confirmAction:s},pet:{handleInput:function(){},setupUI:l,filter:t,confirmMessage:a,confirmAction:o},livingObject:{handleInput:function(e){h=e.item.livingObjectCategory},setupUI:c,filter:i,confirmMessage:a,confirmAction:o}};this.storageViewer=e,this.storageViewer.registerView(this,{manualOpening:!0}),this.on("slot-tap",function(e){this._selectItem(e.itemInstance)}),this.once("open",function(){this._createDom()}),this.on("open",function(e){e=e||{},this._reset(),this.mode=e.mode,this.params=e,this.setting=m[this.mode],this.setting.handleInput(e),this.setting.setupUI();var t=u(this.setting.filter);this.storageViewer.setItemList(t),this.storageViewer.addFilters([this.setting.filter])}),this.on("close",function(){this.storageViewer.removeFilter(this.setting.filter)}),this.on("closed",function(){this.storageViewer.unloadContent()}),this.on("itemQuantity",function(e){this._selectItem(e)}),this.on("itemRemoved",function(){this._reset()})}i(1062);var c=i(335),d=i(29).getText,u=i(172).inherits,h=i(853),p=i(340),m=i(455),f=i(541),g=[7903,7904],_=[41,62,63,64];u(l,f),l.prototype.possessFeedItemForMount=function(){for(var e=window.gui.playerData.inventory.objects,t=Object.keys(e),i=0,o=t.length;i<o;i+=1)if(n(e[t[i]]))return!0;return!1},l.prototype.possessFeedItemForPet=function(e){for(var t=window.gui.playerData.inventory.objects,i=Object.keys(t),n=e.item.foodItems,o=e.item.foodTypes,s=0,a=i.length;s<a;s+=1){var r=t[i[s]];if(n.indexOf(r.objectGID)!==-1||o.indexOf(r.item.typeId)!==-1)return!0}return!1},l.prototype.possessFeedItemForLivingObject=function(e){for(var t=window.gui.playerData.inventory.objects,i=Object.keys(t),n=e.livingObjectCategory,o=0,s=i.length;o<s;o+=1){var a=t[i[o]];if(!a.livingObjectCategory&&a.item.type.id===n)return!0}return!1},l.prototype._reset=function(){this.placeHolder.setText(d("ui.common.selectItem")),this.itemBox.hide(),this.confirmBtn.disable(),this.quantity.setValue(1),this.quantity.disable(),this.minBtn.disable(),this.maxBtn.disable()},l.prototype._createDom=function(){var e=this;this.viewerBox=this.windowBody.createChild("div",{className:"viewer"}),this.viewerBox.appendChild(this.storageViewer.storageUI);var t=this.windowBody.createChild("div",{className:"itemBox"});this.itemBox=t.appendChild(new h({showTitle:!0})),this.placeHolder=new m(t);var i=this.windowBody.createChild("div",{className:"quantityBox"});this.quantityLabel=i.createChild("div",{className:"label"});var n=this.quantity=i.appendChild(new p({title:d("ui.common.quantity")}));this.minBtn=i.appendChild(new c({text:d("ui.common.minWord"),className:["greenButton","minButton"]},function(){n.setValue(1)})),this.maxBtn=i.appendChild(new c({text:d("ui.common.maxWord"),className:["greenButton","minButton"]},function(){n.setValue(e.item.quantity)})),this.confirmBtn=this.windowBody.appendChild(new c({text:d("ui.common.validation"),className:["greenButton","confirm"]})),this.confirmBtn.on("tap",function(){var t=n.getValue();window.gui.openConfirmPopup({title:d("ui.popup.warning"),message:e.setting.confirmMessage(t,e.item.item.nameId),cb:function(i){i&&e.setting.confirmAction(t,e.item.objectUID,e.params)}})})},l.prototype._selectItem=function(e){this.item=e,this.itemBox.displayItem(e),this.itemBox.show(),this.placeHolder.setText(null),this.confirmBtn.enable(),this.quantity.setValue(1),this.quantity.maxValue=e.quantity,this.quantity.enable(),this.minBtn.enable(),this.maxBtn.enable()},e.exports=l},function(e,t){},function(e,t,i){function n(){s.call(this,{title:r("ui.mount.renameTooltip"),className:"MountRenameWindow",positionInfo:{left:"c",top:"c",width:"400px",height:"200px"}});var e=this.windowBody.createChild("div",{className:"mainContainer"});e.createChild("div",{className:"text",text:r("ui.mount.popupRename")});var t=this._validate.bind(this);this._inputName=e.appendChild(new d({className:"inputName",attr:{type:"text",maxlength:h}},t)),this._inputName.on("change",function(e){this.setValue(e.replace(/[^a-zA-Z]+/g,""))}),e.appendChild(new a(r("ui.common.ok"),{className:"okBtn"},t)),this.on("open",function(e){this._previousName=e.name,this._mountId=e.mountId,this._inputName.setValue(e.name),e.inputBox&&this._positionNextTo(e.inputBox)}),this.on("opened",function(){this._inputName.focus()})}i(1064);var o=i(172).inherits,s=i(541),a=i(335).DofusButton,r=i(29).getText,l=i(342),c=i(194),d=i(530),u=l.MIN_RIDE_NAME_LEN,h=l.MAX_RIDE_NAME_LEN,p=153,m=108;o(n,s),e.exports=n,n.prototype._validate=function(){var e=this._inputName.rootElement.value;this._inputName.rootElement.value=this._inputName.rootElement.value.replace(/[^a-zA-Z]+/g,""),e&&this._previousName!==e&&e.length>=u&&e.length<=h&&window.dofus.sendMessage("MountRenameRequestMessage",{name:e,mountId:this._mountId}),c.close(this.id)},n.prototype._positionNextTo=function(e){var t=e.rootElement.getBoundingClientRect();this.position.x=t.left-p,this.position.y=t.top-m}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"FamilyTreeWindow",positionInfo:{left:"c",top:"c",width:"688px",height:"511px"}}),this._reset(),this.on("open",this._setMount)}i(1066);var o=i(172).inherits,s=i(541),a=i(29).getText,r=i(182);o(n,s),e.exports=n,n.prototype._reset=function(){this._hasContent=!1,this._myMount=null,this._myMountName=null,this._ancestorBoxes=null},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._createContent=function(){this._hasContent=!0;var e=this.windowBody.createChild("div",{className:"tree"});this._myMount=e.createChild("div",{className:["mountDisplay","myMount"]}),this._myMountName=e.createChild("div",{className:"myMountName"}),this._ancestorBoxes=[];for(var t=3,i=0,n=1;n<=t;n+=1)for(var o=i;i<Math.pow(2,n)+o;i+=1){var s=["mountDisplay","ancestor_"+i,"geneMinus"+n];this._ancestorBoxes.push(e.createChild("div",{className:s}))}},n.prototype._setMount=function(e){this._hasContent||this._createContent();var t=e.ancestor||[],i=e.name||a("ui.common.noName");this.windowTitle.setText(a("ui.mount.ancestors",i)),this._myMountName.setText(i);for(var n=["gfx/mounts/"+e.model+".png"],o=0;o<t.length;o++)t[o]&&n.push("gfx/mounts/"+t[o]+".png");var s=this;r.preloadImages(n,function(e){if(s._hasContent){s._myMount.setStyle("backgroundImage",e[0]);for(var i=1,n=0;n<t.length;n++)if(t[n]){var o=e[i++];s._ancestorBoxes[n].setStyle("backgroundImage",o)}else s._ancestorBoxes[n].setStyle("backgroundImage","none")}})}},function(e,t){},function(e,t,i){function n(){function e(){var e,t=s.freeOnFailCheckbox.isActivate()&&s.freeOnFailCheckbox.isVisible();e=s.payingCheckbox.isActivate()?o.CRAFT_OPTION_NOT_FREE:o.CRAFT_OPTION_NONE;var i;i=t?o.CRAFT_OPTION_NOT_FREE_EXCEPT_ON_FAIL:o.CRAFT_OPTION_NONE;var n;return n=s.noResourceCheckbox.isActivate()?o.CRAFT_OPTION_RESOURCES_REQUIRED:o.CRAFT_OPTION_NONE,e+i+n}function t(){s.jobCrafterDirectorySettings={jobId:s.job.id,minSlot:p,userDefinedParams:e()},window.dofus.sendMessage("JobCrafterDirectoryDefineSettingsMessage",{settings:s.jobCrafterDirectorySettings})}function i(e){var t=window.gui.playerData.jobs.craftersSettings,i={};for(var n in t)if(t[n].jobId===e){i=t[n];break}var a=i.userDefinedParams,r=0!==(a&o.CRAFT_OPTION_NOT_FREE),l=0!==(a&o.CRAFT_OPTION_NOT_FREE_EXCEPT_ON_FAIL),c=0!==(a&o.CRAFT_OPTION_RESOURCES_REQUIRED);s.payingCheckbox.toggleActivation(r),s.freeOnFailCheckbox.toggleActivation(l),s.noResourceCheckbox.toggleActivation(c),s.selector.clearContent();for(var d=window.gui.playerData.jobs.getMaxSlotsByJobId(s.job.id),u=1;u<=d;u+=1)s.selector.addOption(u,u);s.selector.setValue(i.minSlot?i.minSlot:1)}function n(){window.dofus.sendMessage("JobAllowMultiCraftRequestSetMessage",{enabled:!this.isPublicMode})}a.call(this,{className:"JobOptionsWindow",title:l("ui.craft.jobOptions"),positionInfo:{left:"c",top:"c",width:400,height:240}});var s=this,u=l("ui.craft.enablePublicMode"),h=l("ui.craft.disablePublicMode"),p=1;this.once("open",function(){var e=s.windowBody.createChild("div",{className:"container"});e.createChild("div",{text:l("ui.craft.referencingOptions")}),s.payingCheckbox=e.appendChild(new c(l("ui.craft.notFree"))),s.freeOnFailCheckbox=e.appendChild(new c(l("ui.craft.freeIfFailed"))),s.freeOnFailCheckbox.addClassNames("freeOnFail"),s.noResourceCheckbox=e.appendChild(new c(l("ui.craft.ressourcesNeeded")));var i=e.createChild("div",{className:"selectorWrapper"});i.createChild("div",{className:"selectorLabel",text:l("ui.craft.minItemInCraft")}),s.selector=i.appendChild(new d),s.selector.on("change",function(e){p=Number(e)});var o=s.windowBody.createChild("div",{className:"buttons"});this.publicButton=o.appendChild(new r(u,{className:"publicButton"})),this.publicButton.on("tap",n),this.saveButton=o.appendChild(new r(l("ui.common.save"),{className:"saveButton"})),this.saveButton.on("tap",t),window.gui.playerData.jobs.on("jobPublicMode",function(e){s.publicButton.setText(e?h:u),s.publicButton.isPublicMode=e})}),this.on("open",function(e){this.job=window.gui.playerData.jobs.list[e.jobId],this.freeOnFailCheckbox.toggleDisplay(!!this.job.info.specializationOfId),i(e.jobId)})}i(1068);var o=i(1069),s=i(172).inherits,a=i(541),r=i(335).DofusButton,l=i(29).getText,c=i(612),d=i(532);s(n,a),e.exports=n},function(e,t){},function(e,t){e.exports={CRAFT_OPTION_NONE:0,CRAFT_OPTION_NOT_FREE:1,CRAFT_OPTION_NOT_FREE_EXCEPT_ON_FAIL:2,CRAFT_OPTION_RESOURCES_REQUIRED:4}},function(e,t,i){function n(){function e(e){n.selectedSpellId=e.spellId,n.selectedSpellName=e.spellName}function t(e,t){var i=new c("div",{className:"icon",name:"icon"});i.setStyle("backgroundImage",t),u(i,function(){return new h({spell:e})}),n.table.addRow({icon:i,name:e.spell.nameId,rank:e.level},{spellId:e.id,spellName:e.spell.nameId})}function i(e){for(var i=[],o=0;o<e.length;o++){var s=e[o];i.push(s.getIconUri())}p.preloadImages(i,function(i){for(var o=0;o<e.length;o++)t(e[o],i[o]);e.length>0?(n.table.highlight(0),n.validButton.enable()):n.validButton.disable()})}a.call(this,{className:"SpellForgetWindow",title:l("ui.spellForget.title"),positionInfo:{left:"c",top:"c",width:400,height:350}});var n=this;this.selectedSpellId=null,this.selectedSpellName=null,this.table=this.windowBody.appendChild(new d({colIds:["icon","name","rank"],colCount:3,highlightable:!0,headerContent:["",l("ui.common.spellName"),l("ui.social.guildRank")],onRowTap:e})),this.validButton=this.windowBody.appendChild(new r(l("ui.common.validation"))),this.validButton.on("tap",function(){n.selectedSpellId&&window.gui.openConfirmPopup({title:l("ui.popup.warning"),message:l("ui.popup.spellForgetConfirm",n.selectedSpellName),cb:function(e){e&&window.dofus.sendMessage("ValidateSpellForgetMessage",{spellId:n.selectedSpellId})}})}),this.on("open",function(){this.table.clearContent();var e=window.gui.playerData.characters.mainCharacter.spellData.getSpells(m.USABLE),t=[];for(var n in e){var o=e[n];o.level>1&&t.push(o)}i(t)}),this.on("close",function(){this.selectedSpellId=null,this.selectedSpellName=null}),window.gui.on("SpellForgetUIMessage",function(e){e.open?s.openDialog("spellForget"):s.close("spellForget")})}i(1071);var o=i(172).inherits,s=i(194),a=i(541),r=i(335).DofusButton,l=i(29).getText,c=i(321),d=i(649),u=i(337).addTooltip,h=i(745),p=i(182),m=i(415).SpellData.SPELL_STATUS;o(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(e,t,i,n,o){var s=new _({className:[e,"blackButton"],text:t,tooltip:i},n);return o&&(t&&s.createChild("div",{className:"btnText",text:t}),s.createChild("div",{className:"btnIcon"})),s}function o(e,t,i){k.call(this,"div",{className:e}),this.myWindow=t,D(this),this.on("tap",i)}function s(){P.call(this,{title:"",noCloseButton:!0,className:"CharacterCreationWindow",positionInfo:{left:"c",top:"c",width:"85%",maxWidth:950,height:"100%",isFullScreen:!0}}),this._reset(),this.on("open",function(){this.addClassNames(["disabled","spinner"])}),this.on("opened",this._initialize)}function a(e,t){for(var i in e){var n=e[i];if(~~n.skins===t)return n.order}return 0}function r(){var e=this,t=e;I.getItems([t.itemId],function(e,i){return e?console.error(e):void R.showNotification(C("tablet.charCrea.potionNeeded",i[0].getName()),t)})}function l(){var e=this.myWindow;if(e.breedId!==this.breedId)return Date.now()-e.lastRendering<oe?console.warn("Ignoring hammered button"):void e._selectBreed(this.breedId)}function c(){this.myWindow._selectHead(this.headOrder,!0)}function d(e){var t=e.substring(1,e.length-1).split("|");return{bone:t[0],skin:t[1],color:t[2],scale:t[3]}}function u(){window.clearInterval(fe),fe=null,me.setColor(re,le),me.myWindow._updateSprite()}function h(e){e&&(fe&&u(),me=e,re=e.getColor(),le=e.isCustomColor(),he=0,pe=Date.now(),fe=window.setInterval(h,ce));var t=ue[he%ue.length],i={rgb:t,hex:w.colorArrayToHexa(t)};me.setColor(i),me.myWindow._updateSprite(),he++,Date.now()-pe>=de&&u()}function p(){var e=this.myWindow;e._selectColor(this.id),h(e.selectedColorBtn)}function m(e,t){var i=w.parseIndexedColor(t).color,n=[i.r,i.g,i.b];e.setColor({rgb:n,hex:w.colorArrayToHexa(n)})}i(1073);var f=i(182),g=i(167),_=i(335),v=i(179),y=i(369),b=i(601),M=i(918),w=i(378),T=i(373),C=i(29).getText,A=i(172).inherits,I=i(461),S=i(1074),E=i(342),x=i(436),N=i(339).showProgressively,L=i(30),O=i(563),D=i(197),R=i(337),P=i(541),B=i(194),k=i(321),z=i(1076),F=i(1078),H=i(1080).onSubmitRules,q=i(1080).onChangeRules,W=[2,1,2,1,3,2,1,1,1,3,1,2,3,2,2],U=13518,G=10860,j=10861,Y=10862,V=.6,X={1:[174,252],2:[173,252],3:[197,252],4:[218,254],5:[172,253],6:[179,255],7:[189,253],8:[194,254],9:[195,252],10:[210,253],11:[200,256],12:[174,252],13:[238,239],14:[213,208],15:[259,239]},Q=[200,252],K=0,J=1,Z=2,$=3,ee=1e3/24,te=0,ie=1,ne=8,oe=500,se=.85,ae=5;A(o,k),o.prototype.setSelected=function(e){e?this.addClassNames("selected"):this.delClassNames("selected")},A(s,P),e.exports=s,s.prototype._reset=function(){this.step=K,this.relookingParams=null,this.allBreeds=null,this.numBreeds=0,this.headsMap=null,this.loadedHeads=[],this.lastRendering=0,this.breedBtns=[],this.headContainers=[],this.nameInput=null,this.currentIllustration=null,this.breedIllustration=this.breedIllustrationFade=null,this.breedDescription=null,this.breedName=null,this.breedStory=null,this.breedSelector=null,this.headSelector=null,this.colorPicker=null,this.colorButtons=null,this.selectedColor=null,this._assetUrlCache={},this.spriteStatus={},this.breedId=1,this.sex=te,this.cosmeticId=1,this.headOrder=0},s.prototype.freeContent=function(){document.activeElement.blur(),this.characterDisplay&&this.characterDisplay.release(),this.characterDisplay=null,this.windowBody.clearContent(),this.centeredContent.clearContent(),this._reset()},s.prototype._initialize=function(e){if(!this.allBreeds){var t=this;return void this._createAll(function(i){return i?console.error("characterCreation: initialize error",i):(t._initialize(e),void t._loadHeadImages())})}this.relookingParams=e&&e.relookingParams,this.relookingParams?this._initCharacterForRelooking():this._initRandomCharacter(),this.delClassNames(["disabled","spinner"])},s.prototype._initRandomCharacter=function(){this._stepLayoutSetup(J),this.nameInput.setValue(""),this.sex=Math.random()>.45?ie:te,this.breedSexTabs.openTab(this.sex),this.headSexTabs.openTab(this.sex);var e,t=Math.floor(Math.random()*this.numEasyBreeds),i=0;for(e=1;e<=this.numBreeds;e++)if(!(this.allBreeds[e].complexity>1)){if(i===t)break;i++}var n=Math.floor(Math.random()*ne);this._selectBreed(e,n)},s.prototype._initCharacterForRelooking=function(){var e,t,i=this.relookingParams;i.canRename?(e=C("ui.connection.rename"),t=C("ui.charcrea.titleRename")):i.canRecolor?(e=C("ui.connection.recolor"),t=C("ui.charcrea.titleRecolor")):i.canReface&&(e=C("ui.connection.relook"),t=C("ui.charcrea.titleRelook")),e&&(window.gui.openSimplePopup(e,C("ui.popup.warning")),this.pageTitle.setText(t));var n=i.characterToRelook,o=T.getLookWithoutMount(n.entityLook),s=a(this.headsMap,o.skins[1]);this.nameInput.setValue(n.name),this.sex=n.sex?ie:te,this.headSexTabs.openTab(this.sex),this._stepLayoutSetup(Z),this._selectBreed(n.breed,s,o.indexedColors),this.relookingParams.canRecolor&&this._selectColor(0)},s.prototype._createAll=function(e){this.allBreeds=window.gui.databases.Breeds,this.numBreeds=Object.keys(this.allBreeds).length,this.numEasyBreeds=0;for(var t=1;t<=this.numBreeds;t++){var i=W[t-1];this.allBreeds[t].complexity=i,1===i&&this.numEasyBreeds++}this._leftSideSetup(),this._centerSetup(),this._rightSideSetup(),this._createBreedElements(),this._createHeadElements(),this._createNavButtons(),this._stepLayoutSetup(J),this._listenersSetup(),this._loadAsyncData(e)},s.prototype._leftSideSetup=function(){this.breedIllustration=this.windowBody.createChild("div",{className:"breedIllustration"}),this.breedIllustrationFade=this.windowBody.createChild("div",{className:"breedIllustration"})},s.prototype._centerSetup=function(){this.centeredContent||(this.centeredContent=this.createChild("div"));var e=this.centeredContent;this._createTopLabel(e),this._createNameSelector(e),this.breedSelector=this._createSelector(e,"breedSexTabs"),this.headSelector=this._createSelector(e,"headSexTabs",!0),this._createBreedDescription(e),this._setupColorTool(e)},s.prototype._rightSideSetup=function(){var e=this.windowBody.createChild("div",{className:"rightBar"});this._setupCharacterOnIsland(e)},s.prototype._spreadVerticaly=function(e,t){for(var i=0,n=0;n<e.length;n++)i+=e[n].rootElement.clientHeight;var o=this.windowBody.rootElement.clientHeight-i;for(n=0;n<e.length;n++){var s=Math.round(o*t[n]/100);e[n].setStyle("marginBottom",Math.max(s,ae)+"px");
}},s.prototype._stepLayoutSetup=function(e){this.step=e;var t=e===Z,i=e===J;this.breedIllustration.toggleDisplay(i||t),this.characterOnIsland.toggleDisplay(i||t),this.breedSexTabs.toggleDisplay(i),this.breedDescription.toggleDisplay(i),this.nextBtn.toggleDisplay(i),this.nameSelector.toggleDisplay(t),this.nameErrWrapper.toggleDisplay(t),this.createBtn.toggleDisplay(t),this.headSexTabs.toggleDisplay(t),this.colorTool.toggleDisplay(t),i?(this._spreadVerticaly([this.topLabel,this.breedSexTabs,this.breedDescription],[15,15,50]),this.backButton.setText(C("ui.common.cancel"))):t&&(this._spreadVerticaly([this.topLabel,this.headSexTabs,this.nameSelector,this.colorTool],[5,5,5,85]),this._selectCurrentHeads(),this.relookingParams?(this._allowElement(this.headSexTabs,!1),this._allowElement(this.nameSelector,this.relookingParams.canRename,G),this._allowElement(this.colorTool,this.relookingParams.canRecolor,j),this.createBtn.setText(C("ui.common.validation")),this.backButton.setText(C("ui.common.cancel"))):(this._selectColor(0,!0),this.backButton.setText(C("ui.common.back"))))},s.prototype._allowElement=function(e,t,i){if(e.toggleTabAvailability){var n=this.sex===te,o=e.header.getChildren(),s=o[n?ie:te],a=o[this.sex],l=e.content;return this._allowElement(s,!1,Y),this._allowElement(a,this.relookingParams.canReface),this._allowElement(l,this.relookingParams.canReface,U),e.toggleTabAvailability(te,n),void e.toggleTabAvailability(ie,!n)}if(e.setStyle("opacity",t?1:V),!t){var c=e.appendChild(new k("div",{className:"disabledFeature"}));i&&(c.itemId=i,D(c),c.on("tap",r))}},s.prototype._next=function(){this._stepLayoutSetup(Z)},s.prototype._back=function(){this.step===J||this.relookingParams?(B.close(this.id),b.backToSelection()):this._stepLayoutSetup(J)},s.prototype._createSelector=function(e,t,i){var n={};n.females=new k("div",{className:"females"}),n.males=new k("div",{className:"males"});var o=e.appendChild(new O({className:["sexTabs",t],tabClassName:"mySwipeTabBtn"}));i&&o.hide(),o.addTab("",n.males,te),o.addTab("",n.females,ie);var s=this;return o.on("openTab",function(e){s._updateSex(e)}),this[t]=o,n},s.prototype._createBreedButton=function(e,t){var i=new o("breedSelectionButton",this,l);i.breedId=e.id;var n=t===te?this.breedSelector.males:this.breedSelector.females;return n=n.getChild(e.complexity),n.appendChild(i),i},s.prototype._createHeadContainer=function(e,t){var i=new k("div",{className:"headContainer",hidden:!0}),n=1+(e-1)*ne*2+t*ne;i.buttons=[];for(var s=0;s<ne;s++){var a=new o("headSelectionButton",this,c);i.appendChild(a),i.buttons.push(a),a.headOrder=s,a.cosmeticId=n+s,a.gender=t}var r=t===te?this.headSelector.males:this.headSelector.females;return r.appendChild(i),i},s.prototype._createBreedElements=function(){for(var e=1;e<=3;e++)this.breedSelector.males.createChild("div",{className:"complexityLevel",name:e}),this.breedSelector.females.createChild("div",{className:"complexityLevel",name:e});for(var t=0;t<this.numBreeds;t++){var i=t+1,n=this.allBreeds[i];this.breedBtns[t]=this._createBreedButton(n,te),this.breedBtns[t+this.numBreeds]=this._createBreedButton(n,ie)}},s.prototype._createHeadElements=function(){for(var e=1;e<=this.numBreeds;e++)this.headContainers[e]=[this._createHeadContainer(e,te),this._createHeadContainer(e,ie)]},s.prototype._loadAsyncData=function(e){var t=this;L.getAllDataMap("Heads",function(i,n){if(i)return e(i);t.headsMap=n;for(var o=[],s=1;s<=t.numBreeds;s++){var a=("0"+s).slice(-2);o.push("gfx/classes/CreaPerso_btn_0"+a+".png"),o.push("gfx/classes/CreaPerso_btn_1"+a+".png")}f.preloadImages(o,function(i){for(var n=0;n<t.numBreeds;n++){var o=t.breedBtns[n];o.setStyles({backgroundImage:i[2*n+te]}),o=t.breedBtns[n+t.numBreeds],o.setStyles({backgroundImage:i[2*n+ie]})}e()})})},s.prototype._loadHeadImages=function(e,t){if(this.loadedHeads[e])return t&&t();var i,n;e?(i=1+(e-1)*ne*2,n=i+2*ne-1,this.loadedHeads[e]=!0):(i=1,n=this.numBreeds*ne*2);for(var o=this.headsMap,s=[],a=i;a<=n;a++)s.push("gfx/cosmetics/"+o[~~a].assetId+".png");var r=this;f.preloadImages(s,function(s){if(!e)for(var a=1;a<=r.numBreeds;a++)r.loadedHeads[a]=!0;for(var l=0,c=i;c<=n;c++){var d=o[~~c],u=r.headContainers[d.breed][d.gender].buttons[d.order];u.setStyle("backgroundImage",s[l++])}t&&t()})},s.prototype._listenersSetup=function(){var e=this;window.gui.on("CharacterCreationResultMessage",function(t){if(t.result===v.OK)return b.confirmNewCharacterCreation(),B.close(e.id);var i;switch(t.result){case v.ERR_INVALID_NAME:i=C("ui.charcrea.nameRules");break;case v.ERR_NAME_ALREADY_EXISTS:i=C("ui.popup.charcrea.nameAlreadyExist");break;case v.ERR_TOO_MANY_CHARACTERS:i=C("ui.popup.charcrea.tooManyCharacters");break;case v.ERR_NOT_ALLOWED:i=C("ui.popup.charcrea.notSubscriber");break;case v.ERR_RESTRICED_ZONE:i=C("ui.charSel.deletionErrorUnsecureMode");break;default:i=C("ui.popup.charcrea.noReason")}R.showNotification(i,e.createBtn),e.delClassNames(["disabled","spinner"])}),window.gui.on("CharacterNameSuggestionSuccessMessage",function(t){e.nameInput.setValue(t.suggestion,!0)})},s.prototype._buildColorsArray=function(){for(var e=new Array(g.CHARACTER_COLORS),t=0;t<g.CHARACTER_COLORS;t++){var i=this.colorButtons[t].getColor();e[t]=w.getIndexedColor(t+1,i.rgb[0],i.rgb[1],i.rgb[2])}return e},s.prototype._selectCurrentHeads=function(){if(this.headSexTabs.isVisible()){for(var e=1,t=this.numBreeds;e<=t;e++)this.headContainers[e][te].hide(),this.headContainers[e][ie].hide();this.headContainers[this.breedId][te].show(),this.headContainers[this.breedId][ie].show()}},s.prototype._updateSprite=function(e){var t=this.allBreeds[this.breedId],i=d(t[(this.sex===ie?"female":"male")+"Look"]),n=i.skin,o=i.scale,s=this.headsMap[this.cosmeticId].skins,a=this._buildColorsArray().join("#");this.spriteStatus.bodySkin===n&&this.spriteStatus.headSkin===s&&this.spriteStatus.colorsHash===a&&this.spriteStatus.orientation===this.orientation&&this.spriteStatus.scale===o||(this.spriteStatus.bodySkin=n,this.spriteStatus.headSkin=s,this.spriteStatus.colorsHash=a,this.spriteStatus.orientation=this.orientation,this.spriteStatus.scale=o,this._drawCharacter(e))},s.prototype._getAsset=function(e,t){var i=this;return this._assetUrlCache[e]?t(this._assetUrlCache[e]):void f.preloadImage(e,function(n){i._assetUrlCache[e]=n,t(n)})},s.prototype._updateBreedIllustration=function(){if(this.breedIllustration.isVisible()){var e="gfx/illusUi/illus_classe/artwork_"+this.breedId+this.sex+".png";if(e!==this.currentIllustration){this.currentIllustration=e;var t=this.breedIllustration;this.breedIllustration=this.breedIllustrationFade,this.breedIllustrationFade=t,N(null,500,null,this.breedIllustrationFade),this.breedIllustration.addClassNames("spinner");var i=this;this._getAsset(e,function(e){i.breedIllustration&&(i.breedIllustration.setStyle("backgroundImage",e),i.breedIllustration.delClassNames("spinner"),N(i.breedIllustration,500))})}}},s.prototype._updateBreedIsland=function(){var e=this;this._getAsset("gfx/bases/base_"+this.breedId+".png",function(t){if(e.characterDisplay){var i=X[e.breedId];i||(console.warn("Missing center tile data for breed:",e.breedId),i=Q);var n=e.characterDisplay.rootElement.getBoundingClientRect(),o=.5*n.width,s=se*n.height;e.islandImage.setStyles({backgroundImage:t,left:o-i[0]+"px",top:e.characterDisplay.rootElement.offsetTop+s-i[1]+"px"}),N(e.islandImage),N(e.rotationLeft),N(e.rotationRight)}})},s.prototype._updateBreedDescription=function(){var e=this.allBreeds[this.breedId];this.breedName.setText(e.longNameId),this.breedStory.content.setText(e.gameplayDescriptionId),this.breedStory.refresh(),this.breedStory.goToTop(),this.breedComplexity.replaceClassNames(["level1","level2","level3"],["level"+e.complexity])},s.prototype._toggleBreedBtn=function(e,t){this.breedBtns[e-1].setSelected(t),this.breedBtns[e-1+this.numBreeds].setSelected(t)},s.prototype._selectBreed=function(e,t,i){this._toggleBreedBtn(this.breedId,!1),this._toggleBreedBtn(e,!0),this.breedId=e,this._updateBreedIllustration(),this.characterDisplay.setStyle("opacity",0),this._updateBreedIsland(),this._updateBreedDescription(),this._selectCurrentHeads(),this._loadHeadImages(e),this._selectHead(void 0!==t?t:this.headOrder),i?this._loadColors(i):this._resetColors(),this.orientation=$,this._updateSprite(!0)},s.prototype._updateSex=function(e){this.sex!==e&&(this.sex=e,this._updateBreedIllustration(),this._selectCurrentHeads(),this._selectHead(this.headOrder),this.headSexTabs.openTab(e),this.breedSexTabs.openTab(e),this._resetColors(!0),this._updateSprite(!0))},s.prototype._selectHead=function(e,t){var i=this.headContainers[this.breedId][this.sex].buttons[e];if(i.cosmeticId!==this.cosmeticId){this.cosmeticId=i.cosmeticId,this.headOrder=e;for(var n=this.headContainers[this.breedId][this.sex].buttons,o=0;o<n.length;o++)n[o].setSelected(n[o]===i);t&&this._updateSprite(!1)}};var re,le,ce=100,de=500,ue=[[255,144,0],[255,228,0]],he=0,pe=0,me=null,fe=null;s.prototype._setupColorTool=function(e){var t=this.colorTool=e.createChild("div",{className:"colorTool",hidden:!0});t.setStyle("opacity",0),t.show();var i=this.colorSelector=t.createChild("div",{className:"colorSelector"}),o=i.createChild("div",{className:"colorButtons"}),s=o.createChild("div",{className:"buttonBox"});this.colorButtons=new Array(g.CHARACTER_COLORS+1);for(var a=0;a<=g.CHARACTER_COLORS;a++)this.colorButtons[a]=s.appendChild(new S(this,a,p,{active:a<g.CHARACTER_COLORS}));this.selectedColorBtn=null;var r=i.createChild("div",{className:"picker"}),l=this.pickerRect=r.rootElement.getBoundingClientRect();this.colorPicker=r.appendChild(new M),this.colorPicker.updateDimensions(l.width,l.height),t.hide(),t.setStyle("opacity",1);var c=this;this.colorPicker.on("newColor",function(e){if(c.selectedColorBtn){c.selectedColorBtn.setColor(e,!0);var t=Date.now();(!c.colorPicker.lastUpdate||t-c.colorPicker.lastUpdate>ee)&&(c.colorPicker.lastUpdate=t,c._updateSprite())}}),this.colorPicker.on("colorChanged",function(e){c.selectedColorBtn&&(c.selectedColorBtn.setColor(e,!0),c._updateSprite())});var d=this.colorPickerFooter=t.createChild("div",{className:"colorPickerFooter"});d.appendChild(new n("resetColorBtn","",C("tablet.charCrea.resetCurrentColor"),function(){return c.selectedColorBtn&&c.selectedColorBtn.getColor()?(c._resetColorButton(c.selectedColorBtn),c._selectColor(c.selectedColorBtn.id,!0),void c._updateSprite()):R.showNotification(C("tablet.charCrea.resetCurrentColor"),this)},(!0))),d.appendChild(new n("randomColorBtn",C("tablet.charCrea.randomColors"),C("tablet.charCrea.randomColorsTip"),function(){for(var e=0;e<g.CHARACTER_COLORS;e++)c.colorButtons[e].randomize();c._selectColor(0,!0),c._updateSprite()},(!0))),d.appendChild(new n("resetAllColorBtn",C("tablet.charCrea.resetAll"),C("tablet.charCrea.resetAllTip"),function(){c._resetColors(),c._updateSprite()}))},s.prototype._createTopLabel=function(e){var t=this.topLabel=e.createChild("div",{className:"topLabel"});t.createChild("div",{className:"topLabelBackground"}),t.createChild("div",{className:"fioritureRococo"}),this.pageTitle=t.createChild("div",{className:"topLabelText",text:C("ui.charcrea.title")})},s.prototype._createBreedDescription=function(e){this.breedDescription=e.createChild("div",{className:"breedDescription"});var t=this.breedDescription.createChild("div",{className:"descriptionZone"}),i=t.createChild("div",{className:"descriptionText"});this.breedName=i.createChild("div",{className:"breedName",text:"."}),this.breedName.setText(""),this.breedStory=i.appendChild(new x({className:"breedStory"},{showHintArrows:!0}));var o=i.createChild("div",{className:"footer"}),s=this.breedComplexity=o.createChild("div",{className:"breedComplexity"});s.createChild("div",{className:"label",text:C("tablet.charCrea.difficulty")+C("ui.common.colon")}),s.createChild("div",{className:["sword","sword1"]}),s.createChild("div",{className:["sword","sword2"]}),s.createChild("div",{className:["sword","sword3"]});var a=this;this.moreInfoBtn=o.appendChild(new n("moreInfoBtn",C("ui.charcrea.more"),"",function(){B.open("breedDetail",{breedData:a.allBreeds[a.breedId]})}));var r=this.rootElement.clientHeight-this.breedDescription.rootElement.offsetTop-2*this.breedStory.rootElement.offsetTop;this.breedStory.setStyle("maxHeight",r+"px")},s.prototype._createNameSelector=function(e){var t=this.nameSelector=e.createChild("div",{className:"nameSelector",hidden:!0}),i=this.nameErrWrapper=e.createChild("div",{className:"nameErrors",hidden:!0}),o=i.appendChild(new F);this.nameInput=t.appendChild(new z({className:"nameInput",attr:{type:"text",id:"nameInput",maxlength:E.MAX_PLAYER_NAME_LEN},onChangeRules:q,onSubmitRules:H,blockInvalidInput:!1},function(e){e.blur()})),this.nameInput.setPlaceholder(C("ui.popup.charcrea.noName")),this.nameInput.on("validationFailed",function(e){var t=[];e.forEach(function(e){t.push(" - "+C(e.error))}),t.length>0&&o.setText(t.join("\n"))}),this.nameInput.on("validationPassed",function(){o.setText("")}),this.randomiseBtn=t.appendChild(new n("randomiseBtn","",C("tablet.charCrea.randomNameTip"),function(){window.dofus.sendMessage("CharacterNameSuggestionRequestMessage")},(!0)))},s.prototype._createRotationButton=function(e,t){var i=this,n=this.characterOnIsland.createChild("div",{className:e,hidden:!0}),o=n.appendChild(new _({className:"shadow",repeatDelay:100},function(){i.orientation=i.characterDisplay.rotateCharacter(t)}));return o.createChild("div",{className:"arrow"}),n},s.prototype._setupCharacterOnIsland=function(e){var t=this.characterOnIsland=e.createChild("div",{className:"characterOnIsland"});this.islandImage=t.createChild("div",{className:"islandImage"}),this.characterDisplay=t.appendChild(new y({scale:2})),this.rotationRight=this._createRotationButton("rotationRight",!0),this.rotationLeft=this._createRotationButton("rotationLeft",!1)},s.prototype._createNavButtons=function(){var e=this;this.backButton=this.windowBody.appendChild(new n("cancelBtn","","",function(){e._back()})),this.nextBtn=this.characterOnIsland.appendChild(new _({text:C("tablet.charCrea.next"),className:["greenButton","nextBtn"]},function(){e._next()})),this.createBtn=this.characterOnIsland.appendChild(new _({text:C("ui.charcrea.create"),className:["greenButton","createButton"]},function(){e._createCharacter()}))},s.prototype._createCharacter=function(){var e=this.nameInput.getValue();if(e!==!1){var t=e.length;if(0===t)return R.showNotification(C("ui.popup.charcrea.noName"),this.createBtn);if(t<E.MIN_PLAYER_NAME_LEN||t>E.MAX_PLAYER_NAME_LEN)return R.showNotification(C("ui.charcrea.nameRules"),this.createBtn);var i={name:e,breed:this.breedId,sex:this.sex===ie,colors:this._buildColorsArray(),cosmeticId:this.cosmeticId};this.relookingParams?(i.headSkin=this.spriteStatus.headSkin,b.confirmCharacterRelooking(i)):(this.addClassNames(["disabled","spinner"]),document.activeElement.blur(),window.dofus.sendMessage("CharacterCreationRequestMessage",i))}},s.prototype._buildEntityLook=function(){return{bonesId:1,indexedColors:this._buildColorsArray(),scales:[this.spriteStatus.scale],skins:[this.spriteStatus.bodySkin,this.spriteStatus.headSkin],subentities:[]}},s.prototype._drawCharacter=function(e){this.lastRendering=Date.now();var t=this;this.characterDisplay.setLook(this._buildEntityLook(),{boneType:"characters/",skinType:"characters/",direction:this.orientation},function(){e&&N(t.characterDisplay,300,50)})},s.prototype._selectColor=function(e,t){var i=this.colorButtons[e];(i!==this.selectedColorBtn||t)&&(this.selectedColorBtn&&this.selectedColorBtn.deselect(),this.selectedColorBtn=i,i.select(),this.colorPicker.setCurrentColor(i.getColor().rgb))},s.prototype._resetColorButton=function(e){var t=(this.sex===ie?"female":"male")+"Colors",i=this.allBreeds[this.breedId][t][e.id];m(e,i)},s.prototype._resetColors=function(e){for(var t=0;t<g.CHARACTER_COLORS;t++){var i=this.colorButtons[t];e&&i.isCustomColor()||this._resetColorButton(i)}this._selectColor(0,!0)},s.prototype._loadColors=function(e){for(var t=0;t<g.CHARACTER_COLORS;t++)m(this.colorButtons[t],e[t])}},function(e,t){},function(e,t,i){function n(e,t,i,n){n=n||{},this.myWindow=e,this.id=t,this.active=n.active,this.selected=!1,this.currentColor=null,this.isCustom=!1,a.call(this,"div",{className:"plusColorButton"}),r(this),this.active&&i&&"function"==typeof i?this.on("tap",i):this.addClassNames("inactive"),this.plainColor=this.createChild("div",{className:"plainColor"})}i(1075);var o=i(378),s=i(172).inherits,a=i(321),r=i(197);s(n,a),e.exports=n,n.prototype.select=function(){this.addClassNames("selected"),this.selected=!0},n.prototype.deselect=function(){this.delClassNames("selected"),this.selected=!1},n.prototype.isCustomColor=function(){return this.isCustom},n.prototype.setColor=function(e,t){this.isCustom=t,this.currentColor=e,e?(this.plainColor.setStyle("display","block"),this.plainColor.setStyle("background",e.hex),this.plainColor.setStyle("background","-moz-linear-gradient(top,  #ffffff 0%, "+e.hex+" 14%, "+e.hex+" 85%, "+e.hex+" 85%, #110f0d 100%)"),this.plainColor.setStyle("background","-webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(14%,"+e.hex+"), color-stop(85%,"+e.hex+"), color-stop(85%,"+e.hex+"), color-stop(100%,#110f0d))"),this.plainColor.setStyle("background","-webkit-linear-gradient(top,  #ffffff 0%,"+e.hex+" 14%,"+e.hex+" 85%,"+e.hex+" 85%,#110f0d 100%)"),this.plainColor.setStyle("background","-o-linear-gradient(top,  #ffffff 0%,"+e.hex+" 14%,"+e.hex+" 85%,"+e.hex+" 85%,#110f0d 100%)"),this.plainColor.setStyle("background","-ms-linear-gradient(top,  #ffffff 0%,"+e.hex+" 14%,"+e.hex+" 85%,"+e.hex+" 85%,#110f0d 100%)"),this.plainColor.setStyle("background","linear-gradient(to bottom,  #ffffff 0%,"+e.hex+" 14%,"+e.hex+" 85%,"+e.hex+" 85%,#110f0d 100%)")):this.plainColor.setStyle("display","none")},n.prototype.getColor=function(){return this.currentColor},n.prototype.randomize=function(){var e=Math.floor(255*Math.random()),t=Math.floor(255*Math.random()),i=Math.floor(255*Math.random()),n=[e,t,i];n={rgb:n,hex:o.colorArrayToHexa(n)},this.setColor(n,!0)}},function(e,t){},function(e,t,i){function n(e,t){function i(e){!e.regex||e.regex instanceof RegExp||(e.regex=new RegExp(e.regex,e.regexFlags))}s.call(this,e,t),this.addClassNames("InputBoxValidated");var n="",o=this.onChangeRules=e.onChangeRules||[],a=this.onSubmitRules=e.onSubmitRules||[],r=void 0===e.blockInvalidInput||e.blockInvalidInput;o.forEach(i),a.forEach(i),this.on("change",function(e){for(var t=[],i=0;i<o.length;i+=1){var s=o[i],a=void 0===s.expectedResult||s.expectedResult;s.regex&&s.regex.test(e)!==a&&(s.transform?e=s.transform(e):t.push({error:s.error}))}t.length>0&&r?this.setValue(n,!1):(n=e,this.setValue(n,!1)),t.length>0?(this.addClassNames("invalid"),this.emit("validationFailed",t)):(this.delClassNames("invalid"),this.emit("validationPassed"))})}i(1077);var o=i(172).inherits,s=i(530);o(n,s),e.exports=n,n.prototype.getValue=function(e){var t=s.prototype.getValue.call(this);if(e=void 0===e||e,!e)return t;var i,n,o,a=[];for(i=0;i<this.onChangeRules.length;i+=1)n=this.onChangeRules[i],o=void 0===n.expectedResult||n.expectedResult,n.regex&&n.regex.test(t)!==o&&n.error&&a.push({error:n.error});for(i=0;i<this.onSubmitRules.length;i+=1)n=this.onSubmitRules[i],o=void 0===n.expectedResult||n.expectedResult,n.regex&&n.regex.test(t)!==o&&n.error&&a.push({error:n.error});return 0===a.length?(this.delClassNames("invalid"),this.emit("validationPassed"),t):(this.addClassNames("invalid"),this.emit("validationFailed",a),!1)}},function(e,t){},function(e,t,i){function n(e){e=e||{},s.call(this,"div",e),this.addClassNames("InputBoxErrors"),this.setText(e.text||"")}i(1079);var o=i(172).inherits,s=i(321);o(n,s),e.exports=n,n.prototype.setText=function(e){s.prototype.setText.call(this,e),e?this.show():this.hide()}},function(e,t){},function(e,t){t.onChangeRules=[{regex:"^[a-z]$",expectedResult:!1,transform:function(e){return e.toUpperCase()}},{regex:"([A-Z].*|\\[[A-Z].*|)$",error:"tablet.charCrea.name.capStart"},{regex:"^[a-z-\\[\\]]*$",regexFlags:"i",error:"tablet.charCrea.name.lettersDashes"},{regex:"[\\s]+",expectedResult:!1,error:"tablet.charCrea.name.noSpaces"},{regex:"^(-|[a-z]-)",expectedResult:!1,regexFlags:"i",error:"tablet.charCrea.name.no1st2ndDash"},{regex:"^.*-.*-",expectedResult:!1,error:"tablet.charCrea.name.1DashMax"},{regex:"^.*[^-\\[][A-Z]",expectedResult:!1,error:"tablet.charCrea.name.capAfterDash"},{regex:"(.)\\1{2,}",expectedResult:!1,regexFlags:"i",error:"tablet.charCrea.name.identical2Consec"},{regex:"([b-df-hj-np-tv-xz]){4,}",expectedResult:!1,regexFlags:"i",error:"tablet.charCrea.name.consonants3Consec"},{regex:"^[\\S]{,20}$",expectedResult:!1,error:"tablet.charCrea.name.nameLength"}],t.onSubmitRules=[{regex:"^[\\S]{3,20}$",error:"tablet.charCrea.name.nameLength"},{regex:"[aeiouy]+",regexFlags:"i",error:"tablet.charCrea.name.must1Vowel"}]},function(e,t,i){function n(e){function t(e){e=e||{},h._totalFailure=0,h._totalSuccess=0,h._done=0;var t=[],i=h._mySlotElems.getGivenIngredientsInfo(),n=h._targetSlotElems.getGivenIngredientsInfo();i.length>0&&n.length<=0&&(t=i,t.push(h._mySlotElems.getRuneSignatureInfo()));var o=h.jobsData.checkRecipe(h._skillId);if(h._skillId===h.jobsData.SKILLID_DECRAFT)for(var s=0;s<t.length;s+=1){var a=t[s];a.GID&&(o.itemToCraft.ingredientIds.push(a.GID),o.itemToCraft.quantities.push(a.quantity))}h._craftResultBox.checkRecipe(t,o),o.isRecipeKnown&&!e.keepResultVisible?(h._itemResult.hide(),h._craftResultBox._clearProgress(),h.highlightedRecipeId=o.itemToCraft.resultId):h.highlightedRecipeId=null,h._recipeList.highlightRecipe(h.highlightedRecipeId)}function i(e){h._totalQty=e.count,h._craftResultBox.setQty(h._totalQty,!0),h._isInAutoCraft=h._totalQty>1}function n(e){e=e||{count:0};var t=e.count||0;h._done=h._totalQty-t,h._craftResultBox.setProgress(h._done,h._totalQty)}function o(e){var i=e.reason;c.displayAutoCraftStopReasonMessage(i),h._isInAutoCraft=!1,i===p.STOPPED_REASON_OK&&n({count:0}),t({keepResultVisible:!0}),h._restoreMergeStopButtons()}e=e||{},s.call(this,{className:"CraftingWindow",title:"",noCloseButton:!0,positionInfo:{left:"0.5%",bottom:"2%",width:"76%",height:"95%",isDefault:!0}});var r={left:"0.5%",bottom:"2%",width:320,height:"95%"};this._positionInfos={decrafting:r,wrapping:r};var l={right:"0.5%",bottom:"2%",width:"34.8%",height:"95%"};this._inventoryPositionInfos={decrafting:l,wrapping:l},this._mergeLabels={crafting:a("ui.common.merge"),decrafting:a("ui.common.decraft")};var h=this,m=window.gui;this._domCreated=!1,this._recipeList=null,this._mySlotElems=null,this._targetSlotElems=null,this._craftResultBox=null,this._itemResult=null,this._totalQty=1,this._done=0,this._isInAutoCraft=!1,this._skillId=null,this.jobsData=m.playerData.jobs,this.addAndModifySlots=function(e){u.createItemInstances(e,function(e,i){if(e)return console.error("Crafting: addAndModifySlots cannot createItemInstances",e);var n=i.array[0];m.playerData.inventory.objects[n.objectUID]?h._mySlotElems.addAndModifySlot(n):h._targetSlotElems.addAndModifySlot(n),h._mySlotElems.setNbSlots(),h._targetSlotElems.setNbSlots(),t()})},this.objectRemoved=function(e){h._targetSlotElems.removeIngredient(e),h._mySlotElems.removeIngredient(e),h._mySlotElems.setNbSlots(),h._targetSlotElems.setNbSlots(),t()},this._onResultEvents=function(e){h._onResult(e,function(e,t){return e?console.error("Crafting: onResult error",e):void h.giveTheResult(t.objectInfo,t.message)})},this._slotCountIncreased=function(e){var t=e.newMaxSlot;h._updateRecipeList(t),h._updateSlotElems(t)},this._updateSlotElems=function(e){h._updateMySlotElems(e)},m.on("ExchangeCraftResultMessage",this.localizeEvent(h._onResultEvents)),m.on("ExchangeCraftResultWithObjectIdMessage",this.localizeEvent(h._onResultEvents)),m.on("ExchangeCraftResultWithObjectDescMessage",this.localizeEvent(h._onResultEvents)),m.on("ExchangeReplayCountModifiedMessage",this.localizeEvent(i)),m.on("ExchangeItemAutoCraftRemainingMessage",this.localizeEvent(n)),m.on("ExchangeItemAutoCraftStopedMessage",this.localizeEvent(o)),m.on("ExchangeCraftSlotCountIncreasedMessage",this.localizeEvent(h._slotCountIncreased)),this.on("open",function(e){h._domCreated||h._createDom(),h._onOpen(e)}),this.on("close",function(){h._mySlotElems.clear(),h._targetSlotElems.clear(),h._recipeList.reset(),h._craftResultBox.clear(),h.jobsData.clearAfterCraft(),h._skillId=null,h._paymentButton.hide(),d.close("craftPayment")}),this.on("closed",function(){this._updatePerCraftType()}),this._buttonMergeAction=function(){function e(){window.dofus.sendMessage("ExchangeReadyMessage",{ready:!0,step:2}),h._isInAutoCraft?(h._stopBtn.enable(),h._buttonMerge.disable()):h._restoreMergeStopButtons()}var t=h._mySlotElems.getGivenIngredientsInfo().length;if(t+=h._targetSlotElems.getGivenIngredientsInfo().length,!(t<1))return h._skillId!==h.jobsData.SKILLID_DECRAFT?e():void window.gui.openConfirmPopup({title:a("ui.popup.warning"),message:a("ui.craft.decraftConfirm"),cb:function(t){t&&e()}})}}i(1082);var o=i(172).inherits,s=i(541),a=i(29).getText,r=i(910),l=i(335).DofusButton,c=i(627),d=i(194),u=i(461),h=i(1083),p=i(628),m=i(853),f=i(1084),g=i(1086),_=i(317);o(n,s),e.exports=n,n.prototype._restoreMergeStopButtons=function(){this._stopBtn.disable(),this._buttonMerge.enable()},n.prototype._createDom=function(){var e=this,t=this.windowBody.createChild("div",{className:"col1"}),i=this.windowBody.createChild("div",{className:"col2"});this._recipeList=t.appendChild(new r({showCraftableFilter:!0})),this._recipeList.on("recipeSelected",function(t){return this.isRecipeCraftableFromInventory(t)?void(t!==e.highlightedRecipeId?window.dofus.sendMessage("ExchangeSetCraftRecipeMessage",{objectGID:t}):e._totalQty<e._craftResultBox.getMaxQuantity()?e._requestReplayCountChange(e._totalQty+1):e._craftResultBox.setQty(e._totalQty,!0)):window.gui.openSimplePopup(a("ui.craft.dontHaveAllIngredient"))}),this._targetSlotElems=i.appendChild(new g),this._mySlotElems=i.appendChild(new g),_.on("dragStart",e.localizeEvent(function(t,i){switch(i){case"craftInventory":e._mySlotElems.showDropHighlight(t.getItem()),t.once("dragEnd",function(){e._mySlotElems.hideDropHighlight()});break;case"recipeList":e._craftResultBox.selectSlot(!0),t.once("dragEnd",function(){e._craftResultBox.selectSlot(!1)})}})),this._craftResultBox=i.appendChild(new f),this._craftResultBox.on("craftReplayCount",function(t){e._requestReplayCountChange(t)});var n=i.createChild("div",{className:"buttonsContainer"});this._buttonMerge=n.appendChild(new l(a("ui.common.merge"),{className:"mergeButton"})),this._buttonMerge.on("tap",e._buttonMergeAction),this._stopBtn=n.appendChild(new l(a("ui.common.stop"),{className:"stopButton",disable:!0})),this._stopBtn.on("tap",function(){window.dofus.sendMessage("ExchangeReplayStopMessage")}),this._paymentButton=n.appendChild(new l(a("ui.common.payment"),{className:"paymentButton"})),this._paymentButton.on("tap",function(){d.open("craftPayment")}),this._itemResult=i.createChild("div",{className:"itemResult"});var o=this._itemResult.createChild("div",{className:"titleBar"});this._itemName=o.createChild("div",{className:"itemName"}),this._itemLevel=o.createChild("div",{className:"itemLevel"}),this._itemDescription=this._itemResult.appendChild(new m),this._domCreated=!0},n.prototype._requestReplayCountChange=function(e){window.dofus.sendMessage("ExchangeReplayMessage",{count:e})},n.prototype._updateRecipeList=function(e){var t=this.jobsData.getRecipesBySkill(this._skillId);this._recipeList.addRecipes(t,{nbCase:e,mode:"craft"});var i=e>8?8:e;this.jobsData.setExistingSlotCount(i),this.toggleClassName("noRecipe",!t.length)},n.prototype._updatePerCraftType=function(e){d.positionWindow(this.id,this._positionInfos[e]),d.positionWindow("craftInventory",this._inventoryPositionInfos[e]),this._buttonMerge.setText(this._mergeLabels[e]||this._mergeLabels.crafting)},n.prototype._updateMySlotElems=function(e){var t=9===e;this._mySlotElems.setNbSlots(),this._mySlotElems.toggleSignatureSlot(t)},n.prototype._onOpen=function(e){var t=e.msg;this._skillId=t.skillId,this._totalQty=1,this._totalFailure=0,this._totalSuccess=0,this.highlightedRecipeId=null,this._craftResultBox.clear(),this._itemResult.hide(),this._targetSlotElems.hide(),this._paymentButton.hide(),this._restoreMergeStopButtons(),this._mySlotElems.setPlayerName(window.gui.playerData.characterBaseInformations.name);var i=t.maxCase||t.nbCase,n=void 0===e.isCrafter?"SOLO":e.isCrafter?"CRAFTER":"CLIENT";this.jobsData.startCraftingSession(n,this._skillId,i),this.jobsData.on("objectAdded",this.addAndModifySlots),this.jobsData.on("objectModified",this.addAndModifySlots),this.jobsData.on("objectRemoved",this.objectRemoved),this._updateRecipeList(i),this._updateSlotElems(i),this._updatePerCraftType(e.type)},n.prototype._onResult=function(e,t){var i="",n=null,o=window.gui,s=this,r="",l=e.craftResult;return n=e.objectGenericId||e.objectInfo&&e.objectInfo.objectGID,l===h.CRAFT_IMPOSSIBLE?(s._totalFailure+=1,i=a("ui.craft.noResult"),o.openSimplePopup(i)):l===h.CRAFT_FAILED&&(s._totalFailure+=1,s._isInAutoCraft||o.openSimplePopup(a("ui.craft.failed"))),s._isInAutoCraft||s._restoreMergeStopButtons(),n?void u.getItems([n],function(o){if(o)return t(o);var c=u.items[n];r=c.nameId,l===h.CRAFT_SUCCESS&&(s._totalSuccess+=1,i=a("ui.craft.craftSuccessSelf",r)),t(null,{objectName:r,objectInfo:e.objectInfo,craftResult:l,message:i})}):t(null,{objectName:r,objectInfo:e.objectInfo,craftResult:l,message:i})},n.prototype.giveTheResult=function(e,t){function i(e){u.createItemInstances(e,function(t,i){if(t)return console.error("Crafting: updateItemResultDescription Failed to create item instances",t);var n=i.map[e.objectUID];o._itemDescription.displayItem(n),o._itemName.setText(n.item.nameId),o._itemLevel.setText(a("ui.common.short.level")+n.item.level),o._itemResult.show()})}var n=window.gui,o=this;t&&n.chat.logMsg(t),this._recipeList.filterRecipes(),e&&i(e),this._craftResultBox.updateFailSuccessValues(this._totalFailure,this._totalSuccess)}},function(e,t){},function(e,t){e.exports={CRAFT_IMPOSSIBLE:0,CRAFT_FAILED:1,CRAFT_SUCCESS:2,CRAFT_NEUTRAL:3}},function(e,t,i){function n(){s.call(this,"div",{className:["CraftResultBox","hoverable"]});var e=this;this._maxQuantity=this._currentQuantity=1,this._minMaxSelector=this.appendChild(new r),this._minMaxSelector.on("confirm",function(t){e.emit("craftReplayCount",t)});var t=this.createChild("div",{className:"resultContainer"}),i=t.createChild("div",{className:"resultObjectBox"});this._resultSlot=i.appendChild(new d);var n=i.createChild("div",{className:"resultNameBox"});this._resultName=n.createChild("div",{className:"label"});var o=t.createChild("div",{className:"secondRow"}),c=this._qtyButton=o.appendChild(new u({className:"quantityBtn"}));this._quantity=c.createChild("div",{className:"quantity",text:"x1"}),c.createChild("div",{className:"btnIcon"});var p=this.successFailBox=o.createChild("div",{className:"successFailBox",hidden:!0}),m=p.createChild("div",{className:"nameCol"});m.createChild("div",{className:"label",text:a("ui.craft.success")+a("ui.common.colon")}),m.createChild("div",{className:"label",text:a("ui.craft.failure")+a("ui.common.colon")});var f=p.createChild("div",{className:"valueCol"});this._successValue=f.createChild("div",{className:"value"}),this._failureValue=f.createChild("div",{className:"value"}),this._progressLine=t.createChild("div",{className:"progressBox",hidden:!0}),this._progressBar=this._progressLine.appendChild(new l({className:["progressBar","orange"]})),this._progressValue=this._progressLine.createChild("div",{className:"value"}),h.setDroppable(this,["recipeList"]),this.on("drop",function(e,t,i){i.selectRecipe()}),this._qtyButton.disable(),this._qtyButton.on("tap",function(){e._minMaxSelector.open({min:1,max:e._maxQuantity,defaultValue:e._currentQuantity})})}i(1085);var o=i(172).inherits,s=i(321),a=i(29).getText,r=i(332),l=i(557),c=i(461),d=i(737),u=i(335),h=i(317),p=350;o(n,s),e.exports=n,n.prototype.prepareItem=function(e){
var t=this;c.getItems([e],function(i){if(i)return console.error(i);var n=c.items[e];t._resultSlot.setItem(n),t._resultName.setText(n.nameId)})},n.prototype.setQty=function(e,t){this._currentQuantity=e,this._quantity.setText("x "+e),t&&(this._qtyButton.addClassNames("highlighted"),this.highlightTimeout&&window.clearTimeout(this.highlightTimeout),this.highlightTimeout=window.setTimeout(function(e){e._qtyButton.delClassNames("highlighted")},p,this))},n.prototype._setMaxQuantity=function(e){this._maxQuantity=e},n.prototype.setProgress=function(e,t){if(1===e){if(t<=1)return;this._progressLine.show(),this._progressBar.setValue(e)}this._progressBar.setValue(e/t),this._progressValue.setText(e+" / "+t)},n.prototype.updateFailSuccessValues=function(e,t){this.successFailBox.show(),this._failureValue.setText(e),this._successValue.setText(t)},n.prototype.checkRecipe=function(e,t){function i(){var t,i,n=window.gui.playerData,o=n.inventory.objects,s={},a=-1;for(t=0,i=e.length;t<i;t+=1){var r=e[t];if(o[r.UID]){var l=o[r.UID].quantity;s[r.GID]=l}}for(t=0,i=e.length;t<i;t+=1)if(e[t].GID){var c=e[t].GID,d=e[t].quantity,u=s[c],h=Math.floor(u/d);(a===-1||a>h)&&(a=h)}var p=s[n.jobs.RUNE_SIGNATURE_GID];return p&&a>p&&(a=p),a}var n=e.length<=0;if(t.isRecipeKnown?this.prepareItem(t.itemToCraft.resultId):this._clearItem(),n)this._qtyButton.disable(),this._setMaxQuantity(1);else{this._qtyButton.enable();var o=i();this._setMaxQuantity(o)}},n.prototype.getMaxQuantity=function(){return this._maxQuantity},n.prototype._clearItem=function(){this._resultSlot.unset(),this._resultName.setText(""),this.setQty(1),this._qtyButton.disable()},n.prototype.toggleReady=function(e){this.toggleClassName("isReady",e)},n.prototype._clearProgress=function(){this._progressLine.hide(),this.successFailBox.hide()},n.prototype.clear=function(){this._clearItem(),this._clearProgress(),this._setMaxQuantity(1)},n.prototype.selectSlot=function(e){this._resultSlot.toggleClassName("selected",e)}},function(e,t){},function(e,t,i){function n(){function e(e){s.moveItemToCraft("craftInventory",o,e)}function t(t,i){return o=t,o.objectGID===s.RUNE_SIGNATURE_GID?e(1):1===i?e(1):void n._minMaxSelector.open({min:1,max:i})}function i(e,t,i){return!this._isRemote&&(!!e.slot&&s.howManyCanBeAddedToCraft(i,e.slot.getItem(),1)>0)}c.call(this,"div",{className:["CraftActorBox","hoverable"]});var n=this;this._usedSlots=0,this._runeSignatureUid=null,this.highlightedSlots=[],this._minMaxSelector=this.appendChild(new d),this._minMaxSelector.setStyles({left:"20px",top:"30px"});var o=null,s=this.jobsData=window.gui.playerData.jobs;this._minMaxSelector.on("confirm",e);var r=this.createChild("div",{className:"wrapper"}),l=this._slotsContainer=r.createChild("div",{className:"slotsContainer"});a.setDroppable(this,["craftInventory"],{isDropAllowed:i}),this.on("drop",function(e){t(e.itemInstance,e.getQuantity())}),this._playerName=l.createChild("div",{className:"playerName"}),this._playerRole=l.createChild("div",{className:"playerRole"}),this._allSlots=l.createChild("div",{className:"allSlots"}),this._signatureSlot=l.appendChild(this._createItemSlot("signatureSlot")),this._signatureSlot.hide();for(var u=0;u<s.MAX_CRAFT_SLOTS;u+=1)this._allSlots.appendChild(this._createItemSlot())}function o(e,t,i){return!!i.getItem()&&(this.backgroundImage=i.getImage(),!0)}function s(){this.craftActorBox._slotTapHandler(this)}i(1087);var a=i(317),r=i(737),l=i(172).inherits,c=i(321),d=i(332),u=i(29).getText;l(n,c),e.exports=n,n.prototype._createItemSlot=function(e){var t=new r({noDoubleTap:!0});return e&&t.addClassNames(e),t.on("tap",s),t.craftActorBox=this,this._isRemote||a.setDraggable(t,{prepareForDrag:o},"crafting",{slot:t}),t},n.prototype._slotTapHandler=function(e){if(!this._isRemote){var t=e.getItem();if(t){var i=this.jobsData.getQuickTransferInfo("crafting",t,e.getQuantity());e!==this.selectedSlot?(window.gui.openContextualMenuAround("item",e,{item:t}),this._selectCurrentSlot(e,i.movedQty>1?"stackMove":"")):this.jobsData.removeItemFromCraft(t.objectUID,i.movedQty)}}},n.prototype._selectCurrentSlot=function(e,t){this.selectedSlot&&this._unselectCurrentSlot(),this.selectedSlot=e,e.select({extraStyle:t})},n.prototype._unselectCurrentSlot=function(){this.selectedSlot&&(this.selectedSlot.unselect(),this.selectedSlot=null)},n.prototype.setNbSlots=function(){for(var e=this._allSlots.getChildren(),t=this._usedSlots+this.jobsData.getFreeSlotCount(),i=0,n=e.length;i<n;i+=1){var o=e[i],s=i>=t;o.toggleClassName("locked",s),o.isLocked=s}},n.prototype.toggleSignatureSlot=function(e){this._signatureSlot.toggleDisplay(e)},n.prototype.showDropHighlight=function(e){if(this.highlightedSlots=[],e.objectGID===this.jobsData.RUNE_SIGNATURE_GID)this.highlightedSlots.push(this._signatureSlot);else for(var t=this._allSlots.getChildren(),i=0;i<t.length;i++){var n=t[i],o=n.getItem();if(o&&o.objectUID===e.objectUID){this.highlightedSlots=[n];break}o||n.isLocked||this.highlightedSlots.push(n)}for(var s=0;s<this.highlightedSlots.length;s++)this.highlightedSlots[s].addClassNames("selected")},n.prototype.hideDropHighlight=function(){for(var e=0;e<this.highlightedSlots.length;e++)this.highlightedSlots[e].delClassNames("selected");this.highlightedSlots=[]},n.prototype.setAsRemote=function(){this._isRemote=!0,this._slotsContainer.addClassNames("client")},n.prototype.setPlayerName=function(e){this._playerName.setText(e)},n.prototype.toggleReady=function(e){this.toggleClassName("isReady",e)},n.prototype._findSlotByUID=function(e){for(var t=this._allSlots.getChildren(),i=0,n=t.length;i<n;i+=1){var o=t[i];if(o.itemInstance&&o.itemInstance.objectUID===e)return i}return null},n.prototype.addAndModifySlot=function(e){var t,i=this._allSlots.getChildren();if(e.objectGID===this.jobsData.RUNE_SIGNATURE_GID)return this._runeSignatureUid=e.objectUID,void this._signatureSlot.setItem(e);var n=this._findSlotByUID(e.objectUID);n||0===n?(t=i[n],t.setItem(e)):(t=i[this._usedSlots],t.setItem(e),this._usedSlots+=1)},n.prototype.removeIngredient=function(e){if(e===this._runeSignatureUid)return this._signatureSlot.unselect(),this._signatureSlot.unset(),void(this._runeSignatureUid=null);var t=this._findSlotByUID(e);if(t||0===t){this._unselectCurrentSlot();for(var i=this._allSlots.getChildren(),n=t+1;n<i.length;n++)i[n-1].setItem(i[n].getItem());i[i.length-1].unset(),this._usedSlots-=1}},n.prototype.getGivenIngredientsInfo=function(){for(var e=this._allSlots.getChildren(),t=[],i=0,n=e.length;i<n;i+=1){var o=e[i].itemInstance;o&&t.push({UID:o.objectUID,GID:o.objectGID,quantity:o.quantity})}return t},n.prototype.getRuneSignatureInfo=function(){var e=this._signatureSlot.itemInstance;return e?{UID:e.objectUID,GID:e.objectGID,quantity:e.quantity}:{}},n.prototype.setCrafterJobLevel=function(e,t,i){t?this._playerRole.setText(i+" "+u("ui.common.short.level")+" "+t):this._playerRole.setText(u("ui.craft.client"))},n.prototype.clear=function(){this._unselectCurrentSlot(),this.hideDropHighlight(),this._minMaxSelector.hide(),this._isRemote=!1,this._usedSlots=0,this._runeSignatureUid=null,this._signatureSlot.unset(),this._signatureSlot.hide();for(var e=this._allSlots.getChildren(),t=0;t<e.length;t++)e[t].unset();this.setNbSlots()}},function(e,t){},function(e,t,i){function n(){function e(){u+=1}function t(e){var t=e.ready,i=o._buttonMerge;o._craftResultBox.toggleReady(t),o._mySlotElems.toggleReady(t),o._targetSlotElems.toggleReady(t),t?c.playerData.id===e.id&&(i.setText(s("ui.common.cancel")),o._restoreMergeStopButtons()):(i.setText(s("ui.common.merge")),o._isReady=!1)}function i(){o._craftResultBox.toggleReady(!1),o._mySlotElems.toggleReady(!1),o._targetSlotElems.toggleReady(!1),o._buttonMerge.setText(s("ui.common.merge")),o._isReady=!1}function n(i){var n=i._messageType;if(o.openState)switch(n){case"ExchangeObjectAddedMessage":case"ExchangeObjectModifiedMessage":case"ExchangeObjectRemovedMessage":case"ExchangeGoldPaymentForCraftMessage":case"ExchangeItemPaymentForCraftMessage":case"ExchangeModifiedPaymentForCraftMessage":case"ExchangeRemovedPaymentForCraftMessage":case"ExchangeClearPaymentForCraftMessage":e();break;case"ExchangeIsReadyMessage":t(i)}}a.call(this);var o=this,c=window.gui;this.jobsData=c.playerData.jobs,this._mySlotElems=null,this._targetSlotElems=null,this._craftResultBox=null,this._isReady=!1;var d="",u=0;this._updateSlotElems=function(e){o._updateMySlotElems(e);var t=9===e;o._targetSlotElems.setPlayerName(d),o._targetSlotElems.setNbSlots(),o._targetSlotElems.setAsRemote(),o._mySlotElems.toggleSignatureSlot(t&&"CRAFTER"===o.jobsData.craftSide),o._targetSlotElems.toggleSignatureSlot(t&&"CLIENT"===o.jobsData.craftSide)},this._onResultEvents=function(e){i(),o._stopBtn.enable(),o._buttonMerge.disable(),o._onResult(e,function(e,t){if(e)return console.error("Crafting multi: onResult error",e);var i=t.message,n=t.craftResult,a=t.objectInfo,l=t.objectName;n===r.CRAFT_SUCCESS&&(i="CRAFTER"===o.jobsData.craftSide?s("ui.craft.successTarget",l,d):s("ui.craft.successOther",d,l)),o.giveTheResult(a,i)})},c.on("ExchangeObjectAddedMessage",n),c.on("ExchangeObjectModifiedMessage",n),c.on("ExchangeObjectRemovedMessage",n),c.on("ExchangeGoldPaymentForCraftMessage",n),c.on("ExchangeItemPaymentForCraftMessage",n),c.on("ExchangeModifiedPaymentForCraftMessage",n),c.on("ExchangeRemovedPaymentForCraftMessage",n),c.on("ExchangeClearPaymentForCraftMessage",n),c.on("ExchangeIsReadyMessage",n),this.on("close",function(){d="",u=0,i(),l.close("craftPayment")}),this._buttonMergeAction=function(){var e=o._mySlotElems.getGivenIngredientsInfo().length;e+=o._targetSlotElems.getGivenIngredientsInfo().length,e<1||(o._isReady=!o._isReady,window.dofus.sendMessage("ExchangeReadyMessage",{ready:o._isReady,step:u}))}}var o=i(172).inherits,s=i(29).getText,a=i(1081),r=i(1083),l=i(194);o(n,a),e.exports=n,n.prototype._onOpen=function(e){a.prototype._onOpen.call(this,e),l.close("cancel",{keepDialog:!0});var t=e.msg;this._targetSlotElems.setCrafterJobLevel(t.skillId,t.crafterJobLevel,t.enrichData.jobName),this._targetSlotElems.show(),this._paymentButton.show();var i=l.getWindow("craftPayment");i.setForCrafter(e.isCrafter),i.setOnSuccess(!1)}},function(e,t,i){function n(){function e(){u.open("crafter",{crafter:this.crafter,job:T})}function t(){window.gui.openContextualMenu("player",{playerId:this.playerInfo.playerId,accountId:b.accountId,playerName:this.playerInfo.playerName})}function i(e){var t=new p("div",{className:"avatar"}),i="gfx/heads/SmallHead_"+e.breed+(e.sex?0:1)+".png";return m.preloadImage(i,function(e){t&&t.rootElement&&t.setStyle("backgroundImage",e)}),t}function n(e){var i=new h({className:"userNameButton",text:e.playerName});return i.playerInfo=e,i.on("tap",t),i}function s(t){var s=t||{},a=new h;a.crafter=s,a.on("tap",e);var r=0!==(s.jobInfo.userDefinedParams&o.CRAFT_OPTION_NOT_FREE),l="( "+s.playerInfo.worldX+","+s.playerInfo.worldY+" )",c=s.playerInfo.isInWorkshop?l:"-",d={avatar:i(s.playerInfo),name:n(s.playerInfo),level:s.jobInfo.jobLevel,coord:c,cost:r?A:I,nbSlots:s.jobInfo.minSlots,button:a};return d}function f(e){if(b.table.clearContent(),e.length)for(var t=0;t<e.length;t+=1)g(e[t])}function g(e){var t=b.table.addRow(s(e));C[e.playerInfo.playerId]=t}function _(e){var t=C[e.playerId],i=b.table.getRows().indexOf(t);b.table.delRow(i),delete C[e.playerId]}function v(e){var t=C[e.playerInfo.playerId],i=b.table.getRows().indexOf(t);b.table.updateRow(i,s(e))}function y(){b.selector.clearContent(),b.table.clearContent()}a.call(this,{className:"CraftersListWindow",title:r("ui.craft.craftersList"),positionInfo:{top:"c",left:"c",width:600,height:480}});var b=this,M=window.gui,w=[],T={},C={},A=r("ui.common.yes"),I=r("ui.common.no");M.on("ExchangeStartOkJobIndexMessage",function(e){u.openDialog(b.id,{msg:e})}),M.on("JobCrafterDirectoryListMessage",function(e){f(e.listEntries)}),M.on("JobCrafterDirectoryAddMessage",function(e){return C[e.listEntry.playerInfo.playerId]?v(e.listEntry):void g(e.listEntry)}),M.on("JobCrafterDirectoryRemoveMessage",_),this.once("open",function(){b.selector=b.windowBody.appendChild(new l),b.table=b.windowBody.appendChild(new c({colIds:["avatar","name","level","coord","cost","nbSlots","button"],colCount:7,highlightable:!0,headerContent:["","Name","Lvl.","coord","cost","nb",""]})),b.selector.on("change",function(e){return e<0?void b.table.clearContent():(T=e,void window.dofus.sendMessage("JobCrafterDirectoryListRequestMessage",{jobId:e.id}))})}),this.on("open",function(e){e=e||{},w=e.msg.jobs,d.getData("Jobs",w,function(e,t){if(e)return console.error(e);b.selector.clearContent(),b.selector.addOption(r("ui.craft.chooseJob"),-1);for(var i=0;i<t.length;i+=1){var n=t[i];b.selector.addOption(n.nameId,n)}1===t.length&&b.selector.select(t[0])})}),this.on("close",y)}i(1090);var o=i(1069),s=i(172).inherits,a=i(541),r=i(29).getText,l=i(532),c=i(649),d=i(30),u=i(194),h=i(335),p=i(321),m=i(182);s(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(e){n.characterDisplay.clear(),n.characterDisplay.setLook(e,{direction:l.DIRECTION_SOUTH,animation:"AnimStatique",boneType:"characters/",skinType:"characters/",riderOnly:!0})}function t(t,i){var o=t.playerInfo.playerId;window.gui.playerData.id===o?e(window.gui.playerData.characterBaseInformations.entityLook):window.dofus.sendMessage("ContactLookRequestByIdMessage",{contactType:r.SOCIAL_CONTACT_CRAFTER,playerId:t.playerInfo.playerId}),n.name.setText(t.playerInfo.playerName),n.jobName.setText(i.nameId),n.jobLevel.setText(t.jobInfo.jobLevel);var s=t.playerInfo.alignmentSide;s!==f.ALIGNMENT_ANGEL&&s!==f.ALIGNMENT_EVIL&&(s=f.ALIGNMENT_NEUTRAL);var l="gfx/alignments/wings/Artisan_tx_bg"+s+"_frame0.png";m.preloadImage(l,function(e){n.characterDisplay.setStyle("backgroundImage",e)}),n.nearCraftTable.setText(t.playerInfo.isInWorkshop?c:g),n.coordinates.setText("-"),t.playerInfo.isInWorkshop&&(n.coordinates.setText("( "+t.playerInfo.worldX+","+t.playerInfo.worldY+" )"),p.getData("SubAreas",t.playerInfo.subAreaId,function(e,t){if(e)return console.error(e);var i=window.gui.databases.Areas[t.areaId];n.location.setText(i.nameId+" ( "+t.nameId+" )")}));var d=t.jobInfo.userDefinedParams,u=0!==(d&a.CRAFT_OPTION_NOT_FREE),h=0!==(d&a.CRAFT_OPTION_NOT_FREE_EXCEPT_ON_FAIL),_=0!==(d&a.CRAFT_OPTION_RESOURCES_REQUIRED);n.checkboxNotFree.toggleActivation(u),n.freeOnFailCheckbox.toggleDisplay(!!i.specializationOfId),n.freeOnFailCheckbox.toggleActivation(h),n.checkboxRessourcesNeeded.toggleActivation(_),n.minItems.setText(t.jobInfo.minSlots),n.messageButton.enable()}function i(){n.characterDisplay.release(),delete n.crafter}d.call(this,{className:"CrafterWindow",title:u("ui.craft.crafter"),positionInfo:{top:"c",left:"c",width:550,height:380}});var n=this,c=u("ui.common.yes"),g=u("ui.common.no");this.once("open",function(){var i=this.windowBody.createChild("div",{className:"colsWrapper"}),a=i.createChild("div",{className:"col1"}),r=i.createChild("div",{className:"col2"}),l=a.createChild("div",{className:["block","blockCharacter"]});this.characterDisplay=l.appendChild(new s({scale:2})),this.characterDisplay.clear();var c=r.createChild("div",{className:["block","blockInfos"]});c.createChild("div",{className:"title",text:u("ui.common.informations")});var d=c.createChild("div",{className:"line"});d.createChild("div",{className:"label",text:u("ui.common.name")}),this.name=d.createChild("div",{className:["value","name"]});var p=c.createChild("div",{className:"line"});p.createChild("div",{className:"label",text:u("ui.craft.job")}),this.jobName=p.createChild("div",{className:["value","job"]});var m=c.createChild("div",{className:"line"});m.createChild("div",{className:"label",text:u("ui.craft.jobLevel")}),this.jobLevel=m.createChild("div",{className:["value","jobLevel"]});var f=r.createChild("div",{className:["block","blockLocation"]});f.createChild("div",{className:"title",text:u("ui.common.localisation")});var g=f.createChild("div",{className:"line"});this.location=g.createChild("div",{className:["value","location"]});var _=f.createChild("div",{className:"line"});_.createChild("div",{className:"label",text:u("ui.craft.nearCraftTable")}),this.nearCraftTable=_.createChild("div",{className:["value","nearCraftTable"]});var v=f.createChild("div",{className:"line"});v.createChild("div",{className:"label",text:u("ui.common.coordinates")}),this.coordinates=v.createChild("div",{className:["value","coordinates"]});var y=r.createChild("div",{className:["block","blockOptions"]});y.createChild("div",{className:"title",text:u("ui.craft.jobOptions")}),this.checkboxNotFree=y.appendChild(new h(u("ui.craft.notFree"))),this.checkboxNotFree.disable(),this.freeOnFailCheckbox=y.appendChild(new h(u("ui.craft.freeIfFailed"))),this.freeOnFailCheckbox.addClassNames("freeOnFail"),this.freeOnFailCheckbox.disable(),this.checkboxRessourcesNeeded=y.appendChild(new h(u("ui.craft.ressourcesNeeded"))),this.checkboxRessourcesNeeded.disable();var b=y.createChild("div",{className:"line"});b.createChild("div",{className:"label",text:u("ui.craft.minItemInCraft")}),this.minItems=b.createChild("div",{className:["value","minItems"]}),this.messageButton=this.windowBody.appendChild(new o(u("ui.common.wMessage"))),this.messageButton.addClassNames("messageButton"),this.messageButton.on("tap",function(){window.gui.chat.startPrivateMessage(n.crafter.playerInfo.playerName)}),window.gui.on("ContactLookMessage",function(t){n.crafter&&e(t.look)}),window.gui.on("JobCrafterDirectoryAddMessage",function(e){n.crafter&&e.listEntry.playerInfo.playerId===n.crafter.playerInfo.playerId&&(n.crafter=e.listEntry,t(n.crafter,n.job))}),window.gui.on("JobCrafterDirectoryRemoveMessage",function(e){n.crafter&&e.playerId===n.crafter.playerInfo.playerId&&n.messageButton.disable()})}),this.on("open",function(e){e=e||{},this.crafter=e.crafter,this.job=e.job,t(this.crafter,this.job)}),this.on("close",i)}i(1092);var o=i(335).DofusButton,s=i(369),a=i(1069),r=i(1093),l=i(410),c=i(172).inherits,d=i(541),u=i(29).getText,h=i(612),p=i(30),m=i(182),f=i(425);c(n,d),e.exports=n},function(e,t){},function(e,t){e.exports={SOCIAL_CONTACT_FRIEND:0,SOCIAL_CONTACT_SPOUSE:1,SOCIAL_CONTACT_PARTY:2,SOCIAL_CONTACT_GUILD:3,SOCIAL_CONTACT_ALLIANCE:4,SOCIAL_CONTACT_CRAFTER:5,SOCIAL_CONTACT_INTERLOCUTOR:6}},function(e,t,i){function n(){g.call(this,{className:"CraftMagusWindow",title:"",positionInfo:{left:"0.5%",bottom:"2%",width:"76%",height:"95%"},noCloseButton:!0}),this._initialize(),this.once("open",this._createDom),this.on("open",this._onOpen),this.on("close",this._onClose)}function o(e,t,i){return!!e.slot&&this.myWindow.jobsData.canItemMove(i,"crafting",e.slot.getItem())}i(1095);var s=i(335).DofusButton,a=i(627),r=i(1083),l=i(317),c=i(29).getText,d=i(172).inherits,u=i(853),h=i(461),p=i(737),m=i(332),f=i(455),g=i(541),_=i(1096),v=a.SMITHMAGIC_RUNE_ID,y=a.SMITHMAGIC_POTION_ID,b=a.SIGNATURE_RUNE_ID,M=a.SIGNATURE_AVAILABLE_LEVEL,w=["item","rune","signatureRune"],T=53,C=56;d(n,g),e.exports=n,n.prototype._initVariables=function(e){this.isMultiCraft=!!e,this.exchangeStep=0,this.isInAutoCraft=!1,this.newItemInstance=null,this.newItemSlotType=null,this.skillId=null,this.skillData=null,this.droppedLocation="",this.droppedItemSource="",this.currentCraftingItem=null},n.prototype._initialize=function(){function e(){d.isInAutoCraft=!0,d._updateCraftingButtons(),u("ExchangeReplayMessage",{count:-1}),u("ExchangeReadyMessage",{ready:!0,step:d.exchangeStep})}function t(){d.isInAutoCraft=!1,d._updateCraftingButtons(),u("ExchangeReadyMessage",{ready:!0,step:d.exchangeStep})}function i(e){h.createItemInstances(e.object,function(e,t){if(e)return console.error("Craft Magus: updateSlot cannot createItemInstances",e);var i=t.array[0],n=d._getItemSlotType(i.item),o=d._getSlotByType(n);o.setItem(i),o.dragUiInfo.backgroundImage=o.getImage(),l.enableDrag(o),"item"===n&&(d.currentCraftingItem=i,d.itemBox.displayItem(i),d.setItemBoxVisibility(!0)),d._updateCraftingButtons()})}function n(e){var t=e.objectUID,i=d._getSlotTypeByUID(t);i&&(d._unselectCurrentSlot(),d._resetSlot(i),d._updateSlotsImage(),"item"===i&&d.setItemBoxVisibility(!1),d._updateCraftingButtons())}function o(e){i(e),p()}function s(e){n(e),p()}function a(e){var t=window.gui;if(e.craftResult===r.CRAFT_IMPOSSIBLE){var i=c("ui.craft.noResult");return t.openSimplePopup(i),t.chat.logMsg(i),u("ExchangeReadyMessage",{ready:!1,step:d.exchangeStep}),d.isInAutoCraft=!1,void d._updateCraftingButtons()}h.createItemInstances(e.objectInfo,function(t,i){if(t)return console.error("CraftMagusWindow createItemInstances",t);var n=i.array[0];_.display(d.currentCraftingItem,n,e)})}this._initVariables();var d=this,u=window.dofus.sendMessage,p=this.incrementStep=function(){d.exchangeStep+=1};this.onMergeAllBtnTap=e,this.onMergeBtnTap=t;var m=window.gui;m.on("ObjectModifiedMessage",this.localizeEvent(i)),m.on("ExchangeObjectAddedMessage",this.localizeEvent(o)),m.on("ExchangeObjectModifiedMessage",this.localizeEvent(o)),m.on("ExchangeObjectRemovedMessage",this.localizeEvent(s)),m.on("ExchangeCraftResultMagicWithObjectDescMessage",this.localizeEvent(a)),m.on("ExchangeCraftResultMessage",this.localizeEvent(a)),m.on("ExchangeItemAutoCraftStopedMessage",this.localizeEvent(this._onAutoCraftStopped.bind(this)))},n.prototype._createDom=function(){function e(e,t,n){var o=n.getItem();return!!o&&i.jobsData.getQuickTransferInfo("crafting",o,1).movedQty>0}function t(t){var n=new p({name:t,noDoubleTap:!0});return n.dragUiInfo={backgroundImage:"none",prepareForDrag:e},l.setDraggable(n,n.dragUiInfo,"crafting",{slot:n}),l.disableDrag(n),n.on("tap",function(){i._simpleTapOnSlot(n)}),n}var i=this,n=this.col1=this.windowBody.createChild("div",{className:"col1"}),a=this.col2=this.windowBody.createChild("div",{className:"col2"}),r=this.craftingBoxContainer=n.createChild("div",{className:"craftingBoxContainer"}),d=r.createChild("div",{className:["craftingBoxDropArea","hoverable"]});l.setDroppable(d,["craftInventory","ingredientsBag"],{isDropAllowed:o}),d.on("drop",this._itemDropOnCraftBox.bind(this)),d.myWindow=this;for(var h=this.craftingBox=d.createChild("div",{className:"craftingBox"}),g=this.craftingSlots=h.createChild("div",{className:"craftingSlots"}),_=0;_<w.length;_+=1){var v=w[_];g.appendChild(t(v))}this.minMaxSelector=this.windowContent.appendChild(new m),this.minMaxSelector.on("confirm",this._moveItem.bind(this));var y=n.createChild("div",{className:"buttonsContainer"});this.mergeAllBtn=y.appendChild(new s(c("ui.common.mergeAll"),{className:"mergeAllBtn"})),this.mergeAllBtn.on("tap",this.onMergeAllBtnTap),this.mergeBtn=y.appendChild(new s(c("ui.common.merge"),{className:"mergeBtn"})),this.mergeBtn.on("tap",this.onMergeBtnTap),this.stopBtn=y.appendChild(new s(c("ui.common.stop"),{className:"stopBtn"})),this.stopBtn.on("tap",this._onStopBtnTap.bind(this)),this._setEnableCraftingButtons(!1),this.itemBox=a.appendChild(new u({showDescription:!0,showTitle:!0,minRows:0})),this.itemPlaceholder=new f(a,{noHeight:!0}),this.itemPlaceholder.setText(" ")},n.prototype._onOpen=function(e){this.jobsData=window.gui.playerData.jobs;var t=e.msg;this.skillId=t.skillId,this.skillData=this.jobsData.getSkill(t.skillId),this.setTitle(this.skillData.nameId),this._updateSlotsImage(),this.selectedSlot=null,this.setItemBoxPlaceholderText(c("tablet.craftHelp.magicSolo")),this.setItemBoxVisibility(!1),this.jobsData.startCraftingSession("SOLO",this.skillId,1)},n.prototype._onClose=function(){this.jobsData.clearAfterCraft(),this._initVariables(),this._resetSlots(),this._unselectCurrentSlot(),this.setItemBoxVisibility(!1),this._setEnableCraftingButtons(!1)},n.prototype._isCraftableItem=function(e){return this.skillData.modifiableItemType===e.typeId},n.prototype._hasSignatureSlot=function(){var e=window.gui.playerData.jobs.list,t=this.skillData.parentJobId,i=e[t]||{},n=i.experience||{};return n.jobLevel>=M},n.prototype._getSlotByType=function(e){return this.craftingSlots.getChild(e)},n.prototype._slotHasItem=function(e){var t=this._getSlotByType(e);return!!t.itemInstance},n.prototype._updateSlotsImage=function(){var e=this.skillData.modifiableItemType;this._getSlotByType("item").setBackgroundImageByItemType(e),this._getSlotByType("rune").setBackgroundImageByItemType(v);var t=this._hasSignatureSlot(),i=this._getSlotByType("signatureRune");i.toggleClassName("signatureSlot",t),i.toggleClassName("locked",!t)},n.prototype._resetSlot=function(e){var t=this._getSlotByType(e);t.unset(),l.disableDrag(t)},n.prototype._resetSlots=function(){for(var e=0;e<w.length;e+=1)this._resetSlot(w[e])},n.prototype._getItemSlotType=function(e){var t,i=this.skillData;return this._isCraftableItem(e)?t="item":i.isForgemagus&&e.typeId===v||e.typeId===y?t="rune":e.id===b&&(t="signatureRune"),t},n.prototype._getSlotTypeByUID=function(e){for(var t=0;t<w.length;t+=1){var i=w[t],n=this._getSlotByType(i);if(n.itemInstance&&n.itemInstance.objectUID===e)return i}},n.prototype._setEnableMergeButtons=function(e){this.mergeAllBtn.setEnable(e),this.mergeBtn.setEnable(e)},n.prototype._setEnableCraftingButtons=function(e){this._setEnableMergeButtons(e),this.stopBtn.setEnable(e)},n.prototype._updateCraftingButtons=function(){this._setEnableMergeButtons(!this.isInAutoCraft&&this._slotHasItem("item")&&this._slotHasItem("rune")),this.stopBtn.setEnable(this.isInAutoCraft),this.isInAutoCraft?this.jobsData.startCombining():this.jobsData.stopCombining()},n.prototype._moveItem=function(e){this.jobsData.moveItemToCraft("craftInventory",this.newItemInstance,e)},n.prototype._itemDropOnCraftBox=function(e,t){if(this.skillId&&e.itemInstance&&(this.newItemSlotType=this._getItemSlotType(e.itemInstance.item),this.newItemSlotType)){var i=this.newItemInstance=e.itemInstance;this.droppedLocation="crafting",this.droppedItemSource=t;var n=e.getQuantity();n=this.jobsData.howManyCanBeAddedToCraft(t,i,n),0!==n&&(1===n?this._moveItem(1):this.minMaxSelector.open({min:1,max:n,defaultValue:n,x:T,y:C}))}},n.prototype._onStopBtnTap=function(){window.dofus.sendMessage("ExchangeReplayStopMessage")},n.prototype._onAutoCraftStopped=function(e){a.displayAutoCraftStopReasonMessage(e.reason),this.isInAutoCraft=!1,this._updateCraftingButtons()},n.prototype.setItemBoxPlaceholderText=function(e){this.placeholderText=e,this.isPlaceholderVisible&&this.itemPlaceholder.setText(this.placeholderText)},n.prototype.setItemBoxVisibility=function(e){this.itemBox.toggleDisplay(e),e?this.itemPlaceholder.setText(null):this.itemPlaceholder.setText(this.placeholderText),this.isPlaceholderVisible=!e},n.prototype._simpleTapOnSlot=function(e){var t=e.getItem();if(t){e!==this.selectedSlot&&window.gui.openContextualMenuAround("item",e,{item:t});var i=this.jobsData.getQuickTransferInfo("crafting",t,e.getQuantity());i.movedQty&&(e!==this.selectedSlot?this._selectCurrentSlot(e,i.movedQty>1?"stackMove":""):this.jobsData.removeItemFromCraft(t.objectUID,i.movedQty))}},n.prototype._selectCurrentSlot=function(e,t){this.selectedSlot&&this._unselectCurrentSlot(),this.selectedSlot=e,e.select({extraStyle:t})},n.prototype._unselectCurrentSlot=function(){this.selectedSlot&&(this.selectedSlot.unselect(),this.selectedSlot=null)}},function(e,t){},function(e,t,i){function n(e){for(var t=0;t<e.length;t+=1)if("ObjectEffectMinMax"===e[t]._type||"EffectInstanceMinMax"===e[t]._type)return e[t];return null}function o(e){return"ObjectEffectInteger"===e._type||"EffectInstanceInteger"===e._type||"ObjectEffectDice"===e._type||"EffectInstanceDice"===e._type}var s=i(355).createEffectInstances,a=i(29).getText,r=i(1097),l=i(353);t.display=function(e,t,i){var c=window.gui.chat,d=e.effects,u=t.effects,h=n(d),p=n(u);if(h&&p&&h.actionId!==p.actionId)return c.logMsg(a("ui.craft.success"));var m={},f={};d=d.filter(o),u=u.filter(o),d.forEach(function(e){m[e.actionId]=e}),u.forEach(function(e){f[e.actionId]=e});var g,_,v,y,b,M=!1,w=[],T=[];for(g=0;g<d.length;g+=1){y=d[g],_=y.actionId,b=y.value;var C=parseInt(y.effect.operator+y.value,10);if(f.hasOwnProperty(_)){var A=parseInt(f[_].effect.operator+f[_].value,10);v=A-C}else v=-C;if(_===l.ACTION_ITEM_CHANGE_DURABILITY)return v=f[_].diceNum-m[_].diceNum,void c.logMsg(a("ui.craft.success")+" : +"+v+", "+f[_].description);v&&(w.push({_type:y._type,actionId:_,value:v}),v>0&&(M=!0)),T.push(_)}for(g=0;g<u.length;g+=1)y=u[g],_=y.actionId,T.indexOf(_)>=0||(b=y.value,w.push({_type:y._type,actionId:_,value:b}),b>0&&(M=!0));var I=a(M?"ui.craft.success":"ui.craft.failure");s(w,function(e,t){if(e)return console.error("Craft Magus: craftResultText cannot createItemInstances",e);for(var n,o,s="",l=0;l<t.length;l+=1)n=t[l],n.effect.bonusType&&(o=n.description,o=n.value>0?"+"+o:o,s+=" "+o+",",s=s.replace("--","-"));var d="";i.magicPoolStatus===r.MAGIC_POOL_INCREASE?d=" +"+a("ui.craft.smithResidualMagic"):i.magicPoolStatus===r.MAGIC_POOL_LOSS?d=" -"+a("ui.craft.smithResidualMagic"):s=s.substring(0,s.length-1),s+=d,s&&(I+=a("ui.common.colon")),c.logMsg(I+s)})}},function(e,t){e.exports={MAGIC_POOL_NO_CHANGE:1,MAGIC_POOL_INCREASE:2,MAGIC_POOL_LOSS:3}},function(e,t,i){function n(){c.call(this),this.addClassNames("CraftMagusMultiWindow"),this.on("opened",function(){this._resizeIngredientSlots(),this._updateIngrediensSlotsPageCount()})}function o(){this.myWindow._tapOnBagSlot(this)}function s(e,t,i){return!!e.slot&&this.myWindow.jobsData.canItemMove(i,"ingredientsBag",e.slot.getItem())}i(1099);var a=i(335).DofusButton,r=i(612),l=i(627),c=i(1094),d=i(317),u=i(29).getText,h=i(172).inherits,p=i(461),m=i(737),f=i(733),g=i(194),_=40,v=40,y=30,b=l.SIGNATURE_AVAILABLE_LEVEL;h(n,c),e.exports=n,n.prototype._initVariables=function(){c.prototype._initVariables.call(this,!0),this.isCrafter=null,this.isCraftingMode=!1,this.crafterSkillLevel=1,this.currentPage=-1,this.pageCount=-1},n.prototype._initialize=function(){function e(e){var t=!!e.allowed;l.allowCrafterIngredientsCheckbox.toggleActivation(t,!0),l.jobsData.setCrafterIngredientsAllowed(t)}function t(e,t,i){var n=l.jobsData.getQuickTransferInfo("ingredientsBag",i.getItem(),1);return n.movedQty>0}function i(e){l._unselectBagSlot();var i=e.object;p.createItemInstances(i,function(e,n){if(e)return console.error(e);var s=n.map[i.objectUID],a=new m({itemData:s,name:i.objectUID,noDoubleTap:!0});a.setQuantity(s.quantity),l.ingredientsSlots.appendChild(a),a.on("tap",o),a.myWindow=l,d.setDraggable(a,{backgroundImage:a.getImage(),prepareForDrag:t},"ingredientsBag",{slot:a}),l._updateIngrediensSlotsPageCount()})}function n(e){l._unselectBagSlot();var t=e.object,i=t.objectUID,n=t.quantity,o=l.ingredientsSlots.getChild(i);o&&o.setQuantity(n)}function s(e){l._unselectBagSlot();var t=e.objectUID,i=l.ingredientsSlots.getChild(t);i&&(i.destroy(),l._updateIngrediensSlotsPageCount())}function a(e,t,i){if(l._unselectBagSlot(),!(!l.skillId||!e.itemInstance||!l._getItemSlotType(e.itemInstance.item)||l.isCrafter&&"craftInventory"===t||l.isCrafter&&"crafting"===t&&l._isMyItem(e.itemInstance.objectUID))){l.newItemInstance=e.itemInstance,l.droppedLocation="ingredientsBag",l.droppedItemSource=t;var n=e.getQuantity();return 1===n?l._moveItem(1):void l.minMaxSelector.open({min:1,max:n,defaultValue:n,x:i.x,y:i.y})}}function r(e){var t=e.ready;l._updateExchangeReadyDisplay(!!t)}c.prototype._initialize.call(this);var l=this;this.itemDropOnBag=a;var u=window.gui;u.on("ExchangeMultiCraftCrafterCanUseHisRessourcesMessage",this.localizeEvent(e)),u.on("ExchangeObjectPutInBagMessage",this.localizeEvent(i)),u.on("ExchangeObjectRemovedFromBagMessage",this.localizeEvent(s)),u.on("ExchangeObjectModifiedInBagMessage",this.localizeEvent(n)),u.on("ExchangeIsReadyMessage",this.localizeEvent(r));var h=this.incrementStep;u.on("ExchangeGoldPaymentForCraftMessage",this.localizeEvent(h)),u.on("ExchangeItemPaymentForCraftMessage",this.localizeEvent(h)),u.on("ExchangeModifiedPaymentForCraftMessage",this.localizeEvent(h)),u.on("ExchangeRemovedPaymentForCraftMessage",this.localizeEvent(h)),u.on("ExchangeClearPaymentForCraftMessage",this.localizeEvent(h))},n.prototype._tapOnBagSlot=function(e){var t=e.getItem(),i=e.getQuantity(),n=this.jobsData.getQuickTransferInfo("ingredientsBag",t,i),o=n.movedQty;
e!==this.selectedBagSlot&&window.gui.openContextualMenuAround("item",e,{item:t}),o&&(e!==this.selectedBagSlot?this._selectBagSlot(e,o>1?"stackMove":""):this.isCrafter?this.jobsData.moveItemToCraft("ingredientsBag",t,o):this.jobsData.removeItemFromCraft(e.itemInstance.objectUID,o))},n.prototype._selectBagSlot=function(e,t){this.selectedBagSlot&&this._unselectBagSlot(),this.selectedBagSlot=e,e.select({extraStyle:t})},n.prototype._unselectBagSlot=function(){this.selectedBagSlot&&(this.selectedBagSlot.unselect(),this.selectedBagSlot=null)},n.prototype._createDom=function(){c.prototype._createDom.call(this);var e=this,t=this.craftingBox.createChild("div");this.crafterName=t.createChild("span",{className:"playerName"}),this.crafterDescription=t.createChild("span");var i=this.craftingBox.createChild("div");this.clientName=i.createChild("span",{className:"playerName"}),this.clientDescription=i.createChild("span"),this.acceptBtn=new a(u("ui.common.accept"),{className:"acceptBtn"}),this.acceptBtn.on("tap",function(){window.dofus.sendMessage("ExchangeReadyMessage",{ready:!0,step:e.exchangeStep})}),this.acceptBtn.insertBefore(this.stopBtn),this.ingredientsBag=this.col1.createChild("div",{className:"ingredientsBag"}),this.ingredientsBag.createChild("div",{className:"title",text:u("ui.craft.ingredientBag")}),this.ingredientsSlotsContainer=this.ingredientsBag.createChild("div",{className:"ingredientsSlotsContainer"}),this.ingredientsSlotsBox=this.ingredientsSlotsContainer.createChild("div",{className:"ingredientsSlotsBox"}),this.ingredientsSlotsMask=this.ingredientsSlotsBox.createChild("div",{className:["ingredientsSlotsMask","hoverable"]}),d.setDroppable(this.ingredientsSlotsMask,["craftInventory","crafting"],{isDropAllowed:s}),this.ingredientsSlotsMask.on("drop",this.itemDropOnBag),this.ingredientsSlotsMask.myWindow=this,this.ingredientsSlots=this.ingredientsSlotsMask.createChild("div",{className:"ingredientsSlots"}),this.pagination=this.ingredientsSlotsContainer.appendChild(new f),this.pagination.on("previous",function(){e._ingrediensSlotsGoToPage(e.currentPage-1)}),this.pagination.on("next",function(){e._ingrediensSlotsGoToPage(e.currentPage+1)}),this.pagination.on("page",function(t){e._ingrediensSlotsGoToPage(t)}),this.allowCrafterIngredientsCheckbox=this.ingredientsBag.appendChild(new r("",(!1))),this.allowCrafterIngredientsCheckbox.on("change",function(e){window.dofus.sendMessage("ExchangeMultiCraftSetCrafterCanUseHisRessourcesMessage",{allow:e})}),this.paymentBtn=new a(u("ui.common.payment"),{className:"paymentBtn"}),this.paymentBtn.on("tap",function(){g.open("craftPayment")}),this.col2.appendChild(this.paymentBtn)},n.prototype._onOpen=function(e){this.jobsData=window.gui.playerData.jobs;var t=e.msg;this.skillId=t.skillId,this.skillData=this.jobsData.getSkill(t.skillId),this.setTitle(this.skillData.nameId),this._roleSetup(e),this._updateSlotsImage(),this.selectedBagSlot=null,this.jobsData.startCraftingSession(this.isCrafter?"CRAFTER":"CLIENT",this.skillId,1);var i=u(this.isCrafter?"tablet.craftHelp.magicMultiCrafter1":"tablet.craftHelp.magicMultiClient1");this.setItemBoxPlaceholderText(i),this.setItemBoxVisibility(!1),g.close("cancel",{keepDialog:!0})},n.prototype._onClose=function(){c.prototype._onClose.call(this),this.ingredientsSlots.clearContent(),this.selectedBagSlot=null,g.close("craftPayment")},n.prototype._roleSetup=function(e){var t=this.isCrafter=e.isCrafter;this.mergeAllBtn.toggleDisplay(t),this.mergeBtn.toggleDisplay(t),this.acceptBtn.toggleDisplay(!t),this.allowCrafterIngredientsCheckbox.setText(u(t?"ui.craft.crafterRunesAllowed":"ui.craft.allowCrafterRunes"));var i=!1,n=!0;this.allowCrafterIngredientsCheckbox.toggleActivation(i,n),this.allowCrafterIngredientsCheckbox.setEnable(!t);var o=g.getWindow("craftPayment");o.setForCrafter(t),o.setOnSuccess(!0);var s=window.gui.playerData.jobs.list[this.skillData.parentJobId]||{},a=s.experience||{};this.crafterSkillLevel=e.msg.crafterJobLevel||a.jobLevel,this.crafterName.setText(e.sourceName),this.clientName.setText(e.targetName);var r=e.msg.enrichData.jobName;this.crafterDescription.setText(" - "+r+" "+u("ui.common.level")+" "+this.crafterSkillLevel),this.clientDescription.setText(" - "+u("ui.craft.client")),this._updateExchangeReadyDisplay(!1)},n.prototype._hasSignatureSlot=function(){return this.crafterSkillLevel>=b},n.prototype._setEnableIngredientsBag=function(e){this.ingredientsSlotsBox.toggleClassName("disabled",!e)},n.prototype._setEnableCraftingBox=function(e){this.craftingSlots.toggleClassName("disabled",!e)},n.prototype._resizeIngredientSlots=function(){this.ingredientsSlotsBox.hide();var e=this.ingredientsSlotsContainer.rootElement,t=e.offsetWidth,i=e.offsetHeight-y,n=this.ingredientsSlotsRowNum=Math.floor(i/_),o=Math.floor(t/v);this.maxIngredientsSlotsPerPage=n*o;var s=o*v,a=n*_;this.ingredientsSlotsBox.setStyles({width:t+"px",height:i+"px"}),this.ingredientsSlotsMask.setStyles({width:s+"px",height:a+"px"}),this.ingredientsSlotsBox.show()},n.prototype._updateExchangeReadyDisplay=function(e){var t=this.isCraftingMode=e;this.jobsData.switchToCrafter(t);var i;this.isCrafter?(this._setEnableCraftingBox(t),this._setEnableIngredientsBag(t),i=e?"tablet.craftHelp.magicMultiCrafter2":"tablet.craftHelp.magicMultiCrafter1"):(this._setEnableCraftingBox(!1),this._setEnableIngredientsBag(!t),this.acceptBtn.setEnable(!t),this.stopBtn.setEnable(t),i=e?"tablet.craftHelp.magicMultiClient2":"tablet.craftHelp.magicMultiClient1"),this.setItemBoxPlaceholderText(u(i))},n.prototype._updateCraftingButtons=function(){this.isCrafter&&c.prototype._updateCraftingButtons.call(this)},n.prototype._isMyItem=function(e){return!!window.gui.playerData.inventory.objects[e]},n.prototype._ingrediensSlotsGoToPage=function(e){if(!(this.currentPage===e||e<0||e>this.pageCount-1)){this.currentPage=e;var t="translateY(-"+e*this.ingredientsSlotsRowNum*_+"px)";this.ingredientsSlots.setStyles({webkitTransform:t,transform:t}),this.pagination.setCurrent(e)}},n.prototype._updateIngrediensSlotsPageCount=function(){var e=this.ingredientsSlots.getChildren().length;this.pageCount=Math.ceil(e/this.maxIngredientsSlotsPerPage)||1,this.pagination.setPageCount(this.pageCount),this._ingrediensSlotsGoToPage(this.pageCount-1)},n.prototype._moveItem=function(e){var t="crafting"===this.droppedLocation||"craftInventory"===this.droppedItemSource&&"ingredientsBag"===this.droppedLocation;t?this.jobsData.moveItemToCraft(this.droppedItemSource,this.newItemInstance,e):this.jobsData.removeItemFromCraft(this.newItemInstance.objectUID,e)},n.prototype._onStopBtnTap=function(){return this.isCrafter?c.prototype._onStopBtnTap.call(this):void window.dofus.sendMessage("ExchangeReadyMessage",{ready:!1,step:this.exchangeStep})},n.prototype._onAutoCraftStopped=function(e){return this.isCrafter?c.prototype._onAutoCraftStopped.call(this,e):(l.displayAutoCraftStopReasonMessage(e.reason),void(this.isInAutoCraft=!1))}},function(e,t){},function(e,t,i){function n(){function e(){l.open("craftPayment")}this._positionInfoNormal={left:"c",bottom:"10%",width:550,height:165},this._positionInfoOnSuccess={left:"c",bottom:"10%",width:550,height:225},s.call(this,{className:"CraftPaymentWindow",title:a("ui.common.payment"),positionInfo:this._positionInfoNormal,customClose:!0});var t=this,i=window.gui;this._domCreated=!1,this._readOnly=!1,this.closeButton.on("tap",function(){t.hide()}),i.on("ExchangeGoldPaymentForCraftMessage",function(i){var n=i.goldSum;i.onlySuccess?t._successPayment.setKama(n):t._normalPayment.setKama(n),e()}),i.on("ExchangeItemPaymentForCraftMessage",function(i){p.createItemInstances(i.object,function(n,o){if(n)return console.error("PaymentWindow: ExchangeItemPaymentForCraftMessage cannot createItemInstances",n);var s=o.array[0];i.onlySuccess?t._successPayment.addItem(s):t._normalPayment.addItem(s),e()})}),i.on("ExchangeModifiedPaymentForCraftMessage",function(i){p.createItemInstances(i.object,function(n,o){if(n)return console.error("PaymentWindow: ExchangeModifiedPaymentForCraftMessage cannot createItemInstances",n);var s=o.array[0];i.onlySuccess?t._successPayment.modifyItem(s):t._normalPayment.modifyItem(s),e()})}),i.on("ExchangeRemovedPaymentForCraftMessage",function(i){i.onlySuccess?t._successPayment.removeItem(i.objectUID):t._normalPayment.removeItem(i.objectUID),e()}),i.on("ExchangeClearPaymentForCraftMessage",function(e){e.paymentType===d.PAYMENT_ON_SUCCESS_ONLY&&t._successPayment.clearPayment(),e.paymentType===d.PAYMENT_IN_ANY_CASE&&t._normalPayment.clearPayment(),t.hide()}),this.once("open",function(){t._domCreated||t._createDom()}),this.on("close",function(){t._normalPayment.reset(),t._successPayment.reset(),t._readOnly=!1})}i(1101);var o=i(172).inherits,s=i(541),a=i(29).getText,r=i(335).DofusButton,l=i(194),c=i(1102),d=i(1104),u=i(317),h=i(332),p=i(461);o(n,s),e.exports=n,n.prototype._createDom=function(){function e(e){window.dofus.sendMessage("ExchangeItemObjectAddAsPaymentMessage",{paymentType:s,bAdd:!0,objectToMoveId:o,quantity:e})}function t(t,i){return o=t,1===i?e(1):void n._minMaxSelector.open({min:1,max:i})}function i(e){if(!n._readOnly){s=this.paymentType;var i=e.itemInstance,o=e.getQuantity();t(i.objectUID,o)}}var n=this,o=null,s=d.PAYMENT_IN_ANY_CASE;this._minMaxSelector=this.appendChild(new h),this._minMaxSelector.setStyles({left:"20px",top:"30px"});var l=this.windowBody,p=this._normalPayment=l.appendChild(new c(d.PAYMENT_IN_ANY_CASE)),m=this._successPayment=l.appendChild(new c(d.PAYMENT_ON_SUCCESS_ONLY));this._minMaxSelector.on("confirm",e),u.setDroppable(p,["craftInventory"]),p.on("drop",i),p.paymentType=d.PAYMENT_IN_ANY_CASE,this._addDragEvents(p),u.setDroppable(m,["craftInventory"]),m.on("drop",i),m.paymentType=d.PAYMENT_ON_SUCCESS_ONLY,this._addDragEvents(m),p.on("kamaChange",function(e){window.dofus.sendMessage("ExchangeItemGoldAddAsPaymentMessage",{paymentType:d.PAYMENT_IN_ANY_CASE,quantity:e})}),m.on("kamaChange",function(e){window.dofus.sendMessage("ExchangeItemGoldAddAsPaymentMessage",{paymentType:d.PAYMENT_ON_SUCCESS_ONLY,quantity:e})});var f=l.appendChild(new r(a("ui.common.confirm"),{className:"confirmBtn"}));f.on("tap",function(){n.hide()}),n._domCreated=!0},n.prototype.setForCrafter=function(e){this._domCreated||this._createDom(),this._normalPayment.setReadonly(e),this._successPayment.setReadonly(e),this._readOnly=e},n.prototype.setOnSuccess=function(e){this._domCreated||this._createDom(),this._successPayment.toggleDisplay(e),e?this.positionInfo=this._positionInfoOnSuccess:this.positionInfo=this._positionInfoNormal},n.prototype._addDragEvents=function(e){function t(e,t){n&&n.selectSlots(t)}var i=this,n=e;u.on("dragStart",i.localizeEvent(function(e,i,n){t(n.source,!0)})),u.on("dragEnd",i.localizeEvent(function(e,i,n){t(n.source,!1)}))}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"PaymentSlotsKamas"});var t=this;this._MAX_SLOTS=5,this._currentKama=0,this._currentItems=[],this._currentPage=1,this._readOnly=!1,this._paymentType=e;var i=this.createChild("div",{className:"itemsContent"});this._previousBtn=i.appendChild(new d({className:["previousBtn","arrow"]},function(){t._currentPage-=1,t._updateItems()}));var n=i.createChild("div",{className:"itemsSlotsAndLabel"});e===u.PAYMENT_ON_SUCCESS_ONLY&&n.createChild("div",{className:"itemsLabel",text:c("ui.craft.additionalPayment")});for(var o=this._itemsSlots=n.createChild("div",{className:"itemsSlots"}),h=0;h<this._MAX_SLOTS;h+=1){var p=o.appendChild(new l({noDoubleTap:!0}));p.itemUI={width:40,height:40,onDragClassName:"slot"},a.setDraggable(p,p.itemUI,"craftPayment",{slot:p}),a.disableDrag(p)}this._nextBtn=i.appendChild(new d({className:["nextBtn","arrow"]},function(){t._currentPage+=1,t._updateItems()}));var m=this.createChild("div",{className:"pagesContent"});this._pagesCount=m.createChild("div",{className:"pagesCount"}),this._updatePagesCount();var f=this.createChild("div",{className:"kamaContent"});f.createChild("div",{className:"kamaLabel",text:c("ui.common.kamas")});var g=this._numberInput=f.appendChild(new r({minValue:0,title:c("ui.common.kamas")}));g.on("focus",function(){g.maxValue=window.gui.playerData.inventory.kamas}),g.on("change",function(e){t._currentKama!==e&&(t._currentKama=e,t.emit("kamaChange",e))})}i(1103);var o=i(172).inherits,s=i(321),a=i(317),r=i(340),l=i(737),c=i(29).getText,d=i(335),u=i(1104);o(n,s),e.exports=n,n.prototype.setKama=function(e){this._numberInput.setValue(e),this._numberInput.blur()},n.prototype.setReadonly=function(e){this._numberInput.setReadonly(e),this._itemsSlots.toggleClassName("disable",e),this._readOnly=e},n.prototype.selectSlots=function(e){this._readOnly&&(e=!1);for(var t=this._itemsSlots.getChildren(),i=0,n=t.length;i<n;i+=1)t[i].toggleClassName("selected",e)},n.prototype._getPageMax=function(){return parseInt(this._currentItems.length/this._MAX_SLOTS,10)+1},n.prototype._updatePagesCount=function(){var e=this._getPageMax();this._currentPage>e&&(this._currentPage=e),this._currentPage<1&&(this._currentPage=1);var t=this._currentPage;this._pagesCount.setText(t+"/"+e),t>=e?this._nextBtn.disable():this._nextBtn.enable(),t<=1?this._previousBtn.disable():this._previousBtn.enable()},n.prototype._getItemIndex=function(e){for(var t=this._currentItems,i=0,n=t.length;i<n;i+=1){var o=t[i];if(o){var s=o.objectUID;if(s===e)return i}}return null},n.prototype.addItem=function(e){this._currentItems.push(e),this._updateItems()},n.prototype.modifyItem=function(e){var t=this._getItemIndex(e.objectUID);null!==t&&(this._currentItems[t]=e,this._currentPage=parseInt(t/this._MAX_SLOTS,10)+1,this._updateItems())},n.prototype.removeItem=function(e){var t=this._getItemIndex(e);null!==t&&(this._currentItems.splice(t,1),this._updateItems())},n.prototype._updateItems=function(){this._updatePagesCount();for(var e=this._itemsSlots.getChildren(),t=this._currentPage-1,i=0,n=e.length;i<n;i+=1){var o=i+t*this._MAX_SLOTS,s=e[i],r=this._currentItems[o];r?(s.setItem(r),s.itemUI.backgroundImage=s.getImage(),s.paymentType=this._paymentType,this._readOnly?a.disableDrag(s):a.enableDrag(s)):(delete s.paymentType,s.unset(),a.disableDrag(s))}},n.prototype.clearPayment=function(){this._currentKama=0,this._currentPage=1,this._numberInput.setValue(""),this._currentItems=[],this._updateItems()},n.prototype.reset=function(){this._readOnly=!1,this.clearPayment()}},function(e,t){},function(e,t){e.exports={PAYMENT_ON_SUCCESS_ONLY:0,PAYMENT_IN_ANY_CASE:1}},function(e,t,i){function n(e){function t(e){return O===E.SKILLID_WRAP_GIFT||L&&L[e.objectGID]}function i(e){var t=e.item,i=E.getSkill(O);return!i||(t.typeId===i.modifiableItemType&&t.enhanceable||t.typeId===u.SMITHMAGIC_RUNE_ID||t.typeId===u.SMITHMAGIC_POTION_ID||e.objectGID===u.SIGNATURE_RUNE_ID&&E.canCrafterSign&&"CLIENT"!==E.craftSide)}function n(e){return e.item.isEquippable()}function s(e){return"craftPayment"===A?window.dofus.sendMessage("ExchangeItemObjectAddAsPaymentMessage",{paymentType:T,bAdd:!1,objectToMoveId:M,quantity:e}):"ingredientsBag"===A?window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:M,quantity:-e}):void E.removeItemFromCraft(M,e)}function h(e){p(e.object,e.remote)}function p(t,i){var n=t.objectUID,o=S.objects[n];if(o){var s=o.quantity-t.quantity;e.setItemQuantity(n,s),s>0&&!i&&y(n)}}function m(t){var i=t.count,n=E.getCraftTable();for(var o in n){var s=parseInt(o,10),a=n[o].quantity,r=S.objects[s];r&&e.setItemQuantity(s,r.quantity-a*i)}}function f(e){g(e.objectUID,e.remote)}function g(t,i){e.resetItemQuantity(t),i||y(t)}function _(e,t,i,n){return M=e.itemInstance.objectUID,w=e.itemInstance.objectGID,T=e.paymentType,w===E.RUNE_SIGNATURE_GID&&"craftPayment"!==A?s(1):1===n?s(1):void x.open({min:1,max:n,defaultValue:n,x:t,y:i})}function v(e,t,i){return!!e.slot&&E.canItemMove(i,"craftInventory",e.slot.getItem())}function y(t){var i=e.getSlotByUID(t);if(i){var n=E.getQuickTransferInfo("craftInventory",i.getItem(),i.getQuantity());n.movedQty>0&&e.selectSlot(i,n.movedQty>1?"stackMove":"")}}function b(e,t,i){return E.howManyCanBeAddedToCraft("craftInventory",i.getItem(),1)>0}r.call(this,{title:l("ui.common.inventory"),className:"CraftInventoryWindow",positionInfo:{right:"0.5%",bottom:"2%",width:"23.2%",height:"95%",isDefault:!0}}),e.registerView(this,{enableSlotContext:!1,tapSelectedEmitsDoubleTap:!0,showHoverFrame:!0,prepareForDragFunction:b,manualReset:!0});var M,w,T,C=!1,A=null,I=window.gui,S=I.playerData.inventory,E=I.playerData.jobs,x=I.windowsContainer.appendChild(new c);x.on("confirm",s);var N=!0,L=null,O=null,D=null,R=null,P=new d(l("ui.craft.craftFilter"),(!0));P.on("change",function(t){N=t,t?e.addFilters([R]):e.removeFilter(R),e.filterList()}),I.on("ExchangeItemPaymentForCraftMessage",this.localizeEvent(h)),I.on("ExchangeModifiedPaymentForCraftMessage",this.localizeEvent(h)),I.on("ExchangeObjectPutInBagMessage",this.localizeEvent(h)),I.on("ExchangeObjectModifiedInBagMessage",this.localizeEvent(h)),this.on("itemModified",this.localizeEvent(function(e){h({object:e,remote:!1})})),I.on("ExchangeReplayCountModifiedMessage",this.localizeEvent(m)),I.on("ExchangeRemovedPaymentForCraftMessage",this.localizeEvent(f)),I.on("ExchangeClearPaymentForCraftMessage",this.localizeEvent(f)),I.on("ExchangeObjectRemovedFromBagMessage",this.localizeEvent(f)),this.on("open",function(s){C||(C=!0,o(this,["crafting","craftPayment","ingredientsBag"],{isDropAllowed:v}),this.on("drop",function(e,t,i){A=t,_(i.slot,i.x,i.y,i.slot.getQuantity())})),E.on("objectAdded",p),E.on("objectModified",p),E.on("objectRemoved",g),s=s||{},D=s.type;var r=s.msg;O=r.skillId;var l=r.maxCase||r.nbCase;"craftMagus"===D?(L={},R=i):"decrafting"===D?R=n:(L=E.getStorageCraftFilterMap(O,l),R=t),e.storageUI.appendChild(P),e.clearFilters(),e.addFilters([a.unlinkedItemsFilter]),N&&e.addFilters([R]),e.filterList(),e.resetDisplay()}),this.on("close",function(){x.hide(),L=null,O=null,D=null}),this.on("closed",function(){e.storageUI.removeChild(P),e.clearFilters(),e.resetItemsQuantity(),e.filterList()}),this.on("slot-tap",function(t){var i=t.getItem();window.gui.openContextualMenuAround("item",t,{item:i});var n=E.getQuickTransferInfo("craftInventory",i,t.getQuantity()),o=n.movedQty;return 0===o?e.unSelectSlot():void(o>1&&t.select({extraStyle:"stackMove"}))}),this.on("slot-doubletap",function(t){var i=t.getItem(),n=E.getQuickTransferInfo("craftInventory",i,t.getQuantity()),o=n.movedQty;return 0===o?e.unSelectSlot():void E.moveItemToCraft(this.id,i,o)})}i(1106);var o=i(317).setDroppable,s=i(172).inherits,a=i(461),r=i(541),l=i(29).getText,c=i(332),d=i(612),u=i(627);s(n,r),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(e){if(e.exchangeType===l.PLAYER_TRADE){var t=y.playerData;g=t.id,_=t.characterBaseInformations.name;var i=h.setupNames(v._targetInfo.targetId,e.source);if(!i)return console.error("TradeWithPlayer: setupNames");b=i.sourceName,M=i.targetName,h.setupCancelPopupTexts({title:a("ui.exchange.requestInProgress"),message:a("ui.exchange.requestInProgress")}),h.setupConfirmPopupTexts({title:a("ui.exchange.exchangeRequest"),message:a("ui.exchange.resquestMessage",b)}),h.askingExchangePopup()}}function t(e){e.exchangeType===l.PLAYER_TRADE&&(r.close("cancel",{keepDialog:!0}),v._domCreated||v._createDom(),y.once("ExchangeLeaveMessage",function(e){var t,i=e.success;t=a(i?"ui.exchange.success":"ui.exchange.cancel"),y.chat.logMsg(t)}),e.firstCharacterId===g?(T=e.firstCharacterCurrentWeight,C=e.secondCharacterCurrentWeight,A=e.firstCharacterMaxWeight,I=e.secondCharacterMaxWeight,w=M):(C=e.firstCharacterCurrentWeight,T=e.secondCharacterCurrentWeight,I=e.firstCharacterMaxWeight,A=e.secondCharacterMaxWeight,w=b),v.setTitle(w+" <-> "+_),v._myTradeSpace.initializePods(T,A),v._otherCharacterTradeSpace.setAsRemote(),v._otherCharacterTradeSpace.initializePods(C,I),i(),r.continueDialog(["tradeWithPlayer","tradeWithPlayerAndNPCInventory"]))}function i(){var e=v._otherCharacterTradeSpace.getEstimationPrice(),t=v._myTradeSpace.getEstimationPrice(),i=!1,n=!1,o=!1;t>0&&t>=2*e&&(i=!0,o=!0),e>0&&e>=2*t&&(i=!0,n=!0),v._otherCharacterTradeSpace.setEstimationPrice(e,{color:i,warning:n}),v._myTradeSpace.setEstimationPrice(t,{color:i,warning:o})}function n(){i(),window.clearTimeout(S),S=window.setTimeout(function(){(v._myTradeSpace.isGoldOrItemToTrade()||v._otherCharacterTradeSpace.isGoldOrItemToTrade())&&v._buttonConfirm.enable()},1e3*p),v._buttonConfirm.disable()}function o(e){v._exchangeStep+=1,e.remote?v._otherCharacterTradeSpace.modifyKama(e.quantity):v._myTradeSpace.modifyKama(e.quantity),n()}function c(e){var t=e.remote,i=e.object,o=i.objectUID,s=i.quantity;v._exchangeStep+=1,v._toggleConfirmForMe(!1),u.createItemInstances(i,function(e,i){if(e)return console.error(e);var a=i.map[o],r=a.weight,l=E[o];l||(l=E[o]={});var c=l.quantity||0;l.weight=r,l.quantity=s;var d=r*(s-c);t?(v._otherCharacterTradeSpace.addAndModifyItem(a),v._otherCharacterTradeSpace.blink(p),v._otherCharacterTradeSpace.incrementExchangePodsQty(-d),v._myTradeSpace.incrementExchangePodsQty(d)):(v._myTradeSpace.addAndModifyItem(a),v._otherCharacterTradeSpace.incrementExchangePodsQty(d),v._myTradeSpace.incrementExchangePodsQty(-d)),n()})}function d(e){var t=e.remote,i=e.objectUID;v._exchangeStep+=1,v._toggleConfirmForMe(!1);var o=E[i];o||console.warn("TradeWithPlayer: no itemMap for",i);var s=o.weight*o.quantity;E[i]={},t?(v._otherCharacterTradeSpace.removeItem(i),v._otherCharacterTradeSpace.blink(p),v._otherCharacterTradeSpace.incrementExchangePodsQty(s),v._myTradeSpace.incrementExchangePodsQty(-s)):(v._myTradeSpace.removeItem(i),v._otherCharacterTradeSpace.incrementExchangePodsQty(-s),v._myTradeSpace.incrementExchangePodsQty(s)),n()}function m(e){var t=e.id,i=e.ready;t===g?v._toggleConfirmForMe(i):v._otherCharacterTradeSpace.toggleReady(i)}function f(){v.targetInfo={},E={},v._otherCharacterTradeSpace.reset(),v._myTradeSpace.reset(),v._toggleConfirmForMe(!1),v._otherCharacterTradeSpace.toggleReady(!1),v._buttonConfirm.disable(),v._exchangeStep=0}s.call(this,{className:"TradeWithPlayerWindow",title:"",positionInfo:{left:"0.5%",top:"2%",width:"612px",height:"350px"}});var g,_,v=this,y=window.gui;this._targetInfo={};var b,M,w,T,C,A,I,S,E={};this._domCreated=!1,this._otherCharacterTradeSpace=null,this._myTradeSpace=null,this._buttonConfirm=null,this._iConfirmed=!1,this._exchangeStep=0,y.on("ExchangeRequestedTradeMessage",e),y.on("ExchangeStartedWithPodsMessage",t),y.on("ExchangeKamaModifiedMessage",this.localizeEvent(o)),y.on("ExchangeObjectAddedMessage",this.localizeEvent(c)),y.on("ExchangeObjectModifiedMessage",this.localizeEvent(c)),y.on("ExchangeObjectRemovedMessage",this.localizeEvent(d)),y.on("ExchangeIsReadyMessage",this.localizeEvent(m)),this._toggleConfirmForMe=function(e){v._iConfirmed=e,v._myTradeSpace.toggleReady(e),e?v._buttonConfirm.disable():v._buttonConfirm.enable()},this.on("close",f)}i(1108);var o=i(172).inherits,s=i(541),a=i(29).getText,r=i(194),l=i(578),c=i(1109),d=i(335).DofusButton,u=i(461),h=i(629),p=2;o(n,s),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.windowBody,i=t.createChild("div",{className:["otherCharacterSpace","tradeSpace"]});this._otherCharacterTradeSpace=i.appendChild(new c({blinkDuration:p}));var n=t.createChild("div",{className:["mySpace","tradeSpace"]});this._myTradeSpace=n.appendChild(new c({blinkDuration:p,dragInteraction:!0,canRemove:!0}));var o=t.createChild("div",{className:"tradeButtons"});this._buttonConfirm=o.appendChild(new d(a("ui.common.validation"),{className:"buttonConfirm",disable:!0})),this._buttonConfirm.on("tap",function(){if(!e._iConfirmed)return!e._otherCharacterTradeSpace.hasFreePods()&&e._myTradeSpace.getItemsToTradeCount()>0?window.gui.openSimplePopup(a("ui.storage.noRoomForTransfert")):void window.dofus.sendMessage("ExchangeReadyMessage",{ready:!0,step:e._exchangeStep})});var s=o.appendChild(new d(a("ui.common.cancel"),{className:"buttonCancel"}));s.on("tap",function(){return e._iConfirmed?window.dofus.sendMessage("ExchangeReadyMessage",{ready:!1,step:e._exchangeStep}):void r.close(e.id)}),this._domCreated=!0},n.prototype.prepareMakeExchange=function(e){this._targetInfo=e}},function(e,t){},function(e,t,i){function n(e){e=e||{},s.call(this,"div",{className:"TradeSpace"});var t=this;this._isRemote=!1,this._blinkDuration=e.blinkDuration||5,this._blinkTimeout=null,this._currentUID=null,this._podsTooltip=new s("div"),this._podsTooltipText="",this._maxPods=0,this._currentPods=0,this._exchangePods=0,this._podsPercent=0,this._estimationPrice={},this.selectedSlot=null,this._minMaxSelector=this.appendChild(new l),this._minMaxSelector.setStyles({left:"20px",top:"50px"}),this._minMaxSelector.on("confirm",function(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:t._currentUID,quantity:e*(this.fromInventory?1:-1)})}),this._tradeGold=this.appendChild(new a),this._tradeGold.on("kamaChange",function(e){window.dofus.sendMessage("ExchangeObjectMoveKamaMessage",{quantity:e})}),this._exchangePodsContent=this.createChild("div",{className:"exchangePodsContent"}),this._exchangePodsProgressBar=this._exchangePodsContent.appendChild(new u({className:"exchangePodsProgressBar"})),h(this._exchangePodsProgressBar,t._podsTooltip);var i=this.createChild("div",{className:"slotBox"});e.dragInteraction&&(p.setDroppable(i,["tradeWithPlayerAndNPCInventory"]),i.on("drop",function(e){var i=e.itemInstance,n=e.getQuantity();return 1===n?window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:i.objectUID,quantity:1}):(t._currentUID=i.objectUID,t._minMaxSelector.fromInventory=!0,void t._minMaxSelector.open({min:1,max:n}))})),this.canRemove=e.canRemove,this._allSlots=i.createChild("div",{className:"slots"});var n=this.createChild("div",{className:"estimationContent"});n.createChild("div",{className:["estimationLabel","half"],text:d("ui.exchange.estimatedValue")+d("ui.common.colon")});var o=n.createChild("div",{className:["estimationValueContent","half"]});this._estimationValue=o.createChild("div",{className:"estimationValue"}),this._estimationWarning=o.createChild("div",{className:"estimationWarning"});var r=null;h(this._estimationWarning,function(){return r?r:r=new s("div",{text:d("ui.exchange.warning")})})}i(1110);var o=i(172).inherits,s=i(321),a=i(1111),r=i(737),l=i(332),c=i(339),d=i(29).getText,u=i(557),h=i(337).addTooltip,p=i(317);o(n,s),e.exports=n,n.prototype.setAsRemote=function(){this._isRemote=!0,this._tradeGold.setAsRemote()},n.prototype.modifyKama=function(e){this._isRemote&&this._tradeGold.blink(this._blinkDuration),this._tradeGold.setKama(e)},n.prototype.blink=function(e){e=e||3;var t=this;window.clearTimeout(this._blinkTimeout),this._blinkTimeout=window.setTimeout(function(){t._allSlots.delClassNames("blink")},1e3*e),this._allSlots.addClassNames("blink")},n.prototype.setEstimationPrice=function(e,t){t=t||{},this._estimationValue.setText(c.kamasToString(e)),this._estimationValue.toggleClassName("warning",t.color),this._estimationWarning.setStyle("visibility",t.warning?"visible":"hidden")},n.prototype.addAndModifyItem=function(e){function t(){var t=s._estimationPrice[l],i=e.item.averagePrice;i<0||(t||(t=s._estimationPrice[l]={}),t.averagePrice=e.item.averagePrice,t.quantity=c)}function i(){if(!s._isRemote&&s.canRemove){var e=o.itemInstance;if(e){s._currentUID=e.objectUID;var t=e.quantity;if(1===t)return window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:s._currentUID,quantity:-1});s._minMaxSelector.fromInventory=!1,s._minMaxSelector.open({min:1,max:e.quantity})}}}function n(e){"remove"===e&&i()}var o,s=this,a=this._allSlots,l=e.objectUID,c=e.quantity;t(),o=a.getChild("slot"+l),o||(o=a.appendChild(new r({name:"slot"+l})),o.setContextMenu("item",{item:o.itemInstance,remove:s.canRemove,onClose:n,enableActions:!1}),s.canRemove&&(o.on("doubletap",i),o.on("tap",function(){s.selectedSlot&&s.selectedSlot.delClassNames("selected"),s.selectedSlot=this,s.selectedSlot.addClassNames("selected")}))),o.setItem(e),s.canRemove&&p.setDraggable(o,{backgroundImage:o.getImage()},"tradeSpace")},n.prototype.removeItem=function(e){delete this._estimationPrice[e];var t=this._allSlots.getChild("slot"+e);t&&(t===this.selectedSlot&&(this.selectedSlot=null),t.destroy())},n.prototype.getEstimationPrice=function(){var e=this._tradeGold.getKama(),t=this._estimationPrice;for(var i in t){var n=t[i];e+=n.quantity*n.averagePrice}return e},n.prototype.toggleReady=function(e){this._tradeGold.toggleReady(e),this._allSlots.toggleClassName("isReady",e)},n.prototype.setPodsProgressBar=function(){var e=this._maxPods,t=this._currentPods,i=this._exchangePods;if(e){var n=this._podsPercent=Math.min(100,Math.floor(100*(t+i)/e));this._exchangePodsProgressBar.setValue(this._podsPercent/100),n<=60?this._exchangePodsProgressBar.replaceClassNames(["yellow","orange","red"],["green"]):n<=70?this._exchangePodsProgressBar.replaceClassNames(["green","orange","red"],["yellow"]):n<=80?this._exchangePodsProgressBar.replaceClassNames(["green","yellow","red"],["orange"]):this._exchangePodsProgressBar.replaceClassNames(["green","yellow","orange"],["red"]),this._podsTooltipText=d("ui.common.player.weight",c.kamasToString(t+i,""),c.kamasToString(e,"")),this._podsTooltip.setText(this._podsTooltipText)}},n.prototype.initializePods=function(e,t){this._maxPods=t,this._currentPods=e,this._exchangePods=0,this.setPodsProgressBar()},n.prototype.NPCTradeMode=function(){this._exchangePodsContent.hide(),this._tradeGold.setReadOnly(!0)},n.prototype.incrementExchangePodsQty=function(e){this._exchangePods+=e,this.setPodsProgressBar()},n.prototype.isGoldOrItemToTrade=function(){if(this._tradeGold.getKama()>0)return!0;for(var e=this._allSlots.getChildren(),t=0,i=e.length;t<i;t+=1){var n=e[t];if(n.itemInstance)return!0}return!1},n.prototype.getItemsToTradeCount=function(){for(var e=0,t=this._allSlots.getChildren(),i=0;i<t.length;i++)t[i].itemInstance&&e++;return e},n.prototype.hasFreePods=function(){return this._maxPods-(this._currentPods+this._exchangePods)>=0},n.prototype.reset=function(){this._tradeGold.reset(),this._isRemote=!1,this._currentUID=null,this._maxPods=0,this._currentPods=0,this._exchangePods=0,this._podsPercent=0,this._estimationPrice={},this._exchangePodsContent.show(),this._tradeGold.show(),window.clearTimeout(this._blinkTimeout),this._allSlots.delClassNames("blink"),this._podsTooltip.setText(""),this._allSlots.clearContent(),this.selectedSlot=null}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"TradeGold"});var e=this;this._blinkTimeout=null,this._currentKama=0,this._kamaContent=this.createChild("div",{className:"kamaContent"});var t;l.addTooltip(this._kamaContent,function(){return t||(t=new s("div",{className:"kamaTooltip",text:a("ui.exchange.kamas")})),t}),l.enableTooltip(this._kamaContent,!1);var i=this._kamaContent.createChild("div",{className:"imgContent"});i.createChild("div",{className:"kamaImg"});var n=this._kamaContent.createChild("div",{className:"kamaInput"}),o=this._input=n.appendChild(new r({minValue:0,title:a("ui.common.kamas")}));n.createChild("div",{className:"kamaUnit",text:a("ui.common.short.kama")}),o.on("focus",function(){o.maxValue=window.gui.playerData.inventory.kamas}),o.on("change",function(t){e._currentKama!==t&&(e._currentKama=t,e.emit("kamaChange",t))})}i(1112);var o=i(172).inherits,s=i(321),a=i(29).getText,r=i(340),l=i(337);o(n,s),e.exports=n,n.prototype.getKama=function(){return this._input.getValue()},n.prototype.setKama=function(e){this._input.setValue(e)},n.prototype.blink=function(e){e=e||3;var t=this;window.clearTimeout(this._blinkTimeout),this._blinkTimeout=window.setTimeout(function(){t._kamaContent.delClassNames("blink")},1e3*e),this._kamaContent.addClassNames("blink")},n.prototype.toggleReady=function(e){this._kamaContent.toggleClassName("isReady",e)},n.prototype.setAsRemote=function(){l.enableTooltip(this._kamaContent,!0),this._input.setReadonly(!0)},n.prototype.reset=function(){this._input.setValue(0),this._input.setReadonly(!1),window.clearTimeout(this._blinkTimeout),this._kamaContent.delClassNames("blink"),this._currentKama=0,
l.enableTooltip(this._kamaContent,!1)},n.prototype.setReadOnly=function(e){this._input.setReadonly(e)}},function(e,t){},function(e,t,i){function n(){function e(){p._domCreated||p._createDom(),m.once("ExchangeLeaveMessage",function(e){var t,i=e.success;t=a(i?"ui.exchange.success":"ui.exchange.cancel"),m.chat.logMsg(t)}),p.setTitle(p._npcName+" <-> "+m.playerData.characterBaseInformations.name),p._myTradeSpace.NPCTradeMode(),p._npcTradeSpace.setAsRemote(),p._npcTradeSpace.NPCTradeMode(),t(),r.continueDialog(["tradeWithNPC","tradeWithPlayerAndNPCInventory"])}function t(){var e=p._npcTradeSpace.getEstimationPrice(),t=p._myTradeSpace.getEstimationPrice(),i=!1,n=!1,o=!1;t>0&&t>=2*e&&(i=!0,o=!0),e>0&&e>=2*t&&(i=!0,n=!0),p._npcTradeSpace.setEstimationPrice(e,{color:i,warning:n}),p._myTradeSpace.setEstimationPrice(t,{color:i,warning:o})}function i(){t(),window.clearTimeout(h),h=window.setTimeout(function(){p._npcTradeSpace.isGoldOrItemToTrade()&&p._buttonConfirm.enable()},1e3*u),p._buttonConfirm.disable()}function n(e){var t=e.remote,n=e.object,o=n.objectUID;p._exchangeStep+=1,d.createItemInstances(n,function(e,n){if(e)return console.error(e);var s=n.map[o];t?(p._npcTradeSpace.addAndModifyItem(s),p._npcTradeSpace.blink(u)):p._myTradeSpace.addAndModifyItem(s),i()})}function o(e){var t=e.remote,n=e.objectUID;p._exchangeStep+=1,t?(p._npcTradeSpace.removeItem(n),p._npcTradeSpace.blink(u)):p._myTradeSpace.removeItem(n),i()}function l(){p._npcTradeSpace.reset(),p._myTradeSpace.reset(),p._buttonConfirm.disable(),p._exchangeStep=0}function c(e){p._exchangeStep+=1,e.remote?p._npcTradeSpace.modifyKama(e.quantity):p._myTradeSpace.modifyKama(e.quantity)}s.call(this,{className:"TradeWithNPCWindow",title:"",positionInfo:{left:"0.5%",top:"2%",width:"612px",height:"300px"}});var h,p=this,m=window.gui;this._npcName="",this._domCreated=!1,this._npcTradeSpace=null,this._myTradeSpace=null,this._buttonConfirm=null,this._exchangeStep=0,m.on("ExchangeStartOkNpcTradeMessage",e),m.on("ExchangeKamaModifiedMessage",this.localizeEvent(c)),m.on("ExchangeObjectAddedMessage",this.localizeEvent(n)),m.on("ExchangeObjectModifiedMessage",this.localizeEvent(n)),m.on("ExchangeObjectRemovedMessage",this.localizeEvent(o)),this.on("closed",l)}i(1114);var o=i(172).inherits,s=i(541),a=i(29).getText,r=i(194),l=i(1109),c=i(335).DofusButton,d=i(461),u=2;o(n,s),e.exports=n,n.prototype.prepareExchange=function(e){this._npcName=e},n.prototype._createDom=function(){var e=this,t=this.windowBody,i=t.createChild("div",{className:["otherCharacterSpace","tradeSpace"]});this._npcTradeSpace=i.appendChild(new l({blinkDuration:u}));var n=t.createChild("div",{className:["mySpace","tradeSpace"]});this._myTradeSpace=n.appendChild(new l({blinkDuration:u,dragInteraction:!0}));var o=t.createChild("div",{className:"tradeButtons"});this._buttonConfirm=o.appendChild(new c(a("ui.common.validation"),{className:"buttonConfirm",disable:!0})),this._buttonConfirm.on("tap",function(){window.dofus.sendMessage("ExchangeReadyMessage",{ready:!0,step:e._exchangeStep})});var s=o.appendChild(new c(a("ui.common.cancel"),{className:"buttonCancel"}));s.on("tap",function(){r.close(e.id)}),this._domCreated=!0}},function(e,t){},function(e,t,i){function n(e){function t(){for(var t in h)e.resetItemQuantity(t);h={}}function i(t){if(!t.remote){var i=t.object.objectUID,n=d.objects[i];e.setItemQuantity(i,n.quantity-t.object.quantity),h[i]=!0}}function n(t){if(!t.remote){var i=t.objectUID;e.resetItemQuantity(i),delete h[i]}}a.call(this,{title:r("ui.common.inventory"),className:"TradeWithPlayerAndNPCInventoryWindow",positionInfo:{right:"0.5%",top:"2%",width:"23.2%",height:"95%"}}),this.storageViewer=e,e.registerView(this,{manualReset:!0}),c.setDroppable(this,["tradeSpace"]),this.on("drop",function(e){var t=e.itemInstance.quantity;return 1===t?window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e.itemInstance.objectUID,quantity:-1}):(o=e.itemInstance.objectUID,p.fromInventory=!1,void p.open({min:1,max:t}))});var o,d=window.gui.playerData.inventory,u=window.gui,h={},p=this.appendChild(new l);p.setStyles({left:"-100px",top:"100px"}),p.on("confirm",function(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:o,quantity:e*(this.fromInventory?1:-1)})}),u.on("ExchangeObjectRemovedMessage",this.localizeEvent(n)),u.on("ExchangeObjectAddedMessage",this.localizeEvent(i)),u.on("ExchangeObjectModifiedMessage",this.localizeEvent(i)),this.on("open",function(){e.addFilters([s.unlinkedItemsFilter]),e.filterList(),e.resetDisplay()}),this.on("close",function(){e.removeFilter(s.unlinkedItemsFilter),p.hide(),t()}),this.on("slot-doubletap",function(e){var t=e.itemInstance;o=t.objectUID;var i=e.getQuantity();return 1===i?window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:o,quantity:1}):(p.fromInventory=!0,void p.open({min:1,max:i}))})}i(1116);var o=i(172).inherits,s=i(461),a=i(541),r=i(29).getText,l=i(332),c=i(317);o(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"CancelWindow",positionInfo:{left:"c",top:"c",width:600,height:200},noCloseButton:!0});var e=this,t=this.windowBody.createChild("div",{className:"messageBox"});this.message=t.createChild("div",{className:"message"});var i=this.windowBody.createChild("div",{className:"buttonContainer"}),n=i.appendChild(new a(r("ui.common.cancel")));n.on("tap",function(){"function"==typeof e.cb&&e.cb(),e.close()})}i(1118);var o=i(172).inherits,s=i(541),a=i(335).DofusButton,r=i(29).getText;o(n,s),e.exports=n,n.prototype.update=function(e,t){t=t||{},this.windowTitle.setText(e.title),this.message.setHtml(e.message),this.cb=e.cb,this.keepDialog=t.keepDialog}},function(e,t){},function(e,t,i){function n(){T.call(this,{className:"OptionsWindow",title:m("ui.common.options"),positionInfo:{left:"c",top:"c",width:"80%",height:"70%"}}),this.optionDefinitions=null,this.sections=null,this.currentSection=null,this.optionMap=null,this.on("open",this._open),this.on("close",this._close)}function o(e){g.changeValue(this.myName,e)}function s(e,t,i){var n=e.appendChild(new p(i,(!1)));return n.addClassNames("settingOption"),n.myName=t,n.on("change",o),n}function a(e,t,i,n){var o=e.appendChild(new h(t,{className:["settingOption","optionButton"]},n));i&&d.addTooltip(o,i)}function r(e){g.changeValue(this.myName,e)}function l(e,t,i,n,o){o=o||n;var s=e.createChild("div");s.createChild("div",{className:["settingOption","dropdownLabel"],text:i});var a=s.appendChild(new v({className:"settingOption"}));a.myName=t,a.on("change",r);for(var l=0;l<n.length;l++)a.addOption(o[l],n[l]);return a}function c(e){var t=e.showedFor;if(!t)return!0;for(var i=0;i<t.length;i++)switch(t[i]){case"narrowScreen":if(window.gui.ipadRatio)return!0;break;default:console.error("Invalid showedFor value:",t[i])}return!1}i(1120);var d=i(337),u=i(247),h=i(335).DofusButton,p=i(612),m=i(29).getText,f=i(172).inherits,g=i(171),_=i(436),v=i(532),y=i(452).SingleSelectionList,b=i(1121),M=i(770),w=i(176),T=i(541),C=i(177);f(n,T),e.exports=n,n.prototype._initOptionDefinitions=function(){this.optionDefinitions=[{name:"game",title:m("ui.common.general"),optionDefs:[{type:"header",text:m("ui.option.worldOption")},{name:"showAllMonsters",text:m("ui.option.viewAllMonsterInGroup")},{name:"maxActorsBeforeCreatureMode",type:"dropdown",text:m("ui.option.creaturesMode"),values:[0,10,20,40,9999],labels:[0,10,20,40,m("ui.common.infinit")]},{name:"alwaysShowGrid",text:m("tablet.option.alwaysShowGrid")},{name:"menubarSize",type:"dropdown",text:m("tablet.option.menubarSize"),values:[2,3,4,5,6],labels:[2,3,4,5,6]},{type:"header",text:m("tablet.option.compass")},{name:"autoGpsFlags",text:m("tablet.option.autoGpsFlags")},{type:"btn",text:m("tablet.option.unfollowAllQuests"),action:window.gui.GPS.questFollower.unfollowAllQuests.bind(window.gui.GPS.questFollower)},{name:"autoGpsPhoenixes",text:m("tablet.option.autoGpsPhoenixes")}]},{name:"fight",title:m("ui.common.fight"),optionDefs:[{type:"header",text:m("ui.common.fight")},{name:"menubarSizeInFight",type:"dropdown",text:m("tablet.option.fight.menubarSizeInFight"),values:[2,3,4,5,6],labels:[2,3,4,5,6]},{name:"toolbarThicknessInFight",type:"dropdown",showedFor:["narrowScreen"],text:m("tablet.option.fight.toolbarThicknessInFight"),values:[1,2,3],labels:[1,2,3]},{name:"hideDeadFighters",text:m("ui.option.hideDeadFighters")},{name:"allowSpellEffects",text:m("ui.option.allowSpellEffects")},{name:"confirmBoxWhenWalking",text:m("tablet.option.fight.confirmBoxWhenWalking")},{name:"showSpeechBubbleInFight",text:m("tablet.option.fight.showSpeechBubbleInFight")},{name:"orderFighters",text:m("tablet.option.fight.orderFighters")},{name:"showApMpUsed",text:m("tablet.option.fight.showApMpUsed")},{type:"header",text:m("ui.charcrea.spells")},{name:"confirmBoxWhenDragCasting",type:"dropdown",text:m("tablet.option.fight.confirmBoxWhenDragCasting"),values:[C.NEVER,C.ALWAYS,C.EMPTY_ONLY],labels:[m("tablet.option.fight.Never"),m("tablet.option.fight.Always"),m("tablet.option.fight.EmptyOnly")]},{name:"confirmBoxWhenClickCasting",type:"dropdown",text:m("tablet.option.fight.confirmBoxWhenClickCasting"),values:[C.NEVER,C.ALWAYS,C.EMPTY_ONLY],labels:[m("tablet.option.fight.Never"),m("tablet.option.fight.Always"),m("tablet.option.fight.EmptyOnly")]}]},{name:"sounds",title:m("ui.option.audio"),optionDefs:[{type:"header",text:m("ui.option.audioSubtitle")},{name:"soundOnPlayerTurnStart",text:m("ui.option.startTurnSound")}],create:n.prototype._createSoundOptions,init:n.prototype._initSoundOptions},{name:"misc",title:m("ui.option.miscellaneousOptions"),optionDefs:[{type:"header",text:m("ui.common.chat")},{name:"censorship",text:m("ui.option.censorship")},{type:"header",text:m("ui.tutorial.tutorial")},{name:"tutorialTips",text:m("ui.option.allowTutorial")},{type:"btn",text:m("ui.option.resetHints"),action:M.resetTips.bind(M)},{type:"header",text:m("tablet.option.spellTooltip")},{name:"spellTooltipName",text:m("tablet.option.spellTooltipName")},{name:"spellTooltipApRange",text:m("tablet.option.spellTooltipApRange")},{name:"spellTooltipCritical",text:m("tablet.option.spellTooltipCritical")},{name:"spellTooltipEffect",text:m("tablet.option.spellTooltipEffect")},{name:"spellTooltipDescription",text:m("tablet.option.spellTooltipDescription")}]}]},n.prototype.freeContent=function(){this.windowBody.clearContent(),this.sections=this.currentSection=null},n.prototype._open=function(){this.sections||(this._createContent(),this.menuList.selectItem(0,{noSound:!0})),this._initContent()},n.prototype._close=function(){w.saveNow()},n.prototype._initContent=function(){for(var e=0;e<this.optionDefinitions.length;e++)this._initOptionSection(e,this.optionDefinitions[e])},n.prototype._createContent=function(){this.sections=[],this.optionMap={},this._initOptionDefinitions();var e=this.windowBody.createChild("div",{className:"content"}),t=e.createChild("div",{className:"menuCol"});this.menuList=t.appendChild(new y({className:"menu"},{disableSelectionToggle:!0}));var i=this;this.menuList.on("selected",function(e){i._showSection(e.id),this.scrollToElement(e)});var n=e.createChild("div",{className:"settingsCol"});this.settingsScroller=n.appendChild(new _({className:"settings"})),this.settingsCol=this.settingsScroller.content;for(var o=0;o<this.optionDefinitions.length;o++)this._createOptionSection(this.optionDefinitions[o])},n.prototype._showSection=function(e){this.currentSection&&this.currentSection.hide(),this.currentSection=this.sections[e],this.currentSection.show(),this.settingsScroller.refresh()},n.prototype._createOptionSection=function(e){var t=this.sections.length,i=this.menuList.addItem({id:t,element:e.title},{noRefresh:!0});t%2&&i.addClassNames("odd");var n=this.settingsCol.createChild("div",{className:["optionSection",e.name+"Section"],hidden:!0});if(e.text){var o=n.createChild("div",{className:"titleBox"});o.createChild("div",{className:"sectionDescription",text:e.text})}for(var r=n.createChild("div",{className:"allOptions"}),d=e.optionDefs,u=0;u<d.length;u++){var h=d[u];if(c(h)){var p=h.type||"bool",m=null;switch(p){case"bool":m=s(r,h.name,h.text);break;case"dropdown":m=l(r,h.name,h.text,h.values,h.labels);break;case"btn":a(r,h.text,h.tooltipText,h.action);break;case"header":r.createChild("div",{className:"header",text:h.text});break;default:console.warn("Unvalid option type:",p)}m&&(this.optionMap[h.name]=m)}}return e.create&&e.create.call(this,r),this.sections.push(n),n},n.prototype._initOptionSection=function(e,t){for(var i=t.optionDefs,n=0;n<i.length;n++){var o=i[n],s=o.name;if(c(o)){var a=this.optionMap[s],r=o.type||"bool";switch(r){case"bool":a.toggleActivation(g[s],!0);break;case"dropdown":a.select(g[s],!0);break;case"btn":break;case"header":break;default:console.warn("Unvalid option type:",r)}}}t.init&&t.init.call(this)},n.prototype._newSoundChannelOption=function(e,t,i,n){this.optionMap[t+"Sound"]=e.appendChild(new b(n,t,i))},n.prototype._setSoundChannelVolume=function(e,t){this.optionMap[e+"Sound"].setPosition(t[e].volume||0)},n.prototype._createSoundOptions=function(e){var t=w.getValue("soundPreferences",u.getDefaultParams(),!0);this._newSoundChannelOption(e,"music",m("ui.option.musics"),t),this._newSoundChannelOption(e,"sfx",m("ui.option.environment"),t),this._newSoundChannelOption(e,"ui",m("ui.option.sounds"),t)},n.prototype._initSoundOptions=function(){var e=w.getValue("soundPreferences",u.getDefaultParams(),!0);this._setSoundChannelVolume("music",e)}},function(e,t){},function(e,t,i){function n(e,t,i){function n(){a.changeVolume(this.volume),l.playUiSound("SPEC_BUTTON")}o.call(this,"div",{className:"SoundChannelVolume"});var a=this;this.channelId=t,this.preferences=e,this.createChild("div",{className:"label",text:i});for(var r=this.createChild("div",{className:"volumeButtons"}),c=this.buttons=[],d=0;d<5;d++){var u=r.appendChild(new s("",{className:["volume","volume"+d]}));c.push(u),u.volume=d/4,u.disable(),u.on("tap",n)}e[this.channelId]=e[this.channelId]||{volume:0,muted:!0},this.setPosition(e[this.channelId].volume||0)}i(1122);var o=i(321),s=i(335).DofusButton,a=i(172).inherits,r=i(176),l=i(247);a(n,o),e.exports=n,n.prototype.setPosition=function(e){e=Math.max(0,Math.min(4,~~(4*e)));for(var t=0;t<5;t++)this.buttons[t].enable();this.buttons[e].disable()},n.prototype.changeVolume=function(e){l.setChannelVolume(this.channelId,e),this.setPosition(e),this.preferences[this.channelId].volume=e,this.preferences[this.channelId].muted=0===e,r.setValue("soundPreferences",this.preferences,null,!0)}},function(e,t){},function(e,t,i){function n(){r.call(this,{className:"FightEndRewardsWindow",positionInfo:{left:"c",top:"c",width:356,height:274}}),this.scroller=this.windowBody.appendChild(new a),this.scroller.content.addClassNames("overlayBox")}i(1124);var o=i(172).inherits,s=i(737),a=i(436),r=i(541);o(n,r),e.exports=n,n.prototype.updateContent=function(e,t,i){this.setTitle(e);var n=this.scroller.content;n.clearContent();for(var o=0;o<t.length;o+=1)n.appendChild(new s({itemData:t[o],quantity:i[t[o].id]||0,tooltipOptions:{openOnTap:!0}}));this.scroller.refresh()}},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"HardcoreDeathWindow",positionInfo:{left:"c",top:"c",width:500,height:365}});var e=this;this.once("open",function(){e._createDom()})}i(1126);var o=i(172).inherits,s=i(204),a=i(541),r=i(321),l=i(194),c=i(335).DofusButton,d=i(29).getText,u=i(182);o(n,a),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.windowBody.createChild("div",{className:"message"}),i=new r("div",{className:"characterIllu"});this.insertAsFirstChild(i),u.preloadImage("gfx/illusUi/Heroique_tx_GameOver.png",function(e){i.setStyle("backgroundImage",e)});var n=this.windowBody.createChild("div",{className:"buttonContainer"}),o=n.appendChild(new c(d("ui.common.yes")));o.on("tap",function(){l.close(e.id),s.goBackToSelectionOf("character")}),this.windowTitle.setText(d("ui.common.gameover")),t.setHtml(d("ui.gameuicore.hardcoreDeath"))}},function(e,t){},function(e,t,i){function n(){c.call(this,{title:s("ui.common.confirm"),className:"ShopConfirmWindow",positionInfo:{left:"c",top:"c",width:500,height:300,isModal:!0}}),this._reset(),this.on("open",this._onOpen),this.on("close",this._onClose);var e=this;l.on("canNotComputeSoftPrices",function(){if(e.articleBox){var t=!e.isPurchasing,i=!e.params.article.product&&!!e.params.isSoft;t&&i&&d.close(e.id)}}),l.on("computedSoftPricesChange",function(){if(e.articleBox){var t=!e.isPurchasing,i=!e.params.article.product&&!!e.params.isSoft;t&&i&&(u.enrichWithSoftPrice(e.params.article),e.updateAmount())}})}i(1128);var o=i(335),s=i(29).getText,a=i(339),r=i(172).inherits,l=i(713),c=i(541),d=i(194),u=i(801),h=i(1129);r(n,c),e.exports=n,n.prototype._reset=function(){this.params=null,this.cb=null,this.articleBox=null,this.buyBtn=null,this.buyBtnAmount=null,this.buyBtnIcon=null,this.purchaseLoader=null,this._setIsPurchasing(!1)},n.prototype._onOpen=function(){this.articleBox||this._createContent()},n.prototype._onClose=function(){return this.cb&&this.cb(!1)},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._createContent=function(){var e=this.windowBody.createChild("div",{className:"twoColumns"}),t=e.createChild("div",{className:"leftCol"});this.articleBox=t.appendChild(new h(null,{boxWidth:190,boxHeight:220},{showTitle:!0,promoType:"corner"}));var i=e.createChild("div",{className:"rightCol"});i.createChild("div",{className:"buyLabel",text:s("ui.common.buy")});var n=s("ui.common.quantity")+s("ui.common.colon")+"1";i.createChild("div",{className:"quantityLabel",text:n});var a=this;this.buyBtn=i.appendChild(new o({className:["buyBtn","greenButton"]},function(){a._setIsPurchasing(!0),a.cb(!0)}));var r=this.buyBtn.createChild("div",{className:"btnContent"});this.buyBtnAmount=r.createChild("div",{className:"btnAmount"}),this.buyBtnIcon=r.createChild("div",{className:"btnIcon"}),this.purchaseLoader=i.createChild("div",{className:["purchaseLoader","spinner"],hidden:!0}),this.purchaseLoader.createChild("div",{className:"purchaseLoaderLabel",text:s("tablet.shop.transactionInProgress")})},n.prototype.confirmBuy=function(e,t){d.open(this.id),this._setIsPurchasing(!1),this.params=e,this.cb=t,this.articleBox.update(e.article),this.updateAmount()},n.prototype._setIsPurchasing=function(e){this.isPurchasing=!!e,this.articleBox&&(e?(this.closeButton.disable(),this.buyBtn.disable()):(this.closeButton.enable(),this.buyBtn.enable()),this.purchaseLoader.toggleDisplay(e))},n.prototype.updateAmount=function(){if(this.articleBox){var e=this.params,t=e.article,i=t.product;if(i)this.buyBtnAmount.setText(i.price),this.buyBtnIcon.hide();else{var n=e.isSoft,o=window.gui.playerData.inventory,s=n?o.kamas:o.goultines,r=n?t._softPrice:t.price;r>s?this.buyBtn.disable():this.buyBtn.enable(),this.buyBtnAmount.setText(a.intToString(r)),this.buyBtnIcon.show(),this.buyBtnIcon.toggleClassName("hardCcy",!n),this.buyBtnIcon.toggleClassName("softCcy",!!n)}}}},function(e,t){},function(e,t,i){function n(e,t,i){l.call(this,"div",{className:"box"}),this.options=i||{},this._createDom(),e&&this.update(e),t&&this.resize(t)}function o(){this.emit("tapItemImage")}function s(e){return 1===e.promo.length&&e.promo[0].image?e.promo[0].image:e.image.length>p?e.image[p].url:null}function a(e){var t=e._promoRate;return t?t:d("tablet.shop.offer")}i(1130);var r=i(172).inherits,l=i(321),c=i(197),d=i(29).getText,u=i(1131),h=i(1133),p=1;r(n,l),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.options,i=this.createChild("div",{className:"slot"});i.createChild("div",{className:"slotBackground"});var n=i.createChild("div",{className:"slotIllu"});if(this.slotImg=n.createChild("div",{className:"slotImg"}),t.showDescription&&(this.description=i.createChild("div",{className:"description"})),i.createChild("div",{className:"slotBorder"}),t.canTapImage&&(c(i),i.on("tap",o.bind(this))),t.showTitle&&(this.title=this.createChild("div",{className:"title"})),t.showButtons){var s=this._articleButtons=this.appendChild(new u);s.on("tapIAPButton",function(){e.emit("tapIAPButton")}),s.on("tapHardButton",function(){e.emit("tapHardButton")}),s.on("tapSoftButton",function(){e.emit("tapSoftButton")})}if("banner"===t.promoType)this._promoBanner=i.createChild("div",{className:"promoBanner"});else if("corner"===t.promoType){var a=this._promoCorner=i.createChild("div",{className:"promoCorner"});a.createChild("div",{className:"promoDummy"});var r=a.createChild("div",{className:"promoElement"});r.createChild("div",{className:"margin"});var l=r.createChild("div",{className:"rotatedContainer"});this._promoRate=l.createChild("div",{className:"text"})}else"strip"===t.promoType&&(this._promoStrip=this.createChild("div",{className:"promoStrip"}))},n.prototype.clear=function(){this.countdown&&this.countdown.clear()},n.prototype.update=function(e){var t=this.options;this.articleId=e.id;var i=s(e);this.slotImg.setStyle("backgroundImage",i?"url("+i+")":"none");var n=e.product,o=!e.hasOwnProperty("_softPrice")&&!n;this.toggleClassName("goultineOnly",o);var r,l,c=t.promoType;if("banner"===c){var u=e.enddate;if(this._promoBanner.toggleDisplay(!!u),u){var p=this;this.countdown&&this.countdown.clear(),this.countdown=new h(new Date(u),function(e,t,i){return e?console.error(e):void p._promoBanner.setText(d("tablet.shop.promo.banner",i).toUpperCase())},function(){p._promoBanner.hide()})}}else"corner"===c?(r=e._promoRate,l=!!(r||e.promo.length||e.enddate),this._promoCorner.toggleDisplay(l),l&&this._promoRate.setText(a(e))):"strip"===c&&(r=e._promoRate,l=!!(r||e.promo.length||e.enddate),this._promoStrip.toggleDisplay(l),l&&this._promoStrip.setText(a(e)));t.showTitle&&this.title.setText(e.name),this.updatePrice(e),t.showDescription&&this.description.setHtml(e.description)},n.prototype.updatePrice=function(e){this.options.showButtons&&this._articleButtons.update(e)},n.prototype.resize=function(e){this.setStyles({width:e.boxWidth+"px",height:e.boxHeight+"px"}),this.options.showButtons&&this._articleButtons.resize(e)}},function(e,t){},function(e,t,i){function n(e,t){r.call(this,"div",{className:"priceButtonsBox"}),this._createDom(),e&&this.update(e),t&&this.resize(t)}function o(e){this.emit(e)}function s(e,t,i,n){var o;e.toggleClassName("iap",!!n),n?(e.delClassNames(["unavailable"]),e.currentPriceText.setText(t)):(e.toggleClassName("unavailable",!t),t?(e.currentPriceText.setText(l.kamasToString(t,"")),t>=h?e.replaceClassNames(["lowPrice"],["bigPrice"]):t<p?e.replaceClassNames(["bigPrice"],["lowPrice"]):e.delClassNames(["lowPrice","bigPrice"]),e.enable(),i&&(o=l.kamasToString(i,""),e.originalPriceText.setText(o))):(e.currentPriceText.setText(u("ui.item.averageprice.unavailable")),e.replaceClassNames(["lowPrice"],["bigPrice"]),e.disable()))}i(1132);var a=i(172).inherits,r=i(321),l=i(339),c=i(335),d=c.DofusButton,u=i(29).getText,h=1e6,p=1e3;a(n,r),e.exports=n,n.prototype._createDom=function(){function e(e,i){var n=i?["priceButton",i]:"priceButton",o=t.appendChild(new d("",{className:n},e)),s=o.createChild("div",{className:"prices"}),a=s.createChild("div",{className:"original"});o.originalPriceText=a.createChild("div",{className:"text"}),a.createChild("div",{className:"icon"});var r=s.createChild("div",{className:"current"});return o.currentPriceText=r.createChild("div",{className:"text"}),r.createChild("div",{className:"icon"}),o}this.createChild("div",{className:"priceBorder"});var t=this.priceButtons=this.createChild("div",{className:"priceButtons"});this.iapButton=e(o.bind(this,"tapIAPButton")),this.hardButton=e(o.bind(this,"tapHardButton"),"hard"),this.softButton=e(o.bind(this,"tapSoftButton"),"soft")},n.prototype.update=function(e){this.articleId=e.id;var t=e.original_price,i=e.product;if(i)this.hardButton.hide(),this.softButton.hide(),s(this.iapButton,i.price,t,!0),this.iapButton.show();else{this.iapButton.hide(),this.priceButtons.toggleClassName("promo",!!t),s(this.hardButton,e.price,t),s(this.softButton,e._softPrice,e._softOriginalPrice),this.hardButton.show();var n=!e.hasOwnProperty("_softPrice");n?(this.hardButton.delClassNames("twoPrices"),this.softButton.hide()):(this.hardButton.addClassNames("twoPrices"),this.softButton.show())}},n.prototype.resize=function(){}},function(e,t){},function(e,t,i){function n(e,t,i){this._endTimestamp=e,this._updateCallback=t,this._endCallback=i,this._endTimeout=null,this._updateTimeout=null,this._setUpdateTimeout(),this._setEndTimeout()}function o(e){var t;return e.day?t=e.day+" "+s("ui.time.days",e.day):e.hour?t=e.hour+" "+s("ui.time.hours",e.hour):e.minute&&(t=e.minute+" "+s("ui.time.minutes",e.minute)),t}var s=i(29).getText,a=6e4,r=60*a,l=24*r;e.exports=n,n.prototype.clear=function(){clearTimeout(this._updateTimeout),clearTimeout(this._endTimeout),this._endTimeout=null,this._updateTimeout=null,this._endTimestamp=null,this._updateCallback=null,this._endCallback=null},n.prototype._setEndTimeout=function(){var e=this,t=Date.now(),i=this._endTimestamp-t;i>l||(i>0?this._endTimeout=setTimeout(function(){e._endCallback(),e.clear()},i):(this._endCallback(),this.clear()))},n.prototype._setUpdateTimeout=function(){var e,t=this,i=Date.now(),n=this._endTimestamp-i;if(!(n<=0)){var s=n%a===0?1:0,c=Math.max(0,~~(n/l)-s),d=Math.max(0,~~(n/r)-s),u=Math.max(0,~~(n/a)-s);c?e=n%l||l:d?e=n%r||r:u&&(e=n%a||a);var h={day:c,hour:d,minute:u||1},p=o(h);if(!p)return t._updateCallback(new Error("Time left could not be formatted, day: "+h.day+", hour: "+h.hour+", minute: "+h.minute));t._updateCallback(null,h,p),e&&(this._updateTimeout=setTimeout(function(){t._setUpdateTimeout()},e))}}},function(e,t,i){function n(){s.call(this,{className:"MarketWindow",positionInfo:{top:20,left:60,right:20,bottom:20}});var e=["shop"],t=this.tabsDefinitions={shop:{target:new a}},i=this.windowBody;this.tabs=i.appendChild(new r);for(var n=0;n<e.length;n++){var o=e[n],l=t[o],c=i.appendChild(l.target);c.tabId=o,this.tabs.addTab("",c,o)}this._initTabs(),this.on("open",function(e){this.tabs.openTab(e.tabId,e.tabParams,{delayOpenedEvent:!0,forceOpen:!0})}),this.on("opened",function(e){e=e||{},this.tabs.emitOnCurrentTab("opened",e.tabParams||{})}),this.on("close",function(){this._resetTabs()}),this._setupEvents()}i(1135);var o=i(172).inherits,s=i(541),a=i(1136),r=i(889);o(n,s),e.exports=n,n.prototype._initTabs=function(){var e=this.tabsDefinitions;for(var t in e)this.tabs.toggleTabAvailability(t,!e[t].disabled)},n.prototype._setupEvents=function(){var e=this,t=window.gui;t.on("disconnect",function(){e._resetTabs(),e._initTabs()})},n.prototype.getOpenedTabId=function(){return this.tabs.getCurrentTabId()},n.prototype._resetTabs=function(){this.tabs.close()}},function(e,t){},function(e,t,i){function n(){p.close("market")}function o(){l.call(this,"div",{className:"ShopWindow",name:"shop"}),this.nbArticlesVisible=1,this.activeTopTab=null,this.selectedTopTab=null,this.selectedSubTab=null,this.openedCategory=null,this.categoriesName={},this.categoriesData={},this.bonusCountdown=null,this.requestTimestamp=0,this.requestTimeout=null,this.lastAction=null,this.isInitializing=!1,this.articlesMap={},this._views={},this._currentViewName=null,this._previousViewName=null,this.viewPreviousToGoultines=null,this.categoryToOpenWhenReady=null,this.needsResize=!1,this.isOpened=!1;var e,t,i;this.once("open",function(){this._createDom(),this._setupEvents()}),this.on("opened",function(n){if(this.isOpened=!0,this._currentViewName)return void(n.category&&this._navigateToCategory(n.category));var o=window.gui.playerData;e=Date.now(),t=o.inventory.kamas,i=o.inventory.goultines,this.categoryToOpenWhenReady=n.category,this.isInitializing||this.reinitializeShop(),this.needsResize&&this.resize(),window.Config.disabledFeatures.shop||window.dofus.send("restoreMysteryBox")}),this.on("close",function(){this.isOpened=!1;var n=~~((Date.now()-e)/1e3),o=window.gui.playerData,s=o.inventory.kamas-t,a=o.inventory.goultines-i;M.log("HUD.Display_Menu",{interface_id:"UI_SHOP",time_spent_on_action:n,relative_soft_currency_gained:s,relative_hard_currency_gained:a}),this.clearShop()})}function s(){return window.gui.playerData.identification.subscriptionEndDate}i(1137);var a=i(172).inherits,r=i(29).getText,l=i(321),c=i(897),d=i(247).playUiSound,u=i(335),h=i(197),p=i(194),m=i(997),f=i(713),g=i(1138),_=i(1140),v=i(1142),y=i(1133),b=i(801),M=i(7),w=500,T="itemsList",C="homepage",A="itemDetails",I="homepage",S={id:I,name:"",child:[]},E=556,x=557,N={canTapImage:!1},L={lines:1,columns:2,promoType:"strip",showArticleDescription:!0,canTapImage:!1},O={556:N,557:L},D={557:!0};a(o,l),e.exports=o;var R=!0,P=!0;o.prototype.setSubCategoryRowVisible=function(e){var t=P!==e;P=e,this.subCategoryRow.toggleDisplay(e),this.subCategoryRowSeparator.toggleDisplay(e),t&&(this.viewContainer.toggleClassName("hasSubCategory",e),this.resize())},o.prototype._activateTopTab=function(e){var t=e.getWuiName(),i=this.activeTopTab;if(i){if(e===i)return;this._deactivateTopTab(i)}if(t===I)this.closeCategory(this.openedCategory),this.setSubCategoryRowVisible(!1),this.setView(C);else{if(this._isSameCategory(t))return;if(e.sublist){for(var n=this.subCategoryRow.getChildren(),o=0;o<n.length;o++)this.subCategoryRow.removeChild(n[o]);this.subCategoryRow.appendChild(e.sublist),this.setSubCategoryRowVisible(!0),R&&(e.sublist.deactivate(),this.selectedSubTab=null)}this._openCategory(t)}this.activeTopTab=e,this.selectedTopTab=t,e.addClassNames("on"),d("TAB")},o.prototype._activateSubCategory=function(e){var t=e.getWuiName();this._isSameCategory(t)||(this.selectedSubTab=t,this._openCategory(t),d("TAB"))};var B=!0;o.prototype._deactivateTopTab=function(e){var t=e.getWuiName();t!==I&&(e.sublist&&(this.setSubCategoryRowVisible(!1),e.sublist.deactivate()),this._isSameCategory(t)&&this.closeCategory(t)),e.delClassNames("on"),this.activeTopTab=null},o.prototype._deactivateSubCategory=function(e){var t=e.getWuiName();this._isSameCategory(t)&&(this.closeCategory(t),B&&(this.selectedSubTab=null,this._openCategory(this.selectedTopTab)))},o.prototype.deactivateAllCategories=function(){B=!1,this.activeTopTab&&this._deactivateTopTab(this.activeTopTab),B=!0},o.prototype.reactivateCategories=function(){var e=this.selectedTopTab;if(e){R=!1;var t=this.topTabsList.getChild(e);if(this._activateTopTab(t),!t.sublist||!this.selectedSubTab)return void(R=!0);t.sublist.selectItem(this.selectedSubTab),R=!0}},o.prototype._openGoultinesCategory=function(){this._isSameCategory(E)||(this.wallet.goultinesBtn.addClassNames("sunk"),this.viewPreviousToGoultines=this._currentViewName,this.deactivateAllCategories(),this.setSubCategoryRowVisible(!1),this._openCategory(E))},o.prototype._closeGoultinesCategory=function(){if(this._isSameCategory(E))return this.wallet.goultinesBtn.delClassNames("sunk"),this.closeCategory(E),this.viewPreviousToGoultines===T?this.reactivateCategories():void this.goToPreviousView()},o.prototype._toggleGoultinesCategory=function(){return this._isSameCategory(E)?this._closeGoultinesCategory():void this._openGoultinesCategory()},o.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"row1"});t.createChild("div",{className:["separator","first"]}),this.subCategoryRowSeparator=t.createChild("div",{className:["separator","second"]}),S.name=r("tablet.shop.homepage.name"),this.topTabsList=t.createChild("div",{className:"topTabsList"});var i=t.appendChild(new u({className:"closeButton",scaleOnPress:!0}));i.on("tap",function(){n()}),this.wallet=t.appendChild(new m({emitTap:!0})),this.wallet.on("moreGoultinesTap",function(){e._toggleGoultinesCategory()}),this.subCategoryRow=this.createChild("div",{className:"subCategoryRow"});var o=this.createChild("div",{className:"row2"});this.viewContainer=o,this.bonusDisplay=new l("div",{className:"bonusDisplay"});var s=r("tablet.shop.bonusTimeLeft")+r("ui.common.colon");this.bonusDisplay.createChild("div",{className:"title",text:s.toUpperCase()}),this.bonusDetails=this.bonusDisplay.createChild("div",{className:"details"}),this.setSubCategoryRowVisible(!1),this._views[C]=new g,
this._views[T]=new _,this._views[A]=new v},o.prototype.setView=function(e,t){if(this._currentViewName!==e){this.deactivateAllCategories(),this._previousViewName=this._currentViewName,this._currentViewName=e;for(var i=this.viewContainer,n=i.getChildren(),o=0;o<n.length;o++)i.removeChild(n[o]);var s=this._views[e];s&&(i.appendChild(s),s.update(t))}},o.prototype.goToPreviousView=function(){return this._previousViewName===C?this.reactivateCategories():this._previousViewName===T?(this.reactivateCategories(),void this._views[T].restoreScrollPosition()):void this.setView(this._previousViewName)},o.prototype._setupEvents=function(){function e(e){c._currentViewName===T&&r.saveScrollPosition();var t=c.articlesMap[e],i=c.openedCategory||I,n=c.categoriesName[i];c.setView(A,{article:t,categoryName:n})}function t(e){b.purchaseArticleOnStore(c.articlesMap[e])}function i(e,t){b.purchaseArticleOnAnkama(c.articlesMap[e],t)}function n(e){c.showSubCategoryRow(e)}function o(){c.showSubCategoryRow(!1)}var s=window.dofus.connectionManager,a=this._views,r=a[T],l=a[A],c=this;s.on("shopOpenError",function(e){c.onShopOpenError(e)}),s.on("shopOpenSuccess",function(e){c.onShopOpenSuccess(e)}),s.on("shopOpenCategoryError",function(e){c.onShopOpenCategoryError(e)}),s.on("shopOpenCategorySuccess",function(e){c.onShopOpenCategorySuccess(e)}),s.on("AccessoryPreviewErrorMessage",function(e){console.error(new Error("Accessory preview failed with: "+e.error)),l.setLook(null)}),s.on("AccessoryPreviewMessage",function(e){l.setLook(e.look)}),window.gui.on("resize",function(){c.resize()});for(var d in a){var u=a[d];u.on("displayItemDetails",e),u.on("purchaseIAP",t),u.on("purchaseOnAnkama",i),u.on("showSubCategoryRow",n),u.on("hideSubCategoryRow",o)}r.on("loadAdditionalContent",function(){c._saveAndExecuteAction(function(){c.loadAdditionalContent()})}),r.on("nbArticlesVisibleUpdated",function(e){c.nbArticlesVisible=e}),l.on("goToPreviousView",function(){c.goToPreviousView()}),l.on("requestPrevisualization",function(e){s.sendMessage("AccessoryPreviewRequestMessage",{genericId:e})}),f.on("canNotComputeSoftPrices",function(){c.isOpen()&&c.updateArticlesPrices()}),f.on("computedSoftPricesChange",function(){c.isOpen()&&c.updateArticlesPrices()})},o.prototype.isOpen=function(){return p.getWindow("market").openState},o.prototype.showSubCategoryRow=function(e){for(var t=this.subCategoryRow.getChildren(),i=0;i<t.length;i++)this.subCategoryRow.removeChild(t[i]);var n=!!e;this.setSubCategoryRowVisible(n),n&&this.subCategoryRow.appendChild(e)},o.prototype._navigateToCategory=function(e){"goultines"===e?this._openGoultinesCategory():"bonuspack"===e&&this._openCategory(x)},o.prototype.onShopOpenError=function(){this.isInitializing=!1,this.viewContainer.delClassNames("spinner"),this.isOpen()&&this._showErrorPopup(!0)},o.prototype.onShopOpenSuccess=function(e){if(this.isInitializing=!1,this.viewContainer.delClassNames("spinner"),this.isOpen()){this.wallet.goultinesBtn.enable();var t=e.home;this.setCategories(t.categories);var i=this.topTabsList.getChildren();i.length&&this._activateTopTab(i[0]);var n;if(t._highlightImageArticle){var o=this.validateArticles([t._highlightImageArticle]);o.length&&(n=o[0])}var s;t.gondolahead_article&&(s=this.validateArticles(t.gondolahead_article));var a;if(t._highlightCarouselArticle){var r=this.validateArticles([t._highlightCarouselArticle]);r.length&&(a=r[0])}var l={gondolaHeadArticles:s,highlightCarousel:t._selectedHighlightCarousel,highlightCarouselArticle:a,highlightImageArticle:n};this._views[C].update(l),this.categoryToOpenWhenReady&&this._navigateToCategory(this.categoryToOpenWhenReady),window.wizPurchase&&b.checkPendingPurchases()}},o.prototype.onShopOpenCategoryError=function(e){if(this._isSameCategory(e.categoryId)){var t=this._views[T];t.setSpinnerVisible(!1),t.setLoadingAdditionalContent(!1),this._showErrorPopup()}},o.prototype.onShopOpenCategorySuccess=function(e){this._loadCategoryWithMessage(e)},o.prototype.resize=function(){if(!this.isOpened)return void(this.needsResize=!0);var e=this._views;for(var t in e)e[t].resize(this.viewContainer);this.needsResize=!1},o.prototype._showErrorPopup=function(e){var t=this;p.getWindow("confirm").update({title:r("ui.common.error"),message:r("ui.popup.accessDenied.serviceUnavailable")+" "+r("tablet.common.askRetry"),cb:function(i){return i?t.lastAction?void t.lastAction():void t.reinitializeShop():void(e&&n())}}),p.openDialog(["confirm"])},o.prototype._isSameCategory=function(e){return e===this.openedCategory},o.prototype._saveAndExecuteAction=function(e){this.lastAction=e,e()},o.prototype.updateArticlesPrices=function(){var e=this.articlesMap;for(var t in e)b.enrichWithSoftPrice(e[t]);var i=this._views;for(var n in i)i[n].updateArticlesPrices(this.articlesMap)},o.prototype.reinitializeShop=function(){function e(e){console.error(e),t.isInitializing=!1,t.viewContainer.delClassNames("spinner"),t.isOpen()&&t._showErrorPopup(!0)}var t=this;this._saveAndExecuteAction(function(){t.isInitializing=!0,t.viewContainer.addClassNames("spinner"),b.getStoreInfos(function(t){return t?e(t):void window.dofus.send("shopOpenRequest")})})},o.prototype.clearShop=function(){var e=this.activeTopTab;e&&this._deactivateTopTab(e),this.closeCategory(this.openedCategory),this.clearCategories(),this.requestTimestamp=0,this.requestTimeout=null,this.lastAction=null,this.isInitializing=!1,this.wallet.goultinesBtn.disable(),this.setView(C),this._currentViewName=null,this._previousViewName=null;var t=this._views;for(var i in t)t[i].clear();this.viewPreviousToGoultines=null},o.prototype.setCategories=function(e){this.clearCategories(),this._addTopCategories(e)},o.prototype._createCategoryLabel=function(e){var t=new l("div",{className:"textContainer"});return t.createChild("div",{className:"text",text:e.name.toUpperCase()}),t},o.prototype._addTopCategories=function(e){function t(e){s._activateSubCategory(e)}function i(e){s._deactivateSubCategory(e)}function n(){s._activateTopTab(this)}function o(e){if(s.categoriesName[e.id]=e.name,e.id!==E){var o=s._createCategoryLabel(e),a=s.topTabsList.createChild("div",{name:e.id,className:"tab"});if(a.appendChild(o),h(a),a.on("tap",n.bind(a)),e.child.length){var r=a.sublist=new c;r.on("activate",t),r.on("deactivate",i),s._addSubCategories(r,e.child)}}}var s=this;o(S);for(var a=0;a<e.length;a++)o(e[a])},o.prototype._addSubCategories=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];this.categoriesName[n.id]=n.name;var o=this._createCategoryLabel(n),s=e.addItem(n.id,o);s.addClassNames("tab")}},o.prototype.clearCategories=function(){this.topTabsList.clearContent(),this.activeTopTab=null,this.selectedTopTab=null,this.selectedSubTab=null,this.openedCategory=null,this.categoriesName={},this.categoriesData={},this.articlesMap={}},o.prototype._loadCategoryWithMessage=function(e){var t=e.categoryId,i=this.categoriesData[t];if(i){if(i.page!==e.page-1)return;i.page=e.page,i.articles=i.articles.concat(e.articles)}else this.categoriesData[t]=e;this._isSameCategory(t)&&this._loadCategory(e)},o.prototype.validateArticles=function(e){for(var t=b.validateArticles(e),i=0;i<t.length;i++){var n=t[i];this.articlesMap[n.id]=n}return t},o.prototype._loadCategory=function(e){var t=this._views[T];if(0===e.totalArticles)return void t.showNoResult(this.categoriesName[this.openedCategory],~~e.categoryId);var i=this.validateArticles(e.articles),n=Math.ceil(e.totalArticles/this.nbArticlesVisible),o=e.page===n;t.addArticles(i,o)},o.prototype.showBonusDetails=function(){var e=this,t=s();t?(this.bonusCountdown&&this.bonusCountdown.clear(),this.bonusCountdown=new y(new Date(t),function(t,i,n){return t?console.error(t):void e.bonusDetails.setText(n.toUpperCase())},function(){e.bonusDetails.setText(r("tablet.shop.noActiveBonus").toUpperCase())})):this.bonusDetails.setText(r("tablet.shop.noActiveBonus").toUpperCase()),this.showSubCategoryRow(this.bonusDisplay)},o.prototype._openCategory=function(e){this._currentViewName!==T&&this.setView(T);var t=this,i=this._views[T],n=O[e];if(i.setConstraints(n)&&i.resize(this.viewContainer),i.setClassNames(["itemsListView","_"+e]),!this._isSameCategory(e)){(this.openedCategory||0===this.openedCategory)&&this.closeCategory(this.openedCategory),D[e]&&this.showBonusDetails(),e===E&&this.wallet.goultinesBtn.addClassNames("sunk"),this.openedCategory=e;var o=this.categoriesData[this.openedCategory];o?this._loadCategory(o):this._saveAndExecuteAction(function(){i.setSpinnerVisible(!0),t._requestPageOfCategory(e,1)})}},o.prototype.loadAdditionalContent=function(){if(this.openedCategory){this._views[T].setLoadingAdditionalContent(!0);var e=this.categoriesData[this.openedCategory];return e?void this._requestPageOfCategory(this.openedCategory,e.page+1):console.error(new Error("Trying to load additional content of a non-opened category."))}},o.prototype._requestPageOfCategory=function(e,t){var i={categoryId:e,page:t,size:this.nbArticlesVisible},n=function(){window.dofus.send("shopOpenCategoryRequest",i)};window.clearTimeout(this.requestTimeout);var o=Date.now(),s=o-this.requestTimestamp;s>w?n():this.requestTimeout=window.setTimeout(n,w-s),this.requestTimestamp=o},o.prototype.closeCategory=function(e){this.openedCategory&&this._isSameCategory(e)&&(D[e]&&this.bonusCountdown&&(this.bonusCountdown.clear(),this.bonusCountdown=null),e===E&&this.wallet.goultinesBtn.delClassNames("sunk"),this._views[T].clearItems(),this.openedCategory=null)}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"homepageView"}),this.highlightArticleBox=null,this.highlightCarouselArticle=null,this._createDom()}function o(e,t){return{boxWidth:e,boxHeight:t}}i(1139);var s=i(172).inherits,a=i(321),r=i(1129),l=i(43),c=i(197),d=6,u=5,h=8,p=155,m=200,f=1,g=p/m;s(n,a),e.exports=n,n.prototype.clear=function(){this.highlightArticleBox&&(this.highlightArticleBox.clear(),this.highlightArticleBox=null);for(var e=this.gondolaHead.getChildren(),t=0;t<e.length;t++)e[t].clear();this.highlightCarouselArticle=null,this.highlightCarouselImage.hide(),this.highlightImage.clearContent(),this.gondolaHead.clearContent()},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"highlights"});this.gondolaHead=this.createChild("div",{className:"gondolaHead"});var i=t.createChild("div",{className:"highlightCarousel"});this.highlightCarouselImage=i.createChild("div",{className:"highlightCarouselImage"}),this.highlightCarouselImage.hide(),c(i),i.on("tap",function(){e.highlightCarouselArticle&&e.emit("displayItemDetails",e.highlightCarouselArticle.id)}),this.highlightImage=t.createChild("div",{className:"highlightImage"})},n.prototype.resize=function(){},n.prototype.update=function(e){function t(){y.emit("purchaseIAP",this.articleId)}function i(){y.emit("purchaseOnAnkama",this.articleId,l.GOULTINE)}function n(){y.emit("purchaseOnAnkama",this.articleId,l.KAMA)}function s(){y.emit("displayItemDetails",this.articleId)}function a(e,o,a){a=a||{},a.canTapImage=!0,a.showButtons=void 0===a.showButtons||a.showButtons,a.showTitle=void 0===a.showTitle||a.showTitle;var l=new r(e,o,a);return l.on("tapIAPButton",t),l.on("tapHardButton",i),l.on("tapSoftButton",n),l.on("tapItemImage",s),l}if(this.emit("hideSubCategoryRow"),e){this.clear();var c=e.highlightCarousel,p=!1;if(c){var m=c.image;m.length>d&&(p=!0,this.highlightCarouselArticle=e.highlightCarouselArticle,this.highlightCarouselImage.setStyle("backgroundImage","url("+m[d].url+")"))}this.highlightCarouselImage.toggleDisplay(p);var _,v,y=this,b=e.highlightImageArticle;if(b){this.highlightImage.show();var M=this.highlightImage.rootElement.getBoundingClientRect();v=o(M.width,M.height),this.highlightArticleBox=a(b,v,{promoType:"banner"}),this.highlightImage.appendChild(this.highlightArticleBox)}else this.highlightImage.hide();var w=e.gondolaHeadArticles;if(w){var T=this.gondolaHead.rootElement.getBoundingClientRect(),C=~~T.width+2*u,A=~~T.height-h,I=~~(A*g)+2*u,S=Math.min(w.length,~~(C/I)),E=C-I*S,x=~~(E/S),N=I+x;I=N/A>f?A*f-2*u:N-2*u,v=o(I,A);for(var L=0;L<S;L++)_=a(w[L],v,{promoType:"corner"}),this.gondolaHead.appendChild(_)}}},n.prototype.updateArticlesPrices=function(e){var t=this.gondolaHead.getChildren();this.highlightArticleBox&&t.push(this.highlightArticleBox);for(var i=0;i<t.length;i++){var n=t[i],o=n.articleId;if(o){var s=e[o];s?n.updatePrice(s):console.error(new Error("Article "+o+" missing for an ArticleBox"))}}}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"itemsListView"}),this.articlesPerLine=d,this.articlesPerColumn=u,this._isAdditionalContentLoading=!1,this._boxHeight=_,this._boxWidth=g,this._scrollMargin=0,this._scrollPosition=null,this.constraints={},this.setConstraints(M),this._createDom()}i(1141);var o=i(172).inherits,s=i(29).getText,a=i(321),r=i(436),l=i(1129),c=i(43),d=2,u=1,h=9,p=0,m=11,f=9,g=155,_=200,v=_+m,y=40,b=548,M={lines:null,columns:null,promoType:"corner",showArticleDescription:!1,canTapImage:!0};o(n,a),e.exports=n,n.prototype.clear=function(){for(var e=this._getArticleBoxes(),t=0;t<e.length;t++)e[t].clear();this._scrollPosition=null},n.prototype._createDom=function(){var e=this;this._itemsScroll=this.appendChild(new r({className:"scroll"},{isHorizontal:!0})),this._itemsList=this._itemsScroll.content.createChild("div",{className:"itemsList"});for(var t=0;t<this.articlesPerColumn;t++)this._itemsList.createChild("div",{className:"itemsLine"});this._loadContent=this._itemsScroll.content.createChild("div",{className:"loadContent"}),this._loadContent.hide(),this._noResultMessage=this._itemsScroll.content.createChild("div",{className:"rightLabel"}),this._noResultMessageText=this._noResultMessage.createChild("div",{className:"text"}),this._noResultMessage.hide(),this._itemsScroll.on("scrollEnd",function(){!e._isAdditionalContentLoading&&e._loadContent.isVisible()&&Math.abs(this.iScroll.maxScrollX-this.iScroll.x)<y&&e.emit("loadAdditionalContent")})},n.prototype.update=function(){},n.prototype.resize=function(e){this._computeMargins(e);var t=this._getItemsMap(),i=this.getArticleBoxSize();for(var n in t)t[n].resize(i);this._itemsScroll.refresh(),this.emit("nbArticlesVisibleUpdated",(this.articlesPerLine+1)*this.articlesPerColumn)},n.prototype.saveScrollPosition=function(){this._scrollPosition=this._itemsScroll.getScrollPosition()},n.prototype.restoreScrollPosition=function(){var e=this._scrollPosition;e&&this._itemsScroll.scrollTo(e.x,e.y),this._scrollPosition=null},n.prototype.getArticleBoxSize=function(){return{boxWidth:this._boxWidth,boxHeight:this._boxHeight}},n.prototype.setConstraints=function(e){e=e||M;var t=!1;for(var i in M){var n=e.hasOwnProperty(i)?e[i]:M[i];this.constraints[i]!==e[i]&&(this.constraints[i]=n,t=!0)}return t},n.prototype.addArticles=function(e,t){this.setSpinnerVisible(!1),this.setLoadingAdditionalContent(!1),this._loadContent.toggleDisplay(!t),this._addArticles(e)},n.prototype.showNoResult=function(e,t){this.clearItems();var i;i=t===b?s("tablet.shop.category.emote.noResults"):e?s("ui.search.noResultFor",e):s("ui.search.noResult"),this._noResultMessageText.setText(i),this._noResultMessage.show()},n.prototype._addArticles=function(e){function t(){u.emit("purchaseIAP",this.articleId)}function i(){u.emit("purchaseOnAnkama",this.articleId,c.GOULTINE)}function n(){u.emit("purchaseOnAnkama",this.articleId,c.KAMA)}function o(){u.emit("displayItemDetails",this.articleId)}for(var s=0,a=this._itemsList.getChildren(),r=a.length,d=this.getArticleBoxSize(),u=this,h={showButtons:!0,showTitle:!0,promoType:this.constraints.promoType,showDescription:this.constraints.showArticleDescription,canTapImage:this.constraints.canTapImage},p=0;p<e.length;p++){var m=new l(e[p],d,h);m.on("tapIAPButton",t),m.on("tapHardButton",i),m.on("tapSoftButton",n),m.on("tapItemImage",o),a[s%r].appendChild(m),s++}this._itemsScroll.refresh()},n.prototype.setLoadingAdditionalContent=function(e){this._isAdditionalContentLoading=e,e?(this._loadContent.addClassNames("spinner"),this._loadContent.delClassNames("showArrow")):(this._loadContent.delClassNames("spinner"),this._loadContent.addClassNames("showArrow"))},n.prototype.setSpinnerVisible=function(e){e?this._itemsScroll.addClassNames("spinner"):this._itemsScroll.delClassNames("spinner")},n.prototype.clearItems=function(){this.setSpinnerVisible(!1),this.setLoadingAdditionalContent(!1);for(var e=this._itemsList.getChildren(),t=0;t<e.length;t++)e[t].clearContent();this._loadContent.hide(),this._noResultMessage.hide(),this._itemsScroll.refresh(),this._itemsScroll.goToTop()},n.prototype._setNumberOfLines=function(e){if(e!==this.articlesPerColumn){this.articlesPerColumn=e;var t,i=[],n=this._itemsList.getChildren(),o=n.length-e;for(t=0;t<n.length;t++){for(var s=n[t],a=s.getChildren(),r=0;r<a.length;r++)i.push(s.removeChild(a[r]));o>0&&(s.destroy(),o--)}if(n.length<e){var l=e-n.length;for(t=0;t<l;t++)this._itemsList.createChild("div",{className:"itemsLine"})}if(i.length)for(n=this._itemsList.getChildren(),t=0;t<i.length;t++)n[t%e].appendChild(i[t])}},n.prototype._computeMargins=function(e){var t=this.constraints,i=e.rootElement.getBoundingClientRect(),n=i.width-2*p,o=i.height-(2*p+h),s=t.lines||Math.max(u,~~(o/v)),a=o-v*s,r=~~(a/s);if(this._boxHeight=_+r,t.columns){var l=n-(g+2*f)*t.columns,c=~~(l/t.columns);this._boxWidth=g+c}else this._boxWidth=g+r;var y=this._boxHeight+m,b=this._boxWidth+2*f;this.articlesPerLine=t.columns||Math.max(d,~~(n/b)),a=o-y*s,a>1&&(this._scrollMargin=~~(.5*a),this._itemsScroll.setStyles({"margin-top":this._scrollMargin+"px","margin-bottom":this._scrollMargin+"px"})),this._setNumberOfLines(s),this._itemsScroll.refresh()},n.prototype._getArticleBoxes=function(){for(var e=[],t=this._itemsList.getChildren(),i=0;i<t.length;i++)e=e.concat(t[i].getChildren());return e},n.prototype.updateArticlesPrices=function(e){for(var t=this._getArticleBoxes(),i=0;i<t.length;i++){var n=t[i],o=n.articleId;if(o){var s=e[o];s?n.updatePrice(s):console.error(new Error("Article "+o+" missing for an ArticleBox"))}}},n.prototype._getItemsMap=function(){for(var e={},t=this._itemsList.getChildren(),i=0;i<t.length;i++)for(var n=t[i].getChildren(),o=0;o<n.length;o++){var s=n[o];e[s.getWuiName()]=s}return e}},function(e,t){},function(e,t,i){function n(){r.call(this,"div",{className:"itemDetailsView"}),this._resetProperties(),this._createDom()}function o(){return window.gui.playerData.characterBaseInformations.entityLook}i(1143);var s=i(172).inherits,a=i(29).getText,r=i(321),l=i(335),c=i(369),d=i(461),u=i(1129),h=i(1131),p=i(410),m=i(182),f=i(436),g=i(737),_=i(194),v=i(43),y=i(1144),b=i(538),M=i(353),w={};w[M.ACTION_LADDER_ID]=!0,w[M.ACTION_ITEM_CHANGE_PETS_LIFE]=!0,w[M.ACTION_ITEM_PETS_SHAPE]=!0,w[M.ACTION_ITEM_PETS_EAT]=!0,w[M.ACTION_PETS_LAST_MEAL]=!0,w[M.ACTION_ID_LIVING_OBJECT_MOOD]=!0,w[M.ACTION_ID_LIVING_OBJECT_SKIN]=!0,w[M.ACTION_ID_LIVING_OBJECT_CATEGORY]=!0,w[M.ACTION_ID_LIVING_OBJECT_LEVEL]=!0,w[983]=!0,w[984]=!0,w[620]=!0;var T=641,C=429,A=C/T,I=.85,S=2/236;s(n,r),e.exports=n,n.prototype._resetProperties=function(){this._classSymbolImage=null,this._firstItemOfSet=null,this._articleId=null},n.prototype.clear=function(){this._resetProperties(),this._articleBox.clear(),this._characterDisplay.release()},n.prototype._createDom=function(){function e(){n.emit("purchaseIAP",n._articleId)}function t(){n.emit("purchaseOnAnkama",n._articleId,v.GOULTINE)}function i(){n.emit("purchaseOnAnkama",n._articleId,v.KAMA)}var n=this,o=this._backToCategory=new r("div",{className:"goToPrevious"}),s=new l({className:"arrow"},function(){n.emit("goToPreviousView")});o.appendChild(s),this._backToCategoryText=o.createChild("div",{className:"text"}),this.promoBanner=this.createChild("div",{className:"promoBanner"});var d=this.leftColumn=this.appendChild(new f({className:"left"}));this.promoDescription=d.content.createChild("div",{className:"promoDescription"});var p=d.content.createChild("div",{className:"topRow"}),m=p.createChild("div",{className:"illuContainer"});m.createChild("div",{className:"dummy"});var g=m.createChild("div",{className:"illuElement"});this._articleBox=g.appendChild(new u);var b=p.createChild("div",{className:"nameAndDescription"});this._name=b.createChild("div",{className:"section"}),this._description=b.createChild("div",{className:"subSection"}),this._weight=this._articleBox.createChild("div",{className:"weight"}),this._linkToItemSet=p.appendChild(new l({className:"setButton",scaleOnPress:!0},function(){n._firstItemOfSet&&_.open("itemSets",n._firstItemOfSet)}));var M=this._itemsListRow=d.content.createChild("div",{className:"itemsListRow"});M.createChild("div",{className:"section",text:a("tablet.shop.comesWith").toUpperCase()}),this._itemsList=M.createChild("div",{className:"subSection"});var w=d.content.createChild("div",{className:"leftItemDetails"});this._effectsBox=w.appendChild(new y(a("ui.common.effects",2).toUpperCase()));var T=d.content.createChild("div",{className:"rightItemDetails"});this._conditionsBox=T.appendChild(new y(a("ui.common.conditions").toUpperCase())),this._characBox=T.appendChild(new y(a("ui.common.caracteristics").toUpperCase()));var C=this.createChild("div",{className:"right"}),A=C.createChild("div",{className:"charaContainer"});A.createChild("div",{className:"dummy"});var I=A.createChild("div",{className:"charaElement"}),S=I.createChild("div",{className:"characterOnIsland"});this._characterOnIsland=S;var E=S.createChild("div",{className:"islandImage"});this._islandImage=E,this._characterDisplay=S.appendChild(new c);var x=this._articleButtons=C.appendChild(new h);x.on("tapIAPButton",e),x.on("tapHardButton",t),x.on("tapSoftButton",i)},n.prototype.resize=function(){var e=this._characterDisplay.rootElement.getBoundingClientRect(),t=A*e.height,i=I*e.height;this._characterDisplay.setStyle("top",t-i+"px");var n=S*e.width;this._characterDisplay.setScale(n),this.leftColumn.refresh()},n.prototype._displayConditions=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=i.text,o=i.isMalus?["malus"]:[];if("string"==typeof n)this._conditionsBox.addRow(n,o);else for(var s=0;s<n.length;s++)this._conditionsBox.addRow(n[s],o)}},n.prototype._displayOneItem=function(e){this._itemsListRow.hide(),this._linkToItemSet.hide();var t=a("ui.common.short.weight",e.getProperty("realWeight"));this._weight.setText(a("ui.common.weight")+a("ui.common.colon")+t);var i;if(this._effectsBox.clearContent(),this._effectsBox.show(),e.hideEffects)this._effectsBox.addRow(a("ui.set.secretBonus"));else{var n=b.getSortedEffectInstances(e);if(n&&n.length)for(i=0;i<n.length;i++){var o=n[i];if(!w[o.effectId])if(""!==o.description){var s=o.effect.bonusType,r=[];s===-1?r.push("malus"):1===s&&r.push("bonus"),this._effectsBox.addRow(o.description,r)}else console.error("Effect "+o.effectId+" not supported for item "+e.getProperty("id"))}this._effectsBox.hasRow()||this._effectsBox.addRow(a("tablet.common.none",0),["placeholder"])}this._conditionsBox.clearContent(),this._conditionsBox.show();var l=e.getProperty("conditionsFormatted"),c=e.getProperty("targetConditionsFormatted");if(0===l.length&&0===c.length?this._conditionsBox.addRow(a("tablet.common.none",1),["placeholder"]):(this._displayConditions(l),this._displayConditions(c)),this._characBox.clearContent(),e.getProperty("isWeapon")){this._characBox.show();var d=e.getProperty("statsFormatted");if(0===d.length)this._characBox.addRow(a("tablet.common.none",1),["placeholder"]);else for(i=0;i<d.length;i++)this._characBox.addRow(d[i])}else this._characBox.hide();this.leftColumn.refresh()},n.prototype._displayMultipleItems=function(e){function t(){_.open("itemBox",{itemData:this.data})}this._itemsListRow.show(),this._effectsBox.hide(),this._conditionsBox.hide(),this._characBox.hide();var i,n=0;this._itemsList.clearContent();for(var o=0;o<e.length;o++){i=e[o],n+=i.getProperty("realWeight");var s=new g({itemData:i});s.on("tap",t),this._itemsList.appendChild(s)}var r=a("ui.common.short.weight",n);this._weight.setText(a("ui.common.weight")+a("ui.common.colon")+r),i=e[0];var l=i.itemSetId;l&&l!==-1?(this._firstItemOfSet=i,this._linkToItemSet.show()):(this._firstItemOfSet=null,this._linkToItemSet.hide()),this.leftColumn.refresh()},n.prototype.update=function(e){if(this.emit("showSubCategoryRow",this._backToCategory),e){this._itemsListRow.hide(),this._effectsBox.hide(),this._conditionsBox.hide(),this._characBox.hide(),this._backToCategoryText.setText(a("tablet.shop.backTo",e.categoryName));var t=e.article;this._articleId=t.id,this._name.setText(t.name.toUpperCase()),this._description.setHtml(t.description),this._articleBox.update(t),this._articleButtons.update(t),this._setClassSymbol(),this._characterDisplay.hide(),this._islandImage.addClassNames("spinner");var i=t.promo&&t.promo.length,n=t._promoRate;if(i||n||t.enddate){this.leftColumn.addClassNames("promo"),this.promoBanner.show(),this.promoDescription.toggleDisplay(!!i);var s,r;if(i||n||!t.enddate?n||t.enddate?(s=a("tablet.shop.offer")+a("ui.common.colon"),n&&(s+=n),t.enddate&&(n&&(s+=" "),r=new Date(t.enddate),s+=a("tablet.common.until",r.toLocaleDateString()))):s=a("tablet.shop.offer"):(r=new Date(t.enddate),s=a("tablet.common.available",a("tablet.common.until",r.toLocaleDateString()))),this.promoBanner.setText(s),i){for(var l=t.promo,c="",u=a("ui.common.colon"),h=0;h<i-1;h++)c+=l[h].name+u+l[h].description+"<br /><br />";c+=l[i-1].name+u+l[i-1].description,this.promoDescription.setHtml(c)}}else this.leftColumn.delClassNames("promo"),this.promoBanner.hide(),this.promoDescription.hide();var p=this,m=t.itemsId;d.getItems(m,function(e,t){if(e)return console.error(e);var i=t.length;if(m.length!==i)return console.error(new Error("Some items are missing, ids requested: "+m+", items get: "+t));i&&(1===i?p._displayOneItem(t[0]):p._displayMultipleItems(t));for(var n=[],s=0;s<i;s++){var a=t[s];a.isEquippable()&&n.push(a.getProperty("id"))}n.length?p.emit("requestPrevisualization",n):p.setLook(o())})}},n.prototype.setLook=function(e){e=e||o();var t=this;this._characterDisplay.setLook(e,{riderOnly:!0,boneType:"characters/",skinType:"characters/",direction:p.DIRECTION_SOUTH_WEST,keepDirection:!1,keepModels:!0},function(){t._islandImage.delClassNames("spinner"),t._characterDisplay.show()})},n.prototype.updateArticlesPrices=function(e){var t,i=this._articleBox,n=this._articleButtons,o=i.articleId;o&&(t=e[o],t?i.updatePrice(t):console.error(new Error("Article "+o+" missing for an ArticleBox"))),o=n.articleId,o&&(t=e[o],t?n.update(t):console.error(new Error("Article "+o+" missing for an ArticleButtons")))},n.prototype._setClassSymbol=function(){if(!this._classSymbolImage){var e=this,t=window.gui.playerData.characterBaseInformations;m.preloadImage("gfx/illusUi/symboles_classe/FichePerso_tx_symboleClasse_frame"+(t.breed-1)+".png",function(t){e._classSymbolImage=t,e._characterOnIsland.setStyle("backgroundImage",t)})}}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"itemDetailsBox"}),this._createDom(e)}i(1143);var o=i(172).inherits,s=i(321);o(n,s),e.exports=n,n.prototype._createDom=function(e){var t=this.createChild("div",{className:"header"});t.createChild("div",{className:"title",text:e}),t.createChild("div",{className:"titleCorner"}),this._content=this.createChild("div",{className:"content"})},n.prototype.clearContent=function(){this._content.clearContent()},n.prototype.addRow=function(e,t){t=t||[],t.push("row"),this._content.createChild("div",{className:t,text:e})},n.prototype.hasRow=function(){return this._content.getChildCount()>0}},function(e,t,i){function n(){r.call(this,{title:s("tablet.shop.needMoreHardCurrency").toUpperCase(),className:"BuyHardCurrencyConfirmWindow",positionInfo:{left:"c",top:"c",width:540,height:440,isModal:!0}}),this._reset(),this.on("open",this._onOpen);var e=this,t=window.dofus.connectionManager;t.on("shopIAPArticlesSuccess",function(t){e.content&&e.displayHardCurrencyPack(t)}),t.on("shopIAPArticlesError",function(){e.content&&e.displayError(u.NO_PACK,new Error("IAP articles are not available"))})}i(1146);var o=i(335),s=i(29).getText,a=i(172).inherits,r=i(541),l=i(194),c=i(801),d=i(1129),u={NO_PACK:0,AMOUNT_TOO_HIGH:1};a(n,r),e.exports=n,n.prototype._reset=function(){this.content=null,this.buyPackText=null,this.articleBoxContainer=null,this.articleBox=null,this.hardCurrencyAmountMissing=0},n.prototype._onOpen=function(){this.content||this._createContent()},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._createContent=function(){this.content=this.windowBody.createChild("div",{className:"content"});var e=this.content.createChild("div",{className:"buyPackTextContainer"});this.buyPackText=e.createChild("div",{className:"buyPackText"}),this.articleBoxContainer=this.content.createChild("div",{className:"articleBoxContainer"}),this.articleBox=this.articleBoxContainer.appendChild(new d(null,{boxWidth:190,boxHeight:220},{showTitle:!0,showButtons:!0,promoType:"corner"})),this.content.appendChild(new o({text:s("tablet.shop.seeAllHardCurrencyPacks"),className:["greenButton","seePacksBtn"]},function(){l.close("buyHardCurrencyConfirm"),l.open("market",{tabId:"shop",tabParams:{category:"goultines"}})}))},n.prototype.confirmBuy=function(e){l.open(this.id),this.content.hide(),this.windowBody.addClassNames("spinner"),this.hardCurrencyAmountMissing=e;var t=this;c.getStoreInfos(function(e){return e?t.displayError(u.NO_PACK,e):void window.dofus.send("shopIAPArticlesRequest")})},n.prototype.displayError=function(e,t){t&&console.error(t),this.content&&(this.content.show(),this.articleBoxContainer.hide(),this.windowBody.delClassNames("spinner"),e===u.AMOUNT_TOO_HIGH?this.buyPackText.setText(s("tablet.shop.noHardCurrencyPackForAmount")):this.buyPackText.setText(s("tablet.shop.noHardCurrencyPack")))},n.prototype.displayHardCurrencyPack=function(e){var t=c.validateArticles(e.articles),i=null,n=Number.MAX_VALUE;if(!t.length)return this.displayError(u.NO_PACK,new Error("No valid IAP "+t.length+" out of "+e.articles.length+" articles"));for(var o=0;o<t.length;o++){var a=t[o],r=1===a.references.length&&a.references[0];if(r&&"GOULTINE"===r.type){var d=parseInt(r.quantity,10);isNaN(d)||d<this.hardCurrencyAmountMissing||d<n&&(n=d,i=a)}}return i?(this.content.show(),this.articleBoxContainer.show(),this.windowBody.delClassNames("spinner"),this.buyPackText.setText(s("tablet.shop.buyHardCurrencyPack",n)),this.articleBox.update(i),void this.articleBox.on("tapIAPButton",function(){l.close("buyHardCurrencyConfirm"),c.purchaseArticleOnStore(i)})):this.displayError(u.AMOUNT_TOO_HIGH)}},function(e,t){},function(e,t,i){function n(){r.call(this,{title:s("tablet.purchasesPending.title"),className:"PurchasesPendingWindow",noCloseButton:!0,positionInfo:{left:"c",top:"c",width:450,height:243,isModal:!0}}),this._reset(),this.on("open",this._onOpen);var e=this,t=window.dofus.connectionManager;t.on("shopIAPArticlesSuccess",function(t){if(e._content){var i=t.articles;c.validateArticles(i),e._displayPurchasesList(null,i)}}),t.on("shopIAPArticlesError",function(){e._content&&e._displayPurchasesList(new Error("IAP articles are not available"))})}i(1148);var o=i(335),s=i(29).getText,a=i(172).inherits,r=i(541),l=i(194),c=i(801),d={PENDING:0,FAILED:1,SUCCEEDED:2};a(n,r),e.exports=n,n.prototype._reset=function(){this.windowBody.clearContent(),this._content=null,this._description=null,this._spinner=null,this._pendingPurchases=[],this._purchasesDetails={},this._isProcessing=!1},n.prototype._onOpen=function(){this._content||this._createContent()},n.prototype.freeContent=function(){this._reset()},n.prototype._createContent=function(){this._content=this.windowBody.createChild("div",{className:"content"});var e=this._content.createChild("div",{className:"textBox"});this._description=e.createChild("div",{className:"description"}),this._purchasesList=e.createChild("div",{className:"purchasesList"}),this._spinner=e.createChild("div",{className:["spinnerContainer","spinner"]}),this._validationDone=e.createChild("div",{className:"validationDone",hidden:!0}),this._okButton=this._content.appendChild(new o({
text:s("ui.common.ok"),className:["greenButton","okButton"]},function(){l.close("purchasesPending")})),this._okButton.disable()},n.prototype._processNext=function(){var e=this._pendingPurchases.shift();c.validatePendingIAP(e)},n.prototype._displayPurchasesListNotAvailable=function(){this._spinner.hide(),this._purchasesList.setText(s("tablet.purchasesPending.listNotAvailable"))},n.prototype._displayPurchasesList=function(e,t){if(e&&console.error(e),this._content)if(e)this._displayPurchasesListNotAvailable();else{for(var i=0;i<t.length;i++){var n=t[i],o=this._purchasesDetails[n.key];if(o){var s=this._purchasesList.getChild(n.key);s||(s=this._purchasesList.createChild("div",{className:"entry",name:n.key,text:n.name}),s.createChild("div",{className:"state"}),s.createChild("div",{className:"name",text:n.name})),o.article=n;var a=o.state;switch(a){case d.PENDING:s.delClassNames(["failure","success"]);break;case d.FAILED:s.replaceClassNames(["success"],["failure"]);break;case d.SUCCEEDED:s.replaceClassNames(["failure"],["success"])}}}Object.keys(this._purchasesDetails).length<=this._purchasesList.getChildCount()?this._spinner.hide():this._spinner.show()}},n.prototype.validatePendingPurchases=function(e){if(!e||!e.length)return console.error(new Error("No purchase to validate: "+e));var t=e.filter(function(e){return!this._purchasesDetails[e.productId]},this);if(t.forEach(function(e){this._purchasesDetails[e.productId]={state:d.PENDING,article:null}},this),this._pendingPurchases=this._pendingPurchases.concat(t),t.length){l.open(this.id),this._description.setText(s("tablet.purchasesPending.description",Object.keys(this._purchasesDetails).length)+s("ui.common.colon")),this._spinner.show();var i=this;c.getStoreInfos(function(e){return e?i._displayPurchasesList(e):(window.dofus.send("shopIAPArticlesRequest"),void i._startProcessing())})}},n.prototype._startProcessing=function(){this._isProcessing||(this._isProcessing=!0,this._validationDone.hide(),this._okButton.disable(),this._processNext())},n.prototype._endProcessing=function(){var e=0,t=!1;for(var i in this._purchasesDetails){var n=this._purchasesDetails[i].state;n===d.SUCCEEDED?e++:t||n!==d.FAILED||(t=!0)}t&&window.wizPurchase.refreshReceipt(function(){},function(e){console.error("Refresh receipt failed",e)}),this._purchasesList.getChildCount()||this._displayPurchasesListNotAvailable(),this._isProcessing=!1,this._validationDone.setText(s("tablet.purchasesPending.validationDone",e)),this._validationDone.show(),this._okButton.enable()},n.prototype.validateNextPendingPurchases=function(e,t){if(e&&console.error(e),this._content){var i=this._purchasesList.getChild(t);this._purchasesDetails[t].state=e?d.FAILED:d.SUCCEEDED,i&&(e?i.replaceClassNames(["success"],["failure"]):i.replaceClassNames(["failure"],["success"])),this._pendingPurchases.length?this._processNext():this._endProcessing()}}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"RecaptchaWindow",positionInfo:{left:"c",top:10,width:400,height:175,isFullScreen:!0,isModal:!0},noCloseButton:!0});var e=this;this.recaptcha=this.windowBody.createChild("iframe");var t=window.dofus.connectionManager;this.on("open",function(t){e.update(t)}),t.on("RecaptchaRequestMessage",function(t){a.open(e.id,t)}),window.addEventListener("message",function(t){if(t.origin===window.Config.proxyUrl){var i=t.data;"recaptchaShow"===i.type&&e.recaptcha.show(),"recaptchaResponse"===i.type&&(window.dofus.send("recaptchaResponse",i.response),a.close("recaptcha"))}})}i(1150);var o=i(172).inherits,s=i(541),a=i(194),r="/recaptcha";o(n,s),e.exports=n,n.prototype.update=function(e){var t={type:"recaptchaLoad",sitekey:e.enrichData.sitekey,lang:window.Config.language||"en"},i=window.Config.proxyUrl,n=this.recaptcha.rootElement;n.onload=function(){n.contentWindow.postMessage(t,i)},n.src=i+r}},function(e,t){},function(e,t,i){function n(){c.call(this,"div",{className:["connectionSplashScreen","hidding"],hidden:!0}),this.currentLevel=null,this.autoRemoveTimeout=null,this.state=""}function o(e){e.autoRemoveTimeout=null,e.replaceClassNames(["blocking"],["warning"])}i(1152);var s=i(29).getText,a=i(339),r=i(172).inherits,l=i(203),c=i(321),d=l.WARNING,u=l.BLOCKING,h=15e3;r(n,c),e.exports=n,n.prototype._createContent=function(){this.lockingDiv=this.createChild("div",{className:"lockingDiv"});var e=this.createChild("div",{className:"splashScreenMsg"});this.message=e.createChild("div",{className:"message"}),e.createChild("div",{className:["spinner","splashSpinner"]})},n.prototype._appear=function(e){if(e!==this.currentLevel)switch(this.currentLevel=e,this.lockingDiv||this._createContent(),this.autoRemoveTimeout=window.clearTimeout(this.autoRemoveTimeout),this.show(),a.forceReflow(this),e){case u:this.replaceClassNames(["hidding","warning"],["blocking"]),this.autoRemoveTimeout=window.setTimeout(o,h,this);break;case d:this.replaceClassNames(["hidding","blocking"],["warning"])}},n.prototype._disappear=function(){this.lockingDiv&&(this.currentLevel=null,this.replaceClassNames(["warning","blocking"],["hidding"]),window.clearTimeout(this.autoRemoveTimeout),this.autoRemoveTimeout=window.setTimeout(function(e){e.hide()},500,this))},n.prototype.onStateChange=function(e,t){if(e!==this.state)switch(this.state=e,e){case"UNSTABLE":this._appear(t||d),this.message.setText(s("tablet.connect.lost"));break;case"RECONNECTING":this._appear(this.currentLevel||d),this.message.setText(s("tablet.connect.retrying",t));break;case"RELOADING":this._appear(u),this.message.setText(s("tablet.connect.reloading"));break;case"CONNECTED":case"DISCONNECTED":this._disappear();break;default:console.error("ConnectionSplashScreen#onStateChange: invalid state: "+e)}}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:["loginScreen","screen"],hidden:!0}),this.addClassNames("vulkaniaSkin"),S=v.isWebGlSupported(),this._connectMethod=_.getValue("connectMethod",E,!0);var e=window.gui,t=this;this._changeLangMethod=N.UPDATE_DOM,this.once("show",function(){this._createContent()}),S&&(this.on("show",this._updateContent),e.on("appLeaveBackground",function(){t.isVisible()&&t._updateContent()}),this.on("hide",function(){t.delClassNames("backgroundImage"),t._toolTip&&t._toolTip.close()})),e.on("NicknameRegistrationMessage",function(){y.open("nickname")}),window.dofus.on("wasAlreadyConnected",function(){e.openSimplePopup(h("ui.connection.disconnectAccount"),h("ui.popup.warning"))})}i(1154);var o=i(172).inherits,s=i(321),a=i(247),r=i(335),l=i(442),c=i(168),d=i(166).dimensions,u=i(29),h=u.getText,p=i(205),m=i(339),f=i(204),g=i(197),_=i(176),v=i(398),y=i(194),b=i(1155),M=i(1160),w=i(1162),T=i(1164),C=i(1168),A=i(1171),I=i(1159).connectMethod,S=!0,E=I.lastCharacter,x=670,N={UPDATE_DOM:0,RELOAD_PAGE:1},L=i(167).TOTAL_MAP_ASSETS_SIZE_IN_GB;o(n,s),e.exports=n,n.prototype._createContent=function(){function e(e){e.on("submit",function(e){e=e||{},t._login(e.login,e.password,e.save)})}var t=this;if(!S)return this._webGlUnsupported=this.createChild("div",{className:"webGlUnsupported"}),void this._webGlUnsupported.setText(h("tablet.login.webGlUnsupported"));var i=this.createChild("div",{className:"verticalPositionerWrapper"}),n=i.createChild("div",{className:"verticalPositioner"});n.createChild("div",{className:"spacer"}),n.createChild("div",{className:"spacer"}),this._leftColumn=n.createChild("div",{className:"leftColumn"}),this._newsBlock=this._leftColumn.appendChild(new T(this)),this._forumBlock=this._leftColumn.appendChild(new C(this)),this._forumBlock.retractableBlock.setBoundedRetractableBlock(this._newsBlock.retractableBlock),this._newsBlock.retractableBlock.expand(),this._loginForm=n.appendChild(new w(this)),this._guestForm=n.appendChild(new b(this)),this._tokenForm=n.appendChild(new M(this)),n.createChild("div",{className:"spacer"}),n.createChild("div",{className:"spacer"}),e(this._loginForm),e(this._guestForm),e(this._tokenForm),this.displayAppropriateForm(),this._toolTip=this.appendChild(new l),this._createTopButtons(),this._createBottomLinks(),this._createSocialButtons(),this._audioSetup()},n.prototype._createTopButtons=function(){var e=this.createChild("div",{className:"topButtons"});this._createPreloadMapButton(e),this._createLangButton(e)},n.prototype._createPreloadMapButton=function(e){var t=this,i=[{getCaption:function(){var e=h("tablet.common.acronymGigabytes",L);return h("tablet.login.settings.downloadMaps",e)},cb:function(){y.open("preloadMap",{})}}];e.appendChild(new r({className:["settingsButton","simpleButton"],addIcon:!0},function(){for(var e=[],n=0;n<i.length;n++){var o=i[n];e.push({caption:o.getCaption(),cb:o.cb})}t._toolTip.openAround(this,{title:"",actions:e})}))},n.prototype._createLangButton=function(e){function t(){n._changeLanguage(this.lang,i)}var i=window.Config,n=this;this._langButton=e.createChild("div",{className:"langButton"}),this._langFlag=this._langButton.createChild("div",{className:"flag"}),g(this._langButton),this._langButton.on("tap",function(){for(var e=[],o=i.language,a=0;a<i.serverLanguages.length;a++){var r=i.serverLanguages[a],l=new s("div",{className:"langLine"});l.createChild("div",{className:["flag",r]}),l.createChild("div",{className:"caption",text:r});var c=["langLineParent"];r===o&&c.push("current"),e.push({wuiDomChild:l,addClassNames:c,lang:r,cb:t})}n._toolTip.openAround(this,{title:"",actions:e})})},n.prototype._changeLanguage=function(e,t){var i=this;if(e!==t.language)return this._changeLangMethod===N.RELOAD_PAGE?(_.setValue("lang",e),_.saveNow(),void window.location.reload()):void u.initialize({language:e,chaseText:t.chaseText},function(n){if(n)return console.error("LoginScreen getText init",n);t.language=e,i.backToLogin(),_.setValue("lang",e,1),i._updateContent();var o=i._toolTip.entryList.getChildren();o[o.length-1].setText(h("ui.common.cancel"))})},n.prototype._createBottomLinks=function(){function e(){m.openUrlInAppBrowser(this.link)}var t=this.createChild("div",{className:"footer"});this._versionLabel=t.createChild("div",{className:"globalMenuVersion"}),this._tou=t.appendChild(new r({className:["link"]})),this._gcs=t.appendChild(new r({className:["link"]})),this._tou.on("tap",e),this._gcs.on("tap",e)},n.prototype._createSocialButtons=function(){function e(){var e=window.Config.language;return A[e]||(e=A.fallbackLanguage),e}var t=this,i=this._leftColumn;d.screenHeight<x&&(i=t);var n=i.createChild("div",{className:"socialBox"}),o=n.appendChild(new r({className:["socialNetworkButton","facebookButton"]})),a=n.appendChild(new r({className:["socialNetworkButton","twitterButton"]})),l=n.appendChild(new r({className:["socialNetworkButton","discordButton"]})),c=n.appendChild(new r({className:["socialNetworkButton","forumButton"]}));c.appendChild(new s("div",{className:["forumButtonLeft"]})),this.forumButtonCaption=c.appendChild(new s("div",{className:["forumButtonCenter"]})),c.appendChild(new s("div",{className:["forumButtonRight"]})),g(o),o.on("tap",function(){var i=e();t._openSocialNetwork({schemeiOS:"fb://",schemeUrl:"fb://profile/"+A[i].facebookPageNumericId,browserUrl:"https://www.facebook.com/"+A[i].facebookPageNumericId})}),g(a),a.on("tap",function(){var i=e();t._openSocialNetwork({schemeiOS:"twitter://",schemeAndroid:"com.twitter.android",schemeUrl:"twitter://user?screen_name="+A[i].twitterAccountId,browserUrl:"https://twitter.com/"+A[i].twitterAccountId})}),g(l),l.on("tap",function(){var t=e();m.openUrlInDeviceBrowser("https://discordapp.com/invite/"+A[t].discordGroupId)}),g(c),c.on("tap",function(){m.openUrlInAppBrowser(h("tablet.forum.link"))})},n.prototype._audioSetup=function(){var e=_.getValue("soundPreferences",a.getDefaultParams(),!0);a.setupChannels(e),a.settings.audioPath=window.Config.assetsUrl+"/audio/",a.initialize(),e.ui.muted||a.createUiSound("GEN_BUTTON")},n.prototype.showLoginForm=function(){this._loginForm.show(),this._guestForm.hide(),this._tokenForm.hide()},n.prototype.showGuestForm=function(){return window.Config.disabledFeatures.guest?(this.showLoginForm(),console.error(new Error("showGuestForm: guest is disabled"))):(this._loginForm.hide(),this._guestForm.show(),void this._tokenForm.hide())},n.prototype.showTokenForm=function(){this._loginForm.hide(),this._guestForm.hide(),this._tokenForm.show()},n.prototype.displayAppropriateForm=function(){if(p.hasKeyFromStorage()&&!window.Config.byPassToken)this.showTokenForm();else if(window.Config.disabledFeatures.guest)this.showLoginForm();else{var e=_.getValue("hasAccount",!1,!0);e?this.showLoginForm():this.showGuestForm()}},n.prototype.openRegisterWindow=function(e){var t=this,i={guestAccount:e,onValidate:function(e){t._afterValidation(e)},isModal:!0};y.open("register",i)},n.prototype._afterValidation=function(e){return e?(_.delValue("guestAccount"),_.delValue("lastIdentification"),_.setValue("hasAccount",!0),_.saveNow(),window.gui.openSimplePopup(h("tablet.register.done"),h("ui.common.congratulation")),this._guestForm.refresh(),void this.showLoginForm()):this._updateContent()},n.prototype.backToLogin=function(){y.closeAll(),window.gui.splashScreen.hide(),this.show()},n.prototype._login=function(e,t,i){function n(e){e||window.gui.initializeAfterLogin(function(e){e&&(console.error("initializeAfterLogin failed:",e),window.gui.openSimplePopup(h("ui.popup.connectionFailed.text")))})}this._changeLangMethod=N.RELOAD_PAGE,window.gui.splashScreen.show(),e?f.startLoginProcessWithPassword(this._connectMethod,e,t,i,n):f.startLoginProcessWithoutPassword(this._connectMethod,n)},n.prototype._updateContent=function(){this.addClassNames("backgroundImage"),this.displayAppropriateForm(),this._loginForm.refresh(),this._guestForm.refresh(),this._tokenForm.refresh(),this._newsBlock.refresh(),this._forumBlock.refresh();for(var e=0;e<window.Config.serverLanguages.length;e++){var t=window.Config.serverLanguages[e];this._langFlag.toggleClassName(t,t===window.Config.language)}this._tou.setText(h("tablet.legals.tou")),this._gcs.setText(h("tablet.legals.gcs")),this._tou.link=h("tablet.legals.link.tou"),this._gcs.link=h("tablet.legals.link.gcs"),this.forumButtonCaption.setText(h("tablet.login.forum")),this._versionLabel.setText(window.gui.getBuildVersion()),this.autoProposeRegistration&&(this.autoProposeRegistration=!1,window.setTimeout(this.openRegisterWindow.bind(this,this._guestForm.guestAccount),0))},n.prototype.proposeRegistrationAfterGuestLimit=function(){var e=this;window.gui.openConfirmPopup({message:h("tablet.oldGuest.limitQuestion"),cb:function(t){t&&(e.autoProposeRegistration=!0,window.gui.disconnect())}})},n.prototype._openSocialNetwork=function(e){if(!window.appAvailability)return m.openUrlInDeviceBrowser(e.browserUrl);var t="";c.isIOSApp?t=e.schemeiOS:c.isAndroidApp&&(t=e.schemeAndroid),window.appAvailability.check(t,function(){window.open(e.schemeUrl,"_system","location=no")},function(){m.openUrlInDeviceBrowser(e.browserUrl)})}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:["GuestForm","rightColumn"],hidden:!0}),this.loginScreen=e;var t=this;this.guestAccount=null,this.isAlreadyGuest=null,this.nickname=null,this.createChild("div",{className:["frame","frame1"]});var i=this.createChild("div",{className:"content"});i.createChild("div",{className:"dofusTouchLogo"});var n=i.createChild("div",{className:"form"});this._introText=n.createChild("div",{className:"introText"}),this._btnPlay=n.createChild("div",{className:"horizontalCenter"}).appendChild(new a({className:["button","buttonPlay"],sound:"OK_BUTTON"})),this._btnPlay.on("tap",function(){if(!t.isAlreadyGuest)return t._createGuest();var i=l.getValue("lastIdentification",null,!0);if(i){var n=Date.now()-i;if(n>864e5)return window.gui.openConfirmPopup({title:r("tablet.oldGuest.register"),message:r("tablet.oldGuest.registerReminder"),cb:function(i){return i?e.openRegisterWindow(t.guestAccount):void t._play()}}),void t._updateLastIdentificationTime()}else t._updateLastIdentificationTime();t._play()}),this._connectionOptions=n.appendChild(new d(e,this)),this._createAccount=this.appendChild(new a({className:"switchAccountBtn"},function(){e.openRegisterWindow(t.guestAccount)})),this._hasAnAccount=this.appendChild(new a({className:"switchAccountBtn2nd"},function(){l.setValue("hasAccount",!0,1),e.showLoginForm()})),this.createChild("div",{className:"greenLine"})}i(1156);var o=i(172).inherits,s=i(321),a=i(335),r=i(29).getText,l=i(176),c=i(205),d=i(1157);o(n,s),e.exports=n,n.prototype.refresh=function(){this._btnPlay.enable(),this._btnPlay.setText(r("ui.common.play")),this._hasAnAccount.setText(r("tablet.login.haveLogin")),this._connectionOptions.refresh(),this._update()},n.prototype._update=function(){this.guestAccount=l.getValue("guestAccount",null,!0),this.isAlreadyGuest=!!(this.guestAccount&&this.guestAccount.login&&this.guestAccount.password),this.nickname=this.guestAccount&&this.guestAccount.nickname||"guestWithNoNickname",this.isAlreadyGuest?(this._createAccount.setText(r("tablet.oldGuest.register")),"guestWithNoNickname"===this.nickname?this._introText.setText(r("tablet.oldGuest.desc.no.nick")):this._introText.setText(r("tablet.oldGuest.desc",this.nickname))):(this._createAccount.setText(r("tablet.login.createAccount")),this._introText.setText(r("tablet.newGuest.desc")))},n.prototype._createGuest=function(){var e=this;this._btnPlay.disable(),c.createGuest(function(t,i){if(t){var n=t.userError||r("ui.secureMode.error.default");return window.gui.openSimplePopup(n),void console.error(t.error)}return e._play(i)})},n.prototype._updateLastIdentificationTime=function(){l.setValue("lastIdentification",Date.now(),null,!0)},n.prototype._play=function(e){e=e||{login:this.guestAccount.login,password:this.guestAccount.password},this.emit("submit",{login:e.login,password:e.password,save:e.save})}},function(e,t){},function(e,t,i){function n(e,t,i){s.call(this,"div",{className:"ConnectionOptions"}),this.loginScreen=e,i=i||{};var n=this;this._bottomLinks=this.appendChild(new a({className:"bottomLinks"})),i.forgotPassword&&(this._forgottenPassword=this._bottomLinks.appendChild(new a({className:"forgottenPassword"})),this._forgottenPassword.on("tap",function(){l.openUrlInAppBrowser(this.link)})),this._connectionOptions=this._bottomLinks.appendChild(new a({className:"connectionOptions"})),this._connectionOptions.on("tap",function(){var e=!n._advancedOptions.isVisible();n._advancedOptions.toggleDisplay(e),n._connectionOptions.toggleClassName("selected",e),e&&n._update()}),this._advancedOptions=this.createChild("div",{className:"advancedOptions"}),this._advancedOptions.hide(),this._grayLine=this._advancedOptions.createChild("div",{className:"grayLine"}),this.connectionMethodSelector=this._advancedOptions.appendChild(new c({className:""})),this._advancedOptions.createChild("div",{className:"clearFloat"}),this.connectionMethodSelector.on("change",function(e){n.loginScreen._connectMethod=e,d.setValue("connectMethod",e,null,!0)})}i(1158);var o=i(172).inherits,s=i(321),a=i(335),r=i(29).getText,l=i(339),c=i(532),d=i(176),u=i(1159);o(n,s),e.exports=n,n.prototype.refresh=function(){this._forgottenPassword&&(this._forgottenPassword.setText(r("ui.login.forgottenPassword")),this._forgottenPassword.link=r("tablet.link.findPassword")),this._connectionOptions.setText(r("tablet.login.connectionOptions")),this.connectionMethodSelector.clearContent();for(var e in u.connectMethod)this.connectionMethodSelector.addOption(r("tablet.login.connectionOption."+e),e);this._update()},n.prototype._update=function(){this.connectionMethodSelector.select(this.loginScreen._connectMethod,!0)}},function(e,t){},function(e,t){e.exports={social:{fr:{facebookPageId:"DOFUSTouch",facebookPageNumericId:"1663041913975144",twitterAccountId:"DofusTouch"},en:{facebookPageId:"DOFUSTouch",facebookPageNumericId:"1663041913975144",twitterAccountId:"DOFUSTouch_EN"},fallbackLanguage:"en"},connectMethod:{manual:"manual",lastServer:"lastServer",lastCharacter:"lastCharacter"}}},function(e,t,i){function n(e){s.call(this,"div",{className:["TokenForm","rightColumn"],hidden:!0}),this.loginScreen=e;var t=this;this.createChild("div",{className:["frame","frame1"]});var i=this.createChild("div",{className:"content"});i.createChild("div",{className:"dofusTouchLogo"});var n=i.createChild("div",{className:"form"});this._introText=n.createChild("div",{className:"introText"}),this._btnPlay=n.createChild("div",{className:"horizontalCenter"}).appendChild(new a({className:["button","buttonPlay"],sound:"OK_BUTTON"})),this._btnPlay.on("tap",function(){t._play()}),this._connectionOptions=n.appendChild(new c(e,this)),this._guestLink=this.appendChild(new a({className:"switchAccountBtn"},function(){l.resetHaapiKey(),t.loginScreen.showLoginForm()})),this.createChild("div",{className:"greenLine"})}i(1161);var o=i(172).inherits,s=i(321),a=i(335),r=i(29).getText,l=i(205),c=i(1157);o(n,s),e.exports=n,n.prototype.refresh=function(){var e=l.getHaapiUsername();this._introText.setText(r("tablet.token.desc",e)),this._btnPlay.setText(r("ui.common.play")),this._guestLink.setText(r("tablet.token.notme",e)),this._connectionOptions.refresh(),this._update()},n.prototype._update=function(){},n.prototype._play=function(){this.emit("submit")}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:["LoginForm","rightColumn"],hidden:!0}),this.loginScreen=e;var t=this;this.createChild("div",{className:["frame","frame1"]});var i=this.createChild("div",{className:["content"]});i.createChild("div",{className:["dofusTouchLogo"]});var n=i.createChild("div",{className:["form"]});this._labelLogin=n.createChild("label"),this._inputLogin=n.appendChild(new c({className:["inputText","whiteStyle"],attr:{type:"text"}})),this._inputLogin.on("validate",function(){t._inputPassword.focus()}),this._labelPassword=n.createChild("label"),this._inputPassword=n.appendChild(new c({className:["inputText","whiteStyle"],attr:{type:"password"}})),this._inputPassword.on("validate",function(){t._play()}),this._rememberName=n.appendChild(new r("")),this._btnPlay=n.createChild("div",{className:["horizontalCenter"]}).appendChild(new a({className:["button","buttonPlay"],sound:"OK_BUTTON"})),this._btnPlay.on("tap",function(){t._play()}),this._connectionOptions=n.appendChild(new h(e,this,{forgotPassword:!0})),this._guestLink=this.appendChild(new a({className:"switchAccountBtn"},function(){u.setValue("hasAccount",!1,1),t.loginScreen.showGuestForm()})),this.createChild("div",{className:"greenLine"})}i(1163);var o=i(172).inherits,s=i(321),a=i(335),r=i(612),l=i(29).getText,c=i(530),d=i(435),u=i(176),h=i(1157);o(n,s),e.exports=n,n.prototype.refresh=function(){this._labelLogin.setText(l("ui.login.username")),this._labelPassword.setText(l("ui.login.password")),this._btnPlay.setText(l("ui.common.play")),this._rememberName.setText(l("tablet.login.rememberMe")),this._guestLink.setText(l("tablet.login.noAccount")),this._guestLink.toggleDisplay(!window.Config.disabledFeatures.guest),this._connectionOptions.refresh(),this._update()},n.prototype._update=function(){this._rememberName.toggleActivation(!1,!0),this._inputLogin.setValue(""),window.developmentMode?this._inputPassword.setValue(window.Config.defaultPassword||""):this._inputPassword.setValue("")},n.prototype._play=function(){d.hide();var e=this._inputLogin.getValue(),t=this._inputPassword.getValue(),i=this._rememberName.isActivate();return window.developmentMode||e&&t?void this.emit("submit",{login:e,password:t,save:i}):window.gui.openSimplePopup(l("ui.popup.accessDenied.wrongCredentials"))}},function(e,t){},function(e,t,i){function n(e){function t(e){function t(){var t=i._newsUrls[e];t&&i.isTapping&&c.openUrlInAppBrowser(t)}i._banners[e].on("tap",t),i._bannerTitles[e].on("tap",t)}s.call(this,"div",{className:"NewsBlock",hidden:!1});var i=this;this.loginScreen=e,this._newsLoadedTime=0,this._currentPage=0,this._newsLang=null,this._transitioning=!1,this._setTimoutId=null,this._pageCount=_,this._carouselPages=[],this._banners=[],this._newsUrls=[],this._bannerTitles=[],this._date=[],this._dots=[],this.retractableBlock=this.appendChild(new d((!1)));var n=this.retractableBlock.getContainer();this._carouselMargin=n.createChild("div",{className:"carouselMargin"}),this._carouselWrapper=this._carouselMargin.createChild("div",{className:"carouselWrapper"}),c.cssTransition(this._carouselWrapper,f+"ms"),this._dotsWrapper=this._carouselMargin.createChild("div",{className:"dotsWrapper",hidden:!0});for(var o=0;o<_;o++)this._carouselPages[o]=this._carouselWrapper.createChild("div",{className:["carouselPage","page"+o],hidden:!0}),this._banners[o]=this._carouselPages[o].createChild("div",{className:["banner","spinner"]}),u(this._banners[o]),this._bannerTitles[o]=this._carouselPages[o].createChild("div",{className:"bannerTitle"}),u(this._bannerTitles[o]),this._date[o]=this._carouselPages[o].createChild("div",{className:"date"}),t(o),this._dots[o]=this._dotsWrapper.createChild("div",{className:"dot"});this._resetTransform(),this._updateDots(),this._rightArrow=n.appendChild(new a({className:"rightArrow",hidden:!0},function(){i._transitioning||i._scrollToNextNews()})),this._leftArrow=n.appendChild(new a({className:"leftArrow",hidden:!0},function(){i._transitioning||i._scrollToPrevNews()})),e.on("hide",function(){for(var e=0;e<_;e++)i._banners[e].setStyle("backgroundImage","initial");i._newsLoadedTime=0,i._clearTimeout()});var r=null;this.isTapping=!1,this.retractableBlock.allowDomEvents(),this.retractableBlock.on("dom.touchstart",function(e){if(!(i._pageCount<=1)){var t=h(e);r=t.x,i.isTapping=!0}}),this.retractableBlock.on("dom.touchmove",function(e){if(!(i._pageCount<=1)&&i.isTapping){var t=h(e),n=t.x-r;n>v&&(i.isTapping=!1,i._scrollToPrevNews()),n<-v&&(i.isTapping=!1,i._scrollToNextNews())}})}i(1165);var o=i(172).inherits,s=i(321),a=i(335),r=i(29).getText,l=i(205),c=i(339),d=i(1166),u=i(197),h=i(198).getPosition,p=5e3,m=288e5,f=600,g=475,_=3,v=20;o(n,s),e.exports=n,n.prototype.refresh=function(){this.retractableBlock.show(),this.retractableBlock.setTitle(r("tablet.login.news")),this._update()},n.prototype._update=function(){var e=window.Config,t=this;Date.now()-this._newsLoadedTime<m&&this._newsLang===e.language||(this._clearTimeout(),this._rightArrow.hide(),this._leftArrow.hide(),this._dotsWrapper.hide(),this._newsLoadedTime=0,this._banners[this._currentPage].addClassNames("spinner"),this._pageCount=0,l.getNewsList(_,function(i,n){if(i||!n)return t._noNewsFallback();if(!n.length)return t.loginScreen._forumBlock.retractableBlock.expand(),t._noNewsFallback();t._newsLoadedTime=Date.now(),t._pageCount=n.length,t._currentPage=0,t._resetTransform(),t._updateDots();for(var o=0;o<_;o++){var s=o<t._pageCount;if(t._dots[o].toggleDisplay(s),t._carouselPages[o].toggleDisplay(s),s){var a=n[o],r=a.image_url;t._banners[o].delClassNames(["spinner","noNewsFallback"]),r&&t._banners[o].setStyle("backgroundImage",'url("'+r+'")'),t._date[o].setText(a.date),t._date[o].show(),t._newsUrls[o]=a.url,t._bannerTitles[o].setText(a.title)}}var l=t._pageCount>1;t._rightArrow.toggleDisplay(l),t._leftArrow.toggleDisplay(l),t._dotsWrapper.toggleDisplay(l),l&&t._registerNextNewsChange(),t._newsLang=e.language}))},n.prototype._scrollToPrevNews=function(){this._scrollNews(-1)},n.prototype._scrollToNextNews=function(){this._scrollNews(1)},n.prototype._scrollNews=function(e){if(e===-1||1===e){var t=this;if(!this._transitioning){this._clearTimeout(),this._currentPage=(this._currentPage+this._pageCount+e)%this._pageCount;var i=e===-1?0:2*g;this._carouselPages[this._currentPage].setStyle("left",i+"px"),c.forceReflow(this._carouselWrapper),c.cssTransform(this._carouselWrapper,"translate("+(1===e?2*-g:0)+"px, 0px)"),this._updateDots(),this._transitioning=!0,setTimeout(function(){t._resetTransform(),t._transitioning=!1,t._registerNextNewsChange()},f+200)}}},n.prototype._updateDots=function(){for(var e=0;e<_;e++)this._dots[e].toggleClassName("selected",this._currentPage===e)},n.prototype._resetTransform=function(){c.cssTransition(this._carouselWrapper,"0ms"),c.forceReflow(this._carouselWrapper),c.cssTransform(this._carouselWrapper,"translate(-"+g+"px, 0px)"),c.forceReflow(this._carouselWrapper),c.cssTransition(this._carouselWrapper,f+"ms");for(var e=0;e<this._pageCount;e++){var t=e===this._currentPage-1||e-this._pageCount===this._currentPage-1,i=e===this._currentPage,n=e===this._currentPage+1||e+this._pageCount===this._currentPage+1,o=t||i||n;if(o){var s=i?g:t?0:2*g;this._carouselPages[e].setStyle("left",s+"px"),this._carouselPages[e].show()}else this._carouselPages[e].hide()}},n.prototype._registerNextNewsChange=function(){var e=this;null===this._setTimoutId&&(this._transitioning||0!==e._newsLoadedTime&&(this._setTimoutId=setTimeout(function(){this._setTimoutId=null,0!==e._newsLoadedTime&&(e._scrollToNextNews(),e._registerNextNewsChange())},p)))},n.prototype._clearTimeout=function(){null!==this._setTimoutId&&(clearTimeout(this._setTimoutId),this._setTimoutId=null)},n.prototype._noNewsFallback=function(){this._newsLoadedTime=0,this._leftArrow.hide(),this._rightArrow.hide(),this._dotsWrapper.hide(),this._clearTimeout();for(var e=0;e<_;e++)this._banners[e].delClassNames("spinner"),this._bannerTitles[e].setText(r("tablet.login.noNewsFallback")),this._date[e].hide();this._banners[this._currentPage].addClassNames("noNewsFallback"),this._newsUrls[this._currentPage]=r("tablet.forum.link")}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"RetractableBlock",hidden:!1});var t=this;this._isExpanded=!1,this._boundedBlock=null,this.createChild("div",{className:["frame","frame2"]});var i=this.createChild("div",{className:"content"});this._titleBox=i.createChild("div",{className:"titleBox"}),this._titleBullet=this._titleBox.createChild("div",{className:"titleBullet"}),this._title=this._titleBox.createChild("div",{className:"title"}),e&&(this._expandButton=this._titleBox.appendChild(new a({className:["greenButton","expandButton"]},function(){t._isExpanded?(t._retract(),t._boundedBlock&&t._boundedBlock.expand()):t.expand()})),this._expandButton.createChild("div",{className:"expandeButtonContent",text:"+"})),this._subTitle=this._titleBox.createChild("div",{className:"subTitle"}),this._retractable=i.createChild("div",{className:"retractable"}),r.push(this)}i(1167);var o=i(172).inherits,s=i(321),a=i(335),r=[];o(n,s),e.exports=n,n.prototype.getContainer=function(){return this._retractable},n.prototype.setTitle=function(e){this._title.setText(e)},n.prototype.setSubTitle=function(e){this._subTitle.setText(e)},n.prototype.expand=function(){for(var e=0;e<r.length;e++){var t=r[e];this===t?t._expand():t._retract()}},n.prototype._expand=function(){this._isExpanded||(this._retractable.addClassNames("expanded"),this._titleBox.addClassNames("expanded"),this._expandButton&&(this._boundedBlock?this._expandButton.setText("-"):this._expandButton.addClassNames("expanded")),this._isExpanded=!0)},n.prototype._retract=function(){this._isExpanded&&(this._retractable.delClassNames("expanded"),this._titleBox.delClassNames("expanded"),this._expandButton&&(this._boundedBlock?this._expandButton.setText("+"):this._expandButton.delClassNames("expanded")),this._isExpanded=!1)},n.prototype.setBoundedRetractableBlock=function(e){return this._boundedBlock||e._boundedBlock?console.error(new Error("RetractableBlock: a block is already bounded to another one")):(this._boundedBlock=e,void(e._boundedBlock=this))}},function(e,t){},function(e,t,i){function n(){c.call(this,"div",{className:"ForumBlock",hidden:!1}),this._newsLoaded=!1,this.retractableBlock=this.appendChild(new m((!0)));var e=this.retractableBlock.getContainer().createChild("div",{className:["forumNewsMargin"]});this._content=e.createChild("div",{className:["forumNews"]}),s()}function o(e){return e=e.filter(function(e){return!e.pinned}),e.sort(function(e,t){return Date.parse(t.added_date)-Date.parse(e.added_date)}),e[0]}function s(){var e={openTag:function(){return"<center>"+u("tablet.login.forumUnsupportedTag")+"</center><br />"},closeTag:function(){return""},displayContent:!1};d.addTags({
h2:{openTag:function(){return"<h3>"},closeTag:function(){return"</h3>"}},h3:{openTag:function(){return"<h4>"},closeTag:function(){return"</h4>"}},hr:{openTag:function(){return'<br /><hr class="postSeparator"><br />'},closeTag:function(){return""}},embed:e,spoiler:e})}function a(e){return e=e.replace(/\[hr\]/g,"[hr][/hr]"),e=e.replace(/\[list=1\]/g,"[list type=decimal]")}function r(e){return e=e.replace(/(?:\r\n|\r|\n)/g,"<br />")}i(1169);var l=i(172).inherits,c=i(321),d=i(1170),u=i(29).getText,h=i(205),p=i(339),m=i(1166);l(n,c),e.exports=n,n.prototype.refresh=function(){this.retractableBlock.show(),this.retractableBlock.setTitle(u("tablet.login.changelog")),this._update()},n.prototype._update=function(){var e=this;this._content.clearContent(),this._content.addClassNames("spinner"),h.getForumTopicsList(function(t,i){if(t)return window.developmentMode&&console.error(t),e._content.delClassNames("spinner"),e._content.setHtml(u("tablet.login.forumUnreachable")),void p.allLinksOnTargetBlank(e._content);var n=o(i);h.getForumPostsList(n.id,function(t,i){if(e._content.delClassNames("spinner"),t)return e._content.setHtml(u("tablet.login.forumUnreachable")),void p.allLinksOnTargetBlank(e._content);var o,s=[n].concat(i),l="";for(o=0;o<s.length;o++){l+=0===o?"<h2>"+s[o].title+"</h2><br/>":"<br /><br /><center>* * *</center><br />";var c=s[o].content;c=a(c),c=d.process({text:c}).html,c=r(c),l+=c}e._content.setHtml(l),p.allLinksOnTargetBlank(e._content),e.retractableBlock.setSubTitle(n.title)})})}},function(e,t){},function(e,t){var i=function(){"use strict";function e(){l=[];var e,t,i;for(e in r)if(r.hasOwnProperty(e)){for("*"===e?l.push("\\"+e):(l.push(e),r[e].noParse&&C.push(e)),r[e].validChildLookup={},r[e].validParentLookup={},r[e].restrictParentsTo=r[e].restrictParentsTo||[],r[e].restrictChildrenTo=r[e].restrictChildrenTo||[],i=r[e].restrictChildrenTo.length,t=0;t<i;t++)r[e].validChildLookup[r[e].restrictChildrenTo[t]]=!0;for(i=r[e].restrictParentsTo.length,t=0;t<i;t++)r[e].validParentLookup[r[e].restrictParentsTo[t]]=!0}c=new RegExp("<bbcl=([0-9]+) ("+l.join("|")+")([ =][^>]*?)?>((?:.|[\\r\\n])*?)<bbcl=\\1 /\\2>","gi"),d=new RegExp("\\[("+l.join("|")+")([ =][^\\]]*?)?\\]([^\\[]*?)\\[/\\1\\]","gi"),u=new RegExp("\\[("+C.join("|")+")([ =][^\\]]*?)?\\]([\\s\\S]*?)\\[/\\1\\]","gi"),function(){for(var e=[],t=0;t<l.length;t++)"\\*"!==l[t]&&e.push("/"+l[t]);h=new RegExp("(\\[)((?:"+l.join("|")+")(?:[ =][^\\]]*?)?)(\\])","gi"),p=new RegExp("(\\[)("+e.join("|")+")(\\])","gi")}()}function t(e,i,n,o,s,a,d){d=d||[],n++;var u,h,p,m,f=new RegExp("(<bbcl="+n+" )("+l.join("|")+")([ =>])","gi"),g=new RegExp("(<bbcl="+n+" )("+l.join("|")+")([ =>])","i"),_=a.match(f)||[],v=r[e]||{};for(f.lastIndex=0,_||(a=""),p=0;p<_.length;p++)g.lastIndex=0,m=_[p].match(g)[2].toLowerCase(),v&&v.restrictChildrenTo&&v.restrictChildrenTo.length>0&&(v.validChildLookup[m]||(h='The tag "'+m+'" is not allowed as a child of the tag "'+e+'".',d.push(h))),u=r[m]||{},u.restrictParentsTo.length>0&&(u.validParentLookup[e]||(h='The tag "'+e+'" is not allowed as a parent of the tag "'+m+'".',d.push(h)));return a=a.replace(c,function(e,i,n,o,s){return d=t(n,e,i,n,o,s,d),e}),d}function i(e){return e=e.replace(/\<([^\>][^\>]*?)\>/gi,function(e,t){var i=t.match(/^bbcl=([0-9]+) /);return null===i?"<bbcl=0 "+t+">":"<"+t.replace(/^(bbcl=)([0-9]+)/,function(e,t,i){return t+(parseInt(i,10)+1)})+">"})}function n(e){return e.replace(/<bbcl=[0-9]+ \/\*>/gi,"").replace(/<bbcl=[0-9]+ /gi,"&#91;").replace(/>/gi,"&#93;")}function o(e){var t=e.text;return t=t.replace(c,A)}function s(e){for(e=e.replace(/\[(?!\*[ =\]]|list([ =][^\]]*)?\]|\/list[\]])/gi,"<"),e=e.replace(/\[(?=list([ =][^\]]*)?\]|\/list[\]])/gi,">");e!==(e=e.replace(/>list([ =][^\]]*)?\]([^>]*?)(>\/list])/gi,function(e,t,i){for(var n=e;n!==(n=n.replace(/\[\*\]([^\[]*?)(\[\*\]|>\/list])/i,function(e,t,i){i=">/list]"===i?"</*]</list]":"</*][*]";var n="<*]"+t+i;return n})););return n=n.replace(/>/g,"<")})););return e=e.replace(/</g,"[")}function a(e){for(var t=function(e,t,n,o){return e=e.replace(/\[/g,"<"),e=e.replace(/\]/g,">"),i(e)};e!==(e=e.replace(d,t)););return e}var r,l,c,d,u,h,p,m={},f=/^(?:https?|file|c):(?:\/{1,3}|\\{1})[-a-zA-Z0-9:;@#%&()~_?\+=\/\\\.]*$/,g=/^(?:ftps?|c):(?:\/{1,3}|\\{1})[-a-zA-Z0-9:;@#%&()~_?\+=\/\\\.]*$/,_=/^(?:red|green|blue|orange|yellow|pink|black|white|beige|brown|grey|gray|silver|purple|maroon|lime|limegreen|olive|navy|teal|aqua)$/,v=/^#?[a-fA-F0-9]{6}$/,y=/[^\s@]+@[^\s@]+\.[^\s@]+/,b=/([1-9][\d]?p[xt]|(?:x-)?small(?:er)?|(?:x-)?large[r]?)/,M=/[#]?([A-Za-z][A-Za-z0-9_-]*)/,w=/(?:board=\d+;)?((?:topic|threadid)=[\dmsg#\.\/]{1,40}(?:;start=[\dmsg#\.\/]{1,40})?|action=profile;u=\d+)/,T=/^\/threads\/[a-z0-9\-]*\/posts[a-z0-9?\=\-#\&]*/i,C=[];r={anchor:{openTag:function(e,t){var i=e||"";return i=i.substr(1)||"",M.test(i)||(i=""),'<span id="post_'+i+'">'},closeTag:function(e,t){return"</span>"}},abbr:{openTag:function(e,t){var i=e||"";return i=i.substr(1)||"",i=i.replace(/<.*?>/g,""),'<abbr title="'+i+'">'},closeTag:function(e,t){return"</abbr>"}},acronym:{openTag:function(e,t){var i=e||"";return i=i.substr(1)||"",itle=i.replace(/<.*?>/g,""),'<acronym title="'+i+'">'},closeTag:function(e,t){return"</acronym>"}},b:{openTag:function(e,t){return"<b>"},closeTag:function(e,t){return"</b>"}},bbcode:{openTag:function(e,t){return""},closeTag:function(e,t){return""}},black:{openTag:function(e,t){return'<span class="bbcode-color-black" style="color: black;">'},closeTag:function(e,t){return"</span>"}},blue:{openTag:function(e,t){return'<span class="bbcode-color-blue" style="color: blue;">'},closeTag:function(e,t){return"</span>"}},br:{openTag:function(e,t){return"<br />"},closeTag:function(e,t){return""}},btc:{openTag:function(e,t){return'<span class="BTC">BTC</span>'},closeTag:function(e,t){return""}},center:{openTag:function(e,t){return'<div align="center">'},closeTag:function(e,t){return"</div>"}},code:{openTag:function(e,t){return"<code>"},closeTag:function(e,t){return"</code>"},noParse:!0},color:{openTag:function(e,t){var i="",n=e||"=black";return n=e.substr(1)||"black",n=n.toLowerCase(),n=n.trim(),_.lastIndex=0,v.lastIndex=0,_.test(n)?i=n:v.test(n)?"#"!==n.substr(0,1)?(i="_"+n,n="#"+n):i="_"+n.substr(1):(n="black",i="black"),'<span class="bbcode-color-'+i+'" style="color:'+n+'">'},closeTag:function(e,t){return"</span>"}},email:{openTag:function(e,t){var i;return i=e?e.substr(1):t.replace(/<.*?>/g,""),i=i.trim(),y.lastIndex=0,y.test(i)?'<a href="mailto:'+i+'" target="_blank">':"<a>"},closeTag:function(e,t){return"</a>"}},ftp:{openTag:function(e,t){var i="";return i=e?e.substr(1):t.replace(/<.*?>/g,""),i=i.trim(),g.lastIndex=0,g.test(i)?'<a href="'+i+'" target="_blank">':'<a target="_blank">'},closeTag:function(e,t){return"</a>"}},glow:{openTag:function(e,t){var i=e||"";i=e.substr(1)||"",i=i.replace(/<.*?>/g,"");var n="",o=i.split(",")[0];return o=o.trim(),o=o.toLowerCase(),_.lastIndex=0,v.lastIndex=0,_.test(o)?n=o:v.test(o)?"#"!==o.substr(0,1)?(n="_"+o,o="#"+o):n="_"+o.substr(1):(o="inherit",n="inherit"),'<span class="bbcode-bgcolor-'+n+'" style="background-color: '+o+'">'},closeTag:function(e,t){return"</span>"}},green:{openTag:function(e,t){return'<span class="bbcode-color-green" style="color: green;">'},closeTag:function(e,t){return"</span>"}},hr:{openTag:function(e,t){return"<hr />"},closeTag:function(e,t){return""}},html:{openTag:function(e,t){return""},closeTag:function(e,t){return""}},i:{openTag:function(e,t){return"<i>"},closeTag:function(e,t){return"</i>"}},img:{openTag:function(e,t){var i=t;if(i=i.trim(),f.lastIndex=0,f.test(i)||(i=""),!e)return'<img src="'+i+'" />';var n=e;n=n.trim(),n=n.replace(/<.*?>/g,"");var o,s,a;if((n.match(/alt=/gi)||[]).length>1)return'<img src="'+i+'" />';if((n.match(/width=/gi)||[]).length>1)return'<img src="'+i+'" />';if((n.match(/height=/gi)||[]).length>1)return'<img src="'+i+'" />';var r=/^(alt=.+?|width=[0-9]+?|height=[0-9]+?)?\s*(alt=.+?|width=[0-9]+?|height=[0-9]+?)?\s*(alt=.+?|width=[0-9]+?|height=[0-9]+?)$/i.exec(n);if(r)for(var l=1;l<r.length;l++){var c=r[l]||"";c=c.trim(),/alt=/i.test(c)?o=c.substr(4):/width=/i.test(c)?s=c.substr(6):/height=/i.test(c)&&(a=c.substr(7))}var d='<img src="'+i+'" ';return o&&(d+='alt="'+o+'" '),s&&(d+='width="'+s+'" '),a&&(d+='height="'+a+'" '),d+="/>"},closeTag:function(e,t){return""},displayContent:!1},iurl:{openTag:function(e,t){var i;return i=e?e.substr(1):t.replace(/<.*?>/g,""),i=i.trim(),f.lastIndex=0,f.test(i)||(i="#"),'<a href="'+i+'" />'},closeTag:function(e,t){return""}},left:{openTag:function(e,t){return'<div class="bbcode-text-left" style="text-align: left;">'},closeTag:function(e,t){return"</div>"}},li:{openTag:function(e,t){return"<li>"},closeTag:function(e,t){return"</li>"},restrictParentsTo:["list","ul","ol"]},list:{openTag:function(e,t){var i="<ul>",n=e||"";return n=n.trim(),n=n.replace(/<.*?>/g,""),0===n.indexOf("type=")&&(n=n.replace("type=",""),n=n.trim(),/(none|disc|circle|square|decimal|decimal-leading-zero|lower-roman|upper-roman|lower-alpha|upper-alpha|lower-greek|lower-latin|upper-latin|hebrew|armenian|georgian|cjk-ideographic|hiragana|katakana|hiragana-iroha|katakana-iroha)/i.test(n)&&(i='<ul class="bbcode-list-'+n+'" style="list-style-type: '+n+'">')),i},closeTag:function(e,t){return"</ul>"},restrictChildrenTo:["*","li"]},ltr:{openTag:function(e,t){return'<div dir="ltr">'},closeTag:function(e,t){return"</div>"}},me:{openTag:function(e,t){var i=e||"";return i=e.substr(1),i=i.replace(/<.*?>/g,""),i=i.trim(),t&&(i+=" "),'<div class="bbcode-color-red" style="color: red;">* '+i+" "},closeTag:function(e,t){return"</div>"}},move:{openTag:function(e,t){return"<div>"},closeTag:function(e,t){return"</div>"}},noparse:{openTag:function(e,t){return""},closeTag:function(e,t){return""},noParse:!0},nobbc:{openTag:function(e,t){return""},closeTag:function(e,t){return""},noParse:!0},ol:{openTag:function(e,t){return"<ol>"},closeTag:function(e,t){return"</ol>"},restrictChildrenTo:["*","li"]},pre:{openTag:function(e,t){return"<pre>"},closeTag:function(e,t){return"</pre>"}},php:{openTag:function(e,t){return"<pre>"},closeTag:function(e,t){return"</pre>"},noParse:!0},quote:{openTag:function(e,t){var i='<div class="quoteHeader">Quote</div>',n='<div class="quote">',o=e||"";if(o=o.trim(),o=o.replace(/<.*?>/g,""),""===o)return i+n;if(0===o.indexOf("=")){var s=o.substr(1);return i='<div class="quoteHeader">',i+="Quote From: "+s,i+="</div>",i+n}if(/author="/i.test(o)){var a=o.toLowerCase(),r=o.substr(a.indexOf('author="')+7);return r=r.replace(/"/g,""),i='<div class="quoteHeader">',i+="Quote From: "+r,i+="</div>",i+n}var l,c,d,u=o.match(/author=/gi)||[];if(u.length>1||0===u.length)return i+n;if((o.match(/link=/gi)||[]).length>1)return i+n;if((o.match(/date=/gi)||[]).length>1)return i+n;var h=/^(author=.+?|link=.+?|date=[0-9]+?)?\s*(author=.+?|link=.+?|date=[0-9]+?)?\s*(author=.+?|link=.+?|date=[0-9]+?)$/i.exec(o);if(h)for(var p=1;p<h.length;p++){var m=h[p]||"";m=m.trim(),/author=/i.test(m)?l=m.substr(7):/link=/i.test(m)?(c=m.substr(5),w.test(c)||T.test(c)||(c=void 0)):/date=/i.test(m)&&(d=Number(m.substr(5)))}return l&&(i='<div class="quoteHeader">',i+="Quote From: "+l,i+="</div>"),l&&c&&d&&(i='<div class="quoteHeader">',i+='<a href="'+c+'">',i+="Quote from: "+l+" on ept-date="+d,i+="</a>",i+="</div>"),i+n},closeTag:function(e,t){return"</div>"}},right:{openTag:function(e,t){return'<div class="bbcode-text-right" style="text-align: right;">'},closeTag:function(e,t){return"</div>"}},red:{openTag:function(e,t){return'<span class="bbcode-color-red" style="color: red;">'},closeTag:function(e,t){return"</span>"}},rtl:{openTag:function(e,t){return'<div dir="rtl">'},closeTag:function(e,t){return"</div>"}},s:{openTag:function(e,t){return"<del>"},closeTag:function(e,t){return"</del>"}},shadow:{openTag:function(e,t){var i="",n="",o="",s="",a=/^(?:left|right|top|bottom)$/,r=/^[0-9]\d{0,2}$/,l=e||"";if(l=e.substr(1)||"",l=l.replace(/<.*?>/g,""),l.indexOf(",")<0)return"<span>";if(n=l.split(",")[0],n=n.trim(),n=n.toLowerCase(),_.lastIndex=0,v.lastIndex=0,_.test(n)||(v.test(n)?"#"!==n.substr(0,1)&&(n="#"+n):n="black"),o=l.split(",")[1]||"",o=o.trim())if(a.test(o))o="left"===o?" -2px 2px":"right"===o?" 2px 2px":"top"===o?" 0 -2px":"bottom"===o?" 0 2px":" 0 0";else if(r.test(o)){var c=o,d=.0174532925*c;o=" "+Math.round(4*Math.cos(d))+"px",o+=" "+Math.round(-4*Math.sin(d))+"px"}else o=" 0 0";else o=" 0 0";s=l.split(",")[2]||"",s=s.trim(),s=s&&r.test(s)?" "+s+"px":" 0",i=n+o+s;var u=i.replace(/\s/gi,"_");return u=u.replace(/#/gi,"_"),'<span class="bbcode-shadow-'+u+'" style="text-shadow: '+i+'">'},closeTag:function(e,t){return"</span>"}},size:{openTag:function(e,t){var i=e||"";return i=i.substr(1)||"inherit",i=i.trim(),b.lastIndex=0,b.test(i)||(i="inherit"),'<span class="bbcode-size-'+i+'" style="font-size: '+i+' !important; line-height: 1.3em;">'},closeTag:function(e,t){return"</span>"}},sub:{openTag:function(e,t){return"<sub>"},closeTag:function(e,t){return"</sub>"}},sup:{openTag:function(e,t){return"<sup>"},closeTag:function(e,t){return"</sup>"}},tt:{openTag:function(e,t){return"<tt>"},closeTag:function(e,t){return"</tt>"}},time:{openTag:function(e,t){var i=t||"";return Number(i)?i="ept-date="+i:(i=new Date(i).getTime(),i="ept-date="+i),i},closeTag:function(e,t){return""},displayContent:!1},table:{openTag:function(e,t){return"<table>"},closeTag:function(e,t){return"</table>"},restrictChildrenTo:["tbody","thead","tfoot","tr"]},tbody:{openTag:function(e,t){return"<tbody>"},closeTag:function(e,t){return"</tbody>"},restrictChildrenTo:["tr"],restrictParentsTo:["table"]},tfoot:{openTag:function(e,t){return"<tfoot>"},closeTag:function(e,t){return"</tfoot>"},restrictChildrenTo:["tr"],restrictParentsTo:["table"]},thead:{openTag:function(e,t){return"<thead>"},closeTag:function(e,t){return"</thead>"},restrictChildrenTo:["tr"],restrictParentsTo:["table"]},td:{openTag:function(e,t){return'<td valign="top">'},closeTag:function(e,t){return"</td>"},restrictParentsTo:["tr"]},th:{openTag:function(e,t){return"<th>"},closeTag:function(e,t){return"</th>"},restrictParentsTo:["tr"]},tr:{openTag:function(e,t){return"<tr>"},closeTag:function(e,t){return"</tr>"},restrictChildrenTo:["td","th"],restrictParentsTo:["table","tbody","tfoot","thead"]},u:{openTag:function(e,t){return"<u>"},closeTag:function(e,t){return"</u>"}},ul:{openTag:function(e,t){return"<ul>"},closeTag:function(e,t){return"</ul>"},restrictChildrenTo:["*","li"]},url:{openTag:function(e,t){var i;return i=e?e.substr(1):t.replace(/<.*?>/g,""),i=i.trim(),f.lastIndex=0,f.test(i)||(i="#"),'<a href="'+i+'" target="_blank">'},closeTag:function(e,t){return"</a>"}},white:{openTag:function(e,t){return'<span class="bbcode-color-white" style="color: white;">'},closeTag:function(e,t){return"</span>"}},"*":{openTag:function(e,t){return"<li>"},closeTag:function(e,t){return"</li>"},restrictParentsTo:["list","ul","ol"]}},e();var A=function(e,t,i,o,s){i=i.toLowerCase();var a=r[i].noParse?n(s):s.replace(c,A),l=r[i].openTag(o,a),d=r[i].closeTag(o,a);return r[i].displayContent===!1&&(a=""),l+a+d};return m.tags=function(){return r},m.addTags=function(t){var i;for(i in t)r[i]=t[i];e()},m.process=function(e){var i={html:"",error:!1},n=[];for(e.text=e.text.replace(/</g,"&lt;"),e.text=e.text.replace(/>/g,"&gt;"),e.text=e.text.replace(h,function(e,t,i,n){return"<"+i+">"}),e.text=e.text.replace(p,function(e,t,i,n){return"<"+i+">"}),e.text=e.text.replace(/\[/g,"&#91;"),e.text=e.text.replace(/\]/g,"&#93;"),e.text=e.text.replace(/</g,"["),e.text=e.text.replace(/>/g,"]");e.text!==(e.text=e.text.replace(u,function(e,t,i,n){return n=n.replace(/\[/g,"&#91;"),n=n.replace(/\]/g,"&#93;"),i=i||"",n=n||"","["+t+i+"]"+n+"[/"+t+"]"})););return e.text=s(e.text),e.text=a(e.text),n=t("bbcode",e.text,-1,"","",e.text),i.html=o(e),i.html.indexOf("[")===-1&&i.html.indexOf("]")===-1||n.push("Some tags appear to be misaligned."),e.removeMisalignedTags&&(i.html=i.html.replace(/\[.*?\]/g,"")),e.addInLineBreaks&&(i.html='<div style="white-space:pre;">'+i.html+"</div>"),i.html=i.html.replace("&#91;","["),i.html=i.html.replace("&#93;","]"),i.html=i.html.replace(/&lt;/g,"<"),i.html=i.html.replace(/&gt;/g,">"),i.error=0!==n.length,i.errorQueue=n,i},m}();e.exports=i},function(e,t){e.exports={fr:{facebookPageId:"DOFUSTouch",facebookPageNumericId:"1663041913975144",twitterAccountId:"DofusTouch",discordGroupId:"K93B4xW"},en:{facebookPageId:"DOFUSTouch",facebookPageNumericId:"1663041913975144",twitterAccountId:"DOFUSTouch_EN",discordGroupId:"K93B4xW"},fallbackLanguage:"en"}},function(e,t,i){function n(){s.call(this,"div",{className:"splashScreen",hidden:!0}),this.once("show",n.prototype._createContent);var e=this;window.gui.on("connected",function(){e.hide()})}i(1173);var o=i(172).inherits,s=i(321);o(n,s),e.exports=n,n.prototype._createContent=function(){this.log=this.createChild("div",{className:"logBox"}),this.createChild("div",{className:"dofusLogo"}),this.createChild("div",{className:["spinner","splashSpinner"]})},n.prototype.showMessage=function(e){this.log.setText(e)}},function(e,t){},function(e,t,i){function n(){function e(){var e=m.getValue();M.disable(),b.disable(),v.setText(l("ui.common.waiting")),v.delClassNames("error"),window.dofus.sendMessage("NicknameChoiceRequestMessage",{nickname:e})}function t(){m.getValue().length<3||!f.isActivate()?M.disable():M.enable()}function i(){h.openUrlInAppBrowser(this.link)}s.call(this,{className:"NicknameWindow",title:"",positionInfo:{left:"c",top:"c",width:500,height:355},noCloseButton:!0});var n=this,o=this.windowBody,d=o.createChild("div",{className:"description"}),m=o.appendChild(new r({className:"nickname",attr:{maxlength:29}})),f=o.appendChild(new u),g=o.appendChild(new c({className:"link"})),_=o.appendChild(new c({className:"link"})),v=o.createChild("div",{className:"info"}),y=o.createChild("div",{className:"buttonContainer"}),b=y.appendChild(new c.DofusButton),M=y.appendChild(new c.DofusButton);g.on("tap",i),_.on("tap",i),this.once("open",function(){m.on("change",t),f.on("change",t),m.on("validate",function(){M.tap()}),M.on("tap",e),b.on("tap",function(){window.dofus.disconnect(),a.close(n.id)}),window.gui.on("NicknameRefusedMessage",function(e){v.setText(l(p[e.reason])),v.addClassNames("error"),M.enable(),b.enable()}),window.gui.on("NicknameAcceptedMessage",function(){n.close()})}),this.on("open",function(){n.setTitle(l("ui.pseudoChoice.title")),d.setText(l("ui.pseudoChoice.help")),M.disable(),b.enable(),b.setText(l("ui.common.cancel")),M.setText(l("ui.common.validation")),f.setText(l("tablet.legals.accept")),g.setText(l("tablet.legals.tou")),g.link=l("tablet.legals.link.tou"),_.setText(l("tablet.legals.gcs")),_.link=l("tablet.legals.link.gcs"),m.focus()}),this.on("close",function(){v.setText(""),v.delClassNames("error"),m.setValue(""),m.blur()})}i(1175);var o=i(172).inherits,s=i(541),a=i(194),r=i(530),l=i(29).getText,c=i(335),d=i(1176),u=i(612),h=i(339),p={};p[d.ALREADY_USED]="ui.nickname.alreadyUsed",p[d.SAME_AS_LOGIN]="ui.nickname.equalsLogin",p[d.TOO_SIMILAR_TO_LOGIN]="ui.nickname.similarToLogin",p[d.INVALID_NICK]="ui.nickname.invalid",p[d.UNKNOWN_NICK_ERROR]="ui.nickname.unknown",o(n,s),e.exports=n},function(e,t){},function(e,t){e.exports={ALREADY_USED:1,SAME_AS_LOGIN:2,TOO_SIMILAR_TO_LOGIN:3,INVALID_NICK:4,UNKNOWN_NICK_ERROR:99}},function(e,t,i){function n(){function e(e,t){h.series([function(e){return v?e():void d.createGuest(function(t,i){return t?e(t.error):(v=i,void e())})},function(t){e.guestLogin=v.login,e.guestPassword=v.password,d.validateGuest(e,t)}],function(i){t(i,{login:e.login,password:e.password})})}function t(){I.getValue().length&&E.getValue().length&&N.getValue().length&&E.getValue()===N.getValue()&&/.+@.+\..+/.test(O.getValue())&&R.getValue().length&&B.isActivate()?j.enable():j.disable()}function i(){var e=!E.getValue().length,t=!N.getValue().length,i=E.getValue()===N.getValue();e||t||i?(F.delClassNames("error"),F.setText("")):(F.addClassNames("error"),F.setText(r("tablet.register.confirmpwdNotSame")))}function n(){f.openUrlInAppBrowser(this.link)}function o(e){if(e){for(var t=H.getChildren(),i=0;i<g;i++)t[i+1].setText((i>0?", ":"")+e[i]);H.addClassNames("visible")}}var _=m.screenHeight>655;s.call(this,{className:"RegisterWindow",title:"",positionInfo:{left:"c",top:"c",width:450,height:_?640:550,isFullScreen:!0},noCloseButton:!0}),_&&this.addClassNames("large");var v,y,b=this,M=this.windowBody,w=function(){},T=w,C=M.createChild("div",{className:"formWrapper"}),A=C.createChild("label",{className:"label"}),I=C.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"text",maxlength:19}}));I.on("validate",function(){E.focus()});var S=C.createChild("label",{className:"label"}),E=C.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"password",maxlength:49}})),x=C.createChild("label",{className:"label"}),N=C.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"password",maxlength:49}})),L=C.createChild("label",{className:"label"}),O=C.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"email"}})),D=C.createChild("label",{className:"label"}),R=C.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"text",maxlength:29}})),P=C.createChild("div",{className:"touWrapper"}),B=P.appendChild(new u);P.createChild("span",{text:" ("});var k=P.appendChild(new l({className:"link"}));P.createChild("span",{text:", "});var z=P.appendChild(new l({className:"link"}));P.createChild("span",{text:")"});for(var F=M.createChild("div",{className:"info"}),H=M.createChild("div",{className:"suggestion"}),q=H.createChild("label",{className:"label"}),W=0;W<g;W++)H.createChild("span",{className:"set"});var U=M.createChild("div",{className:"buttonContainer"}),G=U.appendChild(new c);G.addClassNames("cancel");var j=U.appendChild(new c);I.on("change",t),E.on("change",t),N.on("change",t),O.on("change",t),R.on("change",t),B.on("change",t),N.on("change",function(){window.clearTimeout(y),y=window.setTimeout(i,1e3)}),I.on("validate",function(){E.focus()}),E.on("validate",function(){N.focus()}),N.on("validate",function(){O.focus()}),O.on("validate",function(){R.focus()}),R.on("validate",function(){j.tap()}),k.on("tap",n),z.on("tap",n),j.on("tap",function(){G.disable(),j.disable(),F.setText(r("ui.common.waiting")),H.delClassNames("visible"),F.delClassNames("error");var t={login:I.getValue(),password:E.getValue(),email:O.getValue(),nickname:R.getValue()};v&&(t.guestLogin=v.login,t.guestPassword=v.password),e(t,function(e,t){return G.enable(),j.enable(),e?e._statusCode>=600?(F.addClassNames("error"),F.setText(e.text),void o(e.suggests)):(window.gui.openSimplePopup(r("ui.secureMode.error.default")),console.error("RegisterWindow haapiCall",e)):b.close(t)})}),G.on("tap",function(){b.close()}),this.on("open",function(e){T=e.onValidate,v=e.guestAccount,j.disable(),G.enable(),A.setText(r("tablet.login.username")),S.setText(r("ui.login.password")),L.setText(r("tablet.register.email")),x.setText(r("tablet.register.confirmpwd")),D.setText(r("tablet.login.pseudo")),B.setText(r("tablet.legals.accept")),k.setText(r("tablet.legals.tou")),k.link=r("tablet.legals.link.tou"),z.setText(r("tablet.legals.gcs")),z.link=r("tablet.legals.link.gcs"),G.setText(r("ui.common.cancel")),j.setText(r("ui.common.validation")),q.setText(r("tablet.register.suggestion")),p.setAutomaticHide(!1),v?b.setTitle(r("tablet.oldGuest.register")):b.setTitle(r("ui.login.createAccount"))}),this.on("opened",function(){I.focus()}),this.on("close",function(e){I.setValue(""),E.setValue(""),O.setValue(""),N.setValue(""),R.setValue(""),R.enable(),F.setText(""),F.delClassNames("error"),H.delClassNames("visible"),p.setAutomaticHide(!0),v=null,window.clearTimeout(y),T(e),T=w})}i(1178);var o=i(172).inherits,s=i(541),a=i(530),r=i(29).getText,l=i(335),c=l.DofusButton,d=i(205),u=i(612),h=i(31),p=i(435),m=i(166).dimensions,f=i(339),g=3;o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){if(!navigator.connection)return!1;var e=navigator.connection.type;return e===window.Connection.WIFI}function o(e){var t=this;e=e||{className:"preloadMapWindow",customClose:!0,positionInfo:{left:"c",top:"c",width:700,height:460,isModal:!0}},A.call(this,e),this._clearState(),this.closeButton.on("tap",function(){t._tryClose()});var i=this._mapPreloader=new b;i.on("step",function(e){t._updateState({progress:e.percent,downloadEstimate:{count:e.count,nbTotalMaps:e.nbTotalMaps,secondLeft:e.secondLeft}})}),i.on("error",function(e){console.error(e),t._updateState({currentScreen:E.ERROR})}),i.on("end",function(){t._updateState({currentScreen:E.DOWNLOAD_DONE})}),i.on("stop",function(){var e=t._state.currentScreen;e===E.DOWNLOAD_STOP&&t._tryClose()}),this.on("open",function(){M.start();var e=!!t.windowBody.getChildCount();e||t._createDom(),t._clearState(),t._updateState({isWiFiActivated:n(),currentScreen:E.DISCLAIMER}),t.startWifiCheckTimeout()}),this.on("close",function(){M.stop(),t.stopWifiCheckTimeout()});var o=window.gui;o.on("appGoBackground",function(){var e=t._state.currentScreen;e===E.DOWNLOAD_ACTIVE&&i.stop()}),o.on("appLeaveBackground",function(){var e=t._state.currentScreen;e===E.DOWNLOAD_ACTIVE&&i.restart()})}function s(e){this._state.isWiFiActivated=e,this._wifiState.toggleClassName("on",!!e),this._updateWifiStateText(e)}function a(e){switch(this._updateState({previousScreen:this._state.currentScreen}),this._state.currentScreen=e,this._hideAll(),this.closeButton.enable(),e){case E.DISCLAIMER:this._advice.show(),this._wifiState.show(),this._disclaimerText.show(),this._downloadButton.show(),this._downloadButton.enable(),this._cancelButton.show();break;case E.DOWNLOAD_PREPARE:this._downloading.show(),this._checkingAssetsText.show(),this._downloadWifiState.show(),this._progressBar.show(),this._stopButton.show(),this._stopButton.enable(),this._checkAssetsVersion();break;case E.DOWNLOAD_STOP:this.closeButton.disable(),this._downloading.show(),this._stoppingDownload.show(),this._downloadWifiState.show(),this._progressBar.show(),this._stopButton.show(),this._stopButton.disable();break;case E.DOWNLOAD_ACTIVE:this._downloading.show(),this._downloadEstimate.show(),this._downloadWifiState.show(),this._progressBar.show(),this._stopButton.show(),this._stopButton.enable(),this._state.hasStartedDownloading?this._retryDownloading():this._startDownloading();break;case E.DOWNLOAD_DONE:this._downloaded.show(),this._downloadEstimate.show(),this._downloadWifiState.show(),this._progressBar.show(),this._continueButton.show();break;case E.ERROR:this._downloading.show(),this._downloadError.show(),this._retryButton.show(),this._retryButton.enable(),this._cancelButton.show()}}function r(e){this._state.previousScreen=e}function l(e){this._state.progress=e,this._progressBar.setValue(e)}function c(e){if(!e&&0!==e)return v("tablet.common.computingTimeLeft");var t=[],i=Math.floor(e/N)%L;i&&t.push(i+" "+v("ui.time.minutes",i));var n=Math.floor(e/O);if(n)t.unshift(n+" "+v("ui.time.hours",n));else{var o=(e<0?0:e)%N;t.push(o+" "+v("ui.time.seconds",o))}return v("tablet.common.endsIn",t.join(" "))}function d(e,t){return t||(t="?"),v("tablet.common.mapsPlural",e+"/"+t)}function u(e){this._state.downloadEstimate=e;var t,i=e.count,n=e.nbTotalMaps;t=i===n?v("tablet.common.done"):c(e.secondLeft);var o=d(i,n);this._downloadEstimate.setText(v("tablet.common.hyphenSeparation",t,o))}function h(e){this._state.hasStartedDownloading=e}function p(e){this._state.wifiCheckTimeout&&(this._state.wifiCheckTimeout=window.clearTimeout(this._state.wifiCheckTimeout)),this._state.wifiCheckTimeout=e}function m(e){return e.json()}function f(e,t){var i=window.Config.dataUrl+"/assetsVersions.json?"+T.stringify(e);window.fetch(i).then(m).then(function(e){t(null,e)})["catch"](t)}i(1180);var g=i(309),_=i(335),v=i(29).getText,y=i(172).inherits,b=i(812),M=i(310),w=i(557),T=i(38),C=i(30),A=i(541),I=i(167).TOTAL_MAP_ASSETS_SIZE_IN_GB,S=1e4,E={DISCLAIMER:0,DOWNLOAD_PREPARE:1,DOWNLOAD_ACTIVE:2,DOWNLOAD_STOP:3,DOWNLOAD_DONE:4,ERROR:5};y(o,A),e.exports=o,o.prototype._clearState=function(){this._state={currentScreen:null,downloadEstimate:null,hasStartedDownloading:!1,isWiFiActivated:!1,previousScreen:null,progress:0,wifiCheckTimeout:null}},o.prototype.freeContent=function(){this._advice=null,this._wifiState=null,this._disclaimerText=null,this._downloading=null,this._downloadingFirstLine=null,this._downloadingSecondLine=null,this._downloaded=null,this._downloadError=null,this._checkingAssetsText=null,this._stoppingDownload=null,this._downloadEstimate=null,this._downloadWifiState=null,this._progressBar=null,this._downloadButton=null,this._cancelButton=null,this._stopButton=null,this._continueButton=null,this._retryButton=null,this.windowBody.clearContent()},o.prototype._createDom=function(){var e=this,t=this.windowBody;t.createChild("div",{className:"screenshot"}),this._advice=t.createChild("div",{className:"advice"});var i=t.createChild("div",{className:"disclaimer"});this._wifiState=i.createChild("div",{className:"wifiState"}),this._disclaimerText=i.createChild("div",{className:"disclaimerText"}),this._downloading=t.createChild("div",{className:"downloading"}),this._downloadingFirstLine=this._downloading.createChild("div"),this._downloadingSecondLine=this._downloading.createChild("div",{className:"redLine"}),this._downloaded=t.createChild("div",{className:"downloaded"}),this._downloadError=t.createChild("div",{className:"downloadError"});var n=t.createChild("div",{className:"preloadBarBlock"});this._checkingAssetsText=n.createChild("div"),this._stoppingDownload=n.createChild("div"),this._downloadEstimate=n.createChild("div"),this._downloadWifiState=n.createChild("div",{className:"downloadWifiState"}),this._progressBar=n.appendChild(new w({className:["green"],epsilon:0}));var o=t.createChild("div",{className:"buttonContainer"});this._downloadButton=o.appendChild(new _({className:["greenButton"]},function(){e._downloadButton.disable(),e._updateState({currentScreen:E.DOWNLOAD_PREPARE})})),this._retryButton=o.appendChild(new _({className:["greenButton"]},function(){e._retryButton.disable(),e._updateState({currentScreen:e._state.previousScreen})})),this._cancelButton=o.appendChild(new _({className:["greenButton","greyButton"]},function(){e._tryClose()})),this._stopButton=o.appendChild(new _({className:["greenButton","greyButton"]},function(){e._stopButton.disable(),e._tryClose()})),this._continueButton=o.appendChild(new _({className:["greenButton"]},function(){e._tryClose()})),this._updateText(this._state.isWiFiActivated)},o.prototype._hideAll=function(){this._advice.hide(),this._wifiState.hide(),this._disclaimerText.hide(),this._downloading.hide(),this._downloaded.hide(),this._downloadError.hide(),this._checkingAssetsText.hide(),this._stoppingDownload.hide(),this._downloadEstimate.hide(),this._downloadWifiState.hide(),this._progressBar.hide(),this._downloadButton.hide(),this._cancelButton.hide(),this._stopButton.hide(),this._continueButton.hide(),this._retryButton.hide()};var x={currentScreen:a,downloadEstimate:u,hasStartedDownloading:h,isWiFiActivated:s,previousScreen:r,progress:l,wifiCheckTimeout:p};o.prototype._updateState=function(e){for(var t in e){var i=x[t];i&&this._state[t]!==e[t]&&i.call(this,e[t])}};var N=60,L=60,O=L*N;o.prototype.startWifiCheckTimeout=function(){var e=this,t=window.setTimeout(function(){e._updateState({isWiFiActivated:n()}),e.startWifiCheckTimeout()},S);this._updateState({wifiCheckTimeout:t})},o.prototype.stopWifiCheckTimeout=function(){this._updateState({wifiCheckTimeout:null})},o.prototype._updateText=function(e){this.setTitle(v("tablet.preload.title"));var t=v("tablet.common.acronymGigabytes",I);this._advice.setText(v("tablet.preload.advice",t)),this._disclaimerText.setText(v("tablet.preload.disclaimer")),this._downloadingFirstLine.setText(v("tablet.preload.downloading")),this._downloadingSecondLine.setText(v("tablet.preload.downloadingWarning")),this._downloaded.setText(v("tablet.preload.done")),this._downloadError.setText(v("tablet.preload.error")),this._checkingAssetsText.setText(v("tablet.preload.checkingAssets")),
this._stoppingDownload.setText(v("tablet.common.stopping")),this._downloadButton.setText(v("tablet.common.downloadSize",t)),this._cancelButton.setText(v("ui.common.cancel")),this._stopButton.setText(v("tablet.common.stop")),this._continueButton.setText(v("tablet.common.continue")),this._retryButton.setText(v("tablet.common.retry")),this._updateWifiStateText(e)},o.prototype._updateWifiStateText=function(e){var t=v(e?"tablet.common.activated":"tablet.common.deactivated");this._wifiState.setText(t);var i=e?'<span class="on">'+t+"</span>":t;this._downloadWifiState.setHtml(v("tablet.common.wifiState",i))},o.prototype._tryClose=function(){var e=this._state.currentScreen;return e===E.DOWNLOAD_PREPARE?this._updateState({currentScreen:E.DOWNLOAD_STOP}):e===E.DOWNLOAD_ACTIVE?(this._updateState({currentScreen:E.DOWNLOAD_STOP}),this._mapPreloader.stop()):void this.close()},o.prototype._hasStopped=function(){return this._state.currentScreen===E.DOWNLOAD_STOP},o.prototype._checkAssetsVersion=function(){function e(e){console.error(e),t._updateState({currentScreen:E.ERROR})}var t=this;this._updateState({progress:0}),g.getVersions(function(i,n){return i?e(i):t._hasStopped()?t._tryClose():(t._updateState({progress:.33}),void f(n,function(i,n){return i?e(i):t._hasStopped()?t._tryClose():(t._updateState({progress:.67}),void g.upgradeAssets(n,function(i){return i?e(i):t._hasStopped()?t._tryClose():void t._updateState({progress:1,currentScreen:E.DOWNLOAD_ACTIVE})}))}))})},o.prototype._startDownloading=function(){var e=this;e._updateState({hasStartedDownloading:!0,progress:0,downloadEstimate:{count:0}}),C.getAllDataMap("Areas",function(t,i){if(t)return console.error(t);if(e._hasStopped())return e._tryClose();var n=[];for(var o in i)n.push(i[o].id);e._mapPreloader.preloadAreas(n)})},o.prototype._retryDownloading=function(){this._mapPreloader.restart()}},function(e,t){},function(e,t,i){function n(){c.call(this,{className:"connectionQueueWindow",positionInfo:{left:"c",top:"c",width:600,height:200},noCloseButton:!0}),this.once("open",this._createContent),this._setupEventListeners()}function o(){var e=window.gui.serversData;return e?e.connectedServerData:null}i(1182);var s=i(335).DofusButton,a=i(29).getText,r=i(172).inherits,l=i(204),c=i(541),d=i(194);r(n,c),e.exports=n,n.prototype._setupEventListeners=function(){var e=this;window.dofus.connectionManager.on("LoginQueueStatusMessage",function(t){e._queueStatusUpdate("login",t.position,t.total)}),window.dofus.connectionManager.on("QueueStatusMessage",function(t){e._queueStatusUpdate("game",t.position,t.total)})},n.prototype._createContent=function(){this.windowTitle.setText(a("ui.queue.wait"));var e=this.windowBody.createChild("div",{className:"messageBox"});this.message=e.createChild("div",{className:"message"});var t=this.windowBody.createChild("div",{className:"buttonContainer"}),i=t.appendChild(new s(a("ui.queue.back"))),n=this;i.on("tap",function(){return o()?(l.goBackToSelectionOf("server"),void d.close(n.id)):window.dofus.disconnect()})},n.prototype._queueStatusUpdate=function(e,t,i){if(0===t)return d.close(this.id);d.open(this.id);var n=a("ui.queue.number",t,i),s=o();s&&(n+="\n\n"+a("ui.queue.server",s._name)),this.message.setText(n)}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"popupWindow",title:"Popup",customClose:!0,positionInfo:{left:"c",bottom:"c",width:600,height:210}}),this.messageStack=[]}i(1184);var o=i(172).inherits,s=i(541),a=i(194),r=i(335).DofusButton,l=i(29).getText,c=i(339);o(n,s),e.exports=n,n.prototype._createContent=function(){function e(){return t.messageStack.shift(),0===t.messageStack.length?void a.close(t.id):void t._update()}var t=this,i=this.windowBody.createChild("div",{className:"messageBox"});this.message=i.createChild("div",{className:"message"});var n=this.windowBody.createChild("div",{className:"buttonContainer"}),o=n.appendChild(new r(l("ui.common.ok")));o.on("tap",e),this.closeButton.on("tap",e)},n.prototype._update=function(){this.message||this._createContent();var e=this.messageStack[0],t=e.message.split("<br>").length<=2?"center":"left";this.message.setStyle("text-align",t),this.message.setHtml(e.message),c.allLinksOnTargetBlank(this.message),this.windowTitle.setText(e.title)},n.prototype.addContent=function(e){var t=this.messageStack;t.length&&t[t.length-1].message===e.message||(t.push(e),1===t.length&&this._update())}},function(e,t){},function(e,t){var i=0,n=!1,o=function(e){for(var t=e.target;t!==document.body;){var n=window.getComputedStyle(t),o=n.getPropertyValue("-webkit-overflow-scrolling"),s=n.getPropertyValue("overflow-y"),a=parseInt(n.getPropertyValue("height"),10),r="touch"===o&&("auto"===s||"scroll"===s),l=t.scrollHeight>t.offsetHeight;if(r&&l){var c=e.touches?e.touches[0].screenY:e.screenY,d=i<=c&&0===t.scrollTop,u=i>=c&&t.scrollHeight-t.scrollTop===a;return void((d||u)&&e.preventDefault())}t=t.parentNode}e.preventDefault()},s=function(e){i=e.touches?e.touches[0].screenY:e.screenY},a=function(){window.addEventListener("touchstart",s,!1),window.addEventListener("touchmove",o,!1),n=!0},r=function(){window.removeEventListener("touchstart",s,!1),window.removeEventListener("touchmove",o,!1),n=!1},l=function(){return n},c=document.createElement("div");document.documentElement.appendChild(c),c.style.WebkitOverflowScrolling="touch";var d="touch"===window.getComputedStyle(c)["-webkit-overflow-scrolling"];document.documentElement.removeChild(c),d&&a();var u={enable:a,disable:r,isEnabled:l};e.exports=u},function(e,t,i){i(1187),i(1225),i(1228),i(1231),i(1233),i(1234),i(1235),i(1236),e.exports=i(1188)},function(e,t,i){var n=i(1188),o=i(793),s=o.compressPath,a=i(194),r=i(29).getText,l=i(202),c=i(258),d=3e3,u=1e3;n.prototype.onArrived=function(e){if(window.dofus.sendMessage("GameMapMovementConfirmMessage",null),this.mapRenderer.removeMovementFeedback(),this.endMovementCallback){var t=this.endMovementCallback;this.endMovementCallback=null,t(null,e)}},n.prototype.cancelUserActorMovement=function(e){if(this.isMovementWaitingForConfirmation)return this.lastMoveRequestTime&&!a.isDialogActive()&&Date.now()-this.lastMoveRequestTime>u&&window.gui.connectionSplashScreen.onStateChange("UNSTABLE"),this.endMovementCallback=e,void(this.isMovementCanceled=!0);this.isMovementCanceled=!1;var t=this.actorManager.userActor;return t.moving?(this.mapRenderer.removeMovementFeedback(),this.endMovementCallback=null,void t.cancelMovement(e)):(this.endMovementCallback=e,this.onArrived())},n.prototype.cancelMoveAndDo=function(e){this.actorManager.userActor.moving||this.isMovementWaitingForConfirmation?this.cancelUserActorMovement(e):e()},n.prototype.roleplayUserActorMovement=function(e){var t=e[e.length-1],i=this.actorManager.userActor;if(this.isMovementWaitingForConfirmation=!1,window.gui.connectionSplashScreen.onStateChange("CONNECTED"),window.gui.emit("checkServerLag","roleplayUserActorMovement","stop"),this.isMovementCanceled)return this.cancelUserActorMovement(this.endMovementCallback);if(!i.moving){for(var n=null,o=0;o<e.length;o++)if(e[o]===i.cellId){n=o;break}if(null===n)return i.cellId!==t&&i.setDisposition(t),this.onArrived(t);if(i.cellId===t)return i.setDisposition(t),this.onArrived(t);var s=e.slice(n);i.setPath(s),i.setCellPosition(s[s.length-1])}this.removeAllListeners("arrived"),this.once("arrived",this.onArrived);var a=[];if(!i.isPathMatchingServerPath(e,a)){if(0!==a.length){this.endMovementCallback=null;var r=this;return i.switchPath(a,function(){r.emit("arrived",t)})}return i.noMovement(),i.setDisposition(t),this.endMovementCallback=null,this.onArrived(t)}},n.prototype._movePlayerOnMap=function(e,t,i){if(i&&"function"==typeof i||(i=function(){}),window.gui.playerData.inventory.isOverloaded()&&!window.gui.playerData.isMutant())return void window.gui.chat.logMsg(r("tablet.inventoryFullCannotMove"));t=t||!1;var n=this.actorManager.userActor,a=n.cellId;if(a===e)return i(null,e),e;var l=this.mapRenderer.map,c=this.actorManager.occupiedCells,d=n.canMoveDiagonally,u=o.getPath(a,e,c,d,t);if(u.length<=1)return i(new Error("_movePlayerOnMap noPath:"+a+":"+e)),null;this.isMovementWaitingForConfirmation=!0,this.lastMoveRequestTime=Date.now(),window.gui.emit("checkServerLag","roleplayUserActorMovement","start"),window.dofus.sendMessage("GameMapMovementRequestMessage",{keyMovements:s(u),mapId:l.id});var h=u[u.length-1],p=this;this.mapRenderer.addMovementFeedback(h),this.endMovementCallback=i,n.setPath(u,{cb:function(){p.emit("arrived",h)}});var m=this.mapScene.camera;return m.setAcceleration(1),n.pathTween.removeOnUpdate(),n.onMovementUpdate=function(){m.moveTo(n.x,n.y)},n.pathTween.onUpdate(n.onMovementUpdate),this.userPreviousPosition=n.cellId,n.setCellPosition(h),h},n.prototype.cancelCameraMovement=function(){var e=this.actorManager.userActor;e.pathTween.removeOnUpdate(e.onMovementUpdate)},n.prototype.noMovement=function(){c.isFightMode||(console.warn("[ISO ENGINE] previous movement request has been refused, canceling movement"),this.onQuickReconnection())},n.prototype.getChangeMapCellAt=function(e,t,i){var n=this.mapScene.convertCanvasToSceneCoordinate(e,t);if(!this.mapRenderer.isReady)return-1;var o=this.mapRenderer.getCellId(n.x,n.y);return this.mapRenderer.getChangeMapFlags(o.cell)[i]?o.cell:-1},n.prototype._requestMapChange=function(e,t){window.foreground.lock("loadMap"),window.dofus.sendMessage("ChangeMapMessage",{mapId:e}),this.launchMapTransition(t);var i=this;this.changeMapTimeout=window.setTimeout(function(){l.unlockMessages(),i.changeMapTimeout=null;var e=window.foreground;e.unlock("loadMap"),e.hideBorderArrow(),i.cancelMapTransition(t)},d)},n.prototype.gotoNeighbourMap=function(e,t,i,n){function o(i,n){i||n!==t||s._requestMapChange(s.mapRenderer.map[e+"NeighbourId"],e)}var s=this;if(this.actorManager.userActor.moving)return this.cancelUserActorMovement(function(){s.gotoNeighbourMap(e,t,i,n)});var a=window.gui.tutorialManager;if(!a.inTutorial||a.isChangingMap){var r=this._movePlayerOnMap(t,!1,o);r===t&&window.foreground.showBorderArrow(e,i,n)}},n.prototype.clearPendingMovement=function(){this.isMovementWaitingForConfirmation=!1,this.endMovementCallback=null,this.isMovementCanceled=!1}},function(e,t,i){function n(){s.call(this);var e=document.createElement("canvas");e.id="engineCanvas";var t=document.getElementById("dofusBody");t.appendChild(e),this.mapScene=new l({canvas:e,name:"mapScene",l:-a.HORIZONTAL_OFFSET,t:-a.VERTICAL_OFFSET,w:a.MAP_SCENE_WIDTH,h:a.MAP_SCENE_HEIGHT,canvasWidth:0,canvasHeight:0,maxZoom:a.MAX_ZOOM_MAP,pixelRatio:a.PIXEL_RATIO,textureRatio:a.PRERENDER_RATIO_MAP,cameraAcceleration:1.15,nbCacheableSprites:a.MAX_SPRITES_BUFFER_MAP,textureMemoryCacheSize:a.MAX_TEXTURE_MEMORY_MAP,prerenderQualityRatio:a.PRERENDER_RATIO_MAP,adjustToCanvasRatio:!0,usePrecisionRendering:!0});var i={scene:this.mapScene,layer:a.MAP_LAYER_BACKGROUND,position:-1,x:-a.HORIZONTAL_OFFSET,y:-a.VERTICAL_OFFSET,w:a.MAP_SCENE_WIDTH,h:a.MAP_SCENE_HEIGHT,id:"mapBackground"};this.renderer=this.mapScene.renderer,this.background=new d(i),this.actorManager=new u({isoEngine:this,scene:this.mapScene}),this.mapRenderer=new c(this.mapScene,this.background),this.highlightedElements={},this.isInGame=!1,this.isMovementWaitingForConfirmation=!1,this.endMovementCallback=null,this.isMovementCanceled=!1,this.actionQueue=new g,this.lastContextualMenuSkillId=null,r.start(),this.mapScene.camera.setZoom(0),this._initGridOverlayLayers(),this._previousTurn=!1,this._isUserTurn=!1;var n=this,o=this.background;this.on("GameFightStartMessage",function(){n._resetFightPositionLayer()}),this.on("GameFightEndMessage",function(){n._resetFightPositionLayer(),n._resetSpellRangeLayer(),n._resetSpellEffectLayer(),n._resetWalkLayer(),n._resetWalkAreaLayer(),n._resetEnemyWalkAreaLayer(),o.removeTargetHighlights(),window.foreground.confirmBox.close(),this._isUserTurn=!1}),v.on("gameContextChanged",this.onGameContextChanged.bind(this)),this._initLoadingProgress(),this.bitmapFonts=null,this._currentBannerTweens={backTween:null,textTween:null}}var o=i(172).inherits,s=i(188).EventEmitter,a=i(167),r=i(1007),l=i(1003),c=i(1189),d=i(1199),u=i(1206),h=i(1209),p=i(381),m=i(194),f=i(424),g=i(1224),_=i(202),v=i(258);o(n,s),e.exports=n,n.prototype._loadBitmapFonts=function(){if(null===this.bitmapFonts){var e=this;f.loadModel("bitmapFonts","atlas",function(t,i){var n=e.mapScene.createTexture(i,"atlas","mimap","permanent");e.bitmapFonts={characters:{dimensions:t.characters,texture:n},numbers:{dimensions:t.numbers,texture:n}}})}},n.prototype.initialize=function(e){e.config&&(window.Config=e.config,h.initialize(this),this.mapRenderer.initialize(),this.actionQueue.initialize(),p.loadMissingTemplatesInfo(),this._loadBitmapFonts())},n.prototype._activateMapScene=function(){return this.isInGame===!1&&(r.addScene(this.mapScene),r.addScene(this.actorManager),this.isInGame=!0,!0)},n.prototype._deactivateMapScene=function(){return this.isInGame===!0&&(this.mapScene.clear(0,0,0,0),r.removeScene(this.mapScene),r.removeScene(this.actorManager),this.clearUserMovementZone(),this.background.resetAndClear(),this.releaseMap(),this.interactiveDisconnect(),this.isInGame=!1,!0)},n.prototype.disconnect=function(){_.unlockMessages(),this.emit("disconnect"),this._deactivateMapScene(),this.mapTransitionDisconnect(),this.background&&this.background.gridAnimator&&this.background.gridAnimator.clear(),this.clearPendingMovement(),this.actionQueue.clear(),this.actorManager.turnNicknamesOff()},n.prototype.transmitMessage=function(e){this.emit(e._messageType,e)},n.prototype.releaseMap=function(e){this.isInGame!==!1&&(v.isRoleplayMode&&this.actorManager.removeAllActors(),this.cleanupChallenges(),this.background.releaseMap(),this.mapRenderer.releaseMap(e),this.actionQueue.clear())},n.prototype.onGameContextChanged=function(){this.clearHighlights(),this.clearPendingMovement(),this.actionQueue.clear(),v.isFightMode?(this.cleanupChallenges(),r.removeScene(this.actorManager)):(r.addScene(this.actorManager),this.actorManager.userActor.show(),this.clearUserMovementZone(),this.background.deleteAllZones())},n.prototype.setInteractiveBlink=function(e){this.interactiveBlink=e},n.prototype._updateMapInfoData=function(e,t){this.mapRenderer.setStatedElements(e.statedElements),this.addChallenges(e.fights),this.mapRenderer.setInteractiveElements(e.interactiveElements),this.mapRenderer.updateObstacles(e.obstacles),t&&t.noMovementWaitReset||(this.isMovementWaitingForConfirmation=!1)},n.prototype.onQuickReconnection=function(e){if(!window.gui.isConnected)return e&&e();if(window.gui.playerData&&window.gui.playerData.isFighting)return e&&e();if(this.endMovementCallback=null,this.isMovementCanceled=!1,this.isMovementWaitingForConfirmation=!1,this.mapRenderer.removeMovementFeedback(),this.actionQueue.clear(),m.isDialogActive())return e&&e();window.foreground.lock("quickReconnection"),this.lastMoveRequestTime=null,this.actorManager.pause(),window.dofus.sendMessage("MapInformationsRequestMessage",{mapId:this.mapRenderer.mapId});var t=this;this.once("mapLoaded",function(){if(window.foreground.unlock("quickReconnection"),t.userPreviousPosition){var i=t.userPreviousPosition;window.dofus.sendMessage("GameMapMovementCancelMessage",{cellId:i});var n=t.actorManager.userActor;n.noMovement(),n.setDisposition(i,n.direction)}return t.actorManager.unpause(),e&&e()})},n.prototype.attackActor=function(e){var t=this.actorManager.actors,i=t[e];if(i){var n=i.cellId;this._movePlayerOnMap(n)}},n.prototype.updateDimensions=function(e){this.mapScene.setCanvasDimensions(e.mapWidth,e.mapHeight,e.mapLeft,e.mapTop,"absolute")&&this.mapScene.camera.setZoom(0),this.isInGame&&this.mapScene.requireCompleteRefresh()},n.prototype.useItem=function(e,t,i){var n=this.mapScene.convertCanvasToSceneCoordinate(e,t),o=this.mapRenderer.getCellId(n.x,n.y).cell,s=this.actorManager.occupiedCells[o];s&&s.length&&s[0].actorId>=0?window.dofus.sendMessage("ObjectUseOnCharacterMessage",{characterId:s[0].actorId,objectUID:i}):window.dofus.sendMessage("ObjectUseOnCellMessage",{cells:o,objectUID:i})},n.prototype.sendToFightSequence=function(e){this.emit(e._messageType,e)}},function(e,t,i){function n(e,t){s.call(this);var i=this;this.mapId=null,this.map=null,this.mapScene=e,this.background=t,this.grid=new o,y.on("gameContextChanged",this.onGameContextChanged.bind(this)),this.graphics=[],this.statedElements=[],this.interactiveElements={},this.identifiedElements={},this.objects={},this.animatedElements=[],this.paddockProperties=null,this.isReady=!1,v.on("PaddockPropertiesMessage",function(e){i.paddockProperties=e.properties})}var o=i(1190),s=i(188).EventEmitter,a=i(172).inherits,r=i(670),l=i(167),c=i(1191),d=i(384),u=i(673),h=i(1192),p=i(1193),m=i(1194),f=i(788),g=i(793),_=i(1195),v=i(202),y=i(258),b=i(1197),M=i(667),w=i(176),T=l.BACKGROUND_PATH,C=l.FOREGROUND_PATH,A={r:255,g:0,b:0,a:.75},I={r:0,g:0,b:0,a:1},S=1,E=2,x=52,N=-l.CELL_HEIGHT/4,L=131,O=14,D=56,R=224;a(n,s),e.exports=n,n.prototype.initialize=function(){f.initialize()},n.prototype.setMap=function(e,t){var i=e.mapData;this.map=i,this.mapId=i.id,this.grid.initialize(i.cells,y.isRoleplayMode),this.loadMap(e,t)},n.prototype.releaseMap=function(e){e!==this.mapId&&(this.mapScene.clean(),this.isReady=!1,this.graphics=[],this.statedElements=[],this.interactiveElements={},this.identifiedElements={},this.objects={},this.animatedElements=[],this.paddockProperties=null,this.mapId=null,this.map=null)},n.prototype.stopAnimatedElements=function(){for(var e=this.animatedElements,t=0;t<e.length;t++)e[t].stop()},n.prototype.startAnimatedElements=function(){for(var e=this.animatedElements,t=0;t<e.length;t++)e[t].animate()},n.prototype.loadMap=function(e,t){for(var i=e.mapData,n=e.msg,o={},s=n.statedElements,a=0;a<s.length;a++)o[s[a].elementId]=!0;this.graphics=[],this.statedElements=[],this.animatedElements=[];var r=new b(this,t);r.nAssetsToLoad+=1;var c=new h({id:"mapSceneStaticSprites"+this.mapId,scene:this.mapScene,holdsStatics:!0});this.graphics.push(c);var p=i.atlasLayout,m=p.graphicsPositions;r.loadAtlas(p,c);for(var f,g=i.midgroundLayer,_=Object.keys(g),v=0;v<_.length;v++)for(var A=_[v],I=g[A],S=0;S<I.length;S++){var E=I[S];E.position=parseInt(A,10),E.layer=l.MAP_LAYER_PLAYGROUND,E.scene=this.mapScene;var x=E.hue;if(x[0]=1+x[0]/127,x[1]=1+x[1]/127,x[2]=1+x[2]/127,x[3]=1,E.look)if(E.id&&o[E.id])f=r.loadStatedElement(E),this.statedElements.push(f);else{if(!E.anim){console.warn("[MapRenderer.loadMap] Animated Graphic skipped",E);continue}f=r.loadAnimatedGraphic(E),this.animatedElements.push(f),this.graphics.push(f)}else{if(!E.g){console.warn("[MapRenderer.loadMap] Element of unidentified type skipped",E);continue}f=c.addSprite(E,m[E.g])}f.id&&(this.identifiedElements[f.id]=f)}c.finalize(p.width,p.height);var N=this,L=T+i.id+".jpg";if(r.nAssetsToLoad+=1,d.loadTexture(L,function(e){N.background.updateMap(e),r.notifyAssetAsLoaded()},this.mapScene.renderer,"linear"),i.foreground){var O=new u({x:-l.HORIZONTAL_OFFSET,y:-l.VERTICAL_OFFSET,w:l.MAP_SCENE_WIDTH,h:l.MAP_SCENE_HEIGHT,scene:this.mapScene,layer:l.MAP_LAYER_FOREGROUND});this.graphics.push(O);var D=C+i.id+".png";r.nAssetsToLoad+=1,d.loadTexture(D,function(e){if("empty_texture"===e.id){O.remove();var t=N.graphics.indexOf(O);t!==-1&&N.graphics.splice(t,1)}else O.texture=e,O.forceRefresh();r.notifyAssetAsLoaded()},this.mapScene.renderer,"linear")}r.notifyAssetAsLoaded();var R=w.getValue("tacticModeEngaged",!1);R&&y.isFightMode&&M.turnOn()},n.prototype.onGameContextChanged=function(){this.removeMovementFeedback(),y.isFightMode?this.switchGameContextFight():this.switchGameContextRoleplay()},n.prototype.switchGameContextFight=function(){this.stopAnimatedElements();for(var e=0;e<this.statedElements.length;e++){var t=this.statedElements[e];t.changeState(1,!0)}for(var i in this.objects)this.objects[i].remove();this.objects={},this.map&&this.grid.initialize(this.map.cells,!1)},n.prototype.switchGameContextRoleplay=function(){this.startAnimatedElements(),this.map&&this.grid.initialize(this.map.cells,!0)},n.prototype.addObjects=function(e){if(!this.isReady){var t=this,i=this.mapId;return this.once("ready",function(){t.mapId===i&&t.addObjects(e)})}for(var n=0;n<e.length;n++){var o=e[n];if(o.img){var s=this.getCellSceneCoordinate(o.cellId);o.x=s.x-x/2,o.y=s.y-x/2+N,o.position=o.cellId,o.w=x,o.h=x,o.scene=this.mapScene;var a=this.mapScene.createTexture(o.img,"object:"+o.objectGID),r=new u(o,a);this.objects[o.cellId]=r}else console.error("createObjectGfx: no img for "+JSON.stringify(o))}},n.prototype.removeObjects=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=this.objects[i];n&&(n.remove(),delete this.objects[i])}},n.prototype.setInteractiveElements=function(e){this.interactiveElements={};for(var t=0,i=e.length;t<i;t++){var n=e[t];this.interactiveElements[n.elementId]=n}},n.prototype.updateInteractiveElements=function(e){for(var t=this.interactiveElements,i=0;i<e.length;i++){var n=e[i],o=t[n.elementId];o?(o.disabledSkills=n.disabledSkills,o.enabledSkills=n.enabledSkills):console.warn("Interactive element id "+n.elementId+" does not exist.")}},n.prototype.setStatedElements=function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t],o=this.identifiedElements[n.elementId];o?o instanceof c&&(y.isFightMode?(o.state=-1,o.changeState(1)):o.changeState?o.changeState(n.elementState):o.state=n.elementState):console.warn("stated element not identified:"+n.elementId+", cellId="+n.elementCellId)}},n.prototype.updateStatedElements=function(e){for(var t=this.identifiedElements,i=0,n=e.length;i<n;i++){var o=e[i],s=t[o.elementId];s?s.changeState?s.changeState(o.elementState):(console.warn("Identified element "+o.elementId+" is not a stated element."),s.state=o.elementState):console.warn("Identified element "+o.elementId+" not found.")}},n.prototype.getPaddockProperties=function(){return this.paddockProperties},n.prototype.isPaddock=function(e){var t=e.id;if(!t)return!1;var i=this.interactiveElements[t];return!!i&&i.elementTypeId===l.ELEMENT_TYPE_ID.PADDOCK},n.prototype.addArrowsOnCellsOneShot=function(e,t,i,n){for(var o=[],s=0;s<e.length;s++)o[s]=this.getCellSceneCoordinate(e[s]),o[s].x+=t||0,o[s].y+=i||0;p.addArrowsOneShot(o,e,n,this.mapScene)},n.prototype.addTapFeedback=function(e,t){f.addTapFeedback({x:e,y:t})},n.prototype.addMovementFeedback=function(e){var t=this.getCellSceneCoordinate(e);f.addMovementFeedback({x:t.x,y:t.y,position:e})},n.prototype.removeTapFeedback=function(){f.removeTapFeedback()},n.prototype.removeMovementFeedback=function(){f.removeMovementFeedback()},n.prototype.addArrowOnCell=function(e,t,i,n,o){var s=this.getCellSceneCoordinate(e);s.x+=t||0,s.y+=i||0,p.addArrow(s,e,n,this.mapScene,o)},n.prototype.addArrowOnGraphic=function(e,t,i,n,o){if(!e||!e.bbox)return console.warn("addArrowOnGraphic: invalid graphic entity");var s={x:(e.bbox[0]+e.bbox[1])/2+(t||0),y:(e.bbox[2]+e.bbox[3])/2+(i||0)};p.addArrow(s,null,n,this.mapScene,o)},n.prototype.addArrowsSequence=function(e,t,i,n){for(var o=[],s=0;s<e.length;s++)o[s]=this.getCellSceneCoordinate(e[s]),o[s].x+=t||0,o[s].y+=i||0;p.addArrowsSequence(o,e,n,this.mapScene)},n.prototype.removeArrows=function(){p.removeArrows()},n.prototype.addPingPictoOnCell=function(e,t,i){var n=this.getCellSceneCoordinate(t);m.addPingPicto(e,n,t,i)},n.prototype.removePingPicto=function(e){m.removePingPicto(e)},n.prototype.removeAllPingPictos=function(){m.removeAllPingPictos()},n.prototype.addCellHighlight=function(e,t,i,n){i=i||A,n=n||I;for(var o=0,s=t.length;o<s;o+=1){var a=t[o],r="rgba("+i.r+","+i.g+","+i.b+","+i.a+")",l="rgba("+n.r+","+n.g+","+n.b+","+n.a+")";window.background.addZone(new _([a],{color:r,outline:l}),e)}},n.prototype.deleteCellHighlight=function(e){window.background.deleteZoneById(e)},n.prototype.updateObstacles=function(e){if(!this.isReady){var t=this,i=this.mapId;return this.once("ready",function(){t.mapId===i&&t.updateObstacles(e)})}for(var n=this.map.cells,o=0,s=e.length;o<s;o++){var a=e[o],r=a.obstacleCellId,l=n[r],c=l.l;a.state===S?l.l|=1:a.state===E&&(l.l&=254),this.grid.updateCellState(r,l,c),g.updateCellPath(r,l)}},n.prototype.isWalkable=function(e){var t=y.isFightMode?5:1;return 1===(this.map.cells[e].l&t)},n.prototype.isFarmCell=function(e){return 32===(32&this.map.cells[e].l)},n.prototype.isVisibleCell=function(e){return 64===(64&this.map.cells[e].l)},n.prototype.getChangeMapFlags=function(e){var t=this.map.cells[e].c||0;return 0===t?{}:{left:t&D&&e%14===0,right:t&L&&e%14===13,top:t&R&&e<28,bottom:t&O&&e>531}},n.prototype.getFirstMapFlag=function(e){var t=this.getChangeMapFlags(e);return t.left?"left":t.right?"right":t.top?"top":t.bottom?"bottom":null},n.prototype.getCellId=function(e,t){return this.grid.getCellAtSceneCoordinate({x:e,y:t})},n.prototype.getCellSceneCoordinate=function(e){var t=r.getCellCoord(e);return this.isReady&&(t.y-=this.map.cells[e].f||0),t},n.prototype.hideStatedElements=function(){for(var e=0;e<this.statedElements.length;e++)this.statedElements[e].hide()},n.prototype.showStatedElements=function(){for(var e=0;e<this.statedElements.length;e++)this.statedElements[e].show()},n.prototype.hideGraphics=function(){for(var e=0;e<this.graphics.length;e++)this.graphics[e].hide()},n.prototype.showGraphics=function(){for(var e=0;e<this.graphics.length;e++)this.graphics[e].show()}},function(e,t,i){"use strict";function n(){this.cells=[],this.bounds=[],this.cellId=void 0}function o(){this.grid=[],this.scenePositions=[]}function s(e,t,i,n,o){for(var s=0;s<e.length;s+=1){var a=e[s],r=t[a],l=(r.x-i)*_,c=(r.y-n)*v,d=l*l+c*c;d<o.dist&&(o.dist=d,o.cell=a)}}function a(e,t){var i=e.cells.indexOf(t);i!==-1&&(e.cells.splice(i,1),e.bounds.splice(i,1))}var r=i(167),l=i(794),c=r.CELL_WIDTH,d=r.CELL_HEIGHT,u=r.HORIZONTAL_OFFSET-c,h=r.VERTICAL_OFFSET-d/2,p=19,m=p+.225,f=Math.sqrt(2),g=f/2,_=f/c,v=f/d,y=33,b=34,M=14,w=2*M;e.exports=o,o.prototype.getCoordinateGridFromCellId=function(e){var t=e%M-~~(e/w),i=t+p,n=t+~~(e/M);return{i:i,j:n}},o.prototype.getCoordinateCellIdFromGrid=function(e){return this.grid[e.i][e.j].cellId},o.prototype.getCoordinateGridFromScene=function(e){var t=(e.x-u)*_,i=(e.y-h)*v,n=g*t-g*i+m,o=g*t+g*i,s=Math.max(0,Math.min(y-1,~~n)),a=Math.max(0,Math.min(b-1,~~o));return{i:s,j:a,dx:n-s,dy:o-a}},o.prototype.getCoordinateSceneFromGrid=function(e){var t=e.i-m,i=e.j;return{x:(g*t+g*i)/_+c/2+u,y:(g*i-g*t)/v+h}},o.prototype.getSceneCoordinateFromCellId=function(e){return this.getCoordinateSceneFromGrid(this.getCoordinateGridFromCellId(e))},o.prototype.getCellAtSceneCoordinate=function(e){var t=this.getCoordinateGridFromScene(e),i=this.grid[t.i][t.j],n=i.cells;if(0===n.length)return this.getClosestCell(t,e);for(var o=t.dx,s=t.dy,a=i.bounds,r=0,l=a.length;r<l;r+=1){var c=a[r];if(c[0]<=o&&o<=c[1]&&c[2]<=s&&s<=c[3])return{cell:n[r],dist:0}}return this.getClosestCell(t,e)},o.prototype.getClosestCell=function(e,t){for(var i,n,o,a,r=e.i,l=e.j,c=t.x,d=t.y,u=0,h={cell:-1,dist:1/0};h.cell===-1;){for(o=Math.max(l-u,0),a=Math.min(l+u,b-1),n=Math.min(r+u,y-1),i=Math.max(r-u,0);i<=n;i+=1)s(this.grid[i][o].cells,this.scenePositions,c,d,h),s(this.grid[i][a].cells,this.scenePositions,c,d,h);for(i=Math.max(r-u,0),n=Math.min(r+u,y-1),a=Math.min(l+u-1,b-1),o=Math.max(l-u+1,0);o<=a;o+=1)s(this.grid[i][o].cells,this.scenePositions,c,d,h),s(this.grid[n][o].cells,this.scenePositions,c,d,h);u+=1}return h},o.prototype.getNearbyCellInZone=function(e,t,i,n){if(void 0!==n[e])return e;for(var o=null,s=[],a=l.getNeighbourCells(e,!0),r=0;r<a.length;r++)void 0!==a[r]&&void 0!==n[a[r]]&&s.push(a[r]);var c=1/0;for(r=0;r<s.length;r++){var d=s[r],u=this.scenePositions[d],h=(u.x-t)*_,p=(u.y-i)*v,m=h*h+p*p;m<c&&(c=m,o=d)}return o},o.prototype.updateCellState=function(e,t,i){var n=t.l;0===(1&n)?0!==(1&i)&&this._removeCell(e,t):0===(1&i)&&this._addCell(e,t)},o.prototype._removeCell=function(e,t){delete this.scenePositions[e];var i=this.useAltitude&&t.f||0,n=this.getCoordinateGridFromCellId(e);if(0===i)a(this.grid[n.i][n.j],e);else{var o=i/d,s=Math.floor(n.i+o),r=Math.floor(n.j-o);if(s>=y||r>=b)return;var l=s+1,c=r+1;if(l<0||c<0)return;s>=0&&(r>=0&&a(this.grid[s][r],e),c<b&&a(this.grid[s][c],e)),l<y&&(r>=0&&a(this.grid[l][r],e),c<b&&a(this.grid[l][c],e))}},o.prototype._addCell=function(e,t){var i,n=this.getCoordinateGridFromCellId(e);this.grid[n.i][n.j].cellId=e;var o=this.useAltitude&&t.f||0,s=this.getCoordinateSceneFromGrid(n);if(s.y-=o,this.scenePositions[e]=s,0===o)i=this.grid[n.i][n.j],i.cells.push(e),i.bounds.push([0,1,0,1]);else{var a=o/d,r=n.i+a,l=n.j-a,c=Math.floor(r),u=Math.floor(l);if(c>=y||u>=b)return;var h=c+1,p=u+1;if(h<0||p<0)return;var m=r-c,f=l-u;c>=0&&(u>=0&&(i=this.grid[c][u],i.cells.push(e),i.bounds.push([m,1,f,1])),p<b&&(i=this.grid[c][p],i.cells.push(e),i.bounds.push([m,1,0,f]))),h<y&&(u>=0&&(i=this.grid[h][u],i.cells.push(e),i.bounds.push([0,m,f,1])),p<b&&(i=this.grid[h][p],i.cells.push(e),i.bounds.push([0,m,0,f])))}},o.prototype.initialize=function(e,t){this.cellList=e,this.useAltitude=t,this.grid=[],this.scenePositions=[];for(var i=0;i<y;i+=1){var o=new Array(b);this.grid[i]=o;for(var s=0;s<b;s+=1)o[s]=new n}for(var a=e.length-1;a>=0;a-=1){var r=e[a];0!==(1&r.l)&&this._addCell(a,r)}}},function(e,t,i){function n(e,t){s.call(this,e,t),this.state=-1,this.animated=!1}var o=i(172).inherits,s=i(374),a={2:!0};o(n,s),e.exports=n,n.prototype.changeState=function(e,t){function i(){o.assignSymbol(l,c),n.animated=c}if(this.state!==e){var n=this,o=this.animManager,s=this.state;if(this.state=e,!o.isVoidAnimManager){var r={id:"AnimState"+s+"_to_AnimState"+e+"_0",base:"AnimState"+s+"_to_AnimState"+e,direction:0},l={id:"AnimState"+e+"_0",base:"AnimState"+e,direction:0},c=a[e]||!1;!t&&o.template&&o.template.exposedSymbols[r.id]?(this.animated=!0,o.assignSymbol(r,!1,i)):i()}}}},function(e,t,i){function n(e){a.call(this,e),this._updatedSprites=[],this._atlasTexture=null,this._spriteByteSize=this.renderer.getNbBytesPerSprite(),this._vertexBuffer=null,this._floatView=null,this._longView=null,this._sprites=[],this._vertexBufferCreated=!1,this._vertexBufferIndexPerPosition=new Array(l+1)}function o(e,t,i){r.call(this,e),this.batch=i,this.renderer=i.renderer;var n=e.cx||0,o=e.cy||0,s=e.x,a=e.y,l=e.sx||1,c=e.sy||1,d=e.cw,u=e.ch,h=-n*l,p=-o*c,m=(d-n)*l,f=-o*c,g=-n*l,_=(u-o)*c,v=(d-n)*l,y=(u-o)*c,b=e.rotation||0;if(0!==b){var M=Math.cos(b),w=Math.sin(b),T=h,C=m,A=g,I=v;h=h*M-p*w,p=T*w+p*M,m=m*M-f*w,f=C*w+f*M,g=g*M-_*w,_=A*w+_*M,v=v*M-y*w,y=I*w+y*M}this.x0=h+s,this.y0=p+a,this.x1=m+s,this.y1=f+a,this.x2=g+s,this.y2=_+a,this.x3=v+s,this.y3=y+a,this.bbox[0]=Math.min(this.x0,this.x1,this.x2,this.x3),this.bbox[1]=Math.max(this.x0,this.x1,this.x2,this.x3),this.bbox[2]=Math.min(this.y0,this.y1,this.y2,this.y3),this.bbox[3]=Math.max(this.y0,this.y1,this.y2,this.y3),this.graphicInAtlas=t,this.spriteIndex=0}var s=i(172).inherits,a=i(375),r=i(376),l=i(167).NB_CELLS;s(n,a),e.exports=n,n.prototype.holdsStatics=!0,n.prototype.setTexture=function(e){this._atlasTexture=e,this._updatedSprites.push(this),this.forceRefresh()},n.prototype.draw=function(e,t){if(null!==this._atlasTexture&&!(e.layer>this.layer||t.layer<this.layer)){var i;e.layer<this.layer?i=0:(i=Math.round(e.position),i<0?i=0:i>l&&(i=l));var n;t.layer>this.layer?n=l:(n=Math.round(t.position),n<0?n=0:n>l&&(n=l));var o=this._vertexBufferIndexPerPosition[i],s=this._vertexBufferIndexPerPosition[n];o!==s&&this.renderer.drawSpriteSubBatch(this.id,o,s)}},s(o,r),o.prototype.isWithinBounds=function(e,t){return this.bbox[0]<=e&&e<=this.bbox[1]&&this.bbox[2]<=t&&t<=this.bbox[3]},o.prototype.render=function(){null!==this.batch._atlasTexture&&this.renderer.drawSpriteSubBatch(this.batch.id,6*this.spriteIndex,6*this.spriteIndex+6)},o.prototype.forceRefresh=function(){this.isOutdated===!1&&(this.isOutdated=!0,this.batch._updatedSprites.push(this),this.batch.forceRefresh())},n.prototype.addSprite=function(e,t){var i=new o(e,t,this);return this._sprites.push(i),i},n.prototype.finalize=function(e,t){this._createVertexBuffer(e,t),this._updatedSprites.push(this),this.forceRefresh()},n.prototype.refreshAnimation=function(e){if(this.isOutdated=!1,0!==this._updatedSprites.length){
for(var t=0;t<this._updatedSprites.length;t+=1){var i=this._updatedSprites[t];this._updateSpriteHighlight(i),void 0!==e&&e.push(i.bbox.slice()),i.isOutdated=!1}var n=this.id,o=this.renderer.getBufferData(n);if(void 0===o){var s=this._atlasTexture;if(null!==s&&this._vertexBufferCreated){var a=this._floatView,r=!1;this.renderer.loadSpriteBuffer(n,a,s,this.bbox,r),this.renderer.lockBuffer(n)}}this._updatedSprites.length=0}},n.prototype._updateSpriteHighlight=function(e){var t=e.spriteIndex*this._spriteByteSize,i=t/4,n=this._longView.subarray(i,i+this._spriteByteSize/4),o=e.tint,s=Math.max(-128,Math.min(127,64*o[0])),a=Math.max(-128,Math.min(127,64*o[1])),r=Math.max(-128,Math.min(127,64*o[2])),l=Math.max(-128,Math.min(127,64*o[3])),c=(l<<24&4278190080)+(r<<16&16711680)+(a<<8&65280)+(255&s);n[3]=n[8]=n[13]=c,n[18]=n[23]=n[28]=c,this.renderer.updateVertexBuffer(this.id,n,t)},n.prototype._createVertexBuffer=function(e,t){this._vertexBuffer=new ArrayBuffer(this._spriteByteSize*this._sprites.length),this._floatView=new Float32Array(this._vertexBuffer),this._longView=new Uint32Array(this._vertexBuffer);for(var i=this._floatView,n=this._longView,o=this._longView,s=1/0,a=-(1/0),r=1/0,c=-(1/0),d=0,u=0;u<this._sprites.length;u+=1){var h=this._sprites[u],p=h.graphicInAtlas,m=u*this._spriteByteSize/4;for(h.spriteIndex=u;d<h._position;)this._vertexBufferIndexPerPosition[d]=6*u,d+=1;this._vertexBufferIndexPerPosition[d]=6*u+6;var f=h.bbox;f[0]<s&&(s=f[0]),f[1]>a&&(a=f[1]),f[2]<r&&(r=f[2]),f[3]>c&&(c=f[3]),i[m+0]=h.x0,i[m+1]=h.y0,i[m+5]=h.x2,i[m+6]=h.y2,i[m+10]=h.x3,i[m+11]=h.y3,i[m+15]=h.x0,i[m+16]=h.y0,i[m+20]=h.x3,i[m+21]=h.y3,i[m+25]=h.x1,i[m+26]=h.y1;var g=p.sx/e*65535&65535,_=p.sy/t*4294901760&4294901760,v=(p.sx+p.sw)/e*65535&65535,y=(p.sy+p.sh)/t*4294901760&4294901760;n[m+2]=g+_,n[m+7]=g+y,n[m+12]=v+y,n[m+17]=g+_,n[m+22]=v+y,n[m+27]=v+_;var b=h.tint,M=Math.max(-128,Math.min(127,64*b[0])),w=Math.max(-128,Math.min(127,64*b[1])),T=Math.max(-128,Math.min(127,64*b[2])),C=Math.max(-128,Math.min(127,64*b[3])),A=(C<<24&4278190080)+(T<<16&16711680)+(w<<8&65280)+(255&M);o[m+3]=o[m+8]=o[m+13]=A,o[m+18]=o[m+23]=o[m+28]=A,o[m+4]=o[m+9]=o[m+14]=0,o[m+19]=o[m+24]=o[m+29]=0}for(;d<=l;)this._vertexBufferIndexPerPosition[d]=6*u,d+=1;this.bbox[0]=s,this.bbox[1]=a,this.bbox[2]=r,this.bbox[3]=c,this._vertexBufferCreated=!0},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id),this._atlasTexture&&this._atlasTexture.release()}},function(e,t,i){function n(e,t,i){u.call(this,e,t),this._centerX=e.w/2,this._centerY=e.h,this.orientation=e.orientation,this.tween=null,this._startAnimation(i)}function o(){0!==v.length&&(v.forEach(function(e){t.addArrow.apply(null,e)}),v=[])}function s(e,t,i,s,a){if(!y)return v.push(arguments),void(b||(b=!0,g.loadTexture("ui/hintArrow/arrow.png",function(e){y=e,o()},s.renderer,"linear","permanent")));var r={x:e.x,y:e.y,w:M,h:w,position:t,layer:d.MAP_LAYER_POINT_LABELS,orientation:i,scene:s};_.push(new n(r,y,a))}function a(){v=[];for(var e=0;e<_.length;e++)_[e].remove();_=[],(x.playing||x.starting)&&x.stop(),(N.playing||N.starting)&&N.stop()}function r(e,t,i,n,o){a(),s(e[o],t[o],i,n),x.reset(A,function(){++o>=e.length&&(o=0),r(e,t,i,n,o)}),x.start()}function l(e,t,i,n){r(e,t,i,n,0)}function c(e,t,i,n){if(!N.playing&&!N.starting){a();for(var o=0;o<e.length;o++)s(e[o],t[o],i,n);N.reset(A,function(){a()}),N.start()}}var d=i(167),u=i(673),h=i(172).inherits,p=i(392).easing,m=i(392).Tween,f=i(392).Delay,g=i(384),_=[],v=[],y=null,b=!1,M=60,w=60,T=24,C=2,A=2*(T+C),I={up:0,down:180,left:-90,right:90,upLeft:-45,upRight:45,downLeft:-135,downRight:135},S=3,E=3;h(n,u),Object.defineProperty(n.prototype,"centerX",{get:function(){return this._centerX},set:function(e){this._centerX=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"centerY",{get:function(){return this._centerY},set:function(e){this._centerY=e,this.forceRefresh()}}),n.prototype._startAnimation=function(e){var t=I[this.orientation]||0;this.rotation=t*Math.PI/180,this.tween&&(this.tween.stop(),this.tween=null);var i=this.centerY-S,n=this.centerY+S;return this.tween=new m(this,["alpha","centerY"]).from({alpha:0,centerY:i}).to({alpha:1,centerY:i},C).to({alpha:1,centerY:n},T,p.trigo,E).to({alpha:0,centerY:n},C).to({alpha:0,centerY:n},T).start(e||!0),this},n.prototype.stop=function(){this.tween.stop()},n.prototype.render=function(){var e=this.renderer;e.save(),e.translate(this._x,this._y),e.rotate(this._rotation),e.translate(-this._centerX,-this._centerY),e.multiplyColor(this.tint[0],this.tint[1],this.tint[2],this.tint[3]),e.drawImage(this.texture,0,0,this.w,this.h),e.restore()},n.prototype.generateCurrentFrameData=function(){return[-this._centerX,this.w-this._centerX,-this._centerY,this.h-this._centerY]},t.addArrow=s;var x=new f,N=new f;t.removeArrows=a,t.addArrowsSequence=l,t.addArrowsOneShot=c},function(e,t,i){var n=i(167),o=i(380),s=i(379),a={up:0,down:180*Math.PI/180},r={pingIcon:"ping_Icon",mp:"btn_DeplaceToi",warning:"btn_Attention",stop:"btn_Stop",attack:"btn_Attaque",move:"btn_Deplace",heal:"btn_Soigne",boost:"btn_Boost",tackle:"btn_Entrave",valid:"btn_Valide"},l={};t.addPingPicto=function(e,t,i,c){if(!r[c])return void console.error("[IsoEngine.addPingPicto] No base for type",c);var d=new s({layer:n.MAP_LAYER_ICONS,x:t.x,y:t.y,scene:window.isoEngine.mapScene}),u=new s({layer:n.MAP_LAYER_ICONS,x:t.x,y:t.y,scene:window.isoEngine.mapScene});o.loadAnimationManager(d,"embedded","ping",function(e){e.assignSymbol({base:r.pingIcon,direction:-1},!1)}),o.loadAnimationManager(u,"embedded","ping",function(e){e.assignSymbol({base:r[c],direction:-1},!1)}),l[e]={back:d,front:u};var h=70,p=0;d.rotation=a.up;var m=window.isoEngine.actorManager.occupiedCells[i]||[];if(m.length>0){var f=m[0].bbox;p=f?f[2]-t.y:-100,p-=h,t.y+p<0&&(p=f?f[3]-t.y:100,p+=h,d.rotation=a.down)}else p=-h,t.y+p<0&&(p=h,d.rotation=a.down);d.y=t.y+p,u.y=t.y+p,window.isoEngine.mapRenderer.addCellHighlight(e,[i],window.gui.pingSystem.PING_CELL_COLOR)},t.removePingPicto=function(e){window.isoEngine.mapRenderer.deleteCellHighlight(e);var t=l[e];return t?(t.back&&t.back.remove(),t.front&&t.front.remove(),void delete l[e]):void console.warn("IsoEngine removePing: There no ping picto with the id",e)},t.removeAllPingPictos=function(){for(var e in l)l.hasOwnProperty(e)&&t.removePingPicto(e)}},function(e,t,i){function n(e,t){if(t=t||{},this.id=null,this.outline=t.outline||!1,this.color=t.color,this.data=t.data||null,this.gfx=null,this._boxBatch=null,this._lineBatch=null,!this.outline&&!this.color)return void console.error("[Zone] It is not possible to create a zone without colors and outline");if(this.outline){var i=s.getZoneOutlines(e);this._lineBatch=new l({scene:window.isoEngine.mapScene,x:0,y:0,position:5,lines:i,lineWidth:4,hue:r.anyToColorArray(this.outline),layer:a.MAP_LAYER_BACKGROUND,id:"zoneOutline"+f++})}if(this.color){for(var n=[],u=0;u<e.length;u++){var g=o.cellCoord[e[u]],_=d,v=g.x,y=g.y-_;n.push({x0:v,y0:y,x1:v+p,y1:y+m,x2:v,y2:y+h,x3:v-p,y3:y+m})}this._boxBatch=new c({scene:window.isoEngine.mapScene,x:0,y:0,position:1,boxes:n,hue:r.anyToColorArray(this.color),layer:a.MAP_LAYER_BACKGROUND,id:"zoneColor"+f++})}}var o=i(670),s=i(1196),a=i(167),r=i(378),l=i(1006),c=i(672),d=a.GRID_ALTITUDE_OFFSET,u=a.CELL_WIDTH,h=a.CELL_HEIGHT,p=u/2,m=h/2,f=1;e.exports=n,n.prototype.destroy=function(){null!==this.gfx&&this.gfx.remove(),this._lineBatch&&(this._lineBatch.remove(),this._lineBatch=null),this._boxBatch&&(this._boxBatch.remove(),this._boxBatch=null)}},function(e,t,i){function n(e){var t=y*(e[0]-f),i=y*e[1],n=(t+i)/b+g,o=(i-t)/M+_;return n=~~Math.round(n),o=~~Math.round(2*o)/2-d,{x:n,y:o}}function o(e,t){t[e]?delete t[e]:t[e]=!0}function s(e,t){var i=r.getMapPointFromCellId(e);o(i.x+":"+i.y+":H",t),o(i.x+1+":"+i.y+":V",t),o(i.x+":"+(i.y+1)+":H",t),o(i.x+":"+i.y+":V",t)}function a(e){for(var t={},i=0;i<e.length;i++)s(e[i],t);t=Object.keys(t);for(var o=[],a=0;a<t.length;a++){var r=t[a].split(":");r[0]=~~r[0],r[1]=~~r[1];var l=n(r);"H"===r[2]?r[0]+=1:r[1]+=1;var d=n(r);o.push(new c(l.x,l.y,d.x,d.y))}return o}var r=i(794),l=i(167),c=i(1005),d=l.GRID_ALTITUDE_OFFSET,u=l.CELL_WIDTH,h=l.CELL_HEIGHT,p=.325,m=1.338,f=20.225,g=l.HORIZONTAL_OFFSET-u/2-p,_=l.VERTICAL_OFFSET-h/2-m,v=Math.sqrt(2),y=v/2,b=v/u,M=v/h;e.exports.getZoneOutlines=a},function(e,t,i){function n(e,t){this.mapRenderer=e,this.onLoadedCallback=t,this.nAssetsLoaded=0,this.nAssetsToLoad=0,this.atlas=document.createElement("canvas"),this.atlasContext=this.atlas.getContext("2d"),this.obsolete=!1,null!==u&&(u.obsolete=!0);var i=this;u=i}var o=i(380),s=i(1191),a=i(258),r=i(1198),l=i(182),c=i(167),d=c.IMG_PATH,u=null;e.exports=n,n.prototype.notifyAssetAsLoaded=function(){if(this.nAssetsLoaded+=1,window.isoEngine.showLoadingProgress(this.nAssetsLoaded/this.nAssetsToLoad),this.nAssetsLoaded===this.nAssetsToLoad){if(this.onLoadedCallback(),this.onLoadedCallback=null,this.obsolete)return;this.mapRenderer.isReady=!0,this.mapRenderer.emit("ready"),this.obsolete=!0}},n.prototype.loadStatedElement=function(e){var t=new s(e),i=this;return this.nAssetsToLoad+=1,o.loadAnimationManager(t,"bone",e.look+"/state",function(){t.changeState(t.state,!0),i.notifyAssetAsLoaded()}),t},n.prototype.loadAnimatedGraphic=function(e){var t=new r(e),i=this;return this.nAssetsToLoad+=1,o.loadAnimationManager(t,"bone",e.look+"/motion",function(){a.isFightMode?t.stop():t.animate(),i.notifyAssetAsLoaded()}),t},n.prototype.loadAtlas=function(e,t){function i(){if(r+=1,r===a){var e=c.mapRenderer.mapScene,i=c.mapRenderer.mapId,n=e.createTexture(c.atlas,"mapAtlas"+i,"linear");c.atlas.width=1,c.atlas.height=1,t.setTexture(n)}c.notifyAssetAsLoaded()}function n(e,t){l.loadImage(e,function(e){if(!c.obsolete){var n=t.sx,o=t.sy,s=t.sw,a=t.sh,r=t.cx||0,l=t.cy||0,d=t.cw||s,u=t.ch||a;r+d>e.width&&(d=e.width-r),l+u>e.height&&(u=e.height-l),c.atlasContext.drawImage(e,r,l,d,u,n,o,s,a),i()}})}this.atlas.width=e.width,this.atlas.height=e.height;var o=e.graphicsPositions,s=Object.keys(o),a=s.length,r=0;this.nAssetsToLoad+=a;for(var c=this,u=0;u<s.length;u+=1){var h=s[u],p=o[h],m=p.jpg?"jpg":"png",f=m+"/"+h+"."+m,g=d+f;n(g,p)}}},function(e,t,i){function n(e){s.call(this,e,e.animManager),this.animStatic=!!e.astc,this.delayMin=e.dmin||0,this.delayMax=e.dmax||0,this._timeout=null,this._stopped=!0}var o=i(172).inherits,s=i(374),a={id:"AnimStatique_0",base:"AnimStatique",direction:0},r={id:"AnimStart_0",base:"AnimStart",direction:0};o(n,s),e.exports=n,n.prototype.animate=function(){this._stopped&&(this._stopped=!1,this.delayMax?(this.animStatic&&this.animManager.assignSymbol(a,!1),this._animateShoot()):this._animateLoop())},n.prototype.stop=function(){this._stopped=!0,this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this.delayMax||this.animManager.assignSymbol(a,!1)},n.prototype.remove=function(){this.stop(),s.prototype.remove.call(this)},n.prototype._animateLoop=function(){this.animManager.assignSymbol(r,!0)},n.prototype._animateShoot=function(){var e=this;if(!this._stopped){var t=1e3*(this.delayMin+(this.delayMax-this.delayMin)*Math.random());this._timeout=window.setTimeout(function(){e._stopped||e.animManager.assignSymbol(r,!1,function(){e._stopped||(e.animStatic&&e.animManager.assignSymbol(a,!1),e._animateShoot())})},t)}}},function(e,t,i){function n(e){l.call(this,e,e.scene.renderer.getEmptyTexture()),this.zones=[],this.displayGrid=!1,this.tacticalMode=!1,this.gridLines=null,this.tacticalBoxes=null,this.gridAnimator=null,this.isDebugMode=!1,_.on("gameContextChanged",this.onGameContextChanged.bind(this))}function o(e,t){var i=window.foreground.convertScreenToCanvasCoordinate(e,t),n=window.isoEngine.mapScene.convertCanvasToSceneCoordinate(i.x,i.y);return window.isoEngine.mapRenderer.getCellId(n.x,n.y)}var s=i(167),a=i(670),r=i(172).inherits,l=i(673),c=i(1005),d=i(671),u=i(1006),h=i(1200),p=i(1204),m=i(392).Tween,f=i(1205),g=i(171),_=i(258),v=s.CELL_WIDTH,y=s.CELL_HEIGHT,b=s.GRID_ALTITUDE_OFFSET,M=s.MAP_LAYER_BACKGROUND,w=v/2,T=y/2,C=[.8,.8,.8,.8];r(n,l),e.exports=n,n.prototype.resetAndClear=function(){this.displayGrid=!1},n.prototype.clear=function(){this.texture?(this.texture.release(),this.texture=null):console.warn("[Background.clear] Clearing background although no texture was ever set")},n.prototype.releaseMap=function(){this.deleteAllZones(),this.gridLines&&(this.gridLines.remove(),this.gridLines=null)},n.prototype.updateMap=function(e){this._cleared=!1,this.texture=e,this.show(),this.gridLines||this.generateWalkableGrid()},n.prototype.onGameContextChanged=function(){this.generateWalkableGrid(),this.toggleGrid(g.alwaysShowGrid)},n.prototype.toggleGrid=function(e){var t=e||_.isFightMode;if(this.displayGrid!==t&&(this.displayGrid=t,null!==this.gridLines))if(t)this.gridLines.show(),m(this.gridLines,["alpha"]).to({alpha:1},20).start();else{var i=this;m(this.gridLines,["alpha"]).to({alpha:0},15).start().onFinish(function(){i.gridLines&&i.gridLines.hide()})}},n.prototype.generateWalkableGrid=function(){this.gridAnimator||(this.gridAnimator=new h);var e=window.isoEngine.mapRenderer;if(e.map&&e.map.cells){for(var t=e.map.cells,i=_.isRoleplayMode,n={},o=[],r=[],l=0;l<s.NB_CELLS;l++){var p=e.isWalkable(l);if(p){var f=t[l],g=a.cellCoord[l],v=(i&&f.f||0)+b,A=g.x,I=A-w,S=A+w,E=g.y-v,x=E+T,N=E+y,L=A+"."+E+"-"+S+"."+x,O=A+"."+N+"-"+S+"."+x,D=A+"."+N+"-"+I+"."+x,R=A+"."+E+"-"+I+"."+x;void 0===n[L]&&(n[L]=!0,r.push(new c(A,E,S,x))),void 0===n[O]&&(n[O]=!0,r.push(new c(S,x,A,N))),void 0===n[D]&&(n[D]=!0,r.push(new c(A,N,I,x))),void 0===n[R]&&(n[R]=!0,r.push(new c(I,x,A,E)));var P=new d(A,E,S,x,A,N,I,x);P.cellId=l,o.push(P)}}this.gridLines&&this.gridLines.remove(),this.gridLines=new u({scene:window.isoEngine.mapScene,x:0,y:0,position:3,lines:r,lineWidth:2,hue:C,layer:M,id:"combatGrid"}),this.gridLines.alpha=0,this.displayGrid?(this.gridLines.show(),m(this.gridLines,["alpha"]).to({alpha:1},20).start()):this.gridLines.hide(),this.isDebugMode&&(this.initDebugOverlay(),this.cellIdOverlay.clear(),this.cellIdOverlay.generateOverlay())}},n.prototype.setGridColor=function(e){this.gridLines.hue=e},n.prototype.initDebugOverlay=function(){if(!this.cellIdOverlay){var e={scene:this.scene,layer:s.MAP_LAYER_FOREGROUND,position:1,x:-s.HORIZONTAL_OFFSET,y:-s.VERTICAL_OFFSET,w:s.MAP_SCENE_WIDTH,h:s.MAP_SCENE_HEIGHT,id:"cellIdOverlay"};this.cellIdOverlay=new f(e)}},n.prototype.toggleDebugMode=function(e){this.isDebugMode=!this.isDebugMode,this.initDebugOverlay(),this.isDebugMode?this.cellIdOverlay.generateOverlay(e):this.cellIdOverlay.clear()},n.prototype.highlightDebugCells=function(e,t){this.isDebugMode&&this.cellIdOverlay&&this.cellIdOverlay.colorCells(e,t)},n.prototype.deleteAllZones=function(){for(var e=0;e<this.zones.length;e++)this.zones[e].destroy();this.zones=[]},n.prototype.addZone=function(e,t){this.zones.push(e),e.id=t},n.prototype.deleteZone=function(e){e.destroy();var t=this.zones.indexOf(e);return t===-1?console.warn("Removing a non existing zone"):void this.zones.splice(t,1)},n.prototype.deleteZoneById=function(e,t){for(var i=0;i<this.zones.length;)this.zones[i].id===e?(t&&t(this.zones[i]),this.zones[i].destroy(),this.zones.splice(i,1)):i++},n.prototype.getDataOfZoneId=function(e){for(var t=0;t<this.zones.length;t++)if(this.zones[t].id===e)return this.zones[t].data;return null};var A=10;n.prototype.colorCurrentDragCell=function(e,t,i){if(i.data){var n=window.foreground.convertScreenToCanvasCoordinate(e,t-A),o=window.isoEngine.mapScene.convertCanvasToSceneCoordinate(n.x,n.y),s=window.isoEngine.mapRenderer.getCellId(o.x,o.y),a=s.cell;window.isoEngine.cellHover(a,i.data.id)}},n.prototype.dragCellRelease=function(e,t,i){if(_.isFightMode){if(!i.data)return;var n=o(e,t-A);window.isoEngine.cellHoverRelease(n.cell)}},n.prototype.addGridAnimation=function(e){return this.gridAnimator.addGridAnimation(e)},n.prototype.removeGridLayer=function(e){this.gridAnimator?this.gridAnimator.removeGridLayer(e):this.gridAnimator=new h};var I=[];n.prototype.addTargetHighLights=function(e,t,i,n,o,s){var a=new p(e,t,i);I.push(a),a.animate(n,o),s&&a.hide()},n.prototype.removeTargetHighlights=function(){I.forEach(function(e){e.stopped===!1&&(e.stop(),e.remove())}),I=[]},n.prototype.hideTargetHighlights=function(){I.forEach(function(e){e.hide()})},n.prototype.showTargetHighlights=function(){I.forEach(function(e){e.show()})}},function(e,t,i){function n(){this._gridOverlay=new o,this._gridOverlay.hide(),this._layers=new a,this._layersBeingRemoved=new a}var o=i(1201),s=i(1203),a=i(383),r=i(220),l=i(221);e.exports=n,n.prototype.addGridAnimation=function(e){if(0===Object.keys(e).length)return console.error("Trying to add animation with no cells!"),null;this._gridOverlay.show();var t=new s(e,this._gridOverlay);return t.playAnimation(),t._listReference=this._layers.addFront(t),this._resetBoundingBox(),t},n.prototype.removeGridLayer=function(e){if(e){this._layers.removeByReference(e._listReference),e._listReference=null;for(var t,i,n=e.cellInfos,o=Object.keys(n),a={},c=this._layers.first;null!==c;c=c.next)for(t=0;t<o.length;t++)i=o[t],c.object.cellInfos[i]&&void 0===a[i]&&(a[i]=c.object.cellInfos[i]);for(t=0;t<o.length;t++){i=o[t];var d=n[i];void 0===a[i]&&(a[i]=new r(i,d.distanceToPlayer,l.empty))}e._listReference=this._layersBeingRemoved.add(e);var u=this,h=new s(a,this._gridOverlay);h.playAnimation(function(){u._resetBoundingBox(),u._layersBeingRemoved.removeByReference(e._listReference),e._listReference=null})}},n.prototype._resetBoundingBox=function(){this._gridOverlay._bbox=[1/0,-(1/0),1/0,-(1/0)];for(var e=this._layersBeingRemoved.first;null!==e;e=e.next)this._expandToFitBox(e.object);if(0===this._layers.length)this._gridOverlay.hide();else for(this._layers.length>64&&console.error("layers are likely leaking"),e=this._layers.first;null!==e;e=e.next)this._expandToFitBox(e.object)},n.prototype.clear=function(){this._layers.clear()},n.prototype._expandToFitPoint=function(e,t){var i=this._gridOverlay._bbox;i[0]>e&&(i[0]=e),i[2]>t&&(i[2]=t),i[1]<e&&(i[1]=e),i[3]<t&&(i[3]=t)},n.prototype._expandToFitBox=function(e){var t=this._gridOverlay._bbox,i=e.bbox[0]-43;i<t[0]&&(t[0]=i);var n=e.bbox[1]+43;n>t[1]&&(t[1]=n);var o=e.bbox[2]-22;o<t[2]&&(t[2]=o);var s=e.bbox[3]+22;s>t[3]&&(t[3]=s)}},function(e,t,i){function n(){var e={scene:window.isoEngine.mapScene,position:1,hue:[0,0,0,0],layer:-1,id:"gridFeedbackOverlay"};s.call(this,e),this._bbox=[1/0,-(1/0),1/0,-(1/0)],this._boxByteSize=this.renderer.getNbBytesPerBox(),this.createGrid(),this.forceRefresh(),this._updated=!1}var o=i(1202),s=i(375),a=i(172).inherits,r=i(167),l=i(670),c=i(671),d=r.CELL_WIDTH,u=r.CELL_HEIGHT,h=d/2,p=u/2;a(n,s),e.exports=n,n.prototype.createGrid=function(){this.spriteBoxes=[],this._vertexBuffer=new ArrayBuffer(r.NB_CELLS*this._boxByteSize);for(var e=0;e<r.NB_CELLS;e++){var t=l.cellCoord[e],i=t.x,n=i-h,s=i+h,a=t.y-r.GRID_ALTITUDE_OFFSET,d=a+p,m=a+u,f=new c(i,a,s,d,i,m,n,d),g=e*this._boxByteSize,_=new Float32Array(this._vertexBuffer,g,this._boxByteSize/4),v=new Uint32Array(this._vertexBuffer,g,this._boxByteSize/4),y=new o(e,f,_,v,this);this.spriteBoxes[y.cellId]=y}},n.prototype._expandToFitPoint=function(e,t){this._bbox[0]>e&&(this._bbox[0]=e),this._bbox[1]<e&&(this._bbox[1]=e),this._bbox[2]>t&&(this._bbox[2]=t),this._bbox[3]<t&&(this._bbox[3]=t)},n.prototype._expandToFitBox=function(e){this._expandToFitPoint(e.x0,e.y0),this._expandToFitPoint(e.x1,e.y1),this._expandToFitPoint(e.x2,e.y2),this._expandToFitPoint(e.x3,e.y3)},n.prototype.draw=function(){this.renderer.drawBoxBatch(this.id)},n.prototype.render=function(){this.renderer.save(),this.draw(this.renderer),this.renderer.restore()},n.prototype.remove=function(){},n.prototype.generateCurrentFrameData=function(){this._updated&&(this.renderer.releaseBuffer(this.id),this._updated=!1);var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=!1;this.renderer.loadSpriteBuffer(t,this._vertexBuffer,null,this._bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t,i){function n(e,t,i,n,s){this._cellId=e;var r=a.empty;this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.sx=r.sx,this.sy=r.sy,this.rotation=0,this.gridOverlay=s,this._translateX=t.x0,this._translateY=t.y1,this._box=t,this._vertexBuffer=i,this._colorBuffer=n,this._restore(),this._translate(),this._fillVertexBuffer(),this.tween=new o(this,["sx","sy","r","g","b","a"]);var l=this;this.tween.onUpdate(function(){l.setBuffer()}),this._transformState=a.empty}var o=i(392).Tween,s=i(392).easing,a=i(221);e.exports=n,Object.defineProperty(n.prototype,"cellId",{get:function(){return this._cellId}}),n.prototype.animate=function(e,t){this._transformState=e;var i=11;return this.tween.reset().wait(t).to(e,i,s.backOut,2.3).start(),t+i},n.prototype._restore=function(){this._x0=0,this._y0=-21.5,this._x1=-43,this._y1=0,this._x2=0,this._y2=21.5,this._x3=43,this._y3=0},n.prototype._translate=function(){this._x0+=this._translateX,this._x1+=this._translateX,this._x2+=this._translateX,this._x3+=this._translateX,this._y0+=this._translateY,this._y1+=this._translateY,this._y2+=this._translateY,this._y3+=this._translateY},n.prototype._rotate=function(){if(0!==this.rotation){var e=Math.cos(this.rotation),t=Math.sin(this.rotation),i=this._x0,n=this._x1,o=this._x2,s=this._x3;this._x0=e*i-t*this._y0,this._y0=t*i+e*this._y0,this._x1=e*n-t*this._y1,this._y1=t*n+e*this._y1,this._x2=e*o-t*this._y2,this._y2=t*o+e*this._y2,this._x3=e*s-t*this._y3,this._y3=t*s+e*this._y3}},n.prototype._scale=function(){this._x0*=this.sx,this._x1*=this.sx,this._x2*=this.sx,this._x3*=this.sx,this._y0*=this.sy,this._y1*=this.sy,this._y2*=this.sy,this._y3*=this.sy},n.prototype.setBuffer=function(){this._restore(),this._scale(),this._rotate(),this._translate(),this._fillVertexBuffer(),this.gridOverlay._updated=!0,this.gridOverlay.forceRefresh()},n.prototype._fillVertexBuffer=function(){var e=Math.max(-128,Math.min(127,64*this.r)),t=Math.max(-128,Math.min(127,64*this.g)),i=Math.max(-128,Math.min(127,64*this.b)),n=Math.max(-128,Math.min(127,64*this.a)),o=(n<<24&4278190080)+(i<<16&16711680)+(t<<8&65280)+(255&e);this._vertexBuffer[0]=this._x0,this._vertexBuffer[1]=this._y0,this._colorBuffer[3]=o,this._vertexBuffer[5]=this._x1,this._vertexBuffer[6]=this._y1,this._colorBuffer[8]=o,this._vertexBuffer[10]=this._x2,this._vertexBuffer[11]=this._y2,this._colorBuffer[13]=o,this._vertexBuffer[15]=this._x2,this._vertexBuffer[16]=this._y2,this._colorBuffer[18]=o,this._vertexBuffer[20]=this._x3,this._vertexBuffer[21]=this._y3,this._colorBuffer[23]=o,this._vertexBuffer[25]=this._x0,this._vertexBuffer[26]=this._y0,this._colorBuffer[28]=o}},function(e,t,i){function n(e,t){this.cellInfos=e,this._gridOverlay=t,this.bbox=[1/0,-(1/0),1/0,-(1/0)],this._listReference=null}var o=i(392).Delay;e.exports=n,n.prototype.playAnimation=function(e){for(var t=-(1/0),i=this._gridOverlay.spriteBoxes,n=Object.keys(this.cellInfos),s=0;s<n.length;s++){var a=n[s],r=this.cellInfos[a],l=i[a],c=r.transformState;if(l.transformState!==c){var d=l.animate(c,.6*r.distanceToPlayer);t<d&&(t=d),this._expandToFitBox(l)}}e&&(t<=0?e():o(t,e).start())},n.prototype._expandToFitPoint=function(e,t){this.bbox[0]>e&&(this.bbox[0]=e),this.bbox[2]>t&&(this.bbox[2]=t),this.bbox[1]<e&&(this.bbox[1]=e),this.bbox[3]<t&&(this.bbox[3]=t)},n.prototype._expandToFitBox=function(e){this._expandToFitPoint(e._x0,e._y0),this._expandToFitPoint(e._x1,e._y1),this._expandToFitPoint(e._x2,e._y2),this._expandToFitPoint(e._x3,e._y3)}},function(e,t,i){function n(e,t,i){var n={scene:window.isoEngine.mapScene,position:1,layer:a.MAP_LAYER_TARGET_INDICATOR,id:"lightColumn"+e,x:t,alpha:0};o.call(this,n),this.red=0,this.green=0,this.blue=0,this.stopped=!1,this._defineShape(i);var s=this;this._tween=new r(this,["scaleX","scaleY","red","green","blue","alpha"]),this._tween.onUpdate(function(){var e=s.tint;e[0]=s.red,e[1]=s.green,e[2]=s.blue})}var o=i(375),s=i(172).inherits,a=i(167),r=i(392).Tween,l=i(392).easing;s(n,o),e.exports=n,n.prototype.draw=function(){this.renderer.drawBoxBatch(this.id)},n.prototype._defineShape=function(e){this._x0=16,this._y0=e,this._x1=23,this._y1=-a.VERTICAL_OFFSET,this._x2=-23,this._y2=-a.VERTICAL_OFFSET,this._x3=-16,this._y3=e,this._x4=20,this._y4=-a.VERTICAL_OFFSET,this._x5=-20,this._y5=-a.VERTICAL_OFFSET,this._bbox=[this._x2,this._x1,this._y1,this._y0];var t=this.renderer.getNbBytesPerVertex(),i=new ArrayBuffer(12*t);this._vertexBuffer=new Float32Array(i),this._colorBuffer=new Uint32Array(i);var n=1077952576,o=4210752;this._vertexBuffer[0]=this._x0,this._vertexBuffer[1]=this._y0,this._colorBuffer[3]=o,this._vertexBuffer[5]=this._x1,this._vertexBuffer[6]=this._y1,this._colorBuffer[8]=o,this._vertexBuffer[10]=this._x4,this._vertexBuffer[11]=this._y4,this._colorBuffer[13]=n,this._vertexBuffer[15]=this._x0,this._vertexBuffer[16]=this._y0,this._colorBuffer[18]=o,this._vertexBuffer[20]=this._x4,this._vertexBuffer[21]=this._y4,this._colorBuffer[23]=n,this._vertexBuffer[25]=this._x5,this._vertexBuffer[26]=this._y5,this._colorBuffer[28]=n,this._vertexBuffer[30]=this._x0,this._vertexBuffer[31]=this._y0,this._colorBuffer[33]=o,this._vertexBuffer[35]=this._x5,this._vertexBuffer[36]=this._y5,this._colorBuffer[38]=n,this._vertexBuffer[40]=this._x3,this._vertexBuffer[41]=this._y3,this._colorBuffer[43]=o,this._vertexBuffer[45]=this._x2,this._vertexBuffer[46]=this._y2,this._colorBuffer[48]=o,this._vertexBuffer[50]=this._x3,this._vertexBuffer[51]=this._y3,this._colorBuffer[53]=o,this._vertexBuffer[55]=this._x5,this._vertexBuffer[56]=this._y5,this._colorBuffer[58]=n},n.prototype.animate=function(e,t){var i={scaleX:e.sx,scaleY:e.sy,red:e.r,green:e.g,blue:e.b,alpha:e.a},n={scaleX:t.sx,scaleY:t.sy,red:t.r,green:t.g,blue:t.b,alpha:t.a},o=this;this._tween.reset().from({scaleX:e.sx/2,scaleY:e.sy,red:e.r,green:e.g,blue:e.b,alpha:0},l.polyOut,4).to(i,6).onFinish(function(){this.stopped||o._tween.reset().from(i).to(n,20,l.trigo,1).start(!0)}).start()},n.prototype.stop=function(){this._tween.stop(),this.stopped=!0},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=!1;this.renderer.loadSpriteBuffer(t,this._vertexBuffer,null,this._bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t,i){function n(e){r.call(this,e),this.indexText=document.createElement("canvas"),this.indexText.width=e.w,this.indexText.height=e.h,this.indexTextContext=this.indexText.getContext("2d"),this.indexTextContext.font="20px Verdana",this.indexTextContext.fillStyle="rgba(0,0,0,0.6)",this.indexTextContext.textAlign="center"}var o=i(167),s=i(670),a=i(172).inherits,r=i(673),l=o.CELL_WIDTH,c=o.CELL_HEIGHT,d=o.GRID_ALTITUDE_OFFSET,u=l/2;a(n,r),e.exports=n,n.prototype.generateOverlay=function(e){this._generateOverlay(e)},n.prototype._generateOverlay=function(e,t,i){var n=window.isoEngine.mapRenderer;if(n.map&&n.map.cells){var a=n.map.cells;"string"==typeof e&&(this.indexTextContext.fillStyle=e),this.indexTextContext.clearRect(0,0,this.indexText.width,this.indexText.height);for(var r=0;r<o.NB_CELLS;r++){var l=n.isWalkable(r);if(l){var h=a[r],p=s.cellCoord[r],m=h.f?h.f+d:d,f=p.x,g=p.y-m;if(t&&t.indexOf(r)>=0){var _=this.indexTextContext.fillStyle;this.indexTextContext.fillStyle=i,this.indexTextContext.fillText(r,f+u+10,g+c),this.indexTextContext.fillStyle=_}else this.indexTextContext.fillText(r,f+u+10,g+c)}}this.texture&&this.texture.release(),this.texture=window.isoEngine.mapScene.createTexture(this.indexText),this.show()}},n.prototype.clear=function(){this.texture?(this.texture.release(),this.texture=null):console.warn("[CellIdOverlay.clear] Clearing CellIdOverlay although no texture was ever set"),this.hide()},n.prototype.colorCells=function(e,t){this._generateOverlay(null,e,t)}},function(e,t,i){function n(e){var t=this;o.prototype.actorManager=this,this.isoEngine=e.isoEngine,this.scene=e.scene,this.isTransparentModeOn=!1,this.isCreatureModeOn=!1,this.paused=!0,this.actors={},this.occupiedCells={},this.followers=[],this.customAnimMethods={},this.userId=0,this.userActor=new o({data:{_type:"GameRolePlayCharacterInformations"},scene:this.scene,actorManager:this}),this.userActor.setWhiteListedness(!0),this.isoEngine.on("GameFightSynchronizeMessage",function(e){for(var i=e.fighters,n=0,o=i.length;n<o;n++){var s=i[n];if(s.alive){var a=s.contextualId,r=t.getActor(a);if(r){var l=s.disposition.cellId;l===-1||r.cellId===l||r.moving||r.setDisposition(l,null)}else t.addEmptyActor(s)}}}),m.on("gameContextChanged",this.onGameContextChanged.bind(this)),p.on("MapNpcsQuestStatusUpdateMessage",function(e){t.updateQuestIcons(e)}),this.fighterIndicator=null,this._onIdAdded={},this._queuedToCarryActors={},this._nickNamesOn=!1}var o=i(778),s=i(171),a=i(794),r=i(793),l=i(167),c=i(1207),d=i(364),u=i(788),h=i(1208),p=i(202),m=i(258),f=i(176),g=.001,_=1.5,v=.38,y=.002,b=.5,M=.2;e.exports=n,n.prototype.onGameContextChanged=function(){m.isRoleplayMode?this.cleanupActorAnimations():this.turnNicknamesOff()},n.prototype.removeInvisibilityOfAllActors=function(){var e=d.VISIBLE;this.userActor.setInvisibility(e);for(var t in this.actors)this.actors[t].setInvisibility(e)},n.prototype.cleanupActorAnimations=function(){this.userActor.cleanupAnimations();for(var e in this.actors)this.actors[e].cleanupAnimations()},n.prototype.isActorInvisible=function(e){var t=this.getActor(e);return t.isInvisible},n.prototype.getActor=function(e){var t=e===this.userId?this.userActor:this.actors[e];return t},n.prototype.getActorFromNpcId=function(e){var t=this.actors;for(var i in t){var n=t[i];if(n.isNPC()&&(n.data.npcId===e||e===-1))return n}return null},n.prototype.getActorFromMonsterId=function(e){var t=this.actors;for(var i in t){var n=t[i],o=n.data||{},s=o.staticInfos;if(s&&s.mainCreatureLightInfos&&(s.mainCreatureLightInfos.creatureGenericId===e||e===-1))return n}return null},n.prototype.getActorData=function(e,t){var i=this.getActor(e);return i?t(null,i.data):t(new Error("actorNotFound"))},n.prototype.pause=function(){this.paused=!0},n.prototype.unpause=function(){this.paused=!1},n.prototype.setUserCharacterData=function(e){var t=e.id,i=e.entityLook;this.userId=t,this.userActor.actorId=t,this.userActor.actorManager=this,this.userActor.data.name=e.name,this.userActor.data.playerId=t,this.setActorLook(t,i)},n.prototype.switchUserActor=function(e){if(this.userId!==e){var t=this.getActor(e);if(!t)return console.error("switchUserActor: No actor with id",e);var i=!1;this.userActor.isDead?i=!0:this.actors[this.userId]=this.userActor,this.userId=e,this.userActor=t,delete this.actors[e],i||window.isoEngine.tryDisplayUserMovementZone()}},n.prototype.setActorLook=function(e,t,i,n){var o=this.getActor(e);return o?void(o.animated||(o.riderEntity=null,o.setLook(t,{},function(){var e=o.animManager;o.isFollower&&(e.audioVol=M);var t=o.look;1===t.bonesId&&t.skins&&t.skins[0]&&c[t.skins[0]]&&e.addAnimationModifier("AnimStatique","AnimStatique"+t.skins[0]);var n=o.parentActor;return n?(n.carriedActor.setAnimManager(e),n.staticAnim()):o.staticAnim(),i&&i()},n))):(console.warn("setActorLook: No actor with id",e),i&&i())},n.prototype.getIndexedVisibleActors=function(){var e={};for(var t in this.actors)this.actors[t].isInvisible||(e[this.actors[t].cellId]=this.actors[t]);return e[this.userActor.cellId]=this.userActor,e},n.prototype.removeAllActors=function(){this.cleanupActorAnimations();for(var e in this.actors)this.actors[e].removeTeamCircle(),this.actors[e].remove();this.actors={},this.occupiedCells={},this.followers=[],this.customAnimMethods={}},n.prototype.updateMapInfoData=function(e){var t=this.userActor;if(window.gui.playerData.isSpectator||t.show(),!m.isFightMode){var i,n,o,s=e.actors,a=s.length,r=0;for(i=0;i<a;i++){o=s[i],n=this.getActor(o.contextualId),n||(r+=1);var l=o.staticInfos&&o.staticInfos.underlings;r+=l?l.length:0}for(this.checkCreatureMode(r),i=0;i<a;i++){o=s[i];var c=o.contextualId;c===this.userId&&(t.removeIcons(),
this.isoEngine.userPreviousPosition=o.disposition.cellId),n=this.getActor(c),n?n.updateData(o):n=this.addEmptyActor(o),this.setActorLook(c,o.look),o.staticInfos&&o.staticInfos.underlings&&this.addActorFollowers(n,o.staticInfos.underlings)}this._nickNamesOn&&this.turnNicknamesOn()}},n.prototype.updateQuestIcons=function(e){if(e.mapId===this.isoEngine.mapRenderer.mapId){var t,i=this.actors,n=e.npcsIdsWithQuest;for(var o in i)t=i[o],t.isNPC()&&n.indexOf(t.actorId)===-1&&t.removeQuestIcon();for(var s=0;s<n.length;s++)t=this.getActor(n[s]),t&&t.addQuestIcon(e.questFlags[s])}},n.prototype.addActor=function(e,t){var i=this,n=e.contextualId,o=this.getActor(n);o?o.updateData(e):o=this.addEmptyActor(e);var s=function(){for(var t in i._queuedToCarryActors){var n=i.getActor(t);n===o&&(n.carryCharacter(i._queuedToCarryActors[t]),delete i._queuedToCarryActors[t])}var s=e.disposition&&e.disposition.carryingCharacterId;if(s){var a=i.getActor(s);a?a.carryCharacter(o):i._queuedToCarryActors[s]=o}};this.setActorLook(n,e.look,function(){return e.staticInfos&&e.staticInfos.underlings&&i.addActorFollowers(o,e.staticInfos.underlings),s(),t&&t(i.actors[n])});var a=o.getFighter();return window.gui.playerData.isFighting&&!o.isFollower&&a&&o.addTeamCircle(),this.addedActor(o.actorId),this._nickNamesOn&&o.data.name&&o.addNicknameLabel(o.data.name),o},n.prototype.addEmptyActor=function(e){var t=e.contextualId,i=this.getActor(t);if(i)return i;var n=e.disposition,s=n.cellId,a=n.direction;return i=new o({actorId:t,position:s,cellId:s,direction:a,data:e,scene:this.scene,layer:this.isTransparentModeOn?l.MAP_LAYER_TRANSPARENT:l.MAP_LAYER_PLAYGROUND,alpha:this.isTransparentModeOn?l.TRANSPARENT_MODE_ALPHA:1,actorManager:this}),this.actors[t]=i,i.setDisposition(s,a),i},n.prototype.removeActor=function(e){var t,i=this;if(e===this.userId){if(t=this.userActor,!t.isDead)return}else t=this.actors[e];return t?t.moving?void t.pathTween.onceFinish(function(){i.getActor(e)&&i.removeActor(e)}):void t.remove():console.warn("[ACTOR MANAGER] removeActor: actor not found",e)},n.prototype._removeActor=function(e){e.fighterIndicator&&e.fighterIndicator.remove(),e.removeTurnNumber();var t=e.actorId;this.removeActorOccupation(e),this.customAnimMethods[t]&&delete this.customAnimMethods[t],e.removeNicknameLabel(),e.removeTeamCircle(),delete this.actors[t],e.followers&&this.removeActorFollowers(e)},n.prototype.removeActors=function(e){for(var t=0,i=e.length;t<i;t++)this.removeActor(e[t])},n.prototype.resetActors=function(){this.removeAllActors(),this.userActor.show()},n.prototype.actorMovement=function(e,t){var i=e.actorId,n=e.keyMovements,o=n[n.length-1],s=window.isoEngine;if(m.isRoleplayMode&&i===this.userId)return s.roleplayUserActorMovement(n);var a=this.getActor(i);return a?(a.setCellPosition(o),this.paused?(a.position=o,t&&t()):(2===n.length&&(n=r.normalizePath(n)),n.length>1?void(this.isoEngine.mapRenderer.isReady?a.setPath(n,{slide:e.slide,cb:t}):a.setDisposition(o)):t&&t())):(this.addEmptyActor({contextualId:i,disposition:{cellId:o,direction:1}}),t&&t())},n.prototype.setActorsDisposition=function(e,t){for(var i=0,n=e.length;i<n;i++){var o=e[i];if(o.cellId!==-1){var s=o.id,a=this.getActor(s);if(!a){if(t)continue;if(!o.cellId&&0!==o.cellId)continue;var r=window.gui.fightManager.getFighter(s);if(r&&r.data&&!r.data.alive)continue;a=this.addEmptyActor({contextualId:s,disposition:o})}a.cellId===o.cellId&&a.direction===o.direction||a.setDisposition(o.cellId,o.direction)}}},n.prototype.removeActorOccupation=function(e){var t=e.cellId;if(null!==t){var i=this.occupiedCells[t];if(void 0===i)return;var n=i.indexOf(e);n===-1?console.warn("[ActorManager.removeActorOccupation] Trying to remove an actor from an empty cell",e):1===i.length?delete this.occupiedCells[t]:i.splice(n,1)}},n.prototype.addActorOccupation=function(e){var t=e.cellId,i=this.occupiedCells[t];if(void 0===i)this.occupiedCells[t]=[e];else{var n=i.indexOf(e);n===-1?i.push(e):console.warn("[ActorManager.addActorOccupation] Trying to add an actor to a cell that it already belongs to",e)}},n.prototype.computeFollowerPosition=function(e){var t=a.getMapPointFromCellId(e);t.i=t.x,t.j=t.y;for(var i=1;Math.random()<i;){var n=r.getAccessibleCells(t.i,t.j),o=n.length;if(0===o)break;for(var s=[],l=0,c=0;c<o;c++){var d=n[c],u=a.getCellIdFromMapPoint(d.i,d.j),h=void 0===this.occupiedCells[u]?1:g;s[c]=h,l+=h}for(var p=0,m=l*Math.random()-s[0];m>0&&p<o;)p+=1,m-=s[p];t=n[p===o?p-1:p],e=a.getCellIdFromMapPoint(t.i,t.j),i=this.occupiedCells[e]?.995:.8}return e},n.prototype.addActorFollowers=function(e,t,i){var n=t.length;if(0!==n&&s.showAllMonsters){null===e.followers&&(e.followers=[]);for(var o=e.actorId,a=0;a<n;a++){var r=t[a],l=o+":follower:"+a,c=this.getActor(l);if(!c){var d=this.computeFollowerPosition(e.cellId);c=this.addEmptyActor({contextualId:l,disposition:{cellId:d,direction:1+2*Math.round(3*Math.random())}}),c.isFollower=!0,i===!0?c.isolationCoefficient=b:c.isolationCoefficient=y,e.followers.push(c),c.groupBoss=e,c.data=e.data,this.followers.push(c)}this.setActorLook(l,r.look)}}},n.prototype.removeActorFollowers=function(e){var t=e.followers,i=[];if(t&&t.length){for(var n=0;n<t.length;n++){var o=t[n];i.push(o.actorId);var s=this.followers.indexOf(o);s!==-1&&this.followers.splice(s,1)}this.removeActors(i)}},n.prototype.addAnimBehaviourToActor=function(e,t){var i=this.actors[e];return i?this.customAnimMethods[e]?console.warn("ActorManager.addAnimBehaviourToActor: actor "+e+" already has a custom animation"):this.followers.indexOf(i)!==-1?console.error(new Error("ActorManager.addAnimBehaviourToActor: cannot add an anim behaviour to a follower")):"function"!=typeof t?console.error(new Error("ActorManager.addAnimBehaviourToActor: animationMethod is not a function")):void(this.customAnimMethods[e]=t):console.error(new Error("ActorManager.addAnimBehaviourToActor: actor "+e+" unknown"))},n.prototype._moveFollower=function(e){if(e.moving!==!0){var t=e.cellId,i=a.getMapPointFromCellId(t),n=a.getMapPointFromCellId(e.groupBoss.cellId),o=i.x,s=i.y,l=n.x-o,c=n.y-s,d=Math.sqrt(l*l+c*c);if(1===this.occupiedCells[t].length){var u=.95/(1+(d-1)*e.isolationCoefficient);if(e.groupBoss.moving===!0&&(u*=.8),Math.random()<u)return}for(var h,p={i:i.x,j:i.y},m=[t],f=1;Math.random()<f;){var v=r.getAccessibleCells(p.i,p.j),y=v.length;if(0===y)return;for(var b=[],M=0,w=0;w<y;w++){var T=v[w],C=a.getCellIdFromMapPoint(T.i,T.j),A=void 0===this.occupiedCells[C]?1:g,I=T.i-p.i,S=T.j-p.j;A*=0===I&&0===S?g*g:0===I?Math.pow(_,c/S):Math.pow(_,l/I),b[w]=A,M+=A}for(var E=0,x=M*Math.random()-b[0];x>0&&E<y;)E+=1,x-=b[E];p=v[E===y?E-1:E],h=a.getCellIdFromMapPoint(p.i,p.j),m.push(h),f=1-1/(1+.5*d)}e.setCellPosition(h),e.setPath(m)}},n.prototype.refresh=function(){for(var e in this.customAnimMethods)this.customAnimMethods[e]();var t=this.followers.length;if(t>0){var i=Object.keys(this.actors).length;if(Math.random()>Math.min(.1,v/i))return;for(var n=0;n<t;n++)this._moveFollower(this.followers[n])}},n.prototype.updateActorsAggressableStatus=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=t[i],s=this.getActor(n);if(s&&s.data.humanoidInfo&&s.data.humanoidInfo.options)for(var a=s.data.humanoidInfo.options,r=0;r<a.length;r++){var l=a[r];if("HumanOptionAlliance"===l._type){l.aggressable=o,s.addConquestIcon(l);break}}}},n.prototype.addSmileyOnActor=function(e,t){var i=this.getActor(e);i&&i.addSmileyIcon(t)},n.prototype.setReadyIconOnActor=function(e,t){void 0===t&&(t=!1);var i=this.getActor(e);i&&(t?i.addReadyIconOnActor():i.removeReadyIconOnActor())},n.prototype.removeReadyIcon=function(){for(var e=Object.keys(this.actors),t=e.length,i=0;i<t;i++){var n=this.actors[e[i]];n.removeReadyIconOnActor()}this.userActor.removeReadyIconOnActor()},n.prototype.setTransparentMode=function(e){if(this.isTransparentModeOn!==e){var t,i;e?(t=l.MAP_LAYER_TRANSPARENT,i=l.TRANSPARENT_MODE_ALPHA):(t=l.MAP_LAYER_PLAYGROUND,i=1);for(var n in this.actors){var o=this.actors[n];o.layer=t,o.alpha=i}this.userActor.layer=t,this.userActor.alpha=i,this.isTransparentModeOn=e}},n.prototype.checkCreatureMode=function(e){var t=Object.keys(this.actors).length+e+1,i=s.maxActorsBeforeCreatureMode<t;i=i||f.getValue("creatureMode",!1),this.setCreatureMode(i)},n.prototype.onMaxActorsBeforeCreatureModeChange=function(e){var t=Object.keys(this.actors).length+1,i=e<t;i=i||f.getValue("creatureMode",!1),this.setCreatureMode(i)},n.prototype.setCreatureMode=function(e){if(e!==this.isCreatureModeOn){if(!e)return this._exitCreatureMode();this.isCreatureModeOn=!0;for(var t in this.actors){var i=this.actors[t];i.setCreatureLook(),i.fighterIndicator&&(i.fighterIndicator.y=i.bbox[2]-i.y)}this.userActor.setCreatureLook()}},n.prototype._exitCreatureMode=function(){if(this.isCreatureModeOn){this.isCreatureModeOn=!1;for(var e in this.actors){var t=this.actors[e];t.useRealLook(),t.fighterIndicator&&(t.fighterIndicator.y=t.bbox[2]-t.y)}this.userActor.useRealLook()}},n.prototype.getPlayers=function(e){var t=[];for(var i in this.actors){var n=this.actors[i];n.data&&(n.data.playerId||0===n.data.playerId)&&t.push(n)}return e&&t.push(this.userActor),t},n.prototype.turnIndicatorOff=function(){window.isoEngine.mapRenderer.removeMovementFeedback()},n.prototype.turnIndicatorOn=function(e){if(window.isoEngine.mapRenderer.map){this.turnIndicatorOff();var t=this.getActor(e.id);if(t){var i=t.getFighterData(),n=t.getTeamId(),o=e.data.disposition.cellId;if(o!==-1)if(i.isCarryied&&t.parentActor){var s=t.parentActor.bbox[2]+(t.bbox[3]-t.bbox[2]);u.addTurnFeedback({x:t.parentActor.x,y:s,position:o},n)}else u.addTurnFeedback({x:t.x,y:t.y,position:o},n)}}},n.prototype.removeTeamCircles=function(){this.userActor.removeTeamCircle();for(var e=0;e<this.actors.length;e++){var t=this.actors[e];t.removeTeamCircle()}},n.prototype.selectionIndicatorOff=function(e){var t=this.getActor(e.id);t&&t.fighterIndicator&&t.fighterIndicator.remove()},n.prototype.selectionIndicatorOn=function(e){var t=this.getActor(e.id);t&&(t.fighterIndicator&&t.fighterIndicator.remove(),e.data.disposition.cellId!==-1&&(t.fighterIndicator=new h(t.x,t.bbox[2]-12)))},n.prototype.removeAllFighterIndicators=function(){this.userActor.fighterIndicator&&this.userActor.fighterIndicator.remove();for(var e=0;e<this.actors.length;e++){var t=this.actors[e];t.fighterIndicator&&t.fighterIndicator.remove()}},n.prototype.turnNumberOn=function(e,t){function i(e,i){i||(i=e===o.userActor.actorId?o.userActor:o.actors[e]),""===t?i.removeTurnNumber():i.addTurnNumber(t)}var n,o=this;n=e===this.userActor.actorId?this.userActor:this.actors[e],n?i(e,n):this._onIdAdded[e]=i},n.prototype.areNicknamesOn=function(){return this._nickNamesOn},n.prototype.turnNicknamesOn=function(){this._nickNamesOn=!0;for(var e in this.actors){var t=this.actors[e];t.data.name&&t.addNicknameLabel(t.data.name)}this.userActor.addNicknameLabel(this.userActor.data.name)},n.prototype.turnNicknamesOff=function(){this._nickNamesOn=!1;for(var e in this.actors)this.actors[e].removeNicknameLabel();this.userActor.removeNicknameLabel()},n.prototype.debugActorIdsOn=function(){for(var e in this.actors)this.actors[e].addNicknameLabel(e);this.userActor.addNicknameLabel(this.userActor.actorId)},n.prototype.debugActorIdsOff=function(){for(var e in this.actors)this.actors[e].removeNicknameLabel();this.userActor.removeNicknameLabel()},n.prototype.addedActor=function(e){var t=this._onIdAdded[e];t&&(t(e),delete this._onIdAdded[e])},n.prototype.allTurnNumbersOff=function(){for(var e in this.actors)this.actors[e].removeTurnNumber();this.userActor.removeTurnNumber()},n.prototype.refreshFighter=function(e){var t=window.actorManager.getActor(e.informations.contextualId);if(t){window.gui.transmitFightSequenceMessage(e),t.setDisposition(e.informations.disposition.cellId,e.informations.disposition.direction);var i={};t.setLook(e.informations.look,i,function(){t.applyLook({look:e.informations.look})})}},n.prototype.clearQueuedToCarryActors=function(){this._queuedToCarryActors={}}},function(e,t){e.exports={10:!0,11:!0,20:!0,21:!0,30:!0,31:!0,40:!0,41:!0,50:!0,51:!0,60:!0,61:!0,70:!0,71:!0,80:!0,81:!0,90:!0,91:!0,100:!0,101:!0,110:!0,111:!0,120:!0,121:!0,1405:!0,1407:!0,1437:!0,1438:!0,1663:!0,1664:!0}},function(e,t,i){function n(e,t){this.vertices=[{x:-40,y:60,r:1,g:0,b:0,a:1},{x:40,y:60,r:1,g:0,b:0,a:1},{x:-30,y:50,r:1,g:1,b:0,a:.3},{x:30,y:50,r:1,g:1,b:0,a:.3},{x:-40,y:40,r:1,g:0,b:0,a:1},{x:-30,y:45,r:1,g:1,b:0,a:.3},{x:30,y:45,r:1,g:1,b:0,a:.3},{x:40,y:40,r:1,g:0,b:0,a:1},{x:0,y:10,r:1,g:1,b:0,a:.5},{x:0,y:0,r:1,g:0,b:0,a:1}],this.triangles=[[1,0,2],[2,0,4],[4,5,2],[8,5,4],[4,9,8],[8,9,7],[7,6,8],[3,6,7],[7,1,3],[2,3,1],[3,2,5],[5,6,3],[5,8,6]];var i={scene:window.isoEngine.mapScene,position:1,layer:1,x:e,y:t,id:"FighterIndicator"+d++};o.call(this,i),this._indicatorByteSize=this.renderer.getNbBytesPerVertex()*this.triangles.length*l,this.updated=!0,this.red=1,this.green=1,this.blue=0,this.alpha=1,this.sx=.4,this.sy=.4,this.rotation=Math.PI,this._buffer=new ArrayBuffer(this._indicatorByteSize),this._vertexBuffer=new Float32Array(this._buffer),this._colorBuffer=new Uint32Array(this._buffer),this.loadIndicator(),this.renderer.releaseBuffer(i.id),this.forceRefresh();var n=this,s=this.sx,c=this.sy,u=this.green,h=this.alpha;this.tween=new a(this,["scaleX","scaleY","green","alpha"]).from({scaleX:s,scaleY:c,green:u,alpha:h}).to({scaleX:.25,scaleY:.25,green:.8,alpha:.7},7,r.sineIn).to({scaleX:s,scaleY:c,green:u,alpha:h},7,r.sineOut).onUpdate(function(){n.loadIndicator()}).start(!0)}var o=i(375),s=i(172).inherits,a=i(392).Tween,r=i(392).easing,l=3,c=5,d=0;s(n,o),e.exports=n,n.prototype.loadIndicator=function(){for(var e=1/0,t=-(1/0),i=1/0,n=-(1/0),o=0;o<this.triangles.length;o++)for(var s=0;s<l;s++){var a=(o*l+s)*c,r=this.vertices[this.triangles[o][s]],d=r.x,u=r.y,h=Math.max(-128,Math.min(127,64*r.r)),p=Math.max(-128,Math.min(127,64*this.green)),m=Math.max(-128,Math.min(127,64*r.b)),f=Math.max(-128,Math.min(127,64*(this.alpha&&r.a))),g=(f<<24&4278190080)+(m<<16&16711680)+(p<<8&65280)+(255&h);this._vertexBuffer[a]=d,this._vertexBuffer[a+1]=u,this._colorBuffer[a+3]=g,e>d?e=d:t<d&&(t=d),i>u?i=u:n<u&&(n=u)}this._bbox=[e,t,i,n],this.updated=!0},n.prototype.render=function(){this.renderer.save(),this.renderer.translate(this._x,this._y),0!==this._rotation&&this.renderer.rotate(this._rotation),this.renderer.scale(this._scaleX,this._scaleY),this.updated&&(this.renderer.drawBoxBatch(this.id),this.renderer.releaseBuffer(this.id),this.updated=!1,this.forceRefresh()),this.renderer.restore()},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=!1;this.renderer.loadSpriteBuffer(t,this._vertexBuffer,null,this._bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)},n.prototype.remove=function(){this.tween&&this.tween.stop(),o.prototype.remove.call(this)}},function(e,t,i){function n(e,t){t.push(function(t){return window.gui.transmitFightSequenceMessage(e),t()})}function o(e){window.dofus.connectionManager.emit(e._messageType,e)}function s(e,t){var i=window.actorManager.getActor(e.sourceId);i&&t.push(function(t){window.gui.transmitFightSequenceMessage(e),i.oneShootAnim({base:"AnimTacle"},!0,t)})}function a(e,t){if(e._spell)return n(e,t);var i=window.actorManager,o=i.getActor(e.targetId);t.push(function(t){function n(){i.userActor.isDead||!window.gui.fightManager.isFightersTurn(i.userActor.actorId)||window.gui.fightManager.getIsTurnEndRequestPending()||window.isoEngine.displayUserMovementZone(),t()}return window.gui.transmitFightSequenceMessage(e),o?void o.death(n):(console.warn("Actor "+e.targetId+" not found."),t())})}function r(e,t){t.push(function(t){window.gui.transmitFightSequenceMessage(e),e._summon.show(),t()})}function l(e,t){e._doNotProcess||t.push(function(t){window.gui.transmitFightSequenceMessage(e);var i=window.actorManager.getActor(e.targetId);i.applyLook(e._loadedLook),t()})}function c(e,t){t.push(function(t){window.actorManager.refreshFighter(e),t()})}function d(){f=!0,g=!1,_=!1,v=null,y=!1,b=null,M=[]}function u(){return f?(window.gui.transmitFightSequenceMessage({_messageType:"confirmTurnEnd"}),window.dofus.sendMessage("GameFightTurnReadyMessage",{isReady:!0}),void(g=!1)):void(g=!0)}function h(e){return f?(v._synchronizeBuff=e,window.gui.transmitFightSequenceMessage(v),_=!1,void(v=null)):void(_=!0)}function p(){return window.actorManager.removeAllFighterIndicators(),window.actorManager.allTurnNumbersOff(),f?(window.gui.transmitFightSequenceMessage(b),y=!1,b=null,void(window.actorManager.userActor.isDead=!1)):void(y=!0)}function m(e){function t(){function e(){return f=!0,M.length?(_&&h(!1),m(M.shift())):(window.dofus.sendMessage("GameActionAcknowledgementMessage",{valid:!0,actionId:s.actionId}),_&&h(!0),y?p():void(g&&u()))}try{window.gui.fightManager.finishFightSequence(e)}catch(t){console.error(t),e()}}var i=window.isoEngine;if(!i.mapRenderer.isReady)return i.once("mapLoaded",function(){m(e)});if(window.gui.fightManager.fightState!==L.UNDEFINED){if(!f)return void M.push(e);f=!1;var n=e.sequence,o=n.shift(),s=n.pop();return o.sequenceType!==s.sequenceType?console.error(new Error("Different sequenceType")):o.authorId!==s.authorId?console.error(new Error("Different authorId")):void T(n,function(e){if(e)return console.error(e),t();for(var i=[],o=0;o<n.length;o++){var s=n[o],a=O[s._messageType];void 0!==a?a&&a(s,i):console.error(new Error("[process messageSequence] Unsupported game action: "+s._messageType))}try{w.series(i,function(e){e&&console.error(e),t()})}catch(r){console.error(r),t()}})}}var f,g,_,v,y,b,M,w=i(31),T=i(1210),C=i(1216),A=i(1218),I=i(1220),S=i(1221),E=i(1222),x=i(1223),N=i(258),L=i(347).FIGHT_STATES,O={GameMapMovementMessage:I.mapMovement,GameActionFightSlideMessage:I.slideMovement,GameActionFightTeleportOnSameMapMessage:I.teleport,GameActionFightExchangePositionsMessage:I.exchangePositions,GameActionFightCloseCombatMessage:C,GameActionFightSpellCastMessage:C,GameActionFightLifePointsGainMessage:A.lifePointVariation,GameActionFightLifePointsLostMessage:A.lifePointVariation,GameActionFightLifeAndShieldPointsLostMessage:A.lifePointVariation,GameActionFightPointsVariationMessage:A.actionOrMovementPointVariation,GameActionFightDispellableEffectMessage:A.buffVariation,GameActionFightMarkCellsMessage:S.addMark,GameActionFightUnmarkCellsMessage:S.removeMark,GameActionFightTriggerGlyphTrapMessage:S.triggerGlyphTrap,GameActionFightVanishMessage:E.vanish,GameActionFightInvisibilityMessage:E.setVisibility,GameActionFightInvisibleDetectedMessage:E.detected,GameActionFightInvisibleObstacleMessage:null,GameActionFightCarryCharacterMessage:x.carryCharacter,GameActionFightThrowCharacterMessage:x.throwCharacter,GameActionFightDropCharacterMessage:x.dropCharacter,GameActionFightSummonMessage:r,GameActionFightChangeLookMessage:l,GameActionFightTackledMessage:s,_GameActionFightLeaveMessage:a,GameActionFightDeathMessage:a,GameActionFightKillMessage:a,GameActionFightDispellEffectMessage:n,GameActionFightDispellSpellMessage:n,GameActionFightDispellMessage:n,GameActionFightSpellCooldownVariationMessage:n,GameActionFightSpellImmunityMessage:n,GameActionFightReduceDamagesMessage:n,GameActionFightReflectDamagesMessage:n,GameActionFightReflectSpellMessage:n,GameActionFightModifyEffectsDurationMessage:n,GameActionFightDodgePointLossMessage:n,GameFightTurnListMessage:n,GameActionFightStealKamaMessage:null,GameActionFightTriggerEffectMessage:null,GameFightRefreshFighterMessage:c,TextInformationMessage:o,FighterStatsListMessage:n,SequenceStartMessage:null,SequenceEndMessage:null};d(),t.initialize=function(e){function t(e){S.syncMarks(e.marks)}e.on("messageSequence",m),e.on("GameFightTurnReadyRequestMessage",u),e.on("GameFightSynchronizeMessage",function(e){v=e,h(!1)}),e.on("disconnect",function(){d()}),e.on("GameFightLeaveMessage",function(t){var i=t.charId===window.actorManager.userId,n=window.gui,o=n.fightManager.fightState;if(o===L.BATTLE){var s=n.fightManager.getFighter(t.charId);if(s&&s.data.alive){var a={_messageType:"messageSequence",sequence:[{_messageType:"SequenceStartMessage"},{_messageType:"_GameActionFightLeaveMessage",actionId:0,sourceId:0,targetId:t.charId},{_messageType:"SequenceEndMessage"}]};e.emit("messageSequence",a)}}n.transmitFightSequenceMessage(t),i&&e.emit("GameFightEndMessage",{_messageType:"GameFightEndMessage"})}),e.on("FighterStatsListMessage",function(t){var i=window.gui,n=i.fightManager.fightState;if(n===L.BATTLE){var o={_messageType:"messageSequence",sequence:[{_messageType:"SequenceStartMessage"},t,{_messageType:"SequenceEndMessage"}]};e.emit("messageSequence",o)}else i.transmitFightSequenceMessage(t)}),e.on("GameFightEndMessage",function(e){window.actorManager.removeInvisibilityOfAllActors(),b=e,p()}),e.on("GameFightSpectateMessage",t),e.on("GameFightResumeMessage",t),e.on("GameFightResumeWithSlavesMessage",t),e.on("GameContextDestroyMessage",function(){N.isRoleplayMode||f||(y&&window.gui.transmitFightSequenceMessage(b),d())})},t.getMarkedCells=S.getMarkedCells},function(e,t,i){function n(e,t){var i=t.actors;return i[e]||(i[e]={}),i[e]}function o(e,t){var i=n(e,t);if(!i.position&&0!==i.position){var o=window.actorManager.getActor(e);if(!o)return console.error("No actor "+e);i.position=o.cellId,i.direction=o.direction}return i}function s(e,t,i,n){if(0!==t){var s=window.actorManager.getActor(t);if(!s||s.animManager.isTemporary)return console.warn("No actor",t);i.direction=o(t,n).direction,e.addAnimation(s,i)}}function a(e,t){var i=x.getMapPointFromCellId(e),n=x.getMapPointFromCellId(t),o=x.getCoordinateSceneFromGrid(i),s=x.getCoordinateSceneFromGrid(n),a=s.y-o.y,r=s.x-o.x;return Math.atan2(a,r)}function r(e,t,i,n,o,s,r,l,c){o=o||0;var d=N.cellCoord[s];if(d){var u=new P({scene:window.isoEngine.mapScene,position:s,x:d.x,y:d.y-(r||0)});if(c){var h;h=c===W.TOWARD_POSITION2?a(s,l):a(l,s),u.rotation=F[o]?h+Math.PI:h}return t["_"+n+"Orientation"]=o,t["_"+n]=u,e.loadAnimationManager(u,i+"/FX"),u}}function l(e,t,i){var n=window.actorManager,o=n.getActor(t);if(!o)return void console.warn("Source actor does not exist");var s=new R({actorId:i+":"+t,position:o.position,scene:n.scene});return e.loadAnimationManager(s,i+"/FX"),s}function c(e,t,i){t._missileGfx=l(e,t.sourceId||t.casterId,i)}function d(e,t,i,n,o,s,a,l,c,d){var u=p(l,s),h=m(c,l,"casterGfx"===n);return r(e,t,i,n,u,o,a,d,h)}function u(e,t,i,n,o){function s(i,n){var o=a.getCoordinateCellIdFromGrid({i:i,j:n});E&&b===o&&(x=!0,y.stop());var s=d(e,t,c,"trailGfx",o,u,T,C,A,h);s&&(s.scaleX=S,s.scaleY=S,N.push(s))}var a=window.isoEngine.mapRenderer.grid,r=window.actorManager.getActor(t.sourceId||t.casterId),l=t._scriptParams,c=l.trailGfxId,u=i.direction,h=r.position,p=a.getCoordinateGridFromCellId(h),m=p.i,f=p.j,g=a.getCoordinateGridFromCellId(t.destinationCellId||t.targetCellId),_=g.i,v=g.j,y=new D;y.set(m,f,_,v);var b,M=1+(l.trailGfxMinScale||0)/10,w=1+(l.trailGfxMaxScale||0)/10,T=l.targetGfxYOffset2,C=l.trailDisplayType,A=l.targetGfxOriented2,I=t.spellLevel/6,S=w*I+M*(1-I),E=l.endTrailOnTarget,x=!1;E&&(b=n.position);var N=[];y.exec(s);for(var L=Object.keys(o),O=[],R=0;R<L.length&&!x;R++)O.push(o[L[R]]);var P=z.createPropertyNameCompareFunc("distanceToPlayer");O.sort(P);for(var B=1;B<O.length&&!x;B++){var k=O[B],F=a.getCoordinateGridFromCellId(k.cellId);s(F.i,F.j)}t._trailGfxs=N,t._trailGfxsOrientation=u}function h(e,t,i,n){if(t._scriptParams.useSpellZone){e.addWaitingRequest();var o=t.sourceId||t.casterId,s=t.destinationCellId||t.targetCellId,a=t.spellId,r=t.spellLevel;window.gui.fightManager.getFighterSpell(a,o,function(o,a){var l;if(o)console.error(o),l=[];else{var c=a;if(c.setLevel(r),!window.isoEngine.mapRenderer.map||!window.isoEngine.mapRenderer.map.cells)return;var d=window.isoEngine.mapRenderer.map.cells;l=B(d,i.position,s,c.getZoneEffect())}u(e,t,i,n,l),e.removeWaitingRequest()})}else u(e,t,i,n,[])}function p(e,t){switch(e){case q.RANDOM:return Math.floor(8*Math.random());case q.ORIENTED:return t;default:return 0}}function m(e,t,i){return t===q.ORIENTED?W.NONE:e?i?W.TOWARD_POSITION2:W.TOWARD_POSITION1:W.NONE}function f(e){var t=window.actorManager.getActor(e);if(!t)return!1;var i=t.getTeamId(),n=window.actorManager.userActor.getTeamId();return i===n||!t.isInvisible}function g(e,t,i){var n="GameActionFightCloseCombatMessage"===t._messageType,a="GameRolePlaySpellAnimMessage"===t._messageType,l=t.sourceId||t.casterId,u=o(l,i);if(u){if(t.destinationCellId!==-1&&u.position!==t.destinationCellId){var p=x.getOrientation(u.position,t.destinationCellId,!1);u.direction=p,t._casterOrientation=p}if(!t.silentCast){var m,g;if(t.targetId){if(m=o(t.targetId,i),!m)return;g=f(t.targetId)?m.position:null}else m={direction:1};var _=g||t.destinationCellId||t.targetCellId;t._targetCellId=_;var v=t._scriptParams||{};if(v.casterGfxId&&d(e,t,v.casterGfxId,"casterGfx",u.position,u.direction,v.casterGfxYOffset,v.casterGfxDisplayType,v.casterGfxOriented,_),v.targetGfxId&&d(e,t,v.targetGfxId,"targetGfx",_,u.direction,v.targetGfxYOffset,v.targetGfxDisplayType,v.targetGfxOriented,u.position),v.targetGfxId2&&d(e,t,v.targetGfxId2,"targetGfx2",_,u.direction,v.targetGfxYOffset2,v.targetGfxDisplayType2,v.targetGfxOriented2,u.position),a){var y=v.animId;y&&(v.targetGfxId2&&console.error(new Error("Message contains a targetGfdId2 and ")),r(e,t,y,"targetGfx2",1,_)),t._spellAnimSymbol={base:"AnimAttaque",type:403}}else v.missileGfxId&&c(e,t,v.missileGfxId),n?t._spellAnimSymbol={base:"AnimArme",type:t._weaponTypeId||0}:void 0!==v.animId&&(t._spellAnimSymbol={base:"AnimAttaque",type:v.animId});v.trailGfxId&&h(e,t,u,m),t._spellAnimSymbol&&s(e,l,t._spellAnimSymbol,i);for(var b=t._lifeVariationMsgs||[],M=t._deadIds,w=0;w<b.length;w++){var T=b[w],C=T.targetId;M&&M.indexOf(C)!==-1?T._isDead=!0:b[w].loss&&s(e,C,{base:"AnimHit"},i)}}}}function _(e,t,i){var n=window.actorManager.getActor(t.sourceId);n&&!n.animManager.isVoidAnimManager&&(e.addAnimation(n,{base:"carrying",direction:-1}),s(e,t.sourceId,{base:"AnimPickup"},i),t._direction=o(t.sourceId,i).direction)}function v(e,t,i){s(e,t.sourceId,{base:"AnimDrop"},i),t._direction=o(t.sourceId,i).direction}function y(e,t,i){s(e,t.sourceId,{base:"AnimThrow"},i),t._throwingProjectile=l(e,t.sourceId,H),t._direction=o(t.sourceId,i).direction}function b(e,t){window.gui.fightManager.loadFighter(t);var i=e.loadActor(t.summon);i.hide(),t._summon=i}function M(e,t,i){var o=n(t.targetId,i);if(o.look!==t.entityLook)return void(t._doNotProcess=!0);var s=window.actorManager.getActor(t.targetId);e.loadLook(t,s,t.entityLook)}function w(e,t){var i=t.informations,n=window.actorManager.getActor(i.contextualId);e.loadLook(t,n,i.look)}function T(e,t,i){s(e,t.targetId,{base:"AnimMort"},i),t._animSymbol="AnimMort"}function C(e,t,i){s(e,t.targetId,{base:"AnimHit"},i),t._animSymbol="AnimHit"}function A(e,t,i){s(e,t.sourceId,{base:"AnimTacle"},i)}function I(e,t,i){s(e,t.targetId,{base:"AnimVanish"},i)}function S(e,t){var i=t.mark;i._glyphGfxId&&r(e,i,i._glyphGfxId,"glyph",0,0)}function E(e,t){if(this instanceof E==!1)return new E(e,t);var i=L(e);this.nAssetsToLoad=1,this.nAssetsLoaded=0;var n=this;this.onAssetsLoaded=function(){n.nAssetsLoaded+=1,n.nAssetsLoaded===n.nAssetsToLoad&&t()};for(var o=0;o<e.length;o++){var s=e[o],a=U[s._messageType];a&&a(this,s,i)}this.onAssetsLoaded()}var x=i(794),N=i(670),L=i(1211),O=i(167),D=i(1212),R=i(1213),P=i(379),B=i(1215).getSpellEffectZone,k=i(380),z=i(339),F=O.ANIM_SYMETRY,H="21209",q={NORMAL:0,RANDOM:1,ORIENTED:2},W={NONE:0,TOWARD_POSITION1:1,TOWARD_POSITION2:2},U={GameActionFightSpellCastMessage:g,GameActionFightCloseCombatMessage:g,GameActionFightChangeLookMessage:M,GameActionFightSummonMessage:b,GameActionFightDeathMessage:T,GameActionFightKillMessage:T,GameActionFightTackledMessage:A,GameActionFightMarkCellsMessage:S,GameActionFightCarryCharacterMessage:_,GameActionFightThrowCharacterMessage:y,GameActionFightDropCharacterMessage:v,_GameActionFightLeaveMessage:T,GameActionFightVanishMessage:I,GameActionFightLifeAndShieldPointsLostMessage:C,GameActionFightLifePointsLostMessage:C,GameFightRefreshFighterMessage:w,GameRolePlaySpellAnimMessage:g};E.prototype.addAnimation=function(e,t){this.nAssetsToLoad+=1,e.animManager.addAnimation(t,this.onAssetsLoaded)},E.prototype.loadAnimationManager=function(e,t){this.nAssetsToLoad+=1,k.loadAnimationManager(e,"bone",t,this.onAssetsLoaded)},E.prototype.loadActor=function(e){return this.nAssetsToLoad+=1,window.actorManager.addActor(e,this.onAssetsLoaded)},E.prototype.loadLook=function(e,t,i){this.nAssetsToLoad+=1;var n=this.onAssetsLoaded,o={addToSprite:!1};k.loadLook(t,i,o,function(t){e._loadedLook={animationManager:t,look:i},n()})},E.prototype.addWaitingRequest=function(){this.nAssetsToLoad+=1},E.prototype.removeWaitingRequest=function(){this.nAssetsToLoad-=1},e.exports=function(e,t){E(e,t)}},function(e,t,i){function n(){m={},f=null}function o(e){return m[e]||(m[e]={id:e}),m[e]}function s(e){var t=o(e.targetId);return t?(t.death=!0,void(f&&(e._spell=f,f._deathMsgs.push(e),f._deadIds.push(e.targetId)))):console.error("Actor "+e.targetId+" not found.")}function a(e){var t=o(e.sourceId);t.tackled=!0}function r(e){f&&(e._spell=f,f._pointVariationMsgs.push(e))}function l(e){f&&(e._spell=f,f._lifeVariationMsgs.push(e))}function c(e){var t=window.actorManager.getActor(e.targetId);t&&t.setOnScreenPosition(e.cellId)}function d(e){var t=o(e.targetId);t.look=e.entityLook}function u(e){var t=e.summon.contextualId,i=o(t),n=e.summon.disposition;i.position=n.cellId,i.direction=n.direction,i.isSummoned=!0,f&&(f.targetId=t)}function h(e){f=e,f._deathMsgs=[],f._deadIds=[],f._lifeVariationMsgs=[],f._pointVariationMsgs=[]}function p(e){if(e.cellId!==-1){var t=window.actorManager.getActor(e.sourceId);t&&1===g.getDistance(t.cellId,e.cellId)&&(e._messageType="GameActionFightDropCharacterMessage")}}var m,f,g=i(794),_={GameActionFightCloseCombatMessage:h,GameActionFightSpellCastMessage:h,GameMapMovementMessage:null,GameActionFightSlideMessage:null,GameActionFightPointsVariationMessage:r,GameActionFightLifeAndShieldPointsLostMessage:l,GameActionFightLifePointsGainMessage:l,GameActionFightLifePointsLostMessage:l,GameActionFightTeleportOnSameMapMessage:null,GameActionFightExchangePositionsMessage:null,GameActionFightSummonMessage:u,GameActionFightMarkCellsMessage:null,GameActionFightUnmarkCellsMessage:null,GameActionFightChangeLookMessage:d,GameActionFightInvisibilityMessage:null,_GameActionFightLeaveMessage:s,GameActionFightDeathMessage:s,GameActionFightKillMessage:s,GameActionFightVanishMessage:null,GameActionFightTriggerEffectMessage:null,GameActionFightDispellEffectMessage:null,GameActionFightDispellSpellMessage:null,GameActionFightDispellMessage:null,GameActionFightDodgePointLossMessage:null,GameActionFightSpellCooldownVariationMessage:null,GameActionFightSpellImmunityMessage:null,GameActionFightInvisibleObstacleMessage:null,GameActionFightReduceDamagesMessage:null,GameActionFightReflectDamagesMessage:null,GameActionFightReflectSpellMessage:null,GameActionFightStealKamaMessage:null,GameActionFightTackledMessage:a,GameActionFightTriggerGlyphTrapMessage:null,GameActionFightDispellableEffectMessage:null,GameActionFightModifyEffectsDurationMessage:null,GameActionFightCarryCharacterMessage:null,GameActionFightThrowCharacterMessage:p,GameActionFightDropCharacterMessage:null,GameActionFightInvisibleDetectedMessage:c,GameFightTurnListMessage:null,GameRolePlaySpellAnimMessage:null};e.exports=function(e){n();for(var t=0;t<e.length;t++){var i=e[t],o=_[i._messageType];o&&o(i)}return{actors:m}}},function(e,t){function i(){this.sourceX=0,this.sourceY=0,this.targetX=0,this.targetY=0,this.x=0,this.y=0,this.incX=0,this.incY=0,this.error=0,this.deltaError=0,this._stop=!1,this.cb=null}e.exports=i,i.prototype.set=function(e,t,i,n){this.sourceX=~~e||0,this.sourceY=~~t||0,this.targetX=~~i||0,this.targetY=~~n||0},i.prototype.exec=function(e){var t=[];e&&"function"==typeof e||(e=function(e,i){t.push([e,i])}),this.cb=e,this._stop=!1,
this.error=0,this.deltaError=0,this.x=this.sourceX,this.y=this.sourceY;var i=this.targetX-this.sourceX,n=this.targetY-this.sourceY,o=Math.abs(i),s=Math.abs(n);this.incX=i>0?1:-1,this.incY=n>0?1:-1;var a;for(0===i&&0===n?(this._stop=!0,a=null):0===i?a=this._vertical:0===n?a=this._horizontal:o===s?a=this._equalSlope:o>s?(a=this._xSlope,this.deltaError=s/o):(a=this._ySlope,this.deltaError=o/s);!this._stop;)a.apply(this),this.x===this.targetX&&this.y===this.targetY&&(this._stop=!0),this.cb(this.x,this.y,!0);return t},i.prototype.stop=function(){this._stop=!0},i.prototype._horizontal=function(){this.x+=this.incX},i.prototype._vertical=function(){this.y+=this.incY},i.prototype._equalSlope=function(){this.x+=this.incX,this.y+=this.incY},i.prototype._xSlope=function(){this.error+=this.deltaError,this.error>=.5&&(this.y+=this.incY,this.error-=1),this.x+=this.incX},i.prototype._ySlope=function(){this.error+=this.deltaError,this.error>=.5&&(this.x+=this.incX,this.error-=1),this.y+=this.incY}},function(e,t,i){function n(e){s.call(this,e,e.animManager),this.actorId=void 0!==e.actorId?e.actorId:null,this.path=[],this.step=0,this.moving=!1}var o=i(172).inherits,s=i(374),a=i(392).Tween,r=i(1214).prepare(3),l=i(1212),c=i(670),d=i(794),u=new l,h={base:"FX",direction:0};o(n,s),e.exports=n,n.prototype.isFx=!0,n.prototype.isTapped=function(){return!1},n.prototype.tap=function(){},n.prototype.refreshAnimation=function(e){if(this.moving===!0){var t=this.path,i=this.step,n=~~i,o=this.prevCoords,s={x:r([this.source[0],this.bezier[0],this.target[0]],i/this.pathLength),y:r([this.source[1],this.bezier[1],this.target[1]],i/this.pathLength)};this.x=s.x,this.y=s.y;var a=s.x-o.x,l=s.y-o.y;this.rotation=Math.atan2(l,a);var c=t[n];c!==this.prevPos&&(this.position=c),this.prevPos=c,this.prevCoords=s}this._refreshAnimation(e)},n.prototype._startPath=function(e){this.animManager.assignSymbol(h,!0),this.moving=!0;var t=this;a(this,["step"]).from({step:0}).to({step:this.pathLength},this.duration).start().onFinish(function(){return t.remove(),e()})},n.prototype.launch=function(e,t,i,n,o){var s=window.isoEngine.mapRenderer.map,a=s.cells,r=this.position,l=[r],h=d.getMapPointFromCellId(r),p=d.getMapPointFromCellId(e);u.set(h.x,h.y,p.x,p.y),u.exec(function(e,t){l.push(d.getCellIdFromMapPoint(e,t))}),this.path=l,this.pathLength=l.length,this.mirrored=h.x>p.x,this.scaleY=this.mirrored?-1:1;var m=c.getCellCoord(r),f=c.getCellCoord(e),g=Math.abs(f.x-m.x),_=Math.abs(f.y-m.y),v=Math.sqrt(g*g+_*_);this.duration=v/10*t/1e3*24,m.y-=(a[r].f||0)+n,f.y-=(a[e].f||0)+n,m=[m.x,m.y],f=[f.x,f.y],this.source=m,this.target=f,this.bezier=[(m[0]+f[0])/2,(m[1]+f[1])/2-v*i],this.prevPos=r,this.prevCoords={x:2*m[0]-this.bezier[0],y:2*m[1]-this.bezier[1]},this._startPath(o)}},function(e,t){function i(e,t){return n(e.length)(e,t)}function n(e){if(e=0|+e,!e)throw new Error("Cannot create a interpolator with no elements");if(l[e])return l[e];for(var t=["var ut = 1 - t",""],i=e;i--;){for(var n=0;n<i;n+=1)i+1===e?t.push("var p"+n+" = arr["+n+"] * ut + arr["+(n+1)+"] * t"):i>1?t.push("p"+n+" = p"+n+" * ut + p"+(n+1)+" * t"):t.push("return p"+n+" * ut + p"+(n+1)+" * t");i>1&&t.push("")}return t=["return function bezier"+e+"(arr, t) {",t.map(function(e){return"  "+e}).join("\n"),"}"].join("\n"),Function(t)()}function o(e){return e[0]}function s(e,t){return e[0]+(e[1]-e[0])*t}function a(e,t){var i=1-t;return(e[0]*i+e[1]*t)*i+(e[1]*i+e[2]*t)*t}function r(e,t){var i=1-t,n=e[1]*i+e[2]*t;return((e[0]*i+e[1]*t)*i+n*t)*i+(n*i+(e[2]*i+e[3]*t)*t)*t}var l={1:o,2:s,3:a,4:r};e.exports=i,e.exports.prepare=n},function(e,t,i){function n(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++)for(var a=0;a<s;a++){var r=s-a;o.push([e+a,t-r,s]),o.push([e+r,t+a,s]),o.push([e-a,t+r,s]),o.push([e-r,t-a,s])}return o}function o(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++)o.push([e-s,t,s]),o.push([e+s,t,s]),o.push([e,t-s,s]),o.push([e,t+s,s]);return o}function s(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++)o.push([e-s,t-s,s]),o.push([e-s,t+s,s]),o.push([e+s,t-s,s]),o.push([e+s,t+s,s]);return o}function a(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++)o.push([e-s,t,s]),o.push([e+s,t,s]),o.push([e,t-s,s]),o.push([e,t+s,s]),o.push([e-s,t-s,s]),o.push([e-s,t+s,s]),o.push([e+s,t-s,s]),o.push([e+s,t+s,s]);return o}function r(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++){o.push([e-s,t,s]),o.push([e+s,t,s]),o.push([e,t-s,s]),o.push([e,t+s,s]),o.push([e-s,t-s,s]),o.push([e-s,t+s,s]),o.push([e+s,t-s,s]),o.push([e+s,t+s,s]);for(var a=1;a<s;a++)o.push([e+s,t+a,s]),o.push([e+s,t-a,s]),o.push([e-s,t+a,s]),o.push([e-s,t-a,s]),o.push([e+a,t+s,s]),o.push([e-a,t+s,s]),o.push([e+a,t-s,s]),o.push([e-a,t-s,s])}return o}function l(e,t,i,n,o,s){for(var a=[],r=i;r<=n;r++){var l=e+r*o,c=t+r*s;a.push([l,c,r]);for(var d=1;d<=r;d++)a.push([l+d*s,c-d*o,r]),a.push([l-d*s,c+d*o,r])}return a}function c(e,t,i,n,o,s){var a=[];0===i&&a.push([e,t,0]);for(var r=i||1;r<=n;r++){var l=e-r*o,c=t-r*s;a.push([l+r*s,c-r*o,r]),a.push([l-r*s,c+r*o,r])}return a}function d(e,t,i,n){for(var o=[],s=i||1;s<=n;s++){o.push([e-s,t,s]),o.push([e+s,t,s]),o.push([e,t-s,s]),o.push([e,t+s,s]);for(var a=1;a<s;a++)o.push([e+s,t+a,s]),o.push([e+s,t-a,s]),o.push([e-s,t+a,s]),o.push([e-s,t-a,s]),o.push([e+a,t+s,s]),o.push([e-a,t+s,s]),o.push([e+a,t-s,s]),o.push([e-a,t-s,s])}return o}function u(e,t,i,n,o,s){for(var a=[],r=i;r<=n;r++)a.push([e+o*r,t+s*r,r]);return a}function h(e,t,i,o){return n(e,t,o,o)}function p(e,t,i,o){return n(e,t,o,y)}function m(e,t,i,n,o,s){var a=[];0===i&&a.push([e,t,0]);for(var r=i||1;r<=n;r++)a.push([e+s*r,t-o*r,r]),a.push([e-s*r,t+o*r,r]);return a}function f(e,t,i,n){for(var o=_.getMapPointFromCellId(t),s=n(o.x,o.y,0,i),a=[],r=0;r<s.length;r++){var l=_.getCellIdFromMapPoint(s[r][0],s[r][1]);if(void 0!==l){var c=e[l].l||0;1===(5&c)&&a.push(l)}}return a}var g=i(220),_=i(794),v=i(221),y=39;e.exports.getSpellRange=function(e,t,i){var a,r=_.getMapPointFromCellId(t);return a=i.castInLine&&i.castInDiagonal?o(r.x,r.y,i.minRange,i.range).concat(s(r.x,r.y,i.minRange,i.range)):i.castInLine?o(r.x,r.y,i.minRange,i.range):i.castInDiagonal?s(r.x,r.y,i.minRange,i.range):n(r.x,r.y,i.minRange,i.range)},e.exports.getCircleArea=function(e,t,i){return f(e,t,i,n)},e.exports.getCrossArea=function(e,t,i){return f(e,t,i,o)};var b={P:null,A:null,D:null,X:{fn:o,hasDirection:!1,withoutCenter:!1},L:{fn:u,hasDirection:!0,withoutCenter:!1},T:{fn:m,hasDirection:!0,withoutCenter:!1},C:{fn:n,hasDirection:!1,withoutCenter:!1},O:{fn:h,hasDirection:!1,withoutCenter:!1},"+":{fn:s,hasDirection:!1,withoutCenter:!1},G:{fn:r,hasDirection:!1,withoutCenter:!1},V:{fn:l,hasDirection:!0,withoutCenter:!1},W:{fn:d,hasDirection:!1,withoutCenter:!1},"/":{fn:u,hasDirection:!0,withoutCenter:!1},"-":{fn:m,hasDirection:!0,withoutCenter:!1},U:{fn:c,hasDirection:!0,withoutCenter:!1},Q:{fn:o,hasDirection:!1,withoutCenter:!0},"#":{fn:s,hasDirection:!1,withoutCenter:!0},"*":{fn:a,hasDirection:!1,withoutCenter:!1},I:{fn:p,hasDirection:!1,withoutCenter:!1}};e.exports.getSpellEffectZone=function(e,t,i,n){var o={},s=b[n.zoneShape];if(s){var a,r,l=_.getMapPointFromCellId(i);if(s.hasDirection){var c=_.getMapPointFromCellId(t);a=l.x===c.x?0:l.x>c.x?1:-1,r=l.y===c.y?0:l.y>c.y?1:-1}for(var d=s.withoutCenter?n.zoneMinSize||1:n.zoneMinSize,u=s.fn(l.x,l.y,d,n.zoneSize,a,r),h=0;h<u.length;h++){var p=_.getCellIdFromMapPoint(u[h][0],u[h][1]);if(void 0!==p){var m=e[p].l||0;1===(5&m)&&(o[p]=new g(p,u[h][2],window.foreground.fightIsUserTurn?v.areaOfEffect:v.areaOfEffectEnemyTurn))}}}else void 0===s&&console.error("Incorrect Effect shape id: "+n.zoneShape),o[i]=new g(i,0,window.foreground.fightIsUserTurn?v.areaOfEffect:v.areaOfEffectEnemyTurn);return o}},function(e,t,i){var n=i(1217),o=i(1218),s=i(392).Delay,a=i(171),r=i(31),l=17;e.exports=function(e,t){function i(i){t.push(function(t){return n.playGfx(e._targetGfx,e._targetGfxOrientation,p.targetGfxShowUnder,i?t:null),!i&&t()})}function c(){t.push(function(t){return n.playGfx(e._targetGfx2,e._targetGfx2Orientation,p.targetGfxShowUnder2),t()})}var d=window.actorManager,u=d.getActor(e.sourceId||e.casterId),h=e._casterOrientation;h&&t.push(function(e){return u.setDisposition(null,h),e()});var p=e._scriptParams||{};if(a.allowSpellEffects&&!e.silentCast){var m=e._spellAnimSymbol;m&&t.push(function(e){u.oneShootAnim(m,!0);var t=u.animManager.nbFrames;s(Math.min(l,t),e).start()});var f=e._targetCellId||e.destinationCellId!==-1;f&&(e._targetGfx&&p.playTargetGfxFirst&&i(),e._targetGfx2&&p.playTargetGfxFirst2&&c()),p.casterGfxId&&t.push(function(t){return n.playGfx(e._casterGfx,e._casterGfxOrientation,p.casterGfxShowUnder),t()}),e._missileGfx&&e.destinationCellId!==-1&&t.push(function(t){e._missileGfx.launch(e.destinationCellId,void 0!==p.missileSpeed?p.missileSpeed+10:10,(p.missileCurvature||0)/10,p.missileGfxYOffset||0,t)}),p.trailGfxId&&t.push(function(t){n.playGfxTrailAnimation(e._trailGfxs,e._trailGfxsOrientation,p.trailGfxShowUnder,t)}),f&&(e._targetGfx&&!p.playTargetGfxFirst&&i(),e._targetGfx2&&!p.playTargetGfxFirst2&&c())}var g=e._lifeVariationMsgs&&e._lifeVariationMsgs.length>0;g&&(o.lifePointVariationBatch(e._lifeVariationMsgs,t),t.push(function(t){for(var i=0;i<e._lifeVariationMsgs.length;i++){var n=e._lifeVariationMsgs[i];if(!(n._isDead||n.delta>0)){var o=d.getActor(n.targetId),s={base:n._animSymbol||"AnimHit"};o.oneShootAnim(s,!0)}}return t()}));var _=e._pointVariationMsgs&&e._pointVariationMsgs.length>0;_&&o.actionOrMovementPointVariationBatch(e._pointVariationMsgs,t);var v=e._deathMsgs&&e._deathMsgs.length>0;v&&t.push(function(t){function i(e,t){var i=d.getActor(e.targetId);return i?(i.isDead=!0,void i.death(t)):(console.error("Actor "+e.targetId+"not found."),t())}r.each(e._deathMsgs,i,function(){d.userActor.isDead||!window.gui.fightManager.isFightersTurn(d.userActor.actorId)||window.gui.fightManager.getIsTurnEndRequestPending()||window.isoEngine.tryDisplayUserMovementZone()}),t()}),(g||_||v)&&t.push(function(e){s(15,e).start()}),t.push(function(t){return window.gui.transmitFightSequenceMessage(e),t()})}},function(e,t,i){function n(e,t,i,n){e.position+=i?-.1:.1,e.animManager.assignSymbol({base:"FX",direction:t},!1,function(){if(e.remove(),n)return n()})}function o(e,t,i,o){new s(o,function(){n(e,t,i)}).start()}var s=i(392).Delay,a=3;t.playGfx=n,t.playGfxTrailAnimation=function(e,t,i,n){for(var r=0,l=0;l<e.length;l+=1)o(e[l],t,i,r),r+=a;new s(r,n).start()}},function(e,t,i){function n(e){var t=Date.now(),i=w[e];if(i&&t<i+T){var n=i+T;return w[e]=n,n-t}return w[e]=t,0}function o(e){var t=window.isoEngine.bitmapFonts;if(t){var i=e.maxRotation||0,o=new l({position:0,layer:c.MAP_LAYER_POINT_LABELS,bitmapFont:t.numbers,scene:window.actorManager.scene,text:e.pointVariation,color:e.color||f,x:e.x+30*(Math.random()-.5),y:e.y+30*(Math.random()-.5),rotation:(Math.random()-.5)*i});o.hide();var s=n(e.targetId)*c.TIME_UNITS_PER_SECOND/1e3;h(s,function(){d(o.highlight,["red","green","blue"]).from({red:1,green:1,blue:1}).to({red:4,green:4,blue:4},3,u.polyOut,4).to({red:1,green:1,blue:1},8,u.polyOut,4).start(),d(o,["scaleX","scaleY"]).from({scaleX:.2,scaleY:.2}).to({scaleX:1.8,scaleY:1.8},4,u.polyOut,4).to({scaleX:1,scaleY:1},10,u.polyOut,4).start();var e=o.rotation,t=(Math.random()-.5)*e;d(o,["y","rotation"]).from({y:o.y,rotation:e}).to({y:o.y,rotation:e},8).to({y:o.y-60,rotation:t},30,u.polyOut,7).start(),d(o,["alpha"]).from({alpha:0}).to({alpha:1},3,u.polyOut,4).to({alpha:0},38,u.polyIn,4).start().onFinish(function(){o.remove()}),o.show()}).start()}}function s(e,t){var i=window.actorManager.getActor(e.targetId);if(i){var n=window.gui.fightManager.isFighterOnUsersTeam(e.targetId),s=window.actorManager.isActorInvisible(e.targetId),a=e.actionId===m.ACTION_CHARACTER_MOVEMENT_POINTS_USE;if((n||!a||!s)&&(e.shieldLoss||0!==e.delta&&0!==e.loss)){var r;r=e.actionId===m.ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS||e.actionId===m.ACTION_CHARACTER_DEBOOST_ACTION_POINTS?"-"+e.delta:e.delta?e.delta>0?"+"+e.delta:e.delta:e.shieldLoss?"-"+e.shieldLoss:"-"+e.loss,o({x:i.x,y:i.y-70,maxRotation:.3,color:t,pointVariation:r,targetId:e.targetId})}}}function a(e,t,i){return!e._spell&&i&&(p.showApMpUsed||e.actionId!==m.ACTION_CHARACTER_MOVEMENT_POINTS_USE&&e.actionId!==m.ACTION_CHARACTER_ACTION_POINTS_USE)?void t.push(function(t){return s(e,i),window.gui.transmitFightSequenceMessage(e),t()}):t.push(function(t){return window.gui.transmitFightSequenceMessage(e),t()})}function r(e,t){t.push(function(t){for(var i=0;i<e.length;i++){var n=e[i];(p.showApMpUsed||n.actionId!==m.ACTION_CHARACTER_MOVEMENT_POINTS_USE&&n.actionId!==m.ACTION_CHARACTER_ACTION_POINTS_USE)&&n._labelColor&&s(n,n._labelColor)}return t()})}var l=i(1219),c=i(167),d=i(392).Tween,u=i(392).easing,h=i(392).Delay,p=i(171),m=i(353),f=[0,0,0,0],g=[.5,-.3,-.3,0],_=[.3,.3,-.5,0],v=[-.2,-.3,.5,0],y=[.2,.5,-.2,0],b=[.3,0,.5,0],M={};M[m.ACTION_CHARACTER_ACTION_POINTS_USE]=v,M[m.ACTION_CHARACTER_MOVEMENT_POINTS_USE]=y,M[m.ACTION_CHARACTER_MOVEMENT_POINTS_LOST]=y,M[m.ACTION_CHARACTER_ACTION_POINTS_LOST]=v,M[m.ACTION_CHARACTER_BOOST_ACTION_POINTS]=v,M[m.ACTION_CHARACTER_DEBOOST_ACTION_POINTS]=v,M[m.ACTION_CHARACTER_BOOST_MOVEMENT_POINTS]=y,M[m.ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS]=y,M[m.ACTION_CHARACTER_ACTION_POINTS_WIN]=v;var w={},T=500;t.createPointVariationLabel=o,t.lifePointVariation=function(e,t){e.shieldLoss?a(e,t,b):e._spell&&2===e._spell.critical?a(e,t,_):a(e,t,g)},t.actionOrMovementPointVariation=function(e,t){p.showApMpUsed||e.actionId===m.ACTION_CHARACTER_ACTION_POINTS_LOST||e.actionId===m.ACTION_CHARACTER_MOVEMENT_POINTS_LOST?a(e,t,M[e.actionId]):a(e,t,null)},t.buffVariation=function(e,t){"FightTemporaryBoostEffect"===e.effect._type&&(e.effect.actionId=e.actionId,a(e.effect,t,M[e.actionId])),t.push(function(t){return window.gui.transmitFightSequenceMessage(e),t()})},t.lifePointVariationBatch=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];n.shieldLoss?n._labelColor=b:n._spell&&2===n._spell.critical?n._labelColor=_:n._labelColor=g}r(e,t)},t.actionOrMovementPointVariationBatch=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];n._labelColor=M[n.actionId]}r(e,t)}},function(e,t,i){function n(e){e.id="textSpriteCount"+a++,s.call(this,e);var t=e.bitmapFont;this.characterDimensions=t.dimensions,this.texture=t.texture,this._characterByteSize=this.renderer.getNbBytesPerSprite(),this._bbox=[1/0,-(1/0),1/0,-(1/0)];var i=e.text;"number"==typeof i&&(i=i.toString());for(var n=0;n<i.length;n+=1)" "===i[n]||this.characterDimensions[i[n]]||(e.fallbackText||0===e.fallbackText?(console.error(new Error("TextSprite: character "+i[n]+" not in bitmap font: using fallback text")),i=e.fallbackText,"number"==typeof i&&(i=i.toString()),e.fallbackText=null,n=-1):(console.error(new Error("TextSprite: character "+i[n]+' not in bitmap font: replacing with a "."')),i=i.substr(0,n)+"."+i.substr(n+1)));this.textWidth=0,this.textHeight=0;var o,r,l,c=30;for(o=0;o<i.length;o+=1)r=i[o]," "===r?this.textWidth+=c:(l=this.characterDimensions[r],this.textWidth+=l.w,l.h>this.textHeight&&(this.textHeight=l.h));var d=-this.textWidth/2,u=-this.textHeight/2;for(this._bbox[0]=d,this._bbox[1]=d+this.textWidth,this._bbox[2]=u,this._bbox[3]=u+this.textHeight,this.characterPositions=[],o=0;o<i.length;o+=1)if(r=i[o]," "===r)d+=c;else{l=this.characterDimensions[r];var h=(this.textHeight-l.h)/2;this.characterPositions[o]={x:d,y:u+h},d+=l.w}this._createVertexBuffer(i,e.color)}var o=i(172).inherits,s=i(375),a=0;o(n,s),e.exports=n,n.prototype._createVertexBuffer=function(e,t){var i=e.length;this._vertexBuffer=new ArrayBuffer(i*this._characterByteSize),this._floatView=new Float32Array(this._vertexBuffer),this._longView=new Uint32Array(this._vertexBuffer);for(var n=this._floatView,o=this._longView,s=this._longView,a=this.texture.element.width,r=this.texture.element.height,l=0;l<e.length;l+=1){var c=e[l];if(" "!==c){var d=this.characterPositions[l],u=this.characterDimensions[c],h=l*this._characterByteSize/4,p=d.x,m=d.x+u.w,f=d.y,g=d.y+u.h;n[h+0]=p,n[h+1]=f,n[h+5]=p,n[h+6]=g,n[h+10]=m,n[h+11]=g,n[h+15]=p,n[h+16]=f,n[h+20]=m,n[h+21]=g,n[h+25]=m,n[h+26]=f;var _=u.x/a*65535&65535,v=u.y/r*4294901760&4294901760,y=(u.x+u.w)/a*65535&65535,b=(u.y+u.h)/r*4294901760&4294901760;o[h+2]=_+v,o[h+7]=_+b,o[h+12]=y+b,o[h+17]=_+v,o[h+22]=y+b,o[h+27]=y+v;var M=1077952576;s[h+3]=s[h+8]=s[h+13]=M,s[h+18]=s[h+23]=s[h+28]=M;var w=Math.max(-128,Math.min(127,128*t[0])),T=Math.max(-128,Math.min(127,128*t[1])),C=Math.max(-128,Math.min(127,128*t[2])),A=Math.max(-128,Math.min(127,128*t[3])),I=(A<<24&4278190080)+(C<<16&16711680)+(T<<8&65280)+(255&w);s[h+4]=s[h+9]=s[h+14]=I,s[h+19]=s[h+24]=s[h+29]=I}}this.renderer.releaseBuffer(this.id),this.forceRefresh()},n.prototype.draw=function(){this.renderer.drawSpriteBatch(this.id)},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this._floatView,i=!1;this.renderer.loadSpriteBuffer(this.id,t,this.texture,this.bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t){function i(e){e===window.actorManager.userId&&window.isoEngine.displayUserMovementZone()}function n(e){e===window.actorManager.userId&&window.isoEngine.clearUserMovementZone()}t.mapMovement=function(e,t){t.push(function(t){n(e.actorId),window.gui.transmitFightSequenceMessage(e),window.actorManager.actorMovement(e,t)})},t.slideMovement=function(e,t){e.startCellId!==-1&&e.endCellId!==-1&&t.push(function(t){n(e.actorId),window.gui.transmitFightSequenceMessage(e),window.actorManager.actorMovement({actorId:e.targetId,keyMovements:[e.startCellId,e.endCellId],slide:!0},t)})},t.teleport=function(e,t){if(e.cellId!==-1){var n=window.actorManager.getActor(e.targetId);n&&t.push(function(t){return window.gui.transmitFightSequenceMessage(e),n.setDisposition(e.cellId),i(e.targetId),t()})}},t.exchangePositions=function(e,t){var n=window.actorManager.getActor(e.sourceId),o=window.actorManager.getActor(e.targetId);t.push(function(t){return window.gui.transmitFightSequenceMessage(e),n&&n.setDisposition(e.casterCellId),o&&o.setDisposition(e.targetCellId),i(e.sourceId),i(e.targetId),t()})}},function(e,t,i){function n(e){var t=window.background,i=window.isoEngine,o=i.mapRenderer.map;if(!o)return i.once("mapLoaded",function(){n(e)});h[e.markId]=e;for(var l=e._glyph,d=0,p=e.cells.length;d<p;d++){var m=e.cells[d],f=m.cellId,g=r.parseIndexedColor(m.cellColor).color,_="rgba("+g.r+","+g.g+","+g.b+", 0.6)",v="rgba("+g.r+","+g.g+","+g.b+", 0.3)",y=0===m.cellsType?s.getCircleArea:s.getCrossArea,b=y(o.cells,f,m.zoneSize),M={spellId:e.markSpellId},w=new c(b,{color:v,outline:_,data:M});if(l){var T=a.cellCoord[f];l.x=T.x,l.y=T.y,l.position=f-.1,l.animManager.assignSymbol(u,!1),w.gfx=l}t.addZone(w,"mark:"+e.markId)}}function o(e){return e._glyphGfxId&&!e._glyph?(e._glyph=new l({scene:window.isoEngine.mapScene}),void d.loadAnimationManager(e._glyph,"bone",e._glyphGfxId+"/FX",function(){n(e)})):void n(e)}var s=i(1215),a=i(670),r=i(378),l=i(379),c=i(1195),d=i(380),u={base:"FX",direction:0},h={};t.addMark=function(e,t){t.push(function(t){return n(e.mark),t()})},t.removeMark=function(e,t){delete h[e.markId];var i=window.background;t.push(function(t){return i.deleteZoneById("mark:"+e.markId,function(e){var t=e.gfx;e.gfx=null,t&&t.animManager.assignSymbol(u,!1,function(){t.remove()})}),t()})},t.triggerGlyphTrap=function(e,t){t.push(function(t){var i=window.background.getDataOfZoneId("mark:"+e.markId);return i?(e._spellId=i.spellId,window.gui.transmitFightSequenceMessage(e),t()):(console.warn("No data found for zone: mark:"+e.markId),t())})},t.syncMarks=function(e){for(var t=0;t<e.length;t++)o(e[t])},t.getMarkedCells=function(){for(var e={},t=Object.keys(h),i=0;i<t.length;i++)for(var n=h[t[i]],o=0;o<n.cells.length;o++)e[n.cells[o].cellId]=!0;return e}},function(e,t){t.setVisibility=function(e,t){var i=window.actorManager,n=i.getActor(e.targetId);n&&t.push(function(t){window.gui.transmitFightSequenceMessage(e);var i=n.getFighterData();return n.setInvisibility(e.state,i.teamId),t()})},t.vanish=function(e,t){var i=window.actorManager,n=i.getActor(e.targetId);return n?void t.push(function(t){window.gui.transmitFightSequenceMessage(e),n.oneShootAnim({base:"AnimVanish"},!1,function(){return i.removeActor(e.targetId),t()})}):console.warn("No found actor with id "+e.targetId)},t.detected=function(e,t){var i=window.actorManager,n=i.getActor(e.targetId);if(!n)return console.error("No found actor with id "+e.targetId);var o=n.getFighterData(),s=i.userActor.getFighterData();o.teamId!==s.teamId&&t.push(function(e){return n.invisibleDetectedAnimation(),e()})}},function(e,t,i){function n(e){var t=e.riderEntity||e.animManager;t.removeAnimationModifier("AnimStatique"),t.removeAnimationModifier("AnimMarche"),t.removeAnimationModifier("AnimCourse"),t.removeAnimationModifier("AnimHit"),t.removeAnimationModifier("AnimTacle"),t.removeSubentity(e.carriedEntity),e.carriedActor?e.carriedActor.parentActor=null:console.warn("attempted to drop actor that did not exist."),e.carriedEntity=null,e.carriedActor=null}var o=i(394),s=i(392).Delay,a=3;t.carryCharacter=function(e,t){var i=window.actorManager,n=i.getActor(e.sourceId),s=i.getActor(e.targetId);if(n&&s){var r={base:"AnimPickup",direction:e._direction},l=n.riderEntity||n.animManager,c={animManager:s.animManager,bindingPoint:"carried_3_0",symbolModifier:o[a],bindingPointCategory:a};s.parentActor=n,n.carriedEntity=c,n.carriedActor=s,s.getFighterData().isCarryied=!0,t.push(function(e){l.addAnimationModifier("AnimStatique","AnimStatiqueCarrying"),l.addAnimationModifier("AnimMarche","AnimMarcheCarrying"),l.addAnimationModifier("AnimCourse","AnimCourseCarrying"),l.addAnimationModifier("AnimHit","AnimHitCarrying"),l.addAnimationModifier("AnimTacle","AnimTacleCarrying"),l.addSubentity(c),s.setDisposition(n.cellId),s.y=-1e3,n.oneShootAnim(r,!0,e)})}},t.removeCarrying=n,t.throwCharacter=function(e,t){var i=window.actorManager,o=i.getActor(e.targetId),a=i.getActor(e.sourceId);if(a&&o){var r=e.cellId,l={base:"AnimThrow",direction:e._direction};t.push(function(e){a.oneShootAnim(l,!1,function(){n(a),a.staticAnim(),o.getFighterData().isCarryied=!1});var t=new s(7,e);t.start(!1)}),r!==-1&&(t.push(function(t){e._throwingProjectile.launch(r,13,.3,70,t)}),t.push(function(t){return o.setDisposition(r),window.gui.transmitFightSequenceMessage(e),t()}))}},t.dropCharacter=function(e,t){var i=window.actorManager,o=i.getActor(e.sourceId),s=i.getActor(e.targetId);if(o){var a={base:"AnimDrop",direction:e._direction};t.push(function(t){o.oneShootAnim(a,!1,function(){return n(o),s.setDisposition(e.cellId),s.getFighterData().isCarryied=!1,o.staticAnim(),window.gui.transmitFightSequenceMessage(e),t()})})}}},function(e,t,i){function n(){this._queue=[],this._actionMap={},this._isActive=!1,this._currentActionId=null,this._endOfQueueOnly=!1}var o=i(167).ELEMENT_TYPE_ID,s=i(30),a=null;e.exports=n,n.prototype.initialize=function(){a||s.getAllDataMap("Interactives",function(e,t){if(e)return void console.error(new Error("ActionQueue.staticContent.getAllDataMap: "+e));a={};for(var i in t)1!==t[i].actionId&&(a[i]=!0);a[o.UNSPECIFIED]=!0})},n.prototype.enqueue=function(e,t,i){return!!this.canQueueMore()&&(this._isActive?!!this._actionMap[e]||(this._queue.push({actionId:e,action:i,endOfQueueOnly:t}),this._actionMap[e]=!0,!0):(this._isActive=!0,this._actionMap[e]=!0,this._currentActionId=e,this._endOfQueueOnly=t,i(),!0))},n.prototype.enqueueInteractive=function(e,t,i){var n=a&&a[t]||!1;return this.enqueue(e,n,i)},n.prototype.dequeue=function(e){if(this._isActive&&this._isCurrentAction(e)){delete this._actionMap[e];var t=this._queue.shift();if(!t)return void this.clear();this._currentActionId=t.actionId,this._endOfQueueOnly=t.endOfQueueOnly,t.action()}},n.prototype.canQueueMore=function(){if(!this._isActive)return!0;var e;return e=this._queue.length>0?!this._queue[this._queue.length-1].endOfQueueOnly:!this._endOfQueueOnly},n.prototype.isActive=function(){return this._isActive},n.prototype._isCurrentAction=function(e){return this._currentActionId===e},n.prototype.clear=function(){this._queue=[],this._actionMap={},this._isActive=!1,this._currentActionId=null,this._endOfQueueOnly=!1}},function(e,t,i){function n(e,t){return t.position-e.position}function o(e){switch(e){case 183:case 200:case 212:case 213:return!0;default:return!1}}function s(e,t){var i={red:1,green:1,blue:1},n={red:1.8,green:1.8,blue:1.8},o=new y(e.highlight,["red","green","blue"]);o.from(i);for(var s=0;s<t;s++)o.to(n,12),o.to(i,12);o.start()}var a=i(167),r=i(1188),l=i(794),c=i(29).getText,d=i(29).getTextFailover,u=i(1219),h=i(1226),p=i(778),m=i(1218),f=i(347).FIGHT_STATES,g=i(1227).trueName,_=i(392),v=_.Delay,y=_.Tween,b=_.easing,M={red:1.7,green:1.7,blue:1.7,alpha:1},w=10,T={DEFAULT:1,QUEUE:2},C=a.ELEMENT_TYPE_ID,A=[{elementTypeId:C.ZAAP,skillId:114},{elementTypeId:C.UNSPECIFIED,skillId:84},{elementTypeId:C.UNSPECIFIED,skillId:104},{elementTypeId:C.PADDOCK,skillId:175}],I=3e3,S={},E=null,x=4,N=4,L=new Uint8Array(x*N*4),O=null;r.prototype._isElementClicked=function(e,t,i){if(!e.isWithinBounds(t,i))return!1;var n=x,o=N;t-=n/2,i-=o/2;var s=e.renderer;null===O&&(O=s.startTextureUsage(n,o,1,"clickedInteractive")),s.startTextureRendering(O,t,t+n,i,i+o,!0),e.render();var a=s.gl;a.readPixels(0,0,n,o,a.RGBA,a.UNSIGNED_BYTE,L),s.stopTextureRendering();for(var r=L.length,l=0,c=3;c<r;c+=4)l+=L[c];return l>8},r.prototype._getAllInteractives=function(){for(var e=this.mapRenderer,t=e.identifiedElements,i=e.interactiveElements,o=this.actorManager.actors,s=[],a=Object.keys(i),r=0;r<a.length;r+=1){var l=a[r],c=i[l];if(0!==c.enabledSkills.length||0!==c.disabledSkills.length){var d=t[l];d&&s.push(d)}}for(var u=Object.keys(o),h=0;h<u.length;h+=1)s.push(o[u[h]]);return s.push(this.actorManager.userActor),s.sort(n),s},r.prototype._tapInteractive=function(e,t){var i,n=this.mapRenderer.interactiveElements,s=this._getAllInteractives(),a=window.gui.playerData.isAlive(),r=null,l=null,c=null;for(i=0;i<s.length;i++){var d=s[i];if(this._isElementClicked(d,e,t))if(d.actorId)if(d.isNPC()){if(!r){var u=d.data.npcData&&d.data.npcData.actions&&d.data.npcData.actions.length>0;(a||u)&&(r=d)}}else c||(c=d);else l||(l=d)}var h;if(h=this.actorManager.isTransparentModeOn?c||l||r:r||l||c,null===h)return this._lastTapId=null,!1;var p=!1,m=h.id||h.actorId,f=g([h._position,window.gui.playerData.position.mapId,m]);f===this._lastTapId?(p=!0,this._lastTapId=null):this._lastTapId=f,this.clearHighlights(null,T.DEFAULT);var _=this.actionQueue.isActive();if(h.tap)return _||(p&&h.actorId&&"GameRolePlayGroupMonsterInformations"===h.data.type?window.isoEngine.attackActor(h.actorId):h.tap(e,t)),!0;var v=n[h.id];if(!v)return!0;var y,b;if(1===v.enabledSkills.length&&(b=v.enabledSkills[0],o(b.skillId)||(y=b)),_&&!y)for(i=0;i<v.enabledSkills.length;i++)if(b=v.enabledSkills[i],b.skillId===this.lastContextualMenuSkillId){y=b;break}if(y){var M=this,w=this.actionQueue.enqueueInteractive(v.elementId,v.elementTypeId,function(){for(var e=!1,t=0;t<v.enabledSkills.length;t++){var i=v.enabledSkills[t];if(i.skillId===y.skillId){e=!0;break}}return e?void M.queueUseInteractive(v.elementId,y.skillInstanceUid):(M.actionQueue.clear(),M.clearHighlights(null,T.QUEUE))});return w?(this._addHighlight(h,T.QUEUE),!0):(!_&&1===v.enabledSkills.length&&y&&(this.instantUseInteractive(v.elementId,y.skillInstanceUid),this._addHighlight(h)),!0)}if(_)return!0;if(this._addHighlight(h),p)for(var C=0;C<A.length;C++)if(v.elementTypeId===A[C].elementTypeId)for(var I=0;I<v.enabledSkills.length;I++)if(v.enabledSkills[I].skillId===A[C].skillId)return this.instantUseInteractive(v.elementId,v.enabledSkills[I].skillInstanceUid),!0;var S=this.mapScene.convertSceneToCanvasCoordinate(e,t);return window.gui.openContextualMenu("interactive",v,{x:S.x,y:S.y}),!0},r.prototype._addHighlight=function(e,t){t=t||T.DEFAULT,e.highlight=M,this.highlightedElements[t]||(this.highlightedElements[t]=[]),this.highlightedElements[t].push(e)},r.prototype._clearHighlightType=function(e){var t=this.highlightedElements[e];if(t){for(var i=0;i<t.length;i++)t[i].highlight=null;this.highlightedElements[e]=[]}},r.prototype.clearHighlights=function(e,t){if(e){var i=this,n=new v(e,function(){i.clearHighlights(null,t)});return n.start()}if(t)this._clearHighlightType(t);else{for(var o in this.highlightedElements)this._clearHighlightType(o);this.highlightedElements={}}},r.prototype.queueUseInteractive=function(e,t){this.clearHighlights(null,T.DEFAULT),this._useInteractive(e,t)},r.prototype.instantUseInteractive=function(e,t){this.clearHighlights(w),this._useInteractive(e,t)},r.prototype.useInteractive=function(e,t){this.clearHighlights(),this._useInteractive(e,t)},r.prototype._useInteractive=function(e,t){var i=this,n=this.mapRenderer.identifiedElements[e],o=n.position,s=this.actorManager.userActor,a=function(){var n=l.getOrientation(s.cellId,o,!1);s.setDisposition(null,n),i._interactiveUseTrackServerAnswer(e,t),window.dofus.sendMessage("InteractiveUseRequestMessage",{elemId:e,skillInstanceUid:t})};return l.areCellsNeighbours(s.cellId,o,!0)?a():void this._movePlayerOnMap(o,!0,a)},r.prototype.onInteractiveUseErrorMessage=function(e){var t=e.elemId;void 0!==S[t]&&(window.clearTimeout(S[t]),delete S[t]),this.actionQueue.dequeue(t);var i=this.mapRenderer.identifiedElements[t];i&&(i.highlight=null)},r.prototype._interactiveUseTrackServerAnswer=function(e){var t=this;S[e]=window.setTimeout(function(){console.warn("Server has been too slow to answer to an interactiveUseRequest: we are not waiting for him"),delete S[e],t.actionQueue.dequeue(e)},I)},r.prototype.isWaitingForInteractiveUseServerAnswer=function(){return Object.keys(S).length>0},r.prototype.interactiveUseStart=function(e){var t=this,i=this.actorManager.getActor(e.entityId),n=this.mapRenderer.identifiedElements[e.elemId],o=e.entityId===window.gui.playerData.id,s=0!==e.duration;if(o&&(void 0!==S[e.elemId]&&(window.clearTimeout(S[e.elemId]),delete S[e.elemId]),null!==E&&(console.error("interactiveUseStart: InteractiveUseStart received but was waiting an InteractiveUseEnded"),this._userStopUsingInteractive())),!i)return o?console.error("interactiveUseStart: user actor is not ready"):console.warn("interactiveUseStart: no actor with id "+e.entityId);if(!n)return console[o?"error":"warn"]("interactiveUseStart: no interactive with id "+e.elemId);var a=e._useAnimation;if(!a||"AnimStatique"===a)return void(o&&t.actionQueue.dequeue(e.elemId));n.highlight=null;var r=l.getOrientation(i.cellId,n.position,!1);return i.setDisposition(null,r),i.loadAndPlayAnimation({base:a},s),s?void(o?(i.isLocked=!0,E=window.setTimeout(function(){t._userStopUsingInteractive(e.elemId)},100*e.duration*2)):window.setTimeout(function(){i.staticAnim()},100*e.duration)):void(o&&t.actionQueue.dequeue(e.elemId))},r.prototype.interactiveUseEndedMessage=function(e){this._userStopUsingInteractive(e.elemId)},r.prototype._userStopUsingInteractive=function(e){null!==E&&(clearTimeout(E),E=null);var t=this.actorManager.userActor;t.isLocked=!1,t.staticAnim(),this.actionQueue.dequeue(e)},r.prototype.updateInteractiveElements=function(e){this.mapRenderer.updateInteractiveElements(e)},r.prototype.updateObstacles=function(e){this.mapRenderer.updateObstacles(e)},r.prototype.updateStatedElements=function(e){this.mapRenderer.updateStatedElements(e)},r.prototype.addObjects=function(e){this.mapRenderer.addObjects(e)},r.prototype.removeObjects=function(e){this.mapRenderer.removeObjects(e)},r.prototype._removeArrowsNowAndLater=function(e){this.removeArrows(),this.arrowTimeout&&(window.clearTimeout(this.arrowTimeout),this.arrowTimeout=null);var t=this;this.arrowTimeout=window.setTimeout(function(){t.arrowTimeout=null,t.removeArrows()},e)},r.prototype.addArrowOnCell=function(e,t,i,n,o){this.mapRenderer.addArrowOnCell(e,t,i,n,o)},r.prototype.addArrowOnGraphic=function(e,t,i,n,o){this.mapRenderer.addArrowOnGraphic(e,t,i,n,o);
},r.prototype.addArrowsSequence=function(e,t,i,n){this.mapRenderer.addArrowsSequence(e,t,i,n)};var D={upLeft:{npc:[-.3,-3],monster:[-.5,-2]},downLeft:{npc:[-.5,-.3],monster:[-.5,.5]}};r.prototype._addArrowOnActor=function(e,t,i){var n=t?"monster":"npc",o="upLeft",s=D[o][n],r=s[0],l=s[1];e.y+l<60&&(o="downLeft",s=D[o][n],r=s[0],l=s[1]),i&&this._removeArrowsNowAndLater(i),this.mapRenderer.addArrowOnCell(e.cellId,r*a.CELL_WIDTH,l*a.CELL_HEIGHT,o)},r.prototype.addArrowOnNpc=function(e,t){var i=this.actorManager.getActorFromNpcId(e);return i?void this._addArrowOnActor(i,!1,t):console.warn("NPC not found with ID: "+e)},r.prototype.addArrowOnMonster=function(e,t){var i=this.actorManager.getActorFromMonsterId(e);return i?void this._addArrowOnActor(i,!0,t):console.warn("Monster not found with ID: "+e)},r.prototype.removeArrows=function(){this.mapRenderer.removeArrows()},r.prototype.highlightAllInteractives=function(e){e=e||1;var t=this.mapRenderer.interactiveElements,i=this.mapRenderer.identifiedElements,n=window.gui.fightManager.fightState,o=n===f.PREPARATION||n===f.BATTLE;for(var a in t){var r=t[a],l=i[a],c=l instanceof p;l&&(o&&!c||0===r.enabledSkills.length&&0===r.disabledSkills.length||s(l,e))}},r.prototype.highlightInteractivesWithDifferentType=function(){var e,t,i=this.mapRenderer.interactiveElements,n=this.mapRenderer.identifiedElements,o={};for(e in i){var a=i[e],r=n[e];r&&0!==a.enabledSkills.length&&(t=a.elementTypeId,o[t]||(o[t]=[]),o[t].push(r))}var l=[];for(t in o)if(~~t===C.UNSPECIFIED)l=l.concat(o[t]);else{var c=o[t].length,d=~~(Math.random()*c);l.push(o[t][d])}for(var u=0;u<l.length;u++)s(l[u],5)},r.prototype.displayNumericalValue=function(e){var t=this.actorManager.getActor(e.entityId);if(!t)return console.error("No entity with id",e.entityId);var i=t.x,n=t.y-80;m.createPointVariationLabel({x:i,y:n,pointVariation:"+"+e.value,color:[.2,-.1,-.2,0],maxRotation:.4}),e.valueOfBonus&&m.createPointVariationLabel({x:i,y:n,pointVariation:"+"+e.valueOfBonus,color:[.7,0,-.3,0],maxRotation:.4,targetId:e.entityId})};var R=0;r.prototype.displayTextBanner=function(e){if(this.bitmapFonts&&!window.gui.fightManager.isInactive){var t=c(e),i=d(e),n=this.mapScene,o=n.w/2,s=n.h/2,r=this.bitmapFonts.characters,l=new u({x:o,y:s,scene:n,text:t,fallbackText:i,position:2*R+1,layer:a.MAP_LAYER_POINT_LABELS,bitmapFont:r,color:[.2,.5,-.2,0],isHudElement:!0}),p=r.dimensions.bann,m=l.textWidth,f=l.textHeight,g=p.h,_=p.w,v=2,M=Math.floor(_/2-v),w=p.x,T=p.y,C=new h({x:o,y:s-f/2,scene:n,position:2*R,layer:a.MAP_LAYER_POINT_LABELS,texture:r.texture,controlPoints:[{x:-m/2-M,u:w,y:0,v:T},{x:-m/2,u:w+M,y:0,v:T},{x:m/2,u:w+M+v,y:g,v:T+g},{x:m/2+M,u:w+_,y:g,v:T+g}],isHudElement:!0}),A=new y(l,["y","alpha"]).from({y:s-30,alpha:0}).to({y:s-30,alpha:0},4).to({y:s,alpha:1},8,b.backOut,2).to({y:s,alpha:1},17).to({y:s-30,alpha:0},8,b.backIn,2).onFinish(function(){l.remove()}).start(),I=new y(C,["scaleX","alpha"]).from({scaleX:.7,alpha:0}).to({scaleX:1,alpha:1},8,b.backOut,2).to({scaleX:1,alpha:1},24).to({scaleX:.7,alpha:0},8,b.backIn,2).onFinish(function(){C.remove()}).start();R+=1,null!==this._currentBannerTweens.backTween&&(this._currentBannerTweens.backTween.starting||this._currentBannerTweens.backTween.playing)&&(this._currentBannerTweens.backTween.reset().to({scaleX:.7,alpha:0},8,b.polyOut,2).start(),this._currentBannerTweens.textTween.reset().to({y:s-30,alpha:0},8,b.polyOut,2).start()),this._currentBannerTweens.backTween=I,this._currentBannerTweens.textTween=A}},r.prototype.highlightActorOnAction=function(e,t){var i=this.actorManager.getActor(e);return i?(this._addHighlight(i),void this.clearHighlights(t||w)):console.warn("Actor with id "+e+" to highlight not found.")},r.prototype.interactiveDisconnect=function(){for(var e=Object.keys(S),t=0;t<e.length;t++)window.clearTimeout(S[e[t]]),delete S[e[t]];this.actionQueue.clear()}},function(e,t,i){function n(e){e.id="grid9ScaleCount"+a++,s.call(this,e),this._spriteByteSize=this.renderer.getNbBytesPerSprite(),this._bbox=[1/0,-(1/0),1/0,-(1/0)],this.controlPoints=e.controlPoints;var t=this.controlPoints[0],i=this.controlPoints[3];this.w=i.x-t.x,this.h=i.y-t.y,this._bbox[0]=t.x,this._bbox[1]=i.x,this._bbox[2]=t.y,this._bbox[3]=i.y,this.texture=e.texture,this._createVertexBuffer()}var o=i(172).inherits,s=i(375),a=0;o(n,s),e.exports=n,n.prototype._populateSpriteVertexBuffer=function(e,t,i,n,o,s,a,r,l){var c=this._floatView,d=this._longView,u=this._longView,h=this.texture.element.width,p=this.texture.element.height,m=e*this._spriteByteSize/4;c[m+0]=t,c[m+1]=s,c[m+5]=t,c[m+6]=r,c[m+10]=n,c[m+11]=r,c[m+15]=t,c[m+16]=s,c[m+20]=n,c[m+21]=r,c[m+25]=n,c[m+26]=s;var f=i/h*65535&65535,g=o/h*65535&65535,_=a/p*4294901760&4294901760,v=l/p*4294901760&4294901760;d[m+2]=f+_,d[m+7]=f+v,d[m+12]=g+v,d[m+17]=f+_,d[m+22]=g+v,d[m+27]=g+_;var y=1077952576;u[m+3]=u[m+8]=u[m+13]=y,u[m+18]=u[m+23]=u[m+28]=y},n.prototype._createVertexBuffer=function(){this._vertexBuffer=new ArrayBuffer(9*this._spriteByteSize),this._floatView=new Float32Array(this._vertexBuffer),this._longView=new Uint32Array(this._vertexBuffer);var e=this.controlPoints[0],t=this.controlPoints[1],i=this.controlPoints[2],n=this.controlPoints[3];this._populateSpriteVertexBuffer(0,e.x,e.u,t.x,t.u,e.y,e.v,t.y,t.v),this._populateSpriteVertexBuffer(1,t.x,t.u,i.x,i.u,e.y,e.v,t.y,t.v),this._populateSpriteVertexBuffer(2,i.x,i.u,n.x,n.u,e.y,e.v,t.y,t.v),this._populateSpriteVertexBuffer(3,e.x,e.u,t.x,t.u,t.y,t.v,i.y,i.v),this._populateSpriteVertexBuffer(4,t.x,t.u,i.x,i.u,t.y,t.v,i.y,i.v),this._populateSpriteVertexBuffer(5,i.x,i.u,n.x,n.u,t.y,t.v,i.y,i.v),this._populateSpriteVertexBuffer(6,e.x,e.u,t.x,t.u,i.y,i.v,n.y,n.v),this._populateSpriteVertexBuffer(7,t.x,t.u,i.x,i.u,i.y,i.v,n.y,n.v),this._populateSpriteVertexBuffer(8,i.x,i.u,n.x,n.u,i.y,i.v,n.y,n.v),this.renderer.releaseBuffer(this.id),this.forceRefresh()},n.prototype.draw=function(){this.renderer.drawSpriteBatch(this.id)},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this._floatView,i=!1;this.renderer.loadSpriteBuffer(this.id,t,this.texture,this.bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t){var i=Array.isArray;t.emaNeurt=function(e){return t.trueName(e,"‮")},t.trueName=function n(e,t){var o=(typeof e)[0],s="";if(t){if("object"==typeof t&&(t=t.valueOf()),"string"!=typeof t)throw new TypeError("Invalid type for salt: must be a string");s=t}var a=e;if("o"===o&&null!==e&&(a=e.valueOf()),o=(typeof a)[0],"o"!==o||null===a)return s.concat(o,a);if(a instanceof Date)return s.concat("d",a.toJSON());if(a instanceof RegExp)return s.concat("r",a.toString());if("f"===o)throw new TypeError("Invalid type: function");i(a)&&(o="a");var r,l;r=Object.keys(a),r.sort();for(var c=0;c<r.length;c+=1)l=r[c],s=s.concat(o,l,n(a[l]));return s}},function(e,t,i){function n(e,t){e?(M=!0,window.foreground.showInfobox(e,t)):M&&(M=!1,window.foreground.hideInfobox())}function o(){y=null,w=null,n(!1)}function s(){b=null,o()}function a(e,t,i){var n=i[t];if(!n)return null;if(!n.path){for(var o=t,s=[],a={},r=[],l={},c=0,d=0,u=0;o!==e;){var h=i[o];h.reachable?(s.unshift(o),a[o]=u):(r.unshift(o),l[o]=u),c+=h.mp,d+=h.ap,o=h.from,u+=1}n.path={reachable:s,unreachable:r,mp:c,ap:d,reachableMap:a,unreachableMap:l}}return n.path}var r=i(1188),l=i(1229),c=i(793).compressPath,d=i(1212),u=i(794),h=i(247).playUiSound,p=i(220),m=i(221),f=i(1230),g=i(171),_=i(1227).trueName,v=i(177),y=null,b=null,M=!1,w=null,T=new d;r.prototype.fightTurnStart=function(e){this._previousTurn=this._isUserTurn,this._isUserTurn=e,window.background.hideTargetHighlights(),this._resetFightPositionLayer(),this._previousTurn!==this._isUserTurn&&(e?this._enemyToUserTurn():this._userToEnemyTurn()),this._resetWalkLayer(),s()},r.prototype._switchTurn=function(e,t,i,n,o){if(this._spellRangeLayer){for(var s={},a=this._spellRangeLayer.cellInfos,r=Object.keys(a),l=0;l<r.length;l++){var c=a[r[l]];c.transformState===e?s[c.cellId]=new p(c.cellId,c.distanceToPlayer,t):c.transformState===i&&(s[c.cellId]=new p(c.cellId,c.distanceToPlayer,n))}0!==Object.keys(s).length&&this._resetSpellRangeLayer(s)}if(this._spellEffectLayer){for(s={},a=this._spellEffectLayer.cellInfos,r=Object.keys(a),l=0;l<r.length;l++)c=a[r[l]],s[c.cellId]=new p(c.cellId,c.distanceToPlayer,o);this._resetSpellEffectLayer(s)}},r.prototype._enemyToUserTurn=function(){window.background.showTargetHighlights(),window.foreground.confirmBox.show(),this._switchTurn(m.inSightEnemyTurn,m.inSight,m.outSightEnemyTurn,m.outSight,m.areaOfEffect)},r.prototype._userToEnemyTurn=function(){this._switchTurn(m.inSight,m.inSightEnemyTurn,m.outSight,m.outSightEnemyTurn,m.areaOfEffectEnemyTurn)},r.prototype.touchCancel=function(){this.clearHighlights(),s()},r.prototype.touchMove=function(e,t,i){var n=this.mapScene.convertCanvasToSceneCoordinate(e,t),o=this.mapRenderer.getCellId(n.x,n.y).cell;if(y!==o)if(y=o,"fight"===i.mode&&void 0!==i.spellId)this.displayEffectZone(o);else if("fight"===i.mode&&this._isUserTurn){var s=this.actorManager.occupiedCells;s[o]?this._resetWalkLayer():(window.foreground.confirmBox.close(),w=this._displayPathInFight(o))}},r.prototype._displayPathInFight=function(e){var t=this.actorManager.userActor,i=t.cellId;b=b||l.getReachableZone(t,i);var s=e;if(!b[e]){var r=u.getMapPointFromCellId(i),c=u.getMapPointFromCellId(s);T.set(r.x,r.y,c.x,c.y),T.exec(function(e,t){var i=u.getCellIdFromMapPoint(e,t);b[i]?s=i:T.stop()})}var d=a(i,s,b);if(!d)return o();for(var h=d.reachable[d.reachable.length-1],f={},g=0;g<d.reachable.length;g++)f[d.reachable[g]]=new p(d.reachable[g],d.reachableMap[d.reachable[g]],m.walkable);for(var _=0;_<d.unreachable.length;_++)f[d.unreachable[_]]=new p(d.unreachable[_],d.unreachableMap[d.unreachable[_]],m.unwalkable);return d.reachable.length>0&&(f[h]=new p(h,0,m.walkableLast)),window.background.removeTargetHighlights(),this._resetWalkLayer(f),d.mp>0||d.ap>0?n("tackle",{ap:d.ap,mp:d.mp}):n(!1),d},r.prototype.touchEnd=function(e,t,i){i=i||{},i.canvasX=e,i.canvasY=t;var n=this.mapScene.convertCanvasToSceneCoordinate(e,t),o=this.mapRenderer,s=o.getCellId(n.x,n.y),a=o.getCellSceneCoordinate(s.cell);o.addTapFeedback(a.x,a.y),this._touchEnd(n.x,n.y,s,i)};var C=null;r.prototype.cellHover=function(e){window.gui.playerData.isFighting&&C!==e&&(C=e,this.displayEffectZone(e))},r.prototype.cellHoverRelease=function(e){var t=this._shouldSkipConfirmBox(g.confirmBoxWhenDragCasting,e);this._spellRangeLayer&&this._spellRangeLayer.cellInfos.hasOwnProperty(e)?t?(this._castSpellImmediately(e),this.clearSpellDisplay()):this._castSpellImmediatelyConfirm(e):this.clearSpellDisplay(),this._isUserTurn&&t&&this.displayUserMovementZone()},r.prototype._touchEnd=function(e,t,i,n){n.hasOwnProperty("mode")&&(window.gui.pingSystem.isActive()?this._tapPing(e,t,i):"fightPlacement"===n.mode?this._tapFightPlacement(e,t,i,n):"fight"===n.mode&&void 0!==n.spellId?this._tapFightWithSpell(e,t,i,n):"fight"===n.mode&&this._isUserTurn?this._tapFight(e,t,i,n):"roleplay"===n.mode&&this._tapRoleplay(e,t,i,n),s())},r.prototype.isCellEmpty=function(e){var t=this.actorManager.occupiedCells[e]||[];return!(t.length>0)},r.prototype._tapPing=function(e,t,i){var n=window.gui.pingSystem;if(n.isPingBoxOpen())return n.cancelPingBox();var o=this.isCellEmpty(i),s=i.cell;n.openPingBox(s,o)},r.prototype._tapRoleplay=function(e,t,i,n){var o=this,s=n.canvasX,a=n.canvasY,r=n.changeMapRequest,l=this.mapRenderer,c=this.actorManager.userActor,d=this.actionQueue.isActive();if(d){var u=this._tapInteractive(e,t);if(!u&&!c.moving&&(r=r||l.getFirstMapFlag(i.cell))){var h=!0,p=this.actionQueue.enqueue("changeMap",h,function(){o.gotoNeighbourMap(r,i.cell,s,a)});return void(p&&window.foreground.showBorderArrow(r,s,a))}}else this.lastContextualMenuSkillId=null;if(!c.isLocked){if(c.moving||this.isMovementWaitingForConfirmation){if(window.foreground.hideBorderArrow(),d&&!r&&this._tapInteractive(e,t))return;return this.clearHighlights(),this.actionQueue.clear(),void this.cancelUserActorMovement(function(){o._touchEnd(e,t,i,n)})}if(!r){if(this._tapInteractive(e,t))return;var m=this.actorManager.occupiedCells[i.cell];if(m&&m[0]&&m[0].position===i)return void(0===i.dist&&m[0].tap(e,t,l.camera))}this.clearHighlights();var f=i.cell;return(r=r||l.getFirstMapFlag(i.cell))?this.gotoNeighbourMap(r,i.cell,s,a):void this._movePlayerOnMap(f)}},r.prototype._tapFightWithSpell=function(e,t,i,n){var o=i.cell;window.foreground.fightIsUserTurn?n.hideConfirmWindow=!1:n.hideConfirmWindow=!0;var s=this._shouldSkipConfirmBox(g.confirmBoxWhenClickCasting,o);s?this._castSpell(o,e,t,n):this._castSpellConfirm(o,e,t,n)},r.prototype._shouldSkipConfirmBox=function(e,t){var i=!1;return e===v.NEVER?i=!0:e===v.EMPTY_ONLY?i=!this.isCellEmpty(t):e===v.ALWAYS&&(i=!1),i},r.prototype.displayUserMovementZone=function(){if(this.mapRenderer.isReady&&!window.gui.playerData.isSpectator){this.clearSpellDisplay();var e=this.actorManager.userActor,t=e.cellId,i=b||l.getReachableZone(e,t);this.clearUserMovementZone();var n,o={},s=window.isoEngine.actorManager.userActor.cellId;for(var a in i){var r,c=f.getDistance(s,a);r=i[a].reachable?i[a].ap>0?m.walkAreaRequiresAP:m.walkArea:m.walkAreaRestricted,o[a]=new p((~~a),c,r),n=!0}n&&this._resetWalkAreaLayer(o)}},r.prototype.tryDisplayUserMovementZone=function(){return this._spellRangeLayer?void this.displaySpellRange():void this.displayUserMovementZone()},r.prototype.displayEnemyMovementZone=function(e){if(this.mapRenderer.isReady){this.clearSpellDisplay();var t=this.actorManager.getActor(e.id),i=t.cellId,n=l.getReachableZone(t,i);this._resetWalkAreaLayer();for(var o,s={},a=Object.keys(n),r=0;r<a.length;r++){var c,d=a[r],u=f.getDistance(i,d);c=n[d].reachable?n[d].ap>0?m.enemyWalkAreaRequiresAP:m.enemyWalkArea:m.enemyWalkAreaRestricted,s[d]=new p((~~d),u,c),o=!0}o&&this._resetEnemyWalkAreaLayer(s)}},r.prototype.removeEnemyMovementZone=function(){this._resetEnemyWalkAreaLayer(),this._isUserTurn&&(window.foreground.isSpellSelected()?window.foreground._displaySpellRange():this.displayUserMovementZone())},r.prototype._tapFight=function(e,t,i){function n(e){return e?(h.unshift(l),window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameMapMovementRequestMessage",{keyMovements:c(h),mapId:a}),u._resetWalkLayer(),void s()):void u._resetWalkLayer()}var a=this.mapRenderer.map.id,r=i.cell,l=this.actorManager.userActor.cellId,d=window.foreground.confirmBox,u=this;if(this.actorManager.occupiedCells[r]||!this._isUserTurn)return o(),this._resetWalkLayer(),void d.close();if(w||(w=this._displayPathInFight(r)),!w||0===w.reachable.length||!y&&w.reachable.indexOf(r)===-1&&w.unreachable.indexOf(r)===-1)return o(),this._resetWalkLayer(),void d.close();if(w){var h=w.reachable,p={mp:h.length+w.mp,ap:w.ap},m=_(["move",p,h,r,a]);g.confirmBoxWhenWalking?d.open("move",p,n,m):n(!0)}},r.prototype._tapFightPlacement=function(e,t,i,n){var o=this.actorManager.occupiedCells[i.cell];if(o)return void(0===i.dist&&o[0].tap(e,t,this.mapRenderer.camera));var s=i.cell,a=n.possiblePlacements||[],r=a.indexOf(s);r!==-1&&(window.dofus.sendMessage("GameFightPlacementPositionRequestMessage",{cellId:s}),h("FIGHT_POSITION"))};var A,I;r.prototype.holdStart=function(){this.highlightAllInteractives(5),A=this._getAllInteractives(),I=null},r.prototype.holdEnd=function(){this.clearHighlights(),this.removeEnemyMovementZone()},r.prototype.holdAndMove=function(e,t){for(var i=this.mapScene.convertCanvasToSceneCoordinate(e,t),n=null,o=0;o<A.length;o++){var s=A[o];if(this._isElementClicked(s,i.x,i.y)){n=s;break}}return n?I===n?n:(I=n,this.clearHighlights(),this._addHighlight(n),n):(I=null,void this.clearHighlights())}},function(e,t,i){function n(e,t){var i=e.getFighter(),n=t.getFighter();return i&&n?i.data.stats.invisibilityState!==p&&(i.data.stats.invisibilityState!==m&&(i.data.teamId!==n.data.teamId&&(i.data.alive!==!1&&(!i.data.isCarryied&&(!i.hasState(g)&&(!i.hasState(f)&&i.canTackle)))))):(console.warn("canBeTackler: Corresponding fighters could not be found."),!1)}function o(e){var t=e.getFighter();return t?t.data.stats.invisibilityState!==p&&(t.data.stats.invisibilityState!==m&&(!t.data.isCarryied&&(!t.hasState(_)&&!t.hasState(f)))):(console.error("Corresponding fighter could not be found."),!1)}function s(e,t){var i=Math.max(0,e.getFighterData().stats.tackleEvade||0),n=Math.max(0,t.getFighterData().stats.tackleBlock||0);return(i+2)/(n+2)/2}function a(e,t,i,a){i=Math.max(0,i),a=Math.max(0,a);var r={mp:0,ap:0};if(!o(e))return r;if(0===t.length)return r;for(var l=0;l<t.length;l++){var c=t[l];if(c&&n(c,e)){var d=s(e,c);d>=1||(r.mp+=~~(i*(1-d)+.5),r.ap+=~~(a*(1-d)+.5))}}return r}function r(e,t,i,n,o,s){this.cellId=e,this.availableMp=t,this.availableAp=i,this.tackleMp=n,this.tackleAp=o,this.distance=s}function l(e,t,i){this.ap=e.ap,this.mp=e.mp,this.from=t,this.reachable=i,this.path=null}function c(e,t){var i={},n=e.getFighterData(),o=n.stats,s=o.movementPoints;if(s<=0)return i;var c=window.actorManager,u=window.isoEngine.mapRenderer,p=[],m={},f=new r(t,o.movementPoints,o.actionPoints,0,0,1);p.push(f),m[t]=f;for(var g=c.getIndexedVisibleActors(),_=h.getMarkedCells();p.length;){for(var v,y=p.pop(),b=y.cellId,M=d.getNeighbourCells(b,!1),w=[],T=0;T<M.length;){v=M[T];var C=g[v];void 0===v||C?(M.splice(T,1),C&&w.push(C)):T++}var A=a(e,w,y.availableMp,y.availableAp),I=y.availableMp-A.mp-1,S=y.availableAp-A.ap,E=y.tackleMp+A.mp,x=y.tackleAp+A.ap,N=y.distance+1,L=I>=0;for(_[b]&&t!==b&&(I=0),T=0;T<M.length;T++){if(v=M[T],m[v]){var O=m[v];if(O.availableMp>I)continue;if(O.availableMp===I&&O.availableAp>=S)continue}u.isWalkable(v)&&(i[v]=new l(A,b,L),f=new r(v,I,S,E,x,N),m[v]=f,y.distance<s&&p.push(f))}}return i}var d=i(794),u=i(364),h=i(1209),p=u.INVISIBLE,m=u.DETECTED,f=6,g=95,_=96;t.getReachableZone=c},function(e,t,i){function n(e,t){var i=a(e),n=a(t),o=Math.abs(i.x-n.x)+Math.abs(i.y-n.y);return o}function o(e,t){var i=a(e),n=a(t),o=i.x-n.x,s=i.y-n.y,r=Math.sqrt(o*o+s*s);return r}var s=i(794),a=s.getMapPointFromCellId;e.exports.getCellDistance=n,e.exports.getDistance=o},function(e,t,i){function n(e,t,i,n){for(var o=h(i),s=Object.keys(t),a=0;a<s.length;a++){for(var r=s[a],d=h(r),p=c.getLine(o.x,o.y,d.x,d.y),m=!1,f=0,g=p.length;f<g;f++){var _=l(p[f].x,p[f].y),v=e[_];if(n[_]&&f<g-1||2!==(2&v.l)){m=!0;break}}m&&(t[r].transformState=window.foreground.fightIsUserTurn?u.outSight:u.outSightEnemyTurn)}return t}var o=i(1188),s=i(1215),a=i(1227).trueName,r=i(794),l=r.getCellIdFromMapPoint,c=i(1232),d=i(220),u=i(221),h=r.getMapPointFromCellId,p=null,m=null;o.prototype._initGridOverlayLayers=function(){this._fightPositionLayer=null,this._spellRangeLayer=null,this._spellEffectLayer=null,this._walkLayer=null,this._walkAreaLayer=null,this._enemyWalkAreaLayer=null},o.prototype._resetFightPositionLayer=function(e){this.background.removeGridLayer(this._fightPositionLayer),this._fightPositionLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetSpellRangeLayer=function(e){this.background.removeGridLayer(this._spellRangeLayer),this._spellRangeLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetSpellEffectLayer=function(e){this.background.removeGridLayer(this._spellEffectLayer),this._spellEffectLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetWalkLayer=function(e){this.background.removeGridLayer(this._walkLayer),this._walkLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetWalkAreaLayer=function(e){this.background.removeGridLayer(this._walkAreaLayer),this._walkAreaLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetEnemyWalkAreaLayer=function(e){this.background.removeGridLayer(this._enemyWalkAreaLayer),this._enemyWalkAreaLayer=e?this.background.addGridAnimation(e):null},o.prototype.clearUserMovementZone=o.prototype._resetWalkAreaLayer,o.prototype.setCurrentSpell=function(e){p=e},o.prototype.displaySpellRange=function(){if(this.mapRenderer.map&&this.mapRenderer.map.cells&&p&&!this.actorManager.userActor.isDead){this.clearUserMovementZone();for(var e=this.mapRenderer.map.cells,t=this.actorManager.userActor.cellId,i=s.getSpellRange(e,t,p),o=window.actorManager.getIndexedVisibleActors(),a={},l={},c=window.foreground.fightIsUserTurn?u.outSight:u.outSightEnemyTurn,h=window.foreground.fightIsUserTurn?u.inSight:u.inSightEnemyTurn,f=0;f<i.length;f++){var g=r.getCellIdFromMapPoint(i[f][0],i[f][1]);if(void 0!==g&&!a[g])if(p.needFreeCell&&o[g])l[g]=i[f][2],a[g]=new d(g,i[f][2],c);else{var _=e[g].l||0;3===(7&_)&&(a[g]=new d(g,i[f][2],h),l[g]=i[f][2])}}p.castTestLos&&n(e,a,t,o),m=a,this._resetSpellRangeLayer(a),this._spellEffectLayer&&this._resetSpellEffectLayer(this._spellEffectLayer.cellInfos),this._walkLayer&&(this._resetWalkLayer(),window.foreground.confirmBox.hide())}},e.exports.getCell=n,o.prototype.displayEffectZone=function(e){if(this.background.removeTargetHighlights(),m&&p){if(!m.hasOwnProperty(e))return void this._resetSpellEffectLayer();if(m[e].transformState===u.outSight||m[e].transformState===u.outSightEnemyTurn)return void this._resetSpellEffectLayer();if(this.mapRenderer.map&&this.mapRenderer.map.cells){for(var t=this.actorManager.userActor.cellId,i=this.mapRenderer.map.cells,n=s.getSpellEffectZone(i,t,e,p.zoneEffect),o=this.actorManager.occupiedCells,a=Object.keys(n),r=0;r<a.length;r++)if(t=a[r],o[t]){var l=o[t][0],c=l.getTeamId();0===c?this.background.addTargetHighLights(t,o[t][0]._x,o[t][0]._y,u.redTeamStart,u.redTeamEnd,!window.foreground.fightIsUserTurn):this.background.addTargetHighLights(t,o[t][0]._x,o[t][0]._y,u.blueTeamStart,u.blueTeamEnd,!window.foreground.fightIsUserTurn)}this._resetSpellEffectLayer(n)}}},o.prototype._castSpell=function(e,t,i,n){var o=this.mapRenderer.grid.getNearbyCellInZone(e,t,i,m);return null===o?(window.foreground.deselectSpell(),window.gui.shortcutBar.deselectCurrentSlot(),void this.clearSpellDisplay()):(this.displayEffectZone(o),window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameActionFightCastRequestMessage",{spellId:p.spellId,cellId:o}),window.gui.fightManager.spellCastSucceeded(n.spellId,n.characterId),p=null,this.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot())},o.prototype._castSpellConfirm=function(e,t,i,n){var o=this.mapRenderer.grid.getNearbyCellInZone(e,t,i,m);if(null===o)return window.foreground.deselectSpell(),void window.gui.shortcutBar.deselectCurrentSlot();this.displayEffectZone(o);var s=a(["spell",p.spellId,e,o]),r=this;window.foreground.confirmBox.open("spell",p,function(e){return e?(window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameActionFightCastRequestMessage",{spellId:p.spellId,cellId:o}),window.gui.fightManager.spellCastSucceeded(n.spellId,n.characterId),p=null,r.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot()):(r.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot())},s,n.hideConfirmWindow)},o.prototype._castSpellImmediately=function(e){if(m&&p){if(null===e)return window.foreground.deselectSpell(),void window.gui.shortcutBar.deselectCurrentSlot();window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameActionFightCastRequestMessage",{spellId:p.spellId,cellId:e}),window.gui.fightManager.spellCastSucceeded(p.spellId,window.gui.playerData.characters.controlledCharacterId),this.clearSpellDisplay(),p=null,window.gui.shortcutBar.deselectCurrentSlot()}},o.prototype._castSpellImmediatelyConfirm=function(e){if(m&&p){if(null===e)return window.foreground.deselectSpell(),void window.gui.shortcutBar.deselectCurrentSlot();var t=a(["spell",p.spellId,e,e]),i=this;window.foreground.confirmBox.open("spell",p,function(t){return t?(window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameActionFightCastRequestMessage",{spellId:p.spellId,cellId:e}),window.gui.fightManager.spellCastSucceeded(p.spellId,window.gui.playerData.characters.controlledCharacterId),p=null,i.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot()):(i.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot())},t,!window.foreground.fightIsUserTurn)}},o.prototype.displayFightPositions=function(e){for(var t={},i=0,n=0;n<e.positionsForChallengers.length;n++){var o=e.positionsForChallengers[n];t[o]=new d(o,i,u.fullRed)}for(var s=0;s<e.positionsForDefenders.length;s++)o=e.positionsForDefenders[s],t[o]=new d(o,i,u.fullBlue);this._resetFightPositionLayer(t)},o.prototype.clearSpellDisplay=function(){this.background.removeTargetHighlights(),this._resetSpellEffectLayer(),this._resetSpellRangeLayer()}},function(e,t){e.exports.getLine=function(e,t,i,n){var o=[];e+=.5,t+=.5,i+=.5,n+=.5;var s=0,a=0,r=0,l=0;Math.abs(e-i)===Math.abs(t-n)?(r=Math.abs(e-i),s=i>e?1:-1,a=n>t?1:-1,l=1):Math.abs(e-i)>Math.abs(t-n)?(r=Math.abs(e-i),s=i>e?1:-1,a=(n-t)/r,a=100*a,a=Math.ceil(a)/100,l=2):(r=Math.abs(t-n),s=(i-e)/r,s=100*s,s=Math.ceil(s)/100,a=n>t?1:-1,l=3);for(var c=~~(3+r/2),d=~~(97-r/2),u=0;u<r;u++){var h,p,m=e+s,f=t+a;if(2===l){var g=Math.ceil(100*t+50*a)/100,_=Math.floor(100*t+150*a)/100,v=Math.floor(Math.abs(100*Math.floor(g)-100*g))/100,y=Math.ceil(Math.abs(100*Math.ceil(_)-100*_))/100;h=Math.floor(m),Math.floor(g)===Math.floor(_)?(p=Math.floor(f),(g===p&&_<p||_===p&&g<p)&&(p=Math.ceil(f)),o.push({x:h,y:p})):Math.ceil(g)===Math.ceil(_)?(p=Math.ceil(f),(g===p&&_<p||_===p&&g<p)&&(p=Math.floor(f)),o.push({x:h,y:p})):~~(100*v)<=c?o.push({x:h,y:Math.floor(_)}):~~(100*y)>=d?o.push({x:h,y:Math.floor(g)}):(o.push({x:h,y:Math.floor(g)}),o.push({x:h,y:Math.floor(_)}))}else if(3===l){var b=Math.ceil(100*e+50*s)/100,M=Math.floor(100*e+150*s)/100,w=Math.floor(Math.abs(100*Math.floor(b)-100*b))/100,T=Math.ceil(Math.abs(100*Math.ceil(M)-100*M))/100;p=Math.floor(f),Math.floor(b)===Math.floor(M)?(h=Math.floor(m),(b===h&&M<h||M===h&&b<h)&&(h=Math.ceil(m)),o.push({x:h,y:p})):Math.ceil(b)===Math.ceil(M)?(h=Math.ceil(m),(b===h&&M<h||M===h&&b<h)&&(h=Math.floor(m)),o.push({x:h,y:p})):~~(100*w)<=c?o.push({x:Math.floor(M),y:p}):~~(100*T)>=d?o.push({x:Math.floor(b),y:p}):(o.push({x:Math.floor(b),y:p}),o.push({x:Math.floor(M),y:p}))}else o.push({x:Math.floor(m),y:Math.floor(f)});e=(100*e+100*s)/100,t=(100*t+100*a)/100}return o}},function(e,t,i){function n(e,t){return"fight:"+e+":"+t}function o(e){_[e]&&(console.warn("Fight with id "+e+" already exist."),_[e].remove()),this.id=e,this.teams={},_[e]=this}function s(e,t){switch(e.fightType){case c.FIGHT_TYPE_AGRESSION:return O[t.teamSide][~~(t.teamTypeId===u.TEAM_TYPE_BAD_PLAYER)];case c.FIGHT_TYPE_Koh:var i,n=null,o=null,s=null;switch("FightTeamMemberWithAllianceCharacterInformations"===t.teamMembers[0]._type&&(n=t.teamMembers[0].allianceInfos.allianceId),!0){case null!==o&&o===n:i=0;break;case null!==s&&n===s:i=1;break;default:i=2}return D[t.teamId][i];case c.FIGHT_TYPE_CHALLENGE:return v;case c.FIGHT_TYPE_PvT:return t.teamId===d.TEAM_CHALLENGER?v:b;default:return t.teamId===d.TEAM_CHALLENGER?v:y}}var a=i(1188),r=i(167),l=i(347),c=i(666),d=i(343),u=i(884),h=i(384),p=i(673),m=i(258),f=l.FIGHT_OPTION_KEY_TO_ENUM,g=l.FIGHT_OPTION_ICON_ID,_={};o.prototype.addTeam=function(e,t){this.teams[e]={id:e,contextualId:n(this.id,e),icons:{},options:{},cellId:t}},o.prototype.remove=function(){for(var e in this.teams){var t=this.teams[e];window.actorManager.removeActor(t.contextualId);for(var i in t.icons)t.icons[i].remove()}delete _[this.id]},o.prototype._createIcon=function(e,t,i){function n(i){return _[o.id]?a.icons[t]?i.release():(a.icons[t]=new p({layer:r.MAP_LAYER_ICONS,w:i.element.width,h:i.element.height,scene:s},i),a.options[t]||a.icons[t].hide(),void o._updateIconsPosition(e)):i.release()}var o=this,s=window.isoEngine.mapScene,a=this.teams[e];return a?g.indexOf(t)===-1?console.error(new Error("Unknown fightOption:"+t)):a.icons[t]?(console.warn("Icon "+t+" already exists for team "+e+" in fight "+this.id),void a.icons[t].show()):void h.loadTexture(i,n,s.renderer):console.error(new Error("No team with id "+e+" in fight "+this.id))},o.prototype._updateIconsPosition=function(e){var t=this.teams[e];if(!t)return console.error(new Error("No team with id "+e+" in fight "+this.id));var i=0,n=0;for(var o in t.icons)t.icons[o].isDisplayed&&i++,n=Math.max(t.icons[o].w,n);var s=.1*n,a=window.isoEngine.mapRenderer.grid.getSceneCoordinateFromCellId(t.cellId),l=a.x-(n+s)/2*(i-1),c=0;for(o in t.icons)t.icons[o].isDisplayed&&(t.icons[o].x=l+c*(n+s)-t.icons[o].w/2,t.icons[o].y=a.y-2.1*r.CELL_HEIGHT,c++)},o.prototype.setFightOption=function(e,t,i){var n=this.teams[e];if(!n)return console.error(new Error("No team with id "+e+" in fight "+this.id));if(void 0===n.options[t])return n.options[t]=i,void this._createIcon(e,t,"ui/spectator/fightOption"+t+".png");if(n.options[t]=i,n.icons[t]){var o=i?"show":"hide";n.icons[t][o](),this._updateIconsPosition(e)}},o.prototype.challengeOptionChange=function(e,t,i){var n=this.teams[e];return n?void(g.indexOf(t)!==-1&&this.setFightOption(e,t,i)):console.error(new Error("No team with id "+e+" in fight "+this.id))};var v=19,y=20,b=21,M=32,w=33,T=1237,C=1235,A=1236,I=2248,S=2249,E=2251,x=2252,N=2253,L=2255,O={"-1":[v,v],0:[T,T],1:[C,M],2:[A,w],3:[T,T]},D={0:[I,E,S],1:[x,L,N]};a.prototype.showChallenge=function(e){for(var t=this.actorManager,i=e.fightId,a=e.fightTeams,r=e.fightTeamsPositions,l=e.fightTeamsOptions,c=new o(i),d=0;d<a.length;d++){var u=a[d],h=s(e,u);u.fightId=i,u.look={bonesId:h,scales:[100],skins:[],indexedColors:[]},u.disposition={cellId:r[d],direction:0},u.contextualId=n(i,u.teamId),t.addEmptyActor(u),c.addTeam(u.teamId,r[d]),t.setActorLook(u.contextualId,u.look);for(var p in l[d])void 0!==f[p]&&l[d][p]&&c.setFightOption(u.teamId,f[p],!0)}},a.prototype.addChallenges=function(e){for(var t=0;t<e.length;t++)this.showChallenge(e[t])},a.prototype.removeChallenge=function(e){var t=_[e];return t?void t.remove():console.warn("No challenge with id "+e)},a.prototype.cleanupChallenges=function(){for(var e in _)_[e].remove()},a.prototype.challengeOptionChange=function(e,t,i,n){var o=_[e];return o?void o.challengeOptionChange(t,i,n):console.warn("No challenge with id "+e)},a.prototype.updateFightTeam=function(e){if(!m.isFightMode){var t=e.fightId,i=e.team;i.fightId=t;var o=i.teamId,s=n(t,o),a=this.actorManager.getActor(s);return a?void a.updateData(i):console.warn("No fight id "+s)}}},function(e,t,i){var n=i(1188),o=i(31),s=i(1210),a=i(1216),r=i(373),l=i(247).playUiSound,c=i(167),d=i(1204),u=i(1219),h=i(392),p=h.Tween,m=h.easing;n.prototype.playEmote=function(e){if(!this.actorManager.isCreatureModeOn){var t=this.actorManager.getActor(e.actorId);if(t){if(0===e.emoteId)return void t.staticAnim();var i=e._emote;if(i){var n=i.defaultAnim;if(n=n.substring(0,1).toUpperCase()+n.substring(1)+"_0",!i.eight_directions){var o=2*~~(t.direction/2)+1;o!==t.direction&&t.setDisposition(null,o)}t.loadAndPlayAnimation({base:"AnimEmote",type:n},!1)}}}},n.prototype.playLevelUpAnimation=function(e,t){var i=this.actorManager.getActor(e);if(i){var n,o=i.look;if(o&&o.skins&&o.skins[0]){var s=o.skins[0];n=(1&s).toString()}else n=Math.random()<.5?"0":"1";var a;1===o.bonesId?a="AnimEmoteInterface_"+n:i.isRiding&&2===r.getLookOfRider(o).bonesId&&(a="AnimLevelUpRiding"),a&&i.loadAndPlayAnimation({base:a,direction:1},!1,t),l("LEVEL_UP");var h=i.x,f=i.y,g="LEVEL UP",_=this.bitmapFonts.characters,v=new u({x:h,y:f,scene:this.mapScene,text:g,fallbackText:g,layer:c.MAP_LAYER_POINT_LABELS,bitmapFont:_,color:[.3,.5,-.1,0]});v.scaleX=.7,v.scaleY=.7,p(v,["y","alpha"]).from({y:f,alpha:0}).to({y:f,alpha:0},9).to({y:f-40,alpha:1},8,m.backOut,2).to({y:f-40,alpha:1},16).to({y:f-90,alpha:0},12,m.backIn,2).onFinish(function(){v.remove()}).start();var y=new d(i.position,h,f);y.red=1,y.green=1,y.blue=.9,p(y,["scaleX","scaleY","alpha"]).from({scaleX:.3,scaleY:.3,alpha:0}).to({scaleX:1,scaleY:1,alpha:1.7},7,m.polyOut,4).to({scaleX:.3,scaleY:1,alpha:1.7},20,m.polyOut,2).to({scaleX:.3,scaleY:1,alpha:0},7,m.polyOut,2).onFinish(function(){
y.remove()}).start()}},n.prototype.playRoleplaySpellAnim=function(e){s([e],function(){var t=[];a(e,t),o.series(t)})}},function(e,t,i){var n=i(1188),o=14,s=40;n.prototype._logMap=function(e){e=e||[];for(var t={},i=0;i<e.length;i++)t[e[i]]=!0;var n,a,r,l,c=this.mapRenderer.map,d=this.actorManager.occupiedCells,u=this.actorManager.userActor,h="",p=[];for(n=0;n<o;n++)h+="┌───┐   ";var m=!0;for(a=0;a<s;a++){for(h+="\n",h+=m?"│":"├",n=0;n<o;n++)r=a*o+n,l=r<100?" ":"",l+=r,l+=r<10?" ":"",h+=m?"%c"+l+"%c├───┤":"───┤%c"+l+"%c├",t[r]?p.push("background-color: #FF0"):c&&2!==(2&c.cells[r].l)?p.push("background-color: #00F"):c&&0===(1&c.cells[r].l)?p.push("background-color: #113; color: #779"):u.cellId===r?p.push("background-color: #CD8; color: #072"):d[r]?p.push("background-color: #F88"):p.push("background-color: #FFF"),p.push("background-color: #FFF, color: #000");m=!m}for(h+="\n ",n=0;n<o;n++)h+="   └───┘";p.unshift(h),console.log.apply(window.console,p)}},function(e,t,i){function n(e){this.progressEgg=new h({scene:e,position:5,alpha:1,x:e.w/2,y:e.h/2,isHudElement:!0,id:"loadingProgressEgg"}),this.progressEgg.setAnimManager(new p(this.progressEgg,new m(""),1.7,0)),this.progressEggFrameTween=new c(this.progressEgg.animManager,["frame"]),this.hide()}var o=i(167),s=i(1188),a=i(793),r=i(182),l=i(381),c=i(392).Tween,d=i(392).easing,u=i(673),h=i(1198),p=i(391),m=i(390),f=i(202),g=1200,_=100,v=20;n.prototype.loadAssets=function(e){var t=this.progressEgg.animManager,i=this.progressEgg.renderer;l.loadTemplate("loader","loadingLogo","",function(i){t.template=i,t.assignSymbol({base:"loadeur",direction:-1},!1),t.tween.stop(),t.frame=0,e()},i,"archivable")},n.prototype.hide=function(){this.progressEgg.hide(),this.progressEgg.animManager.clear()},n.prototype.show=function(){this.progressEgg.show()},s.prototype._initLoadingProgress=function(){this._loadingProgress=new n(this.mapScene),this._resetTransition()},s.prototype._resetTransition=function(){this._loadingFadeInTransitionRunning=!1,this._loadingProgressVisible=!1,this._waitingForMessage=!1,this._mapLoadingMessage=null,this._isMapLoading=!1,this._mapSceneTransitionGraphic=null},s.prototype.showLoadingProgress=function(e){var t=this._loadingProgress.progressEgg,i=t.animManager.nbFrames;this._loadingProgressVisible===!1?(this._loadingProgressVisible=!0,t.x=this.mapScene.w/2,t.y=this.mapScene.h/2,this._loadingProgress.show(),this._loadingProgress.progressEggFrameTween.reset().from({frame:0}).to({frame:.4*i},30,d.polyIn,2).start()):this._loadingProgress.progressEggFrameTween.reset().from({frame:t.animManager.frame}).to({frame:(.7*e+.4)*i},5).start()},s.prototype._hideLoadingProgress=function(){this._loadingProgressVisible=!1,this._loadingProgress.hide()},s.prototype.mapTransitionDisconnect=function(){this._mapSceneTransitionGraphic&&(this._mapSceneTransitionGraphic.remove(),this._resetTransition())},s.prototype._makeUserActorWalkInDirection=function(e,t){this.makeActorWalkInDirection(this.actorManager.userActor,e,t)},s.prototype.makeActorWalkInDirection=function(e,t,i,n){if(!e)return console.error(new Error("makeActorWalkInDirection: actor is "+e)),void(n&&n());var s;switch(t){case"top":s=6;break;case"bottom":s=2;break;case"left":s=4;break;case"right":s=0;break;default:s=0}var a=o.ANGLE_PER_DIRECTION[s];i&&(a+=Math.PI);var r=Math.cos(a)*_,l=Math.sin(a)*_;e.walkToSceneCoordinate(e.x+r,e.y+l,s,v,n)},s.prototype.launchMapTransition=function(e){var t=this;this._loadingProgress.loadAssets(function(){t.mapScene.setShader("mapTransition"),t.emit("launchMapTransition",e),t._activateMapScene()?(t._loadingProgress.progressEgg.alpha=1,t.mapScene.renderingParams.ratio=1,t._saveImageForTransition("black"),t._startLoading()):t._loadingFadeInTransitionRunning===!1&&(t._isMapLoading?t._startLoading():(e&&t._makeUserActorWalkInDirection(e,!1),t._runLoadingFadeInTransition()))})},s.prototype.cancelMapTransition=function(e){this.emit("cancelMapTransition",e),this.actorManager.userActor.setOnScreenPosition(this.actorManager.userActor.position),this._makeUserActorWalkInDirection(e,!0),this._waitingForMessage&&this._runLoadingFadeOutTransition(),this._mapLoadingMessage=null,this._waitingForMessage=!1},s.prototype._saveImageForTransition=function(e){var t=g,i=t*this.mapScene.h/this.mapScene.w,n=this.mapScene.renderer,o=n.startTextureUsage(t,i,1,null,"linear");if(n.startTextureRendering(o,0,t,0,i,!1),"black"===e)this.mapScene.clear(0,0,0,1);else{var s=t/this.mapScene.w;n.save(),n.scale(s,s),this.mapScene.render(),n.restore()}var a=!0;n.stopTextureRendering(a),null===this._mapSceneTransitionGraphic?this._mapSceneTransitionGraphic=new u({w:this.mapScene.w,h:this.mapScene.h,scene:this.mapScene,position:0,isHudElement:!0,alpha:1},o.texture):(this._mapSceneTransitionGraphic.clear(),this._mapSceneTransitionGraphic.texture=o.texture,this._mapSceneTransitionGraphic.show())},s.prototype._runLoadingFadeInTransition=function(){this._loadingFadeInTransitionRunning=!0,this._waitingForMessage=!0,this.showLoadingProgress(0),c(this._loadingProgress.progressEgg,["alpha","scaleX","scaleY"]).from({alpha:0,scaleX:.8,scaleY:.8}).to({alpha:1,scaleX:1,scaleY:1},15,d.backOut,1.5).start(),this.mapScene.renderingParams.ratio=0;var e=this;c(this.mapScene.renderingParams,["ratio"]).from({ratio:0}).to({ratio:1},15,d.polyInOut,3).start().onFinish(function(){e._saveImageForTransition("current"),e._loadingFadeInTransitionRunning=!1,e._startLoading()})},s.prototype._runLoadingFadeOutTransition=function(){var e=this,t=this.mapScene;c(this._loadingProgress.progressEgg,["alpha","scaleX","scaleY"]).from({alpha:1,scaleX:1,scaleY:1}).to({alpha:0,scaleX:.8,scaleY:.8},10,d.backIn,1.5).start(),c(this._mapSceneTransitionGraphic,["alpha"]).from({alpha:1}).to({alpha:0},10).onFinish(function(){null!==e._mapSceneTransitionGraphic&&(e._mapSceneTransitionGraphic.remove(),e._mapSceneTransitionGraphic=null)}).start(),c(t.renderingParams,["ratio"]).from({ratio:1}).to({ratio:0},25,d.polyInOut,2).onFinish(function(){t.setShader("unfiltering"),t.renderingParams.ratio=.15,e._hideLoadingProgress()}).start(),this.makeActorWalkIn(this.actorManager.userActor)},s.prototype.makeActorWalkIn=function(e,t,i){t=t||100;var n,s=this.mapScene,a=e.x,r=e.y,l=Math.abs(s.l-a),c=Math.abs(s.l+s.w-a),d=Math.abs(s.t-r),u=Math.abs(s.t+s.h-r),h=l<t,p=c<t,m=d<t,f=u<t;if(h)n=m?1:f?7:0;else if(p)n=m?3:f?5:4;else if(m)n=2;else{if(!f)return;n=6}var g=o.ANGLE_PER_DIRECTION[n];e.x-=Math.cos(g)*_,e.y-=Math.sin(g)*_,e.walkToSceneCoordinate(a,r,n,v,i)},s.prototype.loadMap=function(e){this.changeMapTimeout?(window.clearTimeout(this.changeMapTimeout),this.changeMapTimeout=null):window.foreground.lock("loadMap"),this._mapLoadingMessage=e,this._loadingFadeInTransitionRunning===!1&&(this._waitingForMessage?this._startLoading():this.launchMapTransition())},s.prototype.reloadMap=function(e){if(!this.mapRenderer.isReady){var t=this;return void this.mapRenderer.once("ready",function(){t.reloadMap(e)})}this._updateMapInfoData(e,{noMovementWaitReset:!0}),window.foreground.show(),window.foreground.unlock("loadMap"),this.actorManager.updateMapInfoData(e),this.emit("mapLoaded",{isReload:!0}),this.interactiveBlink&&this.highlightInteractivesWithDifferentType()};var y=null,b=null;s.prototype._startLoading=function(){var e=this._mapLoadingMessage;if(null!==e){this._mapLoadingMessage=null,this._waitingForMessage=!1,this.actorManager.pause();var t=e.mapId;if(t!==b){this.releaseMap(b),b=t,this._isMapLoading=!0;var i=this,n=o.MAP_PATH+t+".json";r.loadJson(n,function(t){return t===o.EMPTY_JSON?window.dofus.disconnect("ASSET_MISSING"):void(t.id===b&&(null===y?(y={msg:e,mapData:t},i._loadMapAssets()):y={msg:e,mapData:t}))})}}},s.prototype._loadMapAssets=function(){var e=y.msg,t=y.mapData,i=this;this.mapRenderer.setMap(y,function(){return null!==y&&b!==t.id?void i._loadMapAssets():(window.foreground.show(),window.foreground.unlock("loadMap"),a.fillPathGrid(t),i._updateMapInfoData(e),i.actorManager.updateMapInfoData(e),i.actorManager.unpause(),i.actorManager.userActor.moving=!1,f.unlockMessages(),i.emit("mapLoaded"),i._runLoadingFadeOutTransition(),i.interactiveBlink&&i.highlightInteractivesWithDifferentType(),b=null,y=null,void(i._isMapLoading=!1))})}}]);
//# sourceMappingURL=script.js.map